# ğŸ¤– COPILOT PROJECT NOTES - EEO2025 ERDMS
# Tento soubor si Copilot pÅ™eÄte na zaÄÃ¡tku kaÅ¾dÃ©ho chatu nebo kdyÅ¾ "tÃ¡pÃ¡"

## âš ï¸ KRITICKÃ PRAVIDLA - VÅ½DY DODRÅ½OVAT

### ğŸ“¦ VERZOVÃNÃ - NIKDY NEZAPOMENOUT!
PÅ™i zmÄ›nÄ› verze aplikace VÅ½DY upravit VÅ ECHNY tyto soubory:
1. `/var/www/erdms-dev/apps/eeo-v2/client/package.json` - pole "version"
2. `/var/www/erdms-dev/apps/eeo-v2/client/.env` - REACT_APP_VERSION
3. `/var/www/erdms-dev/apps/eeo-v2/client/.env.development` - REACT_APP_VERSION
4. `/var/www/erdms-dev/apps/eeo-v2/client/.env.production` - REACT_APP_VERSION

**FormÃ¡t verze:** `X.XXx` (napÅ™. 1.86a, 1.87b)

### ğŸ—ï¸ BUILD PROCES
- Build pÅ™Ã­kaz: `cd /var/www/erdms-dev/apps/eeo-v2/client && npm run build`
- **NIKDY** automaticky nemazat `build/` sloÅ¾ku po buildu!
- Build sloÅ¾ka je urÄena k nasazenÃ­ na produkci
- Pokud user Å™ekne "promazat build" = smazat pÅ™ed novÃ½m buildem, NE po nÄ›m!

### ğŸ—„ï¸ DATABÃZE
- **MySQL NENÃ na localhost!**
- **Konfigurace DB je v `/var/www/erdms-dev/dbconfig.php`**
- NepouÅ¾Ã­vat `mysql -u root -h localhost` pÅ™Ã­kazy - DB je na vzdÃ¡lenÃ©m serveru
- Pro SQL dotazy:
  1. PouÅ¾Ã­vat pÅ™ipravenÃ© skripty v `docs/setup/*.sql`
  2. Nebo poÅ¾Ã¡dat uÅ¾ivatele o pÅ™Ã­stup k DB
  3. Nebo pouÅ¾Ã­t PHP skripty kterÃ© majÃ­ pÅ™Ã­stup pÅ™es dbconfig.php

### ğŸ“ STRUKTURA PROJEKTU
```
/var/www/erdms-dev/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ eeo-v2/
â”‚       â”œâ”€â”€ api/                    # Node.js API (novÃ¡ verze)
â”‚       â”œâ”€â”€ api-legacy/             # PHP API (starÃ½ backend)
â”‚       â”‚   â””â”€â”€ api.eeo/
â”‚       â”‚       â””â”€â”€ v2025.03_25/
â”‚       â”‚           â””â”€â”€ lib/
â”‚       â”‚               â””â”€â”€ invoiceHandlers.php  # Faktury backend
â”‚       â””â”€â”€ client/                 # React frontend
â”‚           â”œâ”€â”€ src/
â”‚           â”‚   â”œâ”€â”€ pages/
â”‚           â”‚   â”‚   â”œâ”€â”€ Invoices25List.js      # Seznam faktur
â”‚           â”‚   â”‚   â””â”€â”€ Orders25List.js        # Seznam objednÃ¡vek
â”‚           â”‚   â””â”€â”€ services/
â”‚           â”‚       â”œâ”€â”€ api25invoices.js       # Faktury API service
â”‚           â”‚       â””â”€â”€ apiOrderV2.js          # ObjednÃ¡vky API service
â”‚           â”œâ”€â”€ .env                           # Env variables
â”‚           â”œâ”€â”€ .env.development
â”‚           â”œâ”€â”€ .env.production
â”‚           â””â”€â”€ package.json
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ development/                # Dokumentace vÃ½voje
â”‚   â””â”€â”€ setup/                      # SQL skripty
â””â”€â”€ .copilot-notes                  # TENTO SOUBOR
```

### ğŸ”§ BÄšÅ½NÃ‰ ÃšKOLY

#### ZmÄ›na verze (napÅ™. na 1.86a):
```bash
# 1. Upravit vÅ¡echny 4 soubory s verzÃ­ (viz VERZOVÃNÃ vÃ½Å¡e)
# 2. Git commit
cd /var/www/erdms-dev/apps/eeo-v2/client
git add -A
git commit -m "Version 1.86a: popis zmÄ›n"
# 3. Build
npm run build
```

#### Oprava filtru/API:
- Frontend: `src/pages/Invoices25List.js` nebo `Orders25List.js`
- API service: `src/services/api25invoices.js` nebo `apiOrderV2.js`
- Backend PHP: `api-legacy/api.eeo/v2025.03_25/lib/invoiceHandlers.php`
- **Kontroluj celÃ½ Å™etÄ›zec:** Frontend â†’ API Service â†’ Backend endpoint

#### Debug console.log:
- **PÅ˜ED buildem vÅ¾dy odstranit debug console.log** z produkÄnÃ­ho kÃ³du
- Hledat: `console.log('ğŸ”`, `console.log('ğŸ“¦` atd.

### ğŸ—‚ï¸ DÅ®LEÅ½ITÃ‰ ÄŒÃSELNÃKY

#### 25_ciselnik_stavy (Druhy objednÃ¡vek)
**Tabulka:** `25_ciselnik_stavy`
**KlÃ­ÄovÃ© sloupce:**
- `id` - primÃ¡rnÃ­ klÃ­Ä
- `typ_objektu` - typ (napÅ™. 'DRUH_OBJEDNAVKY')
- `kod_stavu` - kÃ³d (napÅ™. 'MAJETEK', 'ELEKTRONIKA')
- `nazev_stavu` - lidskÃ½ nÃ¡zev
- `atribut_objektu` - **NOVÃ (12/2025)** - oznaÄuje zda je potÅ™eba specifikovat poloÅ¾ky (hodnota 1)

**atribut_objektu = 1:** ELEKTRONIKA, FKSP, MAJETEK, NÃBYTEK, VZDÄšLÃVÃNÃ_VYBAVENÃ
**atribut_objektu = 0 nebo NULL:** ÄŒistÃ­cÃ­ prostÅ™edky, Emise a STK, OstatnÃ­, atd.

**PouÅ¾itÃ­ v kÃ³du:**
- Frontend (OrderForm25.js): PomocnÃ¡ funkce `isMaterialOrder()`
- Backend: SELECT * z tabulky vracÃ­ vÅ¡echny sloupce vÄetnÄ› atribut_objektu
- API endpoint: `ciselniky/stavy/list` (ciselnikyHandlers.php line 1584)

**DÅ®LEÅ½ITÃ‰:**
- âŒ **NIKDY** nekontrolovat hardcoded string `"MAJETEK"`
- âœ… **VÅ½DY** pouÅ¾Ã­t: `atribut_objektu === 1`
- DÅ¯vod: VÃ­ce druhÅ¯ objednÃ¡vek vyÅ¾aduje stejnÃ© chovÃ¡nÃ­ (povinnÃ© poloÅ¾ky, objekty)

### ğŸ› ÄŒASTÃ‰ CHYBY A Å˜EÅ ENÃ

#### Filter nefunguje:
1. âœ… Frontend posÃ­lÃ¡ parametr? (Invoices25List.js)
2. âœ… API service pÅ™idÃ¡vÃ¡ parametr do payload? (api25invoices.js)
3. âœ… Backend zpracovÃ¡vÃ¡ parametr? (invoiceHandlers.php)
- **ProblÃ©m Äasto v kroku 2** - parametr se "ztratÃ­" v API service!

#### Build warnings:
- `no-unused-vars`, `react-hooks/exhaustive-deps` = OK, ignorovat
- `import/no-anonymous-default-export` = kosmetickÃ©, OK
- Build ÃºspÄ›Å¡nÃ½ = warnings nezÃ¡leÅ¾Ã­

#### MySQL chyba 2002:
- NepouÅ¾Ã­vat pÅ™Ã­mÃ© mysql pÅ™Ã­kazy
- PoÅ¾Ã¡dat uÅ¾ivatele o SQL vÃ½stup nebo pouÅ¾Ã­t pÅ™ipravenÃ© skripty

### ğŸ’¡ TIPY PRO COPILOTA (mÄ›)
- Na zaÄÃ¡tku chatu si pÅ™eÄti tento soubor
- KdyÅ¾ user mluvÃ­ o "verzi" â†’ zkontroluj vÅ¡echny 4 soubory
- KdyÅ¾ user Å™ekne "build" â†’ nikdy nemazat build sloÅ¾ku po buildu
- KdyÅ¾ user Å™ekne "filtr nefunguje" â†’ zkontroluj celÃ½ Å™etÄ›zec FEâ†’APIâ†’BE
- KdyÅ¾ tÃ¡pÃ¡Å¡ â†’ pÅ™eÄti si tento soubor znovu

### ğŸ“ KONTAKT
- User: Robert HolovskÃ½ (robex08)
- Projekt: EEO2025 - Evidence objednÃ¡vek a faktur pro ZZS SK
- AktuÃ¡lnÃ­ verze: 1.86a (k 8.12.2025)

---
**PoslednÃ­ update:** 8.12.2025
**Update reason:** PÅ™idÃ¡na dokumentace atribut_objektu a refactoringu OrderForm25.js
