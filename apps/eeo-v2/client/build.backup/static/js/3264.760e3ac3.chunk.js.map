{"version":3,"file":"static/js/3264.760e3ac3.chunk.js","mappings":"6JA6BA,MAAMA,EAA2B,CAM/B,eAAkB,CAChBC,OAAQ,iBACRC,QAAS,kBAEX,eAAkB,CAChBD,OAAQ,iBACRC,QAAS,kBAEX,eAAkB,CAChBD,OAAQ,KACRC,QAAS,kBAEX,eAAkB,CAChBD,OAAQ,KACRC,QAAS,kBAIX,eAAkB,CAChBD,OAAQ,iBACRC,QAAS,oBAEX,eAAkB,CAChBD,OAAQ,KACRC,QAAS,oBAIX,iBAAoB,CAClBD,OAAQ,mBACRC,QAAS,gBAEX,iBAAoB,CAClBD,OAAQ,KACRC,QAAS,gBAIX,aAAgB,CACdD,OAAQ,KACRC,QAAS,kBAIX,cAAiB,CACfD,OAAQ,KACRC,QAAS,gBAMX,iBAAoB,CAClBD,OAAQ,mBACRC,QAAS,oBAEX,iBAAoB,CAClBD,OAAQ,KACRC,QAAS,oBAEX,iBAAoB,CAClBD,OAAQ,mBACRC,QAAS,sBAEX,iBAAoB,CAClBD,OAAQ,KACRC,QAAS,sBAMX,kBAAqB,CACnBD,OAAQ,oBACRC,QAAS,qBAEX,kBAAqB,CACnBD,OAAQ,KACRC,QAAS,qBAEX,kBAAqB,CACnBD,OAAQ,oBACRC,QAAS,uBAEX,kBAAqB,CACnBD,OAAQ,KACRC,QAAS,wBAyBAC,EAAiC,WAKxC,IAJJC,EAAeC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GAElBG,IAAWH,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACXI,IAAYJ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GAEZ,KAJgBA,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,IAMd,MAAO,IAAID,GAGb,IAAKM,MAAMC,QAAQP,IAA+C,IAA3BA,EAAgBE,OAErD,MAAO,GAGT,MAAMM,EAAsB,IAAIC,IAAI,IAAIT,IAGxC,IAAK,MAAMU,KAAYV,EAAiB,CACtC,MAAMW,EAAef,EAAyBc,GAEzCC,IAMDP,GAAeO,EAAad,QAC9BW,EAAoBI,IAAID,EAAad,QAInCQ,GAAgBM,EAAab,SAC/BU,EAAoBI,IAAID,EAAab,SAEzC,CAEA,OAAOQ,MAAMO,KAAKL,EACpB,C","sources":["services/permissionHierarchyService.js"],"sourcesContent":["/**\n * üîê Slu≈æba pro hierarchick√© roz≈°√≠≈ôen√≠ opr√°vnƒõn√≠\n * \n * PRINCIP:\n * - Hierarchie ROZ≈†I≈òUJE existuj√≠c√≠ pr√°va (OWN ‚Üí ALL)\n * - Hierarchie POSILUJE existuj√≠c√≠ pr√°va (READ ‚Üí EDIT)\n * - Hierarchie NEVYTV√Å≈ò√ç pr√°va z niƒçeho\n * \n * P≈ò√çKLADY:\n * ‚úÖ ORDER_READ_OWN + hierarchie ‚Üí ORDER_READ_ALL\n * ‚úÖ ORDER_READ_ALL + hierarchie ‚Üí ORDER_EDIT_ALL\n * ‚ùå ≈Ω√°dn√© pr√°vo + hierarchie ‚Üí NIƒåEHO\n * \n * @author GitHub Copilot & robex08\n * @date 15. prosince 2025\n * @version 1.0\n */\n\n/**\n * üìã Mapov√°n√≠ roz≈°√≠≈ôen√≠ pr√°v podle hierarchie\n * \n * Struktura: \n * {\n *   'MODULE_ACTION_SCOPE': {\n *     expand: 'MODULE_ACTION_EXPANDED_SCOPE',  // Roz≈°√≠≈ôen√≠ rozsahu (OWN ‚Üí ALL)\n *     upgrade: 'MODULE_HIGHER_ACTION_SCOPE'    // Pov√Ω≈°en√≠ akce (READ ‚Üí EDIT)\n *   }\n * }\n */\nconst PERMISSION_HIERARCHY_MAP = {\n  // ============================================\n  // OBJEDN√ÅVKY (ORDERS)\n  // ============================================\n  \n  // READ permissions\n  'ORDER_READ_OWN': {\n    expand: 'ORDER_READ_ALL',      // Roz≈°√≠≈ôen√≠: vid√≠ objedn√°vky pod≈ô√≠zen√Ωch\n    upgrade: 'ORDER_EDIT_OWN'      // Pov√Ω≈°en√≠: m≈Ø≈æe editovat svoje\n  },\n  'ORDER_VIEW_OWN': {\n    expand: 'ORDER_VIEW_ALL',\n    upgrade: 'ORDER_EDIT_OWN'\n  },\n  'ORDER_READ_ALL': {\n    expand: null,                  // U≈æ je ALL\n    upgrade: 'ORDER_EDIT_ALL'      // M≈Ø≈æe pov√Ω≈°it na editaci v≈°ech\n  },\n  'ORDER_VIEW_ALL': {\n    expand: null,\n    upgrade: 'ORDER_EDIT_ALL'\n  },\n  \n  // EDIT permissions\n  'ORDER_EDIT_OWN': {\n    expand: 'ORDER_EDIT_ALL',      // Roz≈°√≠≈ôen√≠: m≈Ø≈æe editovat i jin√©\n    upgrade: 'ORDER_DELETE_OWN'    // Pov√Ω≈°en√≠: m≈Ø≈æe mazat svoje\n  },\n  'ORDER_EDIT_ALL': {\n    expand: null,                  // U≈æ je ALL\n    upgrade: 'ORDER_DELETE_ALL'    // M≈Ø≈æe pov√Ω≈°it na maz√°n√≠ v≈°ech\n  },\n  \n  // DELETE permissions\n  'ORDER_DELETE_OWN': {\n    expand: 'ORDER_DELETE_ALL',    // Roz≈°√≠≈ôen√≠: m≈Ø≈æe mazat i jin√©\n    upgrade: 'ORDER_MANAGE'        // Pov√Ω≈°en√≠: pln√° spr√°va\n  },\n  'ORDER_DELETE_ALL': {\n    expand: null,                  // U≈æ je ALL\n    upgrade: 'ORDER_MANAGE'        // Pov√Ω≈°en√≠: pln√° spr√°va\n  },\n  \n  // CREATE permission (roz≈°√≠≈ôen√≠ nem√° smysl, ale m≈Ø≈æe pov√Ω≈°it)\n  'ORDER_CREATE': {\n    expand: null,                  // CREATE je glob√°ln√≠\n    upgrade: 'ORDER_EDIT_OWN'      // M≈Ø≈æe z√≠skat i editaci\n  },\n  \n  // APPROVE permission\n  'ORDER_APPROVE': {\n    expand: null,                  // APPROVE je glob√°ln√≠\n    upgrade: 'ORDER_MANAGE'        // M≈Ø≈æe z√≠skat plnou spr√°vu\n  },\n  \n  // ============================================\n  // FAKTURY (INVOICES) - p≈ôipraveno pro Sprint 3\n  // ============================================\n  'INVOICE_READ_OWN': {\n    expand: 'INVOICE_READ_ALL',\n    upgrade: 'INVOICE_EDIT_OWN'\n  },\n  'INVOICE_READ_ALL': {\n    expand: null,\n    upgrade: 'INVOICE_EDIT_ALL'\n  },\n  'INVOICE_EDIT_OWN': {\n    expand: 'INVOICE_EDIT_ALL',\n    upgrade: 'INVOICE_DELETE_OWN'\n  },\n  'INVOICE_EDIT_ALL': {\n    expand: null,\n    upgrade: 'INVOICE_DELETE_ALL'\n  },\n  \n  // ============================================\n  // POKLADNA (CASHBOOK) - p≈ôipraveno pro Sprint 2\n  // ============================================\n  'CASHBOOK_READ_OWN': {\n    expand: 'CASHBOOK_READ_ALL',\n    upgrade: 'CASHBOOK_EDIT_OWN'\n  },\n  'CASHBOOK_READ_ALL': {\n    expand: null,\n    upgrade: 'CASHBOOK_EDIT_ALL'\n  },\n  'CASHBOOK_EDIT_OWN': {\n    expand: 'CASHBOOK_EDIT_ALL',\n    upgrade: 'CASHBOOK_DELETE_OWN'\n  },\n  'CASHBOOK_EDIT_ALL': {\n    expand: null,\n    upgrade: 'CASHBOOK_DELETE_ALL'\n  }\n};\n\n/**\n * üîç Zjist√≠, zda u≈æivatel m√° z√°kladn√≠ pr√°vo (z role/u≈æivatele)\n * \n * @param {string} permission - K√≥d opr√°vnƒõn√≠ (nap≈ô. 'ORDER_READ_OWN')\n * @param {Array<string>} basePermissions - Pole z√°kladn√≠ch opr√°vnƒõn√≠ u≈æivatele\n * @returns {boolean}\n */\nconst hasBasePermission = (permission, basePermissions) => {\n  if (!permission || !Array.isArray(basePermissions)) return false;\n  return basePermissions.includes(permission);\n};\n\n/**\n * üè¢ Roz≈°√≠≈ô√≠ z√°kladn√≠ pr√°va o hierarchick√° roz≈°√≠≈ôen√≠\n * \n * @param {Array<string>} basePermissions - Z√°kladn√≠ pr√°va z role/u≈æivatele\n * @param {boolean} hierarchyEnabled - Je hierarchie zapnut√°?\n * @param {boolean} allowExpand - Povolit roz≈°√≠≈ôen√≠ rozsahu (OWN ‚Üí ALL)?\n * @param {boolean} allowUpgrade - Povolit pov√Ω≈°en√≠ akce (READ ‚Üí EDIT)?\n * @returns {Array<string>} - Roz≈°√≠≈ôen√° pr√°va\n */\nexport const expandPermissionsWithHierarchy = (\n  basePermissions = [],\n  hierarchyEnabled = false,\n  allowExpand = true,\n  allowUpgrade = true\n) => {\n  if (!hierarchyEnabled) {\n    // Hierarchie vypnut√° ‚Üí pouze z√°kladn√≠ pr√°va\n    return [...basePermissions];\n  }\n  \n  if (!Array.isArray(basePermissions) || basePermissions.length === 0) {\n    // ≈Ω√°dn√° z√°kladn√≠ pr√°va ‚Üí hierarchie nic nep≈ôid√°\n    return [];\n  }\n  \n  const expandedPermissions = new Set([...basePermissions]);\n  \n  // Projdi v≈°echna z√°kladn√≠ pr√°va a aplikuj hierarchii\n  for (const basePerm of basePermissions) {\n    const hierarchyMap = PERMISSION_HIERARCHY_MAP[basePerm];\n    \n    if (!hierarchyMap) {\n      // Pro toto pr√°vo nen√≠ definov√°no hierarchick√© roz≈°√≠≈ôen√≠\n      continue;\n    }\n    \n    // Roz≈°√≠≈ôen√≠ rozsahu (OWN ‚Üí ALL)\n    if (allowExpand && hierarchyMap.expand) {\n      expandedPermissions.add(hierarchyMap.expand);\n    }\n    \n    // Pov√Ω≈°en√≠ akce (READ ‚Üí EDIT)\n    if (allowUpgrade && hierarchyMap.upgrade) {\n      expandedPermissions.add(hierarchyMap.upgrade);\n    }\n  }\n  \n  return Array.from(expandedPermissions);\n};\n\n/**\n * üéØ Vytvo≈ô√≠ funkci hasPermission s podporou hierarchie\n * \n * @param {Array<string>} basePermissions - Z√°kladn√≠ pr√°va z role/u≈æivatele\n * @param {Object} hierarchyConfig - Konfigurace hierarchie z hierarchyService\n * @returns {Function} - Funkce hasPermission(permissionCode)\n */\nexport const createHierarchicalPermissionChecker = (basePermissions = [], hierarchyConfig = {}) => {\n  const hierarchyEnabled = Boolean(hierarchyConfig.enabled && hierarchyConfig.profileId);\n  \n  // Roz≈°√≠≈ô pr√°va podle hierarchie\n  const expandedPermissions = expandPermissionsWithHierarchy(\n    basePermissions,\n    hierarchyEnabled,\n    true, // allowExpand\n    true  // allowUpgrade\n  );\n  \n  /**\n   * üîç Kontrola, zda u≈æivatel m√° dan√© pr√°vo\n   * \n   * @param {string} permissionCode - K√≥d opr√°vnƒõn√≠ (nap≈ô. 'ORDER_READ_ALL')\n   * @returns {boolean}\n   */\n  return (permissionCode) => {\n    if (!permissionCode) return false;\n    \n    // Zkontroluj v roz≈°√≠≈ôen√Ωch pr√°vech\n    const hasPermission = expandedPermissions.includes(permissionCode);\n    \n    if (process.env.NODE_ENV === 'development') {\n      if (!hasPermission && basePermissions.includes(permissionCode)) {\n        console.warn(`‚ö†Ô∏è [PermissionHierarchy] Pr√°vo ${permissionCode} je v base, ale ne v expanded!`);\n      }\n    }\n    \n    return hasPermission;\n  };\n};\n\n/**\n * üîç Zjist√≠, zda m√° u≈æivatel pr√°vo VIEW nebo READ pro objedn√°vky\n * \n * @param {Function} hasPermission - Funkce pro kontrolu pr√°v\n * @returns {{ canView: boolean, canViewOwn: boolean, canViewAll: boolean }}\n */\nexport const getOrderViewPermissions = (hasPermission) => {\n  if (!hasPermission) {\n    return { canView: false, canViewOwn: false, canViewAll: false };\n  }\n  \n  const canViewOwn = hasPermission('ORDER_READ_OWN') || hasPermission('ORDER_VIEW_OWN');\n  const canViewAll = hasPermission('ORDER_READ_ALL') || \n                     hasPermission('ORDER_VIEW_ALL') ||\n                     hasPermission('ORDER_MANAGE') ||\n                     hasPermission('ORDER_EDIT_ALL') ||\n                     hasPermission('ORDER_DELETE_ALL');\n  \n  return {\n    canView: canViewOwn || canViewAll,\n    canViewOwn,\n    canViewAll\n  };\n};\n\n/**\n * üîç Zjist√≠, zda m√° u≈æivatel pr√°vo EDIT pro objedn√°vky\n * \n * @param {Function} hasPermission - Funkce pro kontrolu pr√°v\n * @returns {{ canEdit: boolean, canEditOwn: boolean, canEditAll: boolean }}\n */\nexport const getOrderEditPermissions = (hasPermission) => {\n  if (!hasPermission) {\n    return { canEdit: false, canEditOwn: false, canEditAll: false };\n  }\n  \n  const canEditOwn = hasPermission('ORDER_EDIT_OWN');\n  const canEditAll = hasPermission('ORDER_EDIT_ALL') ||\n                     hasPermission('ORDER_MANAGE') ||\n                     hasPermission('ORDER_DELETE_ALL');\n  \n  return {\n    canEdit: canEditOwn || canEditAll,\n    canEditOwn,\n    canEditAll\n  };\n};\n\n/**\n * üîç Zjist√≠, zda m√° u≈æivatel pr√°vo CREATE pro objedn√°vky\n * \n * @param {Function} hasPermission - Funkce pro kontrolu pr√°v\n * @returns {boolean}\n */\nexport const getOrderCreatePermission = (hasPermission) => {\n  if (!hasPermission) return false;\n  \n  return hasPermission('ORDER_CREATE') || \n         hasPermission('ORDER_MANAGE');\n};\n\n/**\n * üîç Zjist√≠, zda m√° u≈æivatel pr√°vo DELETE pro objedn√°vky\n * \n * @param {Function} hasPermission - Funkce pro kontrolu pr√°v\n * @param {number} currentUserId - ID aktu√°ln√≠ho u≈æivatele\n * @param {number} orderAuthorId - ID autora objedn√°vky\n * @returns {boolean}\n */\nexport const getOrderDeletePermission = (hasPermission, currentUserId, orderAuthorId) => {\n  if (!hasPermission) return false;\n  \n  const canDeleteAll = hasPermission('ORDER_DELETE_ALL') || hasPermission('ORDER_MANAGE');\n  if (canDeleteAll) return true;\n  \n  const canDeleteOwn = hasPermission('ORDER_DELETE_OWN');\n  if (canDeleteOwn && currentUserId === orderAuthorId) return true;\n  \n  return false;\n};\n\n/**\n * üìä Vr√°t√≠ p≈ôehled v≈°ech pr√°v pro debugging\n * \n * @param {Array<string>} basePermissions - Z√°kladn√≠ pr√°va\n * @param {Object} hierarchyConfig - Konfigurace hierarchie\n * @returns {Object}\n */\nexport const getPermissionsSummary = (basePermissions = [], hierarchyConfig = {}) => {\n  const hierarchyEnabled = Boolean(hierarchyConfig.enabled && hierarchyConfig.profileId);\n  const expandedPermissions = expandPermissionsWithHierarchy(basePermissions, hierarchyEnabled);\n  \n  return {\n    hierarchyEnabled,\n    profileId: hierarchyConfig.profileId,\n    profileName: hierarchyConfig.profileName,\n    basePermissions,\n    expandedPermissions,\n    addedByHierarchy: expandedPermissions.filter(p => !basePermissions.includes(p)),\n    summary: {\n      baseCount: basePermissions.length,\n      expandedCount: expandedPermissions.length,\n      addedCount: expandedPermissions.length - basePermissions.length\n    }\n  };\n};\n\n/**\n * üß™ Testovac√≠ funkce pro ovƒõ≈ôen√≠ hierarchie\n */\nexport const testPermissionHierarchy = () => {\n  console.group('üß™ Test hierarchie pr√°v');\n  \n  // Test 1: Bez hierarchie\n  console.log('\\nüìã Test 1: BEZ hierarchie');\n  const basePerms1 = ['ORDER_READ_OWN', 'ORDER_CREATE'];\n  const expanded1 = expandPermissionsWithHierarchy(basePerms1, false);\n  console.log('Base:', basePerms1);\n  console.log('Expanded:', expanded1);\n  console.log('Mƒõlo by b√Ωt stejn√©:', JSON.stringify(basePerms1) === JSON.stringify(expanded1));\n  \n  // Test 2: S hierarchi√≠ - roz≈°√≠≈ôen√≠\n  console.log('\\nüìã Test 2: S hierarchi√≠ - roz≈°√≠≈ôen√≠');\n  const basePerms2 = ['ORDER_READ_OWN', 'ORDER_CREATE'];\n  const expanded2 = expandPermissionsWithHierarchy(basePerms2, true, true, true);\n  console.log('Base:', basePerms2);\n  console.log('Expanded:', expanded2);\n  console.log('Mƒõlo p≈ôidat ORDER_READ_ALL, ORDER_EDIT_OWN');\n  \n  // Test 3: ≈Ω√°dn√° pr√°va + hierarchie = po≈ô√°d nic\n  console.log('\\nüìã Test 3: ≈Ω√°dn√° pr√°va + hierarchie');\n  const basePerms3 = [];\n  const expanded3 = expandPermissionsWithHierarchy(basePerms3, true);\n  console.log('Base:', basePerms3);\n  console.log('Expanded:', expanded3);\n  console.log('Mƒõlo z≈Østat pr√°zdn√©:', expanded3.length === 0);\n  \n  // Test 4: Pln√° pr√°va\n  console.log('\\nüìã Test 4: Pln√° pr√°va');\n  const basePerms4 = ['ORDER_MANAGE'];\n  const expanded4 = expandPermissionsWithHierarchy(basePerms4, true);\n  console.log('Base:', basePerms4);\n  console.log('Expanded:', expanded4);\n  \n  console.groupEnd();\n};\n\n// Export v≈°ech funkc√≠\nconst permissionHierarchyService = {\n  expandPermissionsWithHierarchy,\n  createHierarchicalPermissionChecker,\n  getOrderViewPermissions,\n  getOrderEditPermissions,\n  getOrderCreatePermission,\n  getOrderDeletePermission,\n  getPermissionsSummary,\n  testPermissionHierarchy,\n  PERMISSION_HIERARCHY_MAP\n};\n\nexport default permissionHierarchyService;\n"],"names":["PERMISSION_HIERARCHY_MAP","expand","upgrade","expandPermissionsWithHierarchy","basePermissions","arguments","length","undefined","allowExpand","allowUpgrade","Array","isArray","expandedPermissions","Set","basePerm","hierarchyMap","add","from"],"sourceRoot":""}