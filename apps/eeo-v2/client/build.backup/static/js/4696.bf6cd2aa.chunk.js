"use strict";(self.webpackChunkr_app_zzs_eeo=self.webpackChunkr_app_zzs_eeo||[]).push([[4696],{42161:(e,n,o)=>{o.r(n),o.d(n,{default:()=>Yn});var t,i,a,l,r,d,s,c,p,x,u,h,g,v,m,f,b,y,j,k,z,w,S,A,I,T,C,R,E,_,L,N,O,P,D,V,M,B,W,U,F,H,K,J,Y,Z,G,X,$,q,Q,ee,ne,oe,te,ie,ae,le,re,de,se,ce,pe,xe,ue,he,ge=o(89379),ve=o(57528),me=o(65043),fe=o(45903),be=o(12014),ye=o(54110),je=o(54077),ke=o(63227),ze=(o(96299),o(83910)),we=o(63974),Se=o(63577),Ae=o.n(Se),Ie=o(74373),Te=o(88720),Ce=o(97929),Re=o(70579);const Ee="https://erdms.zachranka.cz/api.eeo/".replace(/\/$/,""),_e=window.console.error;window.console.error=function(){var e;const n="string"===typeof(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:(null===(e=arguments.length<=0?void 0:arguments[0])||void 0===e?void 0:e.message)||"";n.includes("ResizeObserver loop completed")||n.includes("ResizeObserver loop limit exceeded")||_e(...arguments)},window.addEventListener("error",e=>{var n,o,t,i,a,l;(null!==(n=e.message)&&void 0!==n&&null!==(o=n.includes)&&void 0!==o&&o.call(n,"ResizeObserver loop completed")||null!==(t=e.message)&&void 0!==t&&null!==(i=t.includes)&&void 0!==i&&i.call(t,"ResizeObserver loop limit exceeded")||null!==(a=e.message)&&void 0!==a&&null!==(l=a.includes)&&void 0!==l&&l.call(a,"undelivered notifications"))&&(e.stopImmediatePropagation(),e.preventDefault())},!0);const Le=fe.A.div(t||(t=(0,ve.A)(["\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: #f5f7fa;\n  margin-top: -1em; /* Kompenzace padding-top z Layout Content */\n  user-select: none;\n  -webkit-user-select: none;\n"]))),Ne=fe.A.div(i||(i=(0,ve.A)(["\n  padding: 16px 24px;\n  background: white;\n  border-bottom: 1px solid #e0e6ed;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n  flex-shrink: 0;\n  user-select: none;\n"]))),Oe=fe.A.h1(a||(a=(0,ve.A)(["\n  color: #2c3e50;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  font-size: 1.5rem;\n"]))),Pe=fe.A.div(l||(l=(0,ve.A)(["\n  display: flex;\n  gap: 12px;\n"]))),De=fe.A.button(r||(r=(0,ve.A)(["\n  padding: 8px 16px;\n  background: ",";\n  color: ",";\n  border: 1px solid ",";\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n  font-weight: 500;\n\n  &:hover {\n    background: ",";\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"])),e=>e.primary?"#3b82f6":"white",e=>e.primary?"#fff":"#2c3e50",e=>e.primary?"#3b82f6":"#e0e6ed",e=>e.primary?"#2563eb":"#f8fafc"),Ve=fe.A.div(d||(d=(0,ve.A)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  animation: fadeIn 0.2s ease-in-out;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n"]))),Me=fe.A.div(s||(s=(0,ve.A)(["\n  background: white;\n  border-radius: 12px;\n  padding: 24px;\n  max-width: 500px;\n  width: 90%;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  animation: slideUp 0.3s ease-out;\n\n  @keyframes slideUp {\n    from {\n      transform: translateY(20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n"]))),Be=fe.A.div(c||(c=(0,ve.A)(["\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 16px;\n  color: #dc2626;\n  font-size: 1.25rem;\n  font-weight: 700;\n"]))),We=fe.A.div(p||(p=(0,ve.A)(["\n  color: #475569;\n  font-size: 1rem;\n  line-height: 1.6;\n  margin-bottom: 24px;\n"]))),Ue=fe.A.div(x||(x=(0,ve.A)(["\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n"]))),Fe=fe.A.button(u||(u=(0,ve.A)(["\n  padding: 10px 20px;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n\n  ","\n"])),e=>"danger"===e.variant?"\n    background: #dc2626;\n    color: white;\n    &:hover {\n      background: #b91c1c;\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.4);\n    }\n  ":"\n    background: #f1f5f9;\n    color: #475569;\n    &:hover {\n      background: #e2e8f0;\n    }\n  "),He=fe.A.div(h||(h=(0,ve.A)(["\n  flex: 1;\n  display: flex;\n  overflow: hidden;\n"]))),Ke=fe.A.div(g||(g=(0,ve.A)(["\n  width: 400px;\n  background: white;\n  border-right: 1px solid #e0e6ed;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  position: relative;\n  user-select: none;\n"]))),Je=fe.A.div(v||(v=(0,ve.A)(["\n  padding: 16px;\n  border-bottom: 1px solid #e0e6ed;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n"]))),Ye=fe.A.h3(m||(m=(0,ve.A)(["\n  margin: 0;\n  color: white;\n  font-size: 1rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),Ze=fe.A.div(f||(f=(0,ve.A)(["\n  padding: 12px 16px;\n  border-bottom: 1px solid #e0e6ed;\n  position: relative;\n"]))),Ge=fe.A.input(b||(b=(0,ve.A)(["\n  width: 100%;\n  padding: 8px 32px 8px 36px;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  background: #f8fafc;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    background: white;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n"]))),Xe=fe.A.div(y||(y=(0,ve.A)(["\n  position: absolute;\n  left: 28px;\n  top: 22px;\n  color: #94a3b8;\n"]))),$e=fe.A.button(j||(j=(0,ve.A)(["\n  position: absolute;\n  right: 24px;\n  top: 20px;\n  background: none;\n  border: none;\n  color: #94a3b8;\n  cursor: pointer;\n  padding: 4px 6px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.1rem;\n  border-radius: 4px;\n  transition: all 0.2s;\n  \n  &:hover {\n    background: #e2e8f0;\n    color: #475569;\n  }\n  \n  &:active {\n    transform: scale(0.95);\n  }\n"]))),qe=fe.A.div(k||(k=(0,ve.A)(["\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n  padding-bottom: 190px; /* Prostor pro ob\u011b fixn\xed tla\u010d\xedtka (P\u0159idat vybran\xe9 + Resetovat plochu) */\n\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n"]))),Qe=fe.A.div(z||(z=(0,ve.A)(["\n  margin-bottom: 8px;\n"]))),en=fe.A.div(w||(w=(0,ve.A)(["\n  padding: 10px 12px;\n  background: ",";\n  border-radius: 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #475569;\n  font-weight: 600;\n  font-size: 0.85rem;\n  transition: all 0.2s;\n\n  &:hover {\n    background: #f1f5f9;\n  }\n\n  svg:first-of-type {\n    width: 12px;\n  }\n"])),e=>e.expanded?"#f1f5f9":"transparent"),nn=fe.A.div(S||(S=(0,ve.A)(["\n  margin-top: 4px;\n  padding-left: 8px;\n  display: ",";\n"])),e=>e.expanded?"block":"none"),on=fe.A.div(A||(A=(0,ve.A)(["\n  padding: 10px 12px;\n  margin-bottom: 6px;\n  background: ",";\n  border: 2px solid ",";\n  border-radius: 8px;\n  cursor: grab;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  transition: all 0.2s;\n  color: ",";\n  box-shadow: ",";\n\n  &:hover {\n    border-color: #3b82f6;\n    transform: translateX(4px);\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n  }\n\n  &:active {\n    cursor: grabbing;\n  }\n"])),e=>e.isDragging?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"white",e=>e.isDragging?"#667eea":"#e0e6ed",e=>e.isDragging?"#fff":"#2c3e50",e=>e.isDragging?"0 8px 24px rgba(102, 126, 234, 0.3)":"0 1px 3px rgba(0,0,0,0.05)"),tn=fe.A.div(I||(I=(0,ve.A)(["\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 700;\n  font-size: 0.85rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n"]))),an=fe.A.div(T||(T=(0,ve.A)(["\n  flex: 1;\n  min-width: 0;\n"]))),ln=fe.A.div(C||(C=(0,ve.A)(["\n  font-weight: 600;\n  font-size: 0.9rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 2px;\n"]))),rn=fe.A.div(R||(R=(0,ve.A)(["\n  font-size: 0.75rem;\n  color: #64748b;\n  display: flex;\n  gap: 6px;\n  align-items: center;\n"]))),dn=(0,fe.A)(on)(E||(E=(0,ve.A)(["\n  cursor: ",";\n  opacity: ",";\n  transform: ",";\n  \n  &:hover {\n    transform: ",";\n  }\n"])),e=>e.isDragging?"grabbing":"grab",e=>e.isDragging?.8:1,e=>e.isDragging?"rotate(2deg) scale(1.05)":"none",e=>e.isDragging?"rotate(2deg) scale(1.05)":"translateX(4px)"),sn=fe.A.div(_||(_=(0,ve.A)(["\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  background: linear-gradient(135deg, #92400e 0%, #78350f 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(146, 64, 14, 0.3);\n"]))),cn=fe.A.div(L||(L=(0,ve.A)(["\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  background: linear-gradient(135deg, #059669 0%, #047857 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(5, 150, 105, 0.3);\n"]))),pn=fe.A.div(N||(N=(0,ve.A)(["\n  flex: 1;\n  position: relative;\n  background: #f5f7fa;\n  user-select: none; /* Zak\xe1zat v\xfdb\u011br textu v cel\xe9 canvas oblasti */\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  \n  /* Pointer kurzor p\u0159i hover nad nodem nebo edge */\n  .react-flow__node,\n  .react-flow__edge {\n    cursor: pointer !important;\n  }\n  \n  /* Crosshair p\u0159i SHIFT (selection mode) - NEJVY\u0160\u0160\xcd PRIORITA */\n  &.selection-mode .react-flow__pane,\n  &.selection-mode .react-flow__pane:hover,\n  &.selection-mode .react-flow__pane:active,\n  &.selection-mode .react-flow__pane:focus {\n    cursor: crosshair !important;\n  }\n  \n  /* V\xfdchoz\xed grab kurzor pro pan - JEN pokud NEN\xcd selection mode */\n  &:not(.selection-mode) .react-flow__pane {\n    cursor: grab !important;\n  }\n  \n  /* Grabbing kurzor p\u0159i aktivn\xedm panov\xe1n\xed - JEN pokud NEN\xcd selection mode */\n  &:not(.selection-mode) .react-flow__pane:active {\n    cursor: grabbing !important;\n  }\n  \n  /* Styl pro v\xfdb\u011brov\xfd obd\xe9ln\xedk (box-select) */\n  .react-flow__selection {\n    background: rgba(102, 126, 234, 0.08) !important;\n    border: 2px dashed #667eea !important;\n    border-radius: 8px !important;\n  }\n  \n  .react-flow__nodesselection {\n    background: transparent !important;\n    border: none !important;\n  }\n"]))),xn=fe.A.div(O||(O=(0,ve.A)(["\n  width: 380px;\n  background: white;\n  border-left: 1px solid #e0e6ed;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  box-shadow: -2px 0 8px rgba(0,0,0,0.05);\n"]))),un=fe.A.div(P||(P=(0,ve.A)(["\n  padding: 16px;\n  border-bottom: 1px solid #e0e6ed;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n"]))),hn=fe.A.h3(D||(D=(0,ve.A)(["\n  margin: 0;\n  color: white;\n  font-size: 1rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),gn=fe.A.button(V||(V=(0,ve.A)(["\n  background: rgba(255,255,255,0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(255,255,255,0.3);\n  }\n"]))),vn=fe.A.button(M||(M=(0,ve.A)(["\n  background: rgba(255,255,255,0.15);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  margin-left: auto;\n  margin-right: 8px;\n  font-size: 16px;\n\n  &:hover {\n    background: rgba(255,255,255,0.3);\n  }\n"]))),mn=fe.A.div(B||(B=(0,ve.A)(["\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 3px;\n  }\n  \n  /* Scrollbar pro email preview */\n  .email-preview-body {\n    &::-webkit-scrollbar {\n      width: 8px;\n    }\n    \n    &::-webkit-scrollbar-track {\n      background: #f1f5f9;\n      border-radius: 4px;\n    }\n    \n    &::-webkit-scrollbar-thumb {\n      background: #cbd5e1;\n      border-radius: 4px;\n      \n      &:hover {\n        background: #94a3b8;\n      }\n    }\n  }\n"]))),fn=fe.A.div(W||(W=(0,ve.A)(["\n  margin-bottom: 28px;\n"]))),bn=fe.A.h4(U||(U=(0,ve.A)(["\n  margin: 0 0 16px 0;\n  color: #475569;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  font-weight: 700;\n"]))),yn=fe.A.div(F||(F=(0,ve.A)(["\n  margin-bottom: 16px;\n"]))),jn=fe.A.label(H||(H=(0,ve.A)(["\n  display: block;\n  margin-bottom: 8px;\n  color: #475569;\n  font-size: 0.85rem;\n  font-weight: 600;\n"]))),kn=fe.A.input(K||(K=(0,ve.A)(["\n  width: 100%;\n  padding: 10px 12px;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  background: #f8fafc;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    background: white;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n\n  &:read-only {\n    background: #e2e8f0;\n    cursor: not-allowed;\n  }\n"]))),zn=fe.A.div(J||(J=(0,ve.A)(["\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  padding: 2px;\n  transition: all 0.2s;\n  \n  &:focus-within {\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n  \n  &:hover {\n    border-color: #d1d5db;\n  }\n"]))),wn=fe.A.select(Y||(Y=(0,ve.A)(["\n  flex: 1;\n  padding: 8px 12px;\n  border: none;\n  background: transparent;\n  color: #111827;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  outline: none;\n  appearance: none;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\");\n  background-position: right 8px center;\n  background-repeat: no-repeat;\n  background-size: 20px;\n  padding-right: 36px;\n  \n  option {\n    padding: 10px;\n    font-size: 0.875rem;\n  }\n"]))),Sn=fe.A.div(Z||(Z=(0,ve.A)(["\n  display: none;\n"]))),An=fe.A.button(G||(G=(0,ve.A)(["\n  padding: 4px 8px;\n  background: transparent;\n  border: 1px solid #e5e7eb;\n  color: ",";\n  cursor: ",";\n  font-size: 0.875rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s;\n  border-radius: 6px;\n  min-width: 32px;\n  height: 32px;\n  \n  &:hover:not(:disabled) {\n    background: #f9fafb;\n    border-color: #d1d5db;\n  }\n  \n  &:active:not(:disabled) {\n    background: #f3f4f6;\n  }\n"])),e=>e.disabled?"#d1d5db":"#6b7280",e=>e.disabled?"not-allowed":"pointer"),In=fe.A.select(X||(X=(0,ve.A)(["\n  width: 100%;\n  padding: 8px 16px;\n  border: 1px solid #e0e6ed;\n  border-radius: 6px;\n  background: white;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  box-sizing: border-box;\n  height: 40px;\n  font-weight: 500;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n"]))),Tn=fe.A.div($||($=(0,ve.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n"]))),Cn=fe.A.label(q||(q=(0,ve.A)(['\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 6px;\n  transition: background 0.2s;\n\n  &:hover {\n    background: #f8fafc;\n  }\n\n  input[type="checkbox"] {\n    width: 20px;\n    height: 20px;\n    cursor: pointer;\n    accent-color: #667eea;\n  }\n']))),Rn=(fe.A.div(Q||(Q=(0,ve.A)(["\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  margin-top: 8px;\n"]))),fe.A.div(ee||(ee=(0,ve.A)(["\n  padding: 6px 12px;\n  background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);\n  color: #667eea;\n  border-radius: 6px;\n  font-size: 0.85rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 500;\n  border: 1px solid #667eea30;\n\n  button {\n    background: none;\n    border: none;\n    color: inherit;\n    cursor: pointer;\n    padding: 0;\n    display: flex;\n    align-items: center;\n    opacity: 0.6;\n    transition: opacity 0.2s;\n\n    &:hover {\n      opacity: 1;\n    }\n  }\n"]))),fe.A.div(ne||(ne=(0,ve.A)(["\n  height: 1px;\n  background: #e0e6ed;\n  margin: 20px 0;\n"])))),En=fe.A.table(oe||(oe=(0,ve.A)(["\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 12px;\n  font-size: 0.9rem;\n\n  th {\n    background: #f8f9fa;\n    padding: 8px;\n    text-align: left;\n    font-weight: 600;\n    color: #495057;\n    border-bottom: 2px solid #dee2e6;\n  }\n\n  td {\n    padding: 8px;\n    border-bottom: 1px solid #e9ecef;\n  }\n\n  tr:hover {\n    background: #f8f9fa;\n  }\n\n  button {\n    background: none;\n    border: none;\n    color: #dc3545;\n    cursor: pointer;\n    padding: 4px;\n    display: flex;\n    align-items: center;\n    opacity: 0.7;\n    transition: opacity 0.2s;\n\n    &:hover {\n      opacity: 1;\n    }\n  }\n"]))),_n=fe.A.div(te||(te=(0,ve.A)(["\n  display: flex;\n  gap: 8px;\n  align-items: flex-end;\n  margin-top: 12px;\n\n  > div {\n    flex: 1;\n  }\n\n  button {\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-weight: 500;\n    transition: transform 0.2s, box-shadow 0.2s;\n    white-space: nowrap;\n\n    &:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n\n    &:active {\n      transform: translateY(0);\n    }\n  }\n"]))),Ln=fe.A.div(ie||(ie=(0,ve.A)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  animation: fadeIn 0.2s ease;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n"]))),Nn=fe.A.div(ae||(ae=(0,ve.A)(["\n  background: white;\n  border-radius: 16px;\n  padding: 32px;\n  max-width: 500px;\n  width: 90%;\n  box-shadow: 0 20px 60px rgba(0,0,0,0.3);\n  animation: slideUp 0.3s ease;\n\n  @keyframes slideUp {\n    from {\n      transform: translateY(20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n"]))),On=fe.A.div(le||(le=(0,ve.A)(["\n  font-size: 3rem;\n  text-align: center;\n  margin-bottom: 16px;\n"]))),Pn=fe.A.h2(re||(re=(0,ve.A)(["\n  margin: 0 0 12px 0;\n  color: #2c3e50;\n  font-size: 1.5rem;\n  text-align: center;\n"]))),Dn=fe.A.div(de||(de=(0,ve.A)(["\n  color: #64748b;\n  font-size: 0.95rem;\n  line-height: 1.6;\n  margin-bottom: 24px;\n  white-space: pre-line;\n"]))),Vn=fe.A.div(se||(se=(0,ve.A)(["\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n"]))),Mn=fe.A.button(ce||(ce=(0,ve.A)(["\n  padding: 10px 24px;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  border: none;\n  transition: all 0.2s;\n  \n  ","\n"])),e=>e.primary?"\n    background: #667eea;\n    color: white;\n    &:hover {\n      background: #5568d3;\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n  ":"\n    background: #e0e6ed;\n    color: #64748b;\n    &:hover {\n      background: #cbd5e1;\n    }\n  "),Bn=fe.A.div(pe||(pe=(0,ve.A)(["\n  background: #f8fafc;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  padding: 16px;\n  margin: 16px 0;\n  \n  div {\n    display: flex;\n    justify-content: space-between;\n    padding: 8px 0;\n    font-size: 0.9rem;\n    \n    &:not(:last-child) {\n      border-bottom: 1px solid #e0e6ed;\n    }\n    \n    strong {\n      color: #2c3e50;\n      font-weight: 600;\n    }\n    \n    span {\n      color: #667eea;\n      font-weight: 700;\n    }\n  }\n"]))),Wn=fe.A.div(xe||(xe=(0,ve.A)(["\n  max-height: 80vh;\n  overflow-y: auto;\n  padding: 0 4px;\n"]))),Un=fe.A.div(ue||(ue=(0,ve.A)(["\n  margin-bottom: 24px;\n  \n  h3 {\n    color: #2c3e50;\n    font-size: 1.1rem;\n    margin: 0 0 12px 0;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n  \n  p {\n    color: #64748b;\n    font-size: 0.9rem;\n    line-height: 1.6;\n    margin: 0 0 8px 0;\n  }\n  \n  code {\n    background: #f1f5f9;\n    padding: 2px 6px;\n    border-radius: 4px;\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #667eea;\n  }\n"]))),Fn=fe.A.div(he||(he=(0,ve.A)(["\n  background: #f8fafc;\n  border-left: 3px solid #667eea;\n  padding: 12px;\n  border-radius: 4px;\n  margin: 8px 0;\n  font-size: 0.9rem;\n  \n  strong {\n    color: #2c3e50;\n    display: block;\n    margin-bottom: 4px;\n  }\n  \n  span {\n    color: #64748b;\n  }\n"]))),Hn={custom:e=>{let{data:n,selected:o}=e;const t="template"===n.type,i="role"===n.type,a="location"===n.type,l="department"===n.type;return t?(0,Re.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",background:o?"linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)":"white",border:"3px solid ".concat("#f59e0b"),minWidth:"200px",boxShadow:o?"0 6px 16px rgba(245, 158, 11, 0.4)":"0 2px 8px rgba(245, 158, 11, 0.15)",transition:"all 0.2s",position:"relative",transform:o?"scale(1.05)":"scale(1)"},children:[(0,Re.jsx)(be.h7,{type:"source",position:be.yX.Right,style:{width:"16px",height:"16px",background:"#10b981",border:"3px solid white",boxShadow:"0 2px 8px rgba(16, 185, 129, 0.5)",cursor:"crosshair",right:"-10px"}}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,Re.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.3rem",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.3)"},children:"\ud83d\udd14"}),(0,Re.jsxs)("div",{style:{flex:1},children:[(0,Re.jsx)("div",{style:{fontWeight:700,color:"#78350f",fontSize:"0.85rem",marginBottom:"2px"},children:n.name}),(0,Re.jsx)("div",{style:{fontSize:"0.7rem",color:"#92400e",fontWeight:500},children:n.position})]})]})]}):i?(0,Re.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",background:o?"linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%)":"white",border:"3px solid ".concat("#8b5cf6"),minWidth:"200px",boxShadow:o?"0 6px 16px rgba(139, 92, 246, 0.4)":"0 2px 8px rgba(139, 92, 246, 0.15)",transition:"all 0.2s",position:"relative",transform:o?"scale(1.05)":"scale(1)"},children:[(0,Re.jsx)(be.h7,{type:"source",position:be.yX.Right,style:{width:"16px",height:"16px",background:"#10b981",border:"3px solid white",boxShadow:"0 2px 8px rgba(16, 185, 129, 0.5)",cursor:"crosshair",right:"-10px"}}),(0,Re.jsx)(be.h7,{type:"target",position:be.yX.Left,style:{width:"16px",height:"16px",background:"#ef4444",border:"3px solid white",boxShadow:"0 2px 8px rgba(239, 68, 68, 0.5)",cursor:"crosshair",left:"-10px"}}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,Re.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.3rem",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.3)",color:"white"},children:"\ud83d\udee1\ufe0f"}),(0,Re.jsxs)("div",{style:{flex:1},children:[(0,Re.jsx)("div",{style:{fontWeight:700,color:"#6d28d9",fontSize:"0.85rem",marginBottom:"2px"},children:n.name}),(0,Re.jsx)("div",{style:{fontSize:"0.7rem",color:"#8b5cf6",fontWeight:500},children:null!==(r=n.metadata)&&void 0!==r&&r.userCount?"\ud83d\udc65 ".concat(n.metadata.userCount," u\u017eivatel\u016f"):"Role"})]})]})]}):a||l?(0,Re.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",background:o?a?"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)":"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)":"white",border:"3px solid ".concat(a?"#92400e":"#059669"),minWidth:"160px",boxShadow:o?"0 6px 16px ".concat(a?"rgba(146, 64, 14, 0.4)":"rgba(5, 150, 105, 0.4)"):"0 2px 8px ".concat(a?"rgba(146, 64, 14, 0.15)":"rgba(5, 150, 105, 0.15)"),transition:"all 0.2s",position:"relative",transform:o?"scale(1.05)":"scale(1)",textAlign:"center"},children:[(0,Re.jsx)(be.h7,{type:"target",position:be.yX.Top,style:{width:"14px",height:"14px",background:a?"#92400e":"#059669",border:"2px solid white",boxShadow:"0 2px 6px ".concat(a?"rgba(146, 64, 14, 0.4)":"rgba(5, 150, 105, 0.4)"),cursor:"crosshair"}}),(0,Re.jsx)(be.h7,{type:"source",position:be.yX.Bottom,style:{width:"14px",height:"14px",background:a?"#92400e":"#059669",border:"2px solid white",boxShadow:"0 2px 6px ".concat(a?"rgba(146, 64, 14, 0.4)":"rgba(5, 150, 105, 0.4)"),cursor:"crosshair"}}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,Re.jsx)(ze.g,{icon:a?Ce.Pcr:Ce.BzA,style:{color:a?"#92400e":"#059669",fontSize:"1.1rem"}}),(0,Re.jsx)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:"0.9rem"},children:n.name})]})]}):(0,Re.jsxs)("div",{style:{padding:"14px",borderRadius:"12px",background:o?"linear-gradient(135deg, #dbeafe 0%, #e0f2fe 100%)":"white",border:"3px solid ".concat("#3b82f6"),minWidth:"220px",boxShadow:o?"0 8px 24px rgba(59, 130, 246, 0.5), 0 0 0 2px #93c5fd":"0 4px 12px rgba(59, 130, 246, 0.15)",transition:"all 0.2s",position:"relative",transform:o?"scale(1.02)":"scale(1)"},children:[(0,Re.jsx)(be.h7,{type:"target",position:be.yX.Top,style:{width:"16px",height:"16px",background:"#3b82f6",border:"3px solid white",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.4)",cursor:"crosshair"}}),(0,Re.jsx)(be.h7,{type:"source",position:be.yX.Bottom,style:{width:"16px",height:"16px",background:"#10b981",border:"3px solid white",boxShadow:"0 2px 8px rgba(16, 185, 129, 0.4)",cursor:"crosshair"}}),n.notifications&&(n.notifications.hasEmail||n.notifications.hasInApp)&&(0,Re.jsxs)("div",{style:{position:"absolute",top:"8px",right:"8px",display:"flex",gap:"4px",alignItems:"center"},children:[n.notifications.hasEmail&&(0,Re.jsx)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 6px rgba(102, 126, 234, 0.4)",cursor:"help"},title:"Email notifikace aktivn\xed",children:(0,Re.jsx)(ze.g,{icon:Ce.y_8,style:{color:"white",fontSize:"0.7rem"}})}),n.notifications.hasInApp&&(0,Re.jsx)("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 6px rgba(245, 87, 108, 0.4)",cursor:"help"},title:"In-app notifikace aktivn\xed",children:(0,Re.jsx)(ze.g,{icon:Ce.z$e,style:{color:"white",fontSize:"0.7rem"}})})]}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px"},children:[(0,Re.jsx)(tn,{children:n.initials}),(0,Re.jsxs)("div",{style:{flex:1},children:[(0,Re.jsx)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:"0.95rem",marginBottom:"2px"},children:n.name}),(0,Re.jsx)("div",{style:{fontSize:"0.8rem",color:"#64748b",fontWeight:500},children:n.position})]})]}),n.metadata&&(0,Re.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",paddingTop:"10px",borderTop:"1px solid #e0e6ed",display:"flex",flexDirection:"column",gap:"4px"},children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Re.jsx)(ze.g,{icon:Ce.Pcr,style:{color:"#f5576c"}}),n.metadata.location]}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Re.jsx)(ze.g,{icon:Ce.BzA,style:{color:"#00f2fe"}}),n.metadata.department]}),n.notifications&&n.notifications.types&&n.notifications.types.length>0&&(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"4px",paddingTop:"6px",borderTop:"1px dashed #e0e6ed"},children:[(0,Re.jsx)(ze.g,{icon:Ce.z$e,style:{color:"#667eea"}}),(0,Re.jsxs)("span",{style:{fontSize:"0.7rem",color:"#667eea",fontWeight:600},children:[n.notifications.types.length," typ",n.notifications.types.length>1?"y":""," notifikac\xed"]})]})]})]});var r}},Kn=e=>{let{mode:n,onClose:o,onSave:t,existingProfiles:i}=e;const[a,l]=me.useState(""),[r,d]=me.useState(""),[s,c]=me.useState(""),[p,x]=me.useState(!1),u=async()=>{x(!1),o()};return p?(0,Re.jsx)(Ln,{onClick:o,children:(0,Re.jsxs)(Nn,{onClick:e=>e.stopPropagation(),children:[(0,Re.jsx)(On,{children:"\u26a0\ufe0f"}),(0,Re.jsx)(Pn,{children:"Profil jiz existuje"}),(0,Re.jsxs)(Dn,{children:['Profil s nazvem "',(0,Re.jsx)("strong",{children:a}),'" jiz existuje.',(0,Re.jsx)("br",{}),(0,Re.jsx)("br",{}),"Chcete jej prepsat?"]}),(0,Re.jsxs)(Vn,{children:[(0,Re.jsx)(Mn,{onClick:()=>x(!1),children:"Zrusit"}),(0,Re.jsx)(Mn,{primary:!0,onClick:u,children:"Ano, prepsat"})]})]})}):(0,Re.jsx)(Ln,{onClick:o,children:(0,Re.jsxs)(Nn,{onClick:e=>e.stopPropagation(),style:{maxWidth:"500px"},children:[(0,Re.jsx)(On,{children:"\ud83d\udcbe"}),(0,Re.jsx)(Pn,{children:"saveAs"===n?"Ulozit jako novy profil":"Ulozit profil"}),(0,Re.jsxs)("div",{style:{padding:"20px",textAlign:"left"},children:[(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"Nazev profilu *"}),(0,Re.jsx)(kn,{type:"text",value:a,onChange:e=>{l(e.target.value),c("")},placeholder:"napr. ZZSSK 2025, DEV DEMO...",autoFocus:!0})]}),(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"Popis (volitelny)"}),(0,Re.jsx)("textarea",{value:r,onChange:e=>d(e.target.value),placeholder:"Strucny popis profilu...",rows:3,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #e0e6ed",fontSize:"0.95rem",fontFamily:"inherit",resize:"vertical"}})]}),s&&(0,Re.jsx)("div",{style:{padding:"10px",background:"#fee",border:"1px solid #fcc",borderRadius:"6px",color:"#c00",fontSize:"0.9rem",marginTop:"10px"},children:s})]}),(0,Re.jsxs)(Vn,{children:[(0,Re.jsx)(Mn,{onClick:o,children:"Zrusit"}),(0,Re.jsx)(Mn,{primary:!0,onClick:async()=>{if(!a.trim())return void c("Nazev profilu je povinny");const e=await t(a,r);e.exists?x(!0):e.error?c(e.error):o()},children:"Ulozit"})]})]})})},Jn=e=>{let{isOpen:n,onClose:o,emailData:t}=e;if(!n||!t)return null;const{template:i,mockData:a,replacePlaceholders:l,selectedVariantType:r}=t,d=((e,n)=>{if(!e)return e;if("DEFAULT"===n||!e.includes("\x3c!-- RECIPIENT:"))return e;const o="\x3c!-- RECIPIENT: ".concat(n," --\x3e"),t=e.indexOf(o);if(-1===t)return e;let i=t+o.length;const a=["APPROVER_NORMAL","APPROVER_URGENT","SUBMITTER"].filter(e=>e!==n).map(e=>"\x3c!-- RECIPIENT: ".concat(e," --\x3e"));let l=e.length;for(const r of a){const n=e.indexOf(r,i);-1!==n&&n<l&&(l=n)}return e.substring(i,l).trim()})(i.email_body,r||"DEFAULT");return(0,Re.jsx)(Ve,{onClick:o,style:{zIndex:2e4},children:(0,Re.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",width:"98vw",maxWidth:"1400px",height:"75vh",maxHeight:"calc(100vh - 140px)",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.4)",margin:"30px auto"},children:[(0,Re.jsxs)("div",{style:{padding:"16px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"12px 12px 0 0",flexShrink:0},children:[(0,Re.jsxs)("div",{children:[(0,Re.jsxs)("h2",{style:{margin:"0 0 6px 0",fontSize:"1.3rem",display:"flex",alignItems:"center",gap:"10px"},children:[(0,Re.jsx)(ze.g,{icon:Ce.y_8}),"Email \u0160ablona",r&&"DEFAULT"!==r&&({APPROVER_NORMAL:"\ud83d\udd34",APPROVER_URGENT:"\ud83d\udfe0",SUBMITTER:"\ud83d\udfe2"}[r]||"")]}),(0,Re.jsxs)("div",{style:{fontSize:"0.85rem",opacity:.95},children:[(0,Re.jsx)("strong",{children:"\u0160ablona:"})," ",i.name||"Bez n\xe1zvu",r&&"DEFAULT"!==r&&(0,Re.jsxs)(Re.Fragment,{children:[" \u2022 ",(0,Re.jsx)("strong",{children:"Varianta:"})," ","APPROVER_NORMAL"===r?"Schvalovatel (norm\xe1ln\xed)":"APPROVER_URGENT"===r?"Schvalovatel (mimo\u0159\xe1dn\xfd)":"SUBMITTER"===r?"Autor objedn\xe1vky":r]})]})]}),(0,Re.jsx)("button",{onClick:o,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",width:"40px",height:"40px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",transition:"all 0.2s"},onMouseEnter:e=>e.currentTarget.style.background="rgba(255,255,255,0.3)",onMouseLeave:e=>e.currentTarget.style.background="rgba(255,255,255,0.2)",children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})]}),(0,Re.jsxs)("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",background:"white"},children:[(0,Re.jsxs)("div",{style:{padding:"20px 30px",borderBottom:"1px solid #e5e7eb",background:"#fafbfc",flexShrink:0},children:[(0,Re.jsx)("div",{style:{marginBottom:"12px"},children:(0,Re.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#111827",lineHeight:"1.4"},children:l(i.email_subject||"Bez p\u0159edm\u011btu")})}),(0,Re.jsxs)("div",{style:{fontSize:"0.9rem",color:"#6b7280",marginBottom:"6px"},children:[(0,Re.jsx)("strong",{style:{color:"#374151"},children:"Od:"})," EEO Syst\xe9m <noreply@eeo.cz>"]}),(0,Re.jsxs)("div",{style:{fontSize:"0.9rem",color:"#6b7280"},children:[(0,Re.jsx)("strong",{style:{color:"#374151"},children:"Komu:"})," ",a.recipient_name||a.user_name," <",a.user_email,">"]}),(0,Re.jsx)("div",{style:{fontSize:"0.85rem",color:"#9ca3af",marginTop:"8px"},children:a.datetime})]}),(0,Re.jsx)("iframe",{title:"Email Preview",style:{width:"100%",flex:1,border:"none",background:"white",overflow:"hidden"},srcDoc:'\n              <!DOCTYPE html>\n              <html>\n              <head>\n                <meta charset="UTF-8">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <style>\n                  html, body {\n                    margin: 0;\n                    padding: 0;\n                    font-family: Arial, sans-serif;\n                    background: #f9fafb;\n                    overflow: visible;\n                    height: auto;\n                  }\n                </style>\n              </head>\n              <body>\n                '.concat(l(d||'<p style="color: #9ca3af; font-style: italic;">Email t\u011blo nen\xed definov\xe1no v \u0161ablon\u011b</p>'),"\n              </body>\n              </html>\n            ")})]})]})})},Yn=()=>{var e,n,t,i;(0,me.useRef)(null);const{showToast:a}=(0,me.useContext)(Te.$o),[l,r]=(0,me.useState)(!1);(0,me.useEffect)(()=>{const e=e=>{var n,o;(null!==(n=e.message)&&void 0!==n&&n.includes("useNodesState")||null!==(o=e.message)&&void 0!==o&&o.includes("useEdgesState"))&&(console.warn("ReactFlow HMR error - refresh needed"),r(!0))};return window.addEventListener("error",e),()=>window.removeEventListener("error",e)},[]);const[d,s]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_users")||""),[c,p]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_roles")||""),[x,u]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_locations")||""),[h,g]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_departments")||""),[v,m]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_templates")||""),[f,b]=(0,me.useState)(()=>{const e=localStorage.getItem("hierarchy_expanded_sections");return e?JSON.parse(e):{users:!0,roles:!1,locations:!1,departments:!1,notificationTemplates:!1}}),[y,j]=(0,me.useState)(null),[k,z]=(0,me.useState)(null),[w,S]=(0,me.useState)(!1),[A,I]=(0,me.useState)(!0),[T,C]=(0,me.useState)(null),[R,E,_]=(0,be.ck)([]),[L,N,O]=(0,be.fM)([]),[P,D]=(0,me.useState)(null),[V,M]=(0,me.useState)([]),[B,W]=(0,me.useState)([]),[U,F]=(0,me.useState)([]),[H,K]=(0,me.useState)([]),[J,Y]=(0,me.useState)([]),[Z,G]=(0,me.useState)([]),[X,$]=(0,me.useState)([]),[q,Q]=(0,me.useState)([]),[ee,ne]=(0,me.useState)(!1),[oe,te]=(0,me.useState)(!0),[ie,ae]=(0,me.useState)("APPROVAL"),[le,re]=(0,me.useState)("prime"),[de,se]=(0,me.useState)("OWN"),[ce,pe]=(0,me.useState)(""),[xe,ue]=(0,me.useState)(""),[he,ve]=(0,me.useState)(""),[fe,_e]=(0,me.useState)(""),[Yn,Zn]=(0,me.useState)({orders:"READ_ONLY",invoices:"READ_ONLY",contracts:"READ_ONLY",cashbook:"READ_ONLY"}),[Gn,Xn]=(0,me.useState)({orders:!0,invoices:!0,contracts:!1,cashbook:!0,cashbookReadonly:!0}),[$n,qn]=(0,me.useState)(!1),Qn=(0,me.useCallback)(e=>{ro(n=>(0,ge.A)((0,ge.A)({},n),{},{[e]:!n[e]}))},[]),eo=((0,me.useCallback)(()=>{ro({})},[]),(0,me.useCallback)((e,n,o)=>{if(!n)return e;const t=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.filter(e=>(e.name||e.label||e.nazev||String(e)).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))},[])),no=(0,me.useCallback)((e,n)=>"extendedLocations"===n||"extendedDepartments"===n?e.name+(e.code?" (".concat(e.code,")"):""):"notificationTypes"===n?e.name||e.label||String(e):e.name||e.label||e.nazev||String(e),[]),[oo,to]=(0,me.useState)([]),[io,ao]=(0,me.useState)([]),[lo,ro]=(0,me.useState)({}),[so,co]=(0,me.useState)({}),[po,xo]=(0,me.useState)({}),[uo,ho]=(0,me.useState)([]),[go,vo]=(0,me.useState)(null),[mo,fo]=(0,me.useState)(!1),[bo,yo]=(0,me.useState)("save");me.useEffect(()=>{k&&N(e=>e.map(e=>{var n;return e.id===k.id?(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{relationshipType:le,druh_vztahu:le,scope:de,modules:Gn,permissionLevel:Yn,extended:{locations:X,departments:oo,combinations:io},notifications:(0,ge.A)((0,ge.A)({},(null===(n=e.data)||void 0===n?void 0:n.notifications)||{}),{},{types:q,email:ee,inapp:oe,recipientRole:ie})})}):e}))},[X,oo,io,q,ee,oe,ie,le,de,Gn,Yn,k]),me.useEffect(()=>{var e;y&&"template"===(null===(e=y.data)||void 0===e?void 0:e.type)&&E(e=>e.map(e=>e.id===y.id?(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{normalVariant:ce,urgentVariant:xe,infoVariant:he,previewVariant:fe})}):e))},[ce,xe,he,fe,y]);const[jo,ko]=(0,me.useState)(new Set),[zo,wo]=(0,me.useState)(new Set),[So,Ao]=(0,me.useState)(new Set),[Io,To]=(0,me.useState)(new Set),[Co,Ro]=(0,me.useState)(new Set),[Eo,_o]=(0,me.useState)({isOpen:!1,title:"",message:"",onConfirm:null}),[Lo,No]=(0,me.useState)(()=>{const e=localStorage.getItem("hierarchy_help_collapsed");return!e||"false"===e}),[Oo,Po]=(0,me.useState)(!1),[Do,Vo]=(0,me.useState)(!1),[Mo,Bo]=(0,me.useState)(null),[Wo,Uo]=(0,me.useState)({show:!1,type:"confirm",icon:"\u2753",title:"",message:"",onConfirm:null,onCancel:null,confirmText:"Pokra\u010dovat",cancelText:"Zru\u0161it",stats:null}),Fo="hierarchy_draft_nodes",Ho="hierarchy_draft_edges",Ko="hierarchy_draft_timestamp",Jo="hierarchy_selected_profile",[Yo,Zo]=(0,me.useState)(!1);(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_search_users",d)},[d]),(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_search_locations",x)},[x]),(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_search_departments",h)},[h]),(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_search_templates",v)},[v]),(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_expanded_sections",JSON.stringify(f))},[f]),(0,me.useEffect)(()=>{if(R.length>0||L.length>0)try{localStorage.setItem(Fo,JSON.stringify(R)),localStorage.setItem(Ho,JSON.stringify(L)),localStorage.setItem(Ko,(new Date).toISOString())}catch(e){console.warn("Failed to save draft:",e)}},[R,L]);const Go=(0,me.useCallback)(()=>{const e=R.filter(e=>e.selected),n=L.filter(e=>e.selected);0===e.length&&0===n.length||Uo({show:!0,type:"confirm",icon:"\ud83d\uddd1\ufe0f",title:"Smazat vybran\xe9 prvky?",message:"Opravdu chcete smazat ".concat(e.length," uzl\u016f a ").concat(n.length," vztah\u016f?"),confirmText:"Smazat",cancelText:"Zru\u0161it",onConfirm:()=>{if(e.length>0){const n=e.map(e=>e.id);E(e=>e.filter(e=>!n.includes(e.id))),N(e=>e.filter(e=>!n.includes(e.source)&&!n.includes(e.target)))}if(n.length>0){const e=n.map(e=>e.id);N(n=>n.filter(n=>!e.includes(n.id)))}Uo((0,ge.A)((0,ge.A)({},Wo),{},{show:!1})),console.log("\u2705 Deleted ".concat(e.length," nodes and ").concat(n.length," edges"))},onCancel:()=>{Uo((0,ge.A)((0,ge.A)({},Wo),{},{show:!1}))}})},[R,L,E,N,Wo]);(0,me.useEffect)(()=>{const e=e=>{("Delete"===e.key||"Backspace"===e.key&&e.metaKey)&&(e.preventDefault(),Go())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[Go]),(0,me.useEffect)(()=>{const e=e=>{"Shift"!==e.key||$n||qn(!0)},n=e=>{"Shift"===e.key&&qn(!1)},o=()=>{qn(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",n),window.addEventListener("blur",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n),window.removeEventListener("blur",o)}},[$n]),(0,me.useEffect)(()=>{(async()=>{try{I(!0),C(null);let x=!1;try{const e=localStorage.getItem(Fo),n=localStorage.getItem(Ho),o=localStorage.getItem(Ko);if(e&&n&&o){const t=new Date(o);if((Date.now()-t.getTime())/36e5<24){const o=JSON.parse(e),t=JSON.parse(n);(o.length>0||t.length>0)&&(x=!0,Zo(!0),E(o),N(t))}else localStorage.removeItem(Fo),localStorage.removeItem(Ho),localStorage.removeItem(Ko)}}catch(p){console.warn("Failed to restore draft:",p)}const u=await Ie.jK.token(),h=await Ie.jK.user(),g=(null===h||void 0===h?void 0:h.username)||localStorage.getItem("username"),v="https://erdms.zachranka.cz/api.eeo/",m=async e=>{const n=await fetch("".concat(v,"/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:u,username:g})});if(!n.ok)throw new Error("HTTP ".concat(n.status,": ").concat(e));return n.json()},[f,b,y,j,k,z,w]=await Promise.all([m("hierarchy/users"),m("ciselniky/role/list"),m("hierarchy/locations"),m("hierarchy/departments"),m("hierarchy/profiles/list"),m("hierarchy/notification-types"),m("notifications/templates/list")]),S=f.data||[],A=(b.data||[]).map(e=>{const n=S.filter(n=>n.roles&&Array.isArray(n.roles)&&n.roles.includes(e.id)).length;return(0,ge.A)((0,ge.A)({},e),{},{userCount:n})});M(S),W(A),F(y.data||[]),K(j.data||[]),Y(z.data||[]),G(w.data||[]);const T=k.data||[];ho(T);let R=null;try{const{getGlobalSettings:e}=await o.e(8319).then(o.bind(o,58319)),n=await e(u,g);n.hierarchy_profile_id&&(R=T.find(e=>e.id===parseInt(n.hierarchy_profile_id)))}catch(p){console.warn("\u26a0\ufe0f Failed to load profile from Global Settings:",p)}var e;if(!R)R=T.find(e=>e.isActive)||T[0],console.log("\u26a0\ufe0f Using fallback profile (active or first):",null===(e=R)||void 0===e?void 0:e.name);vo(R||null);let _={success:!0,data:{nodes:[],relations:[]}};R&&(_=await fetch("".concat(Ee,"/hierarchy/structure"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:u,username:g,profilId:R.id})}).then(e=>e.json()));const L=_.data&&_.data.relations&&_.data.relations.length>0;if(L){var n,t,i,a,l,r,d,s,c;console.log("\ud83d\udd0d Structure data.data:",null===(n=_)||void 0===n?void 0:n.data),console.log("\ud83d\udd0d Structure data.data.nodes:",null===(t=_)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.nodes),console.log("\ud83d\udd0d Structure data.data.relations:",null===(a=_)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.relations);const e=Array.isArray(null===(r=_)||void 0===r||null===(d=r.data)||void 0===d?void 0:d.nodes)?_.data.nodes:[],o=Array.isArray(null===(s=_)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.relations)?_.data.relations:[];if(0===e.length&&0===o.length)return console.warn("\u26a0\ufe0f Empty structure data from API - will exit early"),void I(!1);const p=Date.now(),x=e.map((e,n)=>{let o,t;if("user"===e.type)o="user-".concat(e.userId,"-").concat(p,"-").concat(n),t={userId:String(e.userId),name:e.name,position:e.position,initials:e.initials,type:"user",metadata:e.metadata||{location:null,department:null}};else if("location"===e.type)o="location-".concat(e.locationId,"-").concat(p,"-").concat(n),t={locationId:e.locationId,name:e.name,type:"location"};else if("department"===e.type)o="department-".concat(e.departmentId,"-").concat(p,"-").concat(n),t={departmentId:e.departmentId,name:e.name,type:"department"};else if("template"===e.type){var i,a,l,r;o="template-".concat(e.templateId,"-").concat(p,"-").concat(n),t={templateId:e.templateId,name:e.name,position:"Notifika\u010dn\xed \u0161ablona",initials:"\ud83d\udd14",type:"template",normalVariant:(null===(i=e.settings)||void 0===i?void 0:i.normalVariant)||"",urgentVariant:(null===(a=e.settings)||void 0===a?void 0:a.urgentVariant)||"",infoVariant:(null===(l=e.settings)||void 0===l?void 0:l.infoVariant)||"",previewVariant:(null===(r=e.settings)||void 0===r?void 0:r.previewVariant)||"",metadata:{type:"template",template:e.name}}}else"role"===e.type&&(o="role-".concat(e.roleId,"-").concat(p,"-").concat(n),t={roleId:e.roleId,name:e.name,type:"role",metadata:{type:"role",popis:e.popis||"",userCount:e.userCount||0}});return{id:o,type:"custom",position:e.position_1||e.position_2||{x:100+n%4*250,y:50+200*Math.floor(n/4)},data:t}}),u=e=>e.includes("template")?"#f59e0b":e.includes("role")?"#8b5cf6":e.includes("location")?"#92400e":e.includes("department")?"#059669":"#3b82f6",h=o.map((e,n)=>{let o,t;const i=e.type,[a,l]=i.split("-");if("user"===a?o=x.find(n=>n.data.userId===String(e.user_id_1)):"role"===a?o=x.find(n=>n.data.roleId===e.role_id):"location"===a?o=x.find(n=>n.data.locationId===e.lokalita_id):"department"===a?o=x.find(n=>n.data.departmentId===e.usek_id):"template"===a&&(o=x.find(n=>n.data.templateId===e.template_id)),"user"===l?t=x.find(n=>n.data.userId===String(e.user_id_2||e.user_id_1)):"role"===l?t=x.find(n=>n.data.roleId===e.role_id):"location"===l?t=x.find(n=>n.data.locationId===e.lokalita_id):"department"===l?t=x.find(n=>n.data.departmentId===e.usek_id):"template"===l&&(t=x.find(n=>n.data.templateId===e.template_id)),!o||!t)return console.warn("\u26a0\ufe0f Relation node not found:",e),null;e.position_1&&(o.position=e.position_1),e.position_2&&(t.position=e.position_2);const r=u(i),d={1:"OWN",2:"TEAM",3:"LOCATION",4:"ALL"}[e.level]||"OWN";return{id:"rel-".concat(e.id||n),source:o.id,target:t.id,type:"smoothstep",animated:!0,markerEnd:{type:be.TG.ArrowClosed,color:r},style:{stroke:r,strokeWidth:3},data:{level:e.level,scope:d,relationshipType:e.relationshipType||e.druh_vztahu||"prime",druh_vztahu:e.relationshipType||e.druh_vztahu||"prime",visibility:e.visibility||{},modules:e.modules||{},permissionLevel:e.permissionLevel||{},extended:e.extended||{locations:[],departments:[],combinations:[]},notifications:e.notifications||{email:!1,inapp:!0,types:[],recipientRole:"APPROVAL"},type:i}}}).filter(e=>null!==e);E(x),N(h),localStorage.removeItem(Fo),localStorage.removeItem(Ho),localStorage.removeItem(Ko),Zo(!1)}else x?console.log("\ud83d\udcdd Using draft from localStorage"):console.log("\u26a0\ufe0f No data to load - empty profile");I(!1)}catch(p){console.error("Error loading hierarchy:",p),C(p.message),I(!1)}})()},[]),(0,me.useEffect)(()=>{go&&go.id&&(E([]),N([]),I(!0),setTimeout(()=>I(!1),500))},[null===go||void 0===go?void 0:go.id]),(0,me.useEffect)(()=>{R.length>0&&P&&setTimeout(()=>{P.fitView({padding:.2,duration:400})},100)},[R.length,P]);const Xo=(0,me.useCallback)(e=>{const n=R.find(n=>n.id===e.source),o=R.find(n=>n.id===e.target);let t="user-user";if(n&&o){var i,a;const e=(null===(i=n.data)||void 0===i?void 0:i.type)||"user",l=(null===(a=o.data)||void 0===a?void 0:a.type)||"user";t="".concat(e,"-").concat(l)}let l="#3b82f6";t.includes("template")?l="#f59e0b":t.includes("role")?l="#8b5cf6":t.includes("location")?l="#92400e":t.includes("department")?l="#059669":"user-user"===t&&(l="#3b82f6"),N(n=>(0,be.rN)((0,ge.A)((0,ge.A)({},e),{},{type:"smoothstep",animated:!0,markerEnd:{type:be.TG.ArrowClosed,color:l},style:{stroke:l,strokeWidth:3},data:{type:t}}),n))},[R]);(0,me.useEffect)(()=>{E(e=>e.map(e=>{var n;const o=null===(n=e.data)||void 0===n?void 0:n.type;if("role"===o||"location"===o||"department"===o){const n=L.filter(n=>n.target===e.id).map(e=>R.find(n=>n.id===e.source)).filter(e=>{var n;return"user"===(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.type)}).length;return(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{metadata:(0,ge.A)((0,ge.A)({},e.data.metadata),{},{userCount:n})})})}return e}))},[L,R.length]);const $o=(0,me.useCallback)((e,n)=>{var o;e.ctrlKey||e.metaKey?(S(!1),j(null),z(null)):(j(n),z(null),S(!0),"template"===(null===(o=n.data)||void 0===o?void 0:o.type)&&(pe(n.data.normalVariant||""),ue(n.data.urgentVariant||""),ve(n.data.infoVariant||""),_e(n.data.previewVariant||n.data.normalVariant||"")))},[]),qo=(0,me.useCallback)((e,n)=>{var o,t,i,a,l,r,d,s,c,p,x,u,h,g,v,m,f,b,y,k,w,A,I,T,C,E,_,L,N,O,P,D,V,M,B,W,U,F,H,K,J,Y,Z,G,X,q,ee,oe,ie,le,de,ce,pe,xe,ue,he,ve,me,fe,be,ye,je,ke,ze,we,Se,Ae,Ie,Te,Ce,Re,Ee,_e,Le,Ne,Oe,Pe,De,Ve,Me,Be,We,Ue,Fe;z(n),j(null),S(!0);const He=R.find(e=>e.id===n.source),Ke=R.find(e=>e.id===n.target),Je=(null===(o=n.data)||void 0===o||null===(t=o.extended)||void 0===t?void 0:t.locations)||(null===(i=n.data)||void 0===i||null===(a=i.permissions)||void 0===a||null===(l=a.extended)||void 0===l?void 0:l.locations)||[];$(Je);const Ye=(null===(r=n.data)||void 0===r||null===(d=r.extended)||void 0===d?void 0:d.departments)||(null===(s=n.data)||void 0===s||null===(c=s.permissions)||void 0===c||null===(p=c.extended)||void 0===p?void 0:p.departments)||[];to(Ye),ne((null===(x=n.data)||void 0===x||null===(u=x.notifications)||void 0===u?void 0:u.email)||!1),te(!1!==(null===(h=n.data)||void 0===h||null===(g=h.notifications)||void 0===g?void 0:g.inapp)),ae((null===(v=n.data)||void 0===v||null===(m=v.notifications)||void 0===m?void 0:m.recipientRole)||"APPROVAL"),re((null===(f=n.data)||void 0===f?void 0:f.relationshipType)||(null===(b=n.data)||void 0===b?void 0:b.druh_vztahu)||"prime"),se((null===(y=n.data)||void 0===y?void 0:y.scope)||"OWN"),Xn({orders:null!==(k=null!==(w=null===(A=n.data)||void 0===A||null===(I=A.modules)||void 0===I?void 0:I.orders)&&void 0!==w?w:null===(T=n.data)||void 0===T||null===(C=T.visibility)||void 0===C?void 0:C.objednavky)&&void 0!==k&&k,invoices:null!==(E=null!==(_=null===(L=n.data)||void 0===L||null===(N=L.modules)||void 0===N?void 0:N.invoices)&&void 0!==_?_:null===(O=n.data)||void 0===O||null===(P=O.visibility)||void 0===P?void 0:P.faktury)&&void 0!==E&&E,contracts:null!==(D=null!==(V=null===(M=n.data)||void 0===M||null===(B=M.modules)||void 0===B?void 0:B.contracts)&&void 0!==V?V:null===(W=n.data)||void 0===W||null===(U=W.visibility)||void 0===U?void 0:U.smlouvy)&&void 0!==D&&D,cashbook:null!==(F=null!==(H=null===(K=n.data)||void 0===K||null===(J=K.modules)||void 0===J?void 0:J.cashbook)&&void 0!==H?H:null===(Y=n.data)||void 0===Y||null===(Z=Y.visibility)||void 0===Z?void 0:Z.pokladna)&&void 0!==F&&F,cashbookReadonly:null!==(G=null===(X=n.data)||void 0===X||null===(q=X.modules)||void 0===q?void 0:q.cashbookReadonly)&&void 0!==G&&G,users:null!==(ee=null!==(oe=null===(ie=n.data)||void 0===ie||null===(le=ie.modules)||void 0===le?void 0:le.users)&&void 0!==oe?oe:null===(de=n.data)||void 0===de||null===(ce=de.visibility)||void 0===ce?void 0:ce.uzivatele)&&void 0!==ee&&ee,lp:null!==(pe=null!==(xe=null===(ue=n.data)||void 0===ue||null===(he=ue.modules)||void 0===he?void 0:he.lp)&&void 0!==xe?xe:null===(ve=n.data)||void 0===ve||null===(me=ve.visibility)||void 0===me?void 0:me.lp)&&void 0!==pe&&pe}),Zn({orders:(null===(fe=n.data)||void 0===fe||null===(be=fe.permissionLevel)||void 0===be?void 0:be.orders)||"READ_ONLY",invoices:(null===(ye=n.data)||void 0===ye||null===(je=ye.permissionLevel)||void 0===je?void 0:je.invoices)||"READ_ONLY",contracts:(null===(ke=n.data)||void 0===ke||null===(ze=ke.permissionLevel)||void 0===ze?void 0:ze.contracts)||"READ_ONLY",cashbook:(null===(we=n.data)||void 0===we||null===(Se=we.permissionLevel)||void 0===Se?void 0:Se.cashbook)||"READ_ONLY"});const Ze=(null===(Ae=n.data)||void 0===Ae||null===(Ie=Ae.extended)||void 0===Ie?void 0:Ie.combinations)||(null===(Te=n.data)||void 0===Te||null===(Ce=Te.permissions)||void 0===Ce||null===(Re=Ce.extended)||void 0===Re?void 0:Re.combinations)||[];ao(Ze);const Ge=(null===(Ee=n.data)||void 0===Ee||null===(_e=Ee.notifications)||void 0===_e?void 0:_e.types)||(null===(Le=n.data)||void 0===Le||null===(Ne=Le.permissions)||void 0===Ne||null===(Oe=Ne.notifications)||void 0===Oe?void 0:Oe.types)||[];Q(Ge),z((0,ge.A)((0,ge.A)({},n),{},{metadata:{sourceName:(null===He||void 0===He||null===(Pe=He.data)||void 0===Pe?void 0:Pe.name)||"Neznamy",targetName:(null===Ke||void 0===Ke||null===(De=Ke.data)||void 0===De?void 0:De.name)||"Neznamy",sourceType:(null===He||void 0===He||null===(Ve=He.data)||void 0===Ve||null===(Me=Ve.metadata)||void 0===Me?void 0:Me.type)||(null===He||void 0===He||null===(Be=He.data)||void 0===Be?void 0:Be.type)||"user",targetType:(null===Ke||void 0===Ke||null===(We=Ke.data)||void 0===We||null===(Ue=We.metadata)||void 0===Ue?void 0:Ue.type)||(null===Ke||void 0===Ke||null===(Fe=Ke.data)||void 0===Fe?void 0:Fe.type)||"user"}}))},[R]),Qo=(0,me.useCallback)((e,n)=>{const o={"user-user":{label:"U\u017eivatel \u2192 U\u017eivatel",icon:"\ud83d\udc64\u2192\ud83d\udc64",description:"Klasick\xfd nad\u0159\xedzen\xfd-pod\u0159\xedzen\xfd vztah",sourceLabel:"Nad\u0159\xedzen\xfd (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"Pod\u0159\xedzen\xfd (sd\xedl\xed data)",showScope:!0,showExtended:!0,showModules:!0,explanation:(e,n)=>"".concat(e," z\xedsk\xe1 pr\xe1va vid\u011bt data od ").concat(n," podle nastaven\xed rozsahu a modul\u016f.")},"location-user":{label:"Lokalita \u2192 U\u017eivatel",icon:"\ud83d\udccd\u2192\ud83d\udc64",description:"V\u0161ichni u\u017eivatel\xe9 z lokality sd\xedl\xed data nad\u0159\xedzen\xe9mu",sourceLabel:"Lokalita (zdroj dat)",targetLabel:"Nad\u0159\xedzen\xfd u\u017eivatel (z\xedsk\xe1v\xe1 data)",showScope:!1,showExtended:!1,showModules:!0,explanation:(e,n)=>"".concat(n," z\xedsk\xe1 pr\xe1va vid\u011bt data od V\u0160ECH u\u017eivatel\u016f v lokalit\u011b ").concat(e,".")},"user-location":{label:"U\u017eivatel \u2192 Lokalita",icon:"\ud83d\udc64\u2192\ud83d\udccd",description:"Nad\u0159\xedzen\xfd vid\xed v\u0161echny u\u017eivatele v lokalit\u011b",sourceLabel:"Nad\u0159\xedzen\xfd u\u017eivatel (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"Lokalita (zdroj dat)",showScope:!1,showExtended:!0,showModules:!0,explanation:(e,n)=>"".concat(e," z\xedsk\xe1 pr\xe1va vid\u011bt data od V\u0160ECH u\u017eivatel\u016f v lokalit\u011b ").concat(n,".")},"department-user":{label:"\xdasek \u2192 U\u017eivatel",icon:"\ud83c\udfe2\u2192\ud83d\udc64",description:"V\u0161ichni u\u017eivatel\xe9 z \xfaseku sd\xedl\xed data nad\u0159\xedzen\xe9mu",sourceLabel:"\xdasek (zdroj dat)",targetLabel:"Nad\u0159\xedzen\xfd u\u017eivatel (z\xedsk\xe1v\xe1 data)",showScope:!1,showExtended:!1,showModules:!0,explanation:(e,n)=>"".concat(n," z\xedsk\xe1 pr\xe1va vid\u011bt data od V\u0160ECH u\u017eivatel\u016f v \xfaseku ").concat(e,".")},"user-department":{label:"U\u017eivatel \u2192 \xdasek",icon:"\ud83d\udc64\u2192\ud83c\udfe2",description:"Nad\u0159\xedzen\xfd vid\xed v\u0161echny u\u017eivatele v \xfaseku",sourceLabel:"Nad\u0159\xedzen\xfd u\u017eivatel (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"\xdasek (zdroj dat)",showScope:!1,showExtended:!0,showModules:!0,explanation:(e,n)=>"".concat(e," z\xedsk\xe1 pr\xe1va vid\u011bt data od V\u0160ECH u\u017eivatel\u016f v \xfaseku ").concat(n,".")},"template-user":{label:"Notifika\u010dn\xed \u0161ablona \u2192 U\u017eivatel",icon:"\ud83d\udce7\u2192\ud83d\udc64",description:"U\u017eivatel bude dost\xe1vat notifikace z t\xe9to \u0161ablony",sourceLabel:"Notifika\u010dn\xed \u0161ablona",targetLabel:"P\u0159\xedjemce (u\u017eivatel)",showScope:!1,showExtended:!1,showModules:!1,explanation:(e,n)=>"".concat(n,' bude dost\xe1vat notifikace typu "').concat(e,'".')},"template-location":{label:"Notifika\u010dn\xed \u0161ablona \u2192 Lokalita",icon:"\ud83d\udce7\u2192\ud83d\udccd",description:"V\u0161ichni u\u017eivatel\xe9 v lokalit\u011b budou dost\xe1vat notifikace",sourceLabel:"Notifika\u010dn\xed \u0161ablona",targetLabel:"P\u0159\xedjemci (lokalita)",showScope:!1,showExtended:!1,showModules:!1,explanation:(e,n)=>"V\u0160ICHNI u\u017eivatel\xe9 v lokalit\u011b ".concat(n,' budou dost\xe1vat notifikace typu "').concat(e,'".')},"template-department":{label:"Notifika\u010dn\xed \u0161ablona \u2192 \xdasek",icon:"\ud83d\udce7\u2192\ud83c\udfe2",description:"V\u0161ichni u\u017eivatel\xe9 v \xfaseku budou dost\xe1vat notifikace",sourceLabel:"Notifika\u010dn\xed \u0161ablona",targetLabel:"P\u0159\xedjemci (\xfasek)",showScope:!1,showExtended:!1,showModules:!1,explanation:(e,n)=>"V\u0160ICHNI u\u017eivatel\xe9 v \xfaseku ".concat(n,' budou dost\xe1vat notifikace typu "').concat(e,'".')},"user-role":{label:"U\u017eivatel \u2192 Role",icon:"\ud83d\udc64\u2192\ud83d\udee1\ufe0f",description:"U\u017eivatel z\xedsk\xe1v\xe1 opr\xe1vn\u011bn\xed z role",sourceLabel:"U\u017eivatel (p\u0159\xedjemce pr\xe1v)",targetLabel:"Role (zdroj opr\xe1vn\u011bn\xed)",showScope:!1,showExtended:!1,showModules:!0,explanation:(e,n)=>"".concat(e," m\xe1 p\u0159i\u0159azenou roli ").concat(n," a z\xedsk\xe1v\xe1 z n\xed opr\xe1vn\u011bn\xed pro moduly.")},"role-user":{label:"Role \u2192 U\u017eivatel",icon:"\ud83d\udee1\ufe0f\u2192\ud83d\udc64",description:"Role p\u0159i\u0159azuje opr\xe1vn\u011bn\xed u\u017eivateli",sourceLabel:"Role (zdroj opr\xe1vn\u011bn\xed)",targetLabel:"U\u017eivatel (p\u0159\xedjemce pr\xe1v)",showScope:!1,showExtended:!1,showModules:!0,explanation:(e,n)=>"Role ".concat(e," p\u0159i\u0159azuje opr\xe1vn\u011bn\xed u\u017eivateli ").concat(n,".")},"template-role":{label:"Notifika\u010dn\xed \u0161ablona \u2192 Role",icon:"\ud83d\udce7\u2192\ud83d\udee1\ufe0f",description:"V\u0161ichni u\u017eivatel\xe9 s rol\xed budou dost\xe1vat notifikace",sourceLabel:"Notifika\u010dn\xed \u0161ablona",targetLabel:"P\u0159\xedjemci (role)",showScope:!1,showExtended:!1,showModules:!1,explanation:(e,n)=>"V\u0160ICHNI u\u017eivatel\xe9 s rol\xed ".concat(n,' budou dost\xe1vat notifikace typu "').concat(e,'".')},"department-role":{label:"\xdasek \u2192 Role",icon:"\ud83c\udfe2\u2192\ud83d\udee1\ufe0f",description:"U\u017eivatel\xe9 s danou rol\xed v \xfaseku z\xedsk\xe1vaj\xed viditelnost dat",sourceLabel:"\xdasek (zdroj dat)",targetLabel:"Role (z\xedsk\xe1v\xe1 pr\xe1va)",showScope:!0,showExtended:!1,showModules:!0,explanation:(e,n)=>"V\u0161ichni u\u017eivatel\xe9 s rol\xed ".concat(n," z\xedskaj\xed pr\xe1va vid\u011bt data z \xfaseku ").concat(e,".")},"role-department":{label:"Role \u2192 \xdasek",icon:"\ud83d\udee1\ufe0f\u2192\ud83c\udfe2",description:"Role z\xedsk\xe1v\xe1 viditelnost dat z \xfaseku",sourceLabel:"Role (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"\xdasek (zdroj dat)",showScope:!0,showExtended:!1,showModules:!0,explanation:(e,n)=>"U\u017eivatel\xe9 s rol\xed ".concat(e," z\xedskaj\xed pr\xe1va vid\u011bt data z \xfaseku ").concat(n,".")},"location-role":{label:"Lokalita \u2192 Role",icon:"\ud83d\udccd\u2192\ud83d\udee1\ufe0f",description:"U\u017eivatel\xe9 s danou rol\xed v lokalit\u011b z\xedsk\xe1vaj\xed viditelnost dat",sourceLabel:"Lokalita (zdroj dat)",targetLabel:"Role (z\xedsk\xe1v\xe1 pr\xe1va)",showScope:!0,showExtended:!1,showModules:!0,explanation:(e,n)=>"V\u0161ichni u\u017eivatel\xe9 s rol\xed ".concat(n," z\xedskaj\xed pr\xe1va vid\u011bt data z lokality ").concat(e,".")},"role-location":{label:"Role \u2192 Lokalita",icon:"\ud83d\udee1\ufe0f\u2192\ud83d\udccd",description:"Role z\xedsk\xe1v\xe1 viditelnost dat z lokality",sourceLabel:"Role (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"Lokalita (zdroj dat)",showScope:!0,showExtended:!1,showModules:!0,explanation:(e,n)=>"U\u017eivatel\xe9 s rol\xed ".concat(e," z\xedskaj\xed pr\xe1va vid\u011bt data z lokality ").concat(n,".")},"role-role":{label:"Role \u2192 Role",icon:"\ud83d\udee1\ufe0f\u2192\ud83d\udee1\ufe0f",description:"Hierarchick\xfd vztah mezi rolemi (nad\u0159\xedzen\xe1 \u2192 pod\u0159\xedzen\xe1)",sourceLabel:"Nad\u0159\xedzen\xe1 role (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"Pod\u0159\xedzen\xe1 role (sd\xedl\xed data)",showScope:!0,showExtended:!0,showModules:!0,explanation:(e,n)=>"".concat(e," z\xedsk\xe1 pr\xe1va vid\u011bt data od u\u017eivatel\u016f s rol\xed ").concat(n,". Rozsah a Moduly ur\u010duj\xed, co p\u0159esn\u011b uvid\xed (objedn\xe1vky/faktury/pokladnu).")}};return o["".concat(e,"-").concat(n)]||o["user-user"]},[]),et=(0,me.useCallback)(async(e,n)=>{console.log("\ud83c\udfaf Node drag stopped:",n.id,"Position:",n.position);const o=R.find(e=>e.id===n.id);var t;o&&console.log("\ud83d\udccd Updated node position saved to local state:",{id:o.id,userId:null===(t=o.data)||void 0===t?void 0:t.userId,position:o.position})},[R]),nt=e=>{b(n=>(0,ge.A)((0,ge.A)({},n),{},{[e]:!n[e]}))},ot=e=>{Ro(n=>{const o=new Set(n);return o.has(e)?o.delete(e):o.add(e),o})},[tt,it]=me.useState(null),at=function(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TB";const t=new Se.graphlib.Graph;t.setDefaultEdgeLabel(()=>({}));t.setGraph({rankdir:o,nodesep:80,ranksep:120,marginx:50,marginy:50}),e.forEach(e=>{t.setNode(e.id,{width:200,height:120})}),n.forEach(e=>{t.setEdge(e.source,e.target)}),Ae().layout(t);return{nodes:e.map(e=>{const n=t.node(e.id);return(0,ge.A)((0,ge.A)({},e),{},{position:{x:n.x-100,y:n.y-60}})}),edges:n}},lt=e=>{if(console.log("\ud83e\udd16 AI: Reorganizing hierarchy from SELECTED NODES on canvas...",e.length),0===e.length)return;const n=e.find(e=>{var n;const o=(null===(n=e.data.position)||void 0===n?void 0:n.toLowerCase())||"";return"\u0159editel"===o||"\u0159editelka"===o}),o=e.filter(e=>{var n;return null===(n=e.data.position)||void 0===n?void 0:n.toLowerCase().includes("n\xe1m\u011bstek")}),t=e.filter(e=>{var n;return null===(n=e.data.position)||void 0===n?void 0:n.toLowerCase().includes("vedouc\xed")}),i=e.filter(e=>{var n,o,t;return!(null!==(n=e.data.position)&&void 0!==n&&n.toLowerCase().includes("\u0159editel"))&&!(null!==(o=e.data.position)&&void 0!==o&&o.toLowerCase().includes("n\xe1m\u011bstek"))&&!(null!==(t=e.data.position)&&void 0!==t&&t.toLowerCase().includes("vedouc\xed"))}),a=[],l=Date.now();n&&(o.forEach(e=>{a.push({id:"e-".concat(n.id,"-").concat(e.id,"-").concat(l),source:n.id,target:e.id,type:"smoothstep",animated:!0,markerEnd:{type:be.TG.ArrowClosed},style:{stroke:"#667eea",strokeWidth:3}})}),t.forEach(e=>{const t=o.find(n=>{var o,t;return(null===(o=n.data.metadata)||void 0===o?void 0:o.department)===(null===(t=e.data.metadata)||void 0===t?void 0:t.department)})||n;a.push({id:"e-".concat(t.id,"-").concat(e.id,"-").concat(l),source:t.id,target:e.id,type:"smoothstep",animated:!0,markerEnd:{type:be.TG.ArrowClosed},style:{stroke:"#667eea",strokeWidth:3}})}));const r=new Set(e.map(e=>e.id)),d=[...L.filter(e=>!r.has(e.source)||!r.has(e.target)),...a],{nodes:s,edges:c}=at(R,d,"TB");E(s),N(c),Uo({show:!0,type:"success",icon:"\u2705",title:"Hierarchie reorganizov\xe1na!",message:"Vybran\xe9 nody (".concat(e.length,") byly reorganizov\xe1ny podle rol\xed.\nZkontrolujte strukturu a p\u0159\xedpadn\u011b upravte."),stats:{"\u0158editel":n?"1":"0","N\xe1m\u011bstci":o.length,"Vedouc\xed":t.length,"Ostatn\xed":i.length,"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":"\u2500\u2500\u2500\u2500\u2500","Nov\xe9 vztahy":a.length},onConfirm:()=>Uo(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null})},rt=async()=>{try{const e=await Ie.jK.token(),n=await Ie.jK.user(),o=(null===n||void 0===n?void 0:n.username)||localStorage.getItem("username"),t="https://erdms.zachranka.cz/api.eeo/",i=await fetch("".concat(t,"/hierarchy/profiles/list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,username:o})}),a=await i.json();if(a.success){ho(a.data||[]);const e=a.data.find(e=>e.isActive)||a.data[0];vo(e||null)}}catch(e){console.error("Failed to load profiles:",e)}},dt=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const J=await Ie.jK.token(),Y=await Ie.jK.user(),Z=(null===Y||void 0===Y?void 0:Y.username)||localStorage.getItem("username"),G="https://erdms.zachranka.cz/api.eeo/",X=e||(null===go||void 0===go?void 0:go.id)||1;console.log("\ud83d\udcca V2 SAVE START - Current state:",{totalNodes:R.length,totalEdges:L.length,nodes:R.map(e=>{var n,o,t;return{id:e.id,userId:null===(n=e.data)||void 0===n?void 0:n.userId,locationId:null===(o=e.data)||void 0===o?void 0:o.locationId,type:(null===(t=e.data)||void 0===t?void 0:t.type)||e.type}}),edges:L.map(e=>({id:e.id,source:e.source,target:e.target}))});const $=[];for(const e of L){var n,o,t,i,l,r,d,s,c,p,x,u,h,g,v,m,f,b,y,j,k,z,w,S,A,I,T,C,E,_,N,O,P,D,V,M,B,W,U,F,H,K;const a=R.find(n=>n.id===e.source),L=R.find(n=>n.id===e.target);if(!a||!L){console.warn("\u26a0\ufe0f Skipping edge - node not found:",e.id);continue}const J=e=>{var n,o,t,i,a;return null!==(n=e.data)&&void 0!==n&&n.type?e.data.type:null!==(o=e.data)&&void 0!==o&&o.userId?"user":null!==(t=e.data)&&void 0!==t&&t.locationId?"location":null!==(i=e.data)&&void 0!==i&&i.departmentId?"department":null!==(a=e.data)&&void 0!==a&&a.templateId?"template":"user"},Y=J(a),Z=J(L),G={OWN:1,TEAM:2,LOCATION:3,ALL:4}[(null===(n=e.data)||void 0===n?void 0:n.scope)||"OWN"]||(null===(o=e.data)||void 0===o?void 0:o.level)||1,X={type:"".concat(Y,"-").concat(Z),position_1:a.position,position_2:L.position,level:G,relationshipType:(null===(t=e.data)||void 0===t?void 0:t.relationshipType)||(null===(i=e.data)||void 0===i?void 0:i.druh_vztahu)||"prime",druh_vztahu:(null===(l=e.data)||void 0===l?void 0:l.relationshipType)||(null===(r=e.data)||void 0===r?void 0:r.druh_vztahu)||"prime",visibility:{objednavky:(null===(d=e.data)||void 0===d||null===(s=d.modules)||void 0===s?void 0:s.orders)||(null===(c=e.data)||void 0===c||null===(p=c.visibility)||void 0===p?void 0:p.objednavky)||!1,faktury:(null===(x=e.data)||void 0===x||null===(u=x.modules)||void 0===u?void 0:u.invoices)||(null===(h=e.data)||void 0===h||null===(g=h.visibility)||void 0===g?void 0:g.faktury)||!1,smlouvy:(null===(v=e.data)||void 0===v||null===(m=v.modules)||void 0===m?void 0:m.contracts)||(null===(f=e.data)||void 0===f||null===(b=f.visibility)||void 0===b?void 0:b.smlouvy)||!1,pokladna:(null===(y=e.data)||void 0===y||null===(j=y.modules)||void 0===j?void 0:j.cashbook)||(null===(k=e.data)||void 0===k||null===(z=k.visibility)||void 0===z?void 0:z.pokladna)||!1,uzivatele:(null===(w=e.data)||void 0===w||null===(S=w.modules)||void 0===S?void 0:S.users)||(null===(A=e.data)||void 0===A||null===(I=A.visibility)||void 0===I?void 0:I.uzivatele)||!1,lp:(null===(T=e.data)||void 0===T||null===(C=T.modules)||void 0===C?void 0:C.lp)||(null===(E=e.data)||void 0===E||null===(_=E.visibility)||void 0===_?void 0:_.lp)||!1},modules:(null===(N=e.data)||void 0===N?void 0:N.modules)||{},permissionLevel:(null===(O=e.data)||void 0===O?void 0:O.permissionLevel)||{},extended:(null===(P=e.data)||void 0===P?void 0:P.extended)||{locations:[],departments:[],combinations:[]},notifications:(null===(D=e.data)||void 0===D?void 0:D.notifications)||{email:!1,inapp:!1,types:[],recipientRole:"APPROVAL"},node_settings:{source:{normalVariant:(null===(V=a.data)||void 0===V?void 0:V.normalVariant)||null,urgentVariant:(null===(M=a.data)||void 0===M?void 0:M.urgentVariant)||null,infoVariant:(null===(B=a.data)||void 0===B?void 0:B.infoVariant)||null,previewVariant:(null===(W=a.data)||void 0===W?void 0:W.previewVariant)||null},target:{normalVariant:(null===(U=L.data)||void 0===U?void 0:U.normalVariant)||null,urgentVariant:(null===(F=L.data)||void 0===F?void 0:F.urgentVariant)||null,infoVariant:(null===(H=L.data)||void 0===H?void 0:H.infoVariant)||null,previewVariant:(null===(K=L.data)||void 0===K?void 0:K.previewVariant)||null}}};"user"===Y?X.user_id_1=parseInt(a.data.userId):"location"===Y?X.lokalita_id=parseInt(a.data.locationId):"department"===Y?X.usek_id=parseInt(a.data.departmentId):"template"===Y?X.template_id=parseInt(a.data.templateId):"role"===Y&&(X.role_id=parseInt(a.data.roleId)),"user"===Z?X.user_id_2=parseInt(L.data.userId):"location"===Z?X.lokalita_id=parseInt(L.data.locationId):"department"===Z?X.usek_id=parseInt(L.data.departmentId):"template"===Z?X.template_id=parseInt(L.data.templateId):"role"===Z&&(X.role_id=parseInt(L.data.roleId)),console.log("\u2705 Relation:",X),$.push(X)}const q={token:J,username:Z,profile_id:X,relations:$,nodes:R.map(e=>{var n,o,t,i,a,l,r,d,s,c;return{id:e.id,type:(null===(n=e.data)||void 0===n?void 0:n.type)||"user",userId:(null===(o=e.data)||void 0===o?void 0:o.userId)||null,locationId:(null===(t=e.data)||void 0===t?void 0:t.locationId)||null,departmentId:(null===(i=e.data)||void 0===i?void 0:i.departmentId)||null,templateId:(null===(a=e.data)||void 0===a?void 0:a.templateId)||null,roleId:(null===(l=e.data)||void 0===l?void 0:l.roleId)||null,position:e.position,settings:{normalVariant:(null===(r=e.data)||void 0===r?void 0:r.normalVariant)||null,urgentVariant:(null===(d=e.data)||void 0===d?void 0:d.urgentVariant)||null,infoVariant:(null===(s=e.data)||void 0===s?void 0:s.infoVariant)||null,previewVariant:(null===(c=e.data)||void 0===c?void 0:c.previewVariant)||null}}})};console.log("\ud83d\udcca V2 SAVE START - Current state:",{totalNodes:R.length,totalEdges:L.length,nodes:R.map(e=>{var n,o;return{id:e.id,userId:null===(n=e.data)||void 0===n?void 0:n.userId,type:null===(o=e.data)||void 0===o?void 0:o.type}}),edges:L.map(e=>({id:e.id,source:e.source,target:e.target}))}),console.log("\ud83d\udcbe V2 SAVE - Payload:",JSON.stringify(q,null,2));const Q=await fetch("".concat(G,"/hierarchy/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(console.log("\ud83d\udce1 SAVE Response status:",Q.status,Q.statusText),!Q.ok){const e=await Q.text();throw console.error("\u274c SAVE Error response:",e),new Error("Chyba pri ukladani")}const ee=await Q.json();if(console.log("\u2705 SAVE Result:",ee),!ee.success)throw console.error("\u274c SAVE Failed:",ee.error,ee.details),new Error(ee.error||"Neznama chyba");if(localStorage.removeItem(Fo),localStorage.removeItem(Ho),localStorage.removeItem(Ko),Zo(!1),ee.profile_id&&ee.profile_id!==(null===go||void 0===go?void 0:go.id)){const e=uo.find(e=>e.id===ee.profile_id);e&&(vo(e),localStorage.setItem(Jo,e.id.toString()),console.log("\ud83d\udd04 Automaticky p\u0159epnuto na profil:",e.name))}a("\u2705 Hierarchie \xfasp\u011b\u0161n\u011b ulo\u017eena! Ulo\u017eeno ".concat(R.length," uzl\u016f a ").concat(L.length," vztah\u016f."),{type:"success",timeout:5e3})}catch(J){console.error("\ud83d\udca5 SAVE Exception:",J),Uo({show:!0,type:"alert",icon:"\u274c",title:"Chyba pri ukladani",message:J.message,onConfirm:()=>Uo(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null})}},st=V.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.position.toLowerCase().includes(d.toLowerCase())||e.location.toLowerCase().includes(d.toLowerCase())),ct=B.filter(e=>e.nazev_role.toLowerCase().includes(c.toLowerCase())||e.popis&&e.popis.toLowerCase().includes(c.toLowerCase())),pt=U.filter(e=>e.name.toLowerCase().includes(x.toLowerCase())||e.code.toLowerCase().includes(x.toLowerCase())),xt=H.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())||e.code.toLowerCase().includes(h.toLowerCase())),ut=Z.filter(e=>e.name.toLowerCase().includes(v.toLowerCase())||e.description&&e.description.toLowerCase().includes(v.toLowerCase()));return l?(0,Re.jsxs)(Le,{children:[(0,Re.jsx)(Ne,{children:(0,Re.jsxs)(Oe,{children:[(0,Re.jsx)(ze.g,{icon:Ce.FFg}),"Syst\xe9m workflow a notifikac\xed"]})}),(0,Re.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#f59e0b",fontSize:"1.1rem"},children:(0,Re.jsxs)("div",{style:{textAlign:"center"},children:[(0,Re.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\u26a0\ufe0f"}),(0,Re.jsx)("div",{style:{marginBottom:"1rem"},children:"Hot-reload chyba detekov\xe1na"}),(0,Re.jsx)("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"600"},children:"Obnovit str\xe1nku (F5)"})]})})]}):A?(0,Re.jsxs)(Le,{children:[(0,Re.jsx)(Ne,{children:(0,Re.jsxs)(Oe,{children:[(0,Re.jsx)(ze.g,{icon:Ce.FFg}),"Syst\xe9m workflow a notifikac\xed"]})}),(0,Re.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#64748b",fontSize:"1.1rem"},children:(0,Re.jsxs)("div",{style:{textAlign:"center"},children:[(0,Re.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\u23f3"}),(0,Re.jsx)("div",{children:"Na\u010d\xedt\xe1n\xed hierarchie..."})]})})]}):T?(0,Re.jsxs)(Le,{children:[(0,Re.jsx)(Ne,{children:(0,Re.jsxs)(Oe,{children:[(0,Re.jsx)(ze.g,{icon:Ce.FFg}),"Syst\xe9m workflow a notifikac\xed"]})}),(0,Re.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#ef4444",fontSize:"1.1rem"},children:(0,Re.jsxs)("div",{style:{textAlign:"center"},children:[(0,Re.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\u274c"}),(0,Re.jsxs)("div",{children:["Chyba p\u0159i na\u010d\xedt\xe1n\xed: ",T]})]})})]}):(0,Re.jsxs)(Le,{children:[(0,Re.jsx)("style",{children:"\n        .email-preview-body::-webkit-scrollbar {\n          width: 8px;\n        }\n        .email-preview-body::-webkit-scrollbar-track {\n          background: #f9fafb;\n        }\n        .email-preview-body::-webkit-scrollbar-thumb {\n          background: #d1d5db;\n          border-radius: 4px;\n        }\n        .email-preview-body::-webkit-scrollbar-thumb:hover {\n          background: #9ca3af;\n        }\n      "}),(0,Re.jsxs)(Ne,{children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,Re.jsxs)(Oe,{children:[(0,Re.jsx)(ze.g,{icon:Ce.FFg}),"Syst\xe9m workflow a notifikac\xed"]}),(R.length>0||L.length>0)&&(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:Yo?"#dbeafe":"#fef3c7",border:"1px solid ".concat(Yo?"#60a5fa":"#fbbf24"),borderRadius:"6px",fontSize:"0.85rem",color:Yo?"#1e3a8a":"#92400e"},children:[(0,Re.jsx)("span",{style:{fontSize:"1.2rem"},children:Yo?"\ud83d\udcbe":"\u26a0\ufe0f"}),(0,Re.jsxs)("span",{children:[(0,Re.jsx)("strong",{children:R.length})," uzl\u016f, ",(0,Re.jsx)("strong",{children:L.length})," vztah\u016f",(0,Re.jsx)("br",{}),(0,Re.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:Yo?"Nacteno z auto-draftu":"Neulozeno (auto-draft)"})]})]})]}),(0,Re.jsxs)(Pe,{children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",minWidth:"320px"},children:[(0,Re.jsx)("label",{style:{fontSize:"0.85rem",fontWeight:600,color:"#6b7280",whiteSpace:"nowrap"},children:"Profil:"}),(0,Re.jsxs)(zn,{children:[(0,Re.jsx)(wn,{value:(null===go||void 0===go?void 0:go.id)||"",onChange:e=>(async e=>{console.log("\ud83d\udd04 handleProfileChange called with profileId:",e);const n=uo.find(n=>n.id===parseInt(e));if(console.log("\ud83d\udd0d Found profile:",n),n){if(!Yo||!(R.length>0||L.length>0)||window.confirm('M\xe1te neulo\u017een\xe9 zm\u011bny v auto-draftu.\n\nChcete na\u010d\xedst profil "'.concat(n.name,'"?\n\nNeulo\u017een\xe9 zm\u011bny budou ztraceny.'))){vo(n),localStorage.setItem(Jo,e.toString()),console.log("\ud83d\udcc2 Loading profile:",n.name,"ID:",e);try{const n=await Ie.jK.token(),o=await Ie.jK.user(),t=(null===o||void 0===o?void 0:o.username)||localStorage.getItem("username"),i="https://erdms.zachranka.cz/api.eeo/",a=await fetch("".concat(i,"/hierarchy/structure"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n,username:t,profilId:e})}),l=await a.json();if(console.log("\ud83d\udce5 Profile structure response:",l),l.success&&l.data){const e=l.data.nodes||[],n=l.data.relations||[];if(n&&0!==n.length){console.log("\ud83d\udce6 Received nodes:",e.length,"relations:",n.length);const o=new Map;n.forEach(e=>{e.node_1&&e.position_1&&o.set(e.node_1,e.position_1),e.node_2&&e.position_2&&o.set(e.node_2,e.position_2)}),console.log("\ud83d\udccd Loaded positions for",o.size,"nodes");const t={},i=e.map((e,n)=>{const i="".concat(e.type,"-").concat(e.userId||e.roleId||e.departmentId||e.locationId||e.templateId,"-").concat(Date.now(),"-").concat(n);return t[e.id]=i,{id:i,type:"custom",position:o.get(e.id)||{x:250*n,y:0},data:{type:e.type,name:e.name,userId:e.userId,roleId:e.roleId,departmentId:e.departmentId,locationId:e.locationId,templateId:e.templateId,position:e.position,initials:e.initials,metadata:e.metadata||{},popis:e.popis}}});console.log("\ud83d\udd04 Node mapping created:",t);const a=n.map((e,n)=>{const o=t[e.node_1],i=t[e.node_2];return o&&i?{id:"rel-".concat(e.id||n),source:o,target:i,type:"smoothstep",animated:!0,data:{level:e.level,visibility:e.visibility,notifications:e.notifications,type:e.type}}:(console.warn("\u26a0\ufe0f Missing source or target mapping for relation:",{relation:e,node_1:e.node_1,node_2:e.node_2,sourceId:o,targetId:i,availableKeys:Object.keys(t)}),null)}).filter(e=>null!==e);E(i),N(a),console.log("\u2705 Profile loaded:",i.length,"nodes,",a.length,"edges")}else E([]),N([]),console.log("\ud83d\udced Empty profile loaded");localStorage.removeItem(Fo),localStorage.removeItem(Ho),localStorage.removeItem(Ko),Zo(!1)}}catch(o){console.error("Failed to load profile structure:",o)}}}else console.log("\u274c Profile not found!")})(e.target.value),children:uo.map(e=>(0,Re.jsxs)("option",{value:e.id,children:[e.name,e.isActive?" \u2705":" \u26aa",e.relationshipsCount>0?" (".concat(e.relationshipsCount,")"):""]},e.id))}),(0,Re.jsx)(Sn,{children:"\u25bc"}),(0,Re.jsx)(An,{onClick:e=>{e.stopPropagation(),(async()=>{if(!go)return;const e=!go.isActive,n=e?"aktivovat":"deaktivovat";try{const n=await Ie.jK.token(),t=await Ie.jK.user(),i=(null===t||void 0===t?void 0:t.username)||localStorage.getItem("username"),{setProfileActive:a}=await o.e(6102).then(o.bind(o,96102));await a(n,i,go.id,e),ho(uo.map(n=>n.id===go.id?(0,ge.A)((0,ge.A)({},n),{},{isActive:e}):n)),vo((0,ge.A)((0,ge.A)({},go),{},{isActive:e}));const l=e?"aktivov\xe1n (viditeln\xfd v AppSettings)":"deaktivov\xe1n (skryt\xfd v AppSettings)";console.log('\u2705 Profil "'.concat(go.name,'" byl ').concat(l))}catch(T){console.error("Chyba p\u0159i pokusu ".concat(n," profil:"),T),alert("Nepoda\u0159ilo se ".concat(n," profil: ").concat(T.message))}})()},disabled:!go,title:null!==go&&void 0!==go&&go.isActive?"Deaktivovat profil (skryje se v AppSettings)":"Aktivovat profil (zobraz\xed se v AppSettings)",style:{background:null!==go&&void 0!==go&&go.isActive?"#10b981":"#6b7280",marginRight:"4px",fontSize:"0.85rem",padding:"4px 8px"},children:null!==go&&void 0!==go&&go.isActive?"\u2713":"\u25cb"}),(0,Re.jsx)(An,{onClick:e=>{e.stopPropagation(),(async()=>{if(!go||uo.length<=1)return;const e=go.relationshipsCount>0?"\n\n\u26a0\ufe0f Profil obsahuje ".concat(go.relationshipsCount," vztah\u016f, kter\xe9 budou tak\xe9 smaz\xe1ny!"):"";Uo({show:!0,type:"confirm",icon:"\ud83d\uddd1\ufe0f",title:"Smazat profil?",message:'Opravdu chcete smazat profil "'.concat(go.name,'"?').concat(e,"\n\nTato akce je nevratn\xe1!"),onConfirm:async()=>{try{const e=await Ie.jK.token(),n=await Ie.jK.user(),o=(null===n||void 0===n?void 0:n.username)||localStorage.getItem("username"),t="https://erdms.zachranka.cz/api.eeo/",i=await fetch("".concat(t,"/hierarchy/profiles/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,username:o,profile_id:go.id})}),a=await i.json();if(!a.success)throw new Error(a.error||"Chyba p\u0159i maz\xe1n\xed profilu");Uo({show:!0,type:"success",icon:"\u2705",title:"Profil smaz\xe1n",message:'Profil "'.concat(go.name,'" byl \xfasp\u011b\u0161n\u011b smaz\xe1n.'),onConfirm:()=>Uo(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null}),await rt(),E([]),N([])}catch(e){console.error("Delete profile error:",e),Uo({show:!0,type:"alert",icon:"\u274c",title:"Chyba p\u0159i maz\xe1n\xed",message:e.message,onConfirm:()=>Uo(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null})}},onCancel:()=>Uo(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"Smazat",cancelText:"Zru\u0161it"})})()},disabled:!go||uo.length<=1,title:uo.length<=1?"Nelze smazat posledn\xed profil":"Smazat aktu\xe1ln\xed profil",children:"\ud83d\uddd1\ufe0f"})]})]}),(0,Re.jsxs)(De,{onClick:()=>{const e=R.filter(e=>e.selected);0!==e.length?lt(e):Uo({show:!0,type:"alert",icon:"\u26a0\ufe0f",title:"\u017d\xe1dn\xe9 polo\u017eky nevybr\xe1ny na plo\u0161e",message:"Pro vytvo\u0159en\xed AI hierarchie mus\xedte nejprve vybrat nody na plo\u0161e.\n\nPou\u017eijte:\n\u2022 T\xe1hn\u011bte my\u0161\xed pro v\xfdb\u011br oblasti (crosshair kurzor)\n\u2022 CTRL+klik pro individu\xe1ln\xed v\xfdb\u011br\n\u2022 SHIFT+klik pro rozsah",onConfirm:()=>Uo(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null})},disabled:A||0===V.length,children:[(0,Re.jsx)("span",{style:{fontSize:"1.1rem",marginRight:"4px"},children:"\ud83e\udd16"}),"AI Asistent"]}),(0,Re.jsxs)(De,{onClick:()=>{if(R.length>0){const{nodes:e,edges:n}=at(R,L,"TB");E(e),N(n),console.log("\ud83d\udcd0 Manual layout applied")}},disabled:0===R.length,title:"Automaticky prerovnat existujici strukturu",children:[(0,Re.jsx)("span",{style:{fontSize:"1.1rem",marginRight:"4px"},children:"\ud83d\udcd0"}),"P\u0159erovnat"]}),(0,Re.jsxs)(De,{children:[(0,Re.jsx)(ze.g,{icon:Ce.pS3}),"N\xe1hled"]}),(0,Re.jsxs)(De,{primary:!0,onClick:()=>dt(),disabled:A||0===R.length&&0===L.length,children:[(0,Re.jsx)(ze.g,{icon:Ce.hSh}),"Ulo\u017eit"]}),(0,Re.jsxs)(De,{onClick:()=>{yo("saveAs"),fo(!0)},disabled:A||0===R.length&&0===L.length,children:[(0,Re.jsx)(ze.g,{icon:Ce.hSh}),"Ulo\u017eit jako..."]})]})]}),(0,Re.jsxs)("div",{style:{padding:"8px 16px",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",borderBottom:"2px solid #e0e6ed",display:"flex",alignItems:"center",gap:"20px",fontSize:"0.8rem",flexWrap:"wrap"},children:[(0,Re.jsx)("span",{style:{fontWeight:700,color:"#475569"},children:"Legenda vztah\u016f:"}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Re.jsx)("div",{style:{width:"30px",height:"3px",background:"#3b82f6",borderRadius:"2px"}}),(0,Re.jsx)("span",{style:{color:"#1e40af"},children:"U\u017eivatel"})]}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Re.jsx)("div",{style:{width:"30px",height:"3px",background:"#92400e",borderRadius:"2px"}}),(0,Re.jsx)("span",{style:{color:"#78350f"},children:"Lokalita"})]}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Re.jsx)("div",{style:{width:"30px",height:"3px",background:"#059669",borderRadius:"2px"}}),(0,Re.jsx)("span",{style:{color:"#065f46"},children:"\xdasek"})]}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Re.jsx)("div",{style:{width:"30px",height:"3px",background:"#f59e0b",borderRadius:"2px"}}),(0,Re.jsx)("span",{style:{color:"#d97706"},children:"Notifikace"})]}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Re.jsx)("div",{style:{width:"30px",height:"3px",background:"#8b5cf6",borderRadius:"2px"}}),(0,Re.jsx)("span",{style:{color:"#6d28d9"},children:"Role"})]})]}),(0,Re.jsxs)(He,{children:[(0,Re.jsxs)(Ke,{children:[(0,Re.jsx)(Je,{children:(0,Re.jsxs)(Ye,{children:[(0,Re.jsx)(ze.g,{icon:Ce.qIE}),"P\u0159ehled polo\u017eek workflow"]})}),(0,Re.jsxs)(Ze,{children:[(0,Re.jsx)(Xe,{children:(0,Re.jsx)(ze.g,{icon:Ce.MjD})}),(0,Re.jsx)(Ge,{placeholder:"Hledat ve v\u0161ech sekc\xedch...",value:d,onChange:e=>{const n=e.target.value;s(n),u(n),g(n),m(n)}}),d&&(0,Re.jsx)($e,{onClick:()=>{s(""),u(""),g(""),m("")},title:"Vymazat vyhled\xe1v\xe1n\xed ve v\u0161ech sekc\xedch",children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})]}),(0,Re.jsxs)(qe,{children:[(0,Re.jsxs)(Qe,{children:[(0,Re.jsxs)(en,{expanded:f.users,onClick:()=>nt("users"),children:[(0,Re.jsx)(ze.g,{icon:f.users?Ce.Jt$:Ce.XkK}),(0,Re.jsx)(ze.g,{icon:Ce.gdJ}),"U\u017dIVATEL\xc9 (",st.length,")",jo.size>0&&(0,Re.jsxs)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#667eea",fontWeight:"bold"},children:[jo.size," vybr\xe1no"]})]}),(0,Re.jsxs)(nn,{expanded:f.users,children:[(0,Re.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:(0,Re.jsxs)(Ze,{style:{margin:0},children:[(0,Re.jsx)(Xe,{children:(0,Re.jsx)(ze.g,{icon:Ce.MjD})}),(0,Re.jsx)(Ge,{placeholder:"Hledat u\u017eivatele...",value:d,onChange:e=>s(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),d&&(0,Re.jsx)($e,{onClick:()=>s(""),title:"Vymazat",children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})]})}),(0,Re.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed",display:"flex",gap:"8px"},children:(0,Re.jsx)("button",{onClick:e=>{e.stopPropagation(),jo.size===st.length?ko(new Set):ko(new Set(st.map(e=>e.id)))},style:{flex:1,padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:jo.size===st.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})}),(0,Re.jsx)("div",{children:st.map(e=>(0,Re.jsxs)(on,{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow",e.id),it(e.id),console.log("\ud83d\udc49 Drag start:",e.id,e.name)},onDragEnd:()=>{it(null),console.log("\ud83d\udea9 Drag end")},style:{background:jo.has(e.id)?"#ede9fe":"white",borderColor:jo.has(e.id)?"#8b5cf6":"#e0e6ed",cursor:"grab"},children:[(0,Re.jsx)("input",{type:"checkbox",checked:jo.has(e.id),onChange:n=>{var o;n.stopPropagation(),o=e.id,ko(e=>{const n=new Set(e);return n.has(o)?n.delete(o):n.add(o),n})},onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#8b5cf6",flexShrink:0}}),(0,Re.jsx)(tn,{children:e.initials}),(0,Re.jsxs)(an,{children:[(0,Re.jsx)(ln,{children:e.name}),(0,Re.jsxs)(rn,{children:[e.position," \u2022 ",e.location]})]})]},e.id))})]})]}),(0,Re.jsxs)(Qe,{children:[(0,Re.jsxs)(en,{expanded:f.roles,onClick:()=>nt("roles"),children:[(0,Re.jsx)(ze.g,{icon:f.roles?Ce.Jt$:Ce.XkK}),(0,Re.jsx)(ze.g,{icon:Ce.CN3}),"ROLE (",ct.length,")"]}),(0,Re.jsxs)(nn,{expanded:f.roles,children:[(0,Re.jsxs)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:[(0,Re.jsxs)(Ze,{style:{margin:0},children:[(0,Re.jsx)(Xe,{children:(0,Re.jsx)(ze.g,{icon:Ce.MjD})}),(0,Re.jsx)(Ge,{placeholder:"Hledat roli...",value:c,onChange:e=>p(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),c&&(0,Re.jsx)($e,{onClick:()=>p(""),title:"Vymazat",children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})]}),(0,Re.jsx)("button",{onClick:()=>{zo.size===ct.length?wo(new Set):wo(new Set(ct.map(e=>e.id)))},style:{width:"100%",marginTop:"8px",padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:zo.size===ct.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})]}),(0,Re.jsx)("div",{children:ct.map(e=>(0,Re.jsxs)(on,{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow","role-".concat(e.id)),it("role-".concat(e.id))},onDragEnd:()=>it(null),style:{background:zo.has(e.id)?"#f5f3ff":"white",borderColor:zo.has(e.id)?"#8b5cf6":"#e0e6ed",cursor:"grab"},children:[(0,Re.jsx)("input",{type:"checkbox",checked:zo.has(e.id),onChange:n=>{var o;n.stopPropagation(),o=e.id,wo(e=>{const n=new Set(e);return n.has(o)?n.delete(o):n.add(o),n})},onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#8b5cf6",flexShrink:0}}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",flex:1},children:[(0,Re.jsx)(ze.g,{icon:Ce.CN3,style:{color:"#8b5cf6",fontSize:"1.1rem"}}),(0,Re.jsxs)("div",{style:{flex:1},children:[(0,Re.jsx)("div",{style:{fontWeight:"600",fontSize:"0.85rem",color:"#6d28d9"},children:e.nazev_role}),(0,Re.jsxs)("div",{style:{fontSize:"0.7rem",color:"#8b5cf6",marginTop:"2px"},children:[e.userCount||0," u\u017eivatel\u016f",e.popis?" \u2022 ".concat(e.popis):""]})]})]})]},"role-".concat(e.id)))})]})]}),(0,Re.jsxs)(Qe,{children:[(0,Re.jsxs)(en,{expanded:f.locations,onClick:()=>nt("locations"),children:[(0,Re.jsx)(ze.g,{icon:f.locations?Ce.Jt$:Ce.XkK}),(0,Re.jsx)(ze.g,{icon:Ce.Pcr}),"LOKALITY (",pt.length,")",So.size>0&&(0,Re.jsxs)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#f5576c",fontWeight:"bold"},children:[So.size," vybr\xe1no"]})]}),(0,Re.jsxs)(nn,{expanded:f.locations,children:[(0,Re.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:(0,Re.jsxs)(Ze,{style:{margin:0},children:[(0,Re.jsx)(Xe,{children:(0,Re.jsx)(ze.g,{icon:Ce.MjD})}),(0,Re.jsx)(Ge,{placeholder:"Hledat lokalitu...",value:x,onChange:e=>u(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),x&&(0,Re.jsx)($e,{onClick:()=>u(""),title:"Vymazat",children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})]})}),(0,Re.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed",display:"flex",gap:"8px"},children:(0,Re.jsx)("button",{onClick:e=>{e.stopPropagation(),So.size===pt.length?Ao(new Set):Ao(new Set(pt.map(e=>e.id)))},style:{flex:1,padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:So.size===pt.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})}),(0,Re.jsx)("div",{children:pt.map(e=>(0,Re.jsxs)(dn,{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow","loc-".concat(e.id)),it("loc-".concat(e.id)),console.log("\ud83d\udccd Drag start location:",e.id,e.name)},onDragEnd:()=>{it(null),console.log("\ud83c\udfc1 Drag end")},style:{background:So.has(e.id)?"#fef3c7":"white",borderColor:So.has(e.id)?"#fbbf24":"#e0e6ed",cursor:"grab"},children:[(0,Re.jsx)("input",{type:"checkbox",checked:So.has(e.id),onChange:n=>{var o;n.stopPropagation(),o=e.id,Ao(e=>{const n=new Set(e);return n.has(o)?n.delete(o):n.add(o),n})},onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#f59e0b",flexShrink:0}}),(0,Re.jsx)(sn,{children:(0,Re.jsx)(ze.g,{icon:Ce.URI})}),(0,Re.jsxs)(an,{children:[(0,Re.jsx)(ln,{children:e.name}),(0,Re.jsxs)(rn,{children:[e.userCount," u\u017eivatel\u016f \u2022 ",e.code]})]})]},e.id))})]})]}),(0,Re.jsxs)(Qe,{children:[(0,Re.jsxs)(en,{expanded:f.departments,onClick:()=>nt("departments"),children:[(0,Re.jsx)(ze.g,{icon:f.departments?Ce.Jt$:Ce.XkK}),(0,Re.jsx)(ze.g,{icon:Ce.BzA}),"\xdaSEKY (",xt.length,")",Io.size>0&&(0,Re.jsxs)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#00f2fe",fontWeight:"bold"},children:[Io.size," vybr\xe1no"]})]}),(0,Re.jsxs)(nn,{expanded:f.departments,children:[(0,Re.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:(0,Re.jsxs)(Ze,{style:{margin:0},children:[(0,Re.jsx)(Xe,{children:(0,Re.jsx)(ze.g,{icon:Ce.MjD})}),(0,Re.jsx)(Ge,{placeholder:"Hledat \xfatvar...",value:h,onChange:e=>g(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),h&&(0,Re.jsx)($e,{onClick:()=>g(""),title:"Vymazat",children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})]})}),(0,Re.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed",display:"flex",gap:"8px"},children:(0,Re.jsx)("button",{onClick:e=>{e.stopPropagation(),Io.size===xt.length?To(new Set):To(new Set(xt.map(e=>e.id)))},style:{flex:1,padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:Io.size===xt.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})}),(0,Re.jsx)("div",{children:xt.map(e=>(0,Re.jsxs)(dn,{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow","dept-".concat(e.id)),it("dept-".concat(e.id)),console.log("\ud83c\udfe2 Drag start department:",e.id,e.name)},onDragEnd:()=>{it(null),console.log("\ud83c\udfc1 Drag end")},style:{background:Io.has(e.id)?"#dbeafe":"white",borderColor:Io.has(e.id)?"#60a5fa":"#e0e6ed",cursor:"grab"},children:[(0,Re.jsx)("input",{type:"checkbox",checked:Io.has(e.id),onChange:n=>{var o;n.stopPropagation(),o=e.id,To(e=>{const n=new Set(e);return n.has(o)?n.delete(o):n.add(o),n})},onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#3b82f6",flexShrink:0}}),(0,Re.jsx)(cn,{children:(0,Re.jsx)(ze.g,{icon:Ce.BzA})}),(0,Re.jsxs)(an,{children:[(0,Re.jsx)(ln,{children:e.name}),(0,Re.jsxs)(rn,{children:[e.userCount," u\u017eivatel\u016f \u2022 ",e.code]})]})]},e.id))})]})]}),(0,Re.jsxs)(Qe,{children:[(0,Re.jsxs)(en,{expanded:f.notificationTemplates,onClick:()=>nt("notificationTemplates"),children:[(0,Re.jsx)(ze.g,{icon:f.notificationTemplates?Ce.Jt$:Ce.XkK}),(0,Re.jsx)(ze.g,{icon:Ce.z$e}),"NOTIFIKA\u010cN\xcd \u0160ABLONY (",ut.length,")",Co.size>0&&(0,Re.jsxs)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#f59e0b",fontWeight:"bold"},children:[Co.size," vybr\xe1no"]})]}),(0,Re.jsxs)(nn,{expanded:f.notificationTemplates,children:[(0,Re.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:(0,Re.jsxs)(Ze,{style:{margin:0},children:[(0,Re.jsx)(Xe,{children:(0,Re.jsx)(ze.g,{icon:Ce.MjD})}),(0,Re.jsx)(Ge,{placeholder:"Hledat \u0161ablonu...",value:v,onChange:e=>m(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),v&&(0,Re.jsx)($e,{onClick:()=>m(""),title:"Vymazat",children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})]})}),(0,Re.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed",display:"flex",gap:"8px"},children:(0,Re.jsx)("button",{onClick:e=>{e.stopPropagation(),Co.size===ut.length?Ro(new Set):Ro(new Set(ut.map(e=>e.id)))},style:{flex:1,padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:Co.size===ut.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})}),(0,Re.jsx)("div",{children:ut.map(e=>{var n;return(0,Re.jsxs)("div",{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow","notif-".concat(e.id)),it("notif-".concat(e.id)),console.log("\ud83d\udd14 Drag start notification template:",e.id,e.name)},onDragEnd:()=>{it(null),console.log("\ud83c\udfc1 Drag end")},style:{padding:"12px",borderBottom:"1px solid #e0e6ed",display:"flex",alignItems:"flex-start",gap:"10px",cursor:"grab",background:Co.has(e.id)?"#fef3c7":"white",transition:"all 0.2s"},onClick:()=>ot(e.id),children:[(0,Re.jsx)("input",{type:"checkbox",checked:Co.has(e.id),onChange:()=>ot(e.id),onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#f59e0b",flexShrink:0,marginTop:"2px"}}),(0,Re.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:"linear-gradient(135deg, #f59e0b 0%, #ea580c 100%)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1rem",flexShrink:0,boxShadow:"0 2px 8px rgba(245, 158, 11, 0.3)"},children:(0,Re.jsx)(ze.g,{icon:Ce.z$e})}),(0,Re.jsxs)("div",{style:{flex:1},children:[(0,Re.jsx)("div",{style:{fontWeight:"600",color:"#2c3e50",fontSize:"0.9rem",marginBottom:"4px"},children:e.name}),(0,Re.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",display:"flex",alignItems:"center",gap:"8px"},children:[(0,Re.jsx)("code",{style:{background:"#f1f5f9",padding:"2px 6px",borderRadius:"4px",fontSize:"0.7rem"},children:e.type}),(null===(n=e.email)||void 0===n?void 0:n.sendByDefault)&&(0,Re.jsxs)("span",{style:{color:"#3b82f6"},children:[(0,Re.jsx)(ze.g,{icon:Ce.y_8})," Email"]}),(0,Re.jsx)("span",{style:{color:"urgent"===e.priorityDefault?"#dc2626":"high"===e.priorityDefault?"#f59e0b":"#64748b",fontWeight:"600"},children:e.priorityDefault})]})]})]},e.id)})})]})]})]}),(jo.size>0||So.size>0||Io.size>0||Co.size>0)&&(0,Re.jsxs)("div",{style:{position:"absolute",bottom:"66px",left:0,right:0,padding:"16px",borderTop:"2px solid #e0e6ed",background:"linear-gradient(180deg, #f8fafc 0%, white 100%)",boxShadow:"0 -4px 12px rgba(0,0,0,0.05)",zIndex:9},children:[(0,Re.jsxs)("button",{onClick:()=>{const e=[];let n=R.length;const o=Date.now();jo.forEach((t,i)=>{const a=V.find(e=>e.id===t);a&&(e.push({id:"user-".concat(t,"-").concat(o,"-").concat(i),type:"custom",position:{x:100+n%5*250,y:100+180*Math.floor(n/5)},data:{userId:t,name:a.name,position:a.position,initials:a.initials,metadata:{location:a.location,department:a.department}}}),n++)}),So.forEach((t,i)=>{const a=U.find(e=>e.id===t);a&&(e.push({id:"location-".concat(t,"-").concat(o,"-").concat(i),type:"custom",position:{x:100+n%5*250,y:100+180*Math.floor(n/5)},data:{type:"location",locationId:t,name:a.name}}),n++)}),Io.forEach((t,i)=>{const a=H.find(e=>e.id===t);a&&(e.push({id:"department-".concat(t,"-").concat(o,"-").concat(i),type:"custom",position:{x:100+n%5*250,y:100+180*Math.floor(n/5)},data:{type:"department",departmentId:t,name:a.name}}),n++)}),Co.forEach((t,i)=>{const a=Z.find(e=>e.id===t);a&&(e.push({id:"template-".concat(t,"-").concat(o,"-").concat(i),type:"custom",position:{x:100+n%5*250,y:100+180*Math.floor(n/5)},data:{type:"template",templateId:t,name:a.name,position:"Notifika\u010dn\xed \u0161ablona",initials:"\ud83d\udd14",metadata:{type:"template",template:a.name}}}),n++)}),e.length>0&&(E(n=>[...n,...e]),console.log("\u2705 Added ".concat(e.length," nodes to canvas")),ko(new Set),Ao(new Set),To(new Set))},style:{width:"100%",padding:"12px 16px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"0.95rem",fontWeight:"700",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.4)",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(102, 126, 234, 0.5)"},onMouseLeave:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},children:[(0,Re.jsx)(ze.g,{icon:Ce.QLR}),(0,Re.jsxs)("span",{children:["P\u0159idat vybran\xe9 (",jo.size+So.size+Io.size+Co.size,")"]})]}),(0,Re.jsxs)("div",{style:{marginTop:"8px",fontSize:"0.75rem",color:"#64748b",textAlign:"center"},children:[jo.size>0&&"".concat(jo.size," u\u017eivatel\u016f"),jo.size>0&&(So.size>0||Io.size>0||Co.size>0)&&" \u2022 ",So.size>0&&"".concat(So.size," lokalit"),So.size>0&&(Io.size>0||Co.size>0)&&" \u2022 ",Io.size>0&&"".concat(Io.size," \xfatvar\u016f"),Io.size>0&&Co.size>0&&" \u2022 ",Co.size>0&&"".concat(Co.size," \u0161ablon")]})]}),(0,Re.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"12px 16px",background:"white",borderTop:"2px solid #e0e6ed",boxShadow:"0 -4px 12px rgba(0,0,0,0.05)",zIndex:10},children:(0,Re.jsxs)("button",{onClick:()=>{_o({isOpen:!0,title:"Resetovat plochu",message:"Opravdu chcete smazat celou plochu a za\u010d\xedt znovu od za\u010d\xe1tku? Tato akce je nevratn\xe1.",onConfirm:()=>{E([]),N([]),localStorage.removeItem("hierarchy_draft_nodes"),localStorage.removeItem("hierarchy_draft_edges"),localStorage.removeItem("hierarchy_draft_timestamp"),Zo(!1),_o({isOpen:!1,title:"",message:"",onConfirm:null})}})},disabled:0===R.length,style:{width:"100%",padding:"10px 16px",background:0===R.length?"#f1f5f9":"white",color:0===R.length?"#94a3b8":"#dc2626",border:"2px solid ".concat(0===R.length?"#e2e8f0":"#fecaca"),borderRadius:"8px",cursor:0===R.length?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s"},onMouseEnter:e=>{R.length>0&&(e.target.style.background="#fef2f2",e.target.style.borderColor="#dc2626")},onMouseLeave:e=>{R.length>0&&(e.target.style.background="white",e.target.style.borderColor="#fecaca")},children:[(0,Re.jsx)(ze.g,{icon:Ce.yLS}),(0,Re.jsx)("span",{children:"Resetovat plochu"})]})})]}),(0,Re.jsx)(pn,{onDrop:e=>{if(e.preventDefault(),!tt)return void console.log("\u26a0\ufe0f No dragged item");if(!P)return void console.log("\u26a0\ufe0f ReactFlow instance not ready");const n=tt,o=e.currentTarget.querySelector(".react-flow");if(!o)return void console.error("\u26a0\ufe0f ReactFlow element not found");const t=o.getBoundingClientRect(),i=P.screenToFlowPosition({x:e.clientX-110,y:e.clientY-40});if(console.log("\ud83d\udce6 Drop:",{dragId:n,position:i,clientX:e.clientX,clientY:e.clientY,bounds:{left:t.left,top:t.top},viewport:P.getViewport()}),n.startsWith("notif-")){const e=parseInt(n.replace("notif-",""),10),o=Z.find(n=>n.id===e);if(o){const n={id:"template-".concat(e,"-").concat(Date.now()),type:"custom",position:i,data:{type:"template",templateId:e,name:o.name,position:"Notifika\u010dn\xed \u0161ablona",initials:"\ud83d\udd14",metadata:{type:"template",template:o.name}}};E(e=>[...e,n]),console.log("\u2705 Added notification template node: ".concat(o.name))}return}if(n.startsWith("role-")){const e=parseInt(n.replace("role-",""),10),o=B.find(n=>n.id===e);if(o){const n={id:"role-".concat(e,"-").concat(Date.now()),type:"custom",position:i,data:{type:"role",roleId:e,name:o.nazev_role,label:o.nazev_role,metadata:{type:"role",popis:o.popis||"",orders:o.orders||0,invoices:o.invoices||0,cashbook:o.cashbook||0}}};E(e=>[...e,n]),console.log("\u2705 Added role node: ".concat(o.nazev_role),n)}return}if(!n.startsWith("loc-")&&!n.startsWith("dept-")&&!n.startsWith("role-")){const e=V.find(e=>e.id===n);if(e){const o={id:"user-".concat(n,"-").concat(Date.now()),type:"custom",position:i,data:{type:"user",userId:n,name:e.name,position:e.position,initials:e.initials,metadata:{location:e.location,department:e.department}}};E(e=>[...e,o])}return}if(n.startsWith("loc-")){const e=n.replace("loc-","");console.log("\ud83d\udccd LOCATION DROP - ID:",e);const o=U.find(n=>n.id===e);if(!o)return void console.error("\u274c Location not found:",e);const t={id:"location-".concat(e,"-").concat(Date.now()),type:"custom",position:i,data:{type:"location",locationId:e,name:o.name,position:"Lokalita",initials:o.name.substring(0,2).toUpperCase(),metadata:{type:"location",location:o.name}}};return E(e=>[...e,t]),void console.log("\u2705 Added location node: ".concat(o.name))}if(n.startsWith("dept-")){const e=n.replace("dept-","");console.log("\ud83c\udfe2 DEPARTMENT DROP - ID:",e);const o=H.find(n=>n.id===e);if(!o)return void console.error("\u274c Department not found:",e);const t={id:"department-".concat(e,"-").concat(Date.now()),type:"custom",position:i,data:{type:"department",departmentId:e,name:o.name,position:"Utvar",initials:o.name.substring(0,2).toUpperCase(),metadata:{type:"department",department:o.name}}};return E(e=>[...e,t]),void console.log("\u2705 Added department node: ".concat(o.name))}},onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},className:$n?"selection-mode":"",children:(0,Re.jsxs)(be.Gc,{nodes:R,edges:L,onNodesChange:_,onEdgesChange:O,onConnect:Xo,onNodeClick:$o,onEdgeClick:qo,onNodeDragStop:et,onInit:D,nodeTypes:Hn,fitView:!0,attributionPosition:"bottom-left",selectionOnDrag:!0,panOnDrag:!0,panOnScroll:!0,zoomOnScroll:!0,zoomOnDoubleClick:!1,selectionMode:"partial",selectionKeyCode:"Shift",multiSelectionKeyCode:"Control",selectNodesOnDrag:!1,onSelectionChange:e=>{const n=e.nodes.length,o=e.edges.length,t=n+o;1===t?1===n?(j(e.nodes[0]),z(null),S(!0)):1===o&&(z(e.edges[0]),j(null),S(!0)):(S(!1),j(null),z(null))},children:[(0,Re.jsx)(ke.V,{color:"#cbd5e1",gap:20,size:1}),(0,Re.jsx)(je.H,{}),(0,Re.jsx)(ye.o,{nodeColor:e=>{var n,o,t;return"template"===(null===(n=e.data)||void 0===n?void 0:n.type)?"#f59e0b":"location"===(null===(o=e.data)||void 0===o?void 0:o.type)?"#92400e":"department"===(null===(t=e.data)||void 0===t?void 0:t.type)?"#059669":"#3b82f6"},maskColor:"rgba(245, 247, 250, 0.8)",pannable:!0,zoomable:!0,style:{background:"white",border:"1px solid #e0e6ed",borderRadius:"8px",cursor:"pointer"}}),Lo?(0,Re.jsxs)(be.Zk,{position:"top-left",style:{background:"white",borderRadius:"12px",border:"1px solid #e0e6ed",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",padding:"16px",width:"360px",maxHeight:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px",paddingBottom:"10px",borderBottom:"1px solid #e0e6ed"},children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Re.jsx)("span",{style:{fontSize:"1.4rem"},children:"\ud83d\udca1"}),(0,Re.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.95rem"},children:"N\xe1pov\u011bda"})]}),(0,Re.jsx)("button",{onClick:()=>{No(!1),localStorage.setItem("hierarchy_help_collapsed","true")},style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"1.3rem",color:"#94a3b8",padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#f1f5f9",e.currentTarget.style.color="#64748b"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},title:"Skr\xfdt n\xe1pov\u011bdu",children:"\u2715"})]}),(0,Re.jsxs)("div",{style:{overflowY:"auto",overflowX:"hidden",color:"#64748b",fontSize:"0.82rem",lineHeight:"1.5",paddingRight:"8px"},children:[(0,Re.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Re.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"1. Ovl\xe1d\xe1n\xed pl\xe1tna:"}),"\u2022 ",(0,Re.jsx)("strong",{children:"Posun:"})," T\xe1hn\u011bte my\u0161\xed (bez kl\xe1vesy)",(0,Re.jsx)("br",{}),"\u2022 ",(0,Re.jsx)("strong",{children:"SHIFT + ta\u017een\xed:"})," V\xfdb\u011br v\xedce nod\u016f najednou",(0,Re.jsx)("br",{}),"\u2022 ",(0,Re.jsx)("strong",{children:"CTRL + klik:"})," P\u0159idat/odebrat node do v\xfdb\u011bru"]}),(0,Re.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Re.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"2. P\u0159idejte u\u017eivatele:"}),"\u2022 P\u0159et\xe1hn\u011bte z lev\xe9ho panelu",(0,Re.jsx)("br",{}),"\u2022 Nebo pou\u017eijte \ud83e\udd16 AI Struktura"]}),(0,Re.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Re.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"3. Vytvo\u0159te vztah (\u0161ipku):"}),"\u2022 Najd\u011bte \ud83d\udfe2 zelen\xfd krou\u017eek DOLE u nad\u0159\xedzen\xe9ho",(0,Re.jsx)("br",{}),"\u2022 Dr\u017ete a t\xe1hn\u011bte my\u0161\xed",(0,Re.jsx)("br",{}),"\u2022 Pus\u0165te na \ud83d\udd35 modr\xfd krou\u017eek NAHO\u0158E u pod\u0159\xedzen\xe9ho"]}),(0,Re.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Re.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"4. P\u0159erovn\xe1n\xed:"}),"\u2022 Tlacitko \ud83d\udcd0 Prerovnat = automaticky layout",(0,Re.jsx)("br",{}),"\u2022 Nebo p\u0159etahujte uzly ru\u010dn\u011b"]}),(0,Re.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Re.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"5. Detail vztahu:"}),"\u2022 Klikn\u011bte na \u0161ipku \u2192 otev\u0159e se prav\xfd panel",(0,Re.jsx)("br",{}),"\u2022 Nastavte pr\xe1va a lokality"]}),(0,Re.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Re.jsx)("strong",{style:{color:"#f5576c",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"6. Ulozeni:"}),'\u2022 Tla\u010d\xedtko "Ulo\u017eit do DB" vpravo naho\u0159e']}),(0,Re.jsxs)("div",{style:{padding:"10px",background:"#f0fdf4",borderRadius:"8px",border:"1px solid #86efac"},children:[(0,Re.jsx)("strong",{style:{color:"#10b981",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"\ud83d\udcbe Auto-save:"}),(0,Re.jsx)("span",{style:{fontSize:"0.8rem"},children:"Pozice uzlu se ukladaji automaticky do localStorage a obnovi se po refreshi. Draft se vymaze po ulozeni do DB."})]})]})]}):(0,Re.jsx)(be.Zk,{position:"top-left",style:{background:"white",borderRadius:"12px",border:"1px solid #e0e6ed",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",width:"52px",height:"52px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},onClick:()=>{No(!0),localStorage.setItem("hierarchy_help_collapsed","false")},children:(0,Re.jsx)("span",{style:{fontSize:"1.7rem",transition:"transform 0.2s"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.2)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",title:"Zobrazit n\xe1pov\u011bdu",children:"\ud83d\udca1"})})]})}),w&&(y||k)&&(0,Re.jsxs)(xn,{children:[(0,Re.jsxs)(un,{children:[(0,Re.jsxs)(hn,{children:[(0,Re.jsx)(ze.g,{icon:Ce.MT7}),y?"Detail uzlu":"Detail vztahu"]}),(0,Re.jsx)(vn,{onClick:()=>Po(!0),children:(0,Re.jsx)(ze.g,{icon:Ce.iW_})}),(0,Re.jsx)(gn,{onClick:()=>{S(!1),j(null),z(null),E(e=>e.map(e=>(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{isSelected:!1})})))},children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})]}),(0,Re.jsxs)(mn,{children:[(0,Re.jsxs)(fn,{children:[(0,Re.jsxs)(bn,{children:[(0,Re.jsx)(ze.g,{icon:Ce.BzA}),"Z\xe1kladn\xed informace"]}),y&&"template"===y.data.type&&(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"N\xe1zev \u0161ablony"}),(0,Re.jsx)(kn,{value:y.data.label||y.data.name,readOnly:!0})]}),(()=>{const e=Z.find(e=>e.id===y.data.templateId);if(!e)return null;const n=(e=>{if(!e)return[];const n=[];return[{type:"RECIPIENT",icon:"\ud83d\udfe0",name:"P\u0159\xedjemce (oran\u017eov\xe1 - norm\xe1ln\xed)"},{type:"APPROVER_NORMAL",icon:"\ud83d\udfe0",name:"Schvalovatel (oran\u017eov\xe1 - norm\xe1ln\xed)"},{type:"APPROVER_URGENT",icon:"\ud83d\udd34",name:"Schvalovatel (\u010derven\xe1 - urgentn\xed)"},{type:"SUBMITTER",icon:"\ud83d\udfe2",name:"Autor objedn\xe1vky (zelen\xe1 - info)"}].forEach(o=>{const t="\x3c!-- RECIPIENT: ".concat(o.type," --\x3e");e.includes(t)&&n.push({type:o.type,icon:o.icon,name:o.name})}),n})(e.email_body),o=n.length>0?n[0].type:"";return 0===n.length?(0,Re.jsxs)("div",{style:{padding:"12px",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"6px",color:"#991b1b",fontSize:"0.85rem"},children:["\u26a0\ufe0f ",(0,Re.jsx)("strong",{children:"Varov\xe1n\xed:"})," Email \u0161ablona neobsahuje \u017e\xe1dn\xe9 varianty"]}):(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(yn,{children:[(0,Re.jsxs)(jn,{children:["HTML \u0161ablona pro NORM\xc1LN\xcd stav",(0,Re.jsx)("span",{style:{color:"#f59e0b",marginLeft:"4px"},children:"*"})]}),(0,Re.jsx)("select",{value:ce||o,onChange:e=>pe(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e6ed",borderRadius:"6px",fontSize:"0.9rem",background:"white",cursor:"pointer",fontWeight:"500"},children:n.map(e=>(0,Re.jsxs)("option",{value:e.type,children:[e.icon," ",e.name]},e.type))}),(0,Re.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"4px",fontStyle:"italic"},children:"Tato HTML varianta se pou\u017eije pro b\u011b\u017en\xe9 p\u0159\xedpady (nap\u0159. oran\u017eov\xe1)"})]}),(0,Re.jsxs)(yn,{children:[(0,Re.jsxs)(jn,{children:["HTML \u0161ablona pro MIMO\u0158\xc1DN\xdd stav",(0,Re.jsx)("span",{style:{color:"#f59e0b",marginLeft:"4px"},children:"*"})]}),(0,Re.jsx)("select",{value:xe||o,onChange:e=>ue(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e6ed",borderRadius:"6px",fontSize:"0.9rem",background:"white",cursor:"pointer",fontWeight:"500"},children:n.map(e=>(0,Re.jsxs)("option",{value:e.type,children:[e.icon," ",e.name]},e.type))}),(0,Re.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"4px",fontStyle:"italic"},children:"Tato HTML varianta se pou\u017eije pro urgentn\xed/mimo\u0159\xe1dn\xe9 p\u0159\xedpady (nap\u0159. \u010derven\xe1)"})]}),(0,Re.jsxs)(yn,{children:[(0,Re.jsxs)(jn,{children:["HTML \u0161ablona pro INFORMA\u010cN\xcd ozn\xe1men\xed",(0,Re.jsx)("span",{style:{color:"#f59e0b",marginLeft:"4px"},children:"*"})]}),(0,Re.jsx)("select",{value:he||o,onChange:e=>ve(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e6ed",borderRadius:"6px",fontSize:"0.9rem",background:"white",cursor:"pointer",fontWeight:"500"},children:n.map(e=>(0,Re.jsxs)("option",{value:e.type,children:[e.icon," ",e.name]},e.type))}),(0,Re.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"4px",fontStyle:"italic"},children:"Tato HTML varianta se pou\u017eije pro \u010dist\u011b informa\u010dn\xed notifikace (nap\u0159. zelen\xe1)"})]}),(0,Re.jsxs)("div",{style:{padding:"10px 12px",background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:"6px",fontSize:"0.75rem",color:"#1e40af",marginTop:"8px"},children:[(0,Re.jsx)("strong",{children:"\ud83d\udca1 Jak to funguje:"}),(0,Re.jsxs)("ul",{style:{margin:"6px 0 0 0",paddingLeft:"18px",lineHeight:"1.5"},children:[(0,Re.jsx)("li",{children:"M\u016f\u017eete definovat 3 r\u016fzn\xe9 HTML varianty pro r\u016fzn\xe9 situace"}),(0,Re.jsxs)("li",{children:["Doporu\u010den\xed: Norm\xe1ln\xed = ",(0,Re.jsx)("span",{style:{color:"#f59e0b",fontWeight:"bold"},children:"\ud83d\udfe0 oran\u017eov\xe1"}),", Urgentn\xed = ",(0,Re.jsx)("span",{style:{color:"#dc2626",fontWeight:"bold"},children:"\ud83d\udd34 \u010derven\xe1"}),", Info = ",(0,Re.jsx)("span",{style:{color:"#10b981",fontWeight:"bold"},children:"\ud83d\udfe2 zelen\xe1"})]}),(0,Re.jsx)("li",{children:"Backend automaticky vybere spr\xe1vnou podle ud\xe1losti a typu p\u0159\xedjemce (definuje se v EDGE)"}),(0,Re.jsx)("li",{children:"EDGE (\u0161ipka) ur\u010duje typ notifikace: schv\xe1len\xed, info, nebo oboje"})]})]}),(0,Re.jsxs)(yn,{style:{marginTop:"16px"},children:[(0,Re.jsx)(jn,{children:"Varianta pro n\xe1hled n\xed\u017ee"}),(0,Re.jsx)("select",{value:fe||ce||o,onChange:e=>_e(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #cbd5e1",borderRadius:"6px",fontSize:"0.85rem",background:"#f8fafc",cursor:"pointer"},children:n.map(e=>(0,Re.jsxs)("option",{value:e.type,children:[e.icon," ",e.name]},e.type))}),(0,Re.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"4px",fontStyle:"italic"},children:"\u2699\ufe0f Toto ovl\xe1d\xe1 pouze n\xe1hled emailu n\xed\u017ee (nem\xe1 vliv na odes\xedl\xe1n\xed)"})]})]})})(),(()=>{const e=Z.find(e=>e.id===y.data.templateId);if(!e)return null;const n={order_number:"O-2025-00142",order_id:"142",ev_cislo:"O-2025-00142",cislo_objednavky:"O-2025-00142",status:"Ke schv\xe1len\xed",old_status:"Nov\xe1",new_status:"Ke schv\xe1len\xed",datum_vytvoreni:"14.12.2025",datum_pozadavku:"14.12.2025",datum_zmeny:"14.12.2025 15:30",predmet:"N\xe1kup kancel\xe1\u0159sk\xe9ho vybaven\xed pro odd\u011blen\xed IT",order_subject:"N\xe1kup kancel\xe1\u0159sk\xe9ho vybaven\xed pro odd\u011blen\xed IT",subject:"N\xe1kup kancel\xe1\u0159sk\xe9ho vybaven\xed pro odd\u011blen\xed IT",cena_celkem:"45 670 K\u010d",cena_bez_dph:"37 743 K\u010d",cena_s_dph:"45 670 K\u010d",max_price_with_dph:"50 000 K\u010d",dodavatel:"ALZA.cz s.r.o.",supplier_name:"ALZA.cz s.r.o.",supplier:"ALZA.cz s.r.o.",pozadovatel_jmeno:"Jan Nov\xe1k",pozadovatel_email:"jan.novak@example.com",pozadovatel:"Jan Nov\xe1k",requester_name:"Jan Nov\xe1k",requester_email:"jan.novak@example.com",schvalovatel_jmeno:"Ing. Petr Svoboda",schvalovatel_email:"petr.svoboda@example.com",approver_name:"Ing. Petr Svoboda",approver_email:"petr.svoboda@example.com",action_user_name:"Jan Nov\xe1k",action_performed_by:"Jan Nov\xe1k",action_date:"14.12.2025 15:30",url_objednavky:"https://eeo.example.com/order-form-25?edit=142",order_url:"https://eeo.example.com/order-form-25?edit=142",url:"https://eeo.example.com/order-form-25?edit=142",poznamka:"Nutn\xe9 schv\xe1lit do konce t\xfddne kv\u016fli slevov\xe9 akci",reason:"Zm\u011bna schvalov\xe1n\xed dle intern\xedch sm\u011brnic",comment:"\u017d\xe1dn\xe9 dal\u0161\xed pozn\xe1mky",user_name:"Jan Nov\xe1k",user_email:"jan.novak@example.com",recipient_name:"Ing. Petr Svoboda",date:"14.12.2025",time:"15:30",datetime:"14.12.2025 15:30"},o=e=>{if(!e)return e;let o=e;return Object.keys(n).forEach(e=>{const t=new RegExp("\\{".concat(e,"\\}"),"g"),i=new RegExp("\\{\\{".concat(e,"\\}\\}"),"g");o=o.replace(t,n[e]),o=o.replace(i,n[e])}),o};return(0,Re.jsxs)(Re.Fragment,{children:[(e.app_title||e.app_message)&&(0,Re.jsxs)("div",{style:{marginTop:"16px"},children:[(0,Re.jsxs)(jn,{style:{marginBottom:"8px",display:"block"},children:[(0,Re.jsx)(ze.g,{icon:Ce.z$e,style:{marginRight:"6px",color:"#f5576c"}}),"N\xe1hled In-App notifikace (zvon\u011b\u010dek)"]}),(0,Re.jsxs)("div",{style:{padding:"16px",borderLeft:"4px solid #3b82f6",cursor:"pointer",display:"flex",gap:"12px",alignItems:"start",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:"8px",border:"1px solid #93c5fd"},children:[(0,Re.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",flexShrink:0,background:"linear-gradient(135deg, #3b82f6, #2563eb)",color:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:"\u2139\ufe0f"}),(0,Re.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,Re.jsx)("div",{style:{fontWeight:700,color:"#111827",fontSize:"14px",lineHeight:1.4,marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:o(e.app_title)||"Schv\xe1lena: O-1958/75030926/2025/IT"}),e.app_message&&(0,Re.jsx)("div",{style:{fontSize:"13px",color:"#6b7280",lineHeight:1.5,marginBottom:"6px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:o(e.app_message)}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",fontSize:"12px",color:"#9ca3af",marginTop:"6px"},children:[(0,Re.jsx)("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:"\ud83d\udd50 P\u0159ed 1 h"}),(0,Re.jsxs)("span",{style:{background:"#f3e8ff",color:"#6b21a8",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:500},children:["\ud83d\udc64 ",n.action_performed_by||"Jan Nov\xe1k"]})]})]})]}),(0,Re.jsx)("div",{style:{marginTop:"6px",fontSize:"0.7rem",color:"#64748b",fontStyle:"italic"},children:"\ud83d\udca1 P\u0159esn\u011b toto uvid\xed u\u017eivatel ve zvone\u010dku \u2022 Mock data pro uk\xe1zku"})]}),(0,Re.jsxs)("div",{style:{marginTop:"16px"},children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,Re.jsxs)(jn,{style:{marginBottom:"0",display:"flex",alignItems:"center",gap:"8px"},children:[(0,Re.jsx)(ze.g,{icon:Ce.y_8,style:{marginRight:"6px",color:"#667eea"}}),"N\xe1hled Email \u0161ablony",(()=>{const e=fe||ce||"APPROVER_NORMAL";return(0,Re.jsxs)("span",{style:{padding:"4px 10px",background:"#f3f4f6",borderRadius:"6px",fontSize:"0.75rem",fontWeight:"600",color:"#374151"},children:[{APPROVER_NORMAL:"\ud83d\udfe0",APPROVER_URGENT:"\ud83d\udd34",SUBMITTER:"\ud83d\udfe2",DEFAULT:"\ud83d\udccb"}[e]||"\ud83d\udccb"," ","APPROVER_NORMAL"===e?"Norm\xe1ln\xed":"APPROVER_URGENT"===e?"Mimo\u0159\xe1dn\xfd":"SUBMITTER"===e?"Autor":"V\xfdchoz\xed"]})})()]}),(0,Re.jsx)("button",{onClick:()=>{Bo({template:e,mockData:n,replacePlaceholders:o,selectedVariantType:fe||ce||"APPROVER_NORMAL"}),Vo(!0)},style:{padding:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"36px",transition:"all 0.2s",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px) scale(1.05)",e.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.5)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) scale(1)",e.currentTarget.style.boxShadow="0 2px 8px rgba(102, 126, 234, 0.3)"},title:"Otev\u0159\xedt fullscreen n\xe1hled",children:(0,Re.jsx)(ze.g,{icon:Ce.oZK})})]}),(0,Re.jsxs)("div",{style:{border:"2px solid #667eea",borderRadius:"12px",overflow:"hidden",background:"white",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.15)"},children:[(0,Re.jsxs)("div",{style:{padding:"16px 20px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:"0.85rem"},children:[(0,Re.jsx)("div",{style:{marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px"},children:(0,Re.jsx)("strong",{style:{fontSize:"0.9rem"},children:"\ud83d\udce7 Email Preview"})}),(0,Re.jsxs)("div",{style:{marginBottom:"6px",opacity:.95},children:[(0,Re.jsx)("strong",{children:"P\u0159edm\u011bt:"})," ",o(e.email_subject||"Bez p\u0159edm\u011btu")]}),(0,Re.jsxs)("div",{style:{marginBottom:"6px",opacity:.95},children:[(0,Re.jsx)("strong",{children:"Odes\xedlatel:"})," EEO Syst\xe9m <noreply@eeo.cz>"]}),(0,Re.jsxs)("div",{style:{opacity:.95},children:[(0,Re.jsx)("strong",{children:"P\u0159\xedjemce:"})," ",n.recipient_name||n.user_name," <",n.user_email,">"]})]}),(0,Re.jsx)("div",{style:{padding:"12px",fontSize:"0.5rem",lineHeight:"1.3",color:"#1f2937",maxHeight:"500px",minHeight:"200px",overflowY:"auto",overflowX:"hidden",background:"#ffffff",zoom:"0.6",transformOrigin:"top left"},className:"email-preview-body",children:(0,Re.jsx)("div",{dangerouslySetInnerHTML:{__html:o((()=>{const n=fe||ce||"APPROVER_NORMAL",o=e.email_body||'<p style="color: #9ca3af; font-style: italic;">Email t\u011blo nen\xed definov\xe1no v \u0161ablon\u011b</p>';if(!o.includes("\x3c!-- RECIPIENT:"))return o;const t="\x3c!-- RECIPIENT: ".concat(n," --\x3e"),i=o.indexOf(t);if(-1===i)return o;let a=i+t.length;const l=["APPROVER_NORMAL","APPROVER_URGENT","SUBMITTER"].filter(e=>e!==n).map(e=>"\x3c!-- RECIPIENT: ".concat(e," --\x3e"));let r=o.length;for(const e of l){const n=o.indexOf(e,a);-1!==n&&n<r&&(r=n)}return o.substring(a,r).trim()})()).replace(/\n/g,"<br />")}})}),(0,Re.jsxs)("div",{style:{padding:"12px 20px",background:"#f9fafb",borderTop:"1px solid #e5e7eb",fontSize:"0.75rem",color:"#6b7280",textAlign:"center"},children:["\ud83d\udcc5 ",n.datetime," \u2022 \ud83d\udd14 Automatick\xe1 notifikace z EEO syst\xe9mu"]})]}),(0,Re.jsxs)("div",{style:{marginTop:"8px",padding:"8px 12px",background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:"6px",fontSize:"0.75rem",color:"#1e40af",display:"flex",alignItems:"center",gap:"6px"},children:[(0,Re.jsx)("span",{children:"\ud83d\udca1"}),(0,Re.jsx)("span",{children:"Pln\u011b scrollovateln\xfd n\xe1hled HTML \u0161ablony s nahrazen\xfdmi placeholdery mock daty"})]})]})]})})(),(0,Re.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"#fef3c7",border:"2px solid #f59e0b",borderRadius:"8px",fontSize:"0.85rem",color:"#92400e"},children:[(0,Re.jsx)("strong",{children:"\ud83d\udce7 Co tato \u0161ablona definuje:"}),(0,Re.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",lineHeight:"1.6"},children:[(0,Re.jsxs)("li",{children:["Kter\xe9mu ",(0,Re.jsx)("strong",{children:"u\u017eivateli"})," se notifikace po\u0161le"]}),(0,Re.jsxs)("li",{children:["Zda m\xe1 u\u017eivatel ",(0,Re.jsx)("strong",{children:"notifikace zapnut\xe9"})]}),(0,Re.jsxs)("li",{children:["Zda m\xe1 u\u017eivatel ",(0,Re.jsx)("strong",{children:"roli/pr\xe1va"})," pro p\u0159\xedjem notifikace"]}),(0,Re.jsx)("li",{children:"Scope viditelnosti m\u016f\u017ee ur\u010dovat, zda notifikaci dostane"})]})]}),(()=>{const e=L.filter(e=>e.source===y.id).map(e=>{var n,o,t;const i=R.find(n=>n.id===e.target);return{id:null===i||void 0===i?void 0:i.id,name:(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.label)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.name)||"Nezn\xe1m\xfd",type:(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.type)||"user",edgeId:e.id}});return(0,Re.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"8px"},children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:"600",color:"#1e40af",fontSize:"0.9rem"},children:[(0,Re.jsx)(ze.g,{icon:Ce.z$e}),"Notifikace je p\u0159i\u0159azena na:"]}),e.length>0?(0,Re.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:e.map((e,n)=>{let o="\ud83d\udc64",t="#dbeafe",i="#1e40af";return"location"===e.type?(o="\ud83d\udccd",t="#d1fae5",i="#065f46"):"department"===e.type&&(o="\ud83c\udfe2",t="#dbeafe",i="#1e40af"),(0,Re.jsxs)("div",{style:{padding:"8px 12px",background:t,borderRadius:"6px",fontSize:"0.85rem",color:i,fontWeight:"500",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"8px"},onClick:()=>{const n=R.find(n=>n.id===e.id);n&&(j(n),z(null))},onMouseEnter:e=>e.currentTarget.style.opacity="0.7",onMouseLeave:e=>e.currentTarget.style.opacity="1",title:"Klikn\u011bte pro zobrazen\xed detailu",children:[(0,Re.jsx)("span",{style:{fontSize:"1.1rem"},children:o}),(0,Re.jsx)("span",{children:e.name}),"location"===e.type&&(0,Re.jsx)("span",{style:{fontSize:"0.75rem",opacity:.7},children:"(lokalita)"}),"department"===e.type&&(0,Re.jsx)("span",{style:{fontSize:"0.75rem",opacity:.7},children:"(\xfasek)"}),"user"===e.type&&(0,Re.jsx)("span",{style:{fontSize:"0.75rem",opacity:.7},children:"(u\u017eivatel)"})]},n)})}):(0,Re.jsx)("div",{style:{fontSize:"0.8rem",color:"#64748b",fontStyle:"italic"},children:"\u0160ablona zat\xedm nen\xed p\u0159i\u0159azena k \u017e\xe1dn\xe9mu u\u017eivateli, lokalit\u011b ani \xfaseku"})]})})()]}),y&&"location"===y.data.type&&(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"N\xe1zev lokality"}),(0,Re.jsx)(kn,{value:y.data.label||y.data.name,readOnly:!0})]}),(0,Re.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"#f0fdf4",border:"2px solid #10b981",borderRadius:"8px",fontSize:"0.85rem",color:"#065f46"},children:[(0,Re.jsx)("strong",{children:"\ud83d\udccd Co lokalita definuje:"}),(0,Re.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",lineHeight:"1.6"},children:[(0,Re.jsxs)("li",{children:["Roz\u0161\xed\u0159en\xed ",(0,Re.jsx)("strong",{children:"viditelnosti"})," v r\xe1mci lokality"]}),(0,Re.jsxs)("li",{children:["Ur\u010duje ",(0,Re.jsx)("strong",{children:"scope"})," pro data (objedn\xe1vky, faktury, pokladna)"]}),(0,Re.jsxs)("li",{children:["M\u016f\u017ee m\xedt dodate\u010dn\xe1 ",(0,Re.jsx)("strong",{children:"pr\xe1va"})," v\xe1zan\xe1 na lokalitu"]})]})]})]}),y&&"department"===y.data.type&&(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"N\xe1zev \xfaseku"}),(0,Re.jsx)(kn,{value:y.data.label||y.data.name,readOnly:!0})]}),(0,Re.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"#eff6ff",border:"2px solid #3b82f6",borderRadius:"8px",fontSize:"0.85rem",color:"#1e40af"},children:[(0,Re.jsx)("strong",{children:"\ud83c\udfe2 Co \xfasek definuje:"}),(0,Re.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",lineHeight:"1.6"},children:[(0,Re.jsxs)("li",{children:["Roz\u0161\xed\u0159en\xed ",(0,Re.jsx)("strong",{children:"viditelnosti"})," v r\xe1mci \xfaseku"]}),(0,Re.jsxs)("li",{children:["Ur\u010duje ",(0,Re.jsx)("strong",{children:"scope"})," pro data (objedn\xe1vky, faktury, pokladna)"]}),(0,Re.jsxs)("li",{children:["M\u016f\u017ee m\xedt dodate\u010dn\xe1 ",(0,Re.jsx)("strong",{children:"pr\xe1va"})," v\xe1zan\xe1 na \xfasek"]})]})]})]}),y&&"role"===y.data.type&&(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"N\xe1zev role"}),(0,Re.jsx)(kn,{value:y.data.label||y.data.name,readOnly:!0})]}),(null===(e=y.data.metadata)||void 0===e?void 0:e.popis)&&(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"Popis"}),(0,Re.jsx)(kn,{value:y.data.metadata.popis,readOnly:!0})]}),(0,Re.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"#f5f3ff",border:"2px solid #8b5cf6",borderRadius:"8px",fontSize:"0.85rem",color:"#6b21a8"},children:[(0,Re.jsx)("strong",{children:"\ud83d\udee1\ufe0f Co role definuje:"}),(0,Re.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",lineHeight:"1.6"},children:[(0,Re.jsxs)("li",{children:["Sadu ",(0,Re.jsx)("strong",{children:"opr\xe1vn\u011bn\xed"})," pro moduly (objedn\xe1vky, faktury, pokladna)"]}),(0,Re.jsxs)("li",{children:["P\u0159i\u0159azen\xed ",(0,Re.jsx)("strong",{children:"u\u017eivatel\u016fm"})," pro d\u011bd\u011bn\xed pr\xe1v"]}),(0,Re.jsxs)("li",{children:["Mo\u017enost p\u0159ij\xedmat ",(0,Re.jsx)("strong",{children:"notifikace"})," pro celou roli"]})]})]}),(()=>{const e=L.filter(e=>e.target===y.id).map(e=>{var n,o,t;const i=R.find(n=>n.id===e.source);return{id:null===i||void 0===i?void 0:i.id,name:(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.label)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.name)||"Nezn\xe1m\xfd",position:(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.position)||"",edgeId:e.id}});return(0,Re.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#eff6ff",border:"2px solid #3b82f6",borderRadius:"8px"},children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:"600",color:"#1e40af",fontSize:"0.9rem"},children:[(0,Re.jsx)(ze.g,{icon:Ce.gdJ}),"U\u017eivatel\xe9 s touto rol\xed (",e.length,")"]}),e.length>0?(0,Re.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:e.map((e,n)=>(0,Re.jsxs)("div",{style:{padding:"8px 12px",background:"#dbeafe",borderRadius:"6px",fontSize:"0.85rem",color:"#1e40af",fontWeight:"500",cursor:"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",gap:"2px"},onClick:()=>{const n=R.find(n=>n.id===e.id);n&&(j(n),z(null))},onMouseEnter:e=>e.currentTarget.style.opacity="0.7",onMouseLeave:e=>e.currentTarget.style.opacity="1",title:"Klikn\u011bte pro zobrazen\xed detailu u\u017eivatele",children:[(0,Re.jsxs)("span",{style:{fontSize:"1rem"},children:["\ud83d\udc64 ",e.name]}),e.position&&(0,Re.jsx)("span",{style:{fontSize:"0.75rem",opacity:.7},children:e.position})]},n))}):(0,Re.jsx)("div",{style:{fontSize:"0.8rem",color:"#64748b",fontStyle:"italic"},children:"Role zat\xedm nen\xed p\u0159i\u0159azena \u017e\xe1dn\xe9mu u\u017eivateli"})]})})(),(0,Re.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#fef3c7",border:"2px solid #f59e0b",borderRadius:"8px"},children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:"600",color:"#92400e",fontSize:"0.9rem"},children:[(0,Re.jsx)(ze.g,{icon:Ce.CN3}),"Opr\xe1vn\u011bn\xed modul\u016f"]}),(0,Re.jsx)("div",{style:{fontSize:"0.8rem",color:"#92400e",marginBottom:"10px"},children:"Tato role m\xe1 p\u0159\xedstup k n\xe1sleduj\xedc\xedm modul\u016fm:"}),(0,Re.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:(()=>{const e=B.find(e=>e.id===y.data.roleId),n=(null===e||void 0===e?void 0:e.modules)||{orders:!1,invoices:!1,cashbook:!1};return["orders","invoices","cashbook"].map(e=>{const o=!0===n[e]||1===n[e];return(0,Re.jsxs)("div",{style:{padding:"8px 12px",background:o?"#d1fae5":"#fee2e2",borderRadius:"6px",fontSize:"0.85rem",color:o?"#065f46":"#991b1b",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px"},children:[(0,Re.jsx)("span",{style:{fontSize:"1.2rem"},children:o?"\u2705":"\u274c"}),(0,Re.jsx)("span",{children:{orders:"\ud83d\udce6 Objedn\xe1vky",invoices:"\ud83d\udcc4 Faktury",cashbook:"\ud83d\udcb0 Pokladna"}[e]})]},e)})})()})]})]}),y&&(!y.data.type||"user"===y.data.type)&&(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"U\u017eivatel"}),(0,Re.jsx)(kn,{value:y.data.name,readOnly:!0})]}),(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"Pozice"}),(0,Re.jsx)(kn,{value:y.data.position,readOnly:!0})]}),(0,Re.jsxs)(yn,{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e0e6ed"},children:[(0,Re.jsx)(jn,{style:{color:"#10b981"},children:"\ud83d\udccd V\xfdchoz\xed lokalita (z DB)"}),(0,Re.jsx)(kn,{value:(null===(n=y.data.metadata)||void 0===n?void 0:n.location)||"Neuvedeno",readOnly:!0,style:{background:"#f0fdf4",fontWeight:"500",border:"1px solid #86efac"}})]}),(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{style:{color:"#10b981"},children:"\ud83c\udfe2 V\xfdchoz\xed \xfasek (z DB)"}),(0,Re.jsx)(kn,{value:(null===(t=y.data.metadata)||void 0===t?void 0:t.department)||"Neuvedeno",readOnly:!0,style:{background:"#f0fdf4",fontWeight:"500",border:"1px solid #86efac"}})]})]}),y&&(!y.data.type||"user"===y.data.type)&&(0,Re.jsxs)("div",{style:{marginTop:"24px",padding:"12px",background:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"8px"},children:[(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:"600",color:"#1e40af",fontSize:"0.9rem"},children:[(0,Re.jsx)(ze.g,{icon:Ce.FFg}),"Aktu\xe1ln\xed vztahy v diagramu"]}),(()=>{const e=L.filter(e=>e.target===y.id).map(e=>{var n,o;const t=R.find(n=>n.id===e.source);return{name:(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.name)||"Nezn\xe1m\xfd",edgeId:e.id,type:(null===(o=e.data)||void 0===o?void 0:o.relationshipType)||"prime"}}),n=L.filter(e=>e.source===y.id).map(e=>{var n,o;const t=R.find(n=>n.id===e.target);return{name:(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.name)||"Nezn\xe1m\xfd",edgeId:e.id,type:(null===(o=e.data)||void 0===o?void 0:o.relationshipType)||"prime"}});return(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Re.jsxs)("strong",{style:{fontSize:"0.8rem",color:"#475569",display:"block",marginBottom:"6px"},children:["\u2b06\ufe0f Nad\u0159\xedzen\xed (",e.length,")"]}),e.length>0?(0,Re.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:e.map((e,n)=>(0,Re.jsxs)("div",{style:{padding:"6px 10px",background:"#dbeafe",borderRadius:"4px",fontSize:"0.8rem",color:"#1e40af",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},onClick:()=>{const n=L.find(n=>n.id===e.edgeId);n&&(z(n),j(null))},onMouseEnter:e=>e.currentTarget.style.background="#bfdbfe",onMouseLeave:e=>e.currentTarget.style.background="#dbeafe",title:"Klikn\u011bte pro zobrazen\xed detailu vztahu",children:[e.name,"zastupovani"===e.type&&" (zastupov\xe1n\xed)"]},n))}):(0,Re.jsx)("div",{style:{fontSize:"0.75rem",color:"#94a3b8",fontStyle:"italic"},children:"Nem\xe1 nad\u0159\xedzen\xe9ho v diagramu"})]}),(0,Re.jsxs)("div",{children:[(0,Re.jsxs)("strong",{style:{fontSize:"0.8rem",color:"#475569",display:"block",marginBottom:"6px"},children:["\u2b07\ufe0f Pod\u0159\xedzen\xed (",n.length,")"]}),n.length>0?(0,Re.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:n.map((e,n)=>(0,Re.jsxs)("div",{style:{padding:"6px 10px",background:"#dbeafe",borderRadius:"4px",fontSize:"0.8rem",color:"#1e40af",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},onClick:()=>{const n=L.find(n=>n.id===e.edgeId);n&&(z(n),j(null))},onMouseEnter:e=>e.currentTarget.style.background="#bfdbfe",onMouseLeave:e=>e.currentTarget.style.background="#dbeafe",title:"Klikn\u011bte pro zobrazen\xed detailu vztahu",children:[e.name,"zastupovani"===e.type&&" (zastupov\xe1n\xed)"]},n))}):(0,Re.jsx)("div",{style:{fontSize:"0.75rem",color:"#94a3b8",fontStyle:"italic"},children:"Nem\xe1 pod\u0159\xedzen\xe9 v diagramu"})]})]})})()]}),k&&((e,n,o,t,i,a,l,r,d,s,c,p,x,u,h,g)=>{const v=R.find(e=>e.id===k.source),m=R.find(e=>e.id===k.target);return console.log("\ud83d\udd0d Edge detail - Source node:",{id:null===v||void 0===v?void 0:v.id,dataType:null===v||void 0===v||null===(e=v.data)||void 0===e?void 0:e.type,metadataType:null===v||void 0===v||null===(n=v.data)||void 0===n||null===(o=n.metadata)||void 0===o?void 0:o.type,name:null===v||void 0===v||null===(t=v.data)||void 0===t?void 0:t.name}),console.log("\ud83d\udd0d Edge detail - Target node:",{id:null===m||void 0===m?void 0:m.id,dataType:null===m||void 0===m||null===(i=m.data)||void 0===i?void 0:i.type,metadataType:null===m||void 0===m||null===(a=m.data)||void 0===a||null===(l=a.metadata)||void 0===l?void 0:l.type,name:null===m||void 0===m||null===(r=m.data)||void 0===r?void 0:r.name}),(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)("div",{style:{marginBottom:"16px",padding:"10px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"8px",color:"white",fontSize:"0.9rem",fontWeight:"600",textAlign:"center",boxShadow:"0 2px 8px rgba(102,126,234,0.3)"},children:((e,n,o,t,i,a)=>{const l=(null===v||void 0===v||null===(e=v.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===v||void 0===v||null===(o=v.data)||void 0===o?void 0:o.type)||"user",r=(null===m||void 0===m||null===(t=m.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===m||void 0===m||null===(a=m.data)||void 0===a?void 0:a.type)||"user";console.log("\ud83d\udd0d Detected types:",{sourceType:l,targetType:r});const d=Qo(l,r);return"".concat(d.icon," ").concat(d.label)})()}),(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:((e,n,o,t,i,a)=>{const l=(null===v||void 0===v||null===(e=v.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===v||void 0===v||null===(o=v.data)||void 0===o?void 0:o.type)||"user",r=(null===m||void 0===m||null===(t=m.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===m||void 0===m||null===(a=m.data)||void 0===a?void 0:a.type)||"user";return Qo(l,r).sourceLabel})()}),(0,Re.jsx)(kn,{value:(null===v||void 0===v||null===(d=v.data)||void 0===d?void 0:d.label)||(null===v||void 0===v||null===(s=v.data)||void 0===s?void 0:s.name)||"Nezn\xe1m\xfd",readOnly:!0,style:{fontWeight:"600",color:"#059669"}})]}),(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:((e,n,o,t,i,a)=>{const l=(null===v||void 0===v||null===(e=v.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===v||void 0===v||null===(o=v.data)||void 0===o?void 0:o.type)||"user",r=(null===m||void 0===m||null===(t=m.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===m||void 0===m||null===(a=m.data)||void 0===a?void 0:a.type)||"user";return Qo(l,r).targetLabel})()}),(0,Re.jsx)(kn,{value:(null===m||void 0===m||null===(c=m.data)||void 0===c?void 0:c.label)||(null===m||void 0===m||null===(p=m.data)||void 0===p?void 0:p.name)||"Nezn\xe1m\xfd",readOnly:!0,style:{fontWeight:"600",color:"#3b82f6"}})]}),(0,Re.jsxs)("div",{style:{marginTop:"16px",marginBottom:"16px",padding:"12px",background:"#f0fdf4",border:"2px solid #86efac",borderRadius:"8px",fontSize:"0.85rem",color:"#15803d"},children:[(0,Re.jsx)("strong",{children:"\ud83d\udca1 Jak to funguje:"}),(0,Re.jsxs)("div",{style:{marginTop:"8px",fontSize:"0.8rem",lineHeight:"1.6"},children:[(0,Re.jsx)("strong",{children:(null===v||void 0===v||null===(x=v.data)||void 0===x||null===(u=x.name)||void 0===u?void 0:u.split(" ")[0])||"Nadr\u030c\xedzen\xfd"})," z\xedsk\xe1 pr\xe1va vid\u011bt data od ",(0,Re.jsx)("strong",{children:(null===m||void 0===m||null===(h=m.data)||void 0===h||null===(g=h.name)||void 0===g?void 0:g.split(" ")[0])||"podr\u030c\xedzen\xe9ho"}),".",(0,Re.jsx)("br",{}),(0,Re.jsx)("strong",{children:"Rozsah"})," a ",(0,Re.jsx)("strong",{children:"Moduly"})," ur\u010duj\xed, co p\u0159esn\u011b uvid\xed (objedn\xe1vky/faktury/pokladnu).",(0,Re.jsx)("br",{}),(0,Re.jsx)("strong",{children:"Roz\u0161\xed\u0159en\xe9 lokality/\xfaseky"})," p\u0159id\xe1vaj\xed dal\u0161\xed data mimo z\xe1kladn\xed vztah."]})]}),((e,n,o,t,i,a)=>{const l=(null===v||void 0===v||null===(e=v.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===v||void 0===v||null===(o=v.data)||void 0===o?void 0:o.type)||"user",r=(null===m||void 0===m||null===(t=m.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===m||void 0===m||null===(a=m.data)||void 0===a?void 0:a.type)||"user";return"user"===l&&"user"===r?(0,Re.jsxs)(yn,{children:[(0,Re.jsx)(jn,{children:"Typ vztahu"}),(0,Re.jsxs)(In,{value:le,onChange:e=>re(e.target.value),children:[(0,Re.jsx)("option",{value:"prime",children:"P\u0159\xedm\xfd nad\u0159\xedzen\xfd"}),(0,Re.jsx)("option",{value:"zastupovani",children:"Zastupov\xe1n\xed"}),(0,Re.jsx)("option",{value:"delegovani",disabled:!0,style:{color:"#9ca3af"},children:"Delegov\xe1n\xed (TODO)"}),(0,Re.jsx)("option",{value:"rozsirene",disabled:!0,style:{color:"#9ca3af"},children:"Roz\u0161\xed\u0159en\xe9 opr\xe1vn\u011bn\xed (TODO)"})]})]}):null})()]})})(),k&&((e,n,o,t,i,a,l,r)=>{const d=R.find(e=>e.id===k.source),s=R.find(e=>e.id===k.target),c=(null===d||void 0===d||null===(e=d.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===d||void 0===d||null===(o=d.data)||void 0===o?void 0:o.type)||"user",p=(null===s||void 0===s||null===(t=s.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===s||void 0===s||null===(a=s.data)||void 0===a?void 0:a.type)||"user";return Qo(c,p).showScope?(0,Re.jsxs)(yn,{children:[(0,Re.jsxs)(jn,{children:["Rozsah viditelnosti (Scope)",(0,Re.jsxs)("span",{style:{fontSize:"0.75rem",color:"#059669",fontWeight:"600",marginLeft:"8px"},children:["\u2192 co uvid\xed ",(null===d||void 0===d||null===(l=d.data)||void 0===l||null===(r=l.name)||void 0===r?void 0:r.split(" ")[0])||"nadr\u030c\xedzen\xfd","?"]})]}),(0,Re.jsxs)(In,{value:de,onChange:e=>se(e.target.value),children:[(0,Re.jsx)("option",{value:"OWN",children:"\ud83d\udd12 OWN - Jen sv\xe9 vlastn\xed z\xe1znamy"}),(0,Re.jsx)("option",{value:"TEAM",children:"\ud83d\udc65 TEAM - Z\xe1znamy sv\xe9ho \xfaseku"}),(0,Re.jsx)("option",{value:"LOCATION",children:"\ud83d\udccd LOCATION - V\u0161e v r\xe1mci lokality"}),(0,Re.jsx)("option",{value:"ALL",children:"\ud83c\udf10 ALL - V\u0161e (admin p\u0159\xedstup)"})]}),(0,Re.jsxs)("div",{style:{marginTop:"8px",padding:"8px",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"4px",fontSize:"0.75rem",color:"#475569"},children:[(0,Re.jsx)("strong",{children:"Vysv\u011btlen\xed:"}),(0,Re.jsxs)("ul",{style:{margin:"6px 0 0 16px",padding:0},children:[(0,Re.jsxs)("li",{children:[(0,Re.jsx)("strong",{children:"OWN:"})," Vid\xed jen sv\xe9 z\xe1znamy (vlastn\xed objedn\xe1vky/faktury)"]}),(0,Re.jsxs)("li",{children:[(0,Re.jsx)("strong",{children:"TEAM:"})," Vid\xed z\xe1znamy cel\xe9ho \xfaseku"]}),(0,Re.jsxs)("li",{children:[(0,Re.jsx)("strong",{children:"LOCATION:"})," Vid\xed v\u0161e v r\xe1mci lokality (nap\u0159. v\u0161echny \xfaseky v Beroun\u011b)"]}),(0,Re.jsxs)("li",{children:[(0,Re.jsx)("strong",{children:"ALL:"})," Vid\xed v\u0161echny z\xe1znamy v syst\xe9mu (nad\u0159azen\xfd p\u0159\xedstup)"]})]})]})]}):null})()]}),k&&((e,n,o,t,i,a)=>{const l=R.find(e=>e.id===k.source),r=R.find(e=>e.id===k.target),d=(null===l||void 0===l||null===(e=l.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===l||void 0===l||null===(o=l.data)||void 0===o?void 0:o.type)||"user",s=(null===r||void 0===r||null===(t=r.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===r||void 0===r||null===(a=r.data)||void 0===a?void 0:a.type)||"user";return Qo(d,s).showModules?(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)(Rn,{}),(0,Re.jsxs)(fn,{children:[(0,Re.jsxs)(bn,{children:[(0,Re.jsx)(ze.g,{icon:Ce.pS3}),"Opr\xe1vn\u011bn\xed pro moduly (workflow)"]}),(0,Re.jsxs)("div",{style:{padding:"12px",background:"#f0f9ff",border:"1px solid #bfdbfe",borderRadius:"8px",fontSize:"0.85rem",color:"#1e40af",marginBottom:"16px"},children:[(0,Re.jsx)("strong",{children:"\u2139\ufe0f Jak to funguje:"}),(0,Re.jsx)("div",{style:{marginTop:"6px",fontSize:"0.8rem",color:"#3b82f6"},children:"Vztah roz\u0161\xed\u0159\xed viditelnost dat podle lokalit a \xfasek\u016f. U\u017eivatel MUS\xcd m\xedt z\xe1kladn\xed pr\xe1vo (roli) pro p\u0159\xedstup k modulu."})]}),(0,Re.jsxs)(Tn,{children:[(0,Re.jsxs)(Cn,{children:[(0,Re.jsx)("input",{type:"checkbox",checked:Gn.orders,onChange:e=>Xn(n=>(0,ge.A)((0,ge.A)({},n),{},{orders:e.target.checked}))}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1},children:[(0,Re.jsxs)("span",{children:["\ud83d\udccb ",(0,Re.jsx)("strong",{children:"Objedn\xe1vky"})]}),(0,Re.jsx)("span",{style:{fontSize:"0.75rem",color:"#10b981",background:"#f0fdf4",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"AKTIVN\xcd"})]})]}),Gn.orders&&(0,Re.jsxs)("div",{style:{marginLeft:"32px",marginTop:"6px",marginBottom:"12px"},children:[(0,Re.jsx)("label",{style:{fontSize:"0.8rem",color:"#64748b",display:"block",marginBottom:"4px"},children:"\xdarove\u0148 pr\xe1v pro nad\u0159\xedzen\xe9ho:"}),(0,Re.jsxs)("select",{value:Yn.orders,onChange:e=>Zn(n=>(0,ge.A)((0,ge.A)({},n),{},{orders:e.target.value})),style:{width:"100%",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cbd5e1",fontSize:"0.85rem",cursor:"pointer",background:"white"},children:[(0,Re.jsx)("option",{value:"READ_ONLY",children:"\ud83d\udc41\ufe0f Jen \u010dten\xed (vid\xed z\xe1znamy)"}),(0,Re.jsx)("option",{value:"READ_WRITE",children:"\u270f\ufe0f \u010cten\xed + Editace"}),(0,Re.jsx)("option",{value:"READ_WRITE_DELETE",children:"\ud83d\uddd1\ufe0f Pln\xfd p\u0159\xedstup (i maz\xe1n\xed)"}),(0,Re.jsx)("option",{value:"INHERIT",children:"\ud83d\udd17 D\u011bdit pr\xe1va pod\u0159\xedzen\xe9ho"})]})]}),(0,Re.jsxs)(Cn,{children:[(0,Re.jsx)("input",{type:"checkbox",checked:Gn.invoices,onChange:e=>Xn(n=>(0,ge.A)((0,ge.A)({},n),{},{invoices:e.target.checked}))}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1},children:[(0,Re.jsxs)("span",{children:["\ud83e\uddfe ",(0,Re.jsx)("strong",{children:"Faktury"})]}),(0,Re.jsx)("span",{style:{fontSize:"0.75rem",color:"#10b981",background:"#f0fdf4",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"AKTIVN\xcd"})]})]}),Gn.invoices&&(0,Re.jsxs)("div",{style:{marginLeft:"32px",marginTop:"6px",marginBottom:"12px"},children:[(0,Re.jsx)("label",{style:{fontSize:"0.8rem",color:"#64748b",display:"block",marginBottom:"4px"},children:"\xdarove\u0148 pr\xe1v pro nad\u0159\xedzen\xe9ho:"}),(0,Re.jsxs)("select",{value:Yn.invoices,onChange:e=>Zn(n=>(0,ge.A)((0,ge.A)({},n),{},{invoices:e.target.value})),style:{width:"100%",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cbd5e1",fontSize:"0.85rem",cursor:"pointer",background:"white"},children:[(0,Re.jsx)("option",{value:"READ_ONLY",children:"\ud83d\udc41\ufe0f Jen \u010dten\xed (vid\xed z\xe1znamy)"}),(0,Re.jsx)("option",{value:"READ_WRITE",children:"\u270f\ufe0f \u010cten\xed + Editace"}),(0,Re.jsx)("option",{value:"READ_WRITE_DELETE",children:"\ud83d\uddd1\ufe0f Pln\xfd p\u0159\xedstup (i maz\xe1n\xed)"}),(0,Re.jsx)("option",{value:"INHERIT",children:"\ud83d\udd17 D\u011bdit pr\xe1va pod\u0159\xedzen\xe9ho"})]})]}),(0,Re.jsxs)("div",{style:{marginLeft:"0px",paddingLeft:"0px"},children:[(0,Re.jsxs)(Cn,{children:[(0,Re.jsx)("input",{type:"checkbox",checked:Gn.cashbook,onChange:e=>Xn(n=>(0,ge.A)((0,ge.A)({},n),{},{cashbook:e.target.checked}))}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1},children:[(0,Re.jsxs)("span",{children:["\ud83d\udcb0 ",(0,Re.jsx)("strong",{children:"Pokladna"})]}),(0,Re.jsx)("span",{style:{fontSize:"0.75rem",color:"#f59e0b",background:"#fef3c7",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"\u010c\xc1STE\u010cN\u011a"})]})]}),(0,Re.jsx)("div",{style:{marginLeft:"32px",marginTop:"6px",marginBottom:"6px"},children:(0,Re.jsxs)(Cn,{style:{fontSize:"0.85rem",padding:"4px 8px"},children:[(0,Re.jsx)("input",{type:"checkbox",checked:Gn.cashbookReadonly,onChange:e=>Xn(n=>(0,ge.A)((0,ge.A)({},n),{},{cashbookReadonly:e.target.checked})),disabled:!Gn.cashbook}),(0,Re.jsx)("span",{style:{color:"#64748b"},children:"\ud83d\udcd6 Jen pro \u010dten\xed (read-only)"})]})}),Gn.cashbook&&(0,Re.jsxs)("div",{style:{marginLeft:"32px",marginTop:"6px",marginBottom:"12px"},children:[(0,Re.jsx)("label",{style:{fontSize:"0.8rem",color:"#64748b",display:"block",marginBottom:"4px"},children:"\xdarove\u0148 pr\xe1v pro nad\u0159\xedzen\xe9ho:"}),(0,Re.jsxs)("select",{value:Yn.cashbook,onChange:e=>Zn(n=>(0,ge.A)((0,ge.A)({},n),{},{cashbook:e.target.value})),style:{width:"100%",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cbd5e1",fontSize:"0.85rem",cursor:"pointer",background:"white"},children:[(0,Re.jsx)("option",{value:"READ_ONLY",children:"\ud83d\udc41\ufe0f Jen \u010dten\xed (vid\xed z\xe1znamy)"}),(0,Re.jsx)("option",{value:"READ_WRITE",children:"\u270f\ufe0f \u010cten\xed + Editace"}),(0,Re.jsx)("option",{value:"READ_WRITE_DELETE",children:"\ud83d\uddd1\ufe0f Pln\xfd p\u0159\xedstup (i maz\xe1n\xed)"}),(0,Re.jsx)("option",{value:"INHERIT",children:"\ud83d\udd17 D\u011bdit pr\xe1va pod\u0159\xedzen\xe9ho"})]})]})]}),(0,Re.jsxs)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px dashed #e5e7eb"},children:[(0,Re.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"8px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Pl\xe1novan\xe9 moduly (TODO):"}),(0,Re.jsxs)(Cn,{style:{opacity:.5,cursor:"not-allowed"},children:[(0,Re.jsx)("input",{type:"checkbox",disabled:!0,checked:Gn.contracts,onChange:e=>Xn(n=>(0,ge.A)((0,ge.A)({},n),{},{contracts:e.target.checked}))}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Re.jsx)("span",{children:"\ud83d\udcc4 Smlouvy"}),(0,Re.jsx)("span",{style:{fontSize:"0.7rem",color:"#6b7280"},children:"(p\u0159ipravujeme)"})]})]})]})]}),(0,Re.jsxs)("div",{style:{marginTop:"12px",padding:"10px",background:"#fffbeb",border:"1px solid #fde68a",borderRadius:"6px",fontSize:"0.75rem",color:"#92400e"},children:[(0,Re.jsx)("strong",{children:"\u26a0\ufe0f D\u016fle\u017eit\xe9:"})," Vztah funguje jen pokud m\xe1 u\u017eivatel glob\xe1ln\xed pr\xe1vo (nap\u0159. ",(0,Re.jsx)("code",{style:{background:"#fef3c7",padding:"2px 4px",borderRadius:"3px"},children:"ORDER_EDIT_OWN"}),")."]})]})]}):null})(),k&&((e,n,o,t,i,a)=>{const l=R.find(e=>e.id===k.source),r=R.find(e=>e.id===k.target),d=(null===l||void 0===l||null===(e=l.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===l||void 0===l||null===(o=l.data)||void 0===o?void 0:o.type)||"user",s=(null===r||void 0===r||null===(t=r.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===r||void 0===r||null===(a=r.data)||void 0===a?void 0:a.type)||"user";return Qo(d,s).showExtended?(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)(Rn,{}),(0,Re.jsxs)(fn,{children:[(0,Re.jsxs)(bn,{children:[(0,Re.jsx)(ze.g,{icon:Ce.Pcr}),"Roz\u0161\xed\u0159en\xe9 lokality"]}),(0,Re.jsx)(yn,{children:(0,Re.jsx)(we.A,{value:X,onChange:e=>$(e),options:U,placeholder:"Vyberte lokality...",field:"extendedLocations",multiple:!0,selectStates:lo,setSelectStates:ro,searchStates:so,setSearchStates:co,touchedSelectFields:po,setTouchedSelectFields:xo,toggleSelect:Qn,filterOptions:eo,getOptionLabel:no,hasTriedToSubmit:!1})})]}),(0,Re.jsx)(Rn,{}),(0,Re.jsxs)(fn,{children:[(0,Re.jsxs)(bn,{children:[(0,Re.jsx)(ze.g,{icon:Ce.URI}),"Roz\u0161\xed\u0159en\xe9 \xfaseky"]}),(0,Re.jsx)(yn,{children:(0,Re.jsx)(we.A,{value:oo,onChange:e=>to(e),options:H,placeholder:"Vyberte \xfaseky...",field:"extendedDepartments",multiple:!0,selectStates:lo,setSelectStates:ro,searchStates:so,setSearchStates:co,touchedSelectFields:po,setTouchedSelectFields:xo,toggleSelect:Qn,filterOptions:eo,getOptionLabel:no,hasTriedToSubmit:!1})})]}),(0,Re.jsx)(Rn,{}),(0,Re.jsxs)(fn,{children:[(0,Re.jsxs)(bn,{children:[(0,Re.jsx)(ze.g,{icon:Ce.qIE}),"Kombinace lokalita + \xfasek"]}),(0,Re.jsx)("p",{style:{fontSize:"0.85rem",color:"#6c757d",marginBottom:"12px"},children:'Specifick\xe9 kombinace lokalita+\xfasek (AND logika). Nap\u0159. "jen IT z Berouna".'}),io.length>0?(0,Re.jsxs)(En,{children:[(0,Re.jsx)("thead",{children:(0,Re.jsxs)("tr",{children:[(0,Re.jsx)("th",{children:"Lokalita"}),(0,Re.jsx)("th",{children:"\xdasek"}),(0,Re.jsx)("th",{style:{width:"40px"}})]})}),(0,Re.jsx)("tbody",{children:io.map((e,n)=>{const o=U.find(n=>n.id===e.locationId),t=H.find(n=>n.id===e.departmentId);return(0,Re.jsxs)("tr",{children:[(0,Re.jsx)("td",{children:(null===o||void 0===o?void 0:o.name)||"N/A"}),(0,Re.jsx)("td",{children:(null===t||void 0===t?void 0:t.name)||"N/A"}),(0,Re.jsx)("td",{children:(0,Re.jsx)("button",{onClick:()=>{ao(e=>e.filter((e,o)=>o!==n))},children:(0,Re.jsx)(ze.g,{icon:Ce.GRI})})})]},n)})})]}):(0,Re.jsx)("p",{style:{fontSize:"0.85rem",color:"#adb5bd",fontStyle:"italic",marginTop:"8px"},children:"Zatim zadne kombinace"}),(0,Re.jsxs)(_n,{children:[(0,Re.jsxs)(yn,{style:{marginBottom:0},children:[(0,Re.jsx)(jn,{children:"Lokalita"}),(0,Re.jsxs)(In,{id:"combo-location-select",children:[(0,Re.jsx)("option",{value:"",children:"-- Vyberte lokalitu --"}),U.map(e=>(0,Re.jsxs)("option",{value:e.id,children:[e.name," ",e.code?"(".concat(e.code,")"):""]},e.id))]})]}),(0,Re.jsxs)(yn,{style:{marginBottom:0},children:[(0,Re.jsx)(jn,{children:"\xdasek"}),(0,Re.jsxs)(In,{id:"combo-department-select",children:[(0,Re.jsx)("option",{value:"",children:"-- Vyberte \xfasek --"}),H.map(e=>(0,Re.jsxs)("option",{value:e.id,children:[e.name," ",e.code?"(".concat(e.code,")"):""]},e.id))]})]}),(0,Re.jsx)("button",{onClick:()=>{const e=document.getElementById("combo-location-select"),n=document.getElementById("combo-department-select"),o=e.value,t=n.value;if(o&&t){io.some(e=>e.locationId===o&&e.departmentId===t)||(ao(e=>[...e,{locationId:o,departmentId:t}]),e.value="",n.value="")}},children:"Pridat"})]})]})]}):null})(),k&&((e,n,o,t,i)=>{const a=R.find(e=>e.id===k.source),l=R.find(e=>e.id===k.target);if(!("template"===(null===a||void 0===a||null===(e=a.data)||void 0===e?void 0:e.type)||"template"===(null===l||void 0===l||null===(n=l.data)||void 0===n?void 0:n.type)))return null;const r="template"===(null===a||void 0===a||null===(o=a.data)||void 0===o?void 0:o.type)?a:l;return(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(fn,{children:[(0,Re.jsxs)(bn,{children:[(0,Re.jsx)(ze.g,{icon:Ce.z$e}),"Nastaven\xed notifikac\xed"]}),(0,Re.jsxs)("div",{style:{padding:"12px",background:"#fef3c7",borderRadius:"6px",marginBottom:"12px",border:"1px solid #fbbf24"},children:[(0,Re.jsxs)("div",{style:{fontSize:"0.8rem",color:"#78350f",fontWeight:500},children:["\ud83d\udd14 ",(0,Re.jsx)("strong",{children:null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.name})]}),(0,Re.jsxs)("div",{style:{fontSize:"0.75rem",color:"#92400e",marginTop:"4px"},children:["Bude odes\xedl\xe1na: ","template"===(null===l||void 0===l||null===(i=l.data)||void 0===i?void 0:i.type)?a.data.name:l.data.name]}),(0,Re.jsx)("div",{style:{fontSize:"0.7rem",color:"#92400e",marginTop:"6px",fontStyle:"italic",paddingTop:"6px",borderTop:"1px solid #fbbf24"},children:"\ud83d\udca1 Variantu HTML emailu vyberte v detailu notifika\u010dn\xedho uzlu (klikn\u011bte na uzel)"})]}),(0,Re.jsxs)(yn,{style:{marginBottom:"16px"},children:[(0,Re.jsxs)(jn,{children:["Typ notifikace pro p\u0159\xedjemce",(0,Re.jsx)("span",{style:{color:"#f59e0b",marginLeft:"4px"},children:"*"})]}),(0,Re.jsxs)(In,{value:ie,onChange:e=>ae(e.target.value),children:[(0,Re.jsx)("option",{value:"APPROVAL",children:"\ud83d\udfe0 Po\u017eadavek na schv\xe1len\xed"}),(0,Re.jsx)("option",{value:"INFO",children:"\ud83d\udfe2 Informa\u010dn\xed ozn\xe1men\xed"}),(0,Re.jsx)("option",{value:"BOTH",children:"\ud83d\udd35 Oboje (schv\xe1len\xed + info)"})]}),(0,Re.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"6px",fontStyle:"italic"},children:"\ud83d\udca1 Urgentnost ur\u010d\xed a\u017e ud\xe1lost v procesu. Zde jen definujete charakter notifikace."})]}),(0,Re.jsxs)(Tn,{children:[(0,Re.jsxs)(Cn,{children:[(0,Re.jsx)("input",{type:"checkbox",checked:ee,onChange:e=>ne(e.target.checked)}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Re.jsx)(ze.g,{icon:Ce.y_8,style:{color:"#667eea"}}),(0,Re.jsx)("span",{children:"Poslat emailem"})]})]}),(0,Re.jsxs)(Cn,{children:[(0,Re.jsx)("input",{type:"checkbox",checked:oe,onChange:e=>te(e.target.checked)}),(0,Re.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Re.jsx)(ze.g,{icon:Ce.z$e,style:{color:"#f5576c"}}),(0,Re.jsx)("span",{children:"Zobrazit ve zvone\u010dku (in-app)"})]})]})]}),(0,Re.jsxs)("div",{style:{marginTop:"12px",padding:"10px",background:"#f0fdf4",borderRadius:"6px",fontSize:"0.75rem",color:"#166534",border:"1px solid #86efac"},children:[(0,Re.jsx)("strong",{children:"\u2139\ufe0f Hierarchie rozhodov\xe1n\xed:"}),(0,Re.jsxs)("ol",{style:{margin:"6px 0 0 18px",padding:0},children:[(0,Re.jsx)("li",{children:"Glob\xe1ln\xed nastaven\xed aplikace"}),(0,Re.jsx)("li",{children:"Nastaven\xed tohoto vztahu (zde)"}),(0,Re.jsx)("li",{children:"U\u017eivatelsk\xe9 preference v profilu"})]}),(0,Re.jsx)("div",{style:{marginTop:"6px",fontSize:"0.7rem",color:"#15803d"},children:"Notifikace se ode\u0161le pouze kdy\u017e jsou v\u0161echny 3 \xfarovn\u011b povoleny."})]})]}),(0,Re.jsx)(Rn,{})]})})(),(y||k)&&(0,Re.jsx)(fn,{children:(0,Re.jsxs)("button",{onClick:y?async()=>{y&&(console.log("\ud83d\uddd1\ufe0f Deleting node:",y.id),E(e=>e.filter(e=>e.id!==y.id)),N(e=>e.filter(e=>e.source!==y.id&&e.target!==y.id)),j(null),S(!1),console.log("\u2705 Node removed from UI (will be deleted from DB on next save)"))}:async()=>{k&&(console.log("\ud83d\uddd1\ufe0f Deleting edge:",k),N(e=>e.filter(e=>e.id!==k.id)),z(null),S(!1),console.log("\u2705 Edge removed from UI (will be deleted from DB on next save)"))},style:{width:"100%",padding:"10px 16px",background:"#dc2626",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:"0.9rem",fontWeight:"600",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="#b91c1c",e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px rgba(220, 38, 38, 0.4)"},onMouseLeave:e=>{e.target.style.background="#dc2626",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:[(0,Re.jsx)(ze.g,{icon:Ce.yLS}),(0,Re.jsx)("span",{children:y?"Odstranit uzel":"Odstranit vztah"})]})})]})]})]}),Wo.show&&(0,Re.jsx)(Ln,{onClick:()=>{var e;return null===(e=Wo.onCancel)||void 0===e?void 0:e.call(Wo)},children:(0,Re.jsxs)(Nn,{onClick:e=>e.stopPropagation(),children:[(0,Re.jsx)(On,{children:Wo.icon}),(0,Re.jsx)(Pn,{children:Wo.title}),(0,Re.jsx)(Dn,{children:Wo.message}),Wo.stats&&(0,Re.jsx)(Bn,{children:Object.entries(Wo.stats).map(e=>{let[n,o]=e;return(0,Re.jsxs)("div",{children:[(0,Re.jsxs)("strong",{children:[n,":"]}),(0,Re.jsx)("span",{children:o})]},n)})}),(0,Re.jsxs)(Vn,{children:[Wo.cancelText&&(0,Re.jsx)(Mn,{onClick:Wo.onCancel,children:Wo.cancelText}),(0,Re.jsx)(Mn,{primary:!0,onClick:Wo.onConfirm,children:Wo.confirmText})]})]})}),Oo&&(0,Re.jsx)(Ln,{onClick:e=>{e.target===e.currentTarget&&Po(!1)},children:(0,Re.jsxs)(Nn,{onClick:e=>e.stopPropagation(),style:{maxWidth:"700px"},children:[(0,Re.jsx)(On,{children:"\ud83d\udca1"}),(0,Re.jsx)(Pn,{children:y?"N\xe1pov\u011bda k detailu uzlu":"N\xe1pov\u011bda k detailu vztahu"}),(0,Re.jsx)(Wn,{children:y?(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(Un,{children:[(0,Re.jsxs)("h3",{children:["\ud83d\udccb ",null===(i=y.data)||void 0===i?void 0:i.label]}),(0,Re.jsx)("p",{children:"Panel zobrazuje vztahy tohoto uzlu v diagramu:"}),(0,Re.jsxs)("p",{style:{marginTop:"8px"},children:[(0,Re.jsx)("strong",{children:"\u2b06\ufe0f Nad\u0159\xedzen\xed"})," - komu tento uzel podl\xe9h\xe1",(0,Re.jsx)("br",{}),(0,Re.jsx)("strong",{children:"\u2b07\ufe0f Pod\u0159\xedzen\xed"})," - kdo tomuto uzlu podl\xe9h\xe1"]})]}),(0,Re.jsxs)(Un,{children:[(0,Re.jsx)("h3",{children:"\ud83d\udcbe Ukl\xe1d\xe1n\xed"}),(0,Re.jsxs)("p",{children:["Zm\u011bny se automaticky ukl\xe1daj\xed do ",(0,Re.jsx)("code",{children:"localStorage"}),". Pro trval\xe9 ulo\u017een\xed do DB pou\u017eijte tla\u010d\xedtko ",(0,Re.jsx)("strong",{children:'"\ud83d\udcbe Ulo\u017eit do DB"'}),"."]})]})]}):(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsxs)(Un,{children:[(0,Re.jsxs)("h3",{children:["\ud83d\udd17 ",((e,n)=>{const o=R.find(e=>e.id===(null===k||void 0===k?void 0:k.source)),t=R.find(e=>e.id===(null===k||void 0===k?void 0:k.target));return"".concat((null===o||void 0===o||null===(e=o.data)||void 0===e?void 0:e.label)||"?"," \u2192 ").concat((null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.label)||"?")})()]}),(0,Re.jsxs)("p",{children:[(0,Re.jsx)("strong",{children:"Nad\u0159\xedzen\xfd z\xedsk\xe1v\xe1 pr\xe1va vid\u011bt data od Pod\u0159\xedzen\xe9ho"})," podle nastaven\xed."]})]}),(0,Re.jsxs)(Un,{children:[(0,Re.jsxs)("h3",{children:["\ud83c\udfaf Rozsah (",de,")"]}),(0,Re.jsxs)("p",{children:[(0,Re.jsx)("code",{children:"OWN"})," - vlastn\xed z\xe1znamy pod\u0159\xedzen\xe9ho",(0,Re.jsx)("br",{}),(0,Re.jsx)("code",{children:"TEAM"})," - cel\xfd \xfasek pod\u0159\xedzen\xe9ho",(0,Re.jsx)("br",{}),(0,Re.jsx)("code",{children:"LOCATION"})," - cel\xe1 lokalita pod\u0159\xedzen\xe9ho",(0,Re.jsx)("br",{}),(0,Re.jsx)("code",{children:"ALL"})," - kompletn\xed p\u0159\xedstup"]})]}),(0,Re.jsxs)(Un,{children:[(0,Re.jsx)("h3",{children:"\ud83d\udd10 \xdarove\u0148 pr\xe1v"}),(0,Re.jsx)("p",{children:"Ur\u010duje, CO m\u016f\u017ee nad\u0159\xedzen\xfd d\u011blat se z\xe1znamy pod\u0159\xedzen\xe9ho:"}),(0,Re.jsxs)(Fn,{children:[(0,Re.jsx)("strong",{children:"P\u0159\xedklad:"}),(0,Re.jsxs)("span",{children:["Holovsk\xfd (THP) m\xe1 pr\xe1vo ",(0,Re.jsx)("code",{children:"CREATE + EDIT"})," vlastn\xed objedn\xe1vky.",(0,Re.jsx)("br",{}),"\u010cernhorsk\xfd je nad\u0159\xedzen\xfd s \xfarovn\xed ",(0,Re.jsx)("code",{children:"READ_ONLY"}),".",(0,Re.jsx)("br",{}),"\u2192 \u010cernhorsk\xfd ",(0,Re.jsx)("strong",{children:"vid\xed"})," Holovsk\xe9ho objedn\xe1vky, ale ",(0,Re.jsx)("strong",{children:"nem\u016f\u017ee je editovat"}),"."]})]}),(0,Re.jsxs)("p",{style:{marginTop:"12px",fontSize:"0.85rem"},children:[(0,Re.jsx)("code",{children:"READ_ONLY"})," - vid\xed z\xe1znamy, nem\u016f\u017ee editovat",(0,Re.jsx)("br",{}),(0,Re.jsx)("code",{children:"READ_WRITE"})," - m\u016f\u017ee editovat z\xe1znamy",(0,Re.jsx)("br",{}),(0,Re.jsx)("code",{children:"READ_WRITE_DELETE"})," - pln\xfd p\u0159\xedstup v\u010detn\u011b maz\xe1n\xed",(0,Re.jsx)("br",{}),(0,Re.jsx)("code",{children:"INHERIT"})," - d\u011bd\xed stejn\xe1 pr\xe1va jako pod\u0159\xedzen\xfd"]}),(Gn.orders||Gn.invoices||Gn.cashbook)&&(0,Re.jsxs)("div",{style:{marginTop:"8px",padding:"8px",background:"#f0fdf4",borderRadius:"6px",border:"1px solid #86efac"},children:[(0,Re.jsx)("strong",{style:{fontSize:"0.85rem",color:"#166534"},children:"Aktu\xe1ln\xed nastaven\xed:"}),(0,Re.jsxs)("div",{style:{fontSize:"0.8rem",color:"#166534",marginTop:"4px"},children:[Gn.orders&&"\ud83d\udccb Objedn\xe1vky: ".concat(Yn.orders),(0,Re.jsx)("br",{}),Gn.invoices&&"\ud83e\uddfe Faktury: ".concat(Yn.invoices),(0,Re.jsx)("br",{}),Gn.cashbook&&"\ud83d\udcb0 Pokladna: ".concat(Yn.cashbook)]})]})]}),(0,Re.jsxs)(Un,{children:[(0,Re.jsx)("h3",{children:"\ud83d\udce6 Roz\u0161\xed\u0159en\xe1 opr\xe1vn\u011bn\xed"}),(0,Re.jsxs)("p",{children:[(0,Re.jsx)("strong",{children:"Lokality/\xdaseky:"})," Nad\u0159\xedzen\xfd vid\xed data i z dal\u0161\xedch m\xedst mimo z\xe1kladn\xed vztah.",(0,Re.jsx)("br",{}),(0,Re.jsx)("strong",{children:"Notifikace:"})," ",ee?"Email \u2713":"Email \u2717"," ",oe?"In-app \u2713":"In-app \u2717"]})]}),(0,Re.jsxs)(Un,{children:[(0,Re.jsx)("h3",{children:"\ud83d\udca1 Kompletn\xed p\u0159\xedklad"}),(0,Re.jsx)(Fn,{children:(0,Re.jsxs)("span",{style:{fontSize:"0.85rem"},children:[(0,Re.jsx)("strong",{children:"Situace:"})," Petr je nad\u0159\xedzen\xfd Jana.",(0,Re.jsx)("br",{}),(0,Re.jsx)("strong",{children:"Nastaven\xed:"})," TEAM scope, modul Objedn\xe1vky, \xfarove\u0148 READ_ONLY",(0,Re.jsx)("br",{}),(0,Re.jsx)("br",{}),(0,Re.jsx)("strong",{children:"V\xfdsledek:"}),(0,Re.jsx)("br",{}),"\u2192 Petr ",(0,Re.jsx)("strong",{children:"vid\xed v\u0161echny objedn\xe1vky"})," z Janova \xfaseku (i od koleg\u016f)",(0,Re.jsx)("br",{}),"\u2192 Petr ",(0,Re.jsx)("strong",{children:"nem\u016f\u017ee editovat"})," tyto objedn\xe1vky (jen \u010d\xedst)",(0,Re.jsx)("br",{}),"\u2192 Pokud Jan m\xe1 pr\xe1vo vytv\xe1\u0159et, Petr to pr\xe1vo ",(0,Re.jsx)("strong",{children:"nedostane"})]})})]})]})}),(0,Re.jsx)(Vn,{style:{marginTop:"20px"},children:(0,Re.jsx)(Mn,{primary:!0,onClick:()=>Po(!1),children:"Rozum\xedm"})})]})}),Eo.isOpen&&(0,Re.jsx)(Ve,{onClick:()=>_o({isOpen:!1,title:"",message:"",onConfirm:null}),children:(0,Re.jsxs)(Me,{onClick:e=>e.stopPropagation(),children:[(0,Re.jsxs)(Be,{children:[(0,Re.jsx)(ze.g,{icon:Ce.yLS}),Eo.title]}),(0,Re.jsx)(We,{children:Eo.message}),(0,Re.jsxs)(Ue,{children:[(0,Re.jsx)(Fe,{onClick:()=>_o({isOpen:!1,title:"",message:"",onConfirm:null}),children:"Zru\u0161it"}),(0,Re.jsx)(Fe,{variant:"danger",onClick:Eo.onConfirm,children:"Ano, smazat"})]})]})}),mo&&(0,Re.jsx)(Kn,{mode:bo,onClose:()=>fo(!1),onSave:async(e,n)=>{try{const o=await Ie.jK.token(),t=await Ie.jK.user(),i=(null===t||void 0===t?void 0:t.username)||localStorage.getItem("username"),a="https://erdms.zachranka.cz/api.eeo/",l=await fetch("".concat(a,"/hierarchy/profiles/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:o,username:i,name:e,description:n,set_active:!1})}),r=await l.json();if("PROFILE_EXISTS"===r.code)return{exists:!0,profileName:e};if(!r.success)throw new Error(r.error||"Chyba pri vytvareni profilu");const d=r.profile_id;return await dt(d),await rt(),fo(!1),{success:!0}}catch(o){return console.error("Profile save error:",o),{error:o.message}}},existingProfiles:uo}),Do&&(0,Re.jsx)(Jn,{isOpen:Do,onClose:()=>{Vo(!1),Bo(null)},emailData:Mo})]})}}}]);
//# sourceMappingURL=4696.bf6cd2aa.chunk.js.map