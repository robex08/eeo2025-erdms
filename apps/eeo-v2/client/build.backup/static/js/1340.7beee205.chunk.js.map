{"version":3,"file":"static/js/1340.7beee205.chunk.js","mappings":"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","sources":["components/OrderFormReadOnly.js","components/SmlouvaPreview.js","components/ErrorDialog.js","components/panels/SpisovkaInboxPanel.js","pages/InvoiceEvidencePage.js","../node_modules/lucide-react/src/icons/search.ts","services/apiSmlouvy.js"],"sourcesContent":["/**\n * OrderFormReadOnly - Read-only nhled objednvky\n * \n * Pesn 1:1 kopie OrderForm25 struktury jen pro zobrazen\n * Vetn svinovacch sekc a stejnho poad jako OrderForm25\n */\n\nimport React, { useState, useImperativeHandle, forwardRef } from 'react';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faUser, faBuilding, faFileAlt, faMoneyBillWave, faCalendar,\n  faCheckCircle, faClock, faMapMarkerAlt, faTruck, faChevronUp,\n  faClipboardCheck, faBox, faCoins, faCheck, faTimesCircle, faEdit,\n  faPaperclip, faFile, faDownload\n} from '@fortawesome/free-solid-svg-icons';\nimport { formatDateOnly } from '../utils/format';\nimport { downloadOrderAttachment, downloadInvoiceAttachment } from '../services/apiOrderV2';\n\n// ===================================================================\n// STYLED COMPONENTS - Zkoprovan z OrderForm25\n// ===================================================================\n\nconst FormContainer = styled.div`\n  background: #fafbfc;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst Section = styled.div`\n  background: white;\n  border-radius: 12px;\n  margin-bottom: 0.75rem;\n  border: 2px solid #e5e7eb;\n  overflow: hidden;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst SectionHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.5rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  border-left: 5px solid transparent;\n  position: relative;\n  \n  /* 3D efekt na lev lince */\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 5px;\n    box-shadow: \n      inset 2px 0 3px rgba(0, 0, 0, 0.15),\n      inset -1px 0 2px rgba(255, 255, 255, 0.5);\n  }\n  \n  /* Barevn schmata podle OF25 */\n  ${props => {\n    switch(props.$theme) {\n      case 'grey':\n        return `\n          background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n          border-left-color: #64748b;\n          &:hover { background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); }\n        `;\n      case 'orange':\n        return `\n          background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\n          border-left-color: #f97316;\n          &:hover { background: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%); }\n        `;\n      case 'blue':\n        return `\n          background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\n          border-left-color: #3b82f6;\n          &:hover { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); }\n        `;\n      case 'purple':\n        return `\n          background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);\n          border-left-color: #a855f7;\n          &:hover { background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%); }\n        `;\n      case 'green':\n        return `\n          background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n          border-left-color: #22c55e;\n          &:hover { background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); }\n        `;\n      case 'red':\n        return `\n          background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n          border-left-color: #ef4444;\n          &:hover { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); }\n        `;\n      default:\n        return `\n          background: ${props.$isActive ? '#f8fafc' : '#fff'};\n          &:hover { background: #f1f5f9; }\n        `;\n    }\n  }}\n`;\n\nconst SectionTitle = styled.h3`\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  \n  svg {\n    ${props => {\n      switch(props.$theme) {\n        case 'grey': return 'color: #64748b;';\n        case 'orange': return 'color: #f97316;';\n        case 'blue': return 'color: #3b82f6;';\n        case 'purple': return 'color: #a855f7;';\n        case 'green': return 'color: #22c55e;';\n        case 'red': return 'color: #ef4444;';\n        default: return 'color: #3b82f6;';\n      }\n    }}\n  }\n`;\n\nconst CollapseIcon = styled.div`\n  transition: transform 0.3s ease;\n  transform: ${props => props.$collapsed ? 'rotate(180deg)' : 'rotate(0deg)'};\n  color: #64748b;\n  font-size: 1.2rem;\n`;\n\nconst SectionContent = styled.div`\n  max-height: ${props => props.$collapsed ? '0' : '5000px'};\n  overflow: hidden;\n  transition: max-height 0.3s ease;\n  padding: ${props => props.$collapsed ? '0 1.5rem' : '1.5rem'};\n  border-left: 5px solid transparent;\n  position: relative;\n  background: #fafbfc;\n  \n  /* 3D efekt na lev lince - pokraovn z headeru */\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 5px;\n    box-shadow: \n      inset 2px 0 3px rgba(0, 0, 0, 0.15),\n      inset -1px 0 2px rgba(255, 255, 255, 0.5);\n  }\n  \n  /* Barevn linka podle tmatu */\n  ${props => {\n    switch(props.$theme) {\n      case 'grey': return 'border-left-color: #64748b;';\n      case 'orange': return 'border-left-color: #f97316;';\n      case 'blue': return 'border-left-color: #3b82f6;';\n      case 'purple': return 'border-left-color: #a855f7;';\n      case 'green': return 'border-left-color: #22c55e;';\n      case 'red': return 'border-left-color: #ef4444;';\n      default: return '';\n    }\n  }}\n`;\n\nconst FieldRow = styled.div`\n  display: grid;\n  grid-template-columns: ${props => props.$columns || '1fr'};\n  gap: 1rem;\n  margin-bottom: 1rem;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst FieldGroup = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n`;\n\nconst FieldLabel = styled.div`\n  font-weight: 600;\n  color: #64748b;\n  font-size: 0.85rem;\n  text-transform: uppercase;\n  letter-spacing: 0.025em;\n`;\n\nconst FieldValue = styled.div`\n  font-size: 0.95rem;\n  color: #1e293b;\n  padding: 0.5rem 0;\n  \n  &.empty {\n    color: #94a3b8;\n    font-style: italic;\n  }\n  \n  &.highlight {\n    font-weight: 600;\n    color: #1e40af;\n  }\n`;\n\nconst Badge = styled.span`\n  display: inline-block;\n  padding: 0.25rem 0.75rem;\n  border-radius: 9999px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  background: ${props => props.$bg || '#f1f5f9'};\n  color: ${props => props.$color || '#475569'};\n`;\n\n// Nov komponenty pro lep organizaci\nconst InfoCard = styled.div`\n  background: white;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1rem;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst CardTitle = styled.div`\n  font-weight: 600;\n  color: #475569;\n  font-size: 0.875rem;\n  margin-bottom: 0.75rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 2px solid #e2e8f0;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  \n  svg {\n    color: #64748b;\n    font-size: 1rem;\n  }\n`;\n\nconst DataGrid = styled.div`\n  display: grid;\n  grid-template-columns: ${props => props.$columns || 'repeat(auto-fit, minmax(200px, 1fr))'};\n  gap: 1.25rem;\n  \n  @media (max-width: 768px) {\n    grid-template-columns: 1fr;\n  }\n`;\n\nconst KeyValuePair = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n  min-width: 0;\n`;\n\nconst KeyLabel = styled.div`\n  font-weight: 600;\n  color: #64748b;\n  font-size: 0.8rem;\n  text-transform: uppercase;\n  letter-spacing: 0.025em;\n`;\n\nconst ValueText = styled.div`\n  font-size: 0.95rem;\n  color: #1e293b;\n  word-wrap: break-word;\n  \n  &.empty {\n    color: #94a3b8;\n    font-style: italic;\n  }\n  \n  &.highlight {\n    font-weight: 600;\n    color: #1e40af;\n    font-size: 1.05rem;\n    white-space: nowrap;\n  }\n  \n  &.currency {\n    font-weight: 600;\n    color: #059669;\n    font-size: 1.05rem;\n  }\n`;\n\nconst Divider = styled.div`\n  height: 1px;\n  background: linear-gradient(to right, #e2e8f0, #f1f5f9, #e2e8f0);\n  margin: 1.5rem 0;\n`;\n\nconst ExpandCollapseButton = styled.button`\n  position: sticky;\n  top: 1rem;\n  right: 1rem;\n  float: right;\n  margin-bottom: 1rem;\n  padding: 0.5rem 1rem;\n  background: #3b82f6;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.2s;\n  z-index: 10;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n  \n  &:hover {\n    background: #2563eb;\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);\n  }\n`;\n\nconst EditInvoiceButton = styled.button`\n  padding: 0.5rem 1rem;\n  background: #f97316;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.2s;\n  box-shadow: 0 2px 8px rgba(249, 115, 22, 0.3);\n  \n  &:hover {\n    background: #ea580c;\n    box-shadow: 0 4px 12px rgba(249, 115, 22, 0.4);\n    transform: translateY(-1px);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n`;\n\nconst OrderFormReadOnly = forwardRef(({ orderData, onCollapseChange, onEditInvoice, canEditInvoice = true, token, username }, ref) => {\n  // State pro svinovac sekce\n  const [collapsed, setCollapsed] = useState({\n    objednatel: false,\n    schvaleni: false,\n    dodavatel: false,\n    detaily: false,\n    dodani: false,\n    fakturace: false,\n    poznamky: false,\n    registr: false,\n    vecna_spravnost: false,\n    dokonceni: false,\n    prilohy: false\n  });\n\n  const toggleSection = (section) => {\n    setCollapsed(prev => {\n      const newCollapsed = { ...prev, [section]: !prev[section] };\n      // Notify parent about change\n      if (onCollapseChange) {\n        const hasAnyCollapsed = Object.values(newCollapsed).some(val => val === true);\n        onCollapseChange(hasAnyCollapsed);\n      }\n      return newCollapsed;\n    });\n  };\n\n  const collapseAll = () => {\n    const allCollapsed = {};\n    Object.keys(collapsed).forEach(key => {\n      allCollapsed[key] = true;\n    });\n    setCollapsed(allCollapsed);\n    if (onCollapseChange) {\n      onCollapseChange(true);\n    }\n  };\n\n  const expandAll = () => {\n    const allExpanded = {};\n    Object.keys(collapsed).forEach(key => {\n      allExpanded[key] = false;\n    });\n    setCollapsed(allExpanded);\n    if (onCollapseChange) {\n      onCollapseChange(false);\n    }\n  };\n\n  const areAllCollapsed = Object.values(collapsed).every(val => val === true);\n  const areAllExpanded = Object.values(collapsed).every(val => val === false);\n\n  // Export collapse functions via ref\n  useImperativeHandle(ref, () => ({\n    collapseAll,\n    expandAll,\n    areAllCollapsed,\n    areAllExpanded\n  }));\n\n  if (!orderData) {\n    return (\n      <div style={{ padding: '3rem', textAlign: 'center', color: '#94a3b8' }}>\n        <FontAwesomeIcon icon={faFileAlt} size=\"3x\" style={{ marginBottom: '1rem', opacity: 0.3 }} />\n        <div>dn data k zobrazen</div>\n      </div>\n    );\n  }\n\n  const formatCurrency = (value) => {\n    if (!value) return '';\n    return `${parseFloat(value).toLocaleString('cs-CZ')} K`;\n  };\n\n  const getWorkflowBadges = () => {\n    if (!orderData.stav_workflow_kod || !Array.isArray(orderData.stav_workflow_kod)) return null;\n    \n    const badgeColors = {\n      'SCHVALENA': { bg: '#dcfce7', color: '#166534' },\n      'ODESLANA': { bg: '#dbeafe', color: '#1e40af' },\n      'POTVRZENA': { bg: '#e0e7ff', color: '#4338ca' },\n      'NEUVEREJNIT': { bg: '#fef3c7', color: '#92400e' },\n      'FAKTURACE': { bg: '#fce7f3', color: '#9f1239' },\n      'VECNA_SPRAVNOST': { bg: '#f3e8ff', color: '#6b21a8' },\n      'ZKONTROLOVANA': { bg: '#d1fae5', color: '#065f46' },\n      'DOKONCENA': { bg: '#ccfbf1', color: '#115e59' }\n    };\n\n    return orderData.stav_workflow_kod.map((kod, index) => {\n      const colors = badgeColors[kod] || { bg: '#f1f5f9', color: '#475569' };\n      return (\n        <React.Fragment key={kod}>\n          <Badge $bg={colors.bg} $color={colors.color} style={{ marginBottom: '0.5rem' }}>\n            {kod.replace('_', ' ')}\n          </Badge>\n          {index < orderData.stav_workflow_kod.length - 1 && (\n            <span style={{ margin: '0 0.5rem', color: '#64748b', fontWeight: '600' }}></span>\n          )}\n        </React.Fragment>\n      );\n    });\n  };\n\n  return (\n    <FormContainer>\n      {/* SEKCE 1: INFORMACE O OBJEDNATELI */}\n      <Section>\n        <SectionHeader $theme=\"grey\" $isActive={!collapsed.objednatel} onClick={() => toggleSection('objednatel')}>\n          <SectionTitle $theme=\"grey\">\n            <FontAwesomeIcon icon={faUser} />\n            Informace o objednateli\n          </SectionTitle>\n          <CollapseIcon $collapsed={collapsed.objednatel}>\n            <FontAwesomeIcon icon={faChevronUp} />\n          </CollapseIcon>\n        </SectionHeader>\n        <SectionContent $collapsed={collapsed.objednatel} $theme=\"grey\">\n          {/* Objednatel */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faUser} />\n              Objednatel\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {(() => {\n                    const enriched = orderData._enriched?.uzivatel || orderData._enriched?.objednatel;\n                    if (enriched) {\n                      const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                      const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                      return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                    }\n                    return orderData.uzivatel?.cele_jmeno || orderData.jmeno || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>\n                  {(() => {\n                    const enriched = orderData._enriched?.uzivatel || orderData._enriched?.objednatel;\n                    return enriched?.telefon || orderData.objednatel_telefon || orderData.uzivatel?.telefon || orderData.telefon || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\" style={{marginTop: '1rem'}}>\n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>\n                  {(() => {\n                    const enriched = orderData._enriched?.uzivatel || orderData._enriched?.objednatel;\n                    return enriched?.email || orderData.uzivatel?.email || orderData.email || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n\n          {/* Garant */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faCheckCircle} />\n              Garant objednvky\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {(() => {\n                    const enriched = orderData._enriched?.garant_uzivatel;\n                    if (enriched) {\n                      const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                      const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                      return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                    }\n                    return orderData.garant_uzivatel?.cele_jmeno || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.garant_uzivatel?.telefon || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\" style={{marginTop: '1rem'}}>\n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.garant_uzivatel?.email || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n        </SectionContent>\n      </Section>\n\n      {/* SEKCE 2: SCHVLEN NKUPU PO */}\n      <Section>\n        <SectionHeader $theme=\"grey\" $isActive={!collapsed.schvaleni} onClick={() => toggleSection('schvaleni')}>\n          <SectionTitle $theme=\"grey\">\n            <FontAwesomeIcon icon={faClipboardCheck} />\n            Schvlen nkupu PO\n          </SectionTitle>\n          <CollapseIcon $collapsed={collapsed.schvaleni}>\n            <FontAwesomeIcon icon={faChevronUp} />\n          </CollapseIcon>\n        </SectionHeader>\n        <SectionContent $collapsed={collapsed.schvaleni} $theme=\"grey\">\n          {/* Zkladn informace o objednvce */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faFileAlt} />\n              Zkladn daje\n            </CardTitle>\n            <KeyValuePair style={{ marginBottom: '1rem' }}>\n              <KeyLabel>Pedmt objednvky</KeyLabel>\n              <ValueText className=\"highlight\">{orderData.predmet || ''}</ValueText>\n            </KeyValuePair>\n            \n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>slo objednvky</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {orderData.cislo_objednavky || `#${orderData.id}`}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Datum objednvky</KeyLabel>\n                <ValueText>\n                  {orderData.dt_objednavky ? formatDateOnly(orderData.dt_objednavky) : ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\">\n              <KeyValuePair style={{textAlign: 'right'}}>\n                <KeyLabel style={{textAlign: 'right'}}>Max. cena s DPH</KeyLabel>\n                <ValueText className=\"currency\" style={{textAlign: 'right'}}>\n                  {formatCurrency(orderData.max_cena_s_dph)}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n\n          {/* Pkazce */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faUser} />\n              Pkazce rozpotu\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {(() => {\n                    const enriched = orderData._enriched?.prikazce;\n                    if (enriched) {\n                      const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                      const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                      return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                    }\n                    return orderData.prikazce?.cele_jmeno || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.prikazce?.telefon || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\" style={{marginTop: '1rem'}}>\n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.prikazce?.email || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n\n          {/* Schvalovatel */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faCheckCircle} />\n              Schvalovatel\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {(() => {\n                    const enriched = orderData._enriched?.schvalovatel;\n                    if (enriched) {\n                      const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                      const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                      return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                    }\n                    return orderData.schvalovatel?.cele_jmeno || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.schvalovatel?.telefon || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\" style={{marginTop: '1rem'}}>\n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.schvalovatel?.email || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n\n          {/* Stediska */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faBuilding} />\n              Stediska\n            </CardTitle>\n            <KeyValuePair>\n              <ValueText>\n                {(() => {\n                  // Backend vrac _enriched.strediska s nzvy\n                  if (orderData._enriched?.strediska && Array.isArray(orderData._enriched.strediska)) {\n                    return orderData._enriched.strediska\n                      .map(s => s.nazev || s.kod)\n                      .join(', ') || '';\n                  }\n                  // Fallback: jen kdy\n                  if (orderData.strediska_kod && Array.isArray(orderData.strediska_kod)) {\n                    return orderData.strediska_kod.join(', ');\n                  }\n                  return '';\n                })()}\n              </ValueText>\n            </KeyValuePair>\n          </InfoCard>\n\n          {/* Financovn */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faCoins} />\n              Zpsob financovn a workflow\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Typ financovn</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {orderData.financovani?.typ_nazev || orderData.financovani?.typ || ''}\n                </ValueText>\n              </KeyValuePair>\n\n              {/* LP - Limitovan psliby */}\n              {orderData.financovani?.lp_nazvy && orderData.financovani.lp_nazvy.length > 0 && (\n                <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                  <KeyLabel>Limitovan psliby</KeyLabel>\n                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem', marginTop: '0.5rem' }}>\n                    {orderData.financovani.lp_nazvy.map((lp, idx) => {\n                      let lpText = '';\n                      if (typeof lp === 'object') {\n                        const kod = lp.cislo_lp || lp.kod || lp.id;\n                        const popis = lp.nazev || lp.nazev_uctu || lp.label;\n                        lpText = kod && popis ? `${kod} - ${popis}` : (popis || kod || 'LP');\n                      } else {\n                        lpText = String(lp);\n                      }\n                      return (\n                        <Badge key={idx} $bg=\"#dbeafe\" $color=\"#1e40af\">\n                          {lpText}\n                        </Badge>\n                      );\n                    })}\n                  </div>\n                </KeyValuePair>\n              )}\n\n              {/* Smlouva - dynamick pole */}\n              {(() => {\n                const typKod = orderData.financovani?.typ_kod || orderData.financovani?.typ || orderData.zpusob_financovani;\n                const isSmlouva = typKod === 'SMLOUVA' || typKod?.toUpperCase?.() === 'SMLOUVA';\n                \n                if (isSmlouva) {\n                  return (\n                    <>\n                      <KeyValuePair>\n                        <KeyLabel>slo smlouvy</KeyLabel>\n                        <ValueText>{orderData.financovani?.cislo_smlouvy || orderData.cislo_smlouvy || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                      <KeyValuePair>\n                        <KeyLabel>Poznmka ke smlouv</KeyLabel>\n                        <ValueText>{orderData.financovani?.smlouva_poznamka || orderData.smlouva_poznamka || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                    </>\n                  );\n                }\n                return null;\n              })()}\n\n              {/* Individuln schvlen - dynamick pole */}\n              {(() => {\n                const typKod = orderData.financovani?.typ_kod || orderData.financovani?.typ || orderData.zpusob_financovani;\n                const isIndividualni = typKod === 'INDIVIDUALNI_SCHVALENI' || typKod?.toUpperCase?.() === 'INDIVIDUALNI_SCHVALENI' || \n                                      typKod === 'INDIVIDUALNI SCHVALENI' || typKod?.includes?.('INDIVIDUALNI');\n                \n                if (isIndividualni) {\n                  return (\n                    <>\n                      <KeyValuePair>\n                        <KeyLabel>slo vzvy</KeyLabel>\n                        <ValueText>{orderData.financovani?.individualni_schvaleni || orderData.individualni_schvaleni || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                      <KeyValuePair>\n                        <KeyLabel>Poznmka</KeyLabel>\n                        <ValueText>{orderData.financovani?.individualni_poznamka || orderData.individualni_poznamka || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                    </>\n                  );\n                }\n                return null;\n              })()}\n\n              {/* Pojistn udlost - dynamick pole */}\n              {(() => {\n                const typKod = orderData.financovani?.typ_kod || orderData.financovani?.typ || orderData.zpusob_financovani;\n                const isPojistna = typKod === 'POJISTNA_UDALOST' || typKod?.toUpperCase?.() === 'POJISTNA_UDALOST' ||\n                                  typKod === 'POJISTNA UDALOST' || typKod?.includes?.('POJISTNA');\n                \n                if (isPojistna) {\n                  return (\n                    <>\n                      <KeyValuePair>\n                        <KeyLabel>slo pojistn udlosti</KeyLabel>\n                        <ValueText>{orderData.financovani?.pojistna_udalost_cislo || orderData.pojistna_udalost_cislo || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                      <KeyValuePair>\n                        <KeyLabel>Poznmka k pojistn udlosti</KeyLabel>\n                        <ValueText>{orderData.financovani?.pojistna_udalost_poznamka || orderData.pojistna_udalost_poznamka || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                    </>\n                  );\n                }\n                return null;\n              })()}\n\n              {/* Workflow stavy */}\n              <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                <KeyLabel>Stavy workflow</KeyLabel>\n                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem', alignItems: 'center', marginTop: '0.5rem' }}>\n                  {getWorkflowBadges()}\n                </div>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n        </SectionContent>\n      </Section>\n\n      {/* SEKCE 3: DODAVATEL */}\n      <Section>\n        <SectionHeader $theme=\"orange\" $isActive={!collapsed.dodavatel} onClick={() => toggleSection('dodavatel')}>\n          <SectionTitle $theme=\"orange\">\n            <FontAwesomeIcon icon={faBuilding} />\n            Dodavatel\n          </SectionTitle>\n          <CollapseIcon $collapsed={collapsed.dodavatel}>\n            <FontAwesomeIcon icon={faChevronUp} />\n          </CollapseIcon>\n        </SectionHeader>\n        <SectionContent $collapsed={collapsed.dodavatel} $theme=\"orange\">\n          {/* Zkladn daje dodavatele */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faBuilding} />\n              Zkladn daje\n            </CardTitle>\n            <KeyValuePair style={{ marginBottom: '1rem' }}>\n              <KeyLabel>Nzev dodavatele</KeyLabel>\n              <ValueText className=\"highlight\">{orderData.dodavatel_nazev || ''}</ValueText>\n            </KeyValuePair>\n            \n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>IO</KeyLabel>\n                <ValueText>{orderData.dodavatel_ico || ''}</ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>DI</KeyLabel>\n                <ValueText>{orderData.dodavatel_dic || ''}</ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <KeyValuePair style={{ marginTop: '1rem' }}>\n              <KeyLabel>Adresa</KeyLabel>\n              <ValueText>{orderData.dodavatel_adresa || ''}</ValueText>\n            </KeyValuePair>\n          </InfoCard>\n\n          {/* Kontaktn osoba */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faUser} />\n              Kontaktn osoba\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText>{orderData.dodavatel_kontakt_jmeno || ''}</ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>{orderData.dodavatel_kontakt_email || ''}</ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>{orderData.dodavatel_kontakt_telefon || ''}</ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n        </SectionContent>\n      </Section>\n\n      {/* SEKCE 5: DETAILY OBJEDNVKY */}\n      {orderData.polozky && orderData.polozky.length > 0 && (\n        <Section>\n          <SectionHeader $theme=\"orange\" $isActive={!collapsed.detaily} onClick={() => toggleSection('detaily')}>\n            <SectionTitle $theme=\"orange\">\n              <FontAwesomeIcon icon={faBox} />\n              Detaily objednvky ({orderData.polozky_count || orderData.polozky.length} {orderData.polozky.length === 1 ? 'poloka' : 'poloek'})\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.detaily}>\n              <FontAwesomeIcon icon={faChevronUp} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.detaily} $theme=\"orange\">\n            <FieldRow>\n              <FieldGroup>\n                <FieldLabel>Druh objednvky</FieldLabel>\n                <FieldValue>\n                  {orderData._enriched?.druh_objednavky?.nazev || \n                   orderData.druh_objednavky_nazev || \n                   orderData.druh_objednavky || \n                   ''}\n                </FieldValue>\n              </FieldGroup>\n            </FieldRow>\n\n            <div style={{ marginTop: '1.5rem' }}>\n              <div style={{ fontWeight: '600', marginBottom: '1rem', color: '#374151' }}>\n                Poloky objednvky\n              </div>\n              {orderData.polozky.map((polozka, idx) => (\n                <div key={idx} style={{ \n                  padding: '1rem', \n                  background: '#fafafa', \n                  border: '1px solid #e5e7eb',\n                  borderRadius: '8px', \n                  marginBottom: '1rem' \n                }}>\n                  <div style={{ fontWeight: '600', color: '#374151', marginBottom: '1rem', fontSize: '0.9rem', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\n                    <span>POLOKA {idx + 1}</span>\n                    {/* LP kd poloky - najt v orderData.financovani.lp_nazvy podle lp_id */}\n                    {polozka.lp_id && (() => {\n                      // Najt LP podle ID v orderData.financovani.lp_nazvy\n                      const lpData = orderData.financovani?.lp_nazvy?.find(lp => lp.id === polozka.lp_id);\n                      \n                      if (!lpData) return null;\n                      \n                      return (\n                        <Badge \n                          $bg={polozka.lp_je_platne !== false ? '#dcfce7' : '#fee2e2'}\n                          $color={polozka.lp_je_platne !== false ? '#166534' : '#991b1b'}\n                        >\n                           LP: {lpData.cislo_lp} - {lpData.nazev}\n                        </Badge>\n                      );\n                    })()}\n                  </div>\n\n                  <FieldRow>\n                    <FieldGroup>\n                      <FieldLabel>Nzev / popis</FieldLabel>\n                      <FieldValue>{polozka.popis || ''}</FieldValue>\n                    </FieldGroup>\n                  </FieldRow>\n\n                  <FieldRow $columns=\"1fr auto 1fr\">\n                    <FieldGroup>\n                      <FieldLabel>Cena bez DPH</FieldLabel>\n                      <FieldValue>{formatCurrency(polozka.cena_bez_dph)}</FieldValue>\n                    </FieldGroup>\n                    \n                    <FieldGroup>\n                      <FieldLabel>DPH</FieldLabel>\n                      <FieldValue>{polozka.sazba_dph || '21'}%</FieldValue>\n                    </FieldGroup>\n                    \n                    <FieldGroup>\n                      <FieldLabel>Cena s DPH</FieldLabel>\n                      <FieldValue className=\"highlight\">\n                        {formatCurrency(polozka.cena_s_dph)}\n                      </FieldValue>\n                    </FieldGroup>\n                  </FieldRow>\n\n                  {/* Umstn - sek, budova, mstnost z JSON polozky */}\n                  {(polozka.usek_kod || polozka.budova_kod || polozka.mistnost_kod || polozka.poznamka) && (\n                    <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px dashed #d1d5db' }}>\n                      <div style={{ fontWeight: '600', color: '#6b7280', marginBottom: '0.75rem', fontSize: '0.85rem' }}>\n                        UMSTN MAJETKU\n                      </div>\n                      <FieldRow $columns=\"1fr 1fr 1fr\">\n                        {polozka.usek_kod && (\n                          <FieldGroup>\n                            <FieldLabel>sek</FieldLabel>\n                            <FieldValue>{polozka.usek_kod}</FieldValue>\n                          </FieldGroup>\n                        )}\n                        {polozka.budova_kod && (\n                          <FieldGroup>\n                            <FieldLabel>Budova</FieldLabel>\n                            <FieldValue>{polozka.budova_kod}</FieldValue>\n                          </FieldGroup>\n                        )}\n                        {polozka.mistnost_kod && (\n                          <FieldGroup>\n                            <FieldLabel>Mstnost</FieldLabel>\n                            <FieldValue>{polozka.mistnost_kod}</FieldValue>\n                          </FieldGroup>\n                        )}\n                      </FieldRow>\n                      {(polozka.usek_kod || polozka.budova_kod || polozka.mistnost_kod) && (\n                        <FieldRow style={{ marginTop: '0.5rem' }}>\n                          <FieldGroup>\n                            <FieldLabel>Poznmka k mstu</FieldLabel>\n                            <FieldValue>{polozka.poznamka || <span style={{color: '#9ca3af'}}>---</span>}</FieldValue>\n                          </FieldGroup>\n                        </FieldRow>\n                      )}\n                    </div>\n                  )}\n                </div>\n              ))}\n\n              <div style={{ marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '2px solid #e5e7eb', display: 'flex', justifyContent: 'flex-end', alignItems: 'center', gap: '1rem' }}>\n                <div style={{ fontWeight: '600', fontSize: '1.1rem', color: '#374151' }}>Celkem s DPH:</div>\n                <div style={{ fontWeight: '700', fontSize: '1.3rem', color: '#1e40af' }}>\n                  {formatCurrency(orderData.polozky_celkova_cena_s_dph)}\n                </div>\n              </div>\n            </div>\n\n            {/* Poznmka k objednvce */}\n            <FieldRow style={{ marginTop: '1.5rem' }}>\n              <FieldGroup>\n                <FieldLabel>Poznmka k objednvce</FieldLabel>\n                <FieldValue>{orderData.poznamka_objednavky || orderData.poznamka || <span style={{color: '#9ca3af'}}>---</span>}</FieldValue>\n              </FieldGroup>\n            </FieldRow>\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 5: DODN */}\n      <Section>\n        <SectionHeader $theme=\"orange\" $isActive={!collapsed.dodani} onClick={() => toggleSection('dodani')}>\n          <SectionTitle $theme=\"orange\">\n            <FontAwesomeIcon icon={faTruck} />\n            Dodn\n          </SectionTitle>\n          <CollapseIcon $collapsed={collapsed.dodani}>\n            <FontAwesomeIcon icon={faChevronUp} />\n          </CollapseIcon>\n        </SectionHeader>\n        <SectionContent $collapsed={collapsed.dodani} $theme=\"orange\">\n          <InfoCard>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Msto dodn</KeyLabel>\n                <ValueText>{orderData.misto_dodani || ''}</ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Pedpokldan termn dodn</KeyLabel>\n                <ValueText>\n                  {orderData.dt_predpokladany_termin_dodani \n                    ? formatDateOnly(orderData.dt_predpokladany_termin_dodani) \n                    : ''}\n                </ValueText>\n              </KeyValuePair>\n\n              <KeyValuePair>\n                <KeyLabel>Zruka</KeyLabel>\n                <ValueText>{orderData.zaruka || <span style={{color: '#9ca3af'}}>---</span>}</ValueText>\n              </KeyValuePair>\n\n              {orderData.dt_akceptace && (\n                <>\n                  <KeyValuePair>\n                    <KeyLabel>Datum akceptace dodavatelem</KeyLabel>\n                    <ValueText>\n                      {formatDateOnly(orderData.dt_akceptace)}\n                    </ValueText>\n                  </KeyValuePair>\n                  \n                  <KeyValuePair>\n                    <KeyLabel>Potvrdil dodavatel</KeyLabel>\n                    <ValueText>\n                      {(() => {\n                        const enriched = orderData._enriched?.dodavatel_potvrdil;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return orderData.dodavatel_potvrdil_jmeno || '';\n                      })()}\n                    </ValueText>\n                  </KeyValuePair>\n                </>\n              )}\n            </DataGrid>\n          </InfoCard>\n        </SectionContent>\n      </Section>\n\n      {/* SEKCE 6: UVEEJNN V REGISTRU SMLUV */}\n      {('zverejnit' in orderData) && (\n        <Section>\n          <SectionHeader $theme=\"blue\" $isActive={!collapsed.registr} onClick={() => toggleSection('registr')}>\n            <SectionTitle $theme=\"blue\">\n              <FontAwesomeIcon icon={faFileAlt} />\n              Rozhodnut o zveejnn v registru smluv\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.registr}>\n              <FontAwesomeIcon icon={faChevronUp} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.registr} $theme=\"blue\">\n            {(() => {\n              // Robustn kontrola - pevedeme na string a porovnme\n              const jeZverejnit = String(orderData.zverejnit) === '1';\n              \n              return (\n                <InfoCard>\n                  <DataGrid $columns=\"1fr 1fr\">\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>M bt zveejnna v registru smluv</KeyLabel>\n                      <div style={{ \n                        display: 'inline-flex',\n                        alignItems: 'center',\n                        gap: '0.5rem',\n                        padding: '0.5rem 1rem',\n                        background: jeZverejnit ? '#dcfce7' : '#fee2e2',\n                        border: `2px solid ${jeZverejnit ? '#16a34a' : '#ef4444'}`,\n                        borderRadius: '8px',\n                        color: jeZverejnit ? '#166534' : '#991b1b',\n                        fontWeight: '600',\n                        marginTop: '0.5rem'\n                      }}>\n                        <FontAwesomeIcon icon={jeZverejnit ? faCheckCircle : faTimesCircle} />\n                        {jeZverejnit ? 'ANO' : 'NE'}\n                      </div>\n                    </KeyValuePair>\n\n                    {/* Pokud NE (0), zobraz info e nebyla zveejnna */}\n                    {!jeZverejnit && (\n                      <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                        <ValueText style={{ color: '#6b7280', fontStyle: 'italic' }}>\n                          Objednvka nebyla zveejnna v registru smluv.\n                        </ValueText>\n                      </KeyValuePair>\n                    )}\n\n                    {/* Datum a ID se zobraz POUZE pokud m bt zveejnna */}\n                    {jeZverejnit && orderData.dt_zverejneni && (\n                      <>\n                        <KeyValuePair>\n                          <KeyLabel>Datum zveejnn</KeyLabel>\n                          <ValueText>{formatDateOnly(orderData.dt_zverejneni)}</ValueText>\n                        </KeyValuePair>\n                        <KeyValuePair>\n                          <KeyLabel>Zveejnil</KeyLabel>\n                          <ValueText>\n                            {(() => {\n                              const enriched = orderData._enriched?.zverejnil;\n                              if (enriched) {\n                                const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                                const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                                return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                              }\n                              return orderData.zverejnil_jmeno || '';\n                            })()}\n                          </ValueText>\n                        </KeyValuePair>\n                      </>\n                    )}\n\n                    {jeZverejnit && orderData.registr_iddt && (\n                      <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                        <KeyLabel>ID smlouvy v registru</KeyLabel>\n                        <ValueText>{orderData.registr_iddt}</ValueText>\n                      </KeyValuePair>\n                    )}\n                  </DataGrid>\n                </InfoCard>\n              );\n            })()}\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 7: FAKTURY */}\n      {orderData.faktury && orderData.faktury.length > 0 && (\n        <Section data-section=\"faktury\">\n          <SectionHeader $theme=\"blue\" $isActive={!collapsed.fakturace} onClick={() => toggleSection('fakturace')}>\n            <SectionTitle $theme=\"blue\">\n              <FontAwesomeIcon icon={faMoneyBillWave} />\n              Fakturace k objednvce ({orderData.faktury.length})\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.fakturace}>\n              <FontAwesomeIcon icon={faChevronUp} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.fakturace} $theme=\"blue\">\n            {orderData.faktury.map((faktura, index) => {\n              const isVecnaPotvrzena = faktura.vecna_spravnost_potvrzeno === 1;\n              return (\n              <div key={faktura.id || index} style={{\n                border: '2px solid #3b82f6',\n                borderRadius: '12px',\n                padding: '0',\n                marginBottom: index < orderData.faktury.length - 1 ? '1.5rem' : 0,\n                background: isVecnaPotvrzena ? '#f0fdf4' : '#ffffff',\n                boxShadow: '0 2px 8px rgba(0, 0, 0, 0.08)',\n                overflow: 'hidden'\n              }}>\n                {/* Zhlav faktury - vrazn */}\n                <div style={{\n                  background: 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)',\n                  color: 'white',\n                  padding: '1rem 1.25rem',\n                  fontWeight: '700',\n                  fontSize: '1.1rem',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'space-between',\n                  gap: '1rem',\n                  borderBottom: '3px solid #1e40af',\n                  letterSpacing: '0.5px',\n                  textTransform: 'uppercase'\n                }}>\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\n                    <FontAwesomeIcon icon={faMoneyBillWave} style={{ fontSize: '1.2rem' }} />\n                    Faktura #{index + 1}\n                    {faktura.fa_cislo_vema && (\n                      <span style={{ \n                        fontWeight: '600',\n                        fontSize: '0.9rem',\n                        background: 'rgba(255, 255, 255, 0.2)',\n                        padding: '0.25rem 0.75rem',\n                        borderRadius: '6px',\n                        letterSpacing: 'normal',\n                        textTransform: 'none'\n                      }}>\n                        {faktura.fa_cislo_vema}\n                      </span>\n                    )}\n                  </div>\n                  {onEditInvoice && canEditInvoice && (\n                    <EditInvoiceButton \n                      onClick={(e) => {\n                        e.stopPropagation();\n                        onEditInvoice(faktura);\n                      }}\n                      style={{\n                        background: 'rgba(255, 255, 255, 0.25)',\n                        color: 'white',\n                        border: '1px solid rgba(255, 255, 255, 0.4)',\n                        padding: '0.5rem 1rem',\n                        fontWeight: '600'\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.background = 'rgba(255, 255, 255, 0.35)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.background = 'rgba(255, 255, 255, 0.25)';\n                      }}\n                    >\n                      <FontAwesomeIcon icon={faEdit} />\n                      Upravit\n                    </EditInvoiceButton>\n                  )}\n                </div>\n\n                {/* Obsah faktury */}\n                <div style={{ padding: '1.25rem' }}>\n                <DataGrid $columns=\"1fr 1fr\">\n                  <KeyValuePair>\n                    <KeyLabel>slo faktury</KeyLabel>\n                    <ValueText>{faktura.fa_cislo_vema || ''}</ValueText>\n                  </KeyValuePair>\n                  \n                  <KeyValuePair>\n                    <KeyLabel>stka</KeyLabel>\n                    <ValueText className=\"highlight\">\n                      {formatCurrency(faktura.fa_castka)}\n                    </ValueText>\n                  </KeyValuePair>\n\n                  <KeyValuePair>\n                    <KeyLabel>Datum vystaven</KeyLabel>\n                    <ValueText>\n                      {faktura.fa_datum_vystaveni ? formatDateOnly(faktura.fa_datum_vystaveni) : ''}\n                    </ValueText>\n                  </KeyValuePair>\n                  \n                  <KeyValuePair>\n                    <KeyLabel>Datum splatnosti</KeyLabel>\n                    <ValueText>\n                      {(faktura.fa_datum_splatnosti || faktura.fa_splatnost)\n                        ? formatDateOnly(faktura.fa_datum_splatnosti || faktura.fa_splatnost)\n                        : ''}\n                    </ValueText>\n                  </KeyValuePair>\n                  \n                  <KeyValuePair>\n                    <KeyLabel>Datum doruen</KeyLabel>\n                    <ValueText>\n                      {faktura.fa_datum_doruceni ? formatDateOnly(faktura.fa_datum_doruceni) : ''}\n                    </ValueText>\n                  </KeyValuePair>\n\n                  <KeyValuePair>\n                    <KeyLabel>Typ faktury</KeyLabel>\n                    <ValueText>\n                      {(() => {\n                        const typ = faktura.fa_typ || 'BEZNA';\n                        const typColors = {\n                          'BEZNA': { bg: '#f1f5f9', color: '#475569' },\n                          'ZALOHOVA': { bg: '#dbeafe', color: '#1e40af' },\n                          'OPRAVNA': { bg: '#fef3c7', color: '#92400e' },\n                          'PROFORMA': { bg: '#f3e8ff', color: '#6b21a8' },\n                          'DOBROPIS': { bg: '#d1fae5', color: '#065f46' }\n                        };\n                        const colors = typColors[typ] || typColors['BEZNA'];\n                        return (\n                          <Badge $bg={colors.bg} $color={colors.color}>\n                            {typ}\n                          </Badge>\n                        );\n                      })()}\n                    </ValueText>\n                  </KeyValuePair>\n\n                  {faktura.fa_strediska_kod && (\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>Stediska</KeyLabel>\n                      <ValueText>\n                        {(() => {\n                          const strediska = faktura.fa_strediska_kod;\n                          if (Array.isArray(strediska)) {\n                            const formatted = strediska\n                              .map(s => {\n                                if (typeof s === 'object') {\n                                  const kod = s.kod || s.value;\n                                  const nazev = s.nazev || s.label;\n                                  return kod && nazev ? `${kod} - ${nazev}` : (nazev || kod || s);\n                                }\n                                return s;\n                              })\n                              .filter(Boolean)\n                              .join(', ');\n                            return formatted || '';\n                          }\n                          if (typeof strediska === 'string') {\n                            return strediska || '';\n                          }\n                          return '';\n                        })()}\n                      </ValueText>\n                    </KeyValuePair>\n                  )}\n\n                  <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                    <KeyLabel>Poznmka</KeyLabel>\n                    <ValueText>{faktura.fa_poznamka || <span style={{color: '#9ca3af'}}>---</span>}</ValueText>\n                  </KeyValuePair>\n\n                  {faktura._isdoc_dodavatel && (\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>ISDOC Dodavatel</KeyLabel>\n                      <ValueText>\n                        {faktura._isdoc_dodavatel.nazev}\n                        {faktura._isdoc_dodavatel.ico && ` (IO: ${faktura._isdoc_dodavatel.ico})`}\n                      </ValueText>\n                    </KeyValuePair>\n                  )}\n\n                </DataGrid>\n\n                {/* PLOHY FAKTURY */}\n                {faktura.prilohy && faktura.prilohy.length > 0 && (\n                  <div style={{\n                    margin: '1.5rem 0 1rem 0',\n                    borderTop: '2px solid #e5e7eb',\n                    paddingTop: '1rem'\n                  }}>\n                    <div style={{\n                      fontWeight: '600',\n                      color: '#1e40af',\n                      fontSize: '0.9rem',\n                      marginBottom: '1rem',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.5rem'\n                    }}>\n                      <FontAwesomeIcon icon={faPaperclip} style={{ color: '#3b82f6' }} />\n                      PLOHY FAKTURY . {index + 1} ({faktura.prilohy.length})\n                    </div>\n\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\n                      {faktura.prilohy.map((priloha, idx) => {\n                        const formatFileSize = (bytes) => {\n                          if (!bytes || bytes === 0) return '0 B';\n                          const k = 1024;\n                          const sizes = ['B', 'KB', 'MB', 'GB'];\n                          const i = Math.floor(Math.log(bytes) / Math.log(k));\n                          return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n                        };\n\n                        const getTypeBadge = (typ) => {\n                          const typeMap = {\n                            'FAKTURA': { bg: '#dbeafe', color: '#1e40af', label: 'Faktura' },\n                            'ISDOC': { bg: '#e0e7ff', color: '#4338ca', label: 'ISDOC' },\n                            'PRILOHA': { bg: '#f3e8ff', color: '#6b21a8', label: 'Ploha' },\n                            'SMLOUVA': { bg: '#fef3c7', color: '#92400e', label: 'Smlouva' },\n                            'IMPORT': { bg: '#fce7f3', color: '#9f1239', label: 'Import' },\n                            'JINE': { bg: '#f1f5f9', color: '#475569', label: 'Jin' },\n                            'JINA': { bg: '#f1f5f9', color: '#475569', label: 'Jin' }\n                          };\n                          const config = typeMap[typ] || typeMap['JINA'];\n                          return (\n                            <Badge $bg={config.bg} $color={config.color}>\n                              {config.label}\n                            </Badge>\n                          );\n                        };\n\n                        const handleDownload = async () => {\n                          try {\n                            const blob = await downloadInvoiceAttachment(faktura.id, priloha.id, username, token);\n                            const url = window.URL.createObjectURL(blob);\n                            const a = document.createElement('a');\n                            a.href = url;\n                            a.download = priloha.originalni_nazev_souboru || 'attachment';\n                            document.body.appendChild(a);\n                            a.click();\n                            window.URL.revokeObjectURL(url);\n                            document.body.removeChild(a);\n                          } catch (error) {\n                            console.error('Error downloading invoice attachment:', error);\n                            // Error u byl zpracovn v API vrstv, sta zobrazit error.message\n                            alert(error.message || 'Nepodailo se sthnout plohu faktury');\n                          }\n                        };\n\n                        return (\n                          <div key={priloha.id || idx} onClick={handleDownload} style={{\n                            display: 'flex',\n                            alignItems: 'center',\n                            gap: '0.75rem',\n                            padding: '0.5rem 0.75rem',\n                            background: '#f9fafb',\n                            borderRadius: '6px',\n                            border: '1px solid #e5e7eb',\n                            cursor: 'pointer',\n                            transition: 'all 0.2s ease',\n                          }}\n                          onMouseEnter={(e) => {\n                            e.currentTarget.style.background = '#f3f4f6';\n                            e.currentTarget.style.borderColor = '#3b82f6';\n                          }}\n                          onMouseLeave={(e) => {\n                            e.currentTarget.style.background = '#f9fafb';\n                            e.currentTarget.style.borderColor = '#e5e7eb';\n                          }}\n                          title=\"Kliknte pro staen\">\n                            <FontAwesomeIcon icon={faFile} style={{ color: '#6b7280', fontSize: '1rem' }} />\n                            <div style={{ flex: 1, minWidth: 0 }}>\n                              <div style={{\n                                fontSize: '0.875rem',\n                                color: '#374151',\n                                fontWeight: '500',\n                                overflow: 'hidden',\n                                textOverflow: 'ellipsis',\n                                whiteSpace: 'nowrap'\n                              }}>\n                                {priloha.originalni_nazev_souboru || 'Nepojmenovan soubor'}\n                              </div>\n                              <div style={{\n                                fontSize: '0.75rem',\n                                color: '#9ca3af',\n                                marginTop: '2px'\n                              }}>\n                                {formatFileSize(priloha.velikost_souboru_b)}\n                              </div>\n                            </div>\n                            {getTypeBadge(priloha.typ_prilohy)}\n                            <FontAwesomeIcon icon={faDownload} style={{ color: '#3b82f6', fontSize: '0.875rem', marginLeft: '0.5rem' }} />\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                )}\n\n                {/* DLC RA - VCN KONTROLA FAKTURY */}\n                <div style={{\n                  margin: '1.5rem 0 1rem 0',\n                  borderTop: '2px solid #e5e7eb',\n                  paddingTop: '1rem'\n                }}>\n                  <div style={{\n                    fontWeight: '600',\n                    color: '#6b21a8',\n                    fontSize: '0.9rem',\n                    marginBottom: '1rem',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '0.5rem'\n                  }}>\n                    <FontAwesomeIcon icon={faClipboardCheck} style={{ color: '#a855f7' }} />\n                    VCN KONTROLA FAKTURY {index + 1}\n                  </div>\n\n                  <DataGrid $columns=\"1fr 1fr\">\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>Stav vcn kontroly</KeyLabel>\n                      <ValueText>\n                        {faktura.vecna_spravnost_potvrzeno === 1 || faktura.vecna_spravnost_potvrzeno === '1' ? (\n                          <div style={{\n                            display: 'inline-flex',\n                            alignItems: 'center',\n                            gap: '0.5rem',\n                            padding: '0.5rem 1rem',\n                            background: '#dcfce7',\n                            border: '2px solid #16a34a',\n                            borderRadius: '8px',\n                            color: '#166534',\n                            fontWeight: '600'\n                          }}>\n                            <FontAwesomeIcon icon={faCheckCircle} />\n                            Potvrzeno\n                          </div>\n                        ) : (\n                          <div style={{\n                            display: 'inline-flex',\n                            alignItems: 'center',\n                            gap: '0.5rem',\n                            padding: '0.5rem 1rem',\n                            background: '#fee2e2',\n                            border: '2px solid #ef4444',\n                            borderRadius: '8px',\n                            color: '#991b1b',\n                            fontWeight: '600'\n                          }}>\n                            <FontAwesomeIcon icon={faTimesCircle} />\n                            Nepotvrzeno\n                          </div>\n                        )}\n                      </ValueText>\n                    </KeyValuePair>\n\n                    <KeyValuePair>\n                      <KeyLabel>Datum potvrzen</KeyLabel>\n                      <ValueText>\n                        {faktura.dt_potvrzeni_vecne_spravnosti \n                          ? <span style={{fontWeight: '600', color: '#059669'}}>{formatDateOnly(faktura.dt_potvrzeni_vecne_spravnosti)}</span>\n                          : <span style={{color: '#9ca3af'}}>Nepotvrzeno</span>}\n                      </ValueText>\n                    </KeyValuePair>\n                    \n                    <KeyValuePair>\n                      <KeyLabel>Potvrdil</KeyLabel>\n                      <ValueText>\n                        {(() => {\n                          // Primrn pouij jmno z DB (JOIN) vetn titul\n                          if (faktura.potvrdil_vecnou_spravnost_jmeno) {\n                            const titul_pred = faktura.potvrdil_vecnou_spravnost_titul_pred ? `${faktura.potvrdil_vecnou_spravnost_titul_pred} ` : '';\n                            const titul_za = faktura.potvrdil_vecnou_spravnost_titul_za ? `, ${faktura.potvrdil_vecnou_spravnost_titul_za}` : '';\n                            const fullName = `${titul_pred}${faktura.potvrdil_vecnou_spravnost_jmeno} ${faktura.potvrdil_vecnou_spravnost_prijmeni || ''}${titul_za}`.trim();\n                            return <span style={{fontWeight: '600', color: '#059669'}}>{fullName}</span>;\n                          }\n                          // Fallback na enriched data\n                          const enriched = faktura._enriched?.potvrdil_vecnou_spravnost;\n                          if (enriched) {\n                            const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                            const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                            const fullName = `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                            return <span style={{fontWeight: '600', color: '#059669'}}>{fullName}</span>;\n                          }\n                          return <span style={{color: '#9ca3af'}}></span>;\n                        })()}\n                      </ValueText>\n                    </KeyValuePair>\n\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>Umstn majetku</KeyLabel>\n                      <ValueText>\n                        {faktura.vecna_spravnost_umisteni_majetku || <span style={{color: '#9ca3af'}}>---</span>}\n                      </ValueText>\n                    </KeyValuePair>\n\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>Poznmka k vcn kontrole</KeyLabel>\n                      <ValueText>\n                        {faktura.vecna_spravnost_poznamka || <span style={{color: '#9ca3af'}}>---</span>}\n                      </ValueText>\n                    </KeyValuePair>\n                  </DataGrid>\n                </div>\n                </div>\n                {/* Konec obsahu faktury */}\n              </div>\n            );\n            })}\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 8: POZNMKY */}\n      {orderData.poznamka && (\n        <Section>\n          <SectionHeader $theme=\"orange\" $isActive={!collapsed.poznamky} onClick={() => toggleSection('poznamky')}>\n            <SectionTitle $theme=\"orange\">\n              <FontAwesomeIcon icon={faFileAlt} />\n              Poznmky\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.poznamky}>\n              <FontAwesomeIcon icon={faChevronUp} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.poznamky} $theme=\"orange\">\n            <InfoCard>\n              <ValueText style={{ whiteSpace: 'pre-wrap', wordBreak: 'break-word' }}>{orderData.poznamka}</ValueText>\n            </InfoCard>\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 9: DOKONEN */}\n      {orderData.stav_workflow_kod && orderData.stav_workflow_kod.includes('DOKONCENA') && (\n        <Section>\n          <SectionHeader $theme=\"green\" $isActive={!collapsed.dokonceni} onClick={() => toggleSection('dokonceni')}>\n            <SectionTitle $theme=\"green\">\n              <FontAwesomeIcon icon={faCheck} />\n              Dokonen objednvky\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.dokonceni}>\n              <FontAwesomeIcon icon={faChevronUp} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.dokonceni} $theme=\"green\">\n            <div style={{\n              padding: '1rem',\n              background: '#dcfce7',\n              border: '2px solid #16a34a',\n              borderRadius: '8px',\n              color: '#166534',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '0.75rem',\n              fontWeight: '600',\n              marginBottom: '1.5rem'\n            }}>\n              <FontAwesomeIcon icon={faCheckCircle} size=\"lg\" />\n              Objednvka byla spn dokonena\n            </div>\n\n            {/* Workflow timeline */}\n            <div style={{ marginBottom: '1.5rem' }}>\n              <h4 style={{ marginBottom: '1rem', color: '#166534', fontSize: '0.95rem', fontWeight: '600' }}>\n                Historie workflow\n              </h4>\n              \n              {/* 1. Schvlen */}\n              {orderData.dt_schvaleni && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Schvlen objednvky\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_schvaleni)}\n                      {(() => {\n                        const enriched = orderData._enriched?.schvalovatel;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 2. Odesln dodavateli */}\n              {orderData.dt_odeslani && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Odesln dodavateli\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_odeslani)}\n                      {(() => {\n                        const enriched = orderData._enriched?.odesilatel;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 3. Potvrzen dodavatele */}\n              {orderData.dt_akceptace && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Potvrzen dodavatele\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_akceptace)}\n                      {(() => {\n                        const enriched = orderData._enriched?.dodavatel_potvrdil;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 4. Registr smluv (optional) */}\n              {orderData.dt_zverejneni && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Zveejnn v registru smluv\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_zverejneni)}\n                      {(() => {\n                        const enriched = orderData._enriched?.zverejnil;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 5. Fakturace */}\n              {orderData.dt_faktura_pridana && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Pidn faktury\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_faktura_pridana)}\n                      {(() => {\n                        const enriched = orderData._enriched?.fakturant;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 6. Vcn sprvnost */}\n              {orderData.dt_potvrzeni_vecne_spravnosti && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Potvrzen vcn sprvnosti\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_potvrzeni_vecne_spravnosti)}\n                      {(() => {\n                        const enriched = orderData._enriched?.potvrdil_vecnou_spravnost;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Price comparison warning */}\n            {orderData.faktury_celkem_s_dph && orderData.max_cena_s_dph && \n             parseFloat(orderData.faktury_celkem_s_dph) > parseFloat(orderData.max_cena_s_dph) && (\n              <div style={{\n                padding: '0.75rem 1rem',\n                background: '#fef2f2',\n                border: '1px solid #fca5a5',\n                borderRadius: '6px',\n                color: '#991b1b',\n                fontSize: '0.875rem',\n                marginBottom: '1rem'\n              }}>\n                <strong> Upozornn:</strong> Celkov cena faktur (\n                {parseFloat(orderData.faktury_celkem_s_dph).toLocaleString('cs-CZ', {\n                  minimumFractionDigits: 2,\n                  maximumFractionDigits: 2\n                })} K) pekrauje maximln cenu objednvky (\n                {parseFloat(orderData.max_cena_s_dph).toLocaleString('cs-CZ', {\n                  minimumFractionDigits: 2,\n                  maximumFractionDigits: 2\n                })} K)\n              </div>\n            )}\n\n            {/* Poznmka k dokonen */}\n            <FieldGroup>\n              <FieldLabel>Poznmka k dokonen</FieldLabel>\n              <FieldValue>{orderData.dokonceni_poznamka || <span style={{color: '#9ca3af'}}>---</span>}</FieldValue>\n            </FieldGroup>\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 10: PLOHY */}\n      {orderData.prilohy_count > 0 && (\n        <Section>\n          <SectionHeader $theme=\"red\" $isActive={!collapsed.prilohy} onClick={() => toggleSection('prilohy')}>\n            <SectionTitle $theme=\"red\">\n              <FontAwesomeIcon icon={faFileAlt} />\n              Plohy ({orderData.prilohy_count})\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.prilohy}>\n              <FontAwesomeIcon icon={faChevronUp} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.prilohy} $theme=\"red\">\n            {orderData.prilohy && orderData.prilohy.length > 0 ? (\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\n                {orderData.prilohy.map((priloha, idx) => {\n                  const formatFileSize = (bytes) => {\n                    if (!bytes || bytes === 0) return '0 B';\n                    const k = 1024;\n                    const sizes = ['B', 'KB', 'MB', 'GB'];\n                    const i = Math.floor(Math.log(bytes) / Math.log(k));\n                    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n                  };\n\n                  const getTypeBadge = (typ) => {\n                    const typeMap = {\n                      'FAKTURA': { bg: '#dbeafe', color: '#1e40af', label: 'Faktura' },\n                      'ISDOC': { bg: '#e0e7ff', color: '#4338ca', label: 'ISDOC' },\n                      'PRILOHA': { bg: '#f3e8ff', color: '#6b21a8', label: 'Ploha' },\n                      'SMLOUVA': { bg: '#fef3c7', color: '#92400e', label: 'Smlouva' },\n                      'OBJEDNAVKA': { bg: '#d1fae5', color: '#065f46', label: 'Objednvka' },\n                      'IMPORT': { bg: '#fce7f3', color: '#9f1239', label: 'Import' },\n                      'JINE': { bg: '#f1f5f9', color: '#475569', label: 'Jin' },\n                      'JINA': { bg: '#f1f5f9', color: '#475569', label: 'Jin' }\n                    };\n                    const config = typeMap[typ] || typeMap['JINA'];\n                    return (\n                      <Badge $bg={config.bg} $color={config.color}>\n                        {config.label}\n                      </Badge>\n                    );\n                  };\n\n                  const handleDownload = async () => {\n                    try {\n                      const blob = await downloadOrderAttachment(orderData.id, priloha.id, username, token);\n                      const url = window.URL.createObjectURL(blob);\n                      const a = document.createElement('a');\n                      a.href = url;\n                      a.download = priloha.originalni_nazev_souboru || priloha.nazev_souboru || 'attachment';\n                      document.body.appendChild(a);\n                      a.click();\n                      window.URL.revokeObjectURL(url);\n                      document.body.removeChild(a);\n                    } catch (error) {\n                      console.error('Error downloading order attachment:', error);\n                      // Error u byl zpracovn v API vrstv, sta zobrazit error.message\n                      alert(error.message || 'Nepodailo se sthnout plohu objednvky');\n                    }\n                  };\n\n                  return (\n                    <div key={priloha.id || idx} onClick={handleDownload} style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.75rem',\n                      padding: '0.75rem 1rem',\n                      background: '#f9fafb',\n                      borderRadius: '8px',\n                      border: '1px solid #e5e7eb',\n                      cursor: 'pointer',\n                      transition: 'all 0.2s ease',\n                    }}\n                    onMouseEnter={(e) => {\n                      e.currentTarget.style.background = '#f3f4f6';\n                      e.currentTarget.style.borderColor = '#3b82f6';\n                    }}\n                    onMouseLeave={(e) => {\n                      e.currentTarget.style.background = '#f9fafb';\n                      e.currentTarget.style.borderColor = '#e5e7eb';\n                    }}\n                    title=\"Kliknte pro staen\">\n                      <FontAwesomeIcon icon={faFile} style={{ color: '#6b7280', fontSize: '1.25rem' }} />\n                      <div style={{ flex: 1, minWidth: 0 }}>\n                        <div style={{\n                          fontSize: '0.9rem',\n                          color: '#374151',\n                          fontWeight: '500',\n                          overflow: 'hidden',\n                          textOverflow: 'ellipsis',\n                          whiteSpace: 'nowrap'\n                        }}>\n                          {priloha.originalni_nazev_souboru || priloha.nazev_souboru || 'Nepojmenovan soubor'}\n                        </div>\n                        <div style={{\n                          fontSize: '0.8rem',\n                          color: '#9ca3af',\n                          marginTop: '2px'\n                        }}>\n                          {formatFileSize(priloha.velikost_souboru_b || priloha.velikost)}\n                        </div>\n                      </div>\n                      {getTypeBadge(priloha.typ_prilohy || priloha.typ)}\n                      <FontAwesomeIcon icon={faDownload} style={{ color: '#3b82f6', fontSize: '1rem', marginLeft: '0.5rem' }} />\n                    </div>\n                  );\n                })}\n              </div>\n            ) : (\n              <FieldValue>\n                Poet ploh: <strong>{orderData.prilohy_count}</strong>\n              </FieldValue>\n            )}\n          </SectionContent>\n        </Section>\n      )}\n    </FormContainer>\n  );\n});\n\nOrderFormReadOnly.displayName = 'OrderFormReadOnly';\n\nexport default OrderFormReadOnly;\n","import React from 'react';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { \n  faFileContract, \n  faBuilding, \n  faMoneyBillWave, \n  faCalendar,\n  faUser,\n  faMapMarkerAlt,\n  faClipboardList\n} from '@fortawesome/free-solid-svg-icons';\n\nconst PreviewContainer = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  height: 100%;\n  overflow-y: auto;\n`;\n\nconst PreviewHeader = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding-bottom: 1rem;\n  border-bottom: 2px solid #e5e7eb;\n  margin-bottom: 1.5rem;\n`;\n\nconst HeaderIcon = styled.div`\n  width: 48px;\n  height: 48px;\n  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 1.5rem;\n  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);\n`;\n\nconst HeaderInfo = styled.div`\n  flex: 1;\n`;\n\nconst ContractNumber = styled.div`\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: #1e40af;\n  margin-bottom: 0.25rem;\n`;\n\nconst ContractTitle = styled.div`\n  font-size: 0.95rem;\n  color: #6b7280;\n  font-weight: 500;\n`;\n\nconst Section = styled.div`\n  margin-bottom: 1.5rem;\n`;\n\nconst SectionTitle = styled.div`\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: #6b7280;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-bottom: 0.75rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n\nconst InfoGrid = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 1rem;\n`;\n\nconst InfoItem = styled.div`\n  background: #f9fafb;\n  padding: 0.875rem;\n  border-radius: 8px;\n  border: 1px solid #e5e7eb;\n`;\n\nconst InfoLabel = styled.div`\n  font-size: 0.75rem;\n  color: #9ca3af;\n  margin-bottom: 0.25rem;\n  font-weight: 500;\n`;\n\nconst InfoValue = styled.div`\n  font-size: 0.95rem;\n  color: #1f2937;\n  font-weight: 600;\n`;\n\nconst FullWidthInfo = styled(InfoItem)`\n  grid-column: 1 / -1;\n`;\n\nconst AmountDisplay = styled.div`\n  background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);\n  border: 2px solid #10b981;\n  border-radius: 12px;\n  padding: 1.25rem;\n  margin-bottom: 1.5rem;\n  text-align: center;\n`;\n\nconst AmountLabel = styled.div`\n  font-size: 0.85rem;\n  color: #065f46;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n`;\n\nconst AmountValue = styled.div`\n  font-size: 2rem;\n  font-weight: 700;\n  color: #065f46;\n`;\n\nconst StatusBadge = styled.div`\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 0.5rem 1rem;\n  background: ${props => props.$active ? 'linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)' : 'linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%)'};\n  border: 2px solid ${props => props.$active ? '#10b981' : '#d1d5db'};\n  border-radius: 8px;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: ${props => props.$active ? '#065f46' : '#6b7280'};\n`;\n\nconst NoData = styled.div`\n  padding: 3rem;\n  text-align: center;\n  color: #9ca3af;\n  font-size: 0.95rem;\n`;\n\nconst formatCurrency = (value) => {\n  if (!value && value !== 0) return '';\n  return new Intl.NumberFormat('cs-CZ', {\n    style: 'currency',\n    currency: 'CZK',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2\n  }).format(value);\n};\n\nconst formatDate = (dateStr) => {\n  if (!dateStr) return '';\n  try {\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('cs-CZ');\n  } catch {\n    return dateStr;\n  }\n};\n\nconst SmlouvaPreview = ({ smlouvaData, loading }) => {\n  // Support both smlouva and smlouvaData props\n  const smlouva = smlouvaData;\n\n  if (loading) {\n    return (\n      <PreviewContainer>\n        <NoData>\n          <FontAwesomeIcon icon={faFileContract} size=\"3x\" style={{ marginBottom: '1rem', opacity: 0.3 }} />\n          <div>Natm smlouvu...</div>\n        </NoData>\n      </PreviewContainer>\n    );\n  }\n\n  if (!smlouva) {\n    return (\n      <PreviewContainer>\n        <NoData>\n          <FontAwesomeIcon icon={faFileContract} size=\"3x\" style={{ marginBottom: '1rem', opacity: 0.3 }} />\n          <div>dn smlouva nen vybrna</div>\n        </NoData>\n      </PreviewContainer>\n    );\n  }\n\n  console.log(' SmlouvaPreview rendering with data:', smlouva);\n\n  return (\n    <PreviewContainer>\n      <PreviewHeader>\n        <HeaderIcon>\n          <FontAwesomeIcon icon={faFileContract} />\n        </HeaderIcon>\n        <HeaderInfo>\n          <ContractNumber>{smlouva.cislo_smlouvy || 'Bez sla'}</ContractNumber>\n          <ContractTitle>{smlouva.nazev_smlouvy || smlouva.nazev || 'Smlouva'}</ContractTitle>\n        </HeaderInfo>\n        {(smlouva.pouzit_v_obj_formu === 1 || smlouva.pouzit_v_obj_formu === '1' || smlouva.pouzit_v_obj_formu === true) && (\n          <StatusBadge $active={false} style={{ background: '#dbeafe', color: '#1e40af', marginRight: '8px' }}>\n            FORM\n          </StatusBadge>\n        )}\n        <StatusBadge $active={smlouva.aktivni === 1 || smlouva.aktivni === '1' || smlouva.aktivni === true}>\n          {(smlouva.aktivni === 1 || smlouva.aktivni === '1' || smlouva.aktivni === true) ? 'Aktivn' : 'Neaktivn'}\n        </StatusBadge>\n      </PreviewHeader>\n\n      {/* Celkov stka plnn */}\n      <AmountDisplay>\n        <AmountLabel>\n          <FontAwesomeIcon icon={faMoneyBillWave} /> Celkem plnn s DPH\n        </AmountLabel>\n        <AmountValue>\n          {formatCurrency(smlouva.hodnota_s_dph || 0)}\n        </AmountValue>\n      </AmountDisplay>\n\n      {/* Dodavatel */}\n      <Section>\n        <SectionTitle>\n          <FontAwesomeIcon icon={faBuilding} />\n          Dodavatel\n        </SectionTitle>\n        <InfoGrid>\n          <FullWidthInfo>\n            <InfoLabel>Nzev</InfoLabel>\n            <InfoValue>{smlouva.nazev_firmy || ''}</InfoValue>\n          </FullWidthInfo>\n          {smlouva.ico && (\n            <InfoItem>\n              <InfoLabel>IO</InfoLabel>\n              <InfoValue>{smlouva.ico}</InfoValue>\n            </InfoItem>\n          )}\n          {smlouva.dic && (\n            <InfoItem>\n              <InfoLabel>DI</InfoLabel>\n              <InfoValue>{smlouva.dic}</InfoValue>\n            </InfoItem>\n          )}\n        </InfoGrid>\n      </Section>\n\n      {/* Datumy */}\n      <Section>\n        <SectionTitle>\n          <FontAwesomeIcon icon={faCalendar} />\n          Termny\n        </SectionTitle>\n        <InfoGrid>\n          {(smlouva.datum_uzavreni || smlouva.datum_podpisu || smlouva.datum_uzavreni_smlouvy || smlouva.dt_vytvoreni) && (\n            <InfoItem>\n              <InfoLabel>Datum importu</InfoLabel>\n              <InfoValue>{formatDate(smlouva.datum_uzavreni || smlouva.datum_podpisu || smlouva.datum_uzavreni_smlouvy || smlouva.dt_vytvoreni)}</InfoValue>\n            </InfoItem>\n          )}\n          {(smlouva.platnost_od || smlouva.datum_od) && (\n            <InfoItem>\n              <InfoLabel>Platnost od</InfoLabel>\n              <InfoValue>{formatDate(smlouva.platnost_od || smlouva.datum_od)}</InfoValue>\n            </InfoItem>\n          )}\n          {(smlouva.platnost_do || smlouva.datum_do) && (() => {\n            const platnostDo = smlouva.platnost_do || smlouva.datum_do;\n            const isExpired = platnostDo && new Date(platnostDo) < new Date();\n            return (\n              <InfoItem style={{ \n                background: isExpired ? '#fee2e2' : '#d1fae5',\n                border: `2px solid ${isExpired ? '#dc2626' : '#10b981'}`\n              }}>\n                <InfoLabel style={{ color: isExpired ? '#7f1d1d' : '#065f46' }}>Platnost do</InfoLabel>\n                <InfoValue style={{ color: isExpired ? '#7f1d1d' : '#065f46' }}>\n                  {formatDate(platnostDo)}\n                </InfoValue>\n              </InfoItem>\n            );\n          })()}\n          {(smlouva.datum_ukonceni || smlouva.ukonceni) && (\n            <InfoItem>\n              <InfoLabel>Datum ukonen</InfoLabel>\n              <InfoValue>{formatDate(smlouva.datum_ukonceni || smlouva.ukonceni)}</InfoValue>\n            </InfoItem>\n          )}\n        </InfoGrid>\n      </Section>\n\n      {/* Pedmt */}\n      {smlouva.predmet && (\n        <Section>\n          <SectionTitle>\n            <FontAwesomeIcon icon={faClipboardList} />\n            Pedmt smlouvy\n          </SectionTitle>\n          <FullWidthInfo>\n            <InfoValue style={{ whiteSpace: 'pre-wrap' }}>{smlouva.predmet}</InfoValue>\n          </FullWidthInfo>\n        </Section>\n      )}\n\n      {/* erpn */}\n      {(smlouva.cerpano_celkem !== undefined || smlouva.cerpano !== undefined) && (\n        <Section>\n          <SectionTitle>\n            <FontAwesomeIcon icon={faMoneyBillWave} />\n            erpn\n          </SectionTitle>\n          <InfoGrid>\n            <InfoItem>\n              <InfoLabel>erpno</InfoLabel>\n              <InfoValue>{formatCurrency(smlouva.cerpano_celkem || smlouva.cerpano || 0)}</InfoValue>\n            </InfoItem>\n            <InfoItem>\n              <InfoLabel>Zbv</InfoLabel>\n              <InfoValue>\n                {formatCurrency(\n                  (smlouva.hodnota_s_dph || smlouva.celkova_castka || 0) - \n                  (smlouva.cerpano_celkem || smlouva.cerpano || 0)\n                )}\n              </InfoValue>\n            </InfoItem>\n          </InfoGrid>\n        </Section>\n      )}\n\n      {/* Poznmka */}\n      {smlouva.poznamka && (\n        <Section>\n          <SectionTitle>Poznmka</SectionTitle>\n          <FullWidthInfo>\n            <InfoValue style={{ whiteSpace: 'pre-wrap', fontSize: '0.875rem' }}>\n              {smlouva.poznamka}\n            </InfoValue>\n          </FullWidthInfo>\n        </Section>\n      )}\n    </PreviewContainer>\n  );\n};\n\nexport default SmlouvaPreview;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport styled from '@emotion/styled';\nimport { AlertCircle, X } from 'lucide-react';\n\nconst Overlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 100003;\n  animation: fadeIn 0.2s ease;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n`;\n\nconst Dialog = styled.div`\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);\n  max-width: 500px;\n  width: 90%;\n  max-height: 80vh;\n  overflow: hidden;\n  animation: slideIn 0.3s ease;\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(-20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n`;\n\nconst Header = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 20px 24px;\n  border-bottom: 1px solid #e5e7eb;\n  background: linear-gradient(135deg, #dc2626, #991b1b);\n  color: white;\n`;\n\nconst IconWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 40px;\n  height: 40px;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 50%;\n  flex-shrink: 0;\n`;\n\nconst Title = styled.h2`\n  font-size: 1.25rem;\n  font-weight: 600;\n  margin: 0;\n  flex: 1;\n`;\n\nconst CloseButton = styled.button`\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  flex-shrink: 0;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.3);\n  }\n`;\n\nconst Content = styled.div`\n  padding: 24px;\n  max-height: 60vh;\n  overflow-y: auto;\n`;\n\nconst Message = styled.div`\n  font-size: 0.95rem;\n  line-height: 1.6;\n  color: #374151;\n  white-space: pre-wrap;\n  word-break: break-word;\n`;\n\nconst ErrorDetails = styled.details`\n  margin-top: 16px;\n  padding: 12px;\n  background: #f9fafb;\n  border-radius: 6px;\n  font-size: 0.85rem;\n  color: #6b7280;\n  cursor: pointer;\n\n  summary {\n    font-weight: 600;\n    user-select: none;\n    outline: none;\n  }\n\n  pre {\n    margin-top: 8px;\n    padding: 8px;\n    background: #1f2937;\n    color: #f3f4f6;\n    border-radius: 4px;\n    overflow-x: auto;\n    font-size: 0.75rem;\n    line-height: 1.4;\n  }\n`;\n\nconst Footer = styled.div`\n  padding: 16px 24px;\n  border-top: 1px solid #e5e7eb;\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n`;\n\nconst Button = styled.button`\n  padding: 10px 20px;\n  border-radius: 6px;\n  font-weight: 600;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n  \n  ${props => props.primary ? `\n    background: #dc2626;\n    color: white;\n    \n    &:hover {\n      background: #b91c1c;\n    }\n  ` : `\n    background: #f3f4f6;\n    color: #374151;\n    \n    &:hover {\n      background: #e5e7eb;\n    }\n  `}\n`;\n\nconst ErrorDialog = ({ \n  isOpen, \n  title = 'Chyba', \n  message, \n  details = null,\n  onClose,\n  onConfirm = null,\n  confirmText = 'OK',\n  cancelText = 'Zruit'\n}) => {\n  if (!isOpen) return null;\n\n  const handleOverlayClick = (e) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  return ReactDOM.createPortal(\n    <Overlay onClick={handleOverlayClick}>\n      <Dialog>\n        <Header>\n          <IconWrapper>\n            <AlertCircle size={24} />\n          </IconWrapper>\n          <Title>{title}</Title>\n          <CloseButton onClick={onClose}>\n            <X size={18} />\n          </CloseButton>\n        </Header>\n        \n        <Content>\n          <Message>{message}</Message>\n          \n          {details && (\n            <ErrorDetails>\n              <summary>Technick detaily</summary>\n              <pre>{details}</pre>\n            </ErrorDetails>\n          )}\n        </Content>\n        \n        <Footer>\n          {onConfirm ? (\n            <>\n              <Button onClick={onClose}>{cancelText}</Button>\n              <Button primary onClick={onConfirm}>{confirmText}</Button>\n            </>\n          ) : (\n            <Button primary onClick={onClose}>{confirmText}</Button>\n          )}\n        </Footer>\n      </Dialog>\n    </Overlay>,\n    document.body\n  );\n};\n\nexport default ErrorDialog;\n","import React, { useState, useEffect, useCallback } from 'react';\nimport ReactDOM from 'react-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { \n  faBookOpen, \n  faTimes, \n  faFileAlt, \n  faDownload, \n  faSpinner, \n  faExclamationTriangle,\n  faSync,\n  faMinus,\n  faSquare,\n  faWindowRestore\n} from '@fortawesome/free-solid-svg-icons';\nimport { Sparkles } from 'lucide-react';\nimport { PanelBase, PanelHeader, TinyBtn, edgeHandles } from './PanelPrimitives';\nimport styled from '@emotion/styled';\nimport { extractTextFromPDF, extractInvoiceData } from '../../utils/invoiceOCR';\nimport ErrorDialog from '../ErrorDialog';\n\n// ============================================================\n// STYLED COMPONENTS\n// ============================================================\n\nconst InboxContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  flex: 1;\n  min-height: 0;\n`;\n\nconst InboxHeader = styled.div`\n  background: linear-gradient(135deg, #3b82f6, #2563eb);\n  padding: 0.6rem;\n  border-radius: 6px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border: 1px solid #60a5fa;\n`;\n\nconst InboxTitle = styled.div`\n  font-size: 0.75rem;\n  font-weight: 700;\n  color: #f1f5f9;\n  letter-spacing: 0.5px;\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n`;\n\nconst InboxStats = styled.div`\n  font-size: 0.65rem;\n  color: #cbd5e1;\n  font-weight: 600;\n`;\n\nconst InboxContent = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  padding: 0.3rem;\n  background: rgba(255, 255, 255, 0.03);\n  border-radius: 6px;\n  min-height: 0;\n\n  scrollbar-width: thin;\n  scrollbar-color: #93c5fd rgba(255, 255, 255, 0.05);\n\n  &::-webkit-scrollbar {\n    width: 8px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 4px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #93c5fd;\n    border-radius: 4px;\n    border: 2px solid rgba(15, 23, 42, 0.92);\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #60a5fa;\n  }\n`;\n\nconst FakturaCard = styled.div`\n  background: linear-gradient(135deg, rgba(147, 197, 253, 0.12), rgba(96, 165, 250, 0.08));\n  border: 1px solid rgba(96, 165, 250, 0.3);\n  border-radius: 8px;\n  padding: 0.7rem;\n  transition: all 0.2s;\n  cursor: pointer;\n\n  &:hover {\n    background: linear-gradient(135deg, rgba(147, 197, 253, 0.18), rgba(96, 165, 250, 0.12));\n    border-color: rgba(96, 165, 250, 0.5);\n    transform: translateX(2px);\n  }\n`;\n\nconst FakturaHeader = styled.div`\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n`;\n\nconst FakturaNazev = styled.div`\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: #f1f5f9;\n  line-height: 1.3;\n  flex: 1;\n`;\n\nconst FakturaID = styled.div`\n  font-size: 0.6rem;\n  color: #60a5fa;\n  font-family: 'Courier New', monospace;\n  background: rgba(96, 165, 250, 0.2);\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  white-space: nowrap;\n`;\n\nconst FakturaInfo = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.3rem;\n  font-size: 0.65rem;\n  color: #cbd5e1;\n`;\n\nconst InfoRow = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n`;\n\nconst InfoLabel = styled.span`\n  color: #94a3b8;\n  font-weight: 600;\n`;\n\nconst InfoValue = styled.span`\n  color: #e2e8f0;\n`;\n\nconst PrilohaSection = styled.div`\n  margin-top: 0.5rem;\n  padding-top: 0.5rem;\n  border-top: 1px solid rgba(96, 165, 250, 0.25);\n`;\n\nconst PrilohaTitle = styled.div`\n  font-size: 0.65rem;\n  color: #94a3b8;\n  font-weight: 600;\n  margin-bottom: 0.4rem;\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n`;\n\nconst PrilohaItem = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0.4rem;\n  background: rgba(96, 165, 250, 0.1);\n  border-radius: 5px;\n  margin-bottom: 0.3rem;\n  transition: background 0.15s;\n\n  &:hover {\n    background: rgba(96, 165, 250, 0.18);\n  }\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst PrilohaInfo = styled.div`\n  flex: 1;\n  min-width: 0;\n`;\n\nconst PrilohaFilename = styled.div`\n  font-size: 0.65rem;\n  color: #f1f5f9;\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst PrilohaMeta = styled.div`\n  font-size: 0.55rem;\n  color: #cbd5e1;\n  margin-top: 0.15rem;\n`;\n\nconst PrilohaButton = styled.a`\n  display: inline-flex;\n  align-items: center;\n  gap: 0.3rem;\n  padding: 0.3rem 0.5rem;\n  background: linear-gradient(135deg, #3b82f6, #2563eb);\n  color: white;\n  border-radius: 4px;\n  text-decoration: none;\n  font-size: 0.6rem;\n  font-weight: 600;\n  transition: all 0.15s;\n  white-space: nowrap;\n\n  &:hover {\n    background: linear-gradient(135deg, #2563eb, #1d4ed8);\n    transform: scale(1.05);\n  }\n\n  svg {\n    font-size: 0.65rem;\n  }\n`;\n\nconst LoadingBox = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  color: #94a3b8;\n  font-size: 0.75rem;\n  gap: 0.5rem;\n`;\n\nconst ErrorBox = styled.div`\n  background: rgba(239, 68, 68, 0.15);\n  border: 1px solid rgba(239, 68, 68, 0.3);\n  border-radius: 6px;\n  padding: 0.7rem;\n  color: #fca5a5;\n  font-size: 0.7rem;\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n`;\n\nconst EmptyBox = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem 1rem;\n  color: #94a3b8;\n  font-size: 0.75rem;\n  text-align: center;\n  gap: 0.5rem;\n  opacity: 0.7;\n`;\n\nconst RefreshButton = styled.button`\n  background: rgba(100, 116, 139, 0.15);\n  border: 1px solid rgba(100, 116, 139, 0.3);\n  color: #94a3b8;\n  padding: 0.3rem 0.6rem;\n  border-radius: 5px;\n  cursor: pointer;\n  font-size: 0.65rem;\n  font-weight: 600;\n  display: inline-flex;\n  align-items: center;\n  gap: 0.3rem;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(16, 185, 129, 0.25);\n    border-color: rgba(16, 185, 129, 0.5);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n`;\n\nconst FileModal = styled.div`\n  position: fixed;\n  top: ${props => props.y || 50}px;\n  left: ${props => props.x || (window.innerWidth / 2)}px;\n  width: ${props => props.w || (window.innerWidth / 2 - 40)}px;\n  height: ${props => props.h || (window.innerHeight - 100)}px;\n  background: white;\n  border-radius: 12px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);\n  z-index: 100002;\n  resize: both;\n  min-width: 400px;\n  min-height: 300px;\n`;\n\nconst FileModalContent = styled.div`\n  width: 100%;\n  height: 100%;\n  background: white;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst FileModalHeader = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1rem 1.5rem;\n  background: linear-gradient(135deg, #475569, #334155);\n  color: white;\n`;\n\nconst FileModalTitle = styled.div`\n  font-size: 1rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst FileCloseButton = styled.button`\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.3);\n  }\n`;\n\nconst FileIframe = styled.iframe`\n  flex: 1;\n  border: none;\n  width: 100%;\n  height: 100%;\n`;\n\nconst FileObject = styled.object`\n  flex: 1;\n  border: none;\n  width: 100%;\n  height: 100%;\n`;\n\nconst PdfFallback = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n  padding: 2rem;\n  background: #f8fafc;\n  color: #334155;\n`;\n\nconst DownloadButton = styled.a`\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1.5rem;\n  background: linear-gradient(135deg, #3b82f6, #2563eb);\n  color: white;\n  border-radius: 8px;\n  text-decoration: none;\n  font-weight: 600;\n  transition: all 0.2s;\n\n  &:hover {\n    background: linear-gradient(135deg, #2563eb, #1d4ed8);\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);\n  }\n`;\n\nconst TxtViewer = styled.pre`\n  flex: 1;\n  overflow: auto;\n  padding: 2rem;\n  margin: 0;\n  font-family: 'Courier New', monospace;\n  font-size: 0.9rem;\n  line-height: 1.6;\n  background: #1e293b;\n  color: #e2e8f0;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n\n  scrollbar-width: thin;\n  scrollbar-color: #64748b #1e293b;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #1e293b;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #64748b;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #475569;\n  }\n`;\n\n// ============================================================\n// MAIN COMPONENT\n// ============================================================\n\nconst SpisovkaInboxPanel = ({ panelState, setPanelState, beginDrag, onClose, onOCRDataExtracted }) => {\n  const [faktury, setFaktury] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [pagination, setPagination] = useState({ total: 0, limit: 10, offset: 0, rok: 2025 });\n  const [fileViewer, setFileViewer] = useState({ visible: false, url: '', filename: '', type: '', content: '' });\n  const [ocrProgress, setOcrProgress] = useState({ visible: false, progress: 0, message: '' });\n  const [fileViewerPosition, setFileViewerPosition] = useState(() => {\n    // PDF viewer napravo - polovin ka okna (jako z Spisovky)\n    return {\n      x: window.innerWidth / 2, // Prav polovina obrazovky\n      y: 50, // Trochu od vrchu\n      w: window.innerWidth / 2 - 40, // Polovin ka minus offset\n      h: window.innerHeight - 100 // Vka do konce obrazovky\n    };\n  });\n  const [isDraggingViewer, setIsDraggingViewer] = useState(false);\n  const [errorDialog, setErrorDialog] = useState({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n\n  const fetchTxtContent = async (url) => {\n    try {\n      // Pout proxy endpoint pro naten TXT (een CORS)\n      const proxyUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/proxy-txt?url=${encodeURIComponent(url)}`;\n      const response = await fetch(proxyUrl);\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      const text = await response.text();\n      return text;\n    } catch (error) {\n      console.error('Chyba pi natn TXT souboru:', error);\n      return `Chyba pi natn souboru:\\n${error.message}\\n\\nURL: ${url}`;\n    }\n  };\n\n  const handleFileViewerDrag = useCallback((e) => {\n    if (!isDraggingViewer) return;\n    e.preventDefault();\n    setFileViewerPosition(prev => ({\n      ...prev,\n      x: e.clientX - 200,\n      y: e.clientY - 20\n    }));\n  }, [isDraggingViewer]);\n\n  const handleFileViewerDragEnd = useCallback(() => {\n    setIsDraggingViewer(false);\n  }, []);\n\n  useEffect(() => {\n    if (isDraggingViewer) {\n      window.addEventListener('mousemove', handleFileViewerDrag);\n      window.addEventListener('mouseup', handleFileViewerDragEnd);\n      return () => {\n        window.removeEventListener('mousemove', handleFileViewerDrag);\n        window.removeEventListener('mouseup', handleFileViewerDragEnd);\n      };\n    }\n  }, [isDraggingViewer, handleFileViewerDrag, handleFileViewerDragEnd]);\n\n  const handleOCRExtraction = async (priloha, dokumentId) => {\n    try {\n      //  RESET pol ped OCR\n      if (onOCRDataExtracted) {\n        onOCRDataExtracted({\n          datumVystaveni: '',\n          datumSplatnosti: '',\n          variabilniSymbol: '',\n          castka: ''\n        });\n      }\n      \n      setOcrProgress({ visible: true, progress: 0, message: 'Stahuji PDF ze Spisovky...' });\n\n      // Pout proxy-file endpoint pro staen PDF (een CORS)\n      const proxyUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/proxy-file?url=${encodeURIComponent(priloha.download_url)}`;\n      \n      console.log(` Fetching PDF via proxy: ${proxyUrl}`);\n      console.log(` Original URL: ${priloha.download_url}`);\n      const response = await fetch(proxyUrl);\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      \n      const contentType = response.headers.get('content-type');\n      const contentLength = response.headers.get('content-length');\n      console.log(` Response received, Content-Type: ${contentType}, Length: ${contentLength}`);\n      \n      // Validace response\n      if (!contentType || !contentType.includes('pdf')) {\n        throw new Error(`Neplatn formt souboru: ${contentType || 'unknown'}. Oekvno PDF.`);\n      }\n      \n      setOcrProgress({ visible: true, progress: 3, message: 'Stahuji PDF data...' });\n      \n      // DLEIT: Pokme na kompletn staen jako ArrayBuffer\n      const arrayBuffer = await response.arrayBuffer();\n      console.log(` PDF completely downloaded: ${arrayBuffer.byteLength} bytes`);\n      \n      // Validace staench dat\n      if (arrayBuffer.byteLength === 0) {\n        throw new Error('Staen soubor je przdn. Zkuste to prosm znovu.');\n      }\n      \n      if (arrayBuffer.byteLength < 100) {\n        throw new Error(`Staen soubor je pli mal (${arrayBuffer.byteLength} bytes). Stahovn mon selhalo.`);\n      }\n      \n      // Validace PDF magickch byt (%PDF)\n      const header = new Uint8Array(arrayBuffer.slice(0, 5));\n      const headerStr = String.fromCharCode(...header);\n      if (!headerStr.startsWith('%PDF')) {\n        console.error('Invalid PDF header:', headerStr);\n        throw new Error('Staen soubor nen platn PDF (chyb PDF header).');\n      }\n      \n      console.log(` PDF validated: header=\"${headerStr}\", size=${arrayBuffer.byteLength} bytes`);\n      \n      setOcrProgress({ visible: true, progress: 5, message: 'PDF staeno, pipravuji OCR...' });\n\n      // OCR extrakce (pedvme pmo ArrayBuffer)\n      const text = await extractTextFromPDF(arrayBuffer, (progress, message) => {\n        setOcrProgress({ visible: true, progress, message });\n      });\n\n      // Vyten dat\n      const data = extractInvoiceData(text);\n      \n      setOcrProgress({ visible: false, progress: 100, message: 'Hotovo!' });\n\n      // Zobrazit varovn, pokud dokument nen faktura\n      if (data.warning) {\n        await new Promise((resolve) => {\n          setErrorDialog({\n            isOpen: true,\n            title: ' Varovn',\n            message: data.warning,\n            details: null,\n            onConfirm: () => {\n              setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n              resolve(true);\n            },\n            onClose: () => {\n              setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n              resolve(false);\n            }\n          });\n        }).then((proceed) => {\n          if (!proceed) {\n            console.log(' OCR zrueno uivatelem - dokument nen faktura');\n            throw new Error('OCR_CANCELLED');\n          }\n        });\n      }\n\n      // Zavolat callback s daty\n      if (onOCRDataExtracted) {\n        onOCRDataExtracted(data);\n      }\n\n      console.log(' OCR Data:', data);\n      \n      //  AUTOMATICKY OTEVT PDF pro kontrolu vsledk OCR\n      console.log(' Opening PDF for verification...');\n      setFileViewer({\n        visible: true,\n        url: priloha.download_url,\n        filename: priloha.filename,\n        type: 'pdf',\n        content: ''\n      });\n    } catch (err) {\n      console.error(' OCR Error:', err);\n      setOcrProgress({ visible: false, progress: 0, message: '' });\n      \n      // Ignorovat cancel chybu\n      if (err.message === 'OCR_CANCELLED') {\n        return;\n      }\n      \n      // Zobrazit error dialog\n      setErrorDialog({\n        isOpen: true,\n        title: 'Chyba pi OCR extrakci',\n        message: err.message || 'Nepodailo se extrahovat data z dokumentu.',\n        details: err.stack || null,\n        onConfirm: () => {\n          setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n          // Otevt PDF viewer pro manuln prci (pout STEJNOU URL jako preview)\n          setFileViewer({\n            visible: true,\n            url: priloha.download_url,\n            filename: priloha.filename,\n            type: 'pdf',\n            content: ''\n          });\n        },\n        onClose: () => {\n          setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n        }\n      });\n    }\n  };\n\n  const fetchFaktury = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const apiUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/faktury?limit=${pagination.limit}&offset=${pagination.offset}&rok=${pagination.rok}`;\n      const response = await fetch(apiUrl);\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      const data = await response.json();\n\n      if (data.status === 'success') {\n        setFaktury(data.data);\n        setPagination(data.pagination);\n      } else {\n        throw new Error(data.message || 'Nepodailo se nast faktury');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Chyba pi natn faktur ze spisovky:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [pagination.limit, pagination.offset, pagination.rok]);\n\n  // Initial fetch\n  useEffect(() => {\n    fetchFaktury();\n  }, []);\n\n  // Background refresh every 5 minutes\n  useEffect(() => {\n    const interval = setInterval(() => {\n      console.log(' Spisovka auto-refresh (5 minut)');\n      fetchFaktury();\n    }, 5 * 60 * 1000); // 5 minutes\n\n    return () => clearInterval(interval);\n  }, [fetchFaktury]);\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return '-';\n    const date = new Date(dateStr);\n    return date.toLocaleString('cs-CZ', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit'\n    });\n  };\n\n  const formatFileSize = (bytes) => {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n    return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  };\n\n  const handleMinimize = () => {\n    setPanelState(s => ({ ...s, minimized: !s.minimized }));\n  };\n\n  const handleClose = () => {\n    if (onClose) onClose();\n  };\n\n  const currentStyle = {\n    left: `${panelState.x}px`,\n    top: `${panelState.y}px`,\n    width: `${panelState.w}px`,\n    height: `${panelState.h}px`,\n    minWidth: '320px',\n    minHeight: '200px',\n    maxHeight: '90vh'\n  };\n\n  return ReactDOM.createPortal(\n    <PanelBase style={currentStyle}>\n      {edgeHandles(beginDrag, 'spisovkaInbox')}\n      \n      <PanelHeader\n        onMouseDown={(e) => beginDrag(e, 'spisovkaInbox', 'move')}\n        style={{ cursor: 'move' }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>\n          <FontAwesomeIcon icon={faBookOpen} style={{ color: '#94a3b8' }} />\n          Spisovka Inbox\n        </div>\n        <div style={{ display: 'flex', gap: '0.3rem' }}>\n          <TinyBtn onClick={handleMinimize} title={panelState.minimized ? 'Obnovit' : 'Minimalizovat'}>\n            <FontAwesomeIcon icon={panelState.minimized ? faWindowRestore : faMinus} />\n          </TinyBtn>\n          <TinyBtn onClick={handleClose} title=\"Zavt\">\n            <FontAwesomeIcon icon={faTimes} />\n          </TinyBtn>\n        </div>\n      </PanelHeader>\n\n      {!panelState.minimized && (\n        <InboxContainer>\n          <InboxHeader>\n            <InboxTitle>\n              <FontAwesomeIcon icon={faBookOpen} />\n              Faktury {pagination.rok}\n            </InboxTitle>\n            <InboxStats>\n              {pagination.total} celkem\n            </InboxStats>\n          </InboxHeader>\n\n          {loading && (\n            <LoadingBox>\n              <FontAwesomeIcon icon={faSpinner} spin />\n              Natm faktury...\n            </LoadingBox>\n          )}\n\n          {error && (\n            <ErrorBox>\n              <FontAwesomeIcon icon={faExclamationTriangle} />\n              Chyba: {error}\n              <RefreshButton onClick={fetchFaktury} disabled={loading}>\n                <FontAwesomeIcon icon={faSync} />\n                Zkusit znovu\n              </RefreshButton>\n            </ErrorBox>\n          )}\n\n          {!loading && !error && faktury.length === 0 && (\n            <EmptyBox>\n              <FontAwesomeIcon icon={faBookOpen} size=\"2x\" />\n              dn faktury k zobrazen\n            </EmptyBox>\n          )}\n\n          {!loading && !error && faktury.length > 0 && (\n            <InboxContent>\n              {faktury.map((faktura) => (\n                <FakturaCard \n                  key={faktura.dokument_id}\n                >\n                  <FakturaHeader\n                    draggable={faktura.prilohy && faktura.prilohy.length > 0}\n                    onDragStart={(e) => {\n                      if (faktura.prilohy && faktura.prilohy.length > 0) {\n                        e.stopPropagation();\n                        e.currentTarget.style.cursor = 'grabbing';\n                        e.currentTarget.style.opacity = '0.6';\n                        // Pedat vechny plohy jako JSON\n                        const attachmentsData = faktura.prilohy.map(p => ({\n                          url: p.download_url,\n                          filename: p.filename,\n                          mime_type: p.mime_type || 'application/octet-stream'\n                        }));\n                        e.dataTransfer.setData('text/spisovka-attachments', JSON.stringify(attachmentsData));\n                        e.dataTransfer.effectAllowed = 'copy';\n                      }\n                    }}\n                    onDragEnd={(e) => {\n                      e.stopPropagation();\n                      e.currentTarget.style.cursor = (faktura.prilohy && faktura.prilohy.length > 0) ? 'grab' : 'default';\n                      e.currentTarget.style.opacity = '1';\n                    }}\n                    style={{ cursor: (faktura.prilohy && faktura.prilohy.length > 0) ? 'grab' : 'default' }}\n                    title={(faktura.prilohy && faktura.prilohy.length > 0) ? `Pethnte hlaviku pro nahrn vech ${faktura.prilohy.length} ploh` : ''}\n                  >\n                    <FakturaNazev>{faktura.nazev}</FakturaNazev>\n                    <FakturaID>#{faktura.dokument_id}</FakturaID>\n                  </FakturaHeader>\n\n                  <FakturaInfo>\n                    <InfoRow>\n                      <InfoLabel>JID:</InfoLabel>\n                      <InfoValue>{faktura.jid}</InfoValue>\n                    </InfoRow>\n                    <InfoRow>\n                      <InfoLabel>slo jednac:</InfoLabel>\n                      <InfoValue>{faktura.cislo_jednaci}</InfoValue>\n                    </InfoRow>\n                    <InfoRow>\n                      <InfoLabel>Datum vzniku:</InfoLabel>\n                      <InfoValue>{formatDate(faktura.datum_vzniku)}</InfoValue>\n                    </InfoRow>\n                  </FakturaInfo>\n\n                  {faktura.prilohy && faktura.prilohy.length > 0 && (\n                    <PrilohaSection>\n                      <PrilohaTitle>\n                         Plohy ({faktura.prilohy.length})\n                      </PrilohaTitle>\n                      {faktura.prilohy.slice(0, 3).map((priloha) => {\n                        const isPdf = priloha.mime_type === 'application/pdf';\n                        const isTxt = priloha.mime_type === 'text/plain' || priloha.filename.toLowerCase().endsWith('.txt');\n                        const canPreview = isPdf || isTxt;\n                        return (\n                          <PrilohaItem \n                            key={priloha.file_id}\n                            draggable={true}\n                            onDragStart={(e) => {\n                              e.stopPropagation();\n                              e.currentTarget.style.cursor = 'grabbing';\n                              e.currentTarget.style.opacity = '0.6';\n                              e.dataTransfer.setData('text/spisovka-file-url', priloha.download_url);\n                              e.dataTransfer.setData('text/spisovka-file-name', priloha.filename);\n                              e.dataTransfer.setData('text/spisovka-file-mime', priloha.mime_type || 'application/octet-stream');\n                              e.dataTransfer.effectAllowed = 'copy';\n                            }}\n                            style={{ cursor: 'grab' }}\n                            onDragEnd={(e) => {\n                              e.stopPropagation();\n                              e.currentTarget.style.cursor = 'grab';\n                              e.currentTarget.style.opacity = '1';\n                            }}\n                          >\n                            <PrilohaInfo>\n                              <PrilohaFilename>\n                                {isPdf && ' '}{isTxt && ' '}{priloha.filename}\n                              </PrilohaFilename>\n                              <PrilohaMeta>\n                                {formatFileSize(priloha.size)}\n                              </PrilohaMeta>\n                            </PrilohaInfo>\n                            <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\n                              {/* OCR Button VLEVO - pouze pro PDF */}\n                              {isPdf && (\n                                <button\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    handleOCRExtraction(priloha, faktura.dokument_id);\n                                  }}\n                                  style={{\n                                    background: 'linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%)',\n                                    border: 'none',\n                                    borderRadius: '4px',\n                                    padding: '4px 6px',\n                                    cursor: 'pointer',\n                                    display: 'flex',\n                                    alignItems: 'center',\n                                    gap: '3px',\n                                    color: 'white',\n                                    fontSize: '0.65rem',\n                                    fontWeight: '600',\n                                    boxShadow: '0 1px 3px rgba(139, 92, 246, 0.3)',\n                                    transition: 'all 0.2s ease'\n                                  }}\n                                  onMouseEnter={(e) => {\n                                    e.currentTarget.style.transform = 'scale(1.05)';\n                                    e.currentTarget.style.boxShadow = '0 2px 6px rgba(139, 92, 246, 0.5)';\n                                  }}\n                                  onMouseLeave={(e) => {\n                                    e.currentTarget.style.transform = 'scale(1)';\n                                    e.currentTarget.style.boxShadow = '0 1px 3px rgba(139, 92, 246, 0.3)';\n                                  }}\n                                  title=\"Vytit daje pomoc OCR\"\n                                >\n                                  <Sparkles size={12} />\n                                  <span>OCR</span>\n                                </button>\n                              )}\n                              \n                              {/* PDF/TXT Preview Button VPRAVO */}\n                              <PrilohaButton\n                                as={canPreview ? 'button' : 'a'}\n                                href={canPreview ? undefined : priloha.download_url}\n                                target={canPreview ? undefined : \"_blank\"}\n                                rel={canPreview ? undefined : \"noopener noreferrer\"}\n                                onClick={async (e) => {\n                                  e.stopPropagation();\n                                  if (isPdf) {\n                                    // Otevt PDF v modalu\n                                    setFileViewer({\n                                      visible: true,\n                                      url: priloha.download_url,\n                                      filename: priloha.filename,\n                                      type: 'pdf',\n                                      content: ''\n                                    });\n                                  } else if (isTxt) {\n                                    const txtContent = await fetchTxtContent(priloha.download_url);\n                                    setFileViewer({\n                                      visible: true,\n                                      url: priloha.download_url,\n                                      filename: priloha.filename,\n                                      type: 'txt',\n                                      content: txtContent\n                                    });\n                                  }\n                                }}\n                              >\n                                <FontAwesomeIcon icon={isPdf ? faFileAlt : (isTxt ? faFileAlt : faDownload)} />\n                                {isPdf ? 'PDF' : (isTxt ? 'TXT' : 'DL')}\n                              </PrilohaButton>\n                            </div>\n                          </PrilohaItem>\n                        );\n                      })}\n                      {faktura.prilohy.length > 3 && (\n                        <div style={{ fontSize: '0.6rem', color: '#94a3b8', marginTop: '0.3rem', textAlign: 'center' }}>\n                          +{faktura.prilohy.length - 3} dal\n                        </div>\n                      )}\n                    </PrilohaSection>\n                  )}\n                </FakturaCard>\n              ))}\n            </InboxContent>\n          )}\n        </InboxContainer>\n      )}\n\n      {/* OCR Progress Overlay */}\n      {ocrProgress.visible && (\n        <div style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(255, 255, 255, 0.95)',\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: '1rem',\n          zIndex: 1000,\n          borderRadius: '8px'\n        }}>\n          <Sparkles size={48} color=\"#8b5cf6\" style={{ animation: 'spin 2s linear infinite' }} />\n          <div style={{ fontSize: '1rem', fontWeight: '600', color: '#1a1a1a' }}>\n            OCR extrakce z PDF\n          </div>\n          <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n            {ocrProgress.message}\n          </div>\n          <div style={{ width: '80%', maxWidth: '300px', height: '8px', backgroundColor: '#e9d5ff', borderRadius: '4px', overflow: 'hidden' }}>\n            <div style={{ \n              height: '100%', \n              width: `${ocrProgress.progress}%`, \n              backgroundColor: '#8b5cf6', \n              transition: 'width 0.3s ease' \n            }} />\n          </div>\n          <div style={{ fontSize: '0.75rem', color: '#8b5cf6', fontWeight: '600' }}>\n            {Math.round(ocrProgress.progress)}%\n          </div>\n        </div>\n      )}\n\n      {fileViewer.visible && ReactDOM.createPortal(\n        <FileModal \n          x={fileViewerPosition.x}\n          y={fileViewerPosition.y}\n          w={fileViewerPosition.w}\n          h={fileViewerPosition.h}\n        >\n          <FileModalContent>\n            <FileModalHeader\n              onMouseDown={(e) => {\n                setIsDraggingViewer(true);\n                e.preventDefault();\n              }}\n              style={{ cursor: isDraggingViewer ? 'grabbing' : 'grab' }}\n            >\n              <FileModalTitle>\n                <FontAwesomeIcon icon={faFileAlt} />\n                {fileViewer.filename}\n              </FileModalTitle>\n              <FileCloseButton onClick={() => setFileViewer({ visible: false, url: '', filename: '', type: '', content: '' })}>\n                <FontAwesomeIcon icon={faTimes} />\n              </FileCloseButton>\n            </FileModalHeader>\n            {fileViewer.type === 'pdf' ? (\n              <FileObject \n                data={fileViewer.url}\n                type=\"application/pdf\"\n                title={fileViewer.filename}\n              >\n                <PdfFallback>\n                  <FontAwesomeIcon icon={faFileAlt} size=\"3x\" style={{ color: '#64748b' }} />\n                  <div style={{ fontSize: '1.1rem', fontWeight: 600 }}>PDF nelze zobrazit v prohlei</div>\n                  <div style={{ fontSize: '0.9rem', color: '#64748b', textAlign: 'center', maxWidth: '400px' }}>\n                    V prohle nepodporuje zobrazen PDF soubor. Mete soubor sthnout a otevt extern.\n                  </div>\n                  <DownloadButton href={fileViewer.url} download={fileViewer.filename}>\n                    <FontAwesomeIcon icon={faDownload} />\n                    Sthnout PDF\n                  </DownloadButton>\n                </PdfFallback>\n              </FileObject>\n            ) : fileViewer.type === 'txt' ? (\n              <TxtViewer>{fileViewer.content}</TxtViewer>\n            ) : null}\n          </FileModalContent>\n        </FileModal>,\n        document.body\n      )}\n\n      <ErrorDialog\n        isOpen={errorDialog.isOpen}\n        title={errorDialog.title}\n        message={errorDialog.message}\n        details={errorDialog.details}\n        onConfirm={errorDialog.onConfirm}\n        onClose={errorDialog.onClose}\n        confirmText={errorDialog.onConfirm ? (errorDialog.title.includes('Varovn') ? 'Pokraovat' : 'Otevt PDF') : null}\n        cancelText=\"Zruit\"\n      />\n    </PanelBase>,\n    document.body\n  );\n};\n\nexport default SpisovkaInboxPanel;\n","import React, { useState, useEffect, useContext, useCallback, useMemo, useRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useNavigate, useParams, useLocation } from 'react-router-dom';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faTimes,\n  faSave,\n  faFileInvoice,\n  faCheckCircle,\n  faTimesCircle,\n  faExclamationTriangle,\n  faBuilding,\n  faCalendar,\n  faMoneyBillWave,\n  faClipboardCheck,\n  faExpand,\n  faCompress,\n  faArrowLeft,\n  faCreditCard,\n  faUpload,\n  faChevronUp,\n  faChevronDown,\n  faSearch,\n  faSpinner,\n  faEdit,\n  faFileContract,\n  faLock,\n  faUnlock,\n  faBookOpen\n} from '@fortawesome/free-solid-svg-icons';\nimport { AuthContext } from '../context/AuthContext';\nimport { ToastContext } from '../context/ToastContext';\nimport { ProgressContext } from '../context/ProgressContext';\nimport { createInvoiceWithAttachmentV2, createInvoiceV2, getInvoiceById25, updateInvoiceV2 } from '../services/api25invoices';\nimport { getOrderV2, updateOrderV2 } from '../services/apiOrderV2';\nimport { getSmlouvaDetail } from '../services/apiSmlouvy';\nimport { universalSearch } from '../services/apiUniversalSearch';\nimport { fetchAllUsers } from '../services/api2auth';\nimport { getStrediska25, getTypyFaktur25 } from '../services/api25orders';\nimport { formatDateOnly } from '../utils/format';\nimport OrderFormReadOnly from '../components/OrderFormReadOnly';\nimport SmlouvaPreview from '../components/SmlouvaPreview';\nimport DatePicker from '../components/DatePicker';\nimport { CustomSelect } from '../components/CustomSelect';\nimport ConfirmDialog from '../components/ConfirmDialog';\nimport { Search } from 'lucide-react';\nimport draftManager from '../services/DraftManager';\nimport { notificationService, NOTIFICATION_TYPES } from '../services/notificationsUnified';\nimport SpisovkaInboxPanel from '../components/panels/SpisovkaInboxPanel';\nimport { InvoiceAttachmentsCompact } from '../components/invoices';\nimport { parseISDOCFile, createISDOCSummary, mapISDOCToFaktura } from '../utils/isdocParser';\n\n// Helper: formt data pro input type=\"date\" (YYYY-MM-DD)\nconst formatDateForPicker = (date) => {\n  if (!date) return '';\n  const d = new Date(date);\n  if (isNaN(d)) return '';\n  return d.toISOString().split('T')[0];\n};\n\n// ===================================================================\n// STYLED COMPONENTS - Recyklovan z OrderForm25 + nov pro layout\n// ===================================================================\n\nconst PageContainer = styled.div`\n  position: relative;\n  width: 100%;\n  height: calc(100vh - 60px);\n  background: #f9fafb;\n  padding: 0;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst FullscreenOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: #ffffff;\n  z-index: 99999;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n`;\n\nconst PageHeader = styled.div`\n  background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);\n  color: white;\n  padding: 1.5rem 2rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 3px solid #3498db;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n`;\n\nconst PageTitle = styled.h1`\n  margin: 0;\n  font-size: 1.75rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n`;\n\nconst HeaderActions = styled.div`\n  display: flex;\n  gap: 12px;\n  align-items: center;\n`;\n\nconst IconButton = styled.button`\n  background: rgba(255, 255, 255, 0.1);\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  color: white;\n  width: 44px;\n  height: 44px;\n  padding: 0;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 1.25rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  position: relative;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.25);\n    border-color: rgba(255, 255, 255, 0.5);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n`;\n\nconst NotificationBadge = styled.span`\n  position: absolute;\n  top: -6px;\n  right: -6px;\n  background: linear-gradient(135deg, #10b981, #059669);\n  color: white;\n  font-size: 0.7rem;\n  font-weight: 700;\n  padding: 2px 6px;\n  border-radius: 10px;\n  min-width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 2px solid #0f172a;\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);\n`;\n\nconst TooltipWrapper = styled.div`\n  position: relative;\n  display: inline-block;\n`;\n\nconst TooltipContent = styled.div`\n  position: fixed;\n  top: ${props => props.$top || 0}px;\n  left: ${props => props.$left || 0}px;\n  min-width: 350px;\n  max-width: 450px;\n  background: linear-gradient(135deg, rgba(15, 23, 42, 0.98), rgba(30, 41, 59, 0.98));\n  border: 1px solid rgba(16, 185, 129, 0.3);\n  border-radius: 10px;\n  padding: 0.75rem;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n  z-index: 10000;\n  opacity: ${props => props.show ? 1 : 0};\n  visibility: ${props => props.show ? 'visible' : 'hidden'};\n  transform: ${props => props.show ? 'translateY(0)' : 'translateY(-10px)'};\n  transition: all 0.2s ease;\n  pointer-events: none;\n\n  &::before {\n    content: '';\n    position: absolute;\n    bottom: 100%;\n    right: 20px;\n    border: 6px solid transparent;\n    border-bottom-color: rgba(16, 185, 129, 0.3);\n  }\n  \n  &::after {\n    content: '';\n    position: absolute;\n    bottom: 100%;\n    right: 21px;\n    border: 5px solid transparent;\n    border-bottom-color: rgba(15, 23, 42, 0.98);\n  }\n`;\n\nconst TooltipTitle = styled.div`\n  font-size: 0.7rem;\n  font-weight: 700;\n  color: #10b981;\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n`;\n\nconst TooltipItem = styled.div`\n  padding: 0.4rem;\n  border-radius: 6px;\n  margin-bottom: 0.3rem;\n  background: rgba(16, 185, 129, 0.08);\n  border: 1px solid rgba(16, 185, 129, 0.2);\n  font-size: 0.75rem;\n  color: #e2e8f0;\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst TooltipItemTitle = styled.div`\n  font-weight: 600;\n  color: #d1fae5;\n  margin-bottom: 0.2rem;\n`;\n\nconst TooltipItemMeta = styled.div`\n  font-size: 0.7rem;\n  color: #94a3b8;\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst ContentLayout = styled.div`\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  min-height: 0;\n`;\n\nconst FormColumn = styled.div`\n  width: 55%;\n  background: white;\n  border-right: 2px solid #e5e7eb;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst FormColumnHeader = styled.div`\n  flex-shrink: 0;\n  background: white;\n  padding: 1.5rem 2rem 1rem 2rem;\n  border-bottom: 2px solid #e5e7eb;\n`;\n\nconst FormColumnContent = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 2rem;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f1f1f1;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n`;\n\nconst PreviewColumn = styled.div`\n  width: 45%;\n  background: #f8fafc;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst PreviewColumnHeader = styled.div`\n  flex-shrink: 0;\n  background: #f8fafc;\n  padding: 1.25rem 2rem 1.5rem 2rem;\n  border-bottom: 2px solid #e5e7eb;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 1rem;\n`;\n\nconst ToggleButton = styled.button`\n  background: ${props => props.disabled ? '#e5e7eb' : '#3b82f6'};\n  color: ${props => props.disabled ? '#94a3b8' : 'white'};\n  border: none;\n  border-radius: 6px;\n  padding: 0.5rem 1rem;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.15s ease;\n  white-space: nowrap;\n  align-self: center;\n  margin: 0;\n\n  &:hover:not(:disabled) {\n    background: #2563eb;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n\n  &:active:not(:disabled) {\n    transform: translateY(0);\n  }\n`;\n\nconst PreviewColumnContent = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 2rem;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #e5e7eb;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #9ca3af;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #6b7280;\n  }\n`;\n\nconst SectionTitle = styled.h2`\n  font-size: 1.3rem;\n  color: #1e293b;\n  margin: 0 0 1.5rem 0;\n  padding-bottom: 12px;\n  border-bottom: 2px solid #3498db;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n\n// Recyklovan z OrderForm25 - FakturaCard layout\nconst FakturaCard = styled.div`\n  border: 2px solid ${props => props.$hasError ? '#ef4444' : '#e5e7eb'};\n  border-radius: 12px;\n  padding: 1.5rem;\n  background: ${props => props.$isEditing ? '#f0f9ff' : '#ffffff'};\n  margin-bottom: 1.5rem;\n  transition: all 0.3s ease;\n\n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n`;\n\nconst FieldRow = styled.div`\n  display: grid;\n  grid-template-columns: ${props => props.$columns || '1fr'};\n  gap: ${props => props.$gap || '1rem'};\n  margin-bottom: 1rem;\n`;\n\nconst FieldGroup = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n`;\n\nconst FieldLabel = styled.label`\n  font-weight: 600;\n  color: #475569;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst RequiredStar = styled.span`\n  color: #ef4444;\n`;\n\nconst CurrencyInputWrapper = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n`;\n\nconst CurrencySymbol = styled.span`\n  position: absolute;\n  right: 12px;\n  color: #374151;\n  font-weight: 600;\n  font-size: 0.875rem;\n  font-family: inherit;\n  pointer-events: none;\n  user-select: none;\n  display: flex;\n  align-items: center;\n  height: 100%;\n`;\n\nconst Input = styled.input`\n  width: 100%;\n  height: 48px;\n  padding: 1px 0.875rem;\n  border: 2px solid ${props => props.$hasError ? '#ef4444' : '#e2e8f0'};\n  border-radius: 8px;\n  font-size: 0.95rem;\n  transition: all 0.2s ease;\n  font-family: inherit;\n  box-sizing: border-box;\n\n  &:focus {\n    outline: none;\n    border-color: ${props => props.$hasError ? '#ef4444' : '#3b82f6'};\n    box-shadow: 0 0 0 3px ${props => props.$hasError ? 'rgba(239, 68, 68, 0.1)' : 'rgba(59, 130, 246, 0.1)'};\n  }\n\n  &:disabled {\n    background: #f1f5f9;\n    cursor: not-allowed;\n  }\n\n  &::placeholder {\n    color: #94a3af;\n  }\n`;\n\nconst Textarea = styled.textarea`\n  padding: 0.875rem;\n  border: 2px solid #e2e8f0;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  min-height: 100px;\n  resize: vertical;\n  font-family: inherit;\n  transition: all 0.2s ease;\n  box-sizing: border-box;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n`;\n\nconst Select = styled.select`\n  width: 100%;\n  height: 48px;\n  padding: 1px 2.5rem 1px 0.875rem;\n  border: 2px solid ${props => props.$hasError ? '#ef4444' : '#e2e8f0'};\n  border-radius: 8px;\n  font-size: 0.95rem;\n  cursor: pointer;\n  font-family: inherit;\n  background-color: white;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 9L1 4h10z'/%3E%3C/svg%3E\");\n  background-repeat: no-repeat;\n  background-position: right 0.75rem center;\n  background-size: 12px;\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  transition: all 0.2s ease;\n  box-sizing: border-box;\n\n  &:hover {\n    border-color: ${props => props.$hasError ? '#ef4444' : '#cbd5e1'};\n  }\n\n  &:focus {\n    outline: none;\n    border-color: ${props => props.$hasError ? '#ef4444' : '#3b82f6'};\n    box-shadow: 0 0 0 3px ${props => props.$hasError ? 'rgba(239, 68, 68, 0.1)' : 'rgba(59, 130, 246, 0.1)'};\n  }\n\n  option {\n    padding: 0.5rem;\n  }\n`;\n\nconst ErrorMessage = styled.div`\n  color: #ef4444;\n  font-size: 0.875rem;\n  margin-top: 0.5rem;\n`;\n\nconst VecnaSpravnostPanel = styled.div`\n  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n  border: 2px solid #86efac;\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-top: 2rem;\n`;\n\nconst VecnaSpravnostTitle = styled.h3`\n  margin: 0 0 1rem 0;\n  font-size: 1.1rem;\n  color: #166534;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n\nconst CheckboxLabel = styled.label`\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  cursor: pointer;\n  padding: 0.75rem;\n  background: white;\n  border-radius: 8px;\n  border: 2px solid #d1fae5;\n  transition: all 0.2s ease;\n\n  &:hover {\n    border-color: #86efac;\n    background: #f0fdf4;\n  }\n\n  input[type=\"checkbox\"] {\n    width: 20px;\n    height: 20px;\n    cursor: pointer;\n  }\n\n  strong {\n    color: #166534;\n    font-size: 1rem;\n  }\n`;\n\nconst ButtonGroup = styled.div`\n  display: flex;\n  gap: 1rem;\n  margin-top: 2rem;\n  padding-top: 1.5rem;\n  border-top: 2px solid #e5e7eb;\n  justify-content: flex-end;\n`;\n\nconst Button = styled.button`\n  padding: 0.875rem 1.75rem;\n  border: none;\n  border-radius: 8px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n\n  ${props => props.$variant === 'primary' && `\n    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n    color: white;\n\n    &:hover {\n      background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);\n    }\n  `}\n\n  ${props => props.$variant === 'secondary' && `\n    background: #f1f5f9;\n    color: #475569;\n\n    &:hover {\n      background: #e2e8f0;\n    }\n  `}\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none !important;\n  }\n\n  &:active:not(:disabled) {\n    transform: scale(0.98);\n  }\n`;\n\nconst OrderPreviewCard = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  margin-bottom: 1.5rem;\n`;\n\nconst OrderHeaderRow = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n  padding-bottom: 1rem;\n  border-bottom: 2px solid #e5e7eb;\n`;\n\nconst OrderNumber = styled.div`\n  font-size: 1.4rem;\n  font-weight: 700;\n  color: #1e293b;\n`;\n\nconst OrderBadge = styled.span`\n  padding: 6px 14px;\n  border-radius: 16px;\n  font-size: 0.85rem;\n  font-weight: 600;\n  background: ${props => props.$color || '#64748b'};\n  color: white;\n`;\n\nconst OrderDetailRow = styled.div`\n  display: flex;\n  margin-bottom: 12px;\n  gap: 12px;\n`;\n\nconst OrderDetailLabel = styled.div`\n  font-weight: 600;\n  color: #64748b;\n  min-width: 140px;\n  font-size: 0.9rem;\n`;\n\nconst OrderDetailValue = styled.div`\n  color: #1e293b;\n  flex: 1;\n  font-size: 0.9rem;\n`;\n\nconst LoadingOverlay = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem;\n  color: #64748b;\n`;\n\nconst LoadingSpinner = styled.div`\n  width: 48px;\n  height: 48px;\n  border: 4px solid #e2e8f0;\n  border-top: 4px solid #3b82f6;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  margin-bottom: 1rem;\n\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n`;\n\nconst ErrorAlert = styled.div`\n  background: #fef2f2;\n  border: 2px solid #fecaca;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1.5rem;\n  color: #991b1b;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n\nconst HelpText = styled.div`\n  font-size: 0.85rem;\n  color: #64748b;\n  margin-top: 0.5rem;\n  font-style: italic;\n`;\n\nconst FieldError = styled.div`\n  font-size: 0.85rem;\n  color: #dc2626;\n  margin-top: 0.5rem;\n  display: flex;\n  align-items: center;\n  gap: 0.35rem;\n  font-weight: 500;\n`;\n\n// Autocomplete styled components\nconst AutocompleteWrapper = styled.div`\n  position: relative;\n  width: 100%;\n`;\n\nconst AutocompleteInput = styled(Input)`\n  padding-right: 2.5rem;\n`;\n\nconst ClearButton = styled.button`\n  position: absolute;\n  right: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  background: none;\n  border: none;\n  color: #cbd5e1;\n  cursor: pointer;\n  padding: 0.25rem;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s ease;\n  font-size: 0.75rem;\n  opacity: 0.6;\n\n  &:hover {\n    color: #94a3b8;\n    opacity: 1;\n  }\n\n  &:active {\n    transform: translateY(-50%) scale(0.9);\n  }\n`;\n\nconst AutocompleteDropdown = styled.div`\n  position: absolute;\n  top: calc(100% + 4px);\n  left: 0;\n  width: 150%;\n  max-height: 400px;\n  overflow-y: auto;\n  background: white;\n  border: 2px solid #3b82f6;\n  border-radius: 8px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n`;\n\nconst OrderSuggestionItem = styled.div`\n  padding: 0.75rem 1rem;\n  cursor: pointer;\n  border-bottom: 1px solid #f3f4f6;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #eff6ff;\n  }\n\n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst OrderSuggestionTitle = styled.div`\n  font-weight: 600;\n  color: #1e40af;\n  font-size: 0.95rem;\n  margin-bottom: 0.25rem;\n`;\n\nconst OrderSuggestionDetail = styled.div`\n  font-size: 0.85rem;\n  color: #6b7280;\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-top: 0.25rem;\n`;\n\nconst OrderSuggestionBadge = styled.span`\n  background: ${props => props.$color || '#e5e7eb'};\n  color: ${props => props.$textColor || '#374151'};\n  padding: 0.125rem 0.5rem;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  font-weight: 500;\n`;\n\nconst NoResults = styled.div`\n  padding: 1rem;\n  text-align: center;\n  color: #9ca3af;\n  font-size: 0.9rem;\n`;\n\nconst SearchingSpinner = styled.div`\n  padding: 1rem;\n  text-align: center;\n  color: #6b7280;\n`;\n\n// Multi-select komponenta pro stediska\nconst MultiSelectWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  z-index: ${props => props.isOpen ? 10000 : 1};\n`;\n\nconst MultiSelectButton = styled.div`\n  width: 100%;\n  box-sizing: border-box;\n  height: 48px;\n  padding: 1px 2.5rem 1px 0.875rem;\n  border: 2px solid ${props => props.hasError ? '#dc2626' : '#e2e8f0'};\n  border-radius: 8px;\n  font-size: 0.95rem;\n  background: ${props => props.disabled ? '#f1f5f9' : '#ffffff'};\n  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n  color: ${props => {\n    if (props.disabled) return '#6b7280';\n    if (props.placeholder || !props.value || props.value === '') return '#94a3af';\n    return '#1f2937';\n  }};\n  font-weight: ${props => props.disabled ? '400' : (props.value && props.value !== '' && props.placeholder !== \"true\" ? '600' : '400')};\n  display: flex;\n  align-items: center;\n  position: relative;\n  transition: all 0.2s ease;\n  appearance: none;\n  -moz-appearance: none;\n  -webkit-appearance: none;\n  background-image: ${props => {\n    if (props.disabled) {\n      return props.isOpen\n        ? `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")`\n        : `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")`;\n    } else if (props.hasError) {\n      return props.isOpen\n        ? `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23b91c1c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")`\n        : `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23b91c1c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")`;\n    } else {\n      return props.isOpen\n        ? `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23374151' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")`\n        : `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23374151' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")`;\n    }\n  }};\n  background-repeat: no-repeat;\n  background-position: right 0.75rem center;\n  background-size: 12px 12px;\n\n  &:hover {\n    border-color: ${props => props.disabled ? '#e2e8f0' : (props.hasError ? '#dc2626' : '#cbd5e1')};\n  }\n\n  &:focus {\n    outline: none;\n    border-color: ${props => props.hasError ? '#dc2626' : '#3b82f6'};\n    box-shadow: 0 0 0 3px ${props => props.hasError ? 'rgba(239, 68, 68, 0.1)' : 'rgba(59, 130, 246, 0.1)'};\n  }\n`;\n\nconst SelectedValue = styled.span`\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  color: ${props => props.isEmpty ? '#9ca3af' : '#1f2937'};\n  font-weight: ${props => props.isEmpty ? '400' : '600'};\n`;\n\nconst MultiSelectDropdown = styled.div`\n  position: fixed;\n  z-index: 40;\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.1);\n  max-height: 300px;\n  overflow-y: auto;\n  min-width: 200px;\n  user-select: none;\n  scroll-behavior: auto;\n  contain: layout style paint;\n  will-change: scroll-position;\n  transform: translateZ(0);\n  scrollbar-width: thin;\n  scrollbar-color: #d1d5db #f9fafb;\n\n  &::-webkit-scrollbar {\n    width: 8px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f9fafb;\n    border-radius: 4px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #d1d5db;\n    border-radius: 4px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #9ca3af;\n  }\n`;\n\nconst SearchBox = styled.div`\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n  padding: 0.75rem;\n  border-bottom: 1px solid #e5e7eb;\n`;\n\nconst SearchInput = styled.input`\n  width: 100%;\n  padding: 0.75rem 0.75rem 0.75rem 2.5rem;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  font-size: 0.875rem;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n  }\n`;\n\nconst SearchIcon = styled.div`\n  position: absolute;\n  left: 1rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #6b7280;\n  pointer-events: none;\n`;\n\nconst MultiSelectOption = styled.div`\n  padding: ${props => props.level === 0 ? '0.75rem' : '0.5rem 0.75rem 0.5rem 2rem'};\n  cursor: pointer;\n  font-size: 0.875rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  background: ${props => props.level === 0 ? '#f9fafb' : '#ffffff'};\n  border-bottom: ${props => props.level === 0 ? '2px solid #e5e7eb' : '1px solid #f3f4f6'};\n  font-weight: ${props => props.level === 0 ? '600' : '400'};\n  color: ${props => props.level === 0 ? '#111827' : '#4b5563'};\n  position: relative;\n  will-change: transform;\n  backface-visibility: hidden;\n  outline: none;\n\n  &:hover {\n    background: ${props => props.level === 0 ? '#f3f4f6' : '#f8fafc'};\n  }\n\n  &:focus {\n    background: #dbeafe;\n    box-shadow: inset 0 0 0 2px #3b82f6;\n  }\n\n  &:last-child {\n    border-bottom: none;\n  }\n\n  input[type=\"checkbox\"] {\n    margin: 0;\n    pointer-events: none;\n  }\n\n  span {\n    padding-left: ${props => (props.level || 0) * 20}px;\n    font-weight: ${props => (props.level || 0) === 0 ? '600' : '400'};\n  }\n`;\n\n// ===================================================================\n// MAIN COMPONENT\n// ===================================================================\n\nexport default function InvoiceEvidencePage() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { orderId } = useParams(); // URL param\n  const { token, username, user_id, hasPermission } = useContext(AuthContext);\n  const { showToast } = useContext(ToastContext);\n  const { setProgress } = useContext(ProgressContext) || {};\n\n  // Kontrola oprvnn - uivatel s MANAGE prvy nebo ADMIN role vid vechny objednvky\n  // hasPermission('ADMIN') kontroluje SUPERADMIN NEBO ADMINISTRATOR (speciln alias v AuthContext)\n  const canViewAllOrders = hasPermission('INVOICE_MANAGE') || \n                           hasPermission('ORDER_MANAGE') || \n                           hasPermission('ADMIN');\n\n  // Helper: zskn finlnho stavu objednvky\n  const getCurrentWorkflowState = useCallback((order) => {\n    if (!order || !order.stav_workflow_kod) {\n      return null;\n    }\n\n    let stavKody = [];\n    try {\n      if (typeof order.stav_workflow_kod === 'string') {\n        stavKody = JSON.parse(order.stav_workflow_kod);\n      } else if (Array.isArray(order.stav_workflow_kod)) {\n        stavKody = order.stav_workflow_kod;\n      }\n    } catch (e) {\n      return null;\n    }\n\n    return stavKody.length > 0 ? stavKody[stavKody.length - 1] : null;\n  }, []);\n\n  // Helper: kontrola zda lze pidat fakturu k objednvce (mus bt ve stavu FAKTURACE, VECNA_SPRAVNOST nebo ZKONTROLOVANA)\n  const canAddInvoiceToOrder = useCallback((order) => {\n    if (!order || !order.stav_workflow_kod) {\n      return { allowed: false, reason: 'Objednvka nem definovan stav' };\n    }\n\n    // stav_workflow_kod je JSON array string - obsahuje celou historii workflow\n    let stavKody = [];\n    try {\n      if (typeof order.stav_workflow_kod === 'string') {\n        stavKody = JSON.parse(order.stav_workflow_kod);\n      } else if (Array.isArray(order.stav_workflow_kod)) {\n        stavKody = order.stav_workflow_kod;\n      }\n    } catch (e) {\n      return { allowed: false, reason: 'Chyba pi parsovn stavu objednvky' };\n    }\n\n    //  DLEIT: Bereme pouze POSLEDN stav (finln stav objednvky)\n    const currentState = stavKody.length > 0 ? stavKody[stavKody.length - 1] : null;\n    \n    if (!currentState) {\n      return { allowed: false, reason: 'Objednvka nem definovan aktuln stav' };\n    }\n\n    // Povolen stavy pro fakturaci\n    // NEUVEREJNIT, UVEREJNENA - ped prvn fakturou (po potvrzen dodavatele)\n    // FAKTURACE - prvn faktura byla pidna\n    // VECNA_SPRAVNOST - ek na kontrolu vcn sprvnosti\n    // ZKONTROLOVANA - vcn sprvnost byla zkontrolovna\n    const allowedStates = ['NEUVEREJNIT', 'UVEREJNENA', 'FAKTURACE', 'VECNA_SPRAVNOST', 'ZKONTROLOVANA'];\n    \n    if (!allowedStates.includes(currentState)) {\n      return { \n        allowed: false, \n        reason: `Fakturaci lze pidat pouze k objednvkm ve stavu: NEUVEEJNIT, UVEEJNNA, FAKTURACE, VCN SPRVNOST nebo ZKONTROLOVAN. Aktuln stav: ${currentState}`\n      };\n    }\n\n    return { allowed: true, reason: null };\n  }, []);\n\n  // State\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [orderLoading, setOrderLoading] = useState(false);\n  const [orderData, setOrderData] = useState(null);\n  const [smlouvaData, setSmlouvaData] = useState(null);\n  const [selectedType, setSelectedType] = useState('order'); // 'order' nebo 'smlouva'\n  const [error, setError] = useState(null);\n  const [fieldErrors, setFieldErrors] = useState({});\n\n  // Autocomplete state - univerzln pro objednvky i smlouvy\n  const [searchTerm, setSearchTerm] = useState('');\n  const [suggestions, setSuggestions] = useState([]); // Zmnno z orderSuggestions\n  const [isSearching, setIsSearching] = useState(false);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n\n  // Ref pro OrderFormReadOnly\n  const orderFormRef = useRef(null);\n  \n  // State pro sledovn collapse stavu\n  const [hasAnySectionCollapsed, setHasAnySectionCollapsed] = useState(false);\n  \n  // State pro sledovn editace faktury\n  const [editingInvoiceId, setEditingInvoiceId] = useState(null);\n\n  // Confirm dialog state\n  const [confirmDialog, setConfirmDialog] = useState({\n    isOpen: false,\n    title: '',\n    message: '',\n    onConfirm: null,\n    onCancel: null\n  });\n\n  // State pro unlock entity (zmna objednvky/smlouvy u existujc FA)\n  const [isEntityUnlocked, setIsEntityUnlocked] = useState(false);\n  // State pro zapamatovn, zda mla faktura pvodn piazenou objednvku/smlouvu\n  const [hadOriginalEntity, setHadOriginalEntity] = useState(false);\n\n  // Spisovka Inbox Panel - pouze pro ADMIN\n  const [spisovkaInboxOpen, setSpisovkaInboxOpen] = useState(false);\n  const [spisovkaInboxState, setSpisovkaInboxState] = useState({\n    x: window.innerWidth - 620, // ir panel (600px)\n    y: Math.max(200, window.innerHeight / 2 - 300),\n    w: 600, // Zvten ka z 400 na 600\n    h: 600,\n    minimized: false\n  });\n  const [spisovkaTodayCount, setSpisovkaTodayCount] = useState(0);\n  const [spisovkaLastRecords, setSpisovkaLastRecords] = useState([]);\n  const [showSpisovkaTooltip, setShowSpisovkaTooltip] = useState(false);\n  const [tooltipPosition, setTooltipPosition] = useState({ top: 0, left: 0 });\n  const tooltipButtonRef = useRef(null);\n\n  //  Resize handler - kontrola pozice panelu pi zmn velikosti okna\n  useEffect(() => {\n    const handleResize = () => {\n      setSpisovkaInboxState(prev => {\n        // Kontrola, zda panel nen mimo viditelnou oblast\n        const maxX = window.innerWidth - prev.w - 20;\n        const maxY = window.innerHeight - prev.h - 20;\n        \n        return {\n          ...prev,\n          x: Math.min(Math.max(20, prev.x), maxX),\n          y: Math.min(Math.max(20, prev.y), maxY)\n        };\n      });\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Form data\n  const [formData, setFormData] = useState({\n    order_id: orderId || '',\n    smlouva_id: null, // ID smlouvy (alternativa k order_id)\n    fa_cislo_vema: '',\n    fa_typ: 'BEZNA', // Vchoz typ: Bn faktura\n    fa_datum_doruceni: formatDateForPicker(new Date()),\n    fa_datum_vystaveni: '', // Nechat przdn - vypln OCR nebo uivatel\n    fa_datum_splatnosti: '',\n    fa_castka: '',\n    fa_poznamka: '',\n    fa_strediska_kod: [], // Stediska - array kd\n    // Nov poloky (nepovinn, pod rou)\n    fa_predana_zam_id: null,\n    fa_datum_predani_zam: '',\n    fa_datum_vraceni_zam: ''\n  });\n\n  // Plohy faktury - array objekt (podle vzoru OrderForm25)\n  const [attachments, setAttachments] = useState([]);\n\n  // CustomSelect states\n  const [selectStates, setSelectStates] = useState({});\n  const [searchStates, setSearchStates] = useState({});\n  const [touchedSelectFields, setTouchedSelectFields] = useState({});\n\n  // Stediska options\n  const [strediskaOptions, setStrediskaOptions] = useState([]);\n  const [strediskaLoading, setStrediskaLoading] = useState(false);\n\n  // Typy faktur (klasifikace ploh)\n  const [typyFakturOptions, setTypyFakturOptions] = useState([]);\n  const [typyFakturLoading, setTypyFakturLoading] = useState(false);\n  \n  // Zamstnanci options (pro pedn FA)\n  const [zamestnanci, setZamestnanci] = useState([]);\n  const [zamestnanciLoading, setZamestnanciLoading] = useState(false);\n  \n  // Tracking zmn kritickch pol\n  const [originalFormData, setOriginalFormData] = useState(null);\n  const [hasChangedCriticalField, setHasChangedCriticalField] = useState(false);\n\n  // Naten stedisek, typ faktur a zamstnanc pi mount (pouze pokud existuje token)\n  useEffect(() => {\n    const loadStrediska = async () => {\n      if (!token || !username) {\n        console.log(' Token nebo username jet nen k dispozici, ekm...');\n        return;\n      }\n      \n      setStrediskaLoading(true);\n      try {\n        const data = await getStrediska25({ token, username });\n        if (data && Array.isArray(data)) {\n          // API vrac pmo objekty s value a label, nen poteba nic mapovat\n          setStrediskaOptions(data);\n          console.log(' Stediska natena:', data.length);\n        }\n      } catch (err) {\n        console.error('Chyba pi natn stedisek:', err);\n      } finally {\n        setStrediskaLoading(false);\n      }\n    };\n\n    const loadTypyFaktur = async () => {\n      if (!token || !username) return;\n      \n      setTypyFakturLoading(true);\n      try {\n        const data = await getTypyFaktur25({ token, username, aktivni: 1 });\n        if (data && Array.isArray(data)) {\n          setTypyFakturOptions(data);\n          console.log(' Typy faktur nateny:', data.length);\n        }\n      } catch (err) {\n        console.error('Chyba pi natn typ faktur:', err);\n      } finally {\n        setTypyFakturLoading(false);\n      }\n    };\n\n    const loadZamestnanci = async () => {\n      if (!token || !username) return;\n      \n      setZamestnanciLoading(true);\n      try {\n        // Naten vech uivatel pes fetchAllUsers API (stejn jako OrderList25)\n        const usersData = await fetchAllUsers({ token, username });\n        \n        if (usersData && Array.isArray(usersData)) {\n          // Filtrovat pouze aktivn uivatele a seadit podle pjmen\n          const aktivni = usersData\n            .filter(u => u.aktivni === 1)\n            .sort((a, b) => {\n              const aName = `${a.prijmeni || ''} ${a.jmeno || ''}`.trim();\n              const bName = `${b.prijmeni || ''} ${b.jmeno || ''}`.trim();\n              return aName.localeCompare(bName, 'cs');\n            });\n          setZamestnanci(aktivni);\n          console.log(' Zamstnanci nateni:', aktivni.length);\n        }\n      } catch (err) {\n        console.error('Chyba pi natn zamstnanc:', err);\n      } finally {\n        setZamestnanciLoading(false);\n      }\n    };\n\n    // Spustit pouze pokud mme token a username\n    if (token && username) {\n      loadStrediska();\n      loadTypyFaktur();\n      loadZamestnanci();\n    }\n  }, [token, username]);\n\n  // Detekce zmny kritickch pol faktury\n  // Varovn m smysl POUZE pokud:\n  // 1. FA MLA piazenou OBJ nebo SML (ne NULL)\n  // 2. FA NEBYLA pedna zamstnanci\n  // 3. Vcn kontrola JI BYLA PROVEDENA (vecna_spravnost_potvrzeno = 1)\n  useEffect(() => {\n    if (!editingInvoiceId || !originalFormData) return;\n    \n    // Kontrola podmnek pro zobrazen varovn\n    const hadOrderOrContract = originalFormData.order_id || originalFormData.smlouva_id;\n    const wasNotHandedToEmployee = !originalFormData.fa_predana_zam_id;\n    const wasAlreadyApproved = originalFormData.vecna_spravnost_potvrzeno === 1;\n    \n    // Varovn zobrazit jen pokud jsou splnny vechny podmnky\n    if (!hadOrderOrContract || !wasNotHandedToEmployee || !wasAlreadyApproved) {\n      setHasChangedCriticalField(false);\n      return;\n    }\n    \n    const criticalFields = [\n      'fa_castka',\n      'fa_cislo_vema',\n      'fa_strediska_kod',\n      'fa_typ',\n      'fa_datum_vystaveni',\n      'fa_datum_splatnosti',\n      'fa_datum_doruceni'\n    ];\n    \n    const hasChanged = criticalFields.some(field => {\n      const original = originalFormData[field];\n      const current = formData[field];\n      \n      // Speciln handling pro array (stediska)\n      if (Array.isArray(original) && Array.isArray(current)) {\n        return JSON.stringify(original.sort()) !== JSON.stringify(current.sort());\n      }\n      \n      return original !== current;\n    });\n    \n    setHasChangedCriticalField(hasChanged);\n  }, [formData, originalFormData, editingInvoiceId]);\n\n  // Naten faktury pi editaci (z location.state)\n  useEffect(() => {\n    const loadInvoiceForEdit = async () => {\n      const editInvoiceId = location.state?.editInvoiceId;\n      const orderIdForLoad = location.state?.orderIdForLoad;\n      \n      if (!editInvoiceId || !token || !username) {\n        return;\n      }\n      \n      // Pokat na naten stedisek (potebujeme je pro mapovn)\n      if (strediskaOptions.length === 0) {\n        return;\n      }\n      \n      // Pokud u je tato faktura naten (mme data v formData), skip\n      // Kontrola pes fa_cislo_vema je spolehlivj ne editingInvoiceId\n      if (editingInvoiceId === editInvoiceId && formData.fa_cislo_vema) {\n        return;\n      }\n      setLoading(true);\n      setEditingInvoiceId(editInvoiceId);\n      \n      try {\n        // Nast data faktury\n        const invoiceData = await getInvoiceById25({ token, username, id: editInvoiceId });\n        \n        // Naplnit formul daty faktury\n        if (invoiceData) {\n          // Parse stedisek pokud jsou string - STEJN JAKO OrderForm25\n          let strediskaArray = [];\n          if (invoiceData.fa_strediska_kod) {\n            let parsed = [];\n            if (typeof invoiceData.fa_strediska_kod === 'string') {\n              try {\n                parsed = JSON.parse(invoiceData.fa_strediska_kod);\n              } catch (e) {\n                console.warn('Chyba pi parsovn stedisek:', e);\n              }\n            } else if (Array.isArray(invoiceData.fa_strediska_kod)) {\n              parsed = invoiceData.fa_strediska_kod;\n            }\n            \n            // MultiSelect oekv array STRING (values), ne objekt!\n            // Pouze ovit, e codes existuj v options\n            strediskaArray = parsed.map(item => {\n              // Pokud je to string, vrtit ho (to je sprvn formt)\n              if (typeof item === 'string') {\n                // Ovit, e existuje v options\n                const exists = strediskaOptions.find(opt => opt.value === item);\n                if (!exists) {\n                  console.warn(` Stedisko ${item} nen v options (neaktivn)`);\n                }\n                return item;\n              }\n              // Pokud je to objekt, extrahovat value\n              if (typeof item === 'object' && item.value) {\n                return item.value;\n              }\n              // Fallback\n              return item;\n            });\n          }\n          \n          const loadedFormData = {\n            order_id: invoiceData.objednavka_id || '',\n            smlouva_id: invoiceData.smlouva_id || null,\n            fa_cislo_vema: invoiceData.fa_cislo_vema || '',\n            fa_typ: invoiceData.fa_typ || 'BEZNA',\n            fa_datum_doruceni: formatDateForPicker(invoiceData.fa_datum_doruceni),\n            fa_datum_vystaveni: formatDateForPicker(invoiceData.fa_datum_vystaveni),\n            fa_datum_splatnosti: formatDateForPicker(invoiceData.fa_datum_splatnosti),\n            fa_castka: invoiceData.fa_castka || '',\n            fa_poznamka: invoiceData.fa_poznamka || '',\n            fa_strediska_kod: strediskaArray,\n            file: null, // Plohy se nenataj pi editaci\n            // Nov poloky\n            fa_predana_zam_id: invoiceData.fa_predana_zam_id || null,\n            fa_datum_predani_zam: formatDateForPicker(invoiceData.fa_datum_predani_zam),\n            fa_datum_vraceni_zam: formatDateForPicker(invoiceData.fa_datum_vraceni_zam),\n            // Vcn sprvnost (pro detekci zmn kritickch pol)\n            vecna_spravnost_potvrzeno: invoiceData.vecna_spravnost_potvrzeno || 0\n          };\n          \n          setFormData(loadedFormData);\n          // Uloit originln data pro detekci zmn\n          setOriginalFormData(loadedFormData);\n          \n          // Zapamatovat si, zda mla faktura pvodn piazenou objednvku nebo smlouvu\n          setHadOriginalEntity(!!(invoiceData.objednavka_id || invoiceData.smlouva_id));\n          \n          // Pokud je znma objednvka, nast ji a nastavit searchTerm\n          if (orderIdForLoad || invoiceData.objednavka_id) {\n            const orderIdToLoad = orderIdForLoad || invoiceData.objednavka_id;\n            await loadOrderData(orderIdToLoad);\n            setSelectedType('order');\n            \n            // Nastavit searchTerm pokud mme slo objednvky\n            if (invoiceData.cislo_objednavky) {\n              setSearchTerm(invoiceData.cislo_objednavky);\n            }\n          }\n          // Pokud je znma smlouva, nast ji\n          else if (invoiceData.smlouva_id) {\n            await loadSmlouvaData(invoiceData.smlouva_id);\n            setSelectedType('smlouva');\n          }\n        }\n      } catch (err) {\n        console.error(' Chyba pi natn faktury:', err);\n        showToast?.(err.message || 'Chyba pi natn faktury', { type: 'error' });\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    // Spustit pouze pokud existuje editInvoiceId v location.state\n    if (location.state?.editInvoiceId) {\n      loadInvoiceForEdit();\n    }\n  }, [location.state?.editInvoiceId, token, username, strediskaOptions]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Naten objednvky pi mount nebo zmn orderId\n  const loadOrderData = useCallback(async (orderIdToLoad) => {\n    if (!orderIdToLoad || !token || !username) {\n      return;\n    }\n\n    setOrderLoading(true);\n    setError(null);\n\n    try {\n      //  Nati pln data objednvky s enriched daty (faktury, poloky, atd.)\n      const orderData = await getOrderV2(orderIdToLoad, token, username, true);\n\n      if (orderData && orderData.id) {\n        setOrderData(orderData);\n        // Aktualizuj searchTerm aby zobrazoval pouze ev. slo\n        const evCislo = orderData.cislo_objednavky || orderData.evidencni_cislo || `#${orderData.id}`;\n        setSearchTerm(evCislo);\n      } else {\n        setError('Nepodailo se nast data objednvky');\n      }\n    } catch (err) {\n      setError(err.message || 'Chyba pi natn objednvky');\n      showToast && showToast(err.message || 'Chyba pi natn objednvky', 'error');\n    } finally {\n      setOrderLoading(false);\n    }\n  }, [token, username, showToast]);\n\n  const loadSmlouvaData = useCallback(async (smlouvaId) => {\n    if (!smlouvaId || !token || !username) {\n      return;\n    }\n\n    setOrderLoading(true); // Pouijeme stejn loading state\n    setError(null);\n\n    try {\n      console.log(' Natm smlouvu ID:', smlouvaId);\n      const smlouvaData = await getSmlouvaDetail({ token, username, id: smlouvaId });\n      \n      console.log(' RAW API RESPONSE - smlouvaData:', JSON.stringify(smlouvaData, null, 2));\n\n      if (smlouvaData) {\n        // API vrac data v objektu { smlouva: {...}, objednavky: [], statistiky: {} }\n        // Potebujeme extrahovat jen st smlouva\n        const contract = smlouvaData.smlouva || smlouvaData;\n        \n        // Normalizace dat - penst vechna data + pidat cel response\n        const normalizedData = {\n          ...contract,\n          // Pidme objednavky a statistiky z root objektu\n          objednavky: smlouvaData.objednavky || [],\n          statistiky: smlouvaData.statistiky || {}\n        };\n        \n        setSmlouvaData(normalizedData);\n        setSelectedType('smlouva');\n        console.log(' Smlouva natena (normalized):', normalizedData);\n        \n        // Aktualizuj formData s smlouva_id\n        setFormData(prev => ({\n          ...prev,\n          smlouva_id: normalizedData.id,\n          order_id: null // Vyistit objednvku pokud byla pedtm\n        }));\n        \n        // Aktualizuj searchTerm - slo smlouvy\n        const cislo = normalizedData.cislo_smlouvy || `#${normalizedData.id}`;\n        setSearchTerm(cislo);\n        \n        // Vyistit orderData\n        setOrderData(null);\n      } else {\n        setError('Nepodailo se nast data smlouvy - przdn odpov z API');\n        showToast && showToast('Nepodailo se nast data smlouvy', 'error');\n      }\n    } catch (err) {\n      console.error(' Chyba pi natn smlouvy:', err);\n      setError(err.message || 'Chyba pi natn smlouvy');\n      showToast && showToast(err.message || 'Chyba pi natn smlouvy', 'error');\n    } finally {\n      setOrderLoading(false);\n    }\n  }, [token, username, showToast]);\n\n  // Search objednvek a smluv pro autocomplete\n  const searchEntities = useCallback(async (search) => {\n    //  universalSearch vyaduje min 3 znaky\n    if (!search || search.length < 3) {\n      setSuggestions([]);\n      return;\n    }\n\n    setIsSearching(true);\n    try {\n      const searchParams = {\n        query: search,\n        categories: ['orders_2025', 'contracts'], // Objednvky + Smlouvy\n        limit: 15,\n        archivovano: 0,\n        search_all: canViewAllOrders\n      };\n      \n      const response = await universalSearch(searchParams);\n\n      const orders = response?.categories?.orders_2025?.results || [];\n      const contracts = response?.categories?.contracts?.results || [];\n\n      // Filtruj objednvky - zobraz VECHNY odeslan/aktivn objednvky\n      const sentOrders = orders.filter(order => {\n        let stavKody = [];\n        try {\n          if (order.stav_kod) {\n            stavKody = JSON.parse(order.stav_kod);\n          }\n        } catch (e) {\n          // Ignorovat chyby parsovn\n        }\n        \n        const invalidStates = ['STORNOVANA', 'ZAMITNUTA'];\n        const hasInvalidState = stavKody.some(stav => invalidStates.includes(stav));\n        \n        if (hasInvalidState) {\n          return false;\n        }\n        \n        const validStates = ['ODESLANA', 'ODESLANO', 'POTVRZENA', 'NEUVEREJNIT', 'FAKTURACE', 'VECNA_SPRAVNOST', 'ZKONTROLOVANA', 'DOKONCENA'];\n        const hasValidState = stavKody.some(stav => validStates.includes(stav));\n        \n        if (!hasValidState) {\n          return false;\n        }\n\n        return canViewAllOrders || true;\n      });\n\n      // Filtruj smlouvy - pouze aktivn\n      const activeContracts = contracts.filter(contract => contract.aktivni === 1);\n\n      // Kombinuj vsledky s oznaenm typu\n      const combinedResults = [\n        ...sentOrders.map(order => ({ ...order, _type: 'order' })),\n        ...activeContracts.map(contract => ({ ...contract, _type: 'smlouva' }))\n      ];\n\n      setSuggestions(combinedResults);\n      setShowSuggestions(true);\n    } catch (err) {\n      setSuggestions([]);\n    } finally {\n      setIsSearching(false);\n    }\n  }, [canViewAllOrders]);\n\n  // Debounced search pi psan (jen kdy jsou suggestions oteven)\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (searchTerm && showSuggestions) {\n        searchEntities(searchTerm);\n      }\n    }, 300);\n\n    return () => clearTimeout(timer);\n  }, [searchTerm, showSuggestions, searchEntities]);\n\n  // Effect: Nast objednvku kdy je orderId v URL\n  useEffect(() => {\n    if (orderId) {\n      setFormData(prev => ({ ...prev, order_id: orderId }));\n      // loadOrderData automaticky nastav searchTerm po naten\n      loadOrderData(orderId);\n    }\n  }, [orderId, loadOrderData]);\n\n  // Effect: Reload objednvky kdy user zmn order_id v inputu\n  useEffect(() => {\n    if (formData.order_id && formData.order_id !== orderId) {\n      loadOrderData(formData.order_id);\n    }\n  }, [formData.order_id, orderId, loadOrderData]);\n\n  // Effect: Zavt dropdown pi kliknut mimo\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (!e.target.closest('.autocomplete-wrapper')) {\n        setShowSuggestions(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Effect: Nast poet faktur ze spisovky za dnen den (pro badge) a poslednch 5 zznam (pro tooltip)\n  useEffect(() => {\n    if (!hasPermission('ADMIN')) return;\n\n    const fetchSpisovkaData = async () => {\n      try {\n        // Fetch count\n        const countUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/count-today`;\n        const countResponse = await fetch(countUrl);\n        if (countResponse.ok) {\n          const countData = await countResponse.json();\n          if (countData.status === 'success') {\n            setSpisovkaTodayCount(countData.count);\n          }\n        }\n\n        // Fetch last 5 records\n        const faktoryUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/faktury?limit=5&offset=0&rok=2025`;\n        const faktoryResponse = await fetch(faktoryUrl);\n        if (faktoryResponse.ok) {\n          const faktoryData = await faktoryResponse.json();\n          if (faktoryData.status === 'success') {\n            setSpisovkaLastRecords(faktoryData.data);\n          }\n        }\n      } catch (error) {\n        console.error('Chyba pi natn dat ze spisovky:', error);\n      }\n    };\n\n    // Initial fetch\n    fetchSpisovkaData();\n\n    // Refresh every 5 minutes\n    const interval = setInterval(fetchSpisovkaData, 5 * 60 * 1000);\n    return () => clearInterval(interval);\n  }, [hasPermission]);\n\n  // Handler: zmna inputu\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  // Handler: zmna search inputu pro autocomplete\n  const handleSearchChange = (e) => {\n    const value = e.target.value;\n    setSearchTerm(value);\n    setShowSuggestions(true);\n    \n    // Pokud uivatel mn text, vymaeme order_id a orderData\n    // aby se nemohlo stt, e bude vyplnn nevalidn text s validnm order_id\n    if (value !== searchTerm) {\n      setFormData(prev => ({ ...prev, order_id: '' }));\n      setOrderData(null);\n    }\n  };\n\n  // Handler: odemen entity (zmna OBJ/SML u existujc FA)\n  const handleUnlockEntity = () => {\n    setConfirmDialog({\n      isOpen: true,\n      title: ' Zmna objednvky/smlouvy',\n      message: (\n        <div style={{ lineHeight: '1.6' }}>\n          <p style={{ marginBottom: '1rem', fontWeight: 600 }}>\n            Opravdu chcete zmnit piazen faktury k jin objednvce nebo smlouv?\n          </p>\n          <div style={{ background: '#fef3c7', border: '2px solid #f59e0b', borderRadius: '8px', padding: '1rem', marginBottom: '1rem' }}>\n            <strong style={{ color: '#92400e' }}> VAROVN - Mon dopady:</strong>\n            <ul style={{ margin: '0.5rem 0 0 1.25rem', color: '#78350f' }}>\n              <li>Pvodn objednvka me bt vrcena na <strong>vcnou sprvnost</strong></li>\n              <li>Me dojt ke zmn <strong>workflow stavu</strong> objednvky</li>\n              <li>stka faktury ovlivn <strong>erpn rozpotu</strong> nov entity</li>\n              <li>Historie a notifikace budou navzny na novou entitu</li>\n            </ul>\n          </div>\n          <p style={{ fontSize: '0.9rem', color: '#6b7280' }}>\n            Po odemen budete moci vybrat jinou objednvku nebo smlouvu.\n          </p>\n        </div>\n      ),\n      onConfirm: () => {\n        setIsEntityUnlocked(true);\n        setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n      },\n      onCancel: () => {\n        setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n      }\n    });\n  };\n\n  // Handler: vymazn hledn objednvky\n  const handleClearSearch = () => {\n    setSearchTerm('');\n    setSuggestions([]);\n    setShowSuggestions(false);\n    setFormData(prev => ({ ...prev, order_id: '', smlouva_id: null }));\n    setOrderData(null);\n    setSmlouvaData(null);\n    setSelectedType('order'); // Reset na vchoz\n  };\n\n  // Handler: vbr objednvky z autocomplete\n  const handleSelectOrder = async (order) => {\n    const evCislo = order.cislo_objednavky || order.evidencni_cislo || `#${order.id}`;\n    \n    //  KONTROLA 1: Je tat objednvka oteven na formuli? (draft v localStorage)\n    draftManager.setCurrentUser(user_id);\n    const existingDraft = await draftManager.loadDraft();\n\n    if (existingDraft && existingDraft.formData && parseInt(existingDraft.formData.id) === parseInt(order.id)) {\n      const draftEvCislo = existingDraft.formData.cislo_objednavky || existingDraft.formData.evidencni_cislo || `#${order.id}`;\n      \n      // Zobraz dialog\n      setConfirmDialog({\n        isOpen: true,\n        title: ' Objednvka je oteven na formuli',\n        message: `Objednvka ${draftEvCislo} je prv oteven v editanm formuli.\\n\\n NEJDVE JI ZAVETE!\\n\\nTeprve pot mete pidvat nebo aktualizovat faktury.`,\n        onConfirm: () => {\n          setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n        },\n        onCancel: null\n      });\n      return;\n    }\n\n    //  KONTROLA 2: Je objednvka zamen jinm uivatelem?\n    setOrderLoading(true);\n    try {\n      const orderCheck = await getOrderV2(order.id, token, username, false); // false = bez enriched dat\n      \n      if (orderCheck?.lock_info?.locked === true) {\n        const lockInfo = orderCheck.lock_info;\n        const lockedByUserName = lockInfo.locked_by_user_fullname || `uivatel #${lockInfo.locked_by_user_id}`;\n\n        setOrderLoading(false);\n        \n        // Zobraz dialog\n        setConfirmDialog({\n          isOpen: true,\n          title: ' Objednvka je zamen',\n          message: `Objednvka ${evCislo} je prv oteven na editaci uivatelem ${lockedByUserName}.\\n\\n NEJDVE MUS ${lockedByUserName.toUpperCase()} ZAVT OBJEDNVKU!\\n\\nObjednvka je zamen a nelze ji zpracovvat, dokud ji jin uivatel uzamkl pro editaci.`,\n          onConfirm: () => {\n            setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n          },\n          onCancel: null\n        });\n        return;\n      }\n    } catch (err) {\n      console.warn(' Nepodailo se zkontrolovat lock status:', err);\n    } finally {\n      setOrderLoading(false);\n    }\n\n    //  VE OK - pokrauj s natenm\n    proceedWithOrderLoad(order, evCislo);\n  };\n\n  // Helper funkce pro naten objednvky\n  const proceedWithOrderLoad = (order, evCislo) => {\n    setFormData(prev => ({\n      ...prev,\n      order_id: order.id,\n      smlouva_id: null // Vyistit smlouvu pokud byla pedtm\n    }));\n    setSearchTerm(evCislo);\n    setShowSuggestions(false);\n    setSelectedType('order');\n    setSmlouvaData(null); // Vyistit data smlouvy\n    \n    //  Nastavit pro OrderForm25 - nate z localStorage\n    localStorage.setItem('activeOrderEditId', order.id);\n    \n    loadOrderData(order.id);\n  };\n\n  // Handler: editace faktury - nate fakturu do formule\n  const handleEditInvoice = useCallback((faktura) => {\n    //  Kontrola stavu objednvky - nelze editovat fakturu u objednvky v nevhodnm stavu\n    if (orderData) {\n      const invoiceCheck = canAddInvoiceToOrder(orderData);\n      if (!invoiceCheck.allowed) {\n        showToast && showToast(` ${invoiceCheck.reason}`, 'error');\n        return;\n      }\n    }\n\n    setFormData({\n      order_id: faktura.objednavka_id || '',\n      smlouva_id: faktura.smlouva_id || null,\n      fa_cislo_vema: faktura.fa_cislo_vema || '',\n      fa_typ: faktura.fa_typ || 'BEZNA',\n      fa_datum_vystaveni: faktura.fa_datum_vystaveni || '',\n      fa_datum_splatnosti: faktura.fa_datum_splatnosti || '',\n      fa_datum_doruceni: faktura.fa_datum_doruceni || '',\n      fa_castka: faktura.fa_castka || '',\n      fa_variabilni_symbol: faktura.fa_variabilni_symbol || '',\n      fa_poznamka: faktura.fa_poznamka || '',\n      fa_predana_zam_id: faktura.fa_predana_zam_id || null,\n      fa_datum_predani_zam: faktura.fa_datum_predani_zam || '',\n      fa_datum_vraceni_zam: faktura.fa_datum_vraceni_zam || '',\n      file: null,\n      invoice_id: faktura.id // Ulome ID faktury pro update msto create\n    });\n    \n    setEditingInvoiceId(faktura.id);\n\n    // Scroll na zatek formule\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n    \n    showToast && showToast(' Faktura natena pro pravu', 'info');\n  }, [showToast, orderData, canAddInvoiceToOrder]);\n\n  //  Handler: zmna ploh (controlled component pattern)\n  const handleAttachmentsChange = useCallback((newAttachments) => {\n    setAttachments(newAttachments);\n  }, []);\n\n  //  Handler: po spnm uploadu plohy (placeholder - zatm nepouito)\n  const handleAttachmentUploaded = useCallback((uploadedAttachment) => {\n    // Zde meme ppadn triggernout autosave nebo jin akce\n  }, []);\n\n  //  Validace faktury ped uploadem ploh (podle vzoru OrderForm25)\n  // Parametr: faktura objekt (ne file!) - obsahuje data faktury pro validaci\n  // Parametr: file (optional) - soubor pro kontrolu ISDOC\n  const validateInvoiceForAttachments = useCallback((faktura, file) => {\n    // Pro editaci existujc faktury - povolit upload bez omezen\n    if (editingInvoiceId) {\n      return {\n        isValid: true,\n        isISDOC: false,\n        categories: {}\n      };\n    }\n    \n    // Pokud je file ISDOC, povolit upload i bez vyplnnch pol\n    const isISDOC = file && file.name && file.name.toLowerCase().endsWith('.isdoc');\n    \n    if (isISDOC) {\n      // ISDOC soubor - povolit upload, data se vyt z ISDOC\n      return {\n        isValid: true,\n        isISDOC: true,\n        categories: {}\n      };\n    }\n    \n    // Bn soubory (PDF, JPG...) - kontrolovat povinn pole faktury\n    const categories = {\n      objednateli: {\n        label: 'Informace o objednateli',\n        errors: []\n      },\n      schvaleni: {\n        label: 'Schvlen nkupu PO',\n        errors: []\n      }\n    };\n    \n    // Kategorie: Informace o objednateli\n    if (!faktura?.fa_cislo_vema) categories.objednateli.errors.push('slo faktury');\n    if (!faktura?.fa_datum_splatnosti) categories.objednateli.errors.push('Datum splatnosti');\n    if (!faktura?.fa_castka) categories.objednateli.errors.push('stka');\n    \n    // Kategorie: Schvlen nkupu PO (przdn pro faktury - pouze pro objednvky)\n    // categories.schvaleni.errors zde zstv przdn\n    \n    const allErrors = [...categories.objednateli.errors, ...categories.schvaleni.errors];\n    \n    return {\n      isValid: allErrors.length === 0,\n      isISDOC: false,\n      categories\n    };\n  }, [editingInvoiceId]);\n\n  //  Handler: Vytvoen faktury v DB (pro temp faktury ped uploadem plohy)\n  const handleCreateInvoiceInDB = useCallback(async (tempFakturaId) => {\n    console.log(' handleCreateInvoiceInDB - vytvm fakturu v DB ped uploadem plohy', { tempFakturaId });\n\n    try {\n      const apiParams = {\n        token,\n        username,\n        order_id: formData.order_id || null,\n        smlouva_id: formData.smlouva_id || null,\n        fa_cislo_vema: formData.fa_cislo_vema,\n        fa_typ: formData.fa_typ || 'BEZNA',\n        fa_datum_vystaveni: formData.fa_datum_vystaveni,\n        fa_datum_splatnosti: formData.fa_datum_splatnosti || null,\n        fa_datum_doruceni: formData.fa_datum_doruceni || null,\n        fa_castka: formData.fa_castka,\n        fa_poznamka: formData.fa_poznamka || '',\n        fa_dorucena: formData.fa_datum_doruceni ? 1 : 0,\n        fa_strediska_kod: JSON.stringify(formData.fa_strediska_kod || []),\n        fa_predana_zam_id: formData.fa_predana_zam_id || null,\n        fa_datum_predani_zam: formData.fa_datum_predani_zam || null,\n        fa_datum_vraceni_zam: formData.fa_datum_vraceni_zam || null\n      };\n\n      // Vytvo fakturu bez plohy\n      const result = await createInvoiceV2(apiParams);\n      \n      console.log(' createInvoiceV2 result:', result);\n      \n      // API vrac {status: 'ok', id: 89} ne {invoice_id: 89}\n      if (!result || (!result.invoice_id && !result.id)) {\n        console.error(' Neplatn result z createInvoiceV2:', result);\n        throw new Error('Nepodailo se vytvoit fakturu v DB');\n      }\n\n      const newInvoiceId = result.invoice_id || result.id;\n      console.log(' Faktura vytvoena v DB, ID:', newInvoiceId);\n\n      // Nastav editingInvoiceId, aby se dal plohy uploadovaly k tto faktue\n      setEditingInvoiceId(newInvoiceId);\n\n      return newInvoiceId;\n    } catch (error) {\n      console.error(' Chyba pi vytven faktury v DB:', error);\n      throw error;\n    }\n  }, [token, username, formData]);\n\n  //  Handler: ISDOC parsing - vyplnn faktury z ISDOC souboru\n  const handleISDOCParsed = useCallback((isdocData, isdocSummary) => {\n    try {\n      // Mapovn ISDOC dat na fakturu\n      const mappedData = mapISDOCToFaktura(isdocData, {\n        strediska: strediskaOptions,\n        // Pokud je piazena objednvka, pouij jej stediska\n        orderStrediska: orderData?.strediska_kod || formData.fa_strediska_kod\n      });\n\n      // Aktualizuj formData s daty z ISDOC\n      setFormData(prev => ({\n        ...prev,\n        fa_cislo_vema: mappedData.fa_cislo_vema || prev.fa_cislo_vema,\n        fa_datum_vystaveni: mappedData.fa_datum_vystaveni || prev.fa_datum_vystaveni,\n        fa_datum_splatnosti: mappedData.fa_datum_splatnosti || prev.fa_datum_splatnosti,\n        fa_castka: mappedData.fa_castka || prev.fa_castka,\n        fa_strediska_kod: mappedData.fa_strediska_kod || prev.fa_strediska_kod,\n        fa_poznamka: mappedData.fa_poznamka || prev.fa_poznamka\n      }));\n\n      showToast && showToast(\n        ` Data z ISDOC byla spn natena\\n\\nslo faktury: ${mappedData.fa_cislo_vema}\\nstka: ${mappedData.fa_castka} K`,\n        { type: 'success' }\n      );\n    } catch (error) {\n      console.error(' Chyba pi zpracovn ISDOC:', error);\n      showToast && showToast(\n        `Chyba pi zpracovn ISDOC: ${error.message}`,\n        { type: 'error' }\n      );\n    }\n  }, [formData, orderData, strediskaOptions, showToast]);\n\n  //  OCR Callback - Vypln data z OCR do formule\n  const handleOCRDataExtracted = useCallback((ocrData) => {\n    try {\n      // Aktualizuj formData s daty z OCR\n      setFormData(prev => {\n        const updates = {};\n        \n        // Variabiln symbol -> fa_cislo_vema\n        if (ocrData.variabilniSymbol) {\n          updates.fa_cislo_vema = ocrData.variabilniSymbol;\n        }\n        \n        // Datum vystaven\n        if (ocrData.datumVystaveni) {\n          updates.fa_datum_vystaveni = ocrData.datumVystaveni;\n        }\n        \n        // Datum splatnosti\n        if (ocrData.datumSplatnosti) {\n          updates.fa_datum_splatnosti = ocrData.datumSplatnosti;\n        }\n        \n        // stka\n        if (ocrData.castka) {\n          updates.fa_castka = ocrData.castka;\n        }\n        \n        return {\n          ...prev,\n          ...updates\n        };\n      });\n      \n      console.log(' OCR data spn aplikovna do formule:', ocrData);\n    } catch (error) {\n      console.error(' Chyba pi aplikaci OCR dat:', error);\n      showToast && showToast(\n        `Chyba pi aplikaci OCR dat: ${error.message}`,\n        { type: 'error' }\n      );\n    }\n  }, [showToast]);\n\n  //  Funkce pro odesln notifikac pi zmn stavu objednvky na vcnou kontrolu\n  const sendInvoiceNotifications = async (orderId, orderData) => {\n    try {\n      // Zskej pjemce notifikac z dat objednvky\n      const recipientUserIds = new Set();\n\n      // 1. Objednatel (uzivatel_id nebo objednatel_id)\n      if (orderData.uzivatel_id) {\n        recipientUserIds.add(parseInt(orderData.uzivatel_id, 10));\n      } else if (orderData.objednatel_id) {\n        recipientUserIds.add(parseInt(orderData.objednatel_id, 10));\n      }\n\n      // 2. Garant\n      if (orderData.garant_uzivatel_id) {\n        recipientUserIds.add(parseInt(orderData.garant_uzivatel_id, 10));\n      }\n\n      // 3. Schvalovatel (pkazce)\n      if (orderData.prikazce_id) {\n        recipientUserIds.add(parseInt(orderData.prikazce_id, 10));\n      }\n\n      // Filtr: Odstranit nevalidn ID\n      const validRecipients = Array.from(recipientUserIds).filter(id => {\n        return id && !isNaN(id) && id > 0;\n      });\n\n      // Pokud nejsou dn pjemci, skoni\n      if (validRecipients.length === 0) {\n        console.warn(' dn pjemci notifikac pro objednvku:', orderId);\n        return;\n      }\n\n      // Odeslat notifikaci o zmn stavu na vcnou kontrolu\n      await notificationService.create({\n        token,\n        username,\n        type: NOTIFICATION_TYPES.ORDER_STATUS_KONTROLA_CEKA, // 'order_status_kontrola_ceka'\n        order_id: orderId,\n        action_user_id: user_id,\n        recipients: validRecipients\n      });\n\n      console.log(' Notifikace o vcn kontrole odeslny:', {\n        orderId,\n        recipients: validRecipients,\n        type: NOTIFICATION_TYPES.ORDER_STATUS_KONTROLA_CEKA\n      });\n    } catch (error) {\n      console.error(' Chyba pi odesln notifikac:', error);\n      // Neblokujeme workflow kvli chyb notifikace\n    }\n  };\n\n  // ============================================================\n  // SPISOVKA INBOX PANEL - Drag handling\n  // ============================================================\n  const handleSpisovkaInboxDrag = useCallback((e, key, dir) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    const startX = e.clientX;\n    const startY = e.clientY;\n    const startState = { ...spisovkaInboxState };\n\n    const onMove = (moveEvent) => {\n      const dx = moveEvent.clientX - startX;\n      const dy = moveEvent.clientY - startY;\n\n      setSpisovkaInboxState(prev => {\n        let newState = { ...prev };\n        const minW = 320;\n        const minH = 200;\n\n        if (dir === 'move') {\n          newState.x = Math.max(0, Math.min(startState.x + dx, window.innerWidth - prev.w));\n          newState.y = Math.max(0, Math.min(startState.y + dy, window.innerHeight - prev.h));\n        } \n        // Prav hrana\n        else if (dir === 'right') {\n          newState.w = Math.max(minW, startState.w + dx);\n        } \n        // Lev hrana\n        else if (dir === 'left') {\n          const newW = Math.max(minW, startState.w - dx);\n          if (newW > minW) {\n            newState.w = newW;\n            newState.x = startState.x + dx;\n          }\n        } \n        // Horn hrana\n        else if (dir === 'top') {\n          const newH = Math.max(minH, startState.h - dy);\n          if (newH > minH) {\n            newState.h = newH;\n            newState.y = startState.y + dy;\n          }\n        } \n        // Doln hrana\n        else if (dir === 'bottom') {\n          newState.h = Math.max(minH, startState.h + dy);\n        } \n        // Rohy\n        else if (dir === 'top-left') {\n          const newW = Math.max(minW, startState.w - dx);\n          const newH = Math.max(minH, startState.h - dy);\n          if (newW > minW) {\n            newState.w = newW;\n            newState.x = startState.x + dx;\n          }\n          if (newH > minH) {\n            newState.h = newH;\n            newState.y = startState.y + dy;\n          }\n        } \n        else if (dir === 'top-right') {\n          const newH = Math.max(minH, startState.h - dy);\n          newState.w = Math.max(minW, startState.w + dx);\n          if (newH > minH) {\n            newState.h = newH;\n            newState.y = startState.y + dy;\n          }\n        } \n        else if (dir === 'bottom-left') {\n          const newW = Math.max(minW, startState.w - dx);\n          newState.h = Math.max(minH, startState.h + dy);\n          if (newW > minW) {\n            newState.w = newW;\n            newState.x = startState.x + dx;\n          }\n        } \n        else if (dir === 'bottom-right') {\n          newState.w = Math.max(minW, startState.w + dx);\n          newState.h = Math.max(minH, startState.h + dy);\n        }\n\n        return newState;\n      });\n    };\n\n    const onUp = () => {\n      document.removeEventListener('mousemove', onMove);\n      document.removeEventListener('mouseup', onUp);\n    };\n\n    document.addEventListener('mousemove', onMove);\n    document.addEventListener('mouseup', onUp);\n  }, [spisovkaInboxState]);\n\n  // Handler: submit formule\n  const handleSubmit = async () => {\n    setError(null);\n    setFieldErrors({});\n\n    //  Kontrola stavu objednvky (pouze pokud nen editace existujc faktury)\n    if (formData.order_id && orderData && !editingInvoiceId) {\n      const invoiceCheck = canAddInvoiceToOrder(orderData);\n      if (!invoiceCheck.allowed) {\n        setError(invoiceCheck.reason);\n        showToast && showToast(invoiceCheck.reason, 'error');\n        return;\n      }\n    }\n\n    //  Validace povinnch pol\n    const errors = {};\n    \n    // slo faktury - POVINN\n    if (!formData.fa_cislo_vema || !formData.fa_cislo_vema.trim()) {\n      errors.fa_cislo_vema = 'Vyplte slo faktury';\n    }\n\n    // Typ faktury - POVINN\n    if (!formData.fa_typ) {\n      errors.fa_typ = 'Vyberte typ faktury';\n    }\n\n    // Datum doruen - POVINN\n    if (!formData.fa_datum_doruceni) {\n      errors.fa_datum_doruceni = 'Vyplte datum doruen';\n    }\n\n    // Datum vystaven - POVINN\n    if (!formData.fa_datum_vystaveni) {\n      errors.fa_datum_vystaveni = 'Vyplte datum vystaven';\n    }\n\n    // Datum splatnosti - POVINN\n    if (!formData.fa_datum_splatnosti) {\n      errors.fa_datum_splatnosti = 'Vyplte datum splatnosti';\n    }\n\n    // stka - POVINN\n    if (!formData.fa_castka || parseFloat(formData.fa_castka) <= 0) {\n      errors.fa_castka = 'Vyplte platnou stku faktury';\n    }\n\n    // Validace datum pedn/vrcen (nepovinn, ale pokud jsou vyplnn)\n    if (formData.fa_datum_predani_zam && formData.fa_datum_vraceni_zam) {\n      const predani = new Date(formData.fa_datum_predani_zam);\n      const vraceni = new Date(formData.fa_datum_vraceni_zam);\n      if (vraceni < predani) {\n        errors.fa_datum_vraceni_zam = 'Datum vrcen neme bt dvj ne datum pedn';\n      }\n    }\n\n    // Pokud jsou chyby, zobraz je a zastav submit\n    if (Object.keys(errors).length > 0) {\n      setFieldErrors(errors);\n      setError('Opravte prosm chyby ve formuli ped odeslnm');\n      return;\n    }\n\n    setLoading(true);\n    setProgress?.(50);\n\n    try {\n      // Vcn sprvnost podle dokumentace\n      const getMysqlDateTime = () => {\n        return new Date().toISOString().slice(0, 19).replace('T', ' ');\n      };\n\n      console.log(' FORM DATA ped API:', {\n        fa_typ: formData.fa_typ,\n        fa_typ_type: typeof formData.fa_typ\n      });\n\n      const apiParams = {\n        token,\n        username,\n        order_id: formData.order_id || null, // Me bt null pokud faktura nen vzna na objednvku\n        smlouva_id: formData.smlouva_id || null, // Me bt null pokud faktura nen vzna na smlouvu\n        fa_cislo_vema: formData.fa_cislo_vema,\n        fa_typ: formData.fa_typ || 'BEZNA',\n        fa_datum_vystaveni: formData.fa_datum_vystaveni,\n        fa_datum_splatnosti: formData.fa_datum_splatnosti || null,\n        fa_datum_doruceni: formData.fa_datum_doruceni || null,\n        fa_castka: formData.fa_castka,\n        fa_poznamka: formData.fa_poznamka || '',\n        fa_dorucena: formData.fa_datum_doruceni ? 1 : 0,\n        // fa_strediska_kod je ji array string [\"101_RLP_KLADNO\"], jen JSON.stringify\n        fa_strediska_kod: JSON.stringify(formData.fa_strediska_kod || []),\n        // Nov poloky (nepovinn) - null pokud nen vyplnno\n        fa_predana_zam_id: formData.fa_predana_zam_id || null,\n        fa_datum_predani_zam: formData.fa_datum_predani_zam || null,\n        fa_datum_vraceni_zam: formData.fa_datum_vraceni_zam || null\n      };\n\n      console.log(' API PARAMS:', {\n        fa_typ: apiParams.fa_typ,\n        fa_typ_type: typeof apiParams.fa_typ\n      });\n\n      let result;\n\n      if (editingInvoiceId) {\n        // EDITACE - UPDATE faktury\n        // updateInvoiceV2 oekv updateData jako separtn objekt\n        const updateData = {\n          objednavka_id: formData.order_id || null,\n          smlouva_id: formData.smlouva_id || null,\n          fa_cislo_vema: formData.fa_cislo_vema,\n          fa_typ: formData.fa_typ || 'BEZNA',\n          fa_datum_vystaveni: formData.fa_datum_vystaveni,\n          fa_datum_splatnosti: formData.fa_datum_splatnosti || null,\n          fa_datum_doruceni: formData.fa_datum_doruceni || null,\n          fa_castka: formData.fa_castka,\n          fa_poznamka: formData.fa_poznamka || '',\n          fa_dorucena: formData.fa_datum_doruceni ? 1 : 0,\n          fa_predana_zam_id: formData.fa_predana_zam_id || null,\n          fa_datum_predani_zam: formData.fa_datum_predani_zam || null,\n          fa_datum_vraceni_zam: formData.fa_datum_vraceni_zam || null,\n          // fa_strediska_kod je ji array string [\"101_RLP_KLADNO\"], jen JSON.stringify\n          fa_strediska_kod: JSON.stringify(formData.fa_strediska_kod || [])\n        };\n\n        result = await updateInvoiceV2({\n          token,\n          username,\n          invoice_id: editingInvoiceId,\n          updateData\n        });\n        \n        setProgress?.(100);\n        showToast && showToast(' Faktura byla spn aktualizovna', 'success');\n      } else {\n        // NOV FAKTURA - CREATE\n        if (formData.file) {\n          // S plohou\n          result = await createInvoiceWithAttachmentV2({\n            ...apiParams,\n            file: formData.file,\n            klasifikace: formData.klasifikace || null // Typ plohy\n          });\n        } else {\n          // Bez plohy\n          result = await createInvoiceV2(apiParams);\n        }\n\n        setProgress?.(100);\n        showToast && showToast(' Faktura byla spn zaevidovna', 'success');\n      }\n\n      //  Pokud je faktura pipojena k objednvce, aktualizuj workflow stav\n      // - NOV FAKTURA: pidat stav VECNA_SPRAVNOST\n      // - EDITACE: vrtit na VECNA_SPRAVNOST (mus projt novou kontrolou)\n      if (formData.order_id && orderData) {\n        try {\n          // Parsuj aktuln workflow stavy\n          let stavKody = [];\n          try {\n            if (typeof orderData.stav_workflow_kod === 'string') {\n              stavKody = JSON.parse(orderData.stav_workflow_kod);\n            } else if (Array.isArray(orderData.stav_workflow_kod)) {\n              stavKody = [...orderData.stav_workflow_kod];\n            }\n          } catch (e) {\n            console.error('Chyba pi parsovn workflow stav:', e);\n            stavKody = [];\n          }\n\n          // Zskej aktuln (posledn) stav\n          const currentState = stavKody.length > 0 ? stavKody[stavKody.length - 1] : null;\n\n          // Logika pro zmnu workflow stavu podle aktulnho stavu:\n          // NOV FAKTURA:\n          // 1. NEUVEREJNIT nebo UVEREJNENA  pidat FAKTURACE  pidat VECNA_SPRAVNOST\n          // 2. FAKTURACE  pidat VECNA_SPRAVNOST\n          // 3. ZKONTROLOVANA  vrtit na VECNA_SPRAVNOST (faktury byly upraveny)\n          // 4. VECNA_SPRAVNOST  nechat beze zmny\n          // \n          // EDITACE FAKTURY:\n          // - ZKONTROLOVANA nebo DOKONCENA  vrtit na VECNA_SPRAVNOST (mus projt novou kontrolou)\n          // - VECNA_SPRAVNOST  nechat (u ek na kontrolu)\n          \n          let needsUpdate = false;\n          \n          if (editingInvoiceId) {\n            // EDITACE existujc faktury\n            if (currentState === 'ZKONTROLOVANA' || currentState === 'DOKONCENA') {\n              // Vrtit zpt na VECNA_SPRAVNOST - mus projt novou kontrolou\n              stavKody.pop(); // Odstra posledn stav (ZKONTROLOVANA/DOKONCENA)\n              if (currentState === 'DOKONCENA' && stavKody[stavKody.length - 1] === 'ZKONTROLOVANA') {\n                stavKody.pop(); // Odstra i ZKONTROLOVANA pokud tam je\n              }\n              // Ujisti se e m VECNA_SPRAVNOST\n              if (stavKody[stavKody.length - 1] !== 'VECNA_SPRAVNOST') {\n                stavKody.push('VECNA_SPRAVNOST');\n              }\n              needsUpdate = true;\n              console.log(' EDITACE FAKTURY: Objednvka vrcena na vcnou sprvnost');\n            }\n            // Pokud je u ve VECNA_SPRAVNOST, nechme beze zmny\n          } else {\n            // NOV FAKTURA\n            if (currentState === 'NEUVEREJNIT' || currentState === 'UVEREJNENA') {\n              // Prvn faktura  pidat FAKTURACE a pak VECNA_SPRAVNOST\n              stavKody.push('FAKTURACE');\n              stavKody.push('VECNA_SPRAVNOST');\n              needsUpdate = true;\n            } else if (currentState === 'FAKTURACE') {\n              // U m FAKTURACE  jen pidat VECNA_SPRAVNOST\n              stavKody.push('VECNA_SPRAVNOST');\n              needsUpdate = true;\n            } else if (currentState === 'ZKONTROLOVANA') {\n              // Vrtit zpt na VECNA_SPRAVNOST (faktury byly upraveny)\n              stavKody.pop(); // Odstra ZKONTROLOVANA\n              needsUpdate = true;\n            }\n            // Pokud je currentState === 'VECNA_SPRAVNOST', nechme beze zmny (needsUpdate = false)\n          }\n\n          if (needsUpdate) {\n            // Aktualizuj objednvku\n            //  Krom stav_workflow_kod je nutn aktualizovat i stav_objednavky (textov stav)\n            await updateOrderV2(\n              formData.order_id,\n              { \n                stav_workflow_kod: JSON.stringify(stavKody),\n                stav_objednavky: 'Vcn sprvnost'  // Text odpovdajc stavu VECNA_SPRAVNOST\n              },\n              token,\n              username\n            );\n\n            console.log(' Workflow objednvky aktualizovno:', {\n              oldState: currentState,\n              newStates: stavKody,\n              newStatusText: 'Vcn sprvnost'\n            });\n\n            //  NOTIFIKACE: Odeslat notifikace objednateli, garantovi a schvalovateli\n            await sendInvoiceNotifications(formData.order_id, orderData);\n\n            //  Reload objednvky aby se zobrazil nov stav\n            await loadOrderData(formData.order_id);\n          }\n        } catch (updateErr) {\n          console.error(' Nepodailo se aktualizovat workflow objednvky:', updateErr);\n          // Neblokujeme spch faktury, jen logujeme chybu\n        }\n      }\n\n      //  ZSTAT NA FORMULI - pouze resetovat formul faktury\n      // Pi editaci vymazat entity, pi nov faktue zachovat pro dal evidenci\n      const keepEntity = !editingInvoiceId;\n      \n      //  VJIMKA: Pokud je vyplnno \"Vyberte obj/sml\" (searchTerm nen przdn),\n      // resetovat entity i pi nov faktue\n      const shouldResetEntity = !keepEntity || searchTerm.trim().length > 0;\n      \n      setFormData({\n        order_id: shouldResetEntity ? '' : formData.order_id,\n        smlouva_id: shouldResetEntity ? null : formData.smlouva_id,\n        fa_cislo_vema: '',\n        fa_typ: 'BEZNA',\n        fa_datum_doruceni: formatDateForPicker(new Date()),\n        fa_datum_vystaveni: '', // Nechat przdn - vypln OCR nebo uivatel\n        fa_datum_splatnosti: '',\n        fa_castka: '',\n        fa_poznamka: '',\n        fa_strediska_kod: [],\n        file: null,\n        fa_predana_zam_id: null,\n        fa_datum_predani_zam: '',\n        fa_datum_vraceni_zam: ''\n      });\n\n      // Reset editace faktury a ploh\n      const wasEditing = !!editingInvoiceId;\n      setEditingInvoiceId(null);\n      setAttachments([]); //  DLEIT: Vyistit seznam ploh po uloen\n      \n      // Reset preview entity a autocomplete pokud je poteba\n      if (shouldResetEntity) {\n        setOrderData(null);\n        setSmlouvaData(null);\n        setSearchTerm('');\n        setShowSuggestions(false);\n        setIsEntityUnlocked(false); // Reset unlock stavu\n        setHadOriginalEntity(false);\n      } else if (!wasEditing) {\n        // Pi nov faktue (bez resetu entity) refresh objednvky pro aktualizovan faktury\n        if (formData.order_id && orderData) {\n          await loadOrderData(formData.order_id);\n        }\n      }\n\n      // Reset pole errors a tracking zmn\n      setFieldErrors({});\n      setOriginalFormData(null);\n      setHasChangedCriticalField(false);\n\n    } catch (err) {\n      console.error('Error creating invoice:', err);\n      setError(err.message || 'Chyba pi evidenci faktury');\n      showToast && showToast(err.message || 'Chyba pi evidenci faktury', 'error');\n      setProgress?.(0);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Handler: zpt na seznam\n  const handleBack = () => {\n    navigate(-1);\n  };\n\n  // Handler: toggle fullscreen\n  const toggleFullscreen = () => {\n    setIsFullscreen(prev => !prev);\n  };\n\n  // Helper: Toggle select dropdown\n  const toggleSelect = (fieldName) => {\n    setSelectStates(prev => ({\n      ...prev,\n      [fieldName]: !prev[fieldName]\n    }));\n  };\n\n  // Helper: Filter options\n  const filterOptions = (options, searchTerm) => {\n    if (!searchTerm) return options;\n    const lowerSearch = searchTerm.toLowerCase();\n    return options.filter(opt => \n      (opt.label || opt).toLowerCase().includes(lowerSearch)\n    );\n  };\n\n  // Helper: Get option label\n  const getOptionLabel = (option) => {\n    return option?.label || option?.value || option;\n  };\n\n  // MultiSelect komponenta\n  const MultiSelect = ({\n    values = [],\n    onChange,\n    options = [],\n    placeholder,\n    disabled = false\n  }) => {\n    const safeValues = Array.isArray(values) ? values : [];\n    const isOpen = selectStates.strediska;\n    const searchTerm = searchStates.strediska || '';\n    const dropdownRef = useRef(null);\n    const buttonRef = useRef(null);\n    const searchInputRef = useRef(null);\n\n    const filteredOptions = filterOptions(options, searchTerm);\n\n    // Zavt dropdown pi kliku mimo\n    useEffect(() => {\n      if (!isOpen) return;\n\n      const handleClickOutside = (event) => {\n        if (\n          dropdownRef.current && \n          buttonRef.current &&\n          !dropdownRef.current.contains(event.target) &&\n          !buttonRef.current.contains(event.target)\n        ) {\n          setSelectStates(prev => ({ ...prev, strediska: false }));\n        }\n      };\n\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => {\n        document.removeEventListener('mousedown', handleClickOutside);\n      };\n    }, [isOpen]);\n\n    // Pozicovn pro fixed dropdown\n    useEffect(() => {\n      if (isOpen && buttonRef.current && dropdownRef.current) {\n        const updatePosition = () => {\n          if (!buttonRef.current || !dropdownRef.current) return;\n          const buttonRect = buttonRef.current.getBoundingClientRect();\n          const dropdown = dropdownRef.current;\n\n          dropdown.style.left = buttonRect.left + 'px';\n          dropdown.style.width = buttonRect.width + 'px';\n          dropdown.style.top = (buttonRect.bottom + 2) + 'px';\n        };\n\n        updatePosition();\n        window.addEventListener('scroll', updatePosition, { passive: true, capture: true });\n        window.addEventListener('resize', updatePosition, { passive: true });\n\n        return () => {\n          window.removeEventListener('scroll', updatePosition, { capture: true });\n          window.removeEventListener('resize', updatePosition);\n        };\n      }\n    }, [isOpen]);\n\n    // Auto-focus search\n    useEffect(() => {\n      if (isOpen && searchInputRef.current) {\n        setTimeout(() => {\n          searchInputRef.current?.focus();\n        }, 100);\n      }\n    }, [isOpen]);\n\n    const displayValue = safeValues.length > 0\n      ? safeValues.map(val => {\n          const option = options.find(opt => opt.value === val || opt === val);\n          return option ? getOptionLabel(option) : val;\n        }).join(', ')\n      : placeholder;\n\n    const handleToggleOption = (option) => {\n      const optionValue = option.value || option;\n      const newValues = safeValues.includes(optionValue)\n        ? safeValues.filter(v => v !== optionValue)\n        : [...safeValues, optionValue];\n\n      onChange({ target: { value: newValues } });\n    };\n\n    return (\n      <MultiSelectWrapper isOpen={isOpen}>\n        <MultiSelectButton\n          ref={buttonRef}\n          onClick={() => !disabled && toggleSelect('strediska')}\n          disabled={disabled}\n          placeholder={safeValues.length === 0 ? \"true\" : \"false\"}\n          value={safeValues.length > 0 ? 'selected' : ''}\n          isOpen={isOpen}\n        >\n          <SelectedValue isEmpty={safeValues.length === 0}>{displayValue}</SelectedValue>\n        </MultiSelectButton>\n\n        {isOpen && !disabled && (\n          <MultiSelectDropdown ref={dropdownRef}>\n            <SearchBox>\n              <SearchIcon>\n                <Search size={16} />\n              </SearchIcon>\n              <SearchInput\n                ref={searchInputRef}\n                type=\"text\"\n                placeholder=\"Vyhledat stedisko...\"\n                value={searchTerm}\n                onChange={(e) => setSearchStates(prev => ({\n                  ...prev,\n                  strediska: e.target.value\n                }))}\n              />\n            </SearchBox>\n\n            {filteredOptions.map((option, index) => {\n              const optionValue = option.value || option;\n              const isChecked = safeValues.includes(optionValue);\n\n              return (\n                <MultiSelectOption\n                  key={option.value || index}\n                  level={option.level || 0}\n                  onClick={() => handleToggleOption(option)}\n                >\n                  <input\n                    type=\"checkbox\"\n                    checked={isChecked}\n                    readOnly\n                  />\n                  <span>{getOptionLabel(option)}</span>\n                </MultiSelectOption>\n              );\n            })}\n\n            {filteredOptions.length === 0 && (\n              <div style={{ padding: '1rem', textAlign: 'center', color: '#9ca3af' }}>\n                dn stedisko nenalezeno\n              </div>\n            )}\n          </MultiSelectDropdown>\n        )}\n      </MultiSelectWrapper>\n    );\n  };\n\n  // Content komponenta (sdlen pro normal i fullscreen reim)\n  const PageContent = (\n    <>\n      <PageHeader>\n        <PageTitle>\n          <FontAwesomeIcon icon={editingInvoiceId ? faEdit : faFileInvoice} />\n          {editingInvoiceId ? 'Upravit fakturu' : 'Zaevidovat fakturu'}\n        </PageTitle>\n        <HeaderActions>\n          {hasPermission('ADMIN') && (\n            <TooltipWrapper\n              ref={tooltipButtonRef}\n              onMouseEnter={() => {\n                setShowSpisovkaTooltip(true);\n                if (tooltipButtonRef.current) {\n                  const rect = tooltipButtonRef.current.getBoundingClientRect();\n                  const tooltipWidth = 350;\n                  let left = rect.right - tooltipWidth;\n                  \n                  // Adjust if tooltip would go off left edge\n                  if (left < 10) {\n                    left = 10;\n                  }\n                  \n                  // Adjust if tooltip would go off right edge\n                  if (left + tooltipWidth > window.innerWidth - 10) {\n                    left = window.innerWidth - tooltipWidth - 10;\n                  }\n                  \n                  setTooltipPosition({\n                    top: rect.bottom + 10,\n                    left: left\n                  });\n                }\n              }}\n              onMouseLeave={() => setShowSpisovkaTooltip(false)}\n            >\n              <IconButton \n                onClick={() => {\n                  setShowSpisovkaTooltip(false);\n                  setSpisovkaInboxOpen(!spisovkaInboxOpen);\n                }} \n                title={spisovkaInboxOpen ? 'Zavt Spisovka InBox' : 'Otevt Spisovka InBox'}\n                style={{ \n                  backgroundColor: spisovkaInboxOpen ? 'rgba(16, 185, 129, 0.2)' : 'transparent',\n                  color: spisovkaInboxOpen ? '#10b981' : '#9ca3af'\n                }}\n              >\n                <FontAwesomeIcon icon={faBookOpen} />\n                {spisovkaTodayCount > 0 && (\n                  <NotificationBadge>{spisovkaTodayCount}</NotificationBadge>\n                )}\n              </IconButton>\n              <TooltipContent \n                show={showSpisovkaTooltip && spisovkaLastRecords.length > 0}\n                $top={tooltipPosition.top}\n                $left={tooltipPosition.left}\n              >\n                <TooltipTitle>Poslednch 5 zznam</TooltipTitle>\n                {spisovkaLastRecords.map((record) => (\n                  <TooltipItem key={record.dokument_id}>\n                    <TooltipItemTitle>{record.nazev}</TooltipItemTitle>\n                    <TooltipItemMeta>\n                      <span> {record.pocet_priloh} plohy</span>\n                      <span>#{record.dokument_id}</span>\n                    </TooltipItemMeta>\n                  </TooltipItem>\n                ))}\n              </TooltipContent>\n            </TooltipWrapper>\n          )}\n          <IconButton onClick={toggleFullscreen} title={isFullscreen ? 'Normln reim' : 'Cel obrazovka'}>\n            <FontAwesomeIcon icon={isFullscreen ? faCompress : faExpand} />\n          </IconButton>\n          <IconButton onClick={handleBack} title=\"Zavt a vrtit se na seznam faktur\">\n            <FontAwesomeIcon icon={faTimes} />\n          </IconButton>\n        </HeaderActions>\n      </PageHeader>\n\n      <ContentLayout $fullscreen={isFullscreen}>\n        {/* LEV STRANA - FORMUL (60%) */}\n        <FormColumn>\n          <FormColumnHeader style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', gap: '1rem' }}>\n            <SectionTitle style={{ margin: 0 }}>\n              <FontAwesomeIcon icon={faCreditCard} />\n              daje faktury\n              {editingInvoiceId && (\n                <span style={{ \n                  marginLeft: '1rem',\n                  color: '#6b7280',\n                  fontSize: '0.9rem',\n                  fontWeight: 400\n                }}>\n                  - Reim prav #{editingInvoiceId}\n                </span>\n              )}\n            </SectionTitle>\n            {editingInvoiceId && (\n              <button\n                onClick={() => {\n                  //  Kompletn reset pi zruen pravy\n                  setEditingInvoiceId(null);\n                  setAttachments([]); //  Vyistit plohy\n                  setOriginalFormData(null);\n                  setHasChangedCriticalField(false);\n                  setIsEntityUnlocked(false);\n                  setHadOriginalEntity(false);\n                  setFieldErrors({});\n                  \n                  //  Pi duplikaci resetovat i autocomplete pokud byl pouit\n                  const shouldResetEntity = searchTerm.trim().length > 0;\n                  \n                  setFormData({\n                    order_id: shouldResetEntity ? '' : formData.order_id,\n                    smlouva_id: shouldResetEntity ? null : formData.smlouva_id,\n                    fa_cislo_vema: '',\n                    fa_typ: 'BEZNA',\n                    fa_datum_doruceni: formatDateForPicker(new Date()),\n                    fa_datum_vystaveni: '', // Nechat przdn - vypln OCR nebo uivatel\n                    fa_datum_splatnosti: '',\n                    fa_castka: '',\n                    fa_poznamka: '',\n                    fa_strediska_kod: [],\n                    file: null,\n                    fa_predana_zam_id: null,\n                    fa_datum_predani_zam: '',\n                    fa_datum_vraceni_zam: ''\n                  });\n                  \n                  //  Reset autocomplete pokud byl pouit\n                  if (shouldResetEntity) {\n                    setOrderData(null);\n                    setSmlouvaData(null);\n                    setSearchTerm('');\n                    setShowSuggestions(false);\n                  }\n                  \n                  navigate(location.pathname, { replace: true, state: {} });\n                  showToast && showToast(' Formul resetovn pro novou fakturu', 'info');\n                }}\n                style={{\n                  background: '#dc2626',\n                  color: 'white',\n                  border: 'none',\n                  padding: '0.5rem 1rem',\n                  borderRadius: '6px',\n                  cursor: 'pointer',\n                  fontSize: '0.9rem',\n                  fontWeight: '600'\n                }}\n                title=\"Zruit pravy a vrtit se k novmu zznamu\"\n              >\n                <FontAwesomeIcon icon={faTimes} /> Zruit pravu\n              </button>\n            )}\n          </FormColumnHeader>\n\n          <FormColumnContent>\n            {error && (\n              <ErrorAlert>\n                <FontAwesomeIcon icon={faExclamationTriangle} />\n                {error}\n              </ErrorAlert>\n            )}\n\n            <FakturaCard $isEditing={true}>\n            {/* DEK 1: Nzev smlouvy / Pedmt objednvky - pes celou ku */}\n            <FieldRow $columns=\"1fr\">\n              <FieldGroup>\n                <FieldLabel>\n                  {selectedType === 'smlouva' ? 'Nzev smlouvy' : 'Pedmt objednvky'}\n                </FieldLabel>\n                <div style={{ \n                  minHeight: '62px',\n                  padding: '0.75rem',\n                  display: 'flex',\n                  alignItems: 'center',\n                  background: (orderData || smlouvaData) ? '#f0f9ff' : '#f9fafb', \n                  border: (orderData || smlouvaData) ? '2px solid #3b82f6' : '2px solid #e5e7eb', \n                  borderRadius: '8px',\n                  color: (orderData || smlouvaData) ? '#1e40af' : '#9ca3af',\n                  fontWeight: (orderData || smlouvaData) ? '600' : '400',\n                  fontSize: '0.95rem',\n                  boxSizing: 'border-box'\n                }}>\n                  {selectedType === 'order' && orderData \n                    ? (orderData.predmet || '')\n                    : selectedType === 'smlouva' && smlouvaData\n                    ? (smlouvaData.nazev_smlouvy || smlouvaData.nazev || '')\n                    : ''}\n                </div>\n              </FieldGroup>\n            </FieldRow>\n\n            {/* DEK 2: Vbr objednvky/smlouvy | Platnost/Datum vytvoen | Celkov cena */}\n            <FieldRow $columns=\"2fr 1fr 1fr\">\n              <FieldGroup style={{ width: '100%' }}>\n                <FieldLabel>\n                  Vyberte objednvku nebo smlouvu\n                </FieldLabel>\n                <AutocompleteWrapper className=\"autocomplete-wrapper\" style={{ width: '100%', position: 'relative' }}>\n                  {/* Ikona zmku - klikateln pro odemen */}\n                  {editingInvoiceId && hadOriginalEntity && (formData.order_id || formData.smlouva_id) && !isEntityUnlocked && (\n                    <div\n                      onClick={handleUnlockEntity}\n                      style={{\n                        position: 'absolute',\n                        left: '0.75rem',\n                        top: '50%',\n                        transform: 'translateY(-50%)',\n                        color: '#f59e0b',\n                        fontSize: '0.875rem',\n                        zIndex: 1,\n                        cursor: 'pointer',\n                        transition: 'color 0.2s'\n                      }}\n                      onMouseEnter={(e) => e.currentTarget.style.color = '#d97706'}\n                      onMouseLeave={(e) => e.currentTarget.style.color = '#f59e0b'}\n                      title=\"Kliknte pro odemen zmny objednvky/smlouvy\"\n                    >\n                      <FontAwesomeIcon icon={faLock} />\n                    </div>\n                  )}\n                  <AutocompleteInput\n                    type=\"text\"\n                    value={searchTerm}\n                    onChange={handleSearchChange}\n                    onFocus={() => setShowSuggestions(true)}\n                    disabled={!!orderId || (editingInvoiceId && hadOriginalEntity && (formData.order_id || formData.smlouva_id) && !isEntityUnlocked)}\n                    placeholder={\n                      \"Zante pst ev. slo objednvky nebo smlouvy (min. 3 znaky)...\"\n                    }\n                    style={{ \n                      width: '100%',\n                      paddingLeft: (editingInvoiceId && hadOriginalEntity && (formData.order_id || formData.smlouva_id) && !isEntityUnlocked) ? '2.5rem' : '0.75rem',\n                      paddingRight: searchTerm ? '2.5rem' : '0.75rem'\n                    }}\n                  />\n                  {searchTerm && (\n                    <ClearButton\n                      type=\"button\"\n                      onClick={handleClearSearch}\n                      title=\"Vymazat text\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </ClearButton>\n                  )}\n                  {showSuggestions && searchTerm && (\n                    <AutocompleteDropdown>\n                      {isSearching ? (\n                        <SearchingSpinner>\n                          <FontAwesomeIcon icon={faFileInvoice} spin />\n                          {' Vyhledvm...'}\n                        </SearchingSpinner>\n                      ) : searchTerm.length < 3 ? (\n                        <NoResults>\n                          <FontAwesomeIcon icon={faSearch} style={{ marginRight: '0.5rem' }} />\n                          Zadejte alespo 3 znaky pro vyhledvn\n                        </NoResults>\n                      ) : suggestions.length > 0 ? (\n                        suggestions.map(item => {\n                          const isOrder = item._type === 'order';\n                          const isSmlouva = item._type === 'smlouva';\n\n                          // Pro objednvky\n                          if (isOrder) {\n                            const stavText = item.stav || '';\n                            const getStavColor = (stav) => {\n                              const stavLower = (stav || '').toLowerCase();\n                              if (stavLower.includes('dokonen') || stavLower.includes('zkontrolovan')) {\n                                return { bg: '#d1fae5', text: '#065f46' };\n                              }\n                              if (stavLower.includes('fakturac') || stavLower.includes('vcn sprvnost')) {\n                                return { bg: '#dbeafe', text: '#1e40af' };\n                              }\n                              if (stavLower.includes('odeslan') || stavLower.includes('potvr')) {\n                                return { bg: '#e0e7ff', text: '#3730a3' };\n                              }\n                              if (stavLower.includes('schval')) {\n                                return { bg: '#fef3c7', text: '#92400e' };\n                              }\n                              return { bg: '#e5e7eb', text: '#374151' };\n                            };\n                            const stavColors = getStavColor(stavText);\n\n                            return (\n                              <OrderSuggestionItem\n                                key={`order-${item.id}`}\n                                onClick={() => handleSelectOrder(item)}\n                              >\n                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', gap: '0.5rem' }}>\n                                  <OrderSuggestionTitle style={{ flex: 1 }}>\n                                    <OrderSuggestionBadge $color=\"#3b82f6\" $textColor=\"white\" style={{ marginRight: '0.5rem' }}>\n                                      OBJ\n                                    </OrderSuggestionBadge>\n                                    {item.cislo_objednavky || item.evidencni_cislo || `#${item.id}`}\n                                    {stavText && (\n                                      <OrderSuggestionBadge $color={stavColors.bg} $textColor={stavColors.text} style={{ marginLeft: '0.5rem' }}>\n                                        {stavText}\n                                      </OrderSuggestionBadge>\n                                    )}\n                                    {item.max_cena_s_dph && (\n                                      <OrderSuggestionBadge $color=\"#fef3c7\" $textColor=\"#92400e\" style={{ marginLeft: '0.5rem' }}>\n                                        {parseFloat(item.max_cena_s_dph).toLocaleString('cs-CZ')} K\n                                      </OrderSuggestionBadge>\n                                    )}\n                                  </OrderSuggestionTitle>\n                                  {item.pocet_faktur !== undefined && (\n                                    <OrderSuggestionBadge \n                                      $color={item.pocet_faktur > 0 ? '#e0f2fe' : '#f1f5f9'} \n                                      $textColor={item.pocet_faktur > 0 ? '#0369a1' : '#64748b'}\n                                      style={{ flexShrink: 0, display: 'flex', alignItems: 'center', gap: '0.25rem' }}\n                                    >\n                                      <FontAwesomeIcon icon={faFileInvoice} style={{ fontSize: '0.7rem' }} />\n                                      {item.pocet_faktur || 0}\n                                    </OrderSuggestionBadge>\n                                  )}\n                                </div>\n                                <OrderSuggestionDetail>\n                                  {item.predmet && <span><strong>Pedmt:</strong> {item.predmet}</span>}\n                                  {item.dodavatel_nazev && (\n                                    <span>\n                                      <strong>{item.dodavatel_nazev}</strong>\n                                      {item.dodavatel_ico && ` (IO: ${item.dodavatel_ico})`}\n                                    </span>\n                                  )}\n                                </OrderSuggestionDetail>\n                              </OrderSuggestionItem>\n                            );\n                          }\n\n                          // Pro smlouvy\n                          if (isSmlouva) {\n                            return (\n                              <OrderSuggestionItem\n                                key={`smlouva-${item.id}`}\n                                onClick={() => {\n                                  setSelectedType('smlouva');\n                                  loadSmlouvaData(item.id);\n                                  setShowSuggestions(false);\n                                }}\n                              >\n                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', gap: '0.5rem' }}>\n                                  <OrderSuggestionTitle style={{ flex: 1 }}>\n                                    <OrderSuggestionBadge $color=\"#10b981\" $textColor=\"white\" style={{ marginRight: '0.5rem' }}>\n                                      SML\n                                    </OrderSuggestionBadge>\n                                    {item.cislo_smlouvy}\n                                    {item.hodnota_s_dph && (\n                                      <OrderSuggestionBadge $color=\"#fef3c7\" $textColor=\"#92400e\" style={{ marginLeft: '0.5rem' }}>\n                                        {parseFloat(item.hodnota_s_dph).toLocaleString('cs-CZ')} K\n                                      </OrderSuggestionBadge>\n                                    )}\n                                  </OrderSuggestionTitle>\n                                </div>\n                                <OrderSuggestionDetail>\n                                  {item.nazev_smlouvy && <span><strong>Nzev:</strong> {item.nazev_smlouvy}</span>}\n                                  {item.nazev_firmy && (\n                                    <span>\n                                      <strong>{item.nazev_firmy}</strong>\n                                      {item.ico && ` (IO: ${item.ico})`}\n                                    </span>\n                                  )}\n                                </OrderSuggestionDetail>\n                              </OrderSuggestionItem>\n                            );\n                          }\n\n                          return null;\n                        })\n                      ) : (\n                        <NoResults>\n                          <FontAwesomeIcon icon={faSearch} style={{ marginRight: '0.5rem' }} />\n                          dn objednvky ani smlouvy nenalezeny\n                          <div style={{ fontSize: '0.75rem', marginTop: '0.5rem', color: '#9ca3af' }}>\n                            Hledaj se odeslan objednvky a aktivn smlouvy\n                          </div>\n                        </NoResults>\n                      )}\n                    </AutocompleteDropdown>\n                  )}\n                </AutocompleteWrapper>\n                <HelpText>\n                  {orderId \n                    ? 'Objednvka je pedvyplnna z kontextu' \n                    : 'Nepovinn - pokud faktura nen vzna na objednvku ani smlouvu, nechte przdn'}\n                </HelpText>\n              </FieldGroup>\n\n              {/* Platnost do / Datum vytvoen */}\n              <FieldGroup>\n                <FieldLabel>\n                  {selectedType === 'smlouva' ? 'Platnost do' : 'Datum vytvoen'}\n                </FieldLabel>\n                <div style={{ \n                  height: '48px',\n                  padding: '1px 0.875rem', \n                  display: 'flex',\n                  alignItems: 'center',\n                  background: (orderData || smlouvaData) ? '#fef3c7' : '#f9fafb', \n                  border: (orderData || smlouvaData) ? '2px solid #f59e0b' : '2px solid #e5e7eb', \n                  borderRadius: '8px',\n                  color: (orderData || smlouvaData) ? '#92400e' : '#9ca3af',\n                  fontWeight: (orderData || smlouvaData) ? '600' : '400',\n                  fontSize: '0.875rem',\n                  boxSizing: 'border-box'\n                }}>\n                  {(() => {\n                    // Pro objednvky zobrazit datum vytvoen\n                    if (orderData) {\n                      const datum = orderData.dt_objednavky || orderData.datum_objednavky || orderData.created_at || orderData.dt_vytvoreni || orderData.datum_vytvoreni;\n                      if (datum) {\n                        return formatDateOnly(datum);\n                      }\n                    }\n                    // Pro smlouvy zobrazit platnost do\n                    if (smlouvaData && smlouvaData.platnost_do) {\n                      return formatDateOnly(smlouvaData.platnost_do);\n                    }\n                    return '';\n                  })()}\n                </div>\n              </FieldGroup>\n\n              {/* Celkov cena - dynamicky podle typu entity */}\n              <FieldGroup>\n                <FieldLabel>\n                  {selectedType === 'smlouva' ? 'Celkem plnn s DPH' : 'Celkov cena'}\n                </FieldLabel>\n                <div style={{ \n                  height: '48px',\n                  padding: '1px 0.875rem', \n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'flex-end',\n                  background: (orderData || smlouvaData) ? '#f0fdf4' : '#f9fafb', \n                  border: (orderData || smlouvaData) ? '2px solid #10b981' : '2px solid #e5e7eb', \n                  borderRadius: '8px',\n                  color: (orderData || smlouvaData) ? '#065f46' : '#9ca3af',\n                  fontWeight: (orderData || smlouvaData) ? '700' : '400',\n                  fontSize: '0.875rem',\n                  boxSizing: 'border-box'\n                }}>\n                  {(() => {\n                    let amount = null;\n                    if (selectedType === 'order' && orderData?.max_cena_s_dph) {\n                      amount = orderData.max_cena_s_dph;\n                    } else if (selectedType === 'smlouva' && smlouvaData) {\n                      amount = smlouvaData.hodnota_s_dph || smlouvaData.celkova_castka;\n                    }\n                    \n                    return amount\n                      ? new Intl.NumberFormat('cs-CZ', { \n                          style: 'decimal', \n                          minimumFractionDigits: 2, \n                          maximumFractionDigits: 2 \n                        }).format(parseFloat(amount)) + ' K'\n                      : '';\n                  })()}\n                </div>\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 3x - DEK 2: Datum doruen | Datum vystaven | Datum splatnosti */}\n            <FieldRow $columns=\"1fr 1fr 1fr\">\n              <FieldGroup>\n                <FieldLabel>\n                  Datum doruen <RequiredStar>*</RequiredStar>\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_doruceni}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_doruceni: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_doruceni: date }))}\n                  placeholder=\"dd.mm.rrrr\"\n                  hasError={!!fieldErrors.fa_datum_doruceni}\n                />\n                {fieldErrors.fa_datum_doruceni && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_datum_doruceni}\n                  </FieldError>\n                )}\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel>\n                  Datum vystaven <RequiredStar>*</RequiredStar>\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_vystaveni}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_vystaveni: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_vystaveni: date }))}\n                  placeholder=\"dd.mm.rrrr\"\n                  hasError={!!fieldErrors.fa_datum_vystaveni}\n                />\n                {fieldErrors.fa_datum_vystaveni && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_datum_vystaveni}\n                  </FieldError>\n                )}\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel>\n                  Datum splatnosti <RequiredStar>*</RequiredStar>\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_splatnosti}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_splatnosti: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_splatnosti: date }))}\n                  placeholder=\"dd.mm.rrrr\"\n                  hasError={!!fieldErrors.fa_datum_splatnosti}\n                />\n                {fieldErrors.fa_datum_splatnosti && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_datum_splatnosti}\n                  </FieldError>\n                )}\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 3x - DEK 3: Typ faktury | Variabiln symbol | stka v. DPH */}\n            <FieldRow $columns=\"minmax(0, 1fr) minmax(0, 1fr) minmax(0, 1fr)\" $gap=\"1rem\">\n              <FieldGroup>\n                <FieldLabel>\n                  Typ faktury <RequiredStar>*</RequiredStar>\n                </FieldLabel>\n                <CustomSelect\n                  field=\"fa_typ\"\n                  value={formData.fa_typ}\n                  onChange={(e) => {\n                    console.log(' FA_TYP CHANGE:', e.target.value, typeof e.target.value);\n                    setFormData(prev => ({ ...prev, fa_typ: e.target.value }));\n                  }}\n                  options={[\n                    { id: 'BEZNA', nazev: 'Bn faktura' },\n                    { id: 'ZALOHOVA', nazev: 'Zlohov faktura' },\n                    { id: 'OPRAVNA', nazev: 'Opravn faktura' },\n                    { id: 'PROFORMA', nazev: 'Proforma' },\n                    { id: 'DOBROPIS', nazev: 'Dobropis' }\n                  ]}\n                  placeholder=\"-- Vyberte typ --\"\n                  required={true}\n                  selectStates={selectStates}\n                  setSelectStates={setSelectStates}\n                  searchStates={searchStates}\n                  setSearchStates={setSearchStates}\n                  touchedSelectFields={touchedSelectFields}\n                  setTouchedSelectFields={setTouchedSelectFields}\n                  toggleSelect={(field) => setSelectStates(prev => ({ ...prev, [field]: !prev[field] }))}\n                  filterOptions={(options, searchTerm) => {\n                    if (!searchTerm) return options;\n                    return options.filter(opt => \n                      opt.nazev?.toLowerCase().includes(searchTerm.toLowerCase())\n                    );\n                  }}\n                  getOptionLabel={(option) => option?.nazev || ''}\n                />\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>Variabiln symbol <RequiredStar>*</RequiredStar></span>\n                  {formData.fa_cislo_vema && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ ...prev, fa_cislo_vema: '' }))}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: '#9ca3af',\n                        cursor: 'pointer',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => e.currentTarget.style.color = '#6b7280'}\n                      onMouseLeave={(e) => e.currentTarget.style.color = '#9ca3af'}\n                      title=\"Vymazat variabiln symbol\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <Input\n                  type=\"text\"\n                  name=\"fa_cislo_vema\"\n                  value={formData.fa_cislo_vema}\n                  onChange={handleInputChange}\n                  placeholder=\"12345678\"\n                  $hasError={!!fieldErrors.fa_cislo_vema}\n                />\n                {fieldErrors.fa_cislo_vema && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_cislo_vema}\n                  </FieldError>\n                )}\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>stka v. DPH <RequiredStar>*</RequiredStar></span>\n                  {formData.fa_castka && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ ...prev, fa_castka: '' }))}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: '#9ca3af',\n                        cursor: 'pointer',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => e.currentTarget.style.color = '#6b7280'}\n                      onMouseLeave={(e) => e.currentTarget.style.color = '#9ca3af'}\n                      title=\"Vymazat stku\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <CurrencyInputWrapper>\n                  <Input\n                    type=\"text\"\n                    name=\"fa_castka\"\n                    value={formData.fa_castka}\n                    onChange={handleInputChange}\n                    placeholder=\"25 000,50\"\n                    style={{textAlign: 'right', paddingRight: '40px', width: '100%'}}\n                    $hasError={!!fieldErrors.fa_castka}\n                  />\n                  <CurrencySymbol>K</CurrencySymbol>\n                </CurrencyInputWrapper>\n                {fieldErrors.fa_castka && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_castka}\n                  </FieldError>\n                )}\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 1x - DEK 5: Stediska (cel ka) */}\n            <FieldRow $columns=\"1fr\">\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>Stediska</span>\n                  {formData.fa_strediska_kod && formData.fa_strediska_kod.length > 0 && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ ...prev, fa_strediska_kod: [] }))}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: '#9ca3af',\n                        cursor: 'pointer',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => e.currentTarget.style.color = '#6b7280'}\n                      onMouseLeave={(e) => e.currentTarget.style.color = '#9ca3af'}\n                      title=\"Vymazat stediska\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <MultiSelect\n                  values={formData.fa_strediska_kod}\n                  onChange={(e) => {\n                    // MultiSelect vrac array objekt [{kod_stavu, nazev_stavu}]\n                    // Stejn jako CustomSelect v OrderForm25\n                    setFormData(prev => ({ \n                      ...prev, \n                      fa_strediska_kod: e.target.value \n                    }));\n                  }}\n                  options={strediskaOptions}\n                  placeholder={strediskaLoading ? \"Natm stediska...\" : \"Vyberte stediska...\"}\n                  disabled={strediskaLoading}\n                />\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 1x - DEK 6: Poznmka (cel ka) */}\n            <FieldRow $columns=\"1fr\">\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>Poznmka</span>\n                  {formData.fa_poznamka && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ ...prev, fa_poznamka: '' }))}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: '#9ca3af',\n                        cursor: 'pointer',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => e.currentTarget.style.color = '#6b7280'}\n                      onMouseLeave={(e) => e.currentTarget.style.color = '#9ca3af'}\n                      title=\"Vymazat poznmku\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <Textarea\n                  name=\"fa_poznamka\"\n                  value={formData.fa_poznamka}\n                  onChange={handleInputChange}\n                  placeholder=\"Voliteln poznmka...\"\n                />\n              </FieldGroup>\n            </FieldRow>\n\n            {/*  PLOHY FAKTURY - Nov komponenta podle vzoru OrderForm25 */}\n            <InvoiceAttachmentsCompact\n              fakturaId={editingInvoiceId || 'temp-new-invoice'}\n              objednavkaId={formData.order_id || null}\n              fakturaTypyPrilohOptions={typyFakturOptions}\n              readOnly={false}\n              onISDOCParsed={handleISDOCParsed}\n              formData={formData}\n              faktura={{\n                fa_cislo_vema: formData.fa_cislo_vema,\n                fa_datum_vystaveni: formData.fa_datum_vystaveni,\n                fa_datum_splatnosti: formData.fa_datum_splatnosti,\n                fa_castka: formData.fa_castka,\n                fa_strediska_kod: formData.fa_strediska_kod\n              }}\n              validateInvoiceForAttachments={validateInvoiceForAttachments}\n              attachments={attachments}\n              onAttachmentsChange={handleAttachmentsChange}\n              onAttachmentUploaded={handleAttachmentUploaded}\n              onCreateInvoiceInDB={handleCreateInvoiceInDB}\n              onOCRDataExtracted={handleOCRDataExtracted}\n            />\n\n            {/* ODDLUJC RA */}\n            <div style={{\n              borderTop: '2px solid #e5e7eb',\n              margin: '1.5rem 0',\n              position: 'relative'\n            }}>\n              <div style={{\n                position: 'absolute',\n                top: '-12px',\n                left: '50%',\n                transform: 'translateX(-50%)',\n                background: '#f9fafb',\n                padding: '0 1rem',\n                fontSize: '0.875rem',\n                color: '#6b7280',\n                fontWeight: 600\n              }}>\n                Doplujc daje (nepovinn)\n              </div>\n            </div>\n\n            {/* GRID 2x - DEK: Datum pedn | Datum vrcen */}\n            <FieldRow $columns=\"1fr 1fr\">\n              <FieldGroup>\n                <FieldLabel>\n                  Datum pedn\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_predani_zam}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_predani_zam: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_predani_zam: date }))}\n                  placeholder=\"dd.mm.rrrr\"\n                />\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel>\n                  Datum vrcen\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_vraceni_zam}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_vraceni_zam: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_vraceni_zam: date }))}\n                  placeholder=\"dd.mm.rrrr\"\n                />\n                {formData.fa_datum_predani_zam && formData.fa_datum_vraceni_zam && \n                 new Date(formData.fa_datum_vraceni_zam) < new Date(formData.fa_datum_predani_zam) && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    Datum vrcen neme bt dvj ne datum pedn\n                  </FieldError>\n                )}\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 1x - DEK: Pedno zamstnanci (cel ka) */}\n            <FieldRow $columns=\"1fr\">\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>Pedno zamstnanci</span>\n                  {formData.fa_predana_zam_id && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ \n                        ...prev, \n                        fa_predana_zam_id: null,\n                        fa_datum_predani_zam: '',\n                        fa_datum_vraceni_zam: ''\n                      }))}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: '#9ca3af',\n                        cursor: 'pointer',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => e.currentTarget.style.color = '#6b7280'}\n                      onMouseLeave={(e) => e.currentTarget.style.color = '#9ca3af'}\n                      title=\"Vymazat zamstnance (vetn datum pedn/vrcen)\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <CustomSelect\n                  value={formData.fa_predana_zam_id}\n                  onChange={(e) => setFormData(prev => ({ \n                    ...prev, \n                    fa_predana_zam_id: e.target.value ? parseInt(e.target.value) : null \n                  }))}\n                  options={zamestnanci}\n                  placeholder={zamestnanciLoading ? \"Natm zamstnance...\" : \"-- Nevybrno --\"}\n                  disabled={zamestnanciLoading}\n                  field=\"fa_predana_zam_id\"\n                  selectStates={selectStates}\n                  setSelectStates={setSelectStates}\n                  searchStates={searchStates}\n                  setSearchStates={setSearchStates}\n                  touchedSelectFields={touchedSelectFields}\n                  setTouchedSelectFields={setTouchedSelectFields}\n                  toggleSelect={(field) => setSelectStates(prev => ({ ...prev, [field]: !prev[field] }))}\n                  filterOptions={(options, searchTerm) => {\n                    if (!searchTerm) return options;\n                    return options.filter(opt => {\n                      const fullName = `${opt.prijmeni || ''} ${opt.jmeno || ''} ${opt.titul_za || ''}`.toLowerCase();\n                      return fullName.includes(searchTerm.toLowerCase());\n                    });\n                  }}\n                  getOptionLabel={(option) => {\n                    if (!option) return '';\n                    return `${option.prijmeni || ''} ${option.jmeno || ''} ${option.titul_za ? `, ${option.titul_za}` : ''}`.trim();\n                  }}\n                  allowEmpty={true}\n                />\n                {zamestnanciLoading && (\n                  <div style={{ fontSize: '0.85rem', color: '#6b7280', marginTop: '0.5rem' }}>\n                    <FontAwesomeIcon icon={faSpinner} spin /> Natm zamstnance...\n                  </div>\n                )}\n              </FieldGroup>\n            </FieldRow>\n          </FakturaCard>\n\n          {/* VAROVN: EDITACE faktury vzan na objednvku - nutnost vcn kontroly (pouze pokud je operace mon) */}\n          {editingInvoiceId && formData.order_id && orderData && canAddInvoiceToOrder(orderData).allowed && (\n            <div style={{\n              background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',\n              border: '3px solid #f59e0b',\n              borderRadius: '12px',\n              padding: '1.25rem',\n              marginBottom: '1.5rem',\n              boxShadow: '0 4px 12px rgba(245, 158, 11, 0.25)'\n            }}>\n              <div style={{ display: 'flex', alignItems: 'flex-start', gap: '1rem', marginBottom: '1rem' }}>\n                <div style={{\n                  background: '#f59e0b',\n                  color: 'white',\n                  borderRadius: '50%',\n                  width: '48px',\n                  height: '48px',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  fontSize: '1.5rem',\n                  flexShrink: 0\n                }}>\n                  <FontAwesomeIcon icon={faExclamationTriangle} />\n                </div>\n                <div style={{ flex: 1 }}>\n                  <div style={{ fontWeight: 700, color: '#92400e', fontSize: '1.1rem', marginBottom: '0.5rem' }}>\n                     DLEIT: Aktualizace faktury vzan na objednvku\n                  </div>\n                  <div style={{ fontSize: '0.95rem', color: '#78350f', lineHeight: '1.6' }}>\n                    Editace faktury vzan na objednvku <strong>{orderData.cislo_objednavky || orderData.evidencni_cislo}</strong> zpsob, \n                    e objednvka bude muset znovu projt <strong>vcnou sprvnost</strong> a kontrolou.\n                  </div>\n                </div>\n              </div>\n              <div style={{\n                background: 'rgba(255, 255, 255, 0.5)',\n                borderRadius: '6px',\n                padding: '0.75rem',\n                fontSize: '0.9rem',\n                color: '#78350f'\n              }}>\n                <strong>Co se stane po uloen:</strong>\n                <ul style={{ margin: '0.5rem 0 0 1.5rem', paddingLeft: 0 }}>\n                  <li>Objednvka bude vrcena do stavu <strong>\"Vcn sprvnost\"</strong></li>\n                  <li>Objednatel, garant a schvalovatel obdr notifikaci</li>\n                  <li>Bude nutn provst novou kontrolu a schvlen</li>\n                </ul>\n              </div>\n            </div>\n          )}\n          \n          {/* VAROVN: Nelze pidat/upravit fakturu k objednvce v nevhodnm stavu */}\n          {formData.order_id && orderData && !canAddInvoiceToOrder(orderData).allowed && (\n            <div style={{\n              background: editingInvoiceId ? '#fee2e2' : '#fef3c7',\n              border: editingInvoiceId ? '3px solid #dc2626' : '2px solid #f59e0b',\n              borderRadius: '8px',\n              padding: '1rem',\n              marginBottom: '1rem',\n              display: 'flex',\n              alignItems: 'flex-start',\n              gap: '0.75rem'\n            }}>\n              <FontAwesomeIcon \n                icon={faExclamationTriangle} \n                style={{ \n                  color: editingInvoiceId ? '#dc2626' : '#f59e0b', \n                  marginTop: '0.25rem', \n                  fontSize: '1.25rem' \n                }} \n              />\n              <div style={{ flex: 1 }}>\n                <div style={{ \n                  fontWeight: 600, \n                  color: editingInvoiceId ? '#991b1b' : '#92400e', \n                  marginBottom: '0.25rem' \n                }}>\n                   {editingInvoiceId ? 'Nelze aktualizovat fakturu u tto objednvky' : 'Nelze pidat fakturu k tto objednvce'}\n                </div>\n                <div style={{ fontSize: '0.9rem', color: editingInvoiceId ? '#991b1b' : '#78350f' }}>\n                  {canAddInvoiceToOrder(orderData).reason}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* VAROVN: Zmna kritickch pol vyaduje nov schvlen */}\n          {editingInvoiceId && hasChangedCriticalField && (\n            <div style={{\n              background: 'linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)',\n              border: '2px solid #fb923c',\n              borderRadius: '8px',\n              padding: '1rem',\n              marginBottom: '1rem',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '0.75rem'\n            }}>\n              <FontAwesomeIcon icon={faExclamationTriangle} style={{ color: '#ea580c', fontSize: '1.25rem' }} />\n              <div style={{ flex: 1, fontSize: '0.9rem', color: '#9a3412' }}>\n                <strong>Pozor:</strong> Zmnili jste kritick pole faktury (stka, slo, stedisko, typ nebo datum). \n                Po uloen bude nutn <strong>znovu schvlit vcnou sprvnost</strong>.\n              </div>\n            </div>\n          )}\n\n          {/* TLATKA */}\n          <ButtonGroup>\n            <Button $variant=\"secondary\" onClick={handleBack} disabled={loading}>\n              <FontAwesomeIcon icon={faTimes} />\n              Zruit\n            </Button>\n            <Button \n              $variant=\"primary\" \n              onClick={handleSubmit} \n              disabled={loading || (formData.order_id && orderData && !canAddInvoiceToOrder(orderData).allowed)}\n              title={\n                formData.order_id && orderData && !canAddInvoiceToOrder(orderData).allowed\n                  ? canAddInvoiceToOrder(orderData).reason\n                  : ''\n              }\n            >\n              <FontAwesomeIcon icon={loading ? faExclamationTriangle : faSave} />\n              {loading ? 'Ukldm...' : (\n                editingInvoiceId \n                  ? 'Aktualizovat fakturu' \n                  : (formData.order_id && orderData \n                      ? 'Pipojit fakturu' \n                      : 'Zaevidovat fakturu')\n              )}\n            </Button>\n          </ButtonGroup>\n          </FormColumnContent>\n        </FormColumn>\n\n        {/* PRAV STRANA - NHLED OBJEDNVKY / SMLOUVY (40%) */}\n        <PreviewColumn>\n          <PreviewColumnHeader>\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', flex: 1 }}>\n              {/* Prvn dek: Nhled + EV.. - dynamick podle typu */}\n              <div style={{ \n                display: 'flex', \n                alignItems: 'center', \n                justifyContent: 'space-between', \n                gap: '1rem', \n                paddingBottom: '12px',\n                borderBottom: selectedType === 'smlouva' ? '2px solid #10b981' : '2px solid #3498db',\n                marginBottom: '1rem'\n              }}>\n                <SectionTitle style={{ margin: 0, border: 'none', paddingBottom: 0, whiteSpace: 'nowrap' }}>\n                  <FontAwesomeIcon icon={selectedType === 'smlouva' ? faFileContract : faBuilding} />\n                  {selectedType === 'smlouva' ? 'Nhled smlouvy' : 'Nhled objednvky'}\n                </SectionTitle>\n                {orderData && selectedType === 'order' && (\n                  <span style={{ fontWeight: 700, color: '#1e40af', fontSize: '1.05rem', whiteSpace: 'nowrap' }}>\n                    {orderData.cislo_objednavky || `#${orderData.id}`}\n                  </span>\n                )}\n                {smlouvaData && selectedType === 'smlouva' && (\n                  <span style={{ fontWeight: 700, color: '#059669', fontSize: '1.05rem', whiteSpace: 'nowrap' }}>\n                    {smlouvaData.cislo_smlouvy || `#${smlouvaData.id}`}\n                  </span>\n                )}\n              </div>\n\n              {/* Druh dek: Souty + STAV */}\n              {orderData && (\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', gap: '0.75rem', flexWrap: 'wrap' }}>\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n                    {/* STAV */}\n                    <div style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '6px',\n                      padding: '0.4rem 0.75rem',\n                      background: 'linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)',\n                      border: '2px solid #10b981',\n                      borderRadius: '6px',\n                      fontSize: '0.7rem',\n                      fontWeight: 600,\n                      color: '#065f46',\n                      boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\n                      whiteSpace: 'nowrap'\n                    }}>\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n                        <div style={{ fontSize: '0.6rem', opacity: 0.8, fontWeight: 500 }}>\n                          STAV\n                        </div>\n                        <div style={{ fontSize: '0.85rem', fontWeight: 700 }}>\n                          {orderData.stav_objednavky || getCurrentWorkflowState(orderData)?.replace(/_/g, ' ') || 'N/A'}\n                        </div>\n                      </div>\n                    </div>\n                    {/* MAX CENA S DPH */}\n                    <div style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '6px',\n                      padding: '0.4rem 0.75rem',\n                      background: 'linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%)',\n                      border: '2px solid #64748b',\n                      borderRadius: '6px',\n                      fontSize: '0.7rem',\n                      fontWeight: 600,\n                      color: '#1e293b',\n                      boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\n                      whiteSpace: 'nowrap'\n                    }}>\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n                        <div style={{ fontSize: '0.6rem', opacity: 0.8, fontWeight: 500 }}>\n                          MAX CENA S DPH\n                        </div>\n                        <div style={{ fontSize: '0.85rem', fontWeight: 700 }}>\n                          {parseFloat(orderData.max_cena_s_dph || 0).toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Souet poloek objednvky */}\n                    <div \n                      onClick={() => {\n                        const section = document.querySelector('[data-section=\"polozky\"]');\n                        if (section) {\n                          section.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                        }\n                      }}\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px',\n                        padding: '0.4rem 0.75rem',\n                        background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',\n                        border: '2px solid #fbbf24',\n                        borderRadius: '6px',\n                        fontSize: '0.7rem',\n                        fontWeight: 600,\n                        color: '#92400e',\n                        boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\n                        whiteSpace: 'nowrap',\n                        cursor: 'pointer',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'scale(1.05)';\n                        e.currentTarget.style.boxShadow = '0 4px 8px rgba(251, 191, 36, 0.3)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'scale(1)';\n                        e.currentTarget.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.05)';\n                      }}\n                    >\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n                        <div style={{ fontSize: '0.6rem', opacity: 0.8, fontWeight: 500 }}>\n                          POLOKY (DPH)\n                        </div>\n                        <div style={{ fontSize: '0.85rem', fontWeight: 700 }}>\n                          {parseFloat(orderData.polozky_celkova_cena_s_dph || 0).toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Souet faktur */}\n                    <div \n                      onClick={() => {\n                        const section = document.querySelector('[data-section=\"faktury\"]');\n                        if (section) {\n                          section.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                        }\n                      }}\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px',\n                        padding: '0.4rem 0.75rem',\n                        background: 'linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)',\n                        border: '2px solid #3b82f6',\n                        borderRadius: '6px',\n                        fontSize: '0.7rem',\n                        fontWeight: 600,\n                        color: '#1e40af',\n                        boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\n                        whiteSpace: 'nowrap',\n                        cursor: 'pointer',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'scale(1.05)';\n                        e.currentTarget.style.boxShadow = '0 4px 8px rgba(59, 130, 246, 0.3)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'scale(1)';\n                        e.currentTarget.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.05)';\n                      }}\n                    >\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n                        <div style={{ fontSize: '0.6rem', opacity: 0.8, fontWeight: 500 }}>\n                          FAKTURY\n                        </div>\n                        <div style={{ fontSize: '0.85rem', fontWeight: 700 }}>\n                          {(() => {\n                            const total = orderData.faktury?.reduce((sum, faktura) => {\n                              const castka = parseFloat(faktura.fa_castka || 0);\n                              return sum + castka;\n                            }, 0) || 0;\n                            return total.toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' K';\n                          })()}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <ToggleButton\n                    onClick={() => {\n                      if (hasAnySectionCollapsed) {\n                        orderFormRef.current?.expandAll();\n                      } else {\n                        orderFormRef.current?.collapseAll();\n                      }\n                    }}\n                  >\n                    <FontAwesomeIcon icon={hasAnySectionCollapsed ? faChevronDown : faChevronUp} />\n                    {hasAnySectionCollapsed ? 'Rozbalit ve' : 'Sbalit ve'}\n                  </ToggleButton>\n                </div>\n              )}\n            </div>\n          </PreviewColumnHeader>\n\n          <PreviewColumnContent>\n          {orderLoading && (\n            <LoadingOverlay>\n              <LoadingSpinner />\n              <div>Natm {selectedType === 'smlouva' ? 'smlouvu' : 'objednvku'}...</div>\n            </LoadingOverlay>\n          )}\n\n          {!orderLoading && !orderData && !smlouvaData && formData.order_id && (\n            <ErrorAlert>\n              <FontAwesomeIcon icon={faExclamationTriangle} />\n              Nepodailo se nast objednvku ID {formData.order_id}\n            </ErrorAlert>\n          )}\n\n          {!orderLoading && !orderData && !smlouvaData && !formData.order_id && (\n            <div style={{ color: '#94a3af', textAlign: 'center', padding: '3rem' }}>\n              <FontAwesomeIcon icon={selectedType === 'smlouva' ? faFileContract : faBuilding} size=\"3x\" style={{ marginBottom: '1rem', opacity: 0.3 }} />\n              <div style={{ fontSize: '1.1rem', marginBottom: '0.5rem' }}>\n                {selectedType === 'smlouva' ? 'dn smlouva nevybrna' : 'dn objednvka nevybrna'}\n              </div>\n              <div style={{ fontSize: '0.9rem' }}>\n                Zante pst do pole \"Vyberte objednvku nebo smlouvu\"\n              </div>\n            </div>\n          )}\n\n          {/* NHLED OBJEDNVKY */}\n          {!orderLoading && orderData && selectedType === 'order' && (\n            <OrderFormReadOnly \n              ref={orderFormRef} \n              orderData={orderData}\n              onCollapseChange={setHasAnySectionCollapsed}\n              onEditInvoice={handleEditInvoice}\n              canEditInvoice={canAddInvoiceToOrder(orderData).allowed}\n              token={token}\n              username={username}\n            />\n          )}\n\n          {/* NHLED SMLOUVY */}\n          {!orderLoading && smlouvaData && selectedType === 'smlouva' && (\n            <SmlouvaPreview smlouvaData={smlouvaData} />\n          )}\n\n          {false && orderData && (\n            <OrderPreviewCard>\n              <OrderHeaderRow>\n                <OrderNumber>\n                  {orderData.evidencni_cislo || `Obj. #${orderData.id}`}\n                </OrderNumber>\n                <OrderBadge $color={orderData.stav_workflow_kod === 'ODESLANA' ? '#10b981' : '#3b82f6'}>\n                  {orderData.stav_workflow_nazev || 'Nezn. stav'}\n                </OrderBadge>\n              </OrderHeaderRow>\n\n              <OrderDetailRow>\n                <OrderDetailLabel>Pedmt:</OrderDetailLabel>\n                <OrderDetailValue style={{ fontWeight: 500 }}>\n                  {orderData.predmet || 'N/A'}\n                </OrderDetailValue>\n              </OrderDetailRow>\n\n              <OrderDetailRow>\n                <OrderDetailLabel>\n                  <FontAwesomeIcon icon={faMoneyBillWave} /> Max. cena s DPH:\n                </OrderDetailLabel>\n                <OrderDetailValue style={{ fontWeight: 600, color: '#1e40af' }}>\n                  {orderData.max_cena_s_dph \n                    ? `${Number(orderData.max_cena_s_dph).toLocaleString('cs-CZ')} K` \n                    : 'N/A'}\n                </OrderDetailValue>\n              </OrderDetailRow>\n\n              <OrderDetailRow>\n                <OrderDetailLabel>\n                  <FontAwesomeIcon icon={faBuilding} /> Pkazce:\n                </OrderDetailLabel>\n                <OrderDetailValue>\n                  {orderData._enriched?.prikazce?.display_name || orderData.prikazce_id || 'N/A'}\n                </OrderDetailValue>\n              </OrderDetailRow>\n\n              {orderData._enriched?.dodavatel?.ico && (\n                <OrderDetailRow>\n                  <OrderDetailLabel>IO dodavatele:</OrderDetailLabel>\n                  <OrderDetailValue>\n                    {orderData._enriched.dodavatel.ico}\n                  </OrderDetailValue>\n                </OrderDetailRow>\n              )}\n\n              {orderData.dodavatel_nazev && (\n                <OrderDetailRow>\n                  <OrderDetailLabel>Dodavatel:</OrderDetailLabel>\n                  <OrderDetailValue>\n                    {orderData.dodavatel_nazev}\n                  </OrderDetailValue>\n                </OrderDetailRow>\n              )}\n\n              <OrderDetailRow>\n                <OrderDetailLabel>\n                  <FontAwesomeIcon icon={faCalendar} /> Datum vytvoen:\n                </OrderDetailLabel>\n                <OrderDetailValue>\n                  {(() => {\n                    const datum = orderData.dt_objednavky || orderData.datum_objednavky || orderData.created_at || orderData.dt_vytvoreni || orderData.datum_vytvoreni;\n                    return datum ? formatDateOnly(datum) : 'N/A';\n                  })()}\n                </OrderDetailValue>\n              </OrderDetailRow>\n\n              {orderData.garant_cele_jmeno && (\n                <OrderDetailRow>\n                  <OrderDetailLabel>Garant:</OrderDetailLabel>\n                  <OrderDetailValue>\n                    {orderData.garant_cele_jmeno}\n                  </OrderDetailValue>\n                </OrderDetailRow>\n              )}\n\n              {orderData.cislo_smlouvy && (\n                <OrderDetailRow>\n                  <OrderDetailLabel>slo smlouvy:</OrderDetailLabel>\n                  <OrderDetailValue>\n                    {orderData.cislo_smlouvy}\n                  </OrderDetailValue>\n                </OrderDetailRow>\n              )}\n            </OrderPreviewCard>\n          )}\n          </PreviewColumnContent>\n        </PreviewColumn>\n      </ContentLayout>\n    </>\n  );\n\n  // Render: normln reim vs fullscreen reim (portal)\n  return (\n    <>\n      {isFullscreen ? (\n        createPortal(\n          <FullscreenOverlay>\n            {PageContent}\n          </FullscreenOverlay>,\n          document.body\n        )\n      ) : (\n        <PageContainer>\n          {PageContent}\n        </PageContainer>\n      )}\n\n      {/*  Custom Confirm Dialog - VDY v portlu nad vm */}\n      {confirmDialog.isOpen && createPortal(\n        <ConfirmDialog\n          isOpen={confirmDialog.isOpen}\n          title={confirmDialog.title}\n          message={confirmDialog.message}\n          confirmText={confirmDialog.onCancel ? \"Ano, pokraovat\" : \"OK\"}\n          cancelText=\"Zruit\"\n          showCancel={!!confirmDialog.onCancel}\n          variant=\"warning\"\n          icon={faExclamationTriangle}\n          onConfirm={() => {\n            if (confirmDialog.onConfirm) {\n              confirmDialog.onConfirm();\n            }\n          }}\n          onClose={confirmDialog.onCancel ? () => {\n            if (confirmDialog.onCancel) {\n              confirmDialog.onCancel();\n            }\n          } : () => {}}\n        />,\n        document.body\n      )}\n\n      {/*  Spisovka Inbox Panel - pouze pro ADMIN */}\n      {hasPermission('ADMIN') && spisovkaInboxOpen && (\n        <SpisovkaInboxPanel\n          panelState={spisovkaInboxState}\n          setPanelState={setSpisovkaInboxState}\n          beginDrag={handleSpisovkaInboxDrag}\n          onClose={() => setSpisovkaInboxOpen(false)}\n          onOCRDataExtracted={handleOCRDataExtracted}\n        />\n      )}\n    </>\n  );\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm21 21-4.34-4.34', key: '14j7rj' }],\n  ['circle', { cx: '11', cy: '11', r: '8', key: '4ej97u' }],\n];\n\n/**\n * @component @name Search\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjEgMjEtNC4zNC00LjM0IiAvPgogIDxjaXJjbGUgY3g9IjExIiBjeT0iMTEiIHI9IjgiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/search\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Search = createLucideIcon('search', __iconNode);\n\nexport default Search;\n","/**\n * API sluby pro smlouvy\n * \n * Endpointy:\n * - POST /ciselniky/smlouvy/list - seznam smluv s filtry\n * - POST /ciselniky/smlouvy/detail - detail smlouvy + objednvky + statistiky\n * - POST /ciselniky/smlouvy/insert - vytvoen smlouvy\n * - POST /ciselniky/smlouvy/update - aktualizace smlouvy\n * - POST /ciselniky/smlouvy/delete - smazn smlouvy\n * - POST /ciselniky/smlouvy/bulk-import - hromadn import z Excel/CSV\n * - POST /ciselniky/smlouvy/prepocet-cerpani - pepoet erpn\n * \n * @author Frontend Team\n * @date 2025-11-23\n */\n\nimport axios from 'axios';\n\nconst API_BASE_URL = process.env.REACT_APP_API2_BASE_URL || 'https://erdms.zachranka.cz/api.eeo/';\n\nconst api = axios.create({\n  baseURL: `${API_BASE_URL}`,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// =============================================================================\n// ERROR HANDLING\n// =============================================================================\n\nconst handleApiError = (error, defaultMessage = 'Chyba serveru') => {\n  if (error.response) {\n    const { status, data } = error.response;\n    const errorMessage = data?.err || data?.error || data?.message || defaultMessage;\n\n    switch (status) {\n      case 401:\n        throw new Error('Neplatn token. Pihlaste se znovu.');\n      case 403:\n        throw new Error('Nemte oprvnn k tto akci.');\n      case 404:\n        throw new Error('Zznam nebyl nalezen.');\n      case 400:\n        throw new Error(errorMessage);\n      case 409:\n        throw new Error(errorMessage); // Duplicita\n      default:\n        throw new Error(errorMessage);\n    }\n  } else if (error.request) {\n    throw new Error('Server neodpovd. Zkontrolujte pipojen.');\n  } else {\n    throw new Error(error.message || defaultMessage);\n  }\n};\n\nconst checkResponse = (response, operation = 'operace') => {\n  if (response.data?.err) {\n    throw new Error(response.data.err);\n  }\n  if (response.data?.status === 'error') {\n    throw new Error(response.data.message || `${operation} se nezdaila`);\n  }\n  if (response.data?.status !== 'ok') {\n    throw new Error(`${operation} se nezdaila - neplatn status`);\n  }\n  return response.data;\n};\n\n// =============================================================================\n// API FUNKCE\n// =============================================================================\n\n/**\n * Nate seznam smluv s filtry\n */\nexport async function getSmlouvyList({\n  token,\n  username,\n  show_inactive = false,\n  usek_id = null,\n  druh_smlouvy = null,\n  stav = null,\n  search = null,\n  platnost_od = null,\n  platnost_do = null,\n  limit = 1000,\n  offset = 0\n}) {\n  try {\n    const payload = {\n      username,\n      token,\n      show_inactive,\n      usek_id,\n      druh_smlouvy,\n      stav,\n      search,\n      platnost_od,\n      platnost_do,\n      limit,\n      offset\n    };\n\n    const response = await api.post('ciselniky/smlouvy/list', payload);\n\n    return checkResponse(response, 'Natn smluv');\n  } catch (error) {\n    handleApiError(error, 'Chyba pi natn smluv');\n    throw error;\n  }\n}\n\n/**\n * Nate detail smlouvy vetn objednvek a statistik\n */\nexport async function getSmlouvaDetail({ token, username, id }) {\n  try {\n    const response = await api.post('ciselniky/smlouvy/detail', {\n      username,\n      token,\n      id\n    });\n\n    const data = checkResponse(response, 'Natn detailu smlouvy');\n    return data.data || null;\n  } catch (error) {\n    handleApiError(error, 'Chyba pi natn detailu smlouvy');\n    throw error;\n  }\n}\n\n/**\n * Vytvo novou smlouvu\n */\nexport async function createSmlouva({ token, username, smlouvaData }) {\n  try {\n    const response = await api.post('ciselniky/smlouvy/insert', {\n      username,\n      token,\n      ...smlouvaData\n    });\n\n    const data = checkResponse(response, 'Vytven smlouvy');\n    return data.data;\n  } catch (error) {\n    handleApiError(error, 'Chyba pi vytven smlouvy');\n    throw error;\n  }\n}\n\n/**\n * Aktualizuje existujc smlouvu\n */\nexport async function updateSmlouva({ token, username, id, smlouvaData }) {\n  try {\n    const response = await api.post('ciselniky/smlouvy/update', {\n      username,\n      token,\n      id,\n      ...smlouvaData\n    });\n\n    const data = checkResponse(response, 'Aktualizace smlouvy');\n    return data.data;\n  } catch (error) {\n    handleApiError(error, 'Chyba pi aktualizaci smlouvy');\n    throw error;\n  }\n}\n\n/**\n * Smae smlouvu\n */\nexport async function deleteSmlouva({ token, username, id }) {\n  try {\n    const response = await api.post('ciselniky/smlouvy/delete', {\n      username,\n      token,\n      id\n    });\n\n    const data = checkResponse(response, 'Mazn smlouvy');\n    return data.data;\n  } catch (error) {\n    handleApiError(error, 'Chyba pi mazn smlouvy');\n    throw error;\n  }\n}\n\n/**\n * Hromadn import smluv z Excel/CSV\n */\nexport async function bulkImportSmlouvy({\n  token,\n  username,\n  data,\n  overwrite_existing = false,\n  nazev_souboru = null,\n  typ_souboru = null,\n  velikost_souboru = null\n}) {\n  try {\n    const response = await api.post('ciselniky/smlouvy/bulk-import', {\n      username,\n      token,\n      data,\n      overwrite_existing,\n      nazev_souboru,\n      typ_souboru,\n      velikost_souboru\n    });\n\n    const result = checkResponse(response, 'Import smluv');\n    return result.data;\n  } catch (error) {\n    handleApiError(error, 'Chyba pi importu smluv');\n    throw error;\n  }\n}\n\n/**\n * Pepot erpn smluv\n */\nexport async function prepocetCerpaniSmluv({\n  token,\n  username,\n  cislo_smlouvy = null,\n  usek_id = null\n}) {\n  try {\n    const response = await api.post('ciselniky/smlouvy/prepocet-cerpani', {\n      username,\n      token,\n      cislo_smlouvy,\n      usek_id\n    });\n\n    const data = checkResponse(response, 'Pepoet erpn');\n    return data.data;\n  } catch (error) {\n    handleApiError(error, 'Chyba pi pepotu erpn');\n    throw error;\n  }\n}\n\n// =============================================================================\n// KONSTANTY PRO FRONTEND\n// =============================================================================\n\nexport const DRUH_SMLOUVY_OPTIONS = [\n  { value: 'SLUBY', label: 'Smlouva o poskytovn slueb' },\n  { value: 'KUPN', label: 'Kupn smlouva' },\n  { value: 'RMCOV', label: 'Rmcov smlouva' }\n];\n\n// Stavy smluv - BE vrac ENUM bez diakritiky (AKTIVNI, UKONCENA, PRERUSENA, PRIPRAVOVANA, NEAKTIVNI)\n// \n// NEAKTIVNI = soft delete, smlouva existuje v DB ale nen aktivn (aktivni = 0)\n// PRIPRAVOVANA = smlouva vytvoen, ale platnost jet nezaala (dnes < platnost_od)\n// AKTIVNI = platn smlouva v aktulnm obdob (platnost_od <= dnes <= platnost_do)\n// UKONCENA = smlouva vyprela (dnes > platnost_do)\n// PRERUSENA = smlouva doasn peruena (manuln nastaven)\nexport const STAV_SMLOUVY_OPTIONS = [\n  { value: 'AKTIVNI', label: 'Platn', color: '#10b981', icon: '', popis: 'Smlouva je v platnosti a lze ji pouvat' },\n  { value: 'UKONCENA', label: 'Vyprela', color: '#dc2626', icon: '', popis: 'Smlouva pekroila datum konce platnosti' },\n  { value: 'PRERUSENA', label: 'Peruena', color: '#f59e0b', icon: '', popis: 'Smlouva je doasn pozastavena' },\n  { value: 'PRIPRAVOVANA', label: 'Pipraven', color: '#f97316', icon: '', popis: 'Smlouva ek na zatek platnosti' },\n  { value: 'NEAKTIVNI', label: 'Neaktivn', color: '#6b7280', icon: '', popis: 'Smlouva je deaktivovna (soft delete)' }\n];\n\n// Helper funkce pro prci se stavy smluv\nexport const getStavSmlouvyConfig = (stav) => {\n  return STAV_SMLOUVY_OPTIONS.find(opt => opt.value === stav) || {\n    value: stav,\n    label: stav,\n    color: '#6b7280',\n    icon: ''\n  };\n};\n\nexport const getStavSmlouvyLabel = (stav) => {\n  return getStavSmlouvyConfig(stav).label;\n};\n\nexport const getStavSmlouvyColor = (stav) => {\n  return getStavSmlouvyConfig(stav).color;\n};\n\nexport const SAZBA_DPH_OPTIONS = [\n  { value: 0, label: '0% (osvobozeno)' },\n  { value: 12, label: '12% (snen)' },\n  { value: 21, label: '21% (zkladn)' }\n];\n"],"names":["FormContainer","styled","div","_templateObject","_taggedTemplateLiteral","Section","_templateObject2","SectionHeader","_templateObject3","props","$theme","concat","$isActive","SectionTitle","h3","_templateObject4","CollapseIcon","_templateObject5","$collapsed","SectionContent","_templateObject6","FieldRow","_templateObject7","$columns","FieldGroup","_templateObject8","FieldLabel","_templateObject9","FieldValue","_templateObject0","Badge","span","_templateObject1","$bg","$color","InfoCard","_templateObject10","CardTitle","_templateObject11","DataGrid","_templateObject12","KeyValuePair","_templateObject13","KeyLabel","_templateObject14","ValueText","_templateObject15","EditInvoiceButton","_templateObject16","button","_templateObject17","_templateObject18","OrderFormReadOnly","forwardRef","_ref","ref","_orderData$_enriched8","_orderData$_enriched9","_orderData$_enriched0","_orderData$_enriched1","_orderData$_enriched11","_orderData$_enriched12","_orderData$_enriched13","_orderData$_enriched14","_orderData$_enriched16","_orderData$_enriched17","_orderData$_enriched18","_orderData$_enriched19","_orderData$financovan","_orderData$financovan2","_orderData$financovan3","_orderData$_enriched21","_orderData$_enriched22","orderData","onCollapseChange","onEditInvoice","canEditInvoice","token","username","collapsed","setCollapsed","useState","objednatel","schvaleni","dodavatel","detaily","dodani","fakturace","poznamky","registr","vecna_spravnost","dokonceni","prilohy","toggleSection","section","prev","newCollapsed","_objectSpread","hasAnyCollapsed","Object","values","some","val","collapseAll","allCollapsed","keys","forEach","key","expandAll","allExpanded","areAllCollapsed","every","areAllExpanded","useImperativeHandle","_jsxs","style","padding","textAlign","color","children","_jsx","FontAwesomeIcon","icon","faFileAlt","size","marginBottom","opacity","formatCurrency","value","parseFloat","toLocaleString","onClick","faUser","faChevronUp","className","_orderData$_enriched","_orderData$_enriched2","_orderData$uzivatel","enriched","_enriched","uzivatel","titul_pred","titul_za","jmeno","prijmeni","cele_jmeno","_orderData$_enriched3","_orderData$_enriched4","_orderData$uzivatel2","telefon","objednatel_telefon","marginTop","_orderData$_enriched5","_orderData$_enriched6","_orderData$uzivatel3","email","faCheckCircle","_orderData$_enriched7","_orderData$garant_uzi","garant_uzivatel","faClipboardCheck","predmet","cislo_objednavky","id","dt_objednavky","formatDateOnly","max_cena_s_dph","_orderData$_enriched10","_orderData$prikazce","prikazce","_orderData$_enriched15","_orderData$schvalovat","schvalovatel","faBuilding","_orderData$_enriched20","strediska","Array","isArray","map","s","nazev","kod","join","strediska_kod","faCoins","financovani","typ_nazev","typ","lp_nazvy","length","gridColumn","display","flexWrap","gap","lp","idx","lpText","cislo_lp","popis","nazev_uctu","label","String","_orderData$financovan4","_orderData$financovan5","_typKod$toUpperCase","typKod","typ_kod","zpusob_financovani","_orderData$financovan6","_orderData$financovan7","toUpperCase","call","_Fragment","cislo_smlouvy","smlouva_poznamka","_orderData$financovan8","_orderData$financovan9","_typKod$toUpperCase2","_typKod$includes","_orderData$financovan0","_orderData$financovan1","includes","individualni_schvaleni","individualni_poznamka","_orderData$financovan10","_orderData$financovan11","_typKod$toUpperCase3","_typKod$includes2","_orderData$financovan12","_orderData$financovan13","pojistna_udalost_cislo","pojistna_udalost_poznamka","alignItems","getWorkflowBadges","stav_workflow_kod","badgeColors","bg","index","colors","React","replace","margin","fontWeight","dodavatel_nazev","dodavatel_ico","dodavatel_dic","dodavatel_adresa","dodavatel_kontakt_jmeno","dodavatel_kontakt_email","dodavatel_kontakt_telefon","polozky","faBox","polozky_count","druh_objednavky","druh_objednavky_nazev","polozka","background","border","borderRadius","fontSize","lp_id","_orderData$financovan14","_orderData$financovan15","lpData","find","lp_je_platne","cena_bez_dph","sazba_dph","cena_s_dph","usek_kod","budova_kod","mistnost_kod","poznamka","paddingTop","borderTop","justifyContent","polozky_celkova_cena_s_dph","poznamka_objednavky","faTruck","misto_dodani","dt_predpokladany_termin_dodani","zaruka","dt_akceptace","_orderData$_enriched23","dodavatel_potvrdil","dodavatel_potvrdil_jmeno","jeZverejnit","zverejnit","faTimesCircle","fontStyle","dt_zverejneni","_orderData$_enriched24","zverejnil","zverejnil_jmeno","registr_iddt","faktury","faMoneyBillWave","faktura","isVecnaPotvrzena","vecna_spravnost_potvrzeno","boxShadow","overflow","borderBottom","letterSpacing","textTransform","fa_cislo_vema","e","stopPropagation","onMouseEnter","currentTarget","onMouseLeave","faEdit","fa_castka","fa_datum_vystaveni","fa_datum_splatnosti","fa_splatnost","fa_datum_doruceni","fa_typ","typColors","fa_strediska_kod","filter","Boolean","fa_poznamka","_isdoc_dodavatel","ico","faPaperclip","flexDirection","priloha","async","blob","downloadInvoiceAttachment","url","window","URL","createObjectURL","a","document","createElement","href","download","originalni_nazev_souboru","body","appendChild","click","revokeObjectURL","removeChild","error","console","alert","message","cursor","transition","borderColor","title","faFile","flex","minWidth","textOverflow","whiteSpace","bytes","i","Math","floor","log","round","pow","formatFileSize","velikost_souboru_b","typeMap","config","getTypeBadge","typ_prilohy","faDownload","marginLeft","dt_potvrzeni_vecne_spravnosti","_faktura$_enriched","potvrdil_vecnou_spravnost_jmeno","potvrdil_vecnou_spravnost_titul_pred","potvrdil_vecnou_spravnost_titul_za","fullName","potvrdil_vecnou_spravnost_prijmeni","trim","potvrdil_vecnou_spravnost","vecna_spravnost_umisteni_majetku","vecna_spravnost_poznamka","wordBreak","faCheck","dt_schvaleni","paddingBottom","lineHeight","_orderData$_enriched25","dt_odeslani","_orderData$_enriched26","odesilatel","_orderData$_enriched27","_orderData$_enriched28","dt_faktura_pridana","_orderData$_enriched29","fakturant","_orderData$_enriched30","faktury_celkem_s_dph","minimumFractionDigits","maximumFractionDigits","dokonceni_poznamka","prilohy_count","downloadOrderAttachment","nazev_souboru","velikost","displayName","PreviewContainer","PreviewHeader","HeaderIcon","HeaderInfo","ContractNumber","ContractTitle","InfoGrid","InfoItem","InfoLabel","InfoValue","FullWidthInfo","AmountDisplay","AmountLabel","AmountValue","StatusBadge","$active","NoData","Intl","NumberFormat","currency","format","formatDate","dateStr","Date","toLocaleDateString","_unused","smlouvaData","loading","smlouva","faFileContract","nazev_smlouvy","pouzit_v_obj_formu","marginRight","aktivni","hodnota_s_dph","nazev_firmy","dic","faCalendar","datum_uzavreni","datum_podpisu","datum_uzavreni_smlouvy","dt_vytvoreni","platnost_od","datum_od","platnost_do","datum_do","platnostDo","isExpired","datum_ukonceni","ukonceni","faClipboardList","undefined","cerpano_celkem","cerpano","celkova_castka","Overlay","Dialog","Header","IconWrapper","Title","h2","CloseButton","Content","Message","ErrorDetails","details","Footer","Button","primary","isOpen","onClose","onConfirm","confirmText","cancelText","ReactDOM","target","AlertCircle","X","InboxContainer","InboxHeader","InboxTitle","InboxStats","InboxContent","FakturaCard","FakturaHeader","FakturaNazev","FakturaID","FakturaInfo","InfoRow","PrilohaSection","PrilohaTitle","PrilohaItem","PrilohaInfo","PrilohaFilename","PrilohaMeta","PrilohaButton","LoadingBox","_templateObject19","ErrorBox","_templateObject20","EmptyBox","_templateObject21","RefreshButton","_templateObject22","FileModal","_templateObject23","y","x","innerWidth","w","h","innerHeight","FileModalContent","_templateObject24","FileModalHeader","_templateObject25","FileModalTitle","_templateObject26","FileCloseButton","_templateObject27","FileObject","iframe","_templateObject28","object","_templateObject29","PdfFallback","_templateObject30","DownloadButton","_templateObject31","TxtViewer","pre","_templateObject32","panelState","setPanelState","beginDrag","onOCRDataExtracted","setFaktury","setLoading","setError","pagination","setPagination","total","limit","offset","rok","fileViewer","setFileViewer","visible","filename","type","content","ocrProgress","setOcrProgress","progress","fileViewerPosition","setFileViewerPosition","isDraggingViewer","setIsDraggingViewer","errorDialog","setErrorDialog","handleFileViewerDrag","useCallback","preventDefault","clientX","clientY","handleFileViewerDragEnd","useEffect","addEventListener","removeEventListener","fetchFaktury","apiUrl","process","response","fetch","ok","Error","status","data","json","err","interval","setInterval","clearInterval","day","month","year","hour","minute","second","currentStyle","left","top","width","height","minHeight","maxHeight","PanelBase","edgeHandles","PanelHeader","onMouseDown","faBookOpen","TinyBtn","handleMinimize","minimized","faWindowRestore","faMinus","handleClose","faTimes","faSpinner","spin","faExclamationTriangle","disabled","faSync","draggable","onDragStart","attachmentsData","p","download_url","mime_type","dataTransfer","setData","JSON","stringify","effectAllowed","onDragEnd","dokument_id","jid","cislo_jednaci","datum_vzniku","slice","isPdf","isTxt","toLowerCase","endsWith","canPreview","toFixed","datumVystaveni","datumSplatnosti","variabilniSymbol","castka","proxyUrl","encodeURIComponent","statusText","contentType","headers","get","contentLength","arrayBuffer","byteLength","header","Uint8Array","headerStr","fromCharCode","startsWith","text","extractTextFromPDF","extractInvoiceData","warning","Promise","resolve","then","proceed","stack","handleOCRExtraction","transform","Sparkles","as","rel","txtContent","fetchTxtContent","file_id","position","right","bottom","zIndex","animation","maxWidth","backgroundColor","ErrorDialog","formatDateForPicker","date","d","isNaN","toISOString","split","PageContainer","FullscreenOverlay","PageHeader","PageTitle","h1","HeaderActions","IconButton","NotificationBadge","TooltipWrapper","TooltipContent","$top","$left","show","TooltipTitle","TooltipItem","TooltipItemTitle","TooltipItemMeta","ContentLayout","FormColumn","FormColumnHeader","FormColumnContent","PreviewColumn","PreviewColumnHeader","ToggleButton","PreviewColumnContent","$hasError","$isEditing","$gap","RequiredStar","CurrencyInputWrapper","CurrencySymbol","Input","input","Textarea","textarea","ButtonGroup","select","_templateObject33","_templateObject34","_templateObject35","_templateObject36","$variant","LoadingOverlay","_templateObject37","_templateObject38","_templateObject39","_templateObject40","_templateObject41","_templateObject42","_templateObject43","_templateObject44","LoadingSpinner","_templateObject45","ErrorAlert","_templateObject46","HelpText","_templateObject47","FieldError","_templateObject48","AutocompleteWrapper","_templateObject49","AutocompleteInput","_templateObject50","ClearButton","_templateObject51","AutocompleteDropdown","_templateObject52","OrderSuggestionItem","_templateObject53","OrderSuggestionTitle","_templateObject54","OrderSuggestionDetail","_templateObject55","OrderSuggestionBadge","_templateObject56","$textColor","NoResults","_templateObject57","SearchingSpinner","_templateObject58","MultiSelectWrapper","_templateObject59","MultiSelectButton","_templateObject60","hasError","placeholder","SelectedValue","_templateObject61","isEmpty","MultiSelectDropdown","_templateObject62","SearchBox","_templateObject63","SearchInput","_templateObject64","SearchIcon","_templateObject65","MultiSelectOption","_templateObject66","level","InvoiceEvidencePage","_location$state4","_getCurrentWorkflowSt","navigate","useNavigate","location","useLocation","orderId","useParams","user_id","hasPermission","useContext","AuthContext","showToast","ToastContext","setProgress","ProgressContext","canViewAllOrders","getCurrentWorkflowState","order","stavKody","parse","canAddInvoiceToOrder","allowed","reason","currentState","isFullscreen","setIsFullscreen","orderLoading","setOrderLoading","setOrderData","setSmlouvaData","selectedType","setSelectedType","fieldErrors","setFieldErrors","searchTerm","setSearchTerm","suggestions","setSuggestions","isSearching","setIsSearching","showSuggestions","setShowSuggestions","orderFormRef","useRef","hasAnySectionCollapsed","setHasAnySectionCollapsed","editingInvoiceId","setEditingInvoiceId","confirmDialog","setConfirmDialog","onCancel","isEntityUnlocked","setIsEntityUnlocked","hadOriginalEntity","setHadOriginalEntity","spisovkaInboxOpen","setSpisovkaInboxOpen","spisovkaInboxState","setSpisovkaInboxState","max","spisovkaTodayCount","setSpisovkaTodayCount","spisovkaLastRecords","setSpisovkaLastRecords","showSpisovkaTooltip","setShowSpisovkaTooltip","tooltipPosition","setTooltipPosition","tooltipButtonRef","handleResize","maxX","maxY","min","formData","setFormData","order_id","smlouva_id","fa_predana_zam_id","fa_datum_predani_zam","fa_datum_vraceni_zam","attachments","setAttachments","selectStates","setSelectStates","searchStates","setSearchStates","touchedSelectFields","setTouchedSelectFields","strediskaOptions","setStrediskaOptions","strediskaLoading","setStrediskaLoading","typyFakturOptions","setTypyFakturOptions","typyFakturLoading","setTypyFakturLoading","zamestnanci","setZamestnanci","zamestnanciLoading","setZamestnanciLoading","originalFormData","setOriginalFormData","hasChangedCriticalField","setHasChangedCriticalField","getStrediska25","loadStrediska","getTypyFaktur25","loadTypyFaktur","usersData","fetchAllUsers","u","sort","b","aName","bName","localeCompare","loadZamestnanci","hadOrderOrContract","wasNotHandedToEmployee","wasAlreadyApproved","hasChanged","field","original","current","_location$state3","state","editInvoiceId","_location$state","_location$state2","orderIdForLoad","invoiceData","getInvoiceById25","strediskaArray","parsed","warn","item","opt","loadedFormData","objednavka_id","file","orderIdToLoad","loadOrderData","loadSmlouvaData","loadInvoiceForEdit","getOrderV2","evCislo","evidencni_cislo","smlouvaId","getSmlouvaDetail","contract","normalizedData","objednavky","statistiky","cislo","searchEntities","search","_response$categories","_response$categories$","_response$categories2","_response$categories3","searchParams","query","categories","archivovano","search_all","universalSearch","orders","orders_2025","results","contracts","sentOrders","stav_kod","invalidStates","stav","validStates","activeContracts","combinedResults","_type","timer","setTimeout","clearTimeout","handleClickOutside","closest","fetchSpisovkaData","countUrl","countResponse","countData","count","faktoryUrl","faktoryResponse","faktoryData","handleInputChange","name","proceedWithOrderLoad","localStorage","setItem","handleEditInvoice","invoiceCheck","fa_variabilni_symbol","invoice_id","scrollTo","behavior","handleAttachmentsChange","newAttachments","handleAttachmentUploaded","uploadedAttachment","validateInvoiceForAttachments","isValid","isISDOC","objednateli","errors","push","handleCreateInvoiceInDB","tempFakturaId","apiParams","fa_dorucena","result","createInvoiceV2","newInvoiceId","handleISDOCParsed","isdocData","isdocSummary","mappedData","mapISDOCToFaktura","orderStrediska","handleOCRDataExtracted","ocrData","updates","handleSpisovkaInboxDrag","dir","startX","startY","startState","onMove","moveEvent","dx","dy","newState","minW","minH","newW","newH","onUp","handleBack","getOptionLabel","option","MultiSelect","onChange","options","safeValues","dropdownRef","buttonRef","searchInputRef","filteredOptions","filterOptions","lowerSearch","event","contains","updatePosition","buttonRect","getBoundingClientRect","dropdown","passive","capture","_searchInputRef$curre","focus","displayValue","fieldName","Search","optionValue","isChecked","newValues","v","handleToggleOption","checked","readOnly","PageContent","faFileInvoice","rect","tooltipWidth","record","pocet_priloh","toggleFullscreen","faCompress","faExpand","$fullscreen","faCreditCard","shouldResetEntity","pathname","boxSizing","handleUnlockEntity","faLock","onFocus","paddingLeft","paddingRight","handleClearSearch","faSearch","isOrder","isSmlouva","stavText","stavColors","stavLower","getStavColor","draftManager","setCurrentUser","existingDraft","loadDraft","parseInt","draftEvCislo","_orderCheck$lock_info","orderCheck","lock_info","locked","lockInfo","lockedByUserName","locked_by_user_fullname","locked_by_user_id","handleSelectOrder","pocet_faktur","flexShrink","datum","datum_objednavky","created_at","datum_vytvoreni","amount","DatePicker","onBlur","CustomSelect","required","toggleSelect","_opt$nazev","InvoiceAttachmentsCompact","fakturaId","objednavkaId","fakturaTypyPrilohOptions","onISDOCParsed","onAttachmentsChange","onAttachmentUploaded","onCreateInvoiceInDB","allowEmpty","predani","fa_typ_type","updateData","updateInvoiceV2","createInvoiceWithAttachmentV2","klasifikace","needsUpdate","pop","updateOrderV2","stav_objednavky","oldState","newStates","newStatusText","recipientUserIds","Set","uzivatel_id","add","objednatel_id","garant_uzivatel_id","prikazce_id","validRecipients","from","notificationService","create","NOTIFICATION_TYPES","ORDER_STATUS_KONTROLA_CEKA","action_user_id","recipients","sendInvoiceNotifications","updateErr","wasEditing","faSave","querySelector","scrollIntoView","block","_orderData$faktury","reduce","sum","_orderFormRef$current","_orderFormRef$current2","faChevronDown","SmlouvaPreview","createPortal","ConfirmDialog","showCancel","variant","SpisovkaInboxPanel","createLucideIcon","cx","cy","r","api","axios","baseURL","handleApiError","defaultMessage","arguments","request","errorMessage","checkResponse","_response$data","_response$data2","_response$data3","operation","getSmlouvyList","show_inactive","usek_id","druh_smlouvy","payload","post","_ref2","createSmlouva","_ref3","updateSmlouva","_ref4","deleteSmlouva","_ref5","bulkImportSmlouvy","_ref6","overwrite_existing","typ_souboru","velikost_souboru","prepocetCerpaniSmluv","_ref7","DRUH_SMLOUVY_OPTIONS","STAV_SMLOUVY_OPTIONS","getStavSmlouvyConfig","getStavSmlouvyLabel","getStavSmlouvyColor","SAZBA_DPH_OPTIONS"],"sourceRoot":""}