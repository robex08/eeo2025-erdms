"use strict";(self.webpackChunkr_app_zzs_eeo=self.webpackChunkr_app_zzs_eeo||[]).push([[4795,8319],{34795:(e,n,t)=>{t.d(n,{Ay:()=>l,fb:()=>a,getHierarchyConfig:()=>c});var r=t(58319);const a={ORDERS:"orders",INVOICES:"invoices",CASHBOOK:"cashbook"},o={DISABLED:"disabled",IMMUNE:"immune",ACTIVE:"active",NO_PROFILE:"no_profile",ERROR:"error"},c=async(e,n)=>{try{const c=await(0,r.getGlobalSettings)(e,n),i=Boolean(c.hierarchy_enabled),l=c.hierarchy_profile_id||null,u=c.hierarchy_logic||"OR";let h=null;if(l)try{const{getHierarchyProfiles:r}=await t.e(6102).then(t.bind(t,96102)),a=(await r(e,n)).find(e=>e.id===parseInt(l,10));h=a?a.name:null}catch(a){console.warn("\u26a0\ufe0f [HierarchyService] Nelze na\u010d\xedst n\xe1zev profilu:",a)}let d=o.DISABLED;return i&&(d=l?o.ACTIVE:o.NO_PROFILE),{status:d,enabled:i,profileId:l,profileName:h,logic:u,logicDescription:s(u),modules:{orders:i&&null!==l,invoices:!1,cashbook:!1}}}catch(a){return console.error("\u274c [HierarchyService] Chyba p\u0159i na\u010d\xedt\xe1n\xed nastaven\xed:",a),{status:o.ERROR,enabled:!1,profileId:null,profileName:null,logic:"OR",logicDescription:s("OR"),error:a.message,modules:{orders:!1,invoices:!1,cashbook:!1}}}},s=e=>"AND"===e?"Restriktivn\xed (A Z\xc1ROVE\u0147) - mus\xed spl\u0148ovat v\u0161echny \xfarovn\u011b sou\u010dasn\u011b":"Liber\xe1ln\xed (NEBO) - sta\u010d\xed splnit alespo\u0148 jednu \xfarove\u0148",i=(()=>{let e=null,n=0;return async function(t,r){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=Date.now();return!a&&e&&o-n<6e4?(console.log("\ud83d\udd04 [HierarchyService] Using cached config"),e):(console.log("\ud83d\udce1 [HierarchyService] Fetching fresh config"),e=await c(t,r),n=o,e)}})(),l={HierarchyModules:a,HierarchyStatus:o,getHierarchyConfig:c,getHierarchyConfigCached:i,isHierarchyActiveForModule:async(e,n,t)=>{try{const r=await c(n,t);switch(e){case a.ORDERS:return r.modules.orders;case a.INVOICES:return r.modules.invoices;case a.CASHBOOK:return r.modules.cashbook;default:return console.warn("\u26a0\ufe0f [HierarchyService] Nezn\xe1m\xfd modul: ".concat(e)),!1}}catch(r){return console.error("\u274c [HierarchyService] Chyba p\u0159i kontrole modulu:",r),!1}},getLogicDescription:s,getHierarchyInfoMessage:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.ORDERS;if(!e)return null;switch(e.status){case o.DISABLED:return null;case o.NO_PROFILE:return"\u26a0\ufe0f Hierarchie je zapnut\xe1, ale nen\xed vybr\xe1n \u017e\xe1dn\xfd profil. Kontaktujte administr\xe1tora.";case o.IMMUNE:return"\ud83d\udee1\ufe0f M\xe1te neomezen\xfd p\u0159\xedstup k dat\u016fm (HIERARCHY_IMMUNE).";case o.ACTIVE:const t={[a.ORDERS]:"objedn\xe1vky",[a.INVOICES]:"faktury",[a.CASHBOOK]:"pokladnu"}[n]||"data";return"\ud83c\udfe2 Hierarchie aktivn\xed: Vid\xedte ".concat(t,' podle organiza\u010dn\xedho \u0159\xe1du "').concat(e.profileName,'" (').concat(e.logicDescription,").");case o.ERROR:return"\u274c Chyba p\u0159i na\u010d\xedt\xe1n\xed hierarchie. Kontaktujte administr\xe1tora.";default:return null}},getHierarchyBannerColor:e=>{if(!e)return"info";switch(e.status){case o.DISABLED:return"info";case o.NO_PROFILE:return"warning";case o.IMMUNE:return"success";case o.ACTIVE:return"info";case o.ERROR:return"error";default:return"info"}},clearHierarchyCache:()=>{console.log("\ud83e\uddf9 [HierarchyService] Cache cleared")}}},58319:(e,n,t)=>{t.d(n,{checkMaintenanceMode:()=>s,getGlobalSettings:()=>a,l:()=>c,saveGlobalSettings:()=>o});const r="https://erdms.zachranka.cz/api.eeo/".replace(/\/$/,""),a=async(e,n)=>{try{const t=await fetch("".concat(r,"/global-settings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,username:n,operation:"get"})});if(!t.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));const a=await t.json();return a.data||a}catch(t){throw console.error("Chyba p\u0159i na\u010d\xedt\xe1n\xed glob\xe1ln\xedho nastaven\xed:",t),t}},o=async(e,n,t)=>{try{const a={token:n,username:t,operation:"save",settings:e};console.group("\ud83d\udcbe SAVE GLOBAL SETTINGS"),console.log("Settings to save:",e),console.log("Full payload:",a),console.groupEnd();const o=await fetch("".concat(r,"/global-settings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw new Error("HTTP ".concat(o.status,": ").concat(o.statusText));return await o.json()}catch(a){throw console.error("Chyba p\u0159i ukl\xe1d\xe1n\xed glob\xe1ln\xedho nastaven\xed:",a),a}},c=async(e,n)=>{try{const t=await fetch("".concat(r,"/maintenance-message"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,username:n})});if(!t.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));return(await t.json()).message||"Syst\xe9m je moment\xe1ln\u011b v \xfadr\u017eb\u011b. Omlouv\xe1me se za komplikace."}catch(t){throw console.error("Chyba p\u0159i na\u010d\xedt\xe1n\xed \xfadr\u017ebov\xe9 zpr\xe1vy:",t),t}},s=async()=>{try{const e=await fetch("".concat(r,"/maintenance-status"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)return!1;const n=await e.json();return!0===n.maintenance_mode||1===n.maintenance_mode}catch(e){return console.error("Chyba p\u0159i kontrole maintenance mode:",e),!1}}}}]);
//# sourceMappingURL=4795.580df331.chunk.js.map