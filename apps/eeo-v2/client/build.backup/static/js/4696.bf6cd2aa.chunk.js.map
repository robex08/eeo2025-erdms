{"version":3,"file":"static/js/4696.bf6cd2aa.chunk.js","mappings":"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","sources":["pages/OrganizationHierarchy.js"],"sourcesContent":["import React, { useState, useCallback, useEffect, useRef, useContext } from 'react';\nimport styled from '@emotion/styled';\nimport ReactFlow, {\n  MiniMap,\n  Controls,\n  Background,\n  useNodesState,\n  useEdgesState,\n  addEdge,\n  MarkerType,\n  Panel,\n  Handle,\n  Position,\n  useReactFlow\n} from 'reactflow';\nimport 'reactflow/dist/style.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { CustomSelect } from '../components/CustomSelect';\nimport dagre from 'dagre';\nimport { graphlib } from 'dagre';\nimport { loadAuthData } from '../utils/authStorage';\nimport { ToastContext } from '../context/ToastContext';\nimport { \n  faSitemap, \n  faUsers, \n  faMapMarkerAlt, \n  faBell, \n  faKey,\n  faSearch,\n  faPlus,\n  faTimes,\n  faChevronDown,\n  faChevronRight,\n  faUserTie,\n  faUserShield,\n  faBuilding,\n  faEnvelope,\n  faSave,\n  faTrash,\n  faEdit,\n  faEye,\n  faEyeSlash,\n  faLayerGroup,\n  faInfoCircle,\n  faExpand\n} from '@fortawesome/free-solid-svg-icons';\n\n// API Configuration\nconst API_BASE_URL = (process.env.REACT_APP_API2_BASE_URL || '/api.eeo').replace(/\\/$/, '');\n\n// Potlait nekodnou ResizeObserver chybu (bn u ReactFlow)\nconst resizeObserverErr = window.console.error;\nwindow.console.error = (...args) => {\n  const errorMsg = typeof args[0] === 'string' ? args[0] : args[0]?.message || '';\n  if (errorMsg.includes('ResizeObserver loop completed') || \n      errorMsg.includes('ResizeObserver loop limit exceeded')) {\n    return; // Ignorovat tuto konkrtn chybu\n  }\n  resizeObserverErr(...args);\n};\n\n// Potlait ResizeObserver error i v error handleru\nwindow.addEventListener('error', (e) => {\n  if (e.message?.includes?.('ResizeObserver loop completed') ||\n      e.message?.includes?.('ResizeObserver loop limit exceeded') ||\n      e.message?.includes?.('undelivered notifications')) {\n    e.stopImmediatePropagation();\n    e.preventDefault();\n  }\n}, true);\n\n// Styled Components\nconst Container = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: #f5f7fa;\n  margin-top: -1em; /* Kompenzace padding-top z Layout Content */\n  user-select: none;\n  -webkit-user-select: none;\n`;\n\nconst Header = styled.div`\n  padding: 16px 24px;\n  background: white;\n  border-bottom: 1px solid #e0e6ed;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n  flex-shrink: 0;\n  user-select: none;\n`;\n\nconst Title = styled.h1`\n  color: #2c3e50;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  font-size: 1.5rem;\n`;\n\nconst HeaderActions = styled.div`\n  display: flex;\n  gap: 12px;\n`;\n\nconst Button = styled.button`\n  padding: 8px 16px;\n  background: ${props => props.primary ? '#3b82f6' : 'white'};\n  color: ${props => props.primary ? '#fff' : '#2c3e50'};\n  border: 1px solid ${props => props.primary ? '#3b82f6' : '#e0e6ed'};\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n  font-weight: 500;\n\n  &:hover {\n    background: ${props => props.primary ? '#2563eb' : '#f8fafc'};\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n`;\n\nconst ModalOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  animation: fadeIn 0.2s ease-in-out;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n`;\n\nconst ModalContent = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 24px;\n  max-width: 500px;\n  width: 90%;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  animation: slideUp 0.3s ease-out;\n\n  @keyframes slideUp {\n    from {\n      transform: translateY(20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n`;\n\nconst ModalHeader = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 16px;\n  color: #dc2626;\n  font-size: 1.25rem;\n  font-weight: 700;\n`;\n\nconst ModalBody = styled.div`\n  color: #475569;\n  font-size: 1rem;\n  line-height: 1.6;\n  margin-bottom: 24px;\n`;\n\nconst ModalActions = styled.div`\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n`;\n\nconst ModalButton = styled.button`\n  padding: 10px 20px;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n\n  ${props => props.variant === 'danger' ? `\n    background: #dc2626;\n    color: white;\n    &:hover {\n      background: #b91c1c;\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.4);\n    }\n  ` : `\n    background: #f1f5f9;\n    color: #475569;\n    &:hover {\n      background: #e2e8f0;\n    }\n  `}\n`;\n\n\nconst MainContent = styled.div`\n  flex: 1;\n  display: flex;\n  overflow: hidden;\n`;\n\nconst Sidebar = styled.div`\n  width: 400px;\n  background: white;\n  border-right: 1px solid #e0e6ed;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  position: relative;\n  user-select: none;\n`;\n\nconst SidebarHeader = styled.div`\n  padding: 16px;\n  border-bottom: 1px solid #e0e6ed;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n`;\n\nconst SidebarTitle = styled.h3`\n  margin: 0;\n  color: white;\n  font-size: 1rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n\nconst SearchBox = styled.div`\n  padding: 12px 16px;\n  border-bottom: 1px solid #e0e6ed;\n  position: relative;\n`;\n\nconst SearchInput = styled.input`\n  width: 100%;\n  padding: 8px 32px 8px 36px;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  background: #f8fafc;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    background: white;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n`;\n\nconst SearchIcon = styled.div`\n  position: absolute;\n  left: 28px;\n  top: 22px;\n  color: #94a3b8;\n`;\n\nconst SearchClearButton = styled.button`\n  position: absolute;\n  right: 24px;\n  top: 20px;\n  background: none;\n  border: none;\n  color: #94a3b8;\n  cursor: pointer;\n  padding: 4px 6px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.1rem;\n  border-radius: 4px;\n  transition: all 0.2s;\n  \n  &:hover {\n    background: #e2e8f0;\n    color: #475569;\n  }\n  \n  &:active {\n    transform: scale(0.95);\n  }\n`;\n\nconst SidebarContent = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n  padding-bottom: 190px; /* Prostor pro ob fixn tlatka (Pidat vybran + Resetovat plochu) */\n\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n`;\n\nconst CollapsibleSection = styled.div`\n  margin-bottom: 8px;\n`;\n\nconst SectionHeader = styled.div`\n  padding: 10px 12px;\n  background: ${props => props.expanded ? '#f1f5f9' : 'transparent'};\n  border-radius: 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #475569;\n  font-weight: 600;\n  font-size: 0.85rem;\n  transition: all 0.2s;\n\n  &:hover {\n    background: #f1f5f9;\n  }\n\n  svg:first-of-type {\n    width: 12px;\n  }\n`;\n\nconst SectionContent = styled.div`\n  margin-top: 4px;\n  padding-left: 8px;\n  display: ${props => props.expanded ? 'block' : 'none'};\n`;\n\nconst UserItem = styled.div`\n  padding: 10px 12px;\n  margin-bottom: 6px;\n  background: ${props => props.isDragging ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : 'white'};\n  border: 2px solid ${props => props.isDragging ? '#667eea' : '#e0e6ed'};\n  border-radius: 8px;\n  cursor: grab;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  transition: all 0.2s;\n  color: ${props => props.isDragging ? '#fff' : '#2c3e50'};\n  box-shadow: ${props => props.isDragging ? '0 8px 24px rgba(102, 126, 234, 0.3)' : '0 1px 3px rgba(0,0,0,0.05)'};\n\n  &:hover {\n    border-color: #3b82f6;\n    transform: translateX(4px);\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n  }\n\n  &:active {\n    cursor: grabbing;\n  }\n`;\n\nconst UserAvatar = styled.div`\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 700;\n  font-size: 0.85rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n`;\n\nconst UserInfo = styled.div`\n  flex: 1;\n  min-width: 0;\n`;\n\nconst UserName = styled.div`\n  font-weight: 600;\n  font-size: 0.9rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 2px;\n`;\n\nconst UserMeta = styled.div`\n  font-size: 0.75rem;\n  color: #64748b;\n  display: flex;\n  gap: 6px;\n  align-items: center;\n`;\n\nconst LocationItem = styled(UserItem)`\n  cursor: ${props => props.isDragging ? 'grabbing' : 'grab'};\n  opacity: ${props => props.isDragging ? 0.8 : 1};\n  transform: ${props => props.isDragging ? 'rotate(2deg) scale(1.05)' : 'none'};\n  \n  &:hover {\n    transform: ${props => props.isDragging ? 'rotate(2deg) scale(1.05)' : 'translateX(4px)'};\n  }\n`;\n\nconst LocationIcon = styled.div`\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  background: linear-gradient(135deg, #92400e 0%, #78350f 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(146, 64, 14, 0.3);\n`;\n\nconst DepartmentIcon = styled.div`\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  background: linear-gradient(135deg, #059669 0%, #047857 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(5, 150, 105, 0.3);\n`;\n\nconst CanvasArea = styled.div`\n  flex: 1;\n  position: relative;\n  background: #f5f7fa;\n  user-select: none; /* Zakzat vbr textu v cel canvas oblasti */\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  \n  /* Pointer kurzor pi hover nad nodem nebo edge */\n  .react-flow__node,\n  .react-flow__edge {\n    cursor: pointer !important;\n  }\n  \n  /* Crosshair pi SHIFT (selection mode) - NEJVY PRIORITA */\n  &.selection-mode .react-flow__pane,\n  &.selection-mode .react-flow__pane:hover,\n  &.selection-mode .react-flow__pane:active,\n  &.selection-mode .react-flow__pane:focus {\n    cursor: crosshair !important;\n  }\n  \n  /* Vchoz grab kurzor pro pan - JEN pokud NEN selection mode */\n  &:not(.selection-mode) .react-flow__pane {\n    cursor: grab !important;\n  }\n  \n  /* Grabbing kurzor pi aktivnm panovn - JEN pokud NEN selection mode */\n  &:not(.selection-mode) .react-flow__pane:active {\n    cursor: grabbing !important;\n  }\n  \n  /* Styl pro vbrov obdlnk (box-select) */\n  .react-flow__selection {\n    background: rgba(102, 126, 234, 0.08) !important;\n    border: 2px dashed #667eea !important;\n    border-radius: 8px !important;\n  }\n  \n  .react-flow__nodesselection {\n    background: transparent !important;\n    border: none !important;\n  }\n`;\n\nconst DetailPanel = styled.div`\n  width: 380px;\n  background: white;\n  border-left: 1px solid #e0e6ed;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  box-shadow: -2px 0 8px rgba(0,0,0,0.05);\n`;\n\nconst DetailHeader = styled.div`\n  padding: 16px;\n  border-bottom: 1px solid #e0e6ed;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n`;\n\nconst DetailHeaderTitle = styled.h3`\n  margin: 0;\n  color: white;\n  font-size: 1rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n\nconst CloseButton = styled.button`\n  background: rgba(255,255,255,0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(255,255,255,0.3);\n  }\n`;\n\nconst InfoButton = styled.button`\n  background: rgba(255,255,255,0.15);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  margin-left: auto;\n  margin-right: 8px;\n  font-size: 16px;\n\n  &:hover {\n    background: rgba(255,255,255,0.3);\n  }\n`;\n\nconst DetailContent = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 3px;\n  }\n  \n  /* Scrollbar pro email preview */\n  .email-preview-body {\n    &::-webkit-scrollbar {\n      width: 8px;\n    }\n    \n    &::-webkit-scrollbar-track {\n      background: #f1f5f9;\n      border-radius: 4px;\n    }\n    \n    &::-webkit-scrollbar-thumb {\n      background: #cbd5e1;\n      border-radius: 4px;\n      \n      &:hover {\n        background: #94a3b8;\n      }\n    }\n  }\n`;\n\nconst DetailSection = styled.div`\n  margin-bottom: 28px;\n`;\n\nconst DetailSectionTitle = styled.h4`\n  margin: 0 0 16px 0;\n  color: #475569;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  font-weight: 700;\n`;\n\nconst FormGroup = styled.div`\n  margin-bottom: 16px;\n`;\n\nconst Label = styled.label`\n  display: block;\n  margin-bottom: 8px;\n  color: #475569;\n  font-size: 0.85rem;\n  font-weight: 600;\n`;\n\nconst Input = styled.input`\n  width: 100%;\n  padding: 10px 12px;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  background: #f8fafc;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    background: white;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n\n  &:read-only {\n    background: #e2e8f0;\n    cursor: not-allowed;\n  }\n`;\n\nconst ProfileSelectWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  padding: 2px;\n  transition: all 0.2s;\n  \n  &:focus-within {\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n  \n  &:hover {\n    border-color: #d1d5db;\n  }\n`;\n\nconst ProfileSelect = styled.select`\n  flex: 1;\n  padding: 8px 12px;\n  border: none;\n  background: transparent;\n  color: #111827;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  outline: none;\n  appearance: none;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\");\n  background-position: right 8px center;\n  background-repeat: no-repeat;\n  background-size: 20px;\n  padding-right: 36px;\n  \n  option {\n    padding: 10px;\n    font-size: 0.875rem;\n  }\n`;\n\nconst ProfileSelectArrow = styled.div`\n  display: none;\n`;\n\nconst ProfileDeleteButton = styled.button`\n  padding: 4px 8px;\n  background: transparent;\n  border: 1px solid #e5e7eb;\n  color: ${props => props.disabled ? '#d1d5db' : '#6b7280'};\n  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n  font-size: 0.875rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s;\n  border-radius: 6px;\n  min-width: 32px;\n  height: 32px;\n  \n  &:hover:not(:disabled) {\n    background: #f9fafb;\n    border-color: #d1d5db;\n  }\n  \n  &:active:not(:disabled) {\n    background: #f3f4f6;\n  }\n`;\n\nconst Select = styled.select`\n  width: 100%;\n  padding: 8px 16px;\n  border: 1px solid #e0e6ed;\n  border-radius: 6px;\n  background: white;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  box-sizing: border-box;\n  height: 40px;\n  font-weight: 500;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n`;\n\nconst CheckboxGroup = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n`;\n\nconst CheckboxLabel = styled.label`\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 6px;\n  transition: background 0.2s;\n\n  &:hover {\n    background: #f8fafc;\n  }\n\n  input[type=\"checkbox\"] {\n    width: 20px;\n    height: 20px;\n    cursor: pointer;\n    accent-color: #667eea;\n  }\n`;\n\nconst TagList = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  margin-top: 8px;\n`;\n\nconst Tag = styled.div`\n  padding: 6px 12px;\n  background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);\n  color: #667eea;\n  border-radius: 6px;\n  font-size: 0.85rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 500;\n  border: 1px solid #667eea30;\n\n  button {\n    background: none;\n    border: none;\n    color: inherit;\n    cursor: pointer;\n    padding: 0;\n    display: flex;\n    align-items: center;\n    opacity: 0.6;\n    transition: opacity 0.2s;\n\n    &:hover {\n      opacity: 1;\n    }\n  }\n`;\n\nconst Divider = styled.div`\n  height: 1px;\n  background: #e0e6ed;\n  margin: 20px 0;\n`;\n\nconst CombinationTable = styled.table`\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 12px;\n  font-size: 0.9rem;\n\n  th {\n    background: #f8f9fa;\n    padding: 8px;\n    text-align: left;\n    font-weight: 600;\n    color: #495057;\n    border-bottom: 2px solid #dee2e6;\n  }\n\n  td {\n    padding: 8px;\n    border-bottom: 1px solid #e9ecef;\n  }\n\n  tr:hover {\n    background: #f8f9fa;\n  }\n\n  button {\n    background: none;\n    border: none;\n    color: #dc3545;\n    cursor: pointer;\n    padding: 4px;\n    display: flex;\n    align-items: center;\n    opacity: 0.7;\n    transition: opacity 0.2s;\n\n    &:hover {\n      opacity: 1;\n    }\n  }\n`;\n\nconst CombinationAddRow = styled.div`\n  display: flex;\n  gap: 8px;\n  align-items: flex-end;\n  margin-top: 12px;\n\n  > div {\n    flex: 1;\n  }\n\n  button {\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-weight: 500;\n    transition: transform 0.2s, box-shadow 0.2s;\n    white-space: nowrap;\n\n    &:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n\n    &:active {\n      transform: translateY(0);\n    }\n  }\n`;\n\n// Custom Dialog Components\nconst DialogOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  animation: fadeIn 0.2s ease;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n`;\n\nconst DialogBox = styled.div`\n  background: white;\n  border-radius: 16px;\n  padding: 32px;\n  max-width: 500px;\n  width: 90%;\n  box-shadow: 0 20px 60px rgba(0,0,0,0.3);\n  animation: slideUp 0.3s ease;\n\n  @keyframes slideUp {\n    from {\n      transform: translateY(20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n`;\n\nconst DialogIcon = styled.div`\n  font-size: 3rem;\n  text-align: center;\n  margin-bottom: 16px;\n`;\n\nconst DialogTitle = styled.h2`\n  margin: 0 0 12px 0;\n  color: #2c3e50;\n  font-size: 1.5rem;\n  text-align: center;\n`;\n\nconst DialogMessage = styled.div`\n  color: #64748b;\n  font-size: 0.95rem;\n  line-height: 1.6;\n  margin-bottom: 24px;\n  white-space: pre-line;\n`;\n\nconst DialogActions = styled.div`\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n`;\n\nconst DialogButton = styled.button`\n  padding: 10px 24px;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  border: none;\n  transition: all 0.2s;\n  \n  ${props => props.primary ? `\n    background: #667eea;\n    color: white;\n    &:hover {\n      background: #5568d3;\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n  ` : `\n    background: #e0e6ed;\n    color: #64748b;\n    &:hover {\n      background: #cbd5e1;\n    }\n  `}\n`;\n\nconst DialogStats = styled.div`\n  background: #f8fafc;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  padding: 16px;\n  margin: 16px 0;\n  \n  div {\n    display: flex;\n    justify-content: space-between;\n    padding: 8px 0;\n    font-size: 0.9rem;\n    \n    &:not(:last-child) {\n      border-bottom: 1px solid #e0e6ed;\n    }\n    \n    strong {\n      color: #2c3e50;\n      font-weight: 600;\n    }\n    \n    span {\n      color: #667eea;\n      font-weight: 700;\n    }\n  }\n`;\n\nconst HelpModalContent = styled.div`\n  max-height: 80vh;\n  overflow-y: auto;\n  padding: 0 4px;\n`;\n\nconst HelpSection = styled.div`\n  margin-bottom: 24px;\n  \n  h3 {\n    color: #2c3e50;\n    font-size: 1.1rem;\n    margin: 0 0 12px 0;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n  \n  p {\n    color: #64748b;\n    font-size: 0.9rem;\n    line-height: 1.6;\n    margin: 0 0 8px 0;\n  }\n  \n  code {\n    background: #f1f5f9;\n    padding: 2px 6px;\n    border-radius: 4px;\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #667eea;\n  }\n`;\n\nconst HelpExample = styled.div`\n  background: #f8fafc;\n  border-left: 3px solid #667eea;\n  padding: 12px;\n  border-radius: 4px;\n  margin: 8px 0;\n  font-size: 0.9rem;\n  \n  strong {\n    color: #2c3e50;\n    display: block;\n    margin-bottom: 4px;\n  }\n  \n  span {\n    color: #64748b;\n  }\n`;\n\n// Custom Node Component\nconst CustomNode = ({ data, selected }) => {\n  // Rozliit typ node (user, location, department, template, role)\n  const isTemplate = data.type === 'template';\n  const isRole = data.type === 'role';\n  const isLocation = data.type === 'location';\n  const isDepartment = data.type === 'department';\n  const isUser = !isLocation && !isDepartment && !isTemplate && !isRole;\n  \n  // Pro template nodes - jen zelen vstupn bod\n  if (isTemplate) {\n    return (\n      <div style={{\n        padding: '12px 16px',\n        borderRadius: '8px',\n        background: selected \n          ? 'linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)'\n          : 'white',\n        border: `3px solid ${selected ? '#f59e0b' : '#f59e0b'}`,\n        minWidth: '200px',\n        boxShadow: selected \n          ? '0 6px 16px rgba(245, 158, 11, 0.4)'\n          : '0 2px 8px rgba(245, 158, 11, 0.15)',\n        transition: 'all 0.2s',\n        position: 'relative',\n        transform: selected ? 'scale(1.05)' : 'scale(1)',\n      }}>\n        {/* Jen zelen source handle - ablona vysl notifikace */}\n        <Handle\n          type=\"source\"\n          position={Position.Right}\n          style={{\n            width: '16px',\n            height: '16px',\n            background: '#10b981',\n            border: '3px solid white',\n            boxShadow: '0 2px 8px rgba(16, 185, 129, 0.5)',\n            cursor: 'crosshair',\n            right: '-10px'\n          }}\n        />\n        <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n          <div style={{\n            width: '40px',\n            height: '40px',\n            borderRadius: '50%',\n            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            fontSize: '1.3rem',\n            boxShadow: '0 2px 8px rgba(102, 126, 234, 0.3)'\n          }}>\n            \n          </div>\n          <div style={{ flex: 1 }}>\n            <div style={{ \n              fontWeight: 700, \n              color: '#78350f',\n              fontSize: '0.85rem',\n              marginBottom: '2px'\n            }}>\n              {data.name}\n            </div>\n            <div style={{ \n              fontSize: '0.7rem', \n              color: '#92400e',\n              fontWeight: 500\n            }}>\n              {data.position}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Pro role nodes - fialov node s ikonou ttu\n  if (isRole) {\n    return (\n      <div style={{\n        padding: '12px 16px',\n        borderRadius: '8px',\n        background: selected \n          ? 'linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%)'\n          : 'white',\n        border: `3px solid ${selected ? '#8b5cf6' : '#8b5cf6'}`,\n        minWidth: '200px',\n        boxShadow: selected \n          ? '0 6px 16px rgba(139, 92, 246, 0.4)'\n          : '0 2px 8px rgba(139, 92, 246, 0.15)',\n        transition: 'all 0.2s',\n        position: 'relative',\n        transform: selected ? 'scale(1.05)' : 'scale(1)',\n      }}>\n        {/* Source handle - role me vyslat notifikace/prva */}\n        <Handle\n          type=\"source\"\n          position={Position.Right}\n          style={{\n            width: '16px',\n            height: '16px',\n            background: '#10b981',\n            border: '3px solid white',\n            boxShadow: '0 2px 8px rgba(16, 185, 129, 0.5)',\n            cursor: 'crosshair',\n            right: '-10px'\n          }}\n        />\n        {/* Target handle - role pijm uivatele */}\n        <Handle\n          type=\"target\"\n          position={Position.Left}\n          style={{\n            width: '16px',\n            height: '16px',\n            background: '#ef4444',\n            border: '3px solid white',\n            boxShadow: '0 2px 8px rgba(239, 68, 68, 0.5)',\n            cursor: 'crosshair',\n            left: '-10px'\n          }}\n        />\n        <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n          <div style={{\n            width: '40px',\n            height: '40px',\n            borderRadius: '50%',\n            background: 'linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            fontSize: '1.3rem',\n            boxShadow: '0 2px 8px rgba(139, 92, 246, 0.3)',\n            color: 'white'\n          }}>\n            \n          </div>\n          <div style={{ flex: 1 }}>\n            <div style={{ \n              fontWeight: 700, \n              color: '#6d28d9',\n              fontSize: '0.85rem',\n              marginBottom: '2px'\n            }}>\n              {data.name}\n            </div>\n            <div style={{ \n              fontSize: '0.7rem', \n              color: '#8b5cf6',\n              fontWeight: 500\n            }}>\n              {data.metadata?.userCount ? ` ${data.metadata.userCount} uivatel` : 'Role'}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Pro location/department nodes - zjednoduen vizualizace\n  if (isLocation || isDepartment) {\n    return (\n      <div style={{\n        padding: '12px 16px',\n        borderRadius: '8px',\n        background: selected \n          ? (isLocation ? 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)' : 'linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)')\n          : 'white',\n        border: `3px solid ${selected ? (isLocation ? '#92400e' : '#059669') : (isLocation ? '#92400e' : '#059669')}`,\n        minWidth: '160px',\n        boxShadow: selected \n          ? `0 6px 16px ${isLocation ? 'rgba(146, 64, 14, 0.4)' : 'rgba(5, 150, 105, 0.4)'}`\n          : `0 2px 8px ${isLocation ? 'rgba(146, 64, 14, 0.15)' : 'rgba(5, 150, 105, 0.15)'}`,\n        transition: 'all 0.2s',\n        position: 'relative',\n        transform: selected ? 'scale(1.05)' : 'scale(1)',\n        textAlign: 'center'\n      }}>\n        <Handle\n          type=\"target\"\n          position={Position.Top}\n          style={{\n            width: '14px',\n            height: '14px',\n            background: isLocation ? '#92400e' : '#059669',\n            border: '2px solid white',\n            boxShadow: `0 2px 6px ${isLocation ? 'rgba(146, 64, 14, 0.4)' : 'rgba(5, 150, 105, 0.4)'}`,\n            cursor: 'crosshair'\n          }}\n        />\n        <Handle\n          type=\"source\"\n          position={Position.Bottom}\n          style={{\n            width: '14px',\n            height: '14px',\n            background: isLocation ? '#92400e' : '#059669',\n            border: '2px solid white',\n            boxShadow: `0 2px 6px ${isLocation ? 'rgba(146, 64, 14, 0.4)' : 'rgba(5, 150, 105, 0.4)'}`,\n            cursor: 'crosshair'\n          }}\n        />\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px' }}>\n          <FontAwesomeIcon \n            icon={isLocation ? faMapMarkerAlt : faUserTie} \n            style={{ \n              color: isLocation ? '#92400e' : '#059669',\n              fontSize: '1.1rem'\n            }} \n          />\n          <div style={{ \n            fontWeight: 700, \n            color: '#2c3e50',\n            fontSize: '0.9rem'\n          }}>\n            {data.name}\n          </div>\n        </div>\n      </div>\n    );\n  }\n  \n  // User node - pvodn vizualizace\n  return (\n    <div style={{\n      padding: '14px',\n      borderRadius: '12px',\n      background: selected ? 'linear-gradient(135deg, #dbeafe 0%, #e0f2fe 100%)' : 'white',\n      border: `3px solid ${selected ? '#3b82f6' : '#3b82f6'}`,\n      minWidth: '220px',\n      boxShadow: selected \n        ? '0 8px 24px rgba(59, 130, 246, 0.5), 0 0 0 2px #93c5fd' \n        : '0 4px 12px rgba(59, 130, 246, 0.15)',\n      transition: 'all 0.2s',\n      position: 'relative',\n      transform: selected ? 'scale(1.02)' : 'scale(1)'\n    }}>\n      {/* Target handle - kam pijdou ipky (nahoe) */}\n      <Handle\n        type=\"target\"\n        position={Position.Top}\n        style={{\n          width: '16px',\n          height: '16px',\n          background: '#3b82f6',\n          border: '3px solid white',\n          boxShadow: '0 2px 8px rgba(59, 130, 246, 0.4)',\n          cursor: 'crosshair'\n        }}\n      />\n      \n      {/* Source handle - odkud thneme ipky (dole) */}\n      <Handle\n        type=\"source\"\n        position={Position.Bottom}\n        style={{\n          width: '16px',\n          height: '16px',\n          background: '#10b981',\n          border: '3px solid white',\n          boxShadow: '0 2px 8px rgba(16, 185, 129, 0.4)',\n          cursor: 'crosshair'\n        }}\n      />\n\n      {/* Notification badges - prav horn roh */}\n      {data.notifications && (data.notifications.hasEmail || data.notifications.hasInApp) && (\n        <div style={{\n          position: 'absolute',\n          top: '8px',\n          right: '8px',\n          display: 'flex',\n          gap: '4px',\n          alignItems: 'center'\n        }}>\n          {data.notifications.hasEmail && (\n            <div style={{\n              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n              borderRadius: '50%',\n              width: '24px',\n              height: '24px',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              boxShadow: '0 2px 6px rgba(102, 126, 234, 0.4)',\n              cursor: 'help'\n            }} title=\"Email notifikace aktivn\">\n              <FontAwesomeIcon icon={faEnvelope} style={{ color: 'white', fontSize: '0.7rem' }} />\n            </div>\n          )}\n          {data.notifications.hasInApp && (\n            <div style={{\n              background: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',\n              borderRadius: '50%',\n              width: '24px',\n              height: '24px',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              boxShadow: '0 2px 6px rgba(245, 87, 108, 0.4)',\n              cursor: 'help'\n            }} title=\"In-app notifikace aktivn\">\n              <FontAwesomeIcon icon={faBell} style={{ color: 'white', fontSize: '0.7rem' }} />\n            </div>\n          )}\n        </div>\n      )}\n      \n      <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '10px' }}>\n        <UserAvatar>{data.initials}</UserAvatar>\n        <div style={{ flex: 1 }}>\n          <div style={{ fontWeight: 700, color: '#2c3e50', fontSize: '0.95rem', marginBottom: '2px' }}>\n            {data.name}\n          </div>\n          <div style={{ fontSize: '0.8rem', color: '#64748b', fontWeight: 500 }}>\n            {data.position}\n          </div>\n        </div>\n      </div>\n      {data.metadata && (\n        <div style={{ \n          fontSize: '0.75rem', \n          color: '#64748b', \n          paddingTop: '10px', \n          borderTop: '1px solid #e0e6ed',\n          display: 'flex',\n          flexDirection: 'column',\n          gap: '4px'\n        }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>\n            <FontAwesomeIcon icon={faMapMarkerAlt} style={{ color: '#f5576c' }} />\n            {data.metadata.location}\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>\n            <FontAwesomeIcon icon={faUserTie} style={{ color: '#00f2fe' }} />\n            {data.metadata.department}\n          </div>\n          {data.notifications && data.notifications.types && data.notifications.types.length > 0 && (\n            <div style={{ \n              display: 'flex', \n              alignItems: 'center', \n              gap: '6px',\n              marginTop: '4px',\n              paddingTop: '6px',\n              borderTop: '1px dashed #e0e6ed'\n            }}>\n              <FontAwesomeIcon icon={faBell} style={{ color: '#667eea' }} />\n              <span style={{ fontSize: '0.7rem', color: '#667eea', fontWeight: 600 }}>\n                {data.notifications.types.length} typ{data.notifications.types.length > 1 ? 'y' : ''} notifikac\n              </span>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst nodeTypes = {\n  custom: CustomNode,\n};\n\n// Main Component with error boundary for hot-reload issues\nconst OrganizationHierarchy = () => {\n  const reactFlowWrapper = useRef(null);\n  const { showToast } = useContext(ToastContext);\n  const [hasError, setHasError] = useState(false);\n  \n  // Catch ReactFlow hot-reload errors\n  useEffect(() => {\n    const handleError = (event) => {\n      if (event.message?.includes('useNodesState') || event.message?.includes('useEdgesState')) {\n        console.warn('ReactFlow HMR error - refresh needed');\n        setHasError(true);\n      }\n    };\n    window.addEventListener('error', handleError);\n    return () => window.removeEventListener('error', handleError);\n  }, []);\n  \n  // Search terms pro kadou sekci (nast z LS)\n  const [searchUsers, setSearchUsers] = useState(() => localStorage.getItem('hierarchy_search_users') || '');\n  const [searchRoles, setSearchRoles] = useState(() => localStorage.getItem('hierarchy_search_roles') || '');\n  const [searchLocations, setSearchLocations] = useState(() => localStorage.getItem('hierarchy_search_locations') || '');\n  const [searchDepartments, setSearchDepartments] = useState(() => localStorage.getItem('hierarchy_search_departments') || '');\n  const [searchTemplates, setSearchTemplates] = useState(() => localStorage.getItem('hierarchy_search_templates') || '');\n  \n  const [expandedSections, setExpandedSections] = useState(() => {\n    const saved = localStorage.getItem('hierarchy_expanded_sections');\n    return saved ? JSON.parse(saved) : {\n      users: true,\n      roles: false,\n      locations: false,\n      departments: false,\n      notificationTemplates: false\n    };\n  });\n  const [selectedNode, setSelectedNode] = useState(null);\n  const [selectedEdge, setSelectedEdge] = useState(null);\n  const [showDetailPanel, setShowDetailPanel] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // React Flow state\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const [reactFlowInstance, setReactFlowInstance] = useState(null);\n\n  // Data from API\n  const [allUsers, setAllUsers] = useState([]);\n  const [allRoles, setAllRoles] = useState([]);\n  const [allLocations, setAllLocations] = useState([]);\n  const [allDepartments, setAllDepartments] = useState([]);\n  const [notificationTypes, setNotificationTypes] = useState([]);\n  const [allNotificationTemplates, setAllNotificationTemplates] = useState([]);\n  \n  // Detail panel data - rozsirene lokality a notifikace pro vybrany vztah\n  const [selectedExtendedLocations, setSelectedExtendedLocations] = useState([]);\n  const [selectedNotificationTypes, setSelectedNotificationTypes] = useState([]);\n  const [notificationEmailEnabled, setNotificationEmailEnabled] = useState(false);\n  const [notificationInAppEnabled, setNotificationInAppEnabled] = useState(true);\n  const [notificationRecipientRole, setNotificationRecipientRole] = useState('APPROVAL'); // APPROVER_NORMAL, APPROVER_URGENT, SUBMITTER\n  \n  // Detail panel data - druh vztahu a scope\n  const [relationshipType, setRelationshipType] = useState('prime'); // prime, zastupovani, delegovani, rozsirene\n  const [relationshipScope, setRelationshipScope] = useState('OWN'); // OWN, TEAM, LOCATION, ALL\n  \n  // Detail panel data - template varianty\n  const [templateNormalVariant, setTemplateNormalVariant] = useState('');\n  const [templateUrgentVariant, setTemplateUrgentVariant] = useState('');\n  const [templateInfoVariant, setTemplateInfoVariant] = useState('');\n  const [templatePreviewVariant, setTemplatePreviewVariant] = useState('');\n  \n  // Detail panel data - rove prv pro nadzenho\n  const [permissionLevel, setPermissionLevel] = useState({\n    orders: 'READ_ONLY',       // READ_ONLY, READ_WRITE, READ_WRITE_DELETE, INHERIT\n    invoices: 'READ_ONLY',\n    contracts: 'READ_ONLY',\n    cashbook: 'READ_ONLY'\n  });\n  \n  // Detail panel data - viditelnost modulu\n  const [moduleVisibility, setModuleVisibility] = useState({\n    orders: true,\n    invoices: true,\n    contracts: false,\n    cashbook: true,\n    cashbookReadonly: true\n  });\n  \n  // Sledovn Shift klvesy pro zmnu kurzoru\n  const [isShiftPressed, setIsShiftPressed] = useState(false);\n  \n  // Helper funkce pro CustomSelect\n  const toggleSelect = useCallback((fieldName) => {\n    setSelectStates(prev => ({\n      ...prev,\n      [fieldName]: !prev[fieldName]\n    }));\n  }, []);\n  \n  const closeAllSelects = useCallback(() => {\n    setSelectStates({});\n  }, []);\n  \n  const filterOptions = useCallback((options, searchTerm, fieldName) => {\n    if (!searchTerm) return options;\n    const normalized = searchTerm.toLowerCase().normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\n    return options.filter(option => {\n      const label = option.name || option.label || option.nazev || String(option);\n      const normalizedLabel = label.toLowerCase().normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\n      return normalizedLabel.includes(normalized);\n    });\n  }, []);\n  \n  const getOptionLabel = useCallback((option, fieldName) => {\n    if (fieldName === 'extendedLocations' || fieldName === 'extendedDepartments') {\n      return option.name + (option.code ? ` (${option.code})` : '');\n    }\n    if (fieldName === 'notificationTypes') {\n      return option.name || option.label || String(option);\n    }\n    return option.name || option.label || option.nazev || String(option);\n  }, []);\n  \n  // Detail panel data - rozsirene useky\n  const [selectedExtendedDepartments, setSelectedExtendedDepartments] = useState([]);\n  \n  // Detail panel data - kombinace lokalita+utvar\n  const [selectedCombinations, setSelectedCombinations] = useState([]);\n  \n  // State management pro CustomSelect komponenty (multiselect)\n  const [selectStates, setSelectStates] = useState({});\n  const [searchStates, setSearchStates] = useState({});\n  const [touchedSelectFields, setTouchedSelectFields] = useState({});\n  \n  // Profily organizacnich radu\n  const [profiles, setProfiles] = useState([]);\n  const [currentProfile, setCurrentProfile] = useState(null);\n  const [showProfileDialog, setShowProfileDialog] = useState(false);\n  const [profileDialogMode, setProfileDialogMode] = useState('save'); // 'save' or 'saveAs'\n  \n  // Auto-save rozsirenych lokalit, useku, kombinaci, notifikaci, typu vztahu, scope, modulu a permission level do edge\n  React.useEffect(() => {\n    if (selectedEdge) {\n      setEdges((eds) =>\n        eds.map((e) => {\n          if (e.id === selectedEdge.id) {\n            return {\n              ...e,\n              data: {\n                ...e.data,\n                // Druh vztahu a scope (pro DB)\n                relationshipType: relationshipType,\n                druh_vztahu: relationshipType, // alias pro DB\n                scope: relationshipScope,\n                // Viditelnost modulu (pro DB)\n                modules: moduleVisibility,\n                // rove prv pro kad modul (pro DB)\n                permissionLevel: permissionLevel,\n                // Rozsirene lokality/useky/kombinace\n                extended: {\n                  locations: selectedExtendedLocations,\n                  departments: selectedExtendedDepartments,\n                  combinations: selectedCombinations\n                },\n                // Notifikace\n                notifications: {\n                  ...(e.data?.notifications || {}),\n                  types: selectedNotificationTypes,\n                  email: notificationEmailEnabled,\n                  inapp: notificationInAppEnabled,\n                  recipientRole: notificationRecipientRole\n                }\n              }\n            };\n          }\n          return e;\n        })\n      );\n    }\n  }, [\n    selectedExtendedLocations, \n    selectedExtendedDepartments, \n    selectedCombinations, \n    selectedNotificationTypes, \n    notificationEmailEnabled, \n    notificationInAppEnabled,\n    notificationRecipientRole,\n    relationshipType,\n    relationshipScope,\n    moduleVisibility,\n    permissionLevel,\n    selectedEdge\n  ]);\n  \n  // Auto-save template variant do node\n  React.useEffect(() => {\n    if (selectedNode && selectedNode.data?.type === 'template') {\n      setNodes((nds) =>\n        nds.map((n) => {\n          if (n.id === selectedNode.id) {\n            return {\n              ...n,\n              data: {\n                ...n.data,\n                normalVariant: templateNormalVariant,\n                urgentVariant: templateUrgentVariant,\n                infoVariant: templateInfoVariant,\n                previewVariant: templatePreviewVariant\n              }\n            };\n          }\n          return n;\n        })\n      );\n    }\n  }, [templateNormalVariant, templateUrgentVariant, templateInfoVariant, templatePreviewVariant, selectedNode]);\n  \n  // Selection state pro levy panel (checkboxy)\n  const [selectedUsers, setSelectedUsers] = useState(new Set());\n  const [selectedRoles, setSelectedRoles] = useState(new Set());\n  const [selectedLocations, setSelectedLocations] = useState(new Set());\n  const [selectedDepartments, setSelectedDepartments] = useState(new Set());\n  const [selectedNotificationTemplates, setSelectedNotificationTemplates] = useState(new Set());\n  \n  // Confirm dialog state\n  const [confirmDialog, setConfirmDialog] = useState({\n    isOpen: false,\n    title: '',\n    message: '',\n    onConfirm: null\n  });\n  \n  // UI state\n  const [showHelp, setShowHelp] = useState(() => {\n    const saved = localStorage.getItem('hierarchy_help_collapsed');\n    return saved ? saved === 'false' : true; // Default: zobrazit\n  });\n  \n  const [showDetailHelpModal, setShowDetailHelpModal] = useState(false);\n  const [showFullscreenEmailModal, setShowFullscreenEmailModal] = useState(false);\n  const [fullscreenEmailData, setFullscreenEmailData] = useState(null);\n  \n  // Custom dialog state\n  const [dialog, setDialog] = useState({\n    show: false,\n    type: 'confirm', // 'confirm' | 'alert' | 'success'\n    icon: '',\n    title: '',\n    message: '',\n    onConfirm: null,\n    onCancel: null,\n    confirmText: 'Pokraovat',\n    cancelText: 'Zruit',\n    stats: null\n  });\n\n  // LocalStorage keys pro persistenci\n  const LS_NODES_KEY = 'hierarchy_draft_nodes';\n  const LS_EDGES_KEY = 'hierarchy_draft_edges';\n  const LS_TIMESTAMP_KEY = 'hierarchy_draft_timestamp';\n  const LS_PROFILE_KEY = 'hierarchy_selected_profile';\n  const LS_SEARCH_USERS = 'hierarchy_search_users';\n  const LS_SEARCH_LOCATIONS = 'hierarchy_search_locations';\n  const LS_SEARCH_DEPARTMENTS = 'hierarchy_search_departments';\n  const LS_SEARCH_TEMPLATES = 'hierarchy_search_templates';\n  const LS_EXPANDED_SECTIONS = 'hierarchy_expanded_sections';\n\n  // State pro sledovn, zda byl draft naten\n  const [hasDraft, setHasDraft] = useState(false);\n\n  // Auto-save search terms do localStorage\n  useEffect(() => {\n    localStorage.setItem('hierarchy_search_users', searchUsers);\n  }, [searchUsers]);\n  \n  useEffect(() => {\n    localStorage.setItem('hierarchy_search_locations', searchLocations);\n  }, [searchLocations]);\n  \n  useEffect(() => {\n    localStorage.setItem('hierarchy_search_departments', searchDepartments);\n  }, [searchDepartments]);\n  \n  useEffect(() => {\n    localStorage.setItem('hierarchy_search_templates', searchTemplates);\n  }, [searchTemplates]);\n  \n  // Auto-save expanded sections do localStorage\n  useEffect(() => {\n    localStorage.setItem('hierarchy_expanded_sections', JSON.stringify(expandedSections));\n  }, [expandedSections]);\n\n  // Auto-save do localStorage pi zmn nodes/edges\n  useEffect(() => {\n    if (nodes.length > 0 || edges.length > 0) {\n      try {\n        localStorage.setItem(LS_NODES_KEY, JSON.stringify(nodes));\n        localStorage.setItem(LS_EDGES_KEY, JSON.stringify(edges));\n        localStorage.setItem(LS_TIMESTAMP_KEY, new Date().toISOString());\n      } catch (err) {\n        console.warn('Failed to save draft:', err);\n      }\n    }\n  }, [nodes, edges]);\n\n  // Handler pro smazn vybranch nodes/edges pomoc DELETE klvesy\n  const handleDeleteSelected = useCallback(() => {\n    const selectedNodes = nodes.filter(n => n.selected);\n    const selectedEdges = edges.filter(e => e.selected);\n    \n    if (selectedNodes.length === 0 && selectedEdges.length === 0) {\n      return; // Nic nen vybrno\n    }\n\n    // Zobrazit custom confirm dialog\n    setDialog({\n      show: true,\n      type: 'confirm',\n      icon: '',\n      title: 'Smazat vybran prvky?',\n      message: `Opravdu chcete smazat ${selectedNodes.length} uzl a ${selectedEdges.length} vztah?`,\n      confirmText: 'Smazat',\n      cancelText: 'Zruit',\n      onConfirm: () => {\n        // Smazat vybran nodes\n        if (selectedNodes.length > 0) {\n          const nodeIdsToDelete = selectedNodes.map(n => n.id);\n          setNodes(nds => nds.filter(n => !nodeIdsToDelete.includes(n.id)));\n          // Smazat i edges spojen s tmito nodes\n          setEdges(eds => eds.filter(e => \n            !nodeIdsToDelete.includes(e.source) && \n            !nodeIdsToDelete.includes(e.target)\n          ));\n        }\n        \n        // Smazat vybran edges\n        if (selectedEdges.length > 0) {\n          const edgeIdsToDelete = selectedEdges.map(e => e.id);\n          setEdges(eds => eds.filter(e => !edgeIdsToDelete.includes(e.id)));\n        }\n        \n        setDialog({ ...dialog, show: false });\n        console.log(` Deleted ${selectedNodes.length} nodes and ${selectedEdges.length} edges`);\n      },\n      onCancel: () => {\n        setDialog({ ...dialog, show: false });\n      }\n    });\n  }, [nodes, edges, setNodes, setEdges, dialog]);\n\n  // Keyboard listener pro DELETE klvesu\n  useEffect(() => {\n    const handleKeyDown = (event) => {\n      // Delete nebo Backspace (na Macu)\n      if (event.key === 'Delete' || (event.key === 'Backspace' && event.metaKey)) {\n        event.preventDefault();\n        handleDeleteSelected();\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [handleDeleteSelected]);\n\n  // Shift key listener pro zmnu kurzoru na crosshair pi selection mode\n  useEffect(() => {\n    const handleKeyDown = (event) => {\n      if (event.key === 'Shift' && !isShiftPressed) {\n        setIsShiftPressed(true);\n      }\n    };\n\n    const handleKeyUp = (event) => {\n      if (event.key === 'Shift') {\n        setIsShiftPressed(false);\n      }\n    };\n\n    // Reset pi ztrt focusu (nap. ALT+TAB)\n    const handleBlur = () => {\n      setIsShiftPressed(false);\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    window.addEventListener('keyup', handleKeyUp);\n    window.addEventListener('blur', handleBlur);\n    \n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n      window.removeEventListener('keyup', handleKeyUp);\n      window.removeEventListener('blur', handleBlur);\n    };\n  }, [isShiftPressed]);\n\n  // Load data from API\n  useEffect(() => {\n    const loadHierarchyData = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n\n        // 1. NEJDVE zkontrolovat localStorage draft\n        let draftLoaded = false;\n        try {\n          const savedNodes = localStorage.getItem(LS_NODES_KEY);\n          const savedEdges = localStorage.getItem(LS_EDGES_KEY);\n          const savedTimestamp = localStorage.getItem(LS_TIMESTAMP_KEY);\n          \n          if (savedNodes && savedEdges && savedTimestamp) {\n            const timestamp = new Date(savedTimestamp);\n            const hoursSince = (Date.now() - timestamp.getTime()) / (1000 * 60 * 60);\n            \n            // Nast pouze pokud je draft mlad ne 24 hodin\n            if (hoursSince < 24) {\n              const parsedNodes = JSON.parse(savedNodes);\n              const parsedEdges = JSON.parse(savedEdges);\n              \n              if (parsedNodes.length > 0 || parsedEdges.length > 0) {\n                draftLoaded = true;\n                setHasDraft(true);\n                setNodes(parsedNodes);\n                setEdges(parsedEdges);\n              }\n            } else {\n              localStorage.removeItem(LS_NODES_KEY);\n              localStorage.removeItem(LS_EDGES_KEY);\n              localStorage.removeItem(LS_TIMESTAMP_KEY);\n            }\n          }\n        } catch (err) {\n          console.warn('Failed to restore draft:', err);\n        }\n\n        // 2. Nast token a user data\n        const token = await loadAuthData.token();\n        const userData = await loadAuthData.user();\n        const username = userData?.username || localStorage.getItem('username');\n\n        const apiBase = process.env.REACT_APP_API2_BASE_URL || '/api.eeo';\n\n        // POST requesty pro PHP API\n        const fetchData = async (endpoint) => {\n          const response = await fetch(`${apiBase}/${endpoint}`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ token, username })\n          });\n          if (!response.ok) {\n            throw new Error(`HTTP ${response.status}: ${endpoint}`);\n          }\n          return response.json();\n        };\n\n        // 3. Paraleln naten dat (BEZ struktury - tu nateme a po zjitn profilu)\n        const [usersData, rolesData, locationsData, departmentsData, profilesData, notifTypesData, templatesData] = await Promise.all([\n          fetchData('hierarchy/users'),\n          fetchData('ciselniky/role/list'),\n          fetchData('hierarchy/locations'),\n          fetchData('hierarchy/departments'),\n          fetchData('hierarchy/profiles/list'),\n          fetchData('hierarchy/notification-types'),\n          fetchData('notifications/templates/list')\n        ]);\n\n        const users = usersData.data || [];\n        const roles = rolesData.data || [];\n        \n        // Spotat poet uivatel pro kadou roli (z pole user.roles)\n        const rolesWithUserCount = roles.map(role => {\n          const userCount = users.filter(user => {\n            // Kontrola, jestli uivatel m tuto roli piazenou (user.roles je pole ID)\n            return user.roles && Array.isArray(user.roles) && user.roles.includes(role.id);\n          }).length;\n          \n          return {\n            ...role,\n            userCount: userCount\n          };\n        });\n        \n        setAllUsers(users);\n        setAllRoles(rolesWithUserCount);\n        setAllLocations(locationsData.data || []);\n        setAllDepartments(departmentsData.data || []);\n        setNotificationTypes(notifTypesData.data || []);\n        setAllNotificationTemplates(templatesData.data || []);\n        \n        // Nastavit profily a najt aktivn\n        const profilesList = profilesData.data || [];\n        setProfiles(profilesList);\n        \n        //  PRIORITA: Nast z Global Settings (DB) - to je zdroj pravdy!\n        let selectedProfile = null;\n        \n        // 1. Zkus nast z global settings API\n        try {\n          const { getGlobalSettings } = await import('../services/globalSettingsApi');\n          const globalSettings = await getGlobalSettings(token, username);\n          \n          if (globalSettings.hierarchy_profile_id) {\n            selectedProfile = profilesList.find(p => p.id === parseInt(globalSettings.hierarchy_profile_id));\n          }\n        } catch (err) {\n          console.warn(' Failed to load profile from Global Settings:', err);\n        }\n        \n        // 2. Fallback: Pout aktivn profil\n        if (!selectedProfile) {\n          selectedProfile = profilesList.find(p => p.isActive) || profilesList[0];\n          console.log(' Using fallback profile (active or first):', selectedProfile?.name);\n        }\n        \n        setCurrentProfile(selectedProfile || null);\n        \n        \n        //  TE nast strukturu s profilId\n        let structureData = { success: true, data: { nodes: [], relations: [] } };\n        if (selectedProfile) {\n          structureData = await fetch(`${API_BASE_URL}/hierarchy/structure`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ token, username, profilId: selectedProfile.id })\n          }).then(r => r.json());\n        }\n        \n        \n        //  DEBUG: Detailn vpis struktury\n        \n        // DLEIT: Pokud je draft, ale struktura z API m data, preferovat API data\n        // Draft je jen pro doasn zmny, ne pro perzistentn uloen\n        // V2 API vrac 'relations' msto 'edges'\n        const shouldLoadFromApi = structureData.data && structureData.data.relations && structureData.data.relations.length > 0;\n        \n        if (shouldLoadFromApi) {\n        }\n\n        // 4. Nastavit hierarchickou strukturu z API V2 (preferovat API ped draftem)\n        if (shouldLoadFromApi) {\n          \n          //  DEBUG: Vpis cel struktury\n          console.log(' Structure data.data:', structureData?.data);\n          console.log(' Structure data.data.nodes:', structureData?.data?.nodes);\n          console.log(' Structure data.data.relations:', structureData?.data?.relations);\n          \n          // V2 API vrac { nodes, relations } msto { nodes, edges }\n          const apiNodes = Array.isArray(structureData?.data?.nodes) ? structureData.data.nodes : [];\n          const apiRelations = Array.isArray(structureData?.data?.relations) ? structureData.data.relations : [];\n          \n          \n          if (apiNodes.length === 0 && apiRelations.length === 0) {\n            console.warn(' Empty structure data from API - will exit early');\n            setLoading(false);\n            return;\n          }\n\n          const timestamp = Date.now();\n          \n          // Konvertovat API nodes na ReactFlow nodes\n          const flowNodes = apiNodes.map((node, index) => {\n            let nodeId, nodeData;\n            \n            if (node.type === 'user') {\n              nodeId = `user-${node.userId}-${timestamp}-${index}`;\n              nodeData = {\n                userId: String(node.userId),\n                name: node.name,\n                position: node.position,\n                initials: node.initials,\n                type: 'user',\n                metadata: node.metadata || {\n                  location: null,\n                  department: null\n                }\n              };\n            } else if (node.type === 'location') {\n              nodeId = `location-${node.locationId}-${timestamp}-${index}`;\n              nodeData = {\n                locationId: node.locationId,\n                name: node.name,\n                type: 'location'\n              };\n            } else if (node.type === 'department') {\n              nodeId = `department-${node.departmentId}-${timestamp}-${index}`;\n              nodeData = {\n                departmentId: node.departmentId,\n                name: node.name,\n                type: 'department'\n              };\n            } else if (node.type === 'template') {\n              nodeId = `template-${node.templateId}-${timestamp}-${index}`;\n              nodeData = {\n                templateId: node.templateId,\n                name: node.name,\n                position: 'Notifikan ablona',\n                initials: '',\n                type: 'template',\n                // Nast template varianty z node.settings (pokud existuj)\n                normalVariant: node.settings?.normalVariant || '',\n                urgentVariant: node.settings?.urgentVariant || '',\n                infoVariant: node.settings?.infoVariant || '',\n                previewVariant: node.settings?.previewVariant || '',\n                metadata: {\n                  type: 'template',\n                  template: node.name\n                }\n              };\n            } else if (node.type === 'role') {\n              nodeId = `role-${node.roleId}-${timestamp}-${index}`;\n              nodeData = {\n                roleId: node.roleId,\n                name: node.name,\n                type: 'role',\n                metadata: {\n                  type: 'role',\n                  popis: node.popis || '',\n                  userCount: node.userCount || 0\n                }\n              };\n            }\n            \n            return {\n              id: nodeId,\n              type: 'custom',\n              position: node.position_1 || node.position_2 || { x: 100 + (index % 4) * 250, y: 50 + Math.floor(index / 4) * 200 },\n              data: nodeData\n            };\n          });\n          \n          // Funkce pro uren barvy vztahu podle typu\n          const getEdgeColor = (relationType) => {\n            if (relationType.includes('template')) {\n              return '#f59e0b'; // Oranov pro notifikan ablony\n            } else if (relationType.includes('role')) {\n              return '#8b5cf6'; // Fialov pro role\n            } else if (relationType.includes('location')) {\n              return '#92400e'; // Tmav hnd pro lokality\n            } else if (relationType.includes('department')) {\n              return '#059669'; // Tmav zelen pro tvary\n            } else if (relationType === 'user-user') {\n              return '#3b82f6'; // Modr pro uivatel-uivatel\n            }\n            return '#3b82f6'; // Vchoz modr\n          };\n\n          // Konvertovat relations na ReactFlow edges\n          const flowEdges = apiRelations.map((rel, index) => {\n            // Najt source a target nodes podle typu vztahu\n            let sourceNode, targetNode;\n            \n            const relType = rel.type; // 'user-user', 'location-user', etc.\n            const [sourceType, targetType] = relType.split('-');\n            \n            // Najt source node\n            if (sourceType === 'user') {\n              sourceNode = flowNodes.find(n => n.data.userId === String(rel.user_id_1));\n            } else if (sourceType === 'role') {\n              sourceNode = flowNodes.find(n => n.data.roleId === rel.role_id);\n            } else if (sourceType === 'location') {\n              sourceNode = flowNodes.find(n => n.data.locationId === rel.lokalita_id);\n            } else if (sourceType === 'department') {\n              sourceNode = flowNodes.find(n => n.data.departmentId === rel.usek_id);\n            } else if (sourceType === 'template') {\n              sourceNode = flowNodes.find(n => n.data.templateId === rel.template_id);\n            }\n            \n            // Najt target node\n            if (targetType === 'user') {\n              targetNode = flowNodes.find(n => n.data.userId === String(rel.user_id_2 || rel.user_id_1));\n            } else if (targetType === 'role') {\n              targetNode = flowNodes.find(n => n.data.roleId === rel.role_id);\n            } else if (targetType === 'location') {\n              targetNode = flowNodes.find(n => n.data.locationId === rel.lokalita_id);\n            } else if (targetType === 'department') {\n              targetNode = flowNodes.find(n => n.data.departmentId === rel.usek_id);\n            } else if (targetType === 'template') {\n              targetNode = flowNodes.find(n => n.data.templateId === rel.template_id);\n            }\n            \n            if (!sourceNode || !targetNode) {\n              console.warn(' Relation node not found:', rel);\n              return null;\n            }\n            \n            // Aplikovat pozice z relations\n            if (rel.position_1) {\n              sourceNode.position = rel.position_1;\n            }\n            if (rel.position_2) {\n              targetNode.position = rel.position_2;\n            }\n            \n            const edgeColor = getEdgeColor(relType);\n            \n            // Mapovat level zpt na scope: 1=OWN, 2=TEAM, 3=LOCATION, 4=ALL\n            const levelToScope = { 1: 'OWN', 2: 'TEAM', 3: 'LOCATION', 4: 'ALL' };\n            const edgeScope = levelToScope[rel.level] || 'OWN';\n            \n            return {\n              id: `rel-${rel.id || index}`,\n              source: sourceNode.id,\n              target: targetNode.id,\n              type: 'smoothstep',\n              animated: true,\n              markerEnd: { \n                type: MarkerType.ArrowClosed,\n                color: edgeColor \n              },\n              style: { \n                stroke: edgeColor, \n                strokeWidth: 3 \n              },\n              data: {\n                level: rel.level,\n                scope: edgeScope,\n                // Typ vztahu\n                relationshipType: rel.relationshipType || rel.druh_vztahu || 'prime',\n                druh_vztahu: rel.relationshipType || rel.druh_vztahu || 'prime',\n                // Viditelnost a moduly\n                visibility: rel.visibility || {},\n                modules: rel.modules || {},\n                // rove prv\n                permissionLevel: rel.permissionLevel || {},\n                // Rozen lokality/tvary/kombinace\n                extended: rel.extended || {\n                  locations: [],\n                  departments: [],\n                  combinations: []\n                },\n                // Notifikace\n                notifications: rel.notifications || {\n                  email: false,\n                  inapp: true,\n                  types: [],\n                  recipientRole: 'APPROVAL'\n                },\n                // Typ vztahu pro React Flow\n                type: relType\n              }\n            };\n          }).filter(e => e !== null);\n          \n          setNodes(flowNodes);\n          setEdges(flowEdges);\n          \n          // Pokud jsme nactli z API, vymazat draft\n          localStorage.removeItem(LS_NODES_KEY);\n          localStorage.removeItem(LS_EDGES_KEY);\n          localStorage.removeItem(LS_TIMESTAMP_KEY);\n          setHasDraft(false);\n        } else if (draftLoaded) {\n          console.log(' Using draft from localStorage');\n        } else {\n          console.log(' No data to load - empty profile');\n        }\n\n        setLoading(false);\n      } catch (err) {\n        console.error('Error loading hierarchy:', err);\n        setError(err.message);\n        setLoading(false);\n      }\n    };\n\n    loadHierarchyData();\n  }, []);\n\n  //  Auto-reload pi zmn profilu\n  useEffect(() => {\n    if (currentProfile && currentProfile.id) {\n      \n      // Reload by triggering the main load - just clear nodes/edges\n      // Main useEffect will reload on mount\n      setNodes([]);\n      setEdges([]);\n      setLoading(true);\n      \n      // Note: Actual reload happens in main useEffect on []\n      // This just signals UI that we're loading\n      setTimeout(() => setLoading(false), 500);\n    }\n  }, [currentProfile?.id]);\n\n  //  Auto-fit graf po naten nodes\n  useEffect(() => {\n    if (nodes.length > 0 && reactFlowInstance) {\n      // Pokat na render a pak fitView\n      setTimeout(() => {\n        reactFlowInstance.fitView({ padding: 0.2, duration: 400 });\n      }, 100);\n    }\n  }, [nodes.length, reactFlowInstance]);\n\n  const onConnect = useCallback((params) => {\n    // Urit typ vztahu a barvu podle source a target nodes\n    const sourceNode = nodes.find(n => n.id === params.source);\n    const targetNode = nodes.find(n => n.id === params.target);\n    \n    let relationType = 'user-user';\n    if (sourceNode && targetNode) {\n      const sourceType = sourceNode.data?.type || 'user';\n      const targetType = targetNode.data?.type || 'user';\n      relationType = `${sourceType}-${targetType}`;\n    }\n    \n    // Urit barvu podle typu (podle legendy)\n    let edgeColor = '#3b82f6'; // vchoz modr\n    if (relationType.includes('template')) {\n      edgeColor = '#f59e0b'; // Oranov pro notifikace (podle legendy)\n    } else if (relationType.includes('role')) {\n      edgeColor = '#8b5cf6'; // Fialov pro role (podle legendy)\n    } else if (relationType.includes('location')) {\n      edgeColor = '#92400e'; // Tmav hnd pro lokality (podle legendy)\n    } else if (relationType.includes('department')) {\n      edgeColor = '#059669'; // Tmav zelen pro seky (podle legendy)\n    } else if (relationType === 'user-user') {\n      edgeColor = '#3b82f6'; // Modr pro uivatel-uivatel (podle legendy)\n    }\n    \n    setEdges((eds) => addEdge({\n      ...params,\n      type: 'smoothstep',\n      animated: true,\n      markerEnd: { \n        type: MarkerType.ArrowClosed,\n        color: edgeColor \n      },\n      style: { \n        stroke: edgeColor, \n        strokeWidth: 3 \n      },\n      data: {\n        type: relationType\n      }\n    }, eds));\n  }, [nodes]);\n\n  // Aktualizovat poty uivatel u rol, lokalit a sek po zmn edges\n  useEffect(() => {\n    setNodes((nds) =>\n      nds.map((node) => {\n        const nodeType = node.data?.type;\n        \n        // Potat pouze pro role, lokality a seky\n        if (nodeType === 'role' || nodeType === 'location' || nodeType === 'department') {\n          // Najt vechny edges smujc k tomuto nodu (target)\n          const connectedEdges = edges.filter(e => e.target === node.id);\n          \n          // Spotat uniktn uivatele pipojen k tomuto nodu\n          const connectedUserNodes = connectedEdges\n            .map(e => nodes.find(n => n.id === e.source))\n            .filter(n => n?.data?.type === 'user');\n          \n          const userCount = connectedUserNodes.length;\n          \n          // Aktualizovat metadata s potem\n          return {\n            ...node,\n            data: {\n              ...node.data,\n              metadata: {\n                ...node.data.metadata,\n                userCount: userCount\n              }\n            }\n          };\n        }\n        \n        return node;\n      }));\n  }, [edges, nodes.length]); // Zvislost na edges a potu nodes (ne na nodes samotnch, aby se zabrnilo nekonen smyce)\n\n  const onNodeClick = useCallback((event, node) => {\n    // Pokud nen CTRL/CMD, zobrazit detail panel (single selection)\n    if (!event.ctrlKey && !event.metaKey) {\n      setSelectedNode(node);\n      setSelectedEdge(null);\n      setShowDetailPanel(true);\n      \n      // Nast template varianty pokud je to template node\n      if (node.data?.type === 'template') {\n        setTemplateNormalVariant(node.data.normalVariant || '');\n        setTemplateUrgentVariant(node.data.urgentVariant || '');\n        setTemplateInfoVariant(node.data.infoVariant || '');\n        setTemplatePreviewVariant(node.data.previewVariant || node.data.normalVariant || '');\n      }\n    } else {\n      // Multi-select - skrt detail panel\n      setShowDetailPanel(false);\n      setSelectedNode(null);\n      setSelectedEdge(null);\n    }\n  }, []);\n\n  const onEdgeClick = useCallback((event, edge) => {\n    setSelectedEdge(edge);\n    setSelectedNode(null);\n    setShowDetailPanel(true);\n    \n    // Najit source a target nodes pro zobrazeni jmen\n    const sourceNode = nodes.find(n => n.id === edge.source);\n    const targetNode = nodes.find(n => n.id === edge.target);\n    \n    // Nacist rozsirene lokality z edge data\n    const extendedLocs = edge.data?.extended?.locations || edge.data?.permissions?.extended?.locations || [];\n    setSelectedExtendedLocations(extendedLocs);\n    \n    // Nacist rozsirene useky z edge data\n    const extendedDepts = edge.data?.extended?.departments || edge.data?.permissions?.extended?.departments || [];\n    setSelectedExtendedDepartments(extendedDepts);\n    \n    // Nacist notifikacni nastaveni z edge data\n    setNotificationEmailEnabled(edge.data?.notifications?.email || false);\n    setNotificationInAppEnabled(edge.data?.notifications?.inapp !== false);\n      setNotificationRecipientRole(edge.data?.notifications?.recipientRole || 'APPROVAL');    // Nacist druh vztahu a scope z edge data\n    setRelationshipType(edge.data?.relationshipType || edge.data?.druh_vztahu || 'prime');\n    setRelationshipScope(edge.data?.scope || 'OWN');\n    \n    // Nacist viditelnost modulu z edge data (zkontrolovat modules i visibility)\n    setModuleVisibility({\n      orders: edge.data?.modules?.orders ?? edge.data?.visibility?.objednavky ?? false,\n      invoices: edge.data?.modules?.invoices ?? edge.data?.visibility?.faktury ?? false,\n      contracts: edge.data?.modules?.contracts ?? edge.data?.visibility?.smlouvy ?? false,\n      cashbook: edge.data?.modules?.cashbook ?? edge.data?.visibility?.pokladna ?? false,\n      cashbookReadonly: edge.data?.modules?.cashbookReadonly ?? false,\n      users: edge.data?.modules?.users ?? edge.data?.visibility?.uzivatele ?? false,\n      lp: edge.data?.modules?.lp ?? edge.data?.visibility?.lp ?? false\n    });\n    \n    // Nacist uroven prav z edge data\n    setPermissionLevel({\n      orders: edge.data?.permissionLevel?.orders || 'READ_ONLY',\n      invoices: edge.data?.permissionLevel?.invoices || 'READ_ONLY',\n      contracts: edge.data?.permissionLevel?.contracts || 'READ_ONLY',\n      cashbook: edge.data?.permissionLevel?.cashbook || 'READ_ONLY'\n    });\n    \n    // Nacist kombinace lokalita+utvar z edge data\n    const combos = edge.data?.extended?.combinations || edge.data?.permissions?.extended?.combinations || [];\n    setSelectedCombinations(combos);\n    \n    // Nacist typy notifikaci z edge data\n    const notifTypes = edge.data?.notifications?.types || edge.data?.permissions?.notifications?.types || [];\n    setSelectedNotificationTypes(notifTypes);\n    \n    // Pridat metadata k edge pro zobrazeni\n    setSelectedEdge({\n      ...edge,\n      metadata: {\n        sourceName: sourceNode?.data?.name || 'Neznamy',\n        targetName: targetNode?.data?.name || 'Neznamy',\n        sourceType: sourceNode?.data?.metadata?.type || sourceNode?.data?.type || 'user',\n        targetType: targetNode?.data?.metadata?.type || targetNode?.data?.type || 'user'\n      }\n    });\n  }, [nodes]);\n  \n  // Helper funkce pro uren typu vztahu\n  const getRelationshipTypeInfo = useCallback((sourceType, targetType) => {\n    const types = {\n      'user-user': {\n        label: 'Uivatel  Uivatel',\n        icon: '',\n        description: 'Klasick nadzen-podzen vztah',\n        sourceLabel: 'Nadzen (zskv prva)',\n        targetLabel: 'Podzen (sdl data)',\n        showScope: true,\n        showExtended: true,\n        showModules: true,\n        explanation: (source, target) => `${source} zsk prva vidt data od ${target} podle nastaven rozsahu a modul.`\n      },\n      'location-user': {\n        label: 'Lokalita  Uivatel',\n        icon: '',\n        description: 'Vichni uivatel z lokality sdl data nadzenmu',\n        sourceLabel: 'Lokalita (zdroj dat)',\n        targetLabel: 'Nadzen uivatel (zskv data)',\n        showScope: false, // Scope je implicitn LOCATION\n        showExtended: false,\n        showModules: true,\n        explanation: (source, target) => `${target} zsk prva vidt data od VECH uivatel v lokalit ${source}.`\n      },\n      'user-location': {\n        label: 'Uivatel  Lokalita',\n        icon: '',\n        description: 'Nadzen vid vechny uivatele v lokalit',\n        sourceLabel: 'Nadzen uivatel (zskv prva)',\n        targetLabel: 'Lokalita (zdroj dat)',\n        showScope: false, // Scope je implicitn LOCATION\n        showExtended: true,\n        showModules: true,\n        explanation: (source, target) => `${source} zsk prva vidt data od VECH uivatel v lokalit ${target}.`\n      },\n      'department-user': {\n        label: 'sek  Uivatel',\n        icon: '',\n        description: 'Vichni uivatel z seku sdl data nadzenmu',\n        sourceLabel: 'sek (zdroj dat)',\n        targetLabel: 'Nadzen uivatel (zskv data)',\n        showScope: false, // Scope je implicitn TEAM\n        showExtended: false,\n        showModules: true,\n        explanation: (source, target) => `${target} zsk prva vidt data od VECH uivatel v seku ${source}.`\n      },\n      'user-department': {\n        label: 'Uivatel  sek',\n        icon: '',\n        description: 'Nadzen vid vechny uivatele v seku',\n        sourceLabel: 'Nadzen uivatel (zskv prva)',\n        targetLabel: 'sek (zdroj dat)',\n        showScope: false, // Scope je implicitn TEAM\n        showExtended: true,\n        showModules: true,\n        explanation: (source, target) => `${source} zsk prva vidt data od VECH uivatel v seku ${target}.`\n      },\n      'template-user': {\n        label: 'Notifikan ablona  Uivatel',\n        icon: '',\n        description: 'Uivatel bude dostvat notifikace z tto ablony',\n        sourceLabel: 'Notifikan ablona',\n        targetLabel: 'Pjemce (uivatel)',\n        showScope: false,\n        showExtended: false,\n        showModules: false,\n        explanation: (source, target) => `${target} bude dostvat notifikace typu \"${source}\".`\n      },\n      'template-location': {\n        label: 'Notifikan ablona  Lokalita',\n        icon: '',\n        description: 'Vichni uivatel v lokalit budou dostvat notifikace',\n        sourceLabel: 'Notifikan ablona',\n        targetLabel: 'Pjemci (lokalita)',\n        showScope: false,\n        showExtended: false,\n        showModules: false,\n        explanation: (source, target) => `VICHNI uivatel v lokalit ${target} budou dostvat notifikace typu \"${source}\".`\n      },\n      'template-department': {\n        label: 'Notifikan ablona  sek',\n        icon: '',\n        description: 'Vichni uivatel v seku budou dostvat notifikace',\n        sourceLabel: 'Notifikan ablona',\n        targetLabel: 'Pjemci (sek)',\n        showScope: false,\n        showExtended: false,\n        showModules: false,\n        explanation: (source, target) => `VICHNI uivatel v seku ${target} budou dostvat notifikace typu \"${source}\".`\n      },\n      'user-role': {\n        label: 'Uivatel  Role',\n        icon: '',\n        description: 'Uivatel zskv oprvnn z role',\n        sourceLabel: 'Uivatel (pjemce prv)',\n        targetLabel: 'Role (zdroj oprvnn)',\n        showScope: false,\n        showExtended: false,\n        showModules: true,\n        explanation: (source, target) => `${source} m piazenou roli ${target} a zskv z n oprvnn pro moduly.`\n      },\n      'role-user': {\n        label: 'Role  Uivatel',\n        icon: '',\n        description: 'Role piazuje oprvnn uivateli',\n        sourceLabel: 'Role (zdroj oprvnn)',\n        targetLabel: 'Uivatel (pjemce prv)',\n        showScope: false,\n        showExtended: false,\n        showModules: true,\n        explanation: (source, target) => `Role ${source} piazuje oprvnn uivateli ${target}.`\n      },\n      'template-role': {\n        label: 'Notifikan ablona  Role',\n        icon: '',\n        description: 'Vichni uivatel s rol budou dostvat notifikace',\n        sourceLabel: 'Notifikan ablona',\n        targetLabel: 'Pjemci (role)',\n        showScope: false,\n        showExtended: false,\n        showModules: false,\n        explanation: (source, target) => `VICHNI uivatel s rol ${target} budou dostvat notifikace typu \"${source}\".`\n      },\n      'department-role': {\n        label: 'sek  Role',\n        icon: '',\n        description: 'Uivatel s danou rol v seku zskvaj viditelnost dat',\n        sourceLabel: 'sek (zdroj dat)',\n        targetLabel: 'Role (zskv prva)',\n        showScope: true,\n        showExtended: false,\n        showModules: true,\n        explanation: (source, target) => `Vichni uivatel s rol ${target} zskaj prva vidt data z seku ${source}.`\n      },\n      'role-department': {\n        label: 'Role  sek',\n        icon: '',\n        description: 'Role zskv viditelnost dat z seku',\n        sourceLabel: 'Role (zskv prva)',\n        targetLabel: 'sek (zdroj dat)',\n        showScope: true,\n        showExtended: false,\n        showModules: true,\n        explanation: (source, target) => `Uivatel s rol ${source} zskaj prva vidt data z seku ${target}.`\n      },\n      'location-role': {\n        label: 'Lokalita  Role',\n        icon: '',\n        description: 'Uivatel s danou rol v lokalit zskvaj viditelnost dat',\n        sourceLabel: 'Lokalita (zdroj dat)',\n        targetLabel: 'Role (zskv prva)',\n        showScope: true,\n        showExtended: false,\n        showModules: true,\n        explanation: (source, target) => `Vichni uivatel s rol ${target} zskaj prva vidt data z lokality ${source}.`\n      },\n      'role-location': {\n        label: 'Role  Lokalita',\n        icon: '',\n        description: 'Role zskv viditelnost dat z lokality',\n        sourceLabel: 'Role (zskv prva)',\n        targetLabel: 'Lokalita (zdroj dat)',\n        showScope: true,\n        showExtended: false,\n        showModules: true,\n        explanation: (source, target) => `Uivatel s rol ${source} zskaj prva vidt data z lokality ${target}.`\n      },\n      'role-role': {\n        label: 'Role  Role',\n        icon: '',\n        description: 'Hierarchick vztah mezi rolemi (nadzen  podzen)',\n        sourceLabel: 'Nadzen role (zskv prva)',\n        targetLabel: 'Podzen role (sdl data)',\n        showScope: true,\n        showExtended: true,\n        showModules: true,\n        explanation: (source, target) => `${source} zsk prva vidt data od uivatel s rol ${target}. Rozsah a Moduly uruj, co pesn uvid (objednvky/faktury/pokladnu).`\n      }\n    };\n    \n    const key = `${sourceType}-${targetType}`;\n    return types[key] || types['user-user']; // Fallback na user-user\n  }, []);\n\n  // Handler pro automatick uloen layout pozic po petaen uzlu\n  const onNodeDragStop = useCallback(async (event, node) => {\n    console.log(' Node drag stopped:', node.id, 'Position:', node.position);\n    \n    // Aktualizovat pozici uzlu v state (u je hotovo pes onNodesChange)\n    // Nyn jen zalogovat pro debug\n    const updatedNode = nodes.find(n => n.id === node.id);\n    if (updatedNode) {\n      console.log(' Updated node position saved to local state:', {\n        id: updatedNode.id,\n        userId: updatedNode.data?.userId,\n        position: updatedNode.position\n      });\n    }\n  }, [nodes]);\n\n  const toggleSection = (section) => {\n    setExpandedSections(prev => ({\n      ...prev,\n      [section]: !prev[section]\n    }));\n  };\n\n  // === SELECTION HANDLERS PRO LEV PANEL ===\n  \n  const toggleUserSelection = (userId) => {\n    setSelectedUsers(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(userId)) {\n        newSet.delete(userId);\n      } else {\n        newSet.add(userId);\n      }\n      return newSet;\n    });\n  };\n\n  const toggleLocationSelection = (locationId) => {\n    setSelectedLocations(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(locationId)) {\n        newSet.delete(locationId);\n      } else {\n        newSet.add(locationId);\n      }\n      return newSet;\n    });\n  };\n\n  const toggleDepartmentSelection = (deptId) => {\n    setSelectedDepartments(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(deptId)) {\n        newSet.delete(deptId);\n      } else {\n        newSet.add(deptId);\n      }\n      return newSet;\n    });\n  };\n\n  const toggleRoleSelection = (roleId) => {\n    setSelectedRoles(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(roleId)) {\n        newSet.delete(roleId);\n      } else {\n        newSet.add(roleId);\n      }\n      return newSet;\n    });\n  };\n\n  const selectAllUsers = () => {\n    setSelectedUsers(new Set(filteredUsers.map(u => u.id)));\n  };\n\n  const deselectAllUsers = () => {\n    setSelectedUsers(new Set());\n  };\n\n  const selectAllLocations = () => {\n    setSelectedLocations(new Set(filteredLocations.map(l => l.id)));\n  };\n\n  const deselectAllLocations = () => {\n    setSelectedLocations(new Set());\n  };\n\n  const selectAllDepartments = () => {\n    setSelectedDepartments(new Set(filteredDepartments.map(d => d.id)));\n  };\n\n  const deselectAllDepartments = () => {\n    setSelectedDepartments(new Set());\n  };\n\n  const toggleNotificationTemplateSelection = (templateId) => {\n    setSelectedNotificationTemplates(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(templateId)) {\n        newSet.delete(templateId);\n      } else {\n        newSet.add(templateId);\n      }\n      return newSet;\n    });\n  };\n\n  const selectAllNotificationTemplates = () => {\n    setSelectedNotificationTemplates(new Set(filteredNotificationTemplates.map(t => t.id)));\n  };\n\n  const deselectAllNotificationTemplates = () => {\n    setSelectedNotificationTemplates(new Set());\n  };\n\n  // Pidat vybran poloky na plochu\n  const addSelectedToCanvas = () => {\n    const newNodes = [];\n    let index = nodes.length;\n    const timestamp = Date.now();\n\n    // Pidat vybran uivatele (povolujeme duplicity)\n    selectedUsers.forEach((userId, userIndex) => {\n      const user = allUsers.find(u => u.id === userId);\n      if (user) {\n        newNodes.push({\n          id: `user-${userId}-${timestamp}-${userIndex}`,\n          type: 'custom',\n          position: {\n            x: 100 + (index % 5) * 250,\n            y: 100 + Math.floor(index / 5) * 180\n          },\n          data: {\n            userId: userId, // Pvodn user ID\n            name: user.name,\n            position: user.position,\n            initials: user.initials,\n            metadata: {\n              location: user.location,\n              department: user.department\n            }\n          }\n        });\n        index++;\n      }\n    });\n\n    // Pidat vybran lokality jako samostatn nodes\n    selectedLocations.forEach((locationId, locIndex) => {\n      const location = allLocations.find(l => l.id === locationId);\n      if (location) {\n        newNodes.push({\n          id: `location-${locationId}-${timestamp}-${locIndex}`,\n          type: 'custom',\n          position: {\n            x: 100 + (index % 5) * 250,\n            y: 100 + Math.floor(index / 5) * 180\n          },\n          data: {\n            type: 'location',\n            locationId: locationId,\n            name: location.name\n          }\n        });\n        index++;\n      }\n    });\n\n    // Pidat vybran tvary jako samostatn nodes\n    selectedDepartments.forEach((deptId, deptIndex) => {\n      const department = allDepartments.find(d => d.id === deptId);\n      if (department) {\n        newNodes.push({\n          id: `department-${deptId}-${timestamp}-${deptIndex}`,\n          type: 'custom',\n          position: {\n            x: 100 + (index % 5) * 250,\n            y: 100 + Math.floor(index / 5) * 180\n          },\n          data: {\n            type: 'department',\n            departmentId: deptId,\n            name: department.name\n          }\n        });\n        index++;\n      }\n    });\n\n    // Pidat vybran notifikan ablony jako samostatn nodes\n    selectedNotificationTemplates.forEach((templateId, tplIndex) => {\n      const template = allNotificationTemplates.find(t => t.id === templateId);\n      if (template) {\n        newNodes.push({\n          id: `template-${templateId}-${timestamp}-${tplIndex}`,\n          type: 'custom',\n          position: {\n            x: 100 + (index % 5) * 250,\n            y: 100 + Math.floor(index / 5) * 180\n          },\n          data: {\n            type: 'template',\n            templateId: templateId,\n            name: template.name,\n            position: 'Notifikan ablona',\n            initials: '',\n            metadata: {\n              type: 'template',\n              template: template.name\n            }\n          }\n        });\n        index++;\n      }\n    });\n\n    if (newNodes.length > 0) {\n      setNodes(prevNodes => [...prevNodes, ...newNodes]);\n      console.log(` Added ${newNodes.length} nodes to canvas`);\n      \n      // Vymazat vbr\n      setSelectedUsers(new Set());\n      setSelectedLocations(new Set());\n      setSelectedDepartments(new Set());\n    }\n  };\n\n  // Store dragged item info for HTML5 drag & drop\n  const [draggedItem, setDraggedItem] = React.useState(null);\n\n  const onReactFlowDrop = (event) => {\n    event.preventDefault();\n    \n    if (!draggedItem) {\n      console.log(' No dragged item');\n      return;\n    }\n    \n    if (!reactFlowInstance) {\n      console.log(' ReactFlow instance not ready');\n      return;\n    }\n    \n    const dragId = draggedItem;\n    \n    // Najdi ReactFlow wrapper (.react-flow) a zskej jeho pozici\n    const reactFlowElement = event.currentTarget.querySelector('.react-flow');\n    if (!reactFlowElement) {\n      console.error(' ReactFlow element not found');\n      return;\n    }\n    \n    const reactFlowBounds = reactFlowElement.getBoundingClientRect();\n    \n    // Vypotej pozici pomoc screenToFlowPosition (ReactFlow 11.x)\n    // Odeti polovinu ky/vky nodu, aby kurzor byl piblin ve stedu karty\n    const nodeWidth = 220;  // Piblin ka custom node\n    const nodeHeight = 80;  // Piblin vka custom node\n    \n    const position = reactFlowInstance.screenToFlowPosition({\n      x: event.clientX - nodeWidth / 2,\n      y: event.clientY - nodeHeight / 2,\n    });\n    \n    console.log(' Drop:', { \n      dragId, \n      position, \n      clientX: event.clientX, \n      clientY: event.clientY,\n      bounds: { left: reactFlowBounds.left, top: reactFlowBounds.top },\n      viewport: reactFlowInstance.getViewport()\n    });\n    \n    // Zpracovn notifikan ablony - pidat jako node\n    if (dragId.startsWith('notif-')) {\n      const notifId = parseInt(dragId.replace('notif-', ''), 10);\n      const template = allNotificationTemplates.find(t => t.id === notifId);\n      \n      if (template) {\n        const nodeId = `template-${notifId}-${Date.now()}`;\n        \n        const newNode = {\n          id: nodeId,\n          type: 'custom',\n          position,\n          data: {\n            type: 'template',\n            templateId: notifId,\n            name: template.name,\n            position: 'Notifikan ablona',\n            initials: '',\n            metadata: {\n              type: 'template',\n              template: template.name\n            }\n          }\n        };\n        \n        setNodes((nds) => [...nds, newNode]);\n        console.log(` Added notification template node: ${template.name}`);\n      }\n      return;\n    }\n    \n    // Zpracovn role - pidat jako node\n    if (dragId.startsWith('role-')) {\n      const roleId = parseInt(dragId.replace('role-', ''), 10);\n      const role = allRoles.find(r => r.id === roleId);\n      \n      if (role) {\n        const nodeId = `role-${roleId}-${Date.now()}`;\n        \n        const newNode = {\n          id: nodeId,\n          type: 'custom',\n          position,\n          data: {\n            type: 'role',\n            roleId: roleId,\n            name: role.nazev_role,\n            label: role.nazev_role,\n            metadata: {\n              type: 'role',\n              popis: role.popis || '',\n              orders: role.orders || 0,\n              invoices: role.invoices || 0,\n              cashbook: role.cashbook || 0\n            }\n          }\n        };\n        \n        setNodes((nds) => [...nds, newNode]);\n        console.log(` Added role node: ${role.nazev_role}`, newNode);\n      }\n      return;\n    }\n    \n    // Zpracovn uivatele\n    if (!dragId.startsWith('loc-') && !dragId.startsWith('dept-') && !dragId.startsWith('role-')) {\n      const user = allUsers.find(u => u.id === dragId);\n      \n      if (user) {\n        // Generuj uniktn ID pro node (povoluje duplicity stejnho uivatele)\n        const nodeId = `user-${dragId}-${Date.now()}`;\n        \n        const newNode = {\n          id: nodeId,\n          type: 'custom',\n          position,\n          data: {\n            type: 'user',\n            userId: dragId, // Pvodn user ID pro propojen s DB\n            name: user.name,\n            position: user.position,\n            initials: user.initials,\n            metadata: {\n              location: user.location,\n              department: user.department\n            }\n          }\n        };\n        \n        setNodes((nds) => [...nds, newNode]);\n      }\n      return;\n    }\n    \n    // Zpracovani lokality - prida samotnou lokalitu jako node\n    if (dragId.startsWith('loc-')) {\n      const locationId = dragId.replace('loc-', '');\n      console.log(' LOCATION DROP - ID:', locationId);\n      const location = allLocations.find(l => l.id === locationId);\n      \n      if (!location) {\n        console.error(' Location not found:', locationId);\n        return;\n      }\n      \n      const nodeId = `location-${locationId}-${Date.now()}`;\n      \n      const newNode = {\n        id: nodeId,\n        type: 'custom',\n        position,\n        data: {\n          type: 'location',\n          locationId: locationId,\n          name: location.name,\n          position: 'Lokalita',\n          initials: location.name.substring(0, 2).toUpperCase(),\n          metadata: {\n            type: 'location',\n            location: location.name\n          }\n        }\n      };\n      \n      setNodes((nds) => [...nds, newNode]);\n      console.log(` Added location node: ${location.name}`);\n      return;\n    }\n    \n    // Zpracovani utvaru - prida samotny utvar jako node\n    if (dragId.startsWith('dept-')) {\n      const deptId = dragId.replace('dept-', '');\n      console.log(' DEPARTMENT DROP - ID:', deptId);\n      const department = allDepartments.find(d => d.id === deptId);\n      \n      if (!department) {\n        console.error(' Department not found:', deptId);\n        return;\n      }\n      \n      const nodeId = `department-${deptId}-${Date.now()}`;\n      \n      const newNode = {\n        id: nodeId,\n        type: 'custom',\n        position,\n        data: {\n          type: 'department',\n          departmentId: deptId,\n          name: department.name,\n          position: 'Utvar',\n          initials: department.name.substring(0, 2).toUpperCase(),\n          metadata: {\n            type: 'department',\n            department: department.name\n          }\n        }\n      };\n      \n      setNodes((nds) => [...nds, newNode]);\n      console.log(` Added department node: ${department.name}`);\n      return;\n    }\n  };\n\n  const onReactFlowDragOver = (event) => {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n  };\n\n  const handleAutoGenerateHierarchy = () => {\n    // Kontrola zda jsou vybran nody na ploe\n    const selectedNodes = nodes.filter(n => n.selected);\n    \n    if (selectedNodes.length === 0) {\n      setDialog({\n        show: true,\n        type: 'alert',\n        icon: '',\n        title: 'dn poloky nevybrny na ploe',\n        message: 'Pro vytvoen AI hierarchie muste nejprve vybrat nody na ploe.\\n\\nPouijte:\\n Thnte my pro vbr oblasti (crosshair kurzor)\\n CTRL+klik pro individuln vbr\\n SHIFT+klik pro rozsah',\n        onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n        confirmText: 'OK',\n        cancelText: null\n      });\n      return;\n    }\n\n    // Generovat hierarchii pouze z vybranch nod na ploe\n    generateHierarchyFromSelectedNodes(selectedNodes);\n  };\n\n  // Automatick rozloen grafu pomoc dagre\n  const getLayoutedElements = (nodes, edges, direction = 'TB') => {\n    const dagreGraph = new graphlib.Graph();\n    dagreGraph.setDefaultEdgeLabel(() => ({}));\n    \n    const nodeWidth = 200;\n    const nodeHeight = 120;\n    \n    dagreGraph.setGraph({ \n      rankdir: direction,\n      nodesep: 80,      // Horizontln mezera mezi uzly\n      ranksep: 120,     // Vertikln mezera mezi rovnmi\n      marginx: 50,\n      marginy: 50\n    });\n\n    nodes.forEach((node) => {\n      dagreGraph.setNode(node.id, { width: nodeWidth, height: nodeHeight });\n    });\n\n    edges.forEach((edge) => {\n      dagreGraph.setEdge(edge.source, edge.target);\n    });\n\n    dagre.layout(dagreGraph);\n\n    const layoutedNodes = nodes.map((node) => {\n      const nodeWithPosition = dagreGraph.node(node.id);\n      return {\n        ...node,\n        position: {\n          x: nodeWithPosition.x - nodeWidth / 2,\n          y: nodeWithPosition.y - nodeHeight / 2,\n        },\n      };\n    });\n\n    return { nodes: layoutedNodes, edges };\n  };\n\n  // Pomocn funkce pro vpoet skre shody mezi dvma zkratkami tvar\n  // Vrac slo 0-100, m vy tm lep shoda\n  const getDepartmentMatchScore = (code1, code2) => {\n    if (!code1 || !code2) return 0;\n    \n    const c1 = code1.trim().toUpperCase();\n    const c2 = code2.trim().toUpperCase();\n    \n    if (c1 === c2) return 100; // Pesn shoda\n    \n    // Rozdlit na sti (nap. \"PTN BN\" -> [\"PTN\", \"BN\"])\n    const parts1 = c1.split(/\\s+/);\n    const parts2 = c2.split(/\\s+/);\n    \n    // Poet spolench st\n    let commonParts = 0;\n    parts1.forEach(p1 => {\n      if (parts2.includes(p1)) commonParts++;\n    });\n    \n    if (commonParts === 0) return 0;\n    \n    // Skre = (poet spolench st / vt poet st) * 80\n    const maxParts = Math.max(parts1.length, parts2.length);\n    return Math.floor((commonParts / maxParts) * 80);\n  };\n  \n  // Najde nejlepho nadzenho ze seznamu podle shody tvaru\n  const findBestDepartmentMatch = (user, candidates) => {\n    if (!candidates || candidates.length === 0) return null;\n    if (!user?.departmentCode) return candidates[0]; // Fallback na prvnho\n    \n    let bestMatch = null;\n    let bestScore = 0;\n    \n    candidates.forEach(candidate => {\n      const score = getDepartmentMatchScore(user.departmentCode, candidate.departmentCode);\n      if (score > bestScore) {\n        bestScore = score;\n        bestMatch = candidate;\n      }\n    });\n    \n    // Vrtit pouze pokud je skre > 0 (aspo njak shoda)\n    return bestScore > 0 ? bestMatch : null;\n  };\n\n  const generateHierarchyFromSelected = () => {\n    console.log(' AI: Generating hierarchy from SELECTED items only...');\n\n    // Zskat vechny vybran uivatele\n    let selectedUsersList = [];\n    \n    // Pidat pmo vybran uivatele\n    selectedUsers.forEach(userId => {\n      const user = allUsers.find(u => u.id === userId);\n      if (user) selectedUsersList.push(user);\n    });\n    \n    // Pidat uivatele z vybranch lokalit\n    selectedLocations.forEach(locationId => {\n      const location = allLocations.find(l => l.id === locationId);\n      if (location) {\n        const usersInLocation = allUsers.filter(u => u.location === location.name);\n        usersInLocation.forEach(user => {\n          if (!selectedUsersList.find(u => u.id === user.id)) {\n            selectedUsersList.push(user);\n          }\n        });\n      }\n    });\n    \n    // Pidat uivatele z vybranch tvar\n    selectedDepartments.forEach(deptId => {\n      const department = allDepartments.find(d => d.id === deptId);\n      if (department) {\n        const usersInDept = allUsers.filter(u => u.department === department.name);\n        usersInDept.forEach(user => {\n          if (!selectedUsersList.find(u => u.id === user.id)) {\n            selectedUsersList.push(user);\n          }\n        });\n      }\n    });\n\n    if (selectedUsersList.length === 0) {\n      setDialog({\n        show: true,\n        type: 'alert',\n        icon: '',\n        title: 'dn uivatel',\n        message: 'Ve vybranch polokch nejsou dn uivatel.',\n        onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n        confirmText: 'OK',\n        cancelText: null\n      });\n      return;\n    }\n\n    console.log(` AI: Working with ${selectedUsersList.length} selected users`);\n\n    // Analyzovat role z vybranch uivatel\n    const director = selectedUsersList.find(u => {\n      const pos = u.position?.toLowerCase() || '';\n      return pos === 'editel' || pos === 'editelka';\n    });\n    \n    const deputies = selectedUsersList.filter(u => \n      u.position?.toLowerCase().includes('nmstek')\n    );\n    \n    const directorHeads = selectedUsersList.filter(u => {\n      const pos = u.position?.toLowerCase() || '';\n      const dept = u.department?.toLowerCase() || '';\n      return pos.includes('vedouc') && (dept.includes('editel') || pos.includes('editel'));\n    });\n    \n    const heads = selectedUsersList.filter(u => {\n      const pos = u.position?.toLowerCase() || '';\n      const dept = u.department?.toLowerCase() || '';\n      return pos.includes('vedouc') && !dept.includes('editel') && !pos.includes('editel');\n    });\n    \n    const others = selectedUsersList.filter(u => {\n      const pos = u.position?.toLowerCase() || '';\n      return !pos.includes('editel') &&\n             !pos.includes('nmstek') &&\n             !pos.includes('vedouc');\n    });\n\n    // Vytvoit nodes a edges\n    const newNodes = [];\n    const newEdges = [];\n    const timestamp = Date.now();\n\n    // editel\n    if (director) {\n      newNodes.push({\n        id: `user-${director.id}-${timestamp}-0`,\n        type: 'custom',\n        position: { x: 0, y: 0 },\n        data: {\n          userId: director.id,\n          name: director.name,\n          position: director.position,\n          initials: director.initials,\n          metadata: {\n            location: director.location,\n            department: director.department\n          }\n        }\n      });\n    }\n\n    // Nmstci\n    deputies.forEach((deputy, i) => {\n      const nodeId = `user-${deputy.id}-${timestamp}-${i + 1}`;\n      newNodes.push({\n        id: nodeId,\n        type: 'custom',\n        position: { x: 0, y: 0 },\n        data: {\n          userId: deputy.id,\n          name: deputy.name,\n          position: deputy.position,\n          initials: deputy.initials,\n          metadata: {\n            location: deputy.location,\n            department: deputy.department\n          }\n        }\n      });\n\n      if (director) {\n        newEdges.push({\n          id: `e-${newNodes[0].id}-${nodeId}`,\n          source: newNodes[0].id,\n          target: nodeId,\n          type: 'smoothstep',\n          animated: true,\n          markerEnd: { type: MarkerType.ArrowClosed },\n          style: { stroke: '#667eea', strokeWidth: 3 }\n        });\n      }\n    });\n\n    // Vedouc seku editele\n    let nodeIndex = 1 + deputies.length;\n    directorHeads.forEach((head, i) => {\n      const nodeId = `user-${head.id}-${timestamp}-${nodeIndex + i}`;\n      newNodes.push({\n        id: nodeId,\n        type: 'custom',\n        position: { x: 0, y: 0 },\n        data: {\n          userId: head.id,\n          name: head.name,\n          position: head.position,\n          initials: head.initials,\n          metadata: {\n            location: head.location,\n            department: head.department\n          }\n        }\n      });\n\n      if (director) {\n        newEdges.push({\n          id: `e-${newNodes[0].id}-${nodeId}`,\n          source: newNodes[0].id,\n          target: nodeId,\n          type: 'smoothstep',\n          animated: true,\n          markerEnd: { type: MarkerType.ArrowClosed },\n          style: { stroke: '#667eea', strokeWidth: 3 }\n        });\n      }\n    });\n\n    // Ostatn vedouc\n    nodeIndex += directorHeads.length;\n    heads.forEach((head, i) => {\n      const nodeId = `user-${head.id}-${timestamp}-${nodeIndex + i}`;\n      newNodes.push({\n        id: nodeId,\n        type: 'custom',\n        position: { x: 0, y: 0 },\n        data: {\n          userId: head.id,\n          name: head.name,\n          position: head.position,\n          initials: head.initials,\n          metadata: {\n            location: head.location,\n            department: head.department\n          }\n        }\n      });\n\n      // Pipojit k nmstkovi se stejnm tvarem\n      const deputyWithSameDept = deputies.find(d => d.department === head.department);\n      if (deputyWithSameDept) {\n        const deputyNode = newNodes.find(n => n.data.userId === deputyWithSameDept.id);\n        if (deputyNode) {\n          newEdges.push({\n            id: `e-${deputyNode.id}-${nodeId}`,\n            source: deputyNode.id,\n            target: nodeId,\n            type: 'smoothstep',\n            animated: true,\n            markerEnd: { type: MarkerType.ArrowClosed },\n            style: { stroke: '#667eea', strokeWidth: 3 }\n          });\n        }\n      } else if (director) {\n        // Fallback na editele\n        newEdges.push({\n          id: `e-${newNodes[0].id}-${nodeId}`,\n          source: newNodes[0].id,\n          target: nodeId,\n          type: 'smoothstep',\n          animated: true,\n          markerEnd: { type: MarkerType.ArrowClosed },\n          style: { stroke: '#667eea', strokeWidth: 3 }\n        });\n      }\n    });\n\n    // Ostatn zamstnanci\n    nodeIndex += heads.length;\n    others.forEach((user, i) => {\n      const nodeId = `user-${user.id}-${timestamp}-${nodeIndex + i}`;\n      newNodes.push({\n        id: nodeId,\n        type: 'custom',\n        position: { x: 0, y: 0 },\n        data: {\n          userId: user.id,\n          name: user.name,\n          position: user.position,\n          initials: user.initials,\n          metadata: {\n            location: user.location,\n            department: user.department\n          }\n        }\n      });\n\n      // Pipojit k vedoucmu stejnho tvaru\n      const headWithSameDept = heads.find(h => h.department === user.department);\n      if (headWithSameDept) {\n        const headNode = newNodes.find(n => n.data.userId === headWithSameDept.id);\n        if (headNode) {\n          newEdges.push({\n            id: `e-${headNode.id}-${nodeId}`,\n            source: headNode.id,\n            target: nodeId,\n            type: 'smoothstep',\n            animated: true,\n            markerEnd: { type: MarkerType.ArrowClosed },\n            style: { stroke: '#667eea', strokeWidth: 3 }\n          });\n        }\n      }\n    });\n\n    // Aplikovat layout\n    const { nodes: layoutedNodes, edges: layoutedEdges } = getLayoutedElements(newNodes, newEdges, 'TB');\n    \n    setNodes(layoutedNodes);\n    setEdges(layoutedEdges);\n\n    // Vyistit vbr\n    setSelectedUsers(new Set());\n    setSelectedLocations(new Set());\n    setSelectedDepartments(new Set());\n\n    setDialog({\n      show: true,\n      type: 'success',\n      icon: '',\n      title: 'AI Hierarchie vytvoena!',\n      message: 'Hierarchie byla automaticky vygenerovana z vybranych polozek.\\nZkontrolujte strukturu a pripadne upravte.\\nNezapomente ulozit!',\n      stats: {\n        'editel': director ? '1' : '0',\n        'Nmstci': deputies.length,\n        'Vedouc seku editele': directorHeads.length,\n        'Vedouc ostatnch sek': heads.length,\n        'Ostatn': others.length,\n        '': '',\n        'Celkem uzl': layoutedNodes.length,\n        'Celkem vztah': layoutedEdges.length\n      },\n      onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n      confirmText: 'OK',\n      cancelText: null\n    });\n  };\n\n  // Nov funkce pro prci s vybranmi nody na ploe\n  const generateHierarchyFromSelectedNodes = (selectedNodes) => {\n    console.log(' AI: Reorganizing hierarchy from SELECTED NODES on canvas...', selectedNodes.length);\n\n    if (selectedNodes.length === 0) return;\n\n    // Analyzovat role z vybranch nod\n    const director = selectedNodes.find(n => {\n      const pos = n.data.position?.toLowerCase() || '';\n      return pos === 'editel' || pos === 'editelka';\n    });\n    \n    const deputies = selectedNodes.filter(n => \n      n.data.position?.toLowerCase().includes('nmstek')\n    );\n    \n    const heads = selectedNodes.filter(n => \n      n.data.position?.toLowerCase().includes('vedouc')\n    );\n    \n    const others = selectedNodes.filter(n => \n      !n.data.position?.toLowerCase().includes('editel') &&\n      !n.data.position?.toLowerCase().includes('nmstek') &&\n      !n.data.position?.toLowerCase().includes('vedouc')\n    );\n\n    // Vytvo\\u0159 nov edges podle hierarchie\n    const newEdges = [];\n    const timestamp = Date.now();\n\n    // Nmstci -> editel\n    if (director) {\n      deputies.forEach(deputy => {\n        newEdges.push({\n          id: `e-${director.id}-${deputy.id}-${timestamp}`,\n          source: director.id,\n          target: deputy.id,\n          type: 'smoothstep',\n          animated: true,\n          markerEnd: { type: MarkerType.ArrowClosed },\n          style: { stroke: '#667eea', strokeWidth: 3 }\n        });\n      });\n\n      // Vedouc -> editel nebo Nmstek (podle tvaru)\n      heads.forEach(head => {\n        const deputyWithSameDept = deputies.find(d => \n          d.data.metadata?.department === head.data.metadata?.department\n        );\n        \n        const sourceNode = deputyWithSameDept || director;\n        newEdges.push({\n          id: `e-${sourceNode.id}-${head.id}-${timestamp}`,\n          source: sourceNode.id,\n          target: head.id,\n          type: 'smoothstep',\n          animated: true,\n          markerEnd: { type: MarkerType.ArrowClosed },\n          style: { stroke: '#667eea', strokeWidth: 3 }\n        });\n      });\n    }\n\n    // Odstranit star edges mezi vybranmi nody\n    const selectedNodeIds = new Set(selectedNodes.map(n => n.id));\n    const filteredEdges = edges.filter(e => \n      !selectedNodeIds.has(e.source) || !selectedNodeIds.has(e.target)\n    );\n\n    // Pidat nov edges\n    const updatedEdges = [...filteredEdges, ...newEdges];\n    \n    // Aplikovat layout\n    const { nodes: layoutedNodes, edges: layoutedEdges } = getLayoutedElements(nodes, updatedEdges, 'TB');\n    \n    setNodes(layoutedNodes);\n    setEdges(layoutedEdges);\n\n    setDialog({\n      show: true,\n      type: 'success',\n      icon: '',\n      title: 'Hierarchie reorganizovna!',\n      message: `Vybran nody (${selectedNodes.length}) byly reorganizovny podle rol.\\nZkontrolujte strukturu a ppadn upravte.`,\n      stats: {\n        'editel': director ? '1' : '0',\n        'Nmstci': deputies.length,\n        'Vedouc': heads.length,\n        'Ostatn': others.length,\n        '': '',\n        'Nov vztahy': newEdges.length\n      },\n      onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n      confirmText: 'OK',\n      cancelText: null\n    });\n  };\n\n  const generateHierarchy = () => {\n\n    console.log(' AI: Generating hierarchy from positions...');\n\n    // Pokud u existuj vztahy (naten z DB), pout je a jen aplikovat layout\n    if (edges.length > 0) {\n      console.log(' Using existing relationships from DB:', edges.length);\n      \n      // Vytvoit nodes ze vech uivatel\n      const existingNodes = allUsers.map((user) => ({\n        id: user.id,\n        type: 'custom',\n        position: { x: 0, y: 0 }, // Bude pepotno dagre\n        data: {\n          name: user.name,\n          position: user.position,\n          initials: user.initials,\n          metadata: {\n            location: user.location,\n            department: user.department\n          }\n        }\n      }));\n\n      // Aplikovat dagre layout na existujc strukturu\n      const { nodes: layoutedNodes, edges: layoutedEdges } = getLayoutedElements(existingNodes, edges, 'TB');\n      \n      setNodes(layoutedNodes);\n      setEdges(layoutedEdges);\n\n      setDialog({\n        show: true,\n        type: 'success',\n        icon: '',\n        title: 'Layout aplikovn!',\n        message: 'Pouzity existujici vztahy z databaze.\\nAplikovano prehledne automaticke rozlozeni.',\n        stats: {\n          'Celkem uzl': layoutedNodes.length,\n          'Vztah z DB': layoutedEdges.length\n        },\n        onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n        confirmText: 'OK',\n        cancelText: null\n      });\n      return;\n    }\n\n    // Pokud neexistuj vztahy, vygenerovat nov ze STVAJCCH PIAZEN v DB\n    console.log(' No existing relationships, generating from DB assignments...');\n\n    // 1. Seskupen podle tvar a pozic (pouvme RELN piazen z 25_uzivatele)\n    // editel = pesn \"editel\" (ne vedouc, ne nmstek)\n    const director = allUsers.find(u => {\n      const pos = u.position?.toLowerCase() || '';\n      return pos === 'editel' || pos === 'editelka';\n    });\n    \n    // Nmstci - seskupeni podle jejich tvar (department/departmentCode)\n    const deputies = allUsers.filter(u => \n      u.position?.toLowerCase().includes('nmstek')\n    );\n    \n    // Vedouc seku editele - jdou PMO pod editele\n    const directorHeads = allUsers.filter(u => {\n      const pos = u.position?.toLowerCase() || '';\n      const dept = u.department?.toLowerCase() || '';\n      return pos.includes('vedouc') && (dept.includes('editel') || pos.includes('editel'));\n    });\n    \n    // Ostatn vedouc (ne editelskho seku) - BUDOU nadzeni svmu tvaru\n    const heads = allUsers.filter(u => {\n      const pos = u.position?.toLowerCase() || '';\n      const dept = u.department?.toLowerCase() || '';\n      return pos.includes('vedouc') && !dept.includes('editel') && !pos.includes('editel');\n    });\n    \n    // Ostatn zamstnanci - piazeni podle svho tvaru (department)\n    const others = allUsers.filter(u => {\n      const pos = u.position?.toLowerCase() || '';\n      return !pos.includes('editel') &&\n             !pos.includes('nmstek') &&\n             !pos.includes('vedouc');\n    });\n\n    console.log(' AI: Structure from DB assignments:', { \n      director: director ? `${director.name} (${director.department}, ${director.location})` : 'None',\n      deputies: deputies.map(d => ({ name: d.name, dept: d.department, code: d.departmentCode })),\n      directorHeads: directorHeads.map(h => ({ name: h.name, dept: h.department })),\n      heads: heads.map(h => ({ name: h.name, dept: h.department, code: h.departmentCode })),\n      others: `${others.length} users`\n    });\n\n    // 2. Vytvoen nodes (pozice budou pepotny dagre)\n    const newNodes = [];\n    const newEdges = [];\n    let yPos = 100;\n    const xSpacing = 280;\n    const ySpacing = 180;\n\n    // editel nahoe (sted)\n    if (director) {\n      newNodes.push({\n        id: director.id,\n        type: 'custom',\n        position: { x: 500, y: yPos },\n        data: {\n          name: director.name,\n          position: director.position,\n          initials: director.initials,\n          metadata: {\n            location: director.location,\n            department: director.department\n          }\n        }\n      });\n      yPos += ySpacing;\n    }\n\n    // Nmstci pod editelem\n    if (deputies.length > 0) {\n      const startX = 500 - ((deputies.length - 1) * xSpacing) / 2;\n      deputies.forEach((deputy, i) => {\n        newNodes.push({\n          id: deputy.id,\n          type: 'custom',\n          position: { x: startX + (i * xSpacing), y: yPos },\n          data: {\n            name: deputy.name,\n            position: deputy.position,\n            initials: deputy.initials,\n            metadata: {\n              location: deputy.location,\n              department: deputy.department\n            }\n          }\n        });\n\n        // Spojit s editelem\n        if (director) {\n          newEdges.push({\n            id: `e-${director.id}-${deputy.id}`,\n            source: director.id,\n            target: deputy.id,\n            type: 'smoothstep',\n            animated: true,\n            markerEnd: { type: MarkerType.ArrowClosed },\n            style: { stroke: '#667eea', strokeWidth: 3 }\n          });\n        }\n      });\n      yPos += ySpacing;\n    }\n\n    // Vedouc seku editele - PMO pod editele (ne pes nmstky!)\n    if (directorHeads.length > 0) {\n      const startX = 200;\n      directorHeads.forEach((head, i) => {\n        newNodes.push({\n          id: head.id,\n          type: 'custom',\n          position: { x: startX + (i * 250), y: yPos },\n          data: {\n            name: head.name,\n            position: head.position,\n            initials: head.initials,\n            metadata: {\n              location: head.location,\n              department: head.department\n            }\n          }\n        });\n\n        // Vedouc editelskho seku jde PMO na editele\n        if (director) {\n          newEdges.push({\n            id: `e-${director.id}-${head.id}`,\n            source: director.id,\n            target: head.id,\n            type: 'smoothstep',\n            animated: true,\n            markerEnd: { type: MarkerType.ArrowClosed },\n            style: { stroke: '#667eea', strokeWidth: 3 }\n          });\n        }\n      });\n      yPos += ySpacing;\n    }\n\n    // Ostatn vedouc - pod nmstky (podle tvaru)\n    if (heads.length > 0) {\n      const startX = 200;\n      heads.forEach((head, i) => {\n        newNodes.push({\n          id: head.id,\n          type: 'custom',\n          position: { x: startX + (i * 250), y: yPos },\n          data: {\n            name: head.name,\n            position: head.position,\n            initials: head.initials,\n            metadata: {\n              location: head.location,\n              department: head.department\n            }\n          }\n        });\n\n        // Najt nmstka s nejlep shodou tvaru (podle zkratky), nebo editele\n        const sameDepDeputy = findBestDepartmentMatch(head, deputies);\n        const parent = sameDepDeputy || (deputies.length > 0 ? deputies[0] : director);\n        \n        if (parent) {\n          newEdges.push({\n            id: `e-${parent.id}-${head.id}`,\n            source: parent.id,\n            target: head.id,\n            type: 'smoothstep',\n            animated: true,\n            markerEnd: { type: MarkerType.ArrowClosed },\n            style: { stroke: '#667eea', strokeWidth: 3 }\n          });\n        }\n      });\n      yPos += ySpacing;\n    }\n\n    // Ostatn zamstnanci\n    if (others.length > 0) {\n      const startX = 100;\n      const maxPerRow = 5;\n      others.forEach((user, i) => {\n        const row = Math.floor(i / maxPerRow);\n        const col = i % maxPerRow;\n        \n        newNodes.push({\n          id: user.id,\n          type: 'custom',\n          position: { x: startX + (col * 220), y: yPos + (row * ySpacing) },\n          data: {\n            name: user.name,\n            position: user.position,\n            initials: user.initials,\n            metadata: {\n              location: user.location,\n              department: user.department\n            }\n          }\n        });\n\n        // Najt nadzenho s nejlep shodou tvaru - porovnat vechny monosti\n        const allPossibleParents = [...heads, ...directorHeads, ...deputies];\n        const bestMatch = findBestDepartmentMatch(user, allPossibleParents);\n        const parent = bestMatch || (deputies.length > 0 ? deputies[0] : director);\n        \n        // Debug: zobrazit skre shody\n        if (bestMatch) {\n          const score = getDepartmentMatchScore(user.departmentCode, bestMatch.departmentCode);\n          console.log(` ${user.name} (${user.departmentCode})  ${bestMatch.name} (${bestMatch.departmentCode}) [score: ${score}]`);\n        }\n        \n        if (parent) {\n          newEdges.push({\n            id: `e-${parent.id}-${user.id}`,\n            source: parent.id,\n            target: user.id,\n            type: 'smoothstep',\n            animated: true,\n            markerEnd: { type: MarkerType.ArrowClosed },\n            style: { stroke: '#667eea', strokeWidth: 3 }\n          });\n        }\n      });\n    }\n\n    // Aplikovat automatick rozloen pomoc dagre\n    const { nodes: layoutedNodes, edges: layoutedEdges } = getLayoutedElements(newNodes, newEdges, 'TB');\n    \n    // Nastavit nov nodes a edges s optimlnm layoutem\n    setNodes(layoutedNodes);\n    setEdges(layoutedEdges);\n\n    console.log(' AI: Generated hierarchy with auto-layout:', {\n      nodes: layoutedNodes.length,\n      edges: layoutedEdges.length\n    });\n\n    setDialog({\n      show: true,\n      type: 'success',\n      icon: '',\n      title: 'Hierarchie automaticky vytvorena!',\n      message: 'Zkontrolujte strukturu a ppadn upravte.\\nNezapomete uloit!',\n      stats: {\n        'editel': director ? '1' : '0',\n        'Nmstci': deputies.length,\n        'Vedouc seku editele': directorHeads.length,\n        'Vedouc ostatnch sek': heads.length,\n        'Ostatn': others.length,\n        '': '',\n        'Celkem uzl': layoutedNodes.length,\n        'Celkem vztah': layoutedEdges.length\n      },\n      onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n      confirmText: 'OK',\n      cancelText: null\n    });\n  };\n\n  // ============ PROFILE MANAGEMENT ============\n  \n  const loadProfiles = async () => {\n    try {\n      const token = await loadAuthData.token();\n      const userData = await loadAuthData.user();\n      const username = userData?.username || localStorage.getItem('username');\n      const apiBase = process.env.REACT_APP_API2_BASE_URL || '/api.eeo';\n      \n      const response = await fetch(`${apiBase}/hierarchy/profiles/list`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ token, username })\n      });\n      \n      const result = await response.json();\n      if (result.success) {\n        setProfiles(result.data || []);\n        const activeProfile = result.data.find(p => p.isActive) || result.data[0];\n        setCurrentProfile(activeProfile || null);\n      }\n    } catch (err) {\n      console.error('Failed to load profiles:', err);\n    }\n  };\n\n  const handleDeleteProfile = async () => {\n    if (!currentProfile || profiles.length <= 1) {\n      return;\n    }\n\n    const relationshipsText = currentProfile.relationshipsCount > 0 \n      ? `\\n\\n Profil obsahuje ${currentProfile.relationshipsCount} vztah, kter budou tak smazny!`\n      : '';\n\n    setDialog({\n      show: true,\n      type: 'confirm',\n      icon: '',\n      title: 'Smazat profil?',\n      message: `Opravdu chcete smazat profil \"${currentProfile.name}\"?${relationshipsText}\\n\\nTato akce je nevratn!`,\n      onConfirm: async () => {\n        try {\n          const token = await loadAuthData.token();\n          const userData = await loadAuthData.user();\n          const username = userData?.username || localStorage.getItem('username');\n          const apiBase = process.env.REACT_APP_API2_BASE_URL || '/api.eeo';\n\n          const response = await fetch(`${apiBase}/hierarchy/profiles/delete`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ \n              token, \n              username, \n              profile_id: currentProfile.id \n            })\n          });\n\n          const result = await response.json();\n          \n          if (result.success) {\n            setDialog({\n              show: true,\n              type: 'success',\n              icon: '',\n              title: 'Profil smazn',\n              message: `Profil \"${currentProfile.name}\" byl spn smazn.`,\n              onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n              confirmText: 'OK',\n              cancelText: null\n            });\n\n            // Obnovit seznam profil a vybrat prvn dostupn\n            await loadProfiles();\n            \n            // Vyistit canvas\n            setNodes([]);\n            setEdges([]);\n          } else {\n            throw new Error(result.error || 'Chyba pi mazn profilu');\n          }\n        } catch (err) {\n          console.error('Delete profile error:', err);\n          setDialog({\n            show: true,\n            type: 'alert',\n            icon: '',\n            title: 'Chyba pi mazn',\n            message: err.message,\n            onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n            confirmText: 'OK',\n            cancelText: null\n          });\n        }\n      },\n      onCancel: () => setDialog(prev => ({ ...prev, show: false })),\n      confirmText: 'Smazat',\n      cancelText: 'Zruit'\n    });\n  };\n  \n  const handleToggleProfileActive = async () => {\n    if (!currentProfile) return;\n    \n    const newActiveState = !currentProfile.isActive;\n    const action = newActiveState ? 'aktivovat' : 'deaktivovat';\n    \n    try {\n      const token = await loadAuthData.token();\n      const userData = await loadAuthData.user();\n      const username = userData?.username || localStorage.getItem('username');\n      \n      const { setProfileActive } = await import('../services/hierarchyProfilesApi');\n      await setProfileActive(token, username, currentProfile.id, newActiveState);\n      \n      // Aktualizovat lokln stav\n      setProfiles(profiles.map(p => \n        p.id === currentProfile.id ? { ...p, isActive: newActiveState } : p\n      ));\n      setCurrentProfile({ ...currentProfile, isActive: newActiveState });\n      \n      const statusText = newActiveState ? 'aktivovn (viditeln v AppSettings)' : 'deaktivovn (skryt v AppSettings)';\n      console.log(` Profil \"${currentProfile.name}\" byl ${statusText}`);\n    } catch (error) {\n      console.error(`Chyba pi pokusu ${action} profil:`, error);\n      alert(`Nepodailo se ${action} profil: ${error.message}`);\n    }\n  };\n  \n  const handleProfileChange = async (profileId) => {\n    console.log(' handleProfileChange called with profileId:', profileId);\n    const profile = profiles.find(p => p.id === parseInt(profileId));\n    console.log(' Found profile:', profile);\n    if (!profile) {\n      console.log(' Profile not found!');\n      return;\n    }\n    \n    // Pokud ma draft, zeptat se zda chce prepisat\n    if (hasDraft && (nodes.length > 0 || edges.length > 0)) {\n      if (!window.confirm(`Mte neuloen zmny v auto-draftu.\\n\\nChcete nast profil \"${profile.name}\"?\\n\\nNeuloen zmny budou ztraceny.`)) {\n        return;\n      }\n    }\n    \n    setCurrentProfile(profile);\n    \n    // Uloit vybran profil do LocalStorage\n    localStorage.setItem(LS_PROFILE_KEY, profileId.toString());\n    \n    console.log(' Loading profile:', profile.name, 'ID:', profileId);\n    \n    // Nacist strukturu pro vybrany profil\n    try {\n      const token = await loadAuthData.token();\n      const userData = await loadAuthData.user();\n      const username = userData?.username || localStorage.getItem('username');\n      const apiBase = process.env.REACT_APP_API2_BASE_URL || '/api.eeo';\n      \n      const response = await fetch(`${apiBase}/hierarchy/structure`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ token, username, profilId: profileId })\n      });\n      \n      const result = await response.json();\n      console.log(' Profile structure response:', result);\n      \n      if (result.success && result.data) {\n        // API vrac V2 formt s nodes a relations\n        const apiNodes = result.data.nodes || [];\n        const apiRelations = result.data.relations || [];\n        \n        if (!apiRelations || apiRelations.length === 0) {\n          setNodes([]);\n          setEdges([]);\n          console.log(' Empty profile loaded');\n        } else {\n          console.log(' Received nodes:', apiNodes.length, 'relations:', apiRelations.length);\n          \n          // Nejdv nast pozice z relations (kad relation m position_1 a position_2)\n          const nodePositions = new Map();\n          apiRelations.forEach(rel => {\n            // Position pro node_1\n            if (rel.node_1 && rel.position_1) {\n              nodePositions.set(rel.node_1, rel.position_1);\n            }\n            // Position pro node_2\n            if (rel.node_2 && rel.position_2) {\n              nodePositions.set(rel.node_2, rel.position_2);\n            }\n          });\n          \n          console.log(' Loaded positions for', nodePositions.size, 'nodes');\n          \n          // Konvertovat backend nodes do ReactFlow formtu s uloenmi pozicemi\n          const nodeIdMap = {};\n          const transformedNodes = apiNodes.map((node, index) => {\n            const reactFlowId = `${node.type}-${node.userId || node.roleId || node.departmentId || node.locationId || node.templateId}-${Date.now()}-${index}`;\n            nodeIdMap[node.id] = reactFlowId; // Mapovn backend ID -> ReactFlow ID\n            \n            // Nast uloenou pozici nebo pout default\n            const savedPosition = nodePositions.get(node.id);\n            const position = savedPosition || { x: index * 250, y: 0 };\n            \n            return {\n              id: reactFlowId,\n              type: 'custom',\n              position: position,\n              data: {\n                type: node.type,\n                name: node.name,\n                userId: node.userId,\n                roleId: node.roleId,\n                departmentId: node.departmentId,\n                locationId: node.locationId,\n                templateId: node.templateId,\n                position: node.position, // Pro uivatele (pracovn pozice)\n                initials: node.initials,\n                metadata: node.metadata || {},\n                popis: node.popis // Pro role\n              }\n            };\n          });\n          \n          console.log(' Node mapping created:', nodeIdMap);\n          \n          // Konvertovat relations na edges - backend vrac node_1 a node_2 jako stringy\n          const transformedEdges = apiRelations.map((rel, idx) => {\n            // Backend vrac node_1 a node_2 jako 'user-123', 'role-5' atd.\n            const sourceId = nodeIdMap[rel.node_1];\n            const targetId = nodeIdMap[rel.node_2];\n            \n            if (!sourceId || !targetId) {\n              console.warn(' Missing source or target mapping for relation:', {\n                relation: rel,\n                node_1: rel.node_1,\n                node_2: rel.node_2,\n                sourceId,\n                targetId,\n                availableKeys: Object.keys(nodeIdMap)\n              });\n              return null;\n            }\n            \n            return {\n              id: `rel-${rel.id || idx}`,\n              source: sourceId,\n              target: targetId,\n              type: 'smoothstep',\n              animated: true,\n              data: {\n                level: rel.level,\n                visibility: rel.visibility,\n                notifications: rel.notifications,\n                type: rel.type\n              }\n            };\n          }).filter(e => e !== null);\n          \n          setNodes(transformedNodes);\n          setEdges(transformedEdges);\n          \n          console.log(' Profile loaded:', transformedNodes.length, 'nodes,', transformedEdges.length, 'edges');\n        }\n        \n        // Vymazat draft pri nacitani profilu\n        localStorage.removeItem(LS_NODES_KEY);\n        localStorage.removeItem(LS_EDGES_KEY);\n        localStorage.removeItem(LS_TIMESTAMP_KEY);\n        setHasDraft(false);\n      }\n    } catch (err) {\n      console.error('Failed to load profile structure:', err);\n    }\n  };\n  \n  const handleSaveAs = () => {\n    setProfileDialogMode('saveAs');\n    setShowProfileDialog(true);\n  };\n  \n  const handleProfileSaveConfirm = async (profileName, profileDescription) => {\n    try {\n      const token = await loadAuthData.token();\n      const userData = await loadAuthData.user();\n      const username = userData?.username || localStorage.getItem('username');\n      const apiBase = process.env.REACT_APP_API2_BASE_URL || '/api.eeo';\n      \n      // Nejdrive vytvorit profil\n      const createResponse = await fetch(`${apiBase}/hierarchy/profiles/create`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ \n          token, \n          username,\n          name: profileName,\n          description: profileDescription,\n          set_active: false\n        })\n      });\n      \n      const createResult = await createResponse.json();\n      \n      if (createResult.code === 'PROFILE_EXISTS') {\n        // Profil existuje - zobrazit confirm dialog\n        return { exists: true, profileName };\n      }\n      \n      if (!createResult.success) {\n        throw new Error(createResult.error || 'Chyba pri vytvareni profilu');\n      }\n      \n      const newProfileId = createResult.profile_id;\n      \n      // Ulozit hierarchii do noveho profilu\n      await handleSave(newProfileId);\n      \n      // Obnovit seznam profilu\n      await loadProfiles();\n      \n      setShowProfileDialog(false);\n      \n      return { success: true };\n      \n    } catch (err) {\n      console.error('Profile save error:', err);\n      return { error: err.message };\n    }\n  };\n\n  const handleSave = async (targetProfileId = null) => {\n    try {\n      const token = await loadAuthData.token();\n      const userData = await loadAuthData.user();\n      const username = userData?.username || localStorage.getItem('username');\n      const apiBase = process.env.REACT_APP_API2_BASE_URL || '/api.eeo';\n      \n      const profileId = targetProfileId || currentProfile?.id || 1;\n      \n      console.log(' V2 SAVE START - Current state:', {\n        totalNodes: nodes.length,\n        totalEdges: edges.length,\n        nodes: nodes.map(n => ({id: n.id, userId: n.data?.userId, locationId: n.data?.locationId, type: n.data?.type || n.type})),\n        edges: edges.map(e => ({id: e.id, source: e.source, target: e.target}))\n      });\n      \n      // === NOV SYSTM: Pevst edges na vztahy (relations) ===\n      const relations = [];\n      \n      for (const edge of edges) {\n        const sourceNode = nodes.find(n => n.id === edge.source);\n        const targetNode = nodes.find(n => n.id === edge.target);\n        \n        if (!sourceNode || !targetNode) {\n          console.warn(' Skipping edge - node not found:', edge.id);\n          continue;\n        }\n        \n        // Urit typ nodes z data (nikdy z ReactFlow node.type kter je 'custom')\n        const getNodeType = (node) => {\n          if (node.data?.type) return node.data.type;\n          if (node.data?.userId) return 'user';\n          if (node.data?.locationId) return 'location';\n          if (node.data?.departmentId) return 'department';\n          if (node.data?.templateId) return 'template';\n          return 'user'; // default fallback\n        };\n        \n        const sourceType = getNodeType(sourceNode);\n        const targetType = getNodeType(targetNode);\n        \n        // Vytvoit vztah podle typu\n        // Mapovat scope na level: OWN=1, TEAM=2, LOCATION=3, ALL=4\n        const scopeToLevel = { 'OWN': 1, 'TEAM': 2, 'LOCATION': 3, 'ALL': 4 };\n        const edgeScope = edge.data?.scope || 'OWN';\n        const edgeLevel = scopeToLevel[edgeScope] || edge.data?.level || 1;\n        \n        const relation = {\n          type: `${sourceType}-${targetType}`, // 'user-user', 'location-user', etc.\n          position_1: sourceNode.position,\n          position_2: targetNode.position,\n          level: edgeLevel,\n          // Typ vztahu (prime, zastupovani, delegovani, rozsirene)\n          relationshipType: edge.data?.relationshipType || edge.data?.druh_vztahu || 'prime',\n          druh_vztahu: edge.data?.relationshipType || edge.data?.druh_vztahu || 'prime', // Alias pro DB\n          // Viditelnost modul\n          visibility: {\n            objednavky: edge.data?.modules?.orders || edge.data?.visibility?.objednavky || false,\n            faktury: edge.data?.modules?.invoices || edge.data?.visibility?.faktury || false,\n            smlouvy: edge.data?.modules?.contracts || edge.data?.visibility?.smlouvy || false,\n            pokladna: edge.data?.modules?.cashbook || edge.data?.visibility?.pokladna || false,\n            uzivatele: edge.data?.modules?.users || edge.data?.visibility?.uzivatele || false,\n            lp: edge.data?.modules?.lp || edge.data?.visibility?.lp || false\n          },\n          // Moduly (duplikt pro zptnou kompatibilitu)\n          modules: edge.data?.modules || {},\n          // rove prv pro kad modul\n          permissionLevel: edge.data?.permissionLevel || {},\n          // Rozen lokality/tvary/kombinace\n          extended: edge.data?.extended || {\n            locations: [],\n            departments: [],\n            combinations: []\n          },\n          // Notifikace\n          notifications: edge.data?.notifications || {\n            email: false,\n            inapp: false,\n            types: [],\n            recipientRole: 'APPROVAL'\n          },\n          // Node settings (template variants, atd.)\n          node_settings: {\n            source: {\n              normalVariant: sourceNode.data?.normalVariant || null,\n              urgentVariant: sourceNode.data?.urgentVariant || null,\n              infoVariant: sourceNode.data?.infoVariant || null,\n              previewVariant: sourceNode.data?.previewVariant || null\n            },\n            target: {\n              normalVariant: targetNode.data?.normalVariant || null,\n              urgentVariant: targetNode.data?.urgentVariant || null,\n              infoVariant: targetNode.data?.infoVariant || null,\n              previewVariant: targetNode.data?.previewVariant || null\n            }\n          }\n        };\n        \n        // Piadit IDs podle typu\n        if (sourceType === 'user') {\n          relation.user_id_1 = parseInt(sourceNode.data.userId);\n        } else if (sourceType === 'location') {\n          relation.lokalita_id = parseInt(sourceNode.data.locationId);\n        } else if (sourceType === 'department') {\n          relation.usek_id = parseInt(sourceNode.data.departmentId);\n        } else if (sourceType === 'template') {\n          relation.template_id = parseInt(sourceNode.data.templateId);\n        } else if (sourceType === 'role') {\n          relation.role_id = parseInt(sourceNode.data.roleId);\n        }\n        \n        if (targetType === 'user') {\n          relation.user_id_2 = parseInt(targetNode.data.userId);\n        } else if (targetType === 'location') {\n          relation.lokalita_id = parseInt(targetNode.data.locationId);\n        } else if (targetType === 'department') {\n          relation.usek_id = parseInt(targetNode.data.departmentId);\n        } else if (targetType === 'template') {\n          relation.template_id = parseInt(targetNode.data.templateId);\n        } else if (targetType === 'role') {\n          relation.role_id = parseInt(targetNode.data.roleId);\n        }\n        \n        console.log(' Relation:', relation);\n        relations.push(relation);\n      }\n      \n      // Extrahovat node settings pro samostatn ukldn\n      const nodeSettings = nodes.map(node => ({\n        id: node.id,\n        type: node.data?.type || 'user',\n        userId: node.data?.userId || null,\n        locationId: node.data?.locationId || null,\n        departmentId: node.data?.departmentId || null,\n        templateId: node.data?.templateId || null,\n        roleId: node.data?.roleId || null,\n        position: node.position,\n        settings: {\n          normalVariant: node.data?.normalVariant || null,\n          urgentVariant: node.data?.urgentVariant || null,\n          infoVariant: node.data?.infoVariant || null,\n          previewVariant: node.data?.previewVariant || null\n        }\n      }));\n      \n      const payload = {\n        token,\n        username,\n        profile_id: profileId,\n        relations: relations,\n        nodes: nodeSettings  // Pidno pro ukldn node-specific settings\n      };\n      \n      console.log(' V2 SAVE START - Current state:', {\n        totalNodes: nodes.length,\n        totalEdges: edges.length,\n        nodes: nodes.map(n => ({id: n.id, userId: n.data?.userId, type: n.data?.type})),\n        edges: edges.map(e => ({id: e.id, source: e.source, target: e.target}))\n      });\n      \n      console.log(' V2 SAVE - Payload:', JSON.stringify(payload, null, 2));\n      \n      const response = await fetch(`${apiBase}/hierarchy/save`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(payload)\n      });\n\n      console.log(' SAVE Response status:', response.status, response.statusText);\n      \n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error(' SAVE Error response:', errorText);\n        throw new Error('Chyba pri ukladani');\n      }\n\n      const result = await response.json();\n      console.log(' SAVE Result:', result);\n      if (result.success) {\n        localStorage.removeItem(LS_NODES_KEY);\n        localStorage.removeItem(LS_EDGES_KEY);\n        localStorage.removeItem(LS_TIMESTAMP_KEY);\n        setHasDraft(false);\n        \n        // Automaticky pepnout na uloen profil a uloit do LocalStorage\n        if (result.profile_id && result.profile_id !== currentProfile?.id) {\n          const savedProfile = profiles.find(p => p.id === result.profile_id);\n          if (savedProfile) {\n            setCurrentProfile(savedProfile);\n            localStorage.setItem(LS_PROFILE_KEY, savedProfile.id.toString());\n            console.log(' Automaticky pepnuto na profil:', savedProfile.name);\n          }\n        }\n        \n        // Zobrazit toast notifikaci msto dialogu\n        showToast(\n          ` Hierarchie spn uloena! Uloeno ${nodes.length} uzl a ${edges.length} vztah.`,\n          { type: 'success', timeout: 5000 }\n        );\n      } else {\n        console.error(' SAVE Failed:', result.error, result.details);\n        throw new Error(result.error || 'Neznama chyba');\n      }\n    } catch (err) {\n      console.error(' SAVE Exception:', err);\n      setDialog({\n        show: true,\n        type: 'alert',\n        icon: '',\n        title: 'Chyba pri ukladani',\n        message: err.message,\n        onConfirm: () => setDialog(prev => ({ ...prev, show: false })),\n        confirmText: 'OK',\n        cancelText: null\n      });\n    }\n  };\n\n  const handleDeleteNode = async () => {\n    if (selectedNode) {\n      console.log(' Deleting node:', selectedNode.id);\n      \n      // Odstranit node a vechny souvisejc hrany z UI (optimistic update)\n      setNodes((nds) => nds.filter(n => n.id !== selectedNode.id));\n      setEdges((eds) => eds.filter(e => e.source !== selectedNode.id && e.target !== selectedNode.id));\n      setSelectedNode(null);\n      setShowDetailPanel(false);\n      \n      // Poznmka: Skuten mazn z DB probhne pi dalm uloen (handleSave)\n      // V2 systm ukld celou hierarchii najednou, ne jednotliv nodes\n      console.log(' Node removed from UI (will be deleted from DB on next save)');\n    }\n  };\n\n  const handleDeleteEdge = async () => {\n    if (selectedEdge) {\n      console.log(' Deleting edge:', selectedEdge);\n      \n      // Odstranit z UI okamit (optimistic update)\n      setEdges((eds) => eds.filter(e => e.id !== selectedEdge.id));\n      setSelectedEdge(null);\n      setShowDetailPanel(false);\n      \n      // Poznmka: Skuten mazn z DB probhne pi dalm uloen (handleSave)\n      // V2 systm ukld celou hierarchii najednou, ne jednotliv vztahy\n      console.log(' Edge removed from UI (will be deleted from DB on next save)');\n    }\n  };\n\n  const filteredUsers = allUsers.filter(u => \n    u.name.toLowerCase().includes(searchUsers.toLowerCase()) ||\n    u.position.toLowerCase().includes(searchUsers.toLowerCase()) ||\n    u.location.toLowerCase().includes(searchUsers.toLowerCase())\n  );\n\n  const filteredRoles = allRoles.filter(role =>\n    role.nazev_role.toLowerCase().includes(searchRoles.toLowerCase()) ||\n    (role.popis && role.popis.toLowerCase().includes(searchRoles.toLowerCase()))\n  );\n\n  const filteredLocations = allLocations.filter(loc =>\n    loc.name.toLowerCase().includes(searchLocations.toLowerCase()) ||\n    loc.code.toLowerCase().includes(searchLocations.toLowerCase())\n  );\n\n  const filteredDepartments = allDepartments.filter(dept =>\n    dept.name.toLowerCase().includes(searchDepartments.toLowerCase()) ||\n    dept.code.toLowerCase().includes(searchDepartments.toLowerCase())\n  );\n\n  const filteredNotificationTemplates = allNotificationTemplates.filter(template =>\n    template.name.toLowerCase().includes(searchTemplates.toLowerCase()) ||\n    (template.description && template.description.toLowerCase().includes(searchTemplates.toLowerCase()))\n  );\n\n  // Hot-reload error fallback\n  if (hasError) {\n    return (\n      <Container>\n        <Header>\n          <Title>\n            <FontAwesomeIcon icon={faSitemap} />\n            Systm workflow a notifikac\n          </Title>\n        </Header>\n        <div style={{ \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'center', \n          height: '100%',\n          color: '#f59e0b',\n          fontSize: '1.1rem'\n        }}>\n          <div style={{ textAlign: 'center' }}>\n            <div style={{ fontSize: '3rem', marginBottom: '1rem' }}></div>\n            <div style={{ marginBottom: '1rem' }}>Hot-reload chyba detekovna</div>\n            <button \n              onClick={() => window.location.reload()} \n              style={{\n                padding: '12px 24px',\n                background: '#3b82f6',\n                color: 'white',\n                border: 'none',\n                borderRadius: '8px',\n                cursor: 'pointer',\n                fontSize: '1rem',\n                fontWeight: '600'\n              }}\n            >\n              Obnovit strnku (F5)\n            </button>\n          </div>\n        </div>\n      </Container>\n    );\n  }\n\n  if (loading) {\n    return (\n      <Container>\n        <Header>\n          <Title>\n            <FontAwesomeIcon icon={faSitemap} />\n            Systm workflow a notifikac\n          </Title>\n        </Header>\n        <div style={{ \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'center', \n          height: '100%',\n          color: '#64748b',\n          fontSize: '1.1rem'\n        }}>\n          <div style={{ textAlign: 'center' }}>\n            <div style={{ fontSize: '3rem', marginBottom: '1rem' }}></div>\n            <div>Natn hierarchie...</div>\n          </div>\n        </div>\n      </Container>\n    );\n  }\n\n  if (error) {\n    return (\n      <Container>\n        <Header>\n          <Title>\n            <FontAwesomeIcon icon={faSitemap} />\n            Systm workflow a notifikac\n          </Title>\n        </Header>\n        <div style={{ \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'center', \n          height: '100%',\n          color: '#ef4444',\n          fontSize: '1.1rem'\n        }}>\n          <div style={{ textAlign: 'center' }}>\n            <div style={{ fontSize: '3rem', marginBottom: '1rem' }}></div>\n            <div>Chyba pi natn: {error}</div>\n          </div>\n        </div>\n      </Container>\n    );\n  }\n\n  return (\n    <Container>\n      {/* Custom scrollbar pro email preview */}\n      <style>{`\n        .email-preview-body::-webkit-scrollbar {\n          width: 8px;\n        }\n        .email-preview-body::-webkit-scrollbar-track {\n          background: #f9fafb;\n        }\n        .email-preview-body::-webkit-scrollbar-thumb {\n          background: #d1d5db;\n          border-radius: 4px;\n        }\n        .email-preview-body::-webkit-scrollbar-thumb:hover {\n          background: #9ca3af;\n        }\n      `}</style>\n      <Header>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\n          <Title>\n            <FontAwesomeIcon icon={faSitemap} />\n            Systm workflow a notifikac\n          </Title>\n          {(nodes.length > 0 || edges.length > 0) && (\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: '8px',\n              padding: '8px 12px',\n              background: hasDraft ? '#dbeafe' : '#fef3c7',\n              border: `1px solid ${hasDraft ? '#60a5fa' : '#fbbf24'}`,\n              borderRadius: '6px',\n              fontSize: '0.85rem',\n              color: hasDraft ? '#1e3a8a' : '#92400e'\n            }}>\n              <span style={{ fontSize: '1.2rem' }}>{hasDraft ? '' : ''}</span>\n              <span>\n                <strong>{nodes.length}</strong> uzl, <strong>{edges.length}</strong> vztah\n                <br/>\n                <span style={{ fontSize: '0.75rem', opacity: 0.8 }}>\n                  {hasDraft ? 'Nacteno z auto-draftu' : 'Neulozeno (auto-draft)'}\n                </span>\n              </span>\n            </div>\n          )}\n        </div>\n        <HeaderActions>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px', minWidth: '320px' }}>\n            <label style={{ fontSize: '0.85rem', fontWeight: 600, color: '#6b7280', whiteSpace: 'nowrap' }}>\n              Profil:\n            </label>\n            <ProfileSelectWrapper>\n              <ProfileSelect\n                value={currentProfile?.id || ''}\n                onChange={(e) => handleProfileChange(e.target.value)}\n              >\n                {profiles.map(profile => (\n                  <option key={profile.id} value={profile.id}>\n                    {profile.name}\n                    {profile.isActive ? ' ' : ' '}\n                    {profile.relationshipsCount > 0 ? ` (${profile.relationshipsCount})` : ''}\n                  </option>\n                ))}\n              </ProfileSelect>\n              <ProfileSelectArrow></ProfileSelectArrow>\n              <ProfileDeleteButton\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleToggleProfileActive();\n                }}\n                disabled={!currentProfile}\n                title={currentProfile?.isActive ? 'Deaktivovat profil (skryje se v AppSettings)' : 'Aktivovat profil (zobraz se v AppSettings)'}\n                style={{ \n                  background: currentProfile?.isActive ? '#10b981' : '#6b7280',\n                  marginRight: '4px',\n                  fontSize: '0.85rem',\n                  padding: '4px 8px'\n                }}\n              >\n                {currentProfile?.isActive ? '' : ''}\n              </ProfileDeleteButton>\n              <ProfileDeleteButton\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleDeleteProfile();\n                }}\n                disabled={!currentProfile || profiles.length <= 1}\n                title={profiles.length <= 1 ? 'Nelze smazat posledn profil' : 'Smazat aktuln profil'}\n              >\n                \n              </ProfileDeleteButton>\n            </ProfileSelectWrapper>\n          </div>\n          <Button onClick={handleAutoGenerateHierarchy} disabled={loading || allUsers.length === 0}>\n            <span style={{ fontSize: '1.1rem', marginRight: '4px' }}></span>\n            AI Asistent\n          </Button>\n          <Button \n            onClick={() => {\n              if (nodes.length > 0) {\n                const { nodes: layoutedNodes, edges: layoutedEdges } = getLayoutedElements(nodes, edges, 'TB');\n                setNodes(layoutedNodes);\n                setEdges(layoutedEdges);\n                console.log(' Manual layout applied');\n              }\n            }}\n            disabled={nodes.length === 0}\n            title=\"Automaticky prerovnat existujici strukturu\"\n          >\n            <span style={{ fontSize: '1.1rem', marginRight: '4px' }}></span>\n            Perovnat\n          </Button>\n          <Button>\n            <FontAwesomeIcon icon={faEye} />\n            Nhled\n          </Button>\n          <Button primary onClick={() => handleSave()} disabled={loading || (nodes.length === 0 && edges.length === 0)}>\n            <FontAwesomeIcon icon={faSave} />\n            Uloit\n          </Button>\n          <Button onClick={handleSaveAs} disabled={loading || (nodes.length === 0 && edges.length === 0)}>\n            <FontAwesomeIcon icon={faSave} />\n            Uloit jako...\n          </Button>\n        </HeaderActions>\n      </Header>\n\n      {/* Legenda barev vztah */}\n      <div style={{\n        padding: '8px 16px',\n        background: 'linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)',\n        borderBottom: '2px solid #e0e6ed',\n        display: 'flex',\n        alignItems: 'center',\n        gap: '20px',\n        fontSize: '0.8rem',\n        flexWrap: 'wrap'\n      }}>\n        <span style={{ fontWeight: 700, color: '#475569' }}>Legenda vztah:</span>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>\n          <div style={{ width: '30px', height: '3px', background: '#3b82f6', borderRadius: '2px' }}></div>\n          <span style={{ color: '#1e40af' }}>Uivatel</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>\n          <div style={{ width: '30px', height: '3px', background: '#92400e', borderRadius: '2px' }}></div>\n          <span style={{ color: '#78350f' }}>Lokalita</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>\n          <div style={{ width: '30px', height: '3px', background: '#059669', borderRadius: '2px' }}></div>\n          <span style={{ color: '#065f46' }}>sek</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>\n          <div style={{ width: '30px', height: '3px', background: '#f59e0b', borderRadius: '2px' }}></div>\n          <span style={{ color: '#d97706' }}>Notifikace</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>\n          <div style={{ width: '30px', height: '3px', background: '#8b5cf6', borderRadius: '2px' }}></div>\n          <span style={{ color: '#6d28d9' }}>Role</span>\n        </div>\n      </div>\n\n      <MainContent>\n        <Sidebar>\n            <SidebarHeader>\n              <SidebarTitle>\n                <FontAwesomeIcon icon={faLayerGroup} />\n                Pehled poloek workflow\n              </SidebarTitle>\n            </SidebarHeader>\n\n            {/* Globln search box - vyhledv ve vech sekcch najednou */}\n            <SearchBox>\n              <SearchIcon>\n                <FontAwesomeIcon icon={faSearch} />\n              </SearchIcon>\n              <SearchInput\n                placeholder=\"Hledat ve vech sekcch...\"\n                value={searchUsers}\n                onChange={(e) => {\n                  const value = e.target.value;\n                  setSearchUsers(value);\n                  setSearchLocations(value);\n                  setSearchDepartments(value);\n                  setSearchTemplates(value);\n                }}\n              />\n              {searchUsers && (\n                <SearchClearButton\n                  onClick={() => {\n                    setSearchUsers('');\n                    setSearchLocations('');\n                    setSearchDepartments('');\n                    setSearchTemplates('');\n                  }}\n                  title=\"Vymazat vyhledvn ve vech sekcch\"\n                >\n                  <FontAwesomeIcon icon={faTimes} />\n                </SearchClearButton>\n              )}\n            </SearchBox>\n\n            <SidebarContent>\n              <CollapsibleSection>\n                <SectionHeader \n                  expanded={expandedSections.users}\n                  onClick={() => toggleSection('users')}\n                >\n                  <FontAwesomeIcon icon={expandedSections.users ? faChevronDown : faChevronRight} />\n                  <FontAwesomeIcon icon={faUsers} />\n                  UIVATEL ({filteredUsers.length})\n                  {selectedUsers.size > 0 && (\n                    <span style={{ marginLeft: 'auto', fontSize: '0.8rem', color: '#667eea', fontWeight: 'bold' }}>\n                      {selectedUsers.size} vybrno\n                    </span>\n                  )}\n                </SectionHeader>\n                <SectionContent expanded={expandedSections.users}>\n                  {/* Search box pro uivatele */}\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed' }}>\n                    <SearchBox style={{ margin: 0 }}>\n                      <SearchIcon>\n                        <FontAwesomeIcon icon={faSearch} />\n                      </SearchIcon>\n                      <SearchInput\n                        placeholder=\"Hledat uivatele...\"\n                        value={searchUsers}\n                        onChange={(e) => setSearchUsers(e.target.value)}\n                        style={{ fontSize: '0.85rem', padding: '8px 32px' }}\n                      />\n                      {searchUsers && (\n                        <SearchClearButton\n                          onClick={() => setSearchUsers('')}\n                          title=\"Vymazat\"\n                        >\n                          <FontAwesomeIcon icon={faTimes} />\n                        </SearchClearButton>\n                      )}\n                    </SearchBox>\n                  </div>\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed', display: 'flex', gap: '8px' }}>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        if (selectedUsers.size === filteredUsers.length) {\n                          deselectAllUsers();\n                        } else {\n                          selectAllUsers();\n                        }\n                      }}\n                      style={{\n                        flex: 1,\n                        padding: '6px 12px',\n                        background: '#f8fafc',\n                        border: '1px solid #e0e6ed',\n                        borderRadius: '6px',\n                        cursor: 'pointer',\n                        fontSize: '0.8rem',\n                        fontWeight: '600',\n                        color: '#475569',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => e.target.style.background = '#e2e8f0'}\n                      onMouseLeave={(e) => e.target.style.background = '#f8fafc'}\n                    >\n                      {selectedUsers.size === filteredUsers.length ? ' Zruit ve' : ' Vybrat ve'}\n                    </button>\n                  </div>\n                  <div>\n                    {filteredUsers.map((user) => (\n                      <UserItem\n                        key={user.id}\n                        draggable\n                        onDragStart={(e) => {\n                          e.dataTransfer.effectAllowed = 'move';\n                          e.dataTransfer.setData('application/reactflow', user.id);\n                          setDraggedItem(user.id);\n                          console.log(' Drag start:', user.id, user.name);\n                        }}\n                        onDragEnd={() => {\n                          setDraggedItem(null);\n                          console.log(' Drag end');\n                        }}\n                        style={{\n                          background: selectedUsers.has(user.id) ? '#ede9fe' : 'white',\n                          borderColor: selectedUsers.has(user.id) ? '#8b5cf6' : '#e0e6ed',\n                          cursor: 'grab'\n                        }}\n                      >\n                                <input\n                                  type=\"checkbox\"\n                                  checked={selectedUsers.has(user.id)}\n                                  onChange={(e) => {\n                                    e.stopPropagation();\n                                    toggleUserSelection(user.id);\n                                  }}\n                                  onClick={(e) => e.stopPropagation()}\n                                  style={{\n                                    width: '18px',\n                                    height: '18px',\n                                    cursor: 'pointer',\n                                    accentColor: '#8b5cf6',\n                                    flexShrink: 0\n                                  }}\n                                />\n                                <UserAvatar>{user.initials}</UserAvatar>\n                                <UserInfo>\n                                  <UserName>{user.name}</UserName>\n                                  <UserMeta>\n                                    {user.position}  {user.location}\n                                  </UserMeta>\n                        </UserInfo>\n                      </UserItem>\n                    ))}\n                  </div>\n                </SectionContent>\n              </CollapsibleSection>\n\n              {/* SEKCE: ROLE */}\n              <CollapsibleSection>\n                <SectionHeader \n                  expanded={expandedSections.roles}\n                  onClick={() => toggleSection('roles')}\n                >\n                  <FontAwesomeIcon icon={expandedSections.roles ? faChevronDown : faChevronRight} />\n                  <FontAwesomeIcon icon={faUserShield} />\n                  ROLE ({filteredRoles.length})\n                </SectionHeader>\n                <SectionContent expanded={expandedSections.roles}>\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed' }}>\n                    <SearchBox style={{ margin: 0 }}>\n                      <SearchIcon>\n                        <FontAwesomeIcon icon={faSearch} />\n                      </SearchIcon>\n                      <SearchInput\n                        placeholder=\"Hledat roli...\"\n                        value={searchRoles}\n                        onChange={(e) => setSearchRoles(e.target.value)}\n                        style={{ fontSize: '0.85rem', padding: '8px 32px' }}\n                      />\n                      {searchRoles && (\n                        <SearchClearButton\n                          onClick={() => setSearchRoles('')}\n                          title=\"Vymazat\"\n                        >\n                          <FontAwesomeIcon icon={faTimes} />\n                        </SearchClearButton>\n                      )}\n                    </SearchBox>\n                    <button\n                      onClick={() => {\n                        if (selectedRoles.size === filteredRoles.length) {\n                          setSelectedRoles(new Set());\n                        } else {\n                          setSelectedRoles(new Set(filteredRoles.map(r => r.id)));\n                        }\n                      }}\n                      style={{\n                        width: '100%',\n                        marginTop: '8px',\n                        padding: '6px 12px',\n                        background: '#f8fafc',\n                        border: '1px solid #e0e6ed',\n                        borderRadius: '6px',\n                        cursor: 'pointer',\n                        fontSize: '0.8rem',\n                        fontWeight: '600',\n                        color: '#475569',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => e.target.style.background = '#e2e8f0'}\n                      onMouseLeave={(e) => e.target.style.background = '#f8fafc'}\n                    >\n                      {selectedRoles.size === filteredRoles.length ? ' Zruit ve' : ' Vybrat ve'}\n                    </button>\n                  </div>\n                  <div>\n                    {filteredRoles.map((role) => (\n                      <UserItem\n                        key={`role-${role.id}`}\n                        draggable\n                        onDragStart={(e) => {\n                          e.dataTransfer.effectAllowed = 'move';\n                          e.dataTransfer.setData('application/reactflow', `role-${role.id}`);\n                          setDraggedItem(`role-${role.id}`);\n                        }}\n                        onDragEnd={() => setDraggedItem(null)}\n                        style={{\n                          background: selectedRoles.has(role.id) ? '#f5f3ff' : 'white',\n                          borderColor: selectedRoles.has(role.id) ? '#8b5cf6' : '#e0e6ed',\n                          cursor: 'grab'\n                        }}\n                      >\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedRoles.has(role.id)}\n                          onChange={(e) => {\n                            e.stopPropagation();\n                            toggleRoleSelection(role.id);\n                          }}\n                          onClick={(e) => e.stopPropagation()}\n                          style={{\n                            width: '18px',\n                            height: '18px',\n                            cursor: 'pointer',\n                            accentColor: '#8b5cf6',\n                            flexShrink: 0\n                          }}\n                        />\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '10px', flex: 1 }}>\n                          <FontAwesomeIcon icon={faUserShield} style={{ color: '#8b5cf6', fontSize: '1.1rem' }} />\n                          <div style={{ flex: 1 }}>\n                            <div style={{ fontWeight: '600', fontSize: '0.85rem', color: '#6d28d9' }}>\n                              {role.nazev_role}\n                            </div>\n                            <div style={{ fontSize: '0.7rem', color: '#8b5cf6', marginTop: '2px' }}>\n                              {role.userCount || 0} uivatel{role.popis ? `  ${role.popis}` : ''}\n                            </div>\n                          </div>\n                        </div>\n                      </UserItem>\n                    ))}\n                  </div>\n                </SectionContent>\n              </CollapsibleSection>\n\n              <CollapsibleSection>\n                <SectionHeader \n                  expanded={expandedSections.locations}\n                  onClick={() => toggleSection('locations')}\n                >\n                  <FontAwesomeIcon icon={expandedSections.locations ? faChevronDown : faChevronRight} />\n                  <FontAwesomeIcon icon={faMapMarkerAlt} />\n                  LOKALITY ({filteredLocations.length})\n                  {selectedLocations.size > 0 && (\n                    <span style={{ marginLeft: 'auto', fontSize: '0.8rem', color: '#f5576c', fontWeight: 'bold' }}>\n                      {selectedLocations.size} vybrno\n                    </span>\n                  )}\n                </SectionHeader>\n                <SectionContent expanded={expandedSections.locations}>\n                  {/* Search box pro lokality */}\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed' }}>\n                    <SearchBox style={{ margin: 0 }}>\n                      <SearchIcon>\n                        <FontAwesomeIcon icon={faSearch} />\n                      </SearchIcon>\n                      <SearchInput\n                        placeholder=\"Hledat lokalitu...\"\n                        value={searchLocations}\n                        onChange={(e) => setSearchLocations(e.target.value)}\n                        style={{ fontSize: '0.85rem', padding: '8px 32px' }}\n                      />\n                      {searchLocations && (\n                        <SearchClearButton\n                          onClick={() => setSearchLocations('')}\n                          title=\"Vymazat\"\n                        >\n                          <FontAwesomeIcon icon={faTimes} />\n                        </SearchClearButton>\n                      )}\n                    </SearchBox>\n                  </div>\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed', display: 'flex', gap: '8px' }}>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        if (selectedLocations.size === filteredLocations.length) {\n                          deselectAllLocations();\n                        } else {\n                          selectAllLocations();\n                        }\n                      }}\n                      style={{\n                        flex: 1,\n                        padding: '6px 12px',\n                        background: '#f8fafc',\n                        border: '1px solid #e0e6ed',\n                        borderRadius: '6px',\n                        cursor: 'pointer',\n                        fontSize: '0.8rem',\n                        fontWeight: '600',\n                        color: '#475569',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => e.target.style.background = '#e2e8f0'}\n                      onMouseLeave={(e) => e.target.style.background = '#f8fafc'}\n                    >\n                      {selectedLocations.size === filteredLocations.length ? ' Zruit ve' : ' Vybrat ve'}\n                    </button>\n                  </div>\n                  <div>\n                    {filteredLocations.map((loc) => (\n                      <LocationItem\n                        key={loc.id}\n                        draggable\n                        onDragStart={(e) => {\n                          e.dataTransfer.effectAllowed = 'move';\n                          e.dataTransfer.setData('application/reactflow', `loc-${loc.id}`);\n                          setDraggedItem(`loc-${loc.id}`);\n                          console.log(' Drag start location:', loc.id, loc.name);\n                        }}\n                        onDragEnd={() => {\n                          setDraggedItem(null);\n                          console.log(' Drag end');\n                        }}\n                        style={{\n                          background: selectedLocations.has(loc.id) ? '#fef3c7' : 'white',\n                          borderColor: selectedLocations.has(loc.id) ? '#fbbf24' : '#e0e6ed',\n                          cursor: 'grab'\n                        }}\n                      >\n                                <input\n                                  type=\"checkbox\"\n                                  checked={selectedLocations.has(loc.id)}\n                                  onChange={(e) => {\n                                    e.stopPropagation();\n                                    toggleLocationSelection(loc.id);\n                                  }}\n                                  onClick={(e) => e.stopPropagation()}\n                                  style={{\n                                    width: '18px',\n                                    height: '18px',\n                                    cursor: 'pointer',\n                                    accentColor: '#f59e0b',\n                                    flexShrink: 0\n                                  }}\n                                />\n                                <LocationIcon>\n                                  <FontAwesomeIcon icon={faBuilding} />\n                                </LocationIcon>\n                        <UserInfo>\n                          <UserName>{loc.name}</UserName>\n                          <UserMeta>{loc.userCount} uivatel  {loc.code}</UserMeta>\n                        </UserInfo>\n                      </LocationItem>\n                    ))}\n                  </div>\n                </SectionContent>\n              </CollapsibleSection>\n\n              <CollapsibleSection>\n                <SectionHeader \n                  expanded={expandedSections.departments}\n                  onClick={() => toggleSection('departments')}\n                >\n                  <FontAwesomeIcon icon={expandedSections.departments ? faChevronDown : faChevronRight} />\n                  <FontAwesomeIcon icon={faUserTie} />\n                  SEKY ({filteredDepartments.length})\n                  {selectedDepartments.size > 0 && (\n                    <span style={{ marginLeft: 'auto', fontSize: '0.8rem', color: '#00f2fe', fontWeight: 'bold' }}>\n                      {selectedDepartments.size} vybrno\n                    </span>\n                  )}\n                </SectionHeader>\n                <SectionContent expanded={expandedSections.departments}>\n                  {/* Search box pro tvary */}\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed' }}>\n                    <SearchBox style={{ margin: 0 }}>\n                      <SearchIcon>\n                        <FontAwesomeIcon icon={faSearch} />\n                      </SearchIcon>\n                      <SearchInput\n                        placeholder=\"Hledat tvar...\"\n                        value={searchDepartments}\n                        onChange={(e) => setSearchDepartments(e.target.value)}\n                        style={{ fontSize: '0.85rem', padding: '8px 32px' }}\n                      />\n                      {searchDepartments && (\n                        <SearchClearButton\n                          onClick={() => setSearchDepartments('')}\n                          title=\"Vymazat\"\n                        >\n                          <FontAwesomeIcon icon={faTimes} />\n                        </SearchClearButton>\n                      )}\n                    </SearchBox>\n                  </div>\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed', display: 'flex', gap: '8px' }}>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        if (selectedDepartments.size === filteredDepartments.length) {\n                          deselectAllDepartments();\n                        } else {\n                          selectAllDepartments();\n                        }\n                      }}\n                      style={{\n                        flex: 1,\n                        padding: '6px 12px',\n                        background: '#f8fafc',\n                        border: '1px solid #e0e6ed',\n                        borderRadius: '6px',\n                        cursor: 'pointer',\n                        fontSize: '0.8rem',\n                        fontWeight: '600',\n                        color: '#475569',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => e.target.style.background = '#e2e8f0'}\n                      onMouseLeave={(e) => e.target.style.background = '#f8fafc'}\n                    >\n                      {selectedDepartments.size === filteredDepartments.length ? ' Zruit ve' : ' Vybrat ve'}\n                    </button>\n                  </div>\n                  <div>\n                    {filteredDepartments.map((dept) => (\n                      <LocationItem\n                        key={dept.id}\n                        draggable\n                        onDragStart={(e) => {\n                          e.dataTransfer.effectAllowed = 'move';\n                          e.dataTransfer.setData('application/reactflow', `dept-${dept.id}`);\n                          setDraggedItem(`dept-${dept.id}`);\n                          console.log(' Drag start department:', dept.id, dept.name);\n                        }}\n                        onDragEnd={() => {\n                          setDraggedItem(null);\n                          console.log(' Drag end');\n                        }}\n                        style={{\n                          background: selectedDepartments.has(dept.id) ? '#dbeafe' : 'white',\n                          borderColor: selectedDepartments.has(dept.id) ? '#60a5fa' : '#e0e6ed',\n                          cursor: 'grab'\n                        }}\n                      >\n                                <input\n                                  type=\"checkbox\"\n                                  checked={selectedDepartments.has(dept.id)}\n                                  onChange={(e) => {\n                                    e.stopPropagation();\n                                    toggleDepartmentSelection(dept.id);\n                                  }}\n                                  onClick={(e) => e.stopPropagation()}\n                                  style={{\n                                    width: '18px',\n                                    height: '18px',\n                                    cursor: 'pointer',\n                                    accentColor: '#3b82f6',\n                                    flexShrink: 0\n                                  }}\n                                />\n                                <DepartmentIcon>\n                                  <FontAwesomeIcon icon={faUserTie} />\n                                </DepartmentIcon>\n                        <UserInfo>\n                          <UserName>{dept.name}</UserName>\n                          <UserMeta>{dept.userCount} uivatel  {dept.code}</UserMeta>\n                        </UserInfo>\n                      </LocationItem>\n                    ))}\n                  </div>\n                </SectionContent>\n              </CollapsibleSection>\n\n              {/* NOTIFIKAN ABLONY - Nov sekce */}\n              <CollapsibleSection>\n                <SectionHeader\n                  expanded={expandedSections.notificationTemplates}\n                  onClick={() => toggleSection('notificationTemplates')}\n                >\n                  <FontAwesomeIcon icon={expandedSections.notificationTemplates ? faChevronDown : faChevronRight} />\n                  <FontAwesomeIcon icon={faBell} />\n                  NOTIFIKAN ABLONY ({filteredNotificationTemplates.length})\n                  {selectedNotificationTemplates.size > 0 && (\n                    <span style={{ marginLeft: 'auto', fontSize: '0.8rem', color: '#f59e0b', fontWeight: 'bold' }}>\n                      {selectedNotificationTemplates.size} vybrno\n                    </span>\n                  )}\n                </SectionHeader>\n                <SectionContent expanded={expandedSections.notificationTemplates}>\n                  {/* Search box pro notifikan ablony */}\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed' }}>\n                    <SearchBox style={{ margin: 0 }}>\n                      <SearchIcon>\n                        <FontAwesomeIcon icon={faSearch} />\n                      </SearchIcon>\n                      <SearchInput\n                        placeholder=\"Hledat ablonu...\"\n                        value={searchTemplates}\n                        onChange={(e) => setSearchTemplates(e.target.value)}\n                        style={{ fontSize: '0.85rem', padding: '8px 32px' }}\n                      />\n                      {searchTemplates && (\n                        <SearchClearButton\n                          onClick={() => setSearchTemplates('')}\n                          title=\"Vymazat\"\n                        >\n                          <FontAwesomeIcon icon={faTimes} />\n                        </SearchClearButton>\n                      )}\n                    </SearchBox>\n                  </div>\n                  <div style={{ padding: '8px 12px', borderBottom: '1px solid #e0e6ed', display: 'flex', gap: '8px' }}>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        if (selectedNotificationTemplates.size === filteredNotificationTemplates.length) {\n                          deselectAllNotificationTemplates();\n                        } else {\n                          selectAllNotificationTemplates();\n                        }\n                      }}\n                      style={{\n                        flex: 1,\n                        padding: '6px 12px',\n                        background: '#f8fafc',\n                        border: '1px solid #e0e6ed',\n                        borderRadius: '6px',\n                        cursor: 'pointer',\n                        fontSize: '0.8rem',\n                        fontWeight: '600',\n                        color: '#475569',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => e.target.style.background = '#e2e8f0'}\n                      onMouseLeave={(e) => e.target.style.background = '#f8fafc'}\n                    >\n                      {selectedNotificationTemplates.size === filteredNotificationTemplates.length ? ' Zruit ve' : ' Vybrat ve'}\n                    </button>\n                  </div>\n                  <div>\n                    {filteredNotificationTemplates.map((template) => (\n                      <div\n                        key={template.id}\n                        draggable\n                        onDragStart={(e) => {\n                          e.dataTransfer.effectAllowed = 'move';\n                          e.dataTransfer.setData('application/reactflow', `notif-${template.id}`);\n                          setDraggedItem(`notif-${template.id}`);\n                          console.log(' Drag start notification template:', template.id, template.name);\n                        }}\n                        onDragEnd={() => {\n                          setDraggedItem(null);\n                          console.log(' Drag end');\n                        }}\n                        style={{\n                          padding: '12px',\n                          borderBottom: '1px solid #e0e6ed',\n                          display: 'flex',\n                          alignItems: 'flex-start',\n                          gap: '10px',\n                          cursor: 'grab',\n                          background: selectedNotificationTemplates.has(template.id) ? '#fef3c7' : 'white',\n                          transition: 'all 0.2s'\n                        }}\n                        onClick={() => toggleNotificationTemplateSelection(template.id)}\n                      >\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedNotificationTemplates.has(template.id)}\n                          onChange={() => toggleNotificationTemplateSelection(template.id)}\n                          onClick={(e) => e.stopPropagation()}\n                          style={{\n                            width: '18px',\n                            height: '18px',\n                            cursor: 'pointer',\n                            accentColor: '#f59e0b',\n                            flexShrink: 0,\n                            marginTop: '2px'\n                          }}\n                        />\n                        <div style={{\n                          width: '36px',\n                          height: '36px',\n                          borderRadius: '8px',\n                          background: 'linear-gradient(135deg, #f59e0b 0%, #ea580c 100%)',\n                          color: '#fff',\n                          display: 'flex',\n                          alignItems: 'center',\n                          justifyContent: 'center',\n                          fontSize: '1rem',\n                          flexShrink: 0,\n                          boxShadow: '0 2px 8px rgba(245, 158, 11, 0.3)'\n                        }}>\n                          <FontAwesomeIcon icon={faBell} />\n                        </div>\n                        <div style={{ flex: 1 }}>\n                          <div style={{ \n                            fontWeight: '600', \n                            color: '#2c3e50', \n                            fontSize: '0.9rem',\n                            marginBottom: '4px'\n                          }}>\n                            {template.name}\n                          </div>\n                          <div style={{ \n                            fontSize: '0.75rem', \n                            color: '#64748b',\n                            display: 'flex',\n                            alignItems: 'center',\n                            gap: '8px'\n                          }}>\n                            <code style={{ \n                              background: '#f1f5f9', \n                              padding: '2px 6px', \n                              borderRadius: '4px',\n                              fontSize: '0.7rem'\n                            }}>\n                              {template.type}\n                            </code>\n                            {template.email?.sendByDefault && (\n                              <span style={{ color: '#3b82f6' }}>\n                                <FontAwesomeIcon icon={faEnvelope} /> Email\n                              </span>\n                            )}\n                            <span style={{ \n                              color: template.priorityDefault === 'urgent' ? '#dc2626' : \n                                     template.priorityDefault === 'high' ? '#f59e0b' : '#64748b',\n                              fontWeight: '600'\n                            }}>\n                              {template.priorityDefault}\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </SectionContent>\n              </CollapsibleSection>\n            </SidebarContent>\n\n            {/* Akn tlatka - Pidat vybran (nad fixn patikou) */}\n            {(selectedUsers.size > 0 || selectedLocations.size > 0 || selectedDepartments.size > 0 || selectedNotificationTemplates.size > 0) && (\n              <div style={{\n                position: 'absolute',\n                bottom: '66px',\n                left: 0,\n                right: 0,\n                padding: '16px',\n                borderTop: '2px solid #e0e6ed',\n                background: 'linear-gradient(180deg, #f8fafc 0%, white 100%)',\n                boxShadow: '0 -4px 12px rgba(0,0,0,0.05)',\n                zIndex: 9\n              }}>\n                <button\n                  onClick={addSelectedToCanvas}\n                    style={{\n                      width: '100%',\n                      padding: '12px 16px',\n                      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '8px',\n                      cursor: 'pointer',\n                      fontSize: '0.95rem',\n                      fontWeight: '700',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      gap: '10px',\n                      boxShadow: '0 4px 12px rgba(102, 126, 234, 0.4)',\n                      transition: 'all 0.2s'\n                    }}\n                    onMouseEnter={(e) => {\n                      e.target.style.transform = 'translateY(-2px)';\n                      e.target.style.boxShadow = '0 6px 16px rgba(102, 126, 234, 0.5)';\n                    }}\n                    onMouseLeave={(e) => {\n                      e.target.style.transform = 'translateY(0)';\n                      e.target.style.boxShadow = '0 4px 12px rgba(102, 126, 234, 0.4)';\n                    }}\n                  >\n                    <FontAwesomeIcon icon={faPlus} />\n                  <span>\n                    Pidat vybran ({selectedUsers.size + selectedLocations.size + selectedDepartments.size + selectedNotificationTemplates.size})\n                  </span>\n                </button>\n                <div style={{\n                  marginTop: '8px',\n                  fontSize: '0.75rem',\n                  color: '#64748b',\n                  textAlign: 'center'\n                }}>\n                  {selectedUsers.size > 0 && `${selectedUsers.size} uivatel`}\n                  {selectedUsers.size > 0 && (selectedLocations.size > 0 || selectedDepartments.size > 0 || selectedNotificationTemplates.size > 0) && '  '}\n                  {selectedLocations.size > 0 && `${selectedLocations.size} lokalit`}\n                  {selectedLocations.size > 0 && (selectedDepartments.size > 0 || selectedNotificationTemplates.size > 0) && '  '}\n                  {selectedDepartments.size > 0 && `${selectedDepartments.size} tvar`}\n                  {selectedDepartments.size > 0 && selectedNotificationTemplates.size > 0 && '  '}\n                  {selectedNotificationTemplates.size > 0 && `${selectedNotificationTemplates.size} ablon`}\n                </div>\n              </div>\n            )}\n\n            {/* Fixn patika - Reset plochy (vdy viditeln) */}\n            <div style={{\n              position: 'absolute',\n              bottom: 0,\n              left: 0,\n              right: 0,\n              padding: '12px 16px',\n              background: 'white',\n              borderTop: '2px solid #e0e6ed',\n              boxShadow: '0 -4px 12px rgba(0,0,0,0.05)',\n              zIndex: 10\n            }}>\n              <button\n                onClick={() => {\n                  setConfirmDialog({\n                    isOpen: true,\n                    title: 'Resetovat plochu',\n                    message: 'Opravdu chcete smazat celou plochu a zat znovu od zatku? Tato akce je nevratn.',\n                    onConfirm: () => {\n                      setNodes([]);\n                      setEdges([]);\n                      localStorage.removeItem('hierarchy_draft_nodes');\n                      localStorage.removeItem('hierarchy_draft_edges');\n                      localStorage.removeItem('hierarchy_draft_timestamp');\n                      setHasDraft(false);\n                      setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null });\n                    }\n                  });\n                }}\n                disabled={nodes.length === 0}\n                style={{\n                  width: '100%',\n                  padding: '10px 16px',\n                  background: nodes.length === 0 ? '#f1f5f9' : 'white',\n                  color: nodes.length === 0 ? '#94a3b8' : '#dc2626',\n                  border: `2px solid ${nodes.length === 0 ? '#e2e8f0' : '#fecaca'}`,\n                  borderRadius: '8px',\n                  cursor: nodes.length === 0 ? 'not-allowed' : 'pointer',\n                  fontSize: '0.9rem',\n                  fontWeight: '600',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: '8px',\n                  transition: 'all 0.2s'\n                }}\n                onMouseEnter={(e) => {\n                  if (nodes.length > 0) {\n                    e.target.style.background = '#fef2f2';\n                    e.target.style.borderColor = '#dc2626';\n                  }\n                }}\n                onMouseLeave={(e) => {\n                  if (nodes.length > 0) {\n                    e.target.style.background = 'white';\n                    e.target.style.borderColor = '#fecaca';\n                  }\n                }}\n              >\n                <FontAwesomeIcon icon={faTrash} />\n                <span>Resetovat plochu</span>\n              </button>\n            </div>\n          </Sidebar>\n\n          <CanvasArea\n            onDrop={onReactFlowDrop}\n            onDragOver={onReactFlowDragOver}\n            className={isShiftPressed ? 'selection-mode' : ''}\n          >\n            <ReactFlow\n              nodes={nodes}\n              edges={edges}\n              onNodesChange={onNodesChange}\n              onEdgesChange={onEdgesChange}\n              onConnect={onConnect}\n              onNodeClick={onNodeClick}\n              onEdgeClick={onEdgeClick}\n              onNodeDragStop={onNodeDragStop}\n              onInit={setReactFlowInstance}\n              nodeTypes={nodeTypes}\n              fitView\n              attributionPosition=\"bottom-left\"\n              selectionOnDrag\n              panOnDrag\n              panOnScroll={true}\n              zoomOnScroll={true}\n              zoomOnDoubleClick={false}\n              selectionMode=\"partial\"\n              selectionKeyCode=\"Shift\"\n              multiSelectionKeyCode=\"Control\"\n              selectNodesOnDrag={false}\n              onSelectionChange={(params) => {\n                const selectedNodesCount = params.nodes.length;\n                const selectedEdgesCount = params.edges.length;\n                const totalSelected = selectedNodesCount + selectedEdgesCount;\n                \n                // Zobrazit detail panel jen kdy je vybrn prv 1 prvek\n                if (totalSelected === 1) {\n                  if (selectedNodesCount === 1) {\n                    setSelectedNode(params.nodes[0]);\n                    setSelectedEdge(null);\n                    setShowDetailPanel(true);\n                  } else if (selectedEdgesCount === 1) {\n                    setSelectedEdge(params.edges[0]);\n                    setSelectedNode(null);\n                    setShowDetailPanel(true);\n                  }\n                } else if (totalSelected > 1) {\n                  // Multi-select - skrt panel\n                  setShowDetailPanel(false);\n                  setSelectedNode(null);\n                  setSelectedEdge(null);\n                } else {\n                  // Nic nen vybrno\n                  setShowDetailPanel(false);\n                  setSelectedNode(null);\n                  setSelectedEdge(null);\n                }\n              }}\n            >\n                    <Background color=\"#cbd5e1\" gap={20} size={1} />\n                    <Controls />\n                    <MiniMap \n                      nodeColor={(node) => {\n                        if (node.data?.type === 'template') return '#f59e0b'; // Oranov pro ablony\n                        if (node.data?.type === 'location') return '#92400e'; // Tmav hnd pro lokality\n                        if (node.data?.type === 'department') return '#059669'; // Tmav zelen pro tvary\n                        return '#3b82f6'; // Modr pro uivatele\n                      }}\n                      maskColor=\"rgba(245, 247, 250, 0.8)\"\n                      pannable={true}\n                      zoomable={true}\n                      style={{\n                        background: 'white',\n                        border: '1px solid #e0e6ed',\n                        borderRadius: '8px',\n                        cursor: 'pointer'\n                      }}\n                    />\n                    {showHelp ? (\n                      <Panel position=\"top-left\" style={{\n                        background: 'white',\n                        borderRadius: '12px',\n                        border: '1px solid #e0e6ed',\n                        boxShadow: '0 4px 12px rgba(0,0,0,0.1)',\n                        padding: '16px',\n                        width: '360px',\n                        maxHeight: 'calc(100vh - 120px)',\n                        display: 'flex',\n                        flexDirection: 'column'\n                      }}>\n                        <div style={{\n                          display: 'flex',\n                          alignItems: 'center',\n                          justifyContent: 'space-between',\n                          marginBottom: '12px',\n                          paddingBottom: '10px',\n                          borderBottom: '1px solid #e0e6ed'\n                        }}>\n                          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                            <span style={{ fontSize: '1.4rem' }}></span>\n                            <strong style={{ color: '#2c3e50', fontSize: '0.95rem' }}>Npovda</strong>\n                          </div>\n                          <button\n                            onClick={() => {\n                              setShowHelp(false);\n                              localStorage.setItem('hierarchy_help_collapsed', 'true');\n                            }}\n                            style={{\n                              background: 'transparent',\n                              border: 'none',\n                              cursor: 'pointer',\n                              fontSize: '1.3rem',\n                              color: '#94a3b8',\n                              padding: '4px 8px',\n                              display: 'flex',\n                              alignItems: 'center',\n                              justifyContent: 'center',\n                              borderRadius: '6px',\n                              transition: 'all 0.2s'\n                            }}\n                            onMouseEnter={(e) => {\n                              e.currentTarget.style.background = '#f1f5f9';\n                              e.currentTarget.style.color = '#64748b';\n                            }}\n                            onMouseLeave={(e) => {\n                              e.currentTarget.style.background = 'transparent';\n                              e.currentTarget.style.color = '#94a3b8';\n                            }}\n                            title=\"Skrt npovdu\"\n                          >\n                            \n                          </button>\n                        </div>\n                        <div style={{\n                          overflowY: 'auto',\n                          overflowX: 'hidden',\n                          color: '#64748b',\n                          fontSize: '0.82rem',\n                          lineHeight: '1.5',\n                          paddingRight: '8px'\n                        }}>\n                          <div style={{ marginBottom: '12px' }}>\n                            <strong style={{ color: '#2c3e50', fontSize: '0.85rem', display: 'block', marginBottom: '4px' }}>\n                              1. Ovldn pltna:\n                            </strong>\n                             <strong>Posun:</strong> Thnte my (bez klvesy)<br/>\n                             <strong>SHIFT + taen:</strong> Vbr vce nod najednou<br/>\n                             <strong>CTRL + klik:</strong> Pidat/odebrat node do vbru\n                          </div>\n                          <div style={{ marginBottom: '12px' }}>\n                            <strong style={{ color: '#2c3e50', fontSize: '0.85rem', display: 'block', marginBottom: '4px' }}>\n                              2. Pidejte uivatele:\n                            </strong>\n                             Pethnte z levho panelu<br/>\n                             Nebo pouijte  AI Struktura\n                          </div>\n                          <div style={{ marginBottom: '12px' }}>\n                            <strong style={{ color: '#2c3e50', fontSize: '0.85rem', display: 'block', marginBottom: '4px' }}>\n                              3. Vytvote vztah (ipku):\n                            </strong>\n                             Najdte  zelen krouek DOLE u nadzenho<br/>\n                             Drte a thnte my<br/>\n                             Puste na  modr krouek NAHOE u podzenho\n                          </div>\n                          <div style={{ marginBottom: '12px' }}>\n                            <strong style={{ color: '#2c3e50', fontSize: '0.85rem', display: 'block', marginBottom: '4px' }}>\n                              4. Perovnn:\n                            </strong>\n                             Tlacitko  Prerovnat = automaticky layout<br/>\n                             Nebo petahujte uzly run\n                          </div>\n                          <div style={{ marginBottom: '12px' }}>\n                            <strong style={{ color: '#2c3e50', fontSize: '0.85rem', display: 'block', marginBottom: '4px' }}>\n                              5. Detail vztahu:\n                            </strong>\n                             Kliknte na ipku  oteve se prav panel<br/>\n                             Nastavte prva a lokality\n                          </div>\n                          <div style={{ marginBottom: '12px' }}>\n                            <strong style={{ color: '#f5576c', fontSize: '0.85rem', display: 'block', marginBottom: '4px' }}>\n                              6. Ulozeni:\n                            </strong>\n                             Tlatko \"Uloit do DB\" vpravo nahoe\n                          </div>\n                          <div style={{ padding: '10px', background: '#f0fdf4', borderRadius: '8px', border: '1px solid #86efac' }}>\n                            <strong style={{ color: '#10b981', fontSize: '0.85rem', display: 'block', marginBottom: '4px' }}>\n                               Auto-save:\n                            </strong>\n                            <span style={{ fontSize: '0.8rem' }}>\n                              Pozice uzlu se ukladaji automaticky do localStorage a obnovi se po refreshi. Draft se vymaze po ulozeni do DB.\n                            </span>\n                          </div>\n                        </div>\n                      </Panel>\n                    ) : (\n                      <Panel position=\"top-left\" style={{\n                        background: 'white',\n                        borderRadius: '12px',\n                        border: '1px solid #e0e6ed',\n                        boxShadow: '0 4px 12px rgba(0,0,0,0.1)',\n                        width: '52px',\n                        height: '52px',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        cursor: 'pointer',\n                        transition: 'all 0.2s'\n                      }}\n                      onClick={() => {\n                        setShowHelp(true);\n                        localStorage.setItem('hierarchy_help_collapsed', 'false');\n                      }}>\n                        <span \n                          style={{ fontSize: '1.7rem', transition: 'transform 0.2s' }}\n                          onMouseEnter={(e) => e.currentTarget.style.transform = 'scale(1.2)'}\n                          onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}\n                          title=\"Zobrazit npovdu\"\n                        >\n                          \n                        </span>\n                      </Panel>\n                    )}\n            </ReactFlow>\n          </CanvasArea>\n\n        {showDetailPanel && (selectedNode || selectedEdge) && (\n          <DetailPanel>\n            <DetailHeader>\n              <DetailHeaderTitle>\n                <FontAwesomeIcon icon={faEdit} />\n                {selectedNode ? 'Detail uzlu' : 'Detail vztahu'}\n              </DetailHeaderTitle>\n              <InfoButton onClick={() => setShowDetailHelpModal(true)}>\n                <FontAwesomeIcon icon={faInfoCircle} />\n              </InfoButton>\n              <CloseButton onClick={() => {\n                setShowDetailPanel(false);\n                setSelectedNode(null);\n                setSelectedEdge(null);\n                setNodes((nds) =>\n                  nds.map((n) => ({\n                    ...n,\n                    data: { ...n.data, isSelected: false }\n                  }))\n                );\n              }}>\n                <FontAwesomeIcon icon={faTimes} />\n              </CloseButton>\n            </DetailHeader>\n\n            <DetailContent>\n              <DetailSection>\n                <DetailSectionTitle>\n                  <FontAwesomeIcon icon={faUserTie} />\n                  Zkladn informace\n                </DetailSectionTitle>\n                \n                {/* NOTIFIKAN ABLONA */}\n                {selectedNode && selectedNode.data.type === 'template' && (\n                  <>\n                    <FormGroup>\n                      <Label>Nzev ablony</Label>\n                      <Input value={selectedNode.data.label || selectedNode.data.name} readOnly />\n                    </FormGroup>\n                    \n                    {/* NASTAVEN HTML ABLON PRO NORMLN A MIMODN STAV */}\n                    {(() => {\n                      const template = allNotificationTemplates.find(t => t.id === selectedNode.data.templateId);\n                      if (!template) return null;\n                      \n                      // Parser vech variant z email_body podle <!-- RECIPIENT: TYPE -->\n                      //  FZE 1 UPGRADE - Podporuje RECIPIENT i APPROVER_NORMAL\n                      const parseAllVariants = (emailBody) => {\n                        if (!emailBody) return [];\n                        \n                        const variants = [];\n                        \n                        // Definice vech monch variant\n                        const variantTypes = [\n                          //  NOV FORMT (Fze 1: order_status_schvalena, zamitnuta, ceka_se)\n                          { type: 'RECIPIENT', icon: '', name: 'Pjemce (oranov - normln)' },\n                          \n                          //  STAR FORMT (order_status_ke_schvaleni)\n                          { type: 'APPROVER_NORMAL', icon: '', name: 'Schvalovatel (oranov - normln)' },\n                          { type: 'APPROVER_URGENT', icon: '', name: 'Schvalovatel (erven - urgentn)' },\n                          \n                          //  SPOLEN VARIANTA (info/submitter)\n                          { type: 'SUBMITTER', icon: '', name: 'Autor objednvky (zelen - info)' }\n                        ];\n                        \n                        variantTypes.forEach(variantDef => {\n                          const marker = `<!-- RECIPIENT: ${variantDef.type} -->`;\n                          if (emailBody.includes(marker)) {\n                            variants.push({\n                              type: variantDef.type,\n                              icon: variantDef.icon,\n                              name: variantDef.name\n                            });\n                          }\n                        });\n                        \n                        return variants;\n                      };\n                      \n                      const availableVariants = parseAllVariants(template.email_body);\n                      \n                      // Uren vchozch hodnot\n                      const defaultVariant = availableVariants.length > 0 ? availableVariants[0].type : '';\n                      \n                      if (availableVariants.length === 0) {\n                        return (\n                          <div style={{\n                            padding: '12px',\n                            background: '#fef2f2',\n                            border: '1px solid #fecaca',\n                            borderRadius: '6px',\n                            color: '#991b1b',\n                            fontSize: '0.85rem'\n                          }}>\n                             <strong>Varovn:</strong> Email ablona neobsahuje dn varianty\n                          </div>\n                        );\n                      }\n                      \n                      return (\n                        <>\n                          {/* VBR HTML ABLONY PRO NORMLN STAV */}\n                          <FormGroup>\n                            <Label>\n                              HTML ablona pro NORMLN stav\n                              <span style={{ color: '#f59e0b', marginLeft: '4px' }}>*</span>\n                            </Label>\n                            <select\n                              value={templateNormalVariant || defaultVariant}\n                              onChange={(e) => setTemplateNormalVariant(e.target.value)}\n                              style={{\n                                width: '100%',\n                                padding: '10px 12px',\n                                border: '2px solid #e0e6ed',\n                                borderRadius: '6px',\n                                fontSize: '0.9rem',\n                                background: 'white',\n                                cursor: 'pointer',\n                                fontWeight: '500'\n                              }}\n                            >\n                              {availableVariants.map(variant => (\n                                <option key={variant.type} value={variant.type}>\n                                  {variant.icon} {variant.name}\n                                </option>\n                              ))}\n                            </select>\n                            <div style={{ \n                              fontSize: '0.7rem', \n                              color: '#64748b', \n                              marginTop: '4px',\n                              fontStyle: 'italic'\n                            }}>\n                              Tato HTML varianta se pouije pro bn ppady (nap. oranov)\n                            </div>\n                          </FormGroup>\n                          \n                          {/* VBR HTML ABLONY PRO MIMODN STAV */}\n                          <FormGroup>\n                            <Label>\n                              HTML ablona pro MIMODN stav\n                              <span style={{ color: '#f59e0b', marginLeft: '4px' }}>*</span>\n                            </Label>\n                            <select\n                              value={templateUrgentVariant || defaultVariant}\n                              onChange={(e) => setTemplateUrgentVariant(e.target.value)}\n                              style={{\n                                width: '100%',\n                                padding: '10px 12px',\n                                border: '2px solid #e0e6ed',\n                                borderRadius: '6px',\n                                fontSize: '0.9rem',\n                                background: 'white',\n                                cursor: 'pointer',\n                                fontWeight: '500'\n                              }}\n                            >\n                              {availableVariants.map(variant => (\n                                <option key={variant.type} value={variant.type}>\n                                  {variant.icon} {variant.name}\n                                </option>\n                              ))}\n                            </select>\n                            <div style={{ \n                              fontSize: '0.7rem', \n                              color: '#64748b', \n                              marginTop: '4px',\n                              fontStyle: 'italic'\n                            }}>\n                              Tato HTML varianta se pouije pro urgentn/mimodn ppady (nap. erven)\n                            </div>\n                          </FormGroup>\n                          \n                          {/* VBR HTML ABLONY PRO INFORMAN OZNMEN */}\n                          <FormGroup>\n                            <Label>\n                              HTML ablona pro INFORMAN oznmen\n                              <span style={{ color: '#f59e0b', marginLeft: '4px' }}>*</span>\n                            </Label>\n                            <select\n                              value={templateInfoVariant || defaultVariant}\n                              onChange={(e) => setTemplateInfoVariant(e.target.value)}\n                              style={{\n                                width: '100%',\n                                padding: '10px 12px',\n                                border: '2px solid #e0e6ed',\n                                borderRadius: '6px',\n                                fontSize: '0.9rem',\n                                background: 'white',\n                                cursor: 'pointer',\n                                fontWeight: '500'\n                              }}\n                            >\n                              {availableVariants.map(variant => (\n                                <option key={variant.type} value={variant.type}>\n                                  {variant.icon} {variant.name}\n                                </option>\n                              ))}\n                            </select>\n                            <div style={{ \n                              fontSize: '0.7rem', \n                              color: '#64748b', \n                              marginTop: '4px',\n                              fontStyle: 'italic'\n                            }}>\n                              Tato HTML varianta se pouije pro ist informan notifikace (nap. zelen)\n                            </div>\n                          </FormGroup>\n                          \n                          {/* INFO BOX */}\n                          <div style={{\n                            padding: '10px 12px',\n                            background: '#eff6ff',\n                            border: '1px solid #bfdbfe',\n                            borderRadius: '6px',\n                            fontSize: '0.75rem',\n                            color: '#1e40af',\n                            marginTop: '8px'\n                          }}>\n                            <strong> Jak to funguje:</strong>\n                            <ul style={{ margin: '6px 0 0 0', paddingLeft: '18px', lineHeight: '1.5' }}>\n                              <li>Mete definovat 3 rzn HTML varianty pro rzn situace</li>\n                              <li>Doporuen: Normln = <span style={{color: '#f59e0b', fontWeight: 'bold'}}> oranov</span>, Urgentn = <span style={{color: '#dc2626', fontWeight: 'bold'}}> erven</span>, Info = <span style={{color: '#10b981', fontWeight: 'bold'}}> zelen</span></li>\n                              <li>Backend automaticky vybere sprvnou podle udlosti a typu pjemce (definuje se v EDGE)</li>\n                              <li>EDGE (ipka) uruje typ notifikace: schvlen, info, nebo oboje</li>\n                            </ul>\n                          </div>\n                          \n                          {/* VBR PRO NHLED */}\n                          <FormGroup style={{ marginTop: '16px' }}>\n                            <Label>\n                              Varianta pro nhled ne\n                            </Label>\n                            <select\n                              value={templatePreviewVariant || templateNormalVariant || defaultVariant}\n                              onChange={(e) => setTemplatePreviewVariant(e.target.value)}\n                              style={{\n                                width: '100%',\n                                padding: '10px 12px',\n                                border: '2px solid #cbd5e1',\n                                borderRadius: '6px',\n                                fontSize: '0.85rem',\n                                background: '#f8fafc',\n                                cursor: 'pointer'\n                              }}\n                            >\n                              {availableVariants.map(variant => (\n                                <option key={variant.type} value={variant.type}>\n                                  {variant.icon} {variant.name}\n                                </option>\n                              ))}\n                            </select>\n                            <div style={{ \n                              fontSize: '0.7rem', \n                              color: '#64748b', \n                              marginTop: '4px',\n                              fontStyle: 'italic'\n                            }}>\n                               Toto ovld pouze nhled emailu ne (nem vliv na odesln)\n                            </div>\n                          </FormGroup>\n                        </>\n                      );\n                    })()}\n                    \n                    {/* PREVIEW NOTIFIKACE */}\n                    {(() => {\n                      const template = allNotificationTemplates.find(t => t.id === selectedNode.data.templateId);\n                      \n                      if (!template) return null;\n                      \n                      //  MOCK DATA pro nhled - kompletn seznam vech monch placeholder\n                      const mockData = {\n                        // Zkladn daje objednvky\n                        order_number: 'O-2025-00142',\n                        order_id: '142',\n                        ev_cislo: 'O-2025-00142',\n                        cislo_objednavky: 'O-2025-00142',\n                        \n                        // Stav a data\n                        status: 'Ke schvlen',\n                        old_status: 'Nov',\n                        new_status: 'Ke schvlen',\n                        datum_vytvoreni: '14.12.2025',\n                        datum_pozadavku: '14.12.2025',\n                        datum_zmeny: '14.12.2025 15:30',\n                        \n                        // Pedmt - vechny varianty\n                        predmet: 'Nkup kancelskho vybaven pro oddlen IT',\n                        order_subject: 'Nkup kancelskho vybaven pro oddlen IT',\n                        subject: 'Nkup kancelskho vybaven pro oddlen IT',\n                        \n                        // Ceny\n                        cena_celkem: '45 670 K',\n                        cena_bez_dph: '37 743 K',\n                        cena_s_dph: '45 670 K',\n                        max_price_with_dph: '50 000 K',\n                        \n                        // Dodavatel\n                        dodavatel: 'ALZA.cz s.r.o.',\n                        supplier_name: 'ALZA.cz s.r.o.',\n                        supplier: 'ALZA.cz s.r.o.',\n                        \n                        // adatel/Poadovatel\n                        pozadovatel_jmeno: 'Jan Novk',\n                        pozadovatel_email: 'jan.novak@example.com',\n                        pozadovatel: 'Jan Novk',\n                        requester_name: 'Jan Novk',\n                        requester_email: 'jan.novak@example.com',\n                        \n                        // Schvalovatel\n                        schvalovatel_jmeno: 'Ing. Petr Svoboda',\n                        schvalovatel_email: 'petr.svoboda@example.com',\n                        approver_name: 'Ing. Petr Svoboda',\n                        approver_email: 'petr.svoboda@example.com',\n                        \n                        // Akce a uivatel akce\n                        action_user_name: 'Jan Novk',\n                        action_performed_by: 'Jan Novk',\n                        action_date: '14.12.2025 15:30',\n                        \n                        // URL a odkazy\n                        url_objednavky: 'https://eeo.example.com/order-form-25?edit=142',\n                        order_url: 'https://eeo.example.com/order-form-25?edit=142',\n                        url: 'https://eeo.example.com/order-form-25?edit=142',\n                        \n                        // Poznmky a dvody\n                        poznamka: 'Nutn schvlit do konce tdne kvli slevov akci',\n                        reason: 'Zmna schvalovn dle internch smrnic',\n                        comment: 'dn dal poznmky',\n                        \n                        // Obecn\n                        user_name: 'Jan Novk',\n                        user_email: 'jan.novak@example.com',\n                        recipient_name: 'Ing. Petr Svoboda',\n                        \n                        // Datum a as\n                        date: '14.12.2025',\n                        time: '15:30',\n                        datetime: '14.12.2025 15:30'\n                      };\n                      \n                      // Funkce pro nahrazen placeholder mock daty (podporuje {key} i {{key}})\n                      const replacePlaceholders = (text) => {\n                        if (!text) return text;\n                        let result = text;\n                        Object.keys(mockData).forEach(key => {\n                          // Nahradit {key} i {{key}}\n                          const regex1 = new RegExp(`\\\\{${key}\\\\}`, 'g');\n                          const regex2 = new RegExp(`\\\\{\\\\{${key}\\\\}\\\\}`, 'g');\n                          result = result.replace(regex1, mockData[key]);\n                          result = result.replace(regex2, mockData[key]);\n                        });\n                        return result;\n                      };\n                      \n                      return (\n                        <>\n                          {/* Preview In-App Notifikace - STEJN STYL JAKO ZVONEK */}\n                          {(template.app_title || template.app_message) && (\n                            <div style={{ marginTop: '16px' }}>\n                              <Label style={{ marginBottom: '8px', display: 'block' }}>\n                                <FontAwesomeIcon icon={faBell} style={{ marginRight: '6px', color: '#f5576c' }} />\n                                Nhled In-App notifikace (zvonek)\n                              </Label>\n                              {/* Simulace NotificationItem ze zvoneku */}\n                              <div style={{\n                                padding: '16px',\n                                borderLeft: '4px solid #3b82f6',\n                                cursor: 'pointer',\n                                display: 'flex',\n                                gap: '12px',\n                                alignItems: 'start',\n                                background: 'linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)',\n                                borderRadius: '8px',\n                                border: '1px solid #93c5fd'\n                              }}>\n                                {/* Ikona notifikace */}\n                                <div style={{\n                                  width: '40px',\n                                  height: '40px',\n                                  borderRadius: '12px',\n                                  display: 'flex',\n                                  alignItems: 'center',\n                                  justifyContent: 'center',\n                                  fontSize: '20px',\n                                  flexShrink: 0,\n                                  background: 'linear-gradient(135deg, #3b82f6, #2563eb)',\n                                  color: 'white',\n                                  boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)'\n                                }}>\n                                  \n                                </div>\n                                \n                                {/* Content */}\n                                <div style={{ flex: 1, minWidth: 0 }}>\n                                  {/* Title - TUN */}\n                                  <div style={{\n                                    fontWeight: 700,\n                                    color: '#111827',\n                                    fontSize: '14px',\n                                    lineHeight: 1.4,\n                                    marginBottom: '4px',\n                                    overflow: 'hidden',\n                                    textOverflow: 'ellipsis',\n                                    display: '-webkit-box',\n                                    WebkitLineClamp: 2,\n                                    WebkitBoxOrient: 'vertical'\n                                  }}>\n                                    {replacePlaceholders(template.app_title) || 'Schvlena: O-1958/75030926/2025/IT'}\n                                  </div>\n                                  \n                                  {/* Message */}\n                                  {template.app_message && (\n                                    <div style={{\n                                      fontSize: '13px',\n                                      color: '#6b7280',\n                                      lineHeight: 1.5,\n                                      marginBottom: '6px',\n                                      overflow: 'hidden',\n                                      textOverflow: 'ellipsis',\n                                      display: '-webkit-box',\n                                      WebkitLineClamp: 2,\n                                      WebkitBoxOrient: 'vertical'\n                                    }}>\n                                      {replacePlaceholders(template.app_message)}\n                                    </div>\n                                  )}\n                                  \n                                  {/* Meta - as + uivatel */}\n                                  <div style={{\n                                    display: 'flex',\n                                    alignItems: 'center',\n                                    gap: '12px',\n                                    fontSize: '12px',\n                                    color: '#9ca3af',\n                                    marginTop: '6px'\n                                  }}>\n                                    {/* as */}\n                                    <span style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\n                                       Ped 1 h\n                                    </span>\n                                    {/* Uivatel */}\n                                    <span style={{\n                                      background: '#f3e8ff',\n                                      color: '#6b21a8',\n                                      padding: '2px 6px',\n                                      borderRadius: '4px',\n                                      fontSize: '11px',\n                                      fontWeight: 500\n                                    }}>\n                                       {mockData.action_performed_by || 'Jan Novk'}\n                                    </span>\n                                  </div>\n                                </div>\n                              </div>\n                              <div style={{\n                                marginTop: '6px',\n                                fontSize: '0.7rem',\n                                color: '#64748b',\n                                fontStyle: 'italic'\n                              }}>\n                                 Pesn toto uvid uivatel ve zvoneku  Mock data pro ukzku\n                              </div>\n                            </div>\n                          )}\n                          \n                          {/* Preview Email Notifikace - KOMPLETN NHLED s MOCK daty */}\n                          <div style={{ marginTop: '16px' }}>\n                            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '8px' }}>\n                              <Label style={{ marginBottom: '0', display: 'flex', alignItems: 'center', gap: '8px' }}>\n                                <FontAwesomeIcon icon={faEnvelope} style={{ marginRight: '6px', color: '#667eea' }} />\n                                Nhled Email ablony\n                                {(() => {\n                                  const variantType = templatePreviewVariant || templateNormalVariant || 'APPROVER_NORMAL';\n                                  const variantLabels = {\n                                    'APPROVER_NORMAL': '',\n                                    'APPROVER_URGENT': '',\n                                    'SUBMITTER': '',\n                                    'DEFAULT': ''\n                                  };\n                                  return (\n                                    <span style={{\n                                      padding: '4px 10px',\n                                      background: '#f3f4f6',\n                                      borderRadius: '6px',\n                                      fontSize: '0.75rem',\n                                      fontWeight: '600',\n                                      color: '#374151'\n                                    }}>\n                                      {variantLabels[variantType] || ''} {\n                                        variantType === 'APPROVER_NORMAL' ? 'Normln' :\n                                        variantType === 'APPROVER_URGENT' ? 'Mimodn' :\n                                        variantType === 'SUBMITTER' ? 'Autor' :\n                                        'Vchoz'\n                                      }\n                                    </span>\n                                  );\n                                })()}\n                              </Label>\n                              <button\n                                onClick={() => {\n                                  setFullscreenEmailData({\n                                    template,\n                                    mockData,\n                                    replacePlaceholders,\n                                    selectedVariantType: templatePreviewVariant || templateNormalVariant || 'APPROVER_NORMAL'\n                                  });\n                                  setShowFullscreenEmailModal(true);\n                                }}\n                                style={{\n                                  padding: '8px',\n                                  background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n                                  color: 'white',\n                                  border: 'none',\n                                  borderRadius: '8px',\n                                  cursor: 'pointer',\n                                  fontSize: '1rem',\n                                  display: 'flex',\n                                  alignItems: 'center',\n                                  justifyContent: 'center',\n                                  width: '36px',\n                                  height: '36px',\n                                  transition: 'all 0.2s',\n                                  boxShadow: '0 2px 8px rgba(102, 126, 234, 0.3)'\n                                }}\n                                onMouseEnter={(e) => {\n                                  e.currentTarget.style.transform = 'translateY(-2px) scale(1.05)';\n                                  e.currentTarget.style.boxShadow = '0 4px 12px rgba(102, 126, 234, 0.5)';\n                                }}\n                                onMouseLeave={(e) => {\n                                  e.currentTarget.style.transform = 'translateY(0) scale(1)';\n                                  e.currentTarget.style.boxShadow = '0 2px 8px rgba(102, 126, 234, 0.3)';\n                                }}\n                                title=\"Otevt fullscreen nhled\"\n                              >\n                                <FontAwesomeIcon icon={faExpand} />\n                              </button>\n                            </div>\n                            <div style={{\n                              border: '2px solid #667eea',\n                              borderRadius: '12px',\n                              overflow: 'hidden',\n                              background: 'white',\n                              boxShadow: '0 4px 12px rgba(102, 126, 234, 0.15)'\n                            }}>\n                              {/* Email Header */}\n                              <div style={{\n                                padding: '16px 20px',\n                                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n                                color: 'white',\n                                fontSize: '0.85rem'\n                              }}>\n                                <div style={{ marginBottom: '8px', display: 'flex', alignItems: 'center', gap: '8px' }}>\n                                  <strong style={{ fontSize: '0.9rem' }}> Email Preview</strong>\n                                </div>\n                                <div style={{ marginBottom: '6px', opacity: 0.95 }}>\n                                  <strong>Pedmt:</strong> {replacePlaceholders(template.email_subject || 'Bez pedmtu')}\n                                </div>\n                                <div style={{ marginBottom: '6px', opacity: 0.95 }}>\n                                  <strong>Odeslatel:</strong> EEO Systm &lt;noreply@eeo.cz&gt;\n                                </div>\n                                <div style={{ opacity: 0.95 }}>\n                                  <strong>Pjemce:</strong> {mockData.recipient_name || mockData.user_name} &lt;{mockData.user_email}&gt;\n                                </div>\n                              </div>\n                              {/* Email Body - KOMPLETN SCROLLOVATELN nhled - ZMENENO */}\n                              <div style={{\n                                padding: '12px',\n                                fontSize: '0.5rem',\n                                lineHeight: '1.3',\n                                color: '#1f2937',\n                                maxHeight: '500px',\n                                minHeight: '200px',\n                                overflowY: 'auto',\n                                overflowX: 'hidden',\n                                background: '#ffffff',\n                                zoom: '0.6',\n                                transformOrigin: 'top left'\n                              }}\n                              className=\"email-preview-body\"\n                              >\n                                <div \n                                  dangerouslySetInnerHTML={{ \n                                    __html: replacePlaceholders(\n                                      (() => {\n                                        // Extrakce sprvn varianty podle vbru v templatePreviewVariant\n                                        const selectedVariantType = templatePreviewVariant || templateNormalVariant || 'APPROVER_NORMAL';\n                                        const emailBody = template.email_body || '<p style=\"color: #9ca3af; font-style: italic;\">Email tlo nen definovno v ablon</p>';\n                                        \n                                        // Pokud nen delimiter, vra cel email_body\n                                        if (!emailBody.includes('<!-- RECIPIENT:')) {\n                                          return emailBody;\n                                        }\n                                        \n                                        // Extrahuj specifickou variantu\n                                        const delimiter = `<!-- RECIPIENT: ${selectedVariantType} -->`;\n                                        const startPos = emailBody.indexOf(delimiter);\n                                        \n                                        if (startPos === -1) {\n                                          return emailBody; // Fallback\n                                        }\n                                        \n                                        // Najdi zatek HTML (po delimiteru)\n                                        let htmlStart = startPos + delimiter.length;\n                                        \n                                        // Najdi konec (dal delimiter nebo konec stringu)\n                                        const otherDelimiters = ['APPROVER_NORMAL', 'APPROVER_URGENT', 'SUBMITTER']\n                                          .filter(d => d !== selectedVariantType)\n                                          .map(d => `<!-- RECIPIENT: ${d} -->`);\n                                        \n                                        let htmlEnd = emailBody.length;\n                                        for (const otherDelimiter of otherDelimiters) {\n                                          const pos = emailBody.indexOf(otherDelimiter, htmlStart);\n                                          if (pos !== -1 && pos < htmlEnd) {\n                                            htmlEnd = pos;\n                                          }\n                                        }\n                                        \n                                        return emailBody.substring(htmlStart, htmlEnd).trim();\n                                      })()\n                                    ).replace(/\\n/g, '<br />')\n                                  }} \n                                />\n                              </div>\n                              {/* Email Footer */}\n                              <div style={{\n                                padding: '12px 20px',\n                                background: '#f9fafb',\n                                borderTop: '1px solid #e5e7eb',\n                                fontSize: '0.75rem',\n                                color: '#6b7280',\n                                textAlign: 'center'\n                              }}>\n                                 {mockData.datetime}   Automatick notifikace z EEO systmu\n                              </div>\n                            </div>\n                            <div style={{\n                              marginTop: '8px',\n                              padding: '8px 12px',\n                              background: '#eff6ff',\n                              border: '1px solid #bfdbfe',\n                              borderRadius: '6px',\n                              fontSize: '0.75rem',\n                              color: '#1e40af',\n                              display: 'flex',\n                              alignItems: 'center',\n                              gap: '6px'\n                            }}>\n                              <span></span>\n                              <span>Pln scrollovateln nhled HTML ablony s nahrazenmi placeholdery mock daty</span>\n                            </div>\n                          </div>\n                        </>\n                      );\n                    })()}\n                    \n                    <div style={{\n                      marginTop: '12px',\n                      padding: '12px',\n                      background: '#fef3c7',\n                      border: '2px solid #f59e0b',\n                      borderRadius: '8px',\n                      fontSize: '0.85rem',\n                      color: '#92400e'\n                    }}>\n                      <strong> Co tato ablona definuje:</strong>\n                      <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px', lineHeight: '1.6' }}>\n                        <li>Ktermu <strong>uivateli</strong> se notifikace pole</li>\n                        <li>Zda m uivatel <strong>notifikace zapnut</strong></li>\n                        <li>Zda m uivatel <strong>roli/prva</strong> pro pjem notifikace</li>\n                        <li>Scope viditelnosti me urovat, zda notifikaci dostane</li>\n                      </ul>\n                    </div>\n                    \n                    {/* Zobrazen piazen - ke komu vede ipka */}\n                    {(() => {\n                      const recipients = edges\n                        .filter(e => e.source === selectedNode.id)\n                        .map(e => {\n                          const targetNode = nodes.find(n => n.id === e.target);\n                          return {\n                            id: targetNode?.id,\n                            name: targetNode?.data?.label || targetNode?.data?.name || 'Neznm',\n                            type: targetNode?.data?.type || 'user',\n                            edgeId: e.id\n                          };\n                        });\n                      \n                      return (\n                        <div style={{ \n                          marginTop: '16px', \n                          padding: '12px', \n                          background: '#f0f9ff', \n                          border: '2px solid #3b82f6',\n                          borderRadius: '8px' \n                        }}>\n                          <div style={{ \n                            display: 'flex', \n                            alignItems: 'center', \n                            gap: '8px',\n                            marginBottom: '12px',\n                            fontWeight: '600',\n                            color: '#1e40af',\n                            fontSize: '0.9rem'\n                          }}>\n                            <FontAwesomeIcon icon={faBell} />\n                            Notifikace je piazena na:\n                          </div>\n                          \n                          {recipients.length > 0 ? (\n                            <div style={{ display: 'flex', flexDirection: 'column', gap: '6px' }}>\n                              {recipients.map((recipient, i) => {\n                                let icon = '';\n                                let bgColor = '#dbeafe';\n                                let textColor = '#1e40af';\n                                \n                                if (recipient.type === 'location') {\n                                  icon = '';\n                                  bgColor = '#d1fae5';\n                                  textColor = '#065f46';\n                                } else if (recipient.type === 'department') {\n                                  icon = '';\n                                  bgColor = '#dbeafe';\n                                  textColor = '#1e40af';\n                                }\n                                \n                                return (\n                                  <div key={i} style={{ \n                                    padding: '8px 12px', \n                                    background: bgColor,\n                                    borderRadius: '6px',\n                                    fontSize: '0.85rem',\n                                    color: textColor,\n                                    fontWeight: '500',\n                                    cursor: 'pointer',\n                                    transition: 'all 0.2s',\n                                    display: 'flex',\n                                    alignItems: 'center',\n                                    gap: '8px'\n                                  }}\n                                  onClick={() => {\n                                    const node = nodes.find(n => n.id === recipient.id);\n                                    if (node) {\n                                      setSelectedNode(node);\n                                      setSelectedEdge(null);\n                                    }\n                                  }}\n                                  onMouseEnter={(e) => e.currentTarget.style.opacity = '0.7'}\n                                  onMouseLeave={(e) => e.currentTarget.style.opacity = '1'}\n                                  title=\"Kliknte pro zobrazen detailu\">\n                                    <span style={{ fontSize: '1.1rem' }}>{icon}</span>\n                                    <span>{recipient.name}</span>\n                                    {recipient.type === 'location' && <span style={{ fontSize: '0.75rem', opacity: 0.7 }}>(lokalita)</span>}\n                                    {recipient.type === 'department' && <span style={{ fontSize: '0.75rem', opacity: 0.7 }}>(sek)</span>}\n                                    {recipient.type === 'user' && <span style={{ fontSize: '0.75rem', opacity: 0.7 }}>(uivatel)</span>}\n                                  </div>\n                                );\n                              })}\n                            </div>\n                          ) : (\n                            <div style={{ fontSize: '0.8rem', color: '#64748b', fontStyle: 'italic' }}>\n                              ablona zatm nen piazena k dnmu uivateli, lokalit ani seku\n                            </div>\n                          )}\n                        </div>\n                      );\n                    })()}\n                  </>\n                )}\n                \n                {/* LOKALITA NODE */}\n                {selectedNode && selectedNode.data.type === 'location' && (\n                  <>\n                    <FormGroup>\n                      <Label>Nzev lokality</Label>\n                      <Input value={selectedNode.data.label || selectedNode.data.name} readOnly />\n                    </FormGroup>\n                    <div style={{\n                      marginTop: '12px',\n                      padding: '12px',\n                      background: '#f0fdf4',\n                      border: '2px solid #10b981',\n                      borderRadius: '8px',\n                      fontSize: '0.85rem',\n                      color: '#065f46'\n                    }}>\n                      <strong> Co lokalita definuje:</strong>\n                      <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px', lineHeight: '1.6' }}>\n                        <li>Rozen <strong>viditelnosti</strong> v rmci lokality</li>\n                        <li>Uruje <strong>scope</strong> pro data (objednvky, faktury, pokladna)</li>\n                        <li>Me mt dodaten <strong>prva</strong> vzan na lokalitu</li>\n                      </ul>\n                    </div>\n                  </>\n                )}\n                \n                {/* SEK NODE */}\n                {selectedNode && selectedNode.data.type === 'department' && (\n                  <>\n                    <FormGroup>\n                      <Label>Nzev seku</Label>\n                      <Input value={selectedNode.data.label || selectedNode.data.name} readOnly />\n                    </FormGroup>\n                    <div style={{\n                      marginTop: '12px',\n                      padding: '12px',\n                      background: '#eff6ff',\n                      border: '2px solid #3b82f6',\n                      borderRadius: '8px',\n                      fontSize: '0.85rem',\n                      color: '#1e40af'\n                    }}>\n                      <strong> Co sek definuje:</strong>\n                      <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px', lineHeight: '1.6' }}>\n                        <li>Rozen <strong>viditelnosti</strong> v rmci seku</li>\n                        <li>Uruje <strong>scope</strong> pro data (objednvky, faktury, pokladna)</li>\n                        <li>Me mt dodaten <strong>prva</strong> vzan na sek</li>\n                      </ul>\n                    </div>\n                  </>\n                )}\n                \n                {/* ROLE NODE */}\n                {selectedNode && selectedNode.data.type === 'role' && (\n                  <>\n                    <FormGroup>\n                      <Label>Nzev role</Label>\n                      <Input value={selectedNode.data.label || selectedNode.data.name} readOnly />\n                    </FormGroup>\n                    {selectedNode.data.metadata?.popis && (\n                      <FormGroup>\n                        <Label>Popis</Label>\n                        <Input value={selectedNode.data.metadata.popis} readOnly />\n                      </FormGroup>\n                    )}\n                    <div style={{\n                      marginTop: '12px',\n                      padding: '12px',\n                      background: '#f5f3ff',\n                      border: '2px solid #8b5cf6',\n                      borderRadius: '8px',\n                      fontSize: '0.85rem',\n                      color: '#6b21a8'\n                    }}>\n                      <strong> Co role definuje:</strong>\n                      <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px', lineHeight: '1.6' }}>\n                        <li>Sadu <strong>oprvnn</strong> pro moduly (objednvky, faktury, pokladna)</li>\n                        <li>Piazen <strong>uivatelm</strong> pro ddn prv</li>\n                        <li>Monost pijmat <strong>notifikace</strong> pro celou roli</li>\n                      </ul>\n                    </div>\n                    \n                    {/* Zobrazen piazench uivatel */}\n                    {(() => {\n                      const assignedUsers = edges\n                        .filter(e => e.target === selectedNode.id)\n                        .map(e => {\n                          const sourceNode = nodes.find(n => n.id === e.source);\n                          return {\n                            id: sourceNode?.id,\n                            name: sourceNode?.data?.label || sourceNode?.data?.name || 'Neznm',\n                            position: sourceNode?.data?.position || '',\n                            edgeId: e.id\n                          };\n                        });\n                      \n                      return (\n                        <div style={{ \n                          marginTop: '16px', \n                          padding: '12px', \n                          background: '#eff6ff', \n                          border: '2px solid #3b82f6',\n                          borderRadius: '8px' \n                        }}>\n                          <div style={{ \n                            display: 'flex', \n                            alignItems: 'center', \n                            gap: '8px',\n                            marginBottom: '12px',\n                            fontWeight: '600',\n                            color: '#1e40af',\n                            fontSize: '0.9rem'\n                          }}>\n                            <FontAwesomeIcon icon={faUsers} />\n                            Uivatel s touto rol ({assignedUsers.length})\n                          </div>\n                          \n                          {assignedUsers.length > 0 ? (\n                            <div style={{ display: 'flex', flexDirection: 'column', gap: '6px' }}>\n                              {assignedUsers.map((user, i) => (\n                                <div key={i} style={{ \n                                  padding: '8px 12px', \n                                  background: '#dbeafe',\n                                  borderRadius: '6px',\n                                  fontSize: '0.85rem',\n                                  color: '#1e40af',\n                                  fontWeight: '500',\n                                  cursor: 'pointer',\n                                  transition: 'all 0.2s',\n                                  display: 'flex',\n                                  flexDirection: 'column',\n                                  gap: '2px'\n                                }}\n                                onClick={() => {\n                                  const node = nodes.find(n => n.id === user.id);\n                                  if (node) {\n                                    setSelectedNode(node);\n                                    setSelectedEdge(null);\n                                  }\n                                }}\n                                onMouseEnter={(e) => e.currentTarget.style.opacity = '0.7'}\n                                onMouseLeave={(e) => e.currentTarget.style.opacity = '1'}\n                                title=\"Kliknte pro zobrazen detailu uivatele\">\n                                  <span style={{ fontSize: '1rem' }}> {user.name}</span>\n                                  {user.position && <span style={{ fontSize: '0.75rem', opacity: 0.7 }}>{user.position}</span>}\n                                </div>\n                              ))}\n                            </div>\n                          ) : (\n                            <div style={{ fontSize: '0.8rem', color: '#64748b', fontStyle: 'italic' }}>\n                              Role zatm nen piazena dnmu uivateli\n                            </div>\n                          )}\n                        </div>\n                      );\n                    })()}\n                    \n                    {/* Oprvnn modul role */}\n                    <div style={{ \n                      marginTop: '16px', \n                      padding: '12px', \n                      background: '#fef3c7', \n                      border: '2px solid #f59e0b',\n                      borderRadius: '8px' \n                    }}>\n                      <div style={{ \n                        display: 'flex', \n                        alignItems: 'center', \n                        gap: '8px',\n                        marginBottom: '12px',\n                        fontWeight: '600',\n                        color: '#92400e',\n                        fontSize: '0.9rem'\n                      }}>\n                        <FontAwesomeIcon icon={faUserShield} />\n                        Oprvnn modul\n                      </div>\n                      \n                      <div style={{ fontSize: '0.8rem', color: '#92400e', marginBottom: '10px' }}>\n                        Tato role m pstup k nsledujcm modulm:\n                      </div>\n                      \n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n                        {(() => {\n                          // Najt roli v allRoles podle roleId\n                          const role = allRoles.find(r => r.id === selectedNode.data.roleId);\n                          const modules = role?.modules || { orders: false, invoices: false, cashbook: false };\n                          \n                          return ['orders', 'invoices', 'cashbook'].map(module => {\n                            const hasPermission = modules[module] === true || modules[module] === 1;\n                            const moduleNames = {\n                              orders: ' Objednvky',\n                              invoices: ' Faktury',\n                              cashbook: ' Pokladna'\n                            };\n                            \n                            return (\n                              <div key={module} style={{ \n                                padding: '8px 12px', \n                                background: hasPermission ? '#d1fae5' : '#fee2e2',\n                                borderRadius: '6px',\n                                fontSize: '0.85rem',\n                                color: hasPermission ? '#065f46' : '#991b1b',\n                                fontWeight: '500',\n                                display: 'flex',\n                                alignItems: 'center',\n                                gap: '8px'\n                              }}>\n                                <span style={{ fontSize: '1.2rem' }}>{hasPermission ? '' : ''}</span>\n                                <span>{moduleNames[module]}</span>\n                              </div>\n                            );\n                          });\n                        })()}\n                      </div>\n                    </div>\n                  </>\n                )}\n                \n                {/* UIVATELSK NODE */}\n                {selectedNode && (!selectedNode.data.type || selectedNode.data.type === 'user') && (\n                  <>\n                    <FormGroup>\n                      <Label>Uivatel</Label>\n                      <Input value={selectedNode.data.name} readOnly />\n                    </FormGroup>\n                    <FormGroup>\n                      <Label>Pozice</Label>\n                      <Input value={selectedNode.data.position} readOnly />\n                    </FormGroup>\n                    <FormGroup style={{ marginTop: '12px', paddingTop: '12px', borderTop: '1px solid #e0e6ed' }}>\n                      <Label style={{ color: '#10b981' }}>\n                         Vchoz lokalita (z DB)\n                      </Label>\n                      <Input \n                        value={selectedNode.data.metadata?.location || 'Neuvedeno'} \n                        readOnly \n                        style={{ background: '#f0fdf4', fontWeight: '500', border: '1px solid #86efac' }}\n                      />\n                    </FormGroup>\n                    <FormGroup>\n                      <Label style={{ color: '#10b981' }}>\n                         Vchoz sek (z DB)\n                      </Label>\n                      <Input \n                        value={selectedNode.data.metadata?.department || 'Neuvedeno'} \n                        readOnly \n                        style={{ background: '#f0fdf4', fontWeight: '500', border: '1px solid #86efac' }}\n                      />\n                    </FormGroup>\n                  </>\n                )}\n                \n                {/* Sekce: Aktuln vztahy v diagramu - pouze pro USER node */}\n                {selectedNode && (!selectedNode.data.type || selectedNode.data.type === 'user') && (\n                  <div style={{ \n                    marginTop: '24px', \n                    padding: '12px', \n                    background: '#f0f9ff', \n                    border: '2px solid #3b82f6',\n                    borderRadius: '8px' \n                  }}>\n                      <div style={{ \n                        display: 'flex', \n                        alignItems: 'center', \n                        gap: '8px',\n                        marginBottom: '12px',\n                        fontWeight: '600',\n                        color: '#1e40af',\n                        fontSize: '0.9rem'\n                      }}>\n                        <FontAwesomeIcon icon={faSitemap} />\n                        Aktuln vztahy v diagramu\n                      </div>\n                      \n                      {(() => {\n                        // Najdi nadzen (ipky smujc DO tohoto nodu)\n                        const supervisors = edges\n                          .filter(e => e.target === selectedNode.id)\n                          .map(e => {\n                            const sourceNode = nodes.find(n => n.id === e.source);\n                            return {\n                              name: sourceNode?.data?.name || 'Neznm',\n                              edgeId: e.id,\n                              type: e.data?.relationshipType || 'prime'\n                            };\n                          });\n                        \n                        // Najdi podzen (ipky smujc Z tohoto nodu)\n                        const subordinates = edges\n                          .filter(e => e.source === selectedNode.id)\n                          .map(e => {\n                            const targetNode = nodes.find(n => n.id === e.target);\n                            return {\n                              name: targetNode?.data?.name || 'Neznm',\n                              edgeId: e.id,\n                              type: e.data?.relationshipType || 'prime'\n                            };\n                          });\n                        \n                        return (\n                          <>\n                            <div style={{ marginBottom: '12px' }}>\n                              <strong style={{ fontSize: '0.8rem', color: '#475569', display: 'block', marginBottom: '6px' }}>\n                                 Nadzen ({supervisors.length})\n                              </strong>\n                              {supervisors.length > 0 ? (\n                                <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\n                                  {supervisors.map((sup, i) => (\n                                    <div key={i} style={{ \n                                      padding: '6px 10px', \n                                      background: '#dbeafe',\n                                      borderRadius: '4px',\n                                      fontSize: '0.8rem',\n                                      color: '#1e40af',\n                                      fontWeight: '500',\n                                      cursor: 'pointer',\n                                      transition: 'all 0.2s'\n                                    }}\n                                    onClick={() => {\n                                      // Kliknutm vyber tento edge\n                                      const edge = edges.find(e => e.id === sup.edgeId);\n                                      if (edge) {\n                                        setSelectedEdge(edge);\n                                        setSelectedNode(null);\n                                      }\n                                    }}\n                                    onMouseEnter={(e) => e.currentTarget.style.background = '#bfdbfe'}\n                                    onMouseLeave={(e) => e.currentTarget.style.background = '#dbeafe'}\n                                    title=\"Kliknte pro zobrazen detailu vztahu\">\n                                      {sup.name}\n                                      {sup.type === 'zastupovani' && ' (zastupovn)'}\n                                    </div>\n                                  ))}\n                                </div>\n                              ) : (\n                                <div style={{ fontSize: '0.75rem', color: '#94a3b8', fontStyle: 'italic' }}>\n                                  Nem nadzenho v diagramu\n                                </div>\n                              )}\n                            </div>\n                            \n                            <div>\n                              <strong style={{ fontSize: '0.8rem', color: '#475569', display: 'block', marginBottom: '6px' }}>\n                                 Podzen ({subordinates.length})\n                              </strong>\n                              {subordinates.length > 0 ? (\n                                <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\n                                  {subordinates.map((sub, i) => (\n                                    <div key={i} style={{ \n                                      padding: '6px 10px', \n                                      background: '#dbeafe',\n                                      borderRadius: '4px',\n                                      fontSize: '0.8rem',\n                                      color: '#1e40af',\n                                      fontWeight: '500',\n                                      cursor: 'pointer',\n                                      transition: 'all 0.2s'\n                                    }}\n                                    onClick={() => {\n                                      // Kliknutm vyber tento edge\n                                      const edge = edges.find(e => e.id === sub.edgeId);\n                                      if (edge) {\n                                        setSelectedEdge(edge);\n                                        setSelectedNode(null);\n                                      }\n                                    }}\n                                    onMouseEnter={(e) => e.currentTarget.style.background = '#bfdbfe'}\n                                    onMouseLeave={(e) => e.currentTarget.style.background = '#dbeafe'}\n                                    title=\"Kliknte pro zobrazen detailu vztahu\">\n                                      {sub.name}\n                                      {sub.type === 'zastupovani' && ' (zastupovn)'}\n                                    </div>\n                                  ))}\n                                </div>\n                              ) : (\n                                <div style={{ fontSize: '0.75rem', color: '#94a3b8', fontStyle: 'italic' }}>\n                                  Nem podzen v diagramu\n                                </div>\n                              )}\n                            </div>\n                          </>\n                        );\n                      })()}\n                    </div>\n                )}\n                \n                {selectedEdge && (() => {\n                  const sourceNode = nodes.find(n => n.id === selectedEdge.source);\n                  const targetNode = nodes.find(n => n.id === selectedEdge.target);\n                  \n                  // DEBUG: Log node types\n                  console.log(' Edge detail - Source node:', {\n                    id: sourceNode?.id,\n                    dataType: sourceNode?.data?.type,\n                    metadataType: sourceNode?.data?.metadata?.type,\n                    name: sourceNode?.data?.name\n                  });\n                  console.log(' Edge detail - Target node:', {\n                    id: targetNode?.id,\n                    dataType: targetNode?.data?.type,\n                    metadataType: targetNode?.data?.metadata?.type,\n                    name: targetNode?.data?.name\n                  });\n                  \n                  return (\n                  <>\n                    {/* Typ vztahu badge */}\n                    <div style={{\n                      marginBottom: '16px',\n                      padding: '10px',\n                      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n                      borderRadius: '8px',\n                      color: 'white',\n                      fontSize: '0.9rem',\n                      fontWeight: '600',\n                      textAlign: 'center',\n                      boxShadow: '0 2px 8px rgba(102,126,234,0.3)'\n                    }}>\n                      {(() => {\n                        const sourceType = sourceNode?.data?.metadata?.type || sourceNode?.data?.type || 'user';\n                        const targetType = targetNode?.data?.metadata?.type || targetNode?.data?.type || 'user';\n                        console.log(' Detected types:', { sourceType, targetType });\n                        const relationInfo = getRelationshipTypeInfo(sourceType, targetType);\n                        return `${relationInfo.icon} ${relationInfo.label}`;\n                      })()}\n                    </div>\n                    \n                    <FormGroup>\n                      <Label>{(() => {\n                        const sourceType = sourceNode?.data?.metadata?.type || sourceNode?.data?.type || 'user';\n                        const targetType = targetNode?.data?.metadata?.type || targetNode?.data?.type || 'user';\n                        return getRelationshipTypeInfo(sourceType, targetType).sourceLabel;\n                      })()}</Label>\n                      <Input value={sourceNode?.data?.label || sourceNode?.data?.name || 'Neznm'} readOnly style={{ fontWeight: '600', color: '#059669' }} />\n                    </FormGroup>\n                    <FormGroup>\n                      <Label>{(() => {\n                        const sourceType = sourceNode?.data?.metadata?.type || sourceNode?.data?.type || 'user';\n                        const targetType = targetNode?.data?.metadata?.type || targetNode?.data?.type || 'user';\n                        return getRelationshipTypeInfo(sourceType, targetType).targetLabel;\n                      })()}</Label>\n                      <Input value={targetNode?.data?.label || targetNode?.data?.name || 'Neznm'} readOnly style={{ fontWeight: '600', color: '#3b82f6' }} />\n                    </FormGroup>\n                    \n                    {/* Vysvtlen logiky vztahu */}\n                    <div style={{\n                      marginTop: '16px',\n                      marginBottom: '16px',\n                      padding: '12px',\n                      background: '#f0fdf4',\n                      border: '2px solid #86efac',\n                      borderRadius: '8px',\n                      fontSize: '0.85rem',\n                      color: '#15803d'\n                    }}>\n                      <strong> Jak to funguje:</strong>\n                      <div style={{ marginTop: '8px', fontSize: '0.8rem', lineHeight: '1.6' }}>\n                        <strong>{sourceNode?.data?.name?.split(' ')[0] || 'Nadrzen'}</strong> zsk prva vidt data od <strong>{targetNode?.data?.name?.split(' ')[0] || 'podrzenho'}</strong>.<br/>\n                        <strong>Rozsah</strong> a <strong>Moduly</strong> uruj, co pesn uvid (objednvky/faktury/pokladnu).<br/>\n                        <strong>Rozen lokality/seky</strong> pidvaj dal data mimo zkladn vztah.\n                      </div>\n                    </div>\n                    \n                    {/* Typ vztahu - zobraz JEN pro user-user vztahy */}\n                    {(() => {\n                      const sourceType = sourceNode?.data?.metadata?.type || sourceNode?.data?.type || 'user';\n                      const targetType = targetNode?.data?.metadata?.type || targetNode?.data?.type || 'user';\n                      \n                      if (sourceType === 'user' && targetType === 'user') {\n                        return (\n                          <FormGroup>\n                            <Label>Typ vztahu</Label>\n                            <Select value={relationshipType} onChange={(e) => setRelationshipType(e.target.value)}>\n                              <option value=\"prime\">Pm nadzen</option>\n                              <option value=\"zastupovani\">Zastupovn</option>\n                              <option value=\"delegovani\" disabled style={{ color: '#9ca3af' }}>Delegovn (TODO)</option>\n                              <option value=\"rozsirene\" disabled style={{ color: '#9ca3af' }}>Rozen oprvnn (TODO)</option>\n                            </Select>\n                          </FormGroup>\n                        );\n                      }\n                      return null;\n                    })()}\n                  </>\n                  );\n                })()}\n                \n                {/* Sekce Zkladn vlastnosti vztahu - POUZE pro edge */}\n                {selectedEdge && (() => {\n                  const sourceNode = nodes.find(n => n.id === selectedEdge.source);\n                  const targetNode = nodes.find(n => n.id === selectedEdge.target);\n                  const sourceType = sourceNode?.data?.metadata?.type || sourceNode?.data?.type || 'user';\n                  const targetType = targetNode?.data?.metadata?.type || targetNode?.data?.type || 'user';\n                  const relationInfo = getRelationshipTypeInfo(sourceType, targetType);\n                  \n                  // Zobraz scope jen kdy m smysl (ne pro notifikace)\n                  if (!relationInfo.showScope) return null;\n                  \n                  return (\n                <FormGroup>\n                  <Label>\n                    Rozsah viditelnosti (Scope)\n                    <span style={{ fontSize: '0.75rem', color: '#059669', fontWeight: '600', marginLeft: '8px' }}>\n                       co uvid {sourceNode?.data?.name?.split(' ')[0] || 'nadrzen'}?\n                    </span>\n                  </Label>\n                  <Select value={relationshipScope} onChange={(e) => setRelationshipScope(e.target.value)}>\n                    <option value=\"OWN\"> OWN - Jen sv vlastn zznamy</option>\n                    <option value=\"TEAM\"> TEAM - Zznamy svho seku</option>\n                    <option value=\"LOCATION\"> LOCATION - Ve v rmci lokality</option>\n                    <option value=\"ALL\"> ALL - Ve (admin pstup)</option>\n                  </Select>\n                  <div style={{\n                    marginTop: '8px',\n                    padding: '8px',\n                    background: '#f8fafc',\n                    border: '1px solid #e2e8f0',\n                    borderRadius: '4px',\n                    fontSize: '0.75rem',\n                    color: '#475569'\n                  }}>\n                    <strong>Vysvtlen:</strong>\n                    <ul style={{ margin: '6px 0 0 16px', padding: 0 }}>\n                      <li><strong>OWN:</strong> Vid jen sv zznamy (vlastn objednvky/faktury)</li>\n                      <li><strong>TEAM:</strong> Vid zznamy celho seku</li>\n                      <li><strong>LOCATION:</strong> Vid ve v rmci lokality (nap. vechny seky v Beroun)</li>\n                      <li><strong>ALL:</strong> Vid vechny zznamy v systmu (nadazen pstup)</li>\n                    </ul>\n                  </div>\n                </FormGroup>\n                  );\n                })()}\n              </DetailSection>\n\n              {/* Sekce Oprvnn pro moduly - POUZE pro edge (vztahy) kde m smysl */}\n              {selectedEdge && (() => {\n                const sourceNode = nodes.find(n => n.id === selectedEdge.source);\n                const targetNode = nodes.find(n => n.id === selectedEdge.target);\n                const sourceType = sourceNode?.data?.metadata?.type || sourceNode?.data?.type || 'user';\n                const targetType = targetNode?.data?.metadata?.type || targetNode?.data?.type || 'user';\n                const relationInfo = getRelationshipTypeInfo(sourceType, targetType);\n                \n                if (!relationInfo.showModules) return null;\n                \n                return (\n              <>\n              <Divider />\n\n              <DetailSection>\n                <DetailSectionTitle>\n                  <FontAwesomeIcon icon={faEye} />\n                  Oprvnn pro moduly (workflow)\n                </DetailSectionTitle>\n                \n                {/* Info box s vysvtlenm */}\n                <div style={{\n                  padding: '12px',\n                  background: '#f0f9ff',\n                  border: '1px solid #bfdbfe',\n                  borderRadius: '8px',\n                  fontSize: '0.85rem',\n                  color: '#1e40af',\n                  marginBottom: '16px'\n                }}>\n                  <strong> Jak to funguje:</strong>\n                  <div style={{ marginTop: '6px', fontSize: '0.8rem', color: '#3b82f6' }}>\n                    Vztah roz viditelnost dat podle lokalit a sek.\n                    Uivatel MUS mt zkladn prvo (roli) pro pstup k modulu.\n                  </div>\n                </div>\n                \n                <CheckboxGroup>\n                  {/* AKTIVN MODULY - s workflow podporou */}\n                  <CheckboxLabel>\n                    <input \n                      type=\"checkbox\" \n                      checked={moduleVisibility.orders}\n                      onChange={(e) => setModuleVisibility(prev => ({ ...prev, orders: e.target.checked }))}\n                    />\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', flex: 1 }}>\n                      <span> <strong>Objednvky</strong></span>\n                      <span style={{ fontSize: '0.75rem', color: '#10b981', background: '#f0fdf4', padding: '2px 6px', borderRadius: '4px', fontWeight: 600 }}>\n                        AKTIVN\n                      </span>\n                    </div>\n                  </CheckboxLabel>\n                  {moduleVisibility.orders && (\n                    <div style={{ marginLeft: '32px', marginTop: '6px', marginBottom: '12px' }}>\n                      <label style={{ fontSize: '0.8rem', color: '#64748b', display: 'block', marginBottom: '4px' }}>rove prv pro nadzenho:</label>\n                      <select\n                        value={permissionLevel.orders}\n                        onChange={(e) => setPermissionLevel(prev => ({ ...prev, orders: e.target.value }))}\n                        style={{\n                          width: '100%',\n                          padding: '6px 10px',\n                          borderRadius: '6px',\n                          border: '1px solid #cbd5e1',\n                          fontSize: '0.85rem',\n                          cursor: 'pointer',\n                          background: 'white'\n                        }}\n                      >\n                        <option value=\"READ_ONLY\"> Jen ten (vid zznamy)</option>\n                        <option value=\"READ_WRITE\"> ten + Editace</option>\n                        <option value=\"READ_WRITE_DELETE\"> Pln pstup (i mazn)</option>\n                        <option value=\"INHERIT\"> Ddit prva podzenho</option>\n                      </select>\n                    </div>\n                  )}\n                  \n                  <CheckboxLabel>\n                    <input \n                      type=\"checkbox\" \n                      checked={moduleVisibility.invoices}\n                      onChange={(e) => setModuleVisibility(prev => ({ ...prev, invoices: e.target.checked }))}\n                    />\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', flex: 1 }}>\n                      <span> <strong>Faktury</strong></span>\n                      <span style={{ fontSize: '0.75rem', color: '#10b981', background: '#f0fdf4', padding: '2px 6px', borderRadius: '4px', fontWeight: 600 }}>\n                        AKTIVN\n                      </span>\n                    </div>\n                  </CheckboxLabel>\n                  {moduleVisibility.invoices && (\n                    <div style={{ marginLeft: '32px', marginTop: '6px', marginBottom: '12px' }}>\n                      <label style={{ fontSize: '0.8rem', color: '#64748b', display: 'block', marginBottom: '4px' }}>rove prv pro nadzenho:</label>\n                      <select\n                        value={permissionLevel.invoices}\n                        onChange={(e) => setPermissionLevel(prev => ({ ...prev, invoices: e.target.value }))}\n                        style={{\n                          width: '100%',\n                          padding: '6px 10px',\n                          borderRadius: '6px',\n                          border: '1px solid #cbd5e1',\n                          fontSize: '0.85rem',\n                          cursor: 'pointer',\n                          background: 'white'\n                        }}\n                      >\n                        <option value=\"READ_ONLY\"> Jen ten (vid zznamy)</option>\n                        <option value=\"READ_WRITE\"> ten + Editace</option>\n                        <option value=\"READ_WRITE_DELETE\"> Pln pstup (i mazn)</option>\n                        <option value=\"INHERIT\"> Ddit prva podzenho</option>\n                      </select>\n                    </div>\n                  )}\n                  \n                  <div style={{ marginLeft: '0px', paddingLeft: '0px' }}>\n                    <CheckboxLabel>\n                      <input \n                        type=\"checkbox\"\n                        checked={moduleVisibility.cashbook}\n                        onChange={(e) => setModuleVisibility(prev => ({ ...prev, cashbook: e.target.checked }))}\n                      />\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '8px', flex: 1 }}>\n                        <span> <strong>Pokladna</strong></span>\n                        <span style={{ fontSize: '0.75rem', color: '#f59e0b', background: '#fef3c7', padding: '2px 6px', borderRadius: '4px', fontWeight: 600 }}>\n                          STEN\n                        </span>\n                      </div>\n                    </CheckboxLabel>\n                    {/* Sub-option pro pokladnu */}\n                    <div style={{ marginLeft: '32px', marginTop: '6px', marginBottom: '6px' }}>\n                      <CheckboxLabel style={{ fontSize: '0.85rem', padding: '4px 8px' }}>\n                        <input \n                          type=\"checkbox\"\n                          checked={moduleVisibility.cashbookReadonly}\n                          onChange={(e) => setModuleVisibility(prev => ({ ...prev, cashbookReadonly: e.target.checked }))}\n                          disabled={!moduleVisibility.cashbook}\n                        />\n                        <span style={{ color: '#64748b' }}> Jen pro ten (read-only)</span>\n                      </CheckboxLabel>\n                    </div>\n                    {moduleVisibility.cashbook && (\n                      <div style={{ marginLeft: '32px', marginTop: '6px', marginBottom: '12px' }}>\n                        <label style={{ fontSize: '0.8rem', color: '#64748b', display: 'block', marginBottom: '4px' }}>rove prv pro nadzenho:</label>\n                        <select\n                          value={permissionLevel.cashbook}\n                          onChange={(e) => setPermissionLevel(prev => ({ ...prev, cashbook: e.target.value }))}\n                          style={{\n                            width: '100%',\n                            padding: '6px 10px',\n                            borderRadius: '6px',\n                            border: '1px solid #cbd5e1',\n                            fontSize: '0.85rem',\n                            cursor: 'pointer',\n                            background: 'white'\n                          }}\n                        >\n                          <option value=\"READ_ONLY\"> Jen ten (vid zznamy)</option>\n                          <option value=\"READ_WRITE\"> ten + Editace</option>\n                          <option value=\"READ_WRITE_DELETE\"> Pln pstup (i mazn)</option>\n                          <option value=\"INHERIT\"> Ddit prva podzenho</option>\n                        </select>\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* NEAKTIVN MODULY - zatm bez workflow */}\n                  <div style={{\n                    marginTop: '12px',\n                    paddingTop: '12px',\n                    borderTop: '1px dashed #e5e7eb'\n                  }}>\n                    <div style={{\n                      fontSize: '0.75rem',\n                      color: '#6b7280',\n                      marginBottom: '8px',\n                      fontWeight: 600,\n                      textTransform: 'uppercase',\n                      letterSpacing: '0.5px'\n                    }}>\n                      Plnovan moduly (TODO):\n                    </div>\n                    \n                    <CheckboxLabel style={{ opacity: 0.5, cursor: 'not-allowed' }}>\n                      <input \n                        type=\"checkbox\" \n                        disabled\n                        checked={moduleVisibility.contracts}\n                        onChange={(e) => setModuleVisibility(prev => ({ ...prev, contracts: e.target.checked }))}\n                      />\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                        <span> Smlouvy</span>\n                        <span style={{ fontSize: '0.7rem', color: '#6b7280' }}>(pipravujeme)</span>\n                      </div>\n                    </CheckboxLabel>\n                  </div>\n                </CheckboxGroup>\n                \n                {/* Poznmka o prvech */}\n                <div style={{\n                  marginTop: '12px',\n                  padding: '10px',\n                  background: '#fffbeb',\n                  border: '1px solid #fde68a',\n                  borderRadius: '6px',\n                  fontSize: '0.75rem',\n                  color: '#92400e'\n                }}>\n                  <strong> Dleit:</strong> Vztah funguje jen pokud m uivatel globln prvo\n                  (nap. <code style={{ background: '#fef3c7', padding: '2px 4px', borderRadius: '3px' }}>ORDER_EDIT_OWN</code>).\n                </div>\n              </DetailSection>\n              </>\n                );\n              })()}\n\n              {/* Sekce Rozen lokality/seky - POUZE pro edge (vztahy) kde m smysl */}\n              {selectedEdge && (() => {\n                const sourceNode = nodes.find(n => n.id === selectedEdge.source);\n                const targetNode = nodes.find(n => n.id === selectedEdge.target);\n                const sourceType = sourceNode?.data?.metadata?.type || sourceNode?.data?.type || 'user';\n                const targetType = targetNode?.data?.metadata?.type || targetNode?.data?.type || 'user';\n                const relationInfo = getRelationshipTypeInfo(sourceType, targetType);\n                \n                if (!relationInfo.showExtended) return null;\n                \n                return (\n              <>\n              <Divider />\n\n              <DetailSection>\n                <DetailSectionTitle>\n                  <FontAwesomeIcon icon={faMapMarkerAlt} />\n                  Rozen lokality\n                </DetailSectionTitle>\n                <FormGroup>\n                  <CustomSelect\n                    value={selectedExtendedLocations}\n                    onChange={(newValues) => setSelectedExtendedLocations(newValues)}\n                    options={allLocations}\n                    placeholder=\"Vyberte lokality...\"\n                    field=\"extendedLocations\"\n                    multiple={true}\n                    selectStates={selectStates}\n                    setSelectStates={setSelectStates}\n                    searchStates={searchStates}\n                    setSearchStates={setSearchStates}\n                    touchedSelectFields={touchedSelectFields}\n                    setTouchedSelectFields={setTouchedSelectFields}\n                    toggleSelect={toggleSelect}\n                    filterOptions={filterOptions}\n                    getOptionLabel={getOptionLabel}\n                    hasTriedToSubmit={false}\n                  />\n                </FormGroup>\n              </DetailSection>\n\n              <Divider />\n\n              <DetailSection>\n                <DetailSectionTitle>\n                  <FontAwesomeIcon icon={faBuilding} />\n                  Rozen seky\n                </DetailSectionTitle>\n                <FormGroup>\n                  <CustomSelect\n                    value={selectedExtendedDepartments}\n                    onChange={(newValues) => setSelectedExtendedDepartments(newValues)}\n                    options={allDepartments}\n                    placeholder=\"Vyberte seky...\"\n                    field=\"extendedDepartments\"\n                    multiple={true}\n                    selectStates={selectStates}\n                    setSelectStates={setSelectStates}\n                    searchStates={searchStates}\n                    setSearchStates={setSearchStates}\n                    touchedSelectFields={touchedSelectFields}\n                    setTouchedSelectFields={setTouchedSelectFields}\n                    toggleSelect={toggleSelect}\n                    filterOptions={filterOptions}\n                    getOptionLabel={getOptionLabel}\n                    hasTriedToSubmit={false}\n                  />\n                </FormGroup>\n              </DetailSection>\n\n              <Divider />\n\n              <DetailSection>\n                <DetailSectionTitle>\n                  <FontAwesomeIcon icon={faLayerGroup} />\n                  Kombinace lokalita + sek\n                </DetailSectionTitle>\n                <p style={{ fontSize: '0.85rem', color: '#6c757d', marginBottom: '12px' }}>\n                  Specifick kombinace lokalita+sek (AND logika). Nap. \"jen IT z Berouna\".\n                </p>\n                {selectedCombinations.length > 0 ? (\n                  <CombinationTable>\n                    <thead>\n                      <tr>\n                        <th>Lokalita</th>\n                        <th>sek</th>\n                        <th style={{ width: '40px' }}></th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {selectedCombinations.map((combo, index) => {\n                        const location = allLocations.find(l => l.id === combo.locationId);\n                        const department = allDepartments.find(d => d.id === combo.departmentId);\n                        return (\n                          <tr key={index}>\n                            <td>{location?.name || 'N/A'}</td>\n                            <td>{department?.name || 'N/A'}</td>\n                            <td>\n                              <button onClick={() => {\n                                setSelectedCombinations(prev => prev.filter((_, i) => i !== index));\n                              }}>\n                                <FontAwesomeIcon icon={faTimes} />\n                              </button>\n                            </td>\n                          </tr>\n                        );\n                      })}\n                    </tbody>\n                  </CombinationTable>\n                ) : (\n                  <p style={{ fontSize: '0.85rem', color: '#adb5bd', fontStyle: 'italic', marginTop: '8px' }}>\n                    Zatim zadne kombinace\n                  </p>\n                )}\n                <CombinationAddRow>\n                  <FormGroup style={{ marginBottom: 0 }}>\n                    <Label>Lokalita</Label>\n                    <Select id=\"combo-location-select\">\n                      <option value=\"\">-- Vyberte lokalitu --</option>\n                      {allLocations.map(loc => (\n                        <option key={loc.id} value={loc.id}>\n                          {loc.name} {loc.code ? `(${loc.code})` : ''}\n                        </option>\n                      ))}\n                    </Select>\n                  </FormGroup>\n                  <FormGroup style={{ marginBottom: 0 }}>\n                    <Label>sek</Label>\n                    <Select id=\"combo-department-select\">\n                      <option value=\"\">-- Vyberte sek --</option>\n                      {allDepartments.map(dept => (\n                        <option key={dept.id} value={dept.id}>\n                          {dept.name} {dept.code ? `(${dept.code})` : ''}\n                        </option>\n                      ))}\n                    </Select>\n                  </FormGroup>\n                  <button onClick={() => {\n                    const locSelect = document.getElementById('combo-location-select');\n                    const deptSelect = document.getElementById('combo-department-select');\n                    const locationId = locSelect.value;\n                    const departmentId = deptSelect.value;\n                    \n                    if (locationId && departmentId) {\n                      // Check if combination already exists\n                      const exists = selectedCombinations.some(\n                        c => c.locationId === locationId && c.departmentId === departmentId\n                      );\n                      \n                      if (!exists) {\n                        setSelectedCombinations(prev => [...prev, { locationId, departmentId }]);\n                        locSelect.value = '';\n                        deptSelect.value = '';\n                      }\n                    }\n                  }}>\n                    Pridat\n                  </button>\n                </CombinationAddRow>\n              </DetailSection>\n              </>\n                );\n              })()}\n\n              {/* Sekce notifikac - zobraz jen kdy edge obsahuje template */}\n              {selectedEdge && (() => {\n                const sourceNode = nodes.find(n => n.id === selectedEdge.source);\n                const targetNode = nodes.find(n => n.id === selectedEdge.target);\n                const isTemplateEdge = sourceNode?.data?.type === 'template' || targetNode?.data?.type === 'template';\n                \n                if (!isTemplateEdge) return null;\n                \n                // Najdi template node\n                const templateNode = sourceNode?.data?.type === 'template' ? sourceNode : targetNode;\n                \n                return (\n                  <>\n                    <DetailSection>\n                      <DetailSectionTitle>\n                        <FontAwesomeIcon icon={faBell} />\n                        Nastaven notifikac\n                      </DetailSectionTitle>\n                      <div style={{ \n                        padding: '12px', \n                        background: '#fef3c7', \n                        borderRadius: '6px',\n                        marginBottom: '12px',\n                        border: '1px solid #fbbf24'\n                      }}>\n                        <div style={{ fontSize: '0.8rem', color: '#78350f', fontWeight: 500 }}>\n                           <strong>{templateNode?.data?.name}</strong>\n                        </div>\n                        <div style={{ fontSize: '0.75rem', color: '#92400e', marginTop: '4px' }}>\n                          Bude odeslna: {targetNode?.data?.type === 'template' ? sourceNode.data.name : targetNode.data.name}\n                        </div>\n                        <div style={{ \n                          fontSize: '0.7rem', \n                          color: '#92400e', \n                          marginTop: '6px',\n                          fontStyle: 'italic',\n                          paddingTop: '6px',\n                          borderTop: '1px solid #fbbf24'\n                        }}>\n                           Variantu HTML emailu vyberte v detailu notifikanho uzlu (kliknte na uzel)\n                        </div>\n                      </div>\n                      \n                      {/* Typ notifikace pro pjemce */}\n                      <FormGroup style={{ marginBottom: '16px' }}>\n                        <Label>\n                          Typ notifikace pro pjemce\n                          <span style={{ color: '#f59e0b', marginLeft: '4px' }}>*</span>\n                        </Label>\n                        <Select \n                          value={notificationRecipientRole} \n                          onChange={(e) => setNotificationRecipientRole(e.target.value)}\n                        >\n                          <option value=\"APPROVAL\"> Poadavek na schvlen</option>\n                          <option value=\"INFO\"> Informan oznmen</option>\n                          <option value=\"BOTH\"> Oboje (schvlen + info)</option>\n                        </Select>\n                        <div style={{ \n                          fontSize: '0.7rem', \n                          color: '#64748b', \n                          marginTop: '6px',\n                          fontStyle: 'italic'\n                        }}>\n                           Urgentnost ur a udlost v procesu. Zde jen definujete charakter notifikace.\n                        </div>\n                      </FormGroup>\n                      \n                      <CheckboxGroup>\n                        <CheckboxLabel>\n                          <input \n                            type=\"checkbox\" \n                            checked={notificationEmailEnabled}\n                            onChange={(e) => setNotificationEmailEnabled(e.target.checked)}\n                          />\n                          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                            <FontAwesomeIcon icon={faEnvelope} style={{ color: '#667eea' }} />\n                            <span>Poslat emailem</span>\n                          </div>\n                        </CheckboxLabel>\n                        <CheckboxLabel>\n                          <input \n                            type=\"checkbox\" \n                            checked={notificationInAppEnabled}\n                            onChange={(e) => setNotificationInAppEnabled(e.target.checked)}\n                          />\n                          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                            <FontAwesomeIcon icon={faBell} style={{ color: '#f5576c' }} />\n                            <span>Zobrazit ve zvoneku (in-app)</span>\n                          </div>\n                        </CheckboxLabel>\n                      </CheckboxGroup>\n                      \n                      <div style={{ \n                        marginTop: '12px',\n                        padding: '10px',\n                        background: '#f0fdf4',\n                        borderRadius: '6px',\n                        fontSize: '0.75rem',\n                        color: '#166534',\n                        border: '1px solid #86efac'\n                      }}>\n                        <strong> Hierarchie rozhodovn:</strong>\n                        <ol style={{ margin: '6px 0 0 18px', padding: 0 }}>\n                          <li>Globln nastaven aplikace</li>\n                          <li>Nastaven tohoto vztahu (zde)</li>\n                          <li>Uivatelsk preference v profilu</li>\n                        </ol>\n                        <div style={{ marginTop: '6px', fontSize: '0.7rem', color: '#15803d' }}>\n                          Notifikace se odele pouze kdy jsou vechny 3 rovn povoleny.\n                        </div>\n                      </div>\n                    </DetailSection>\n                    <Divider />\n                  </>\n                );\n              })()}\n\n              {/* Akn tlatka - zobrazit vdy kdy je vybran node nebo edge */}\n              {(selectedNode || selectedEdge) && (\n              <DetailSection>\n                {/* Tlatko 'Uloit zmny' odstranno - zmny se ukldaj automaticky pes useEffect */}\n                {/* Finln uloen do DB probhne pes hlavn tlatko ULOIT / ULOIT JAKO v headeru */}\n                <button\n                  onClick={selectedNode ? handleDeleteNode : handleDeleteEdge}\n                  style={{\n                    width: '100%',\n                    padding: '10px 16px',\n                    background: '#dc2626',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '6px',\n                    cursor: 'pointer',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    gap: '8px',\n                    fontSize: '0.9rem',\n                    fontWeight: '600',\n                    transition: 'all 0.2s'\n                  }}\n                  onMouseEnter={(e) => {\n                    e.target.style.background = '#b91c1c';\n                    e.target.style.transform = 'translateY(-1px)';\n                    e.target.style.boxShadow = '0 4px 12px rgba(220, 38, 38, 0.4)';\n                  }}\n                  onMouseLeave={(e) => {\n                    e.target.style.background = '#dc2626';\n                    e.target.style.transform = 'translateY(0)';\n                    e.target.style.boxShadow = 'none';\n                  }}\n                >\n                  <FontAwesomeIcon icon={faTrash} />\n                  <span>{selectedNode ? 'Odstranit uzel' : 'Odstranit vztah'}</span>\n                </button>\n              </DetailSection>\n              )}\n            </DetailContent>\n          </DetailPanel>\n        )}\n      </MainContent>\n\n      {dialog.show && (\n        <DialogOverlay onClick={() => dialog.onCancel?.()}>\n          <DialogBox onClick={(e) => e.stopPropagation()}>\n            <DialogIcon>{dialog.icon}</DialogIcon>\n            <DialogTitle>{dialog.title}</DialogTitle>\n            <DialogMessage>{dialog.message}</DialogMessage>\n            {dialog.stats && (\n              <DialogStats>\n                {Object.entries(dialog.stats).map(([key, value]) => (\n                  <div key={key}>\n                    <strong>{key}:</strong>\n                    <span>{value}</span>\n                  </div>\n                ))}\n              </DialogStats>\n            )}\n            <DialogActions>\n              {dialog.cancelText && (\n                <DialogButton onClick={dialog.onCancel}>\n                  {dialog.cancelText}\n                </DialogButton>\n              )}\n              <DialogButton primary onClick={dialog.onConfirm}>\n                {dialog.confirmText}\n              </DialogButton>\n            </DialogActions>\n          </DialogBox>\n        </DialogOverlay>\n      )}\n\n      {/* Detail Help Modal */}\n      {showDetailHelpModal && (\n        <DialogOverlay onClick={(e) => {\n          // Zavt pouze pi kliknut na overlay, ne na dialogBox\n          if (e.target === e.currentTarget) {\n            setShowDetailHelpModal(false);\n          }\n        }}>\n          <DialogBox onClick={(e) => e.stopPropagation()} style={{ maxWidth: '700px' }}>\n            <DialogIcon></DialogIcon>\n            <DialogTitle>\n              {selectedNode ? 'Npovda k detailu uzlu' : 'Npovda k detailu vztahu'}\n            </DialogTitle>\n            <HelpModalContent>\n              {selectedNode ? (\n                // Node help\n                <>\n                  <HelpSection>\n                    <h3> {selectedNode.data?.label}</h3>\n                    <p>Panel zobrazuje vztahy tohoto uzlu v diagramu:</p>\n                    <p style={{ marginTop: '8px' }}>\n                      <strong> Nadzen</strong> - komu tento uzel podlh<br/>\n                      <strong> Podzen</strong> - kdo tomuto uzlu podlh\n                    </p>\n                  </HelpSection>\n\n                  <HelpSection>\n                    <h3> Ukldn</h3>\n                    <p>\n                      Zmny se automaticky ukldaj do <code>localStorage</code>. Pro trval uloen do DB pouijte \n                      tlatko <strong>\" Uloit do DB\"</strong>.\n                    </p>\n                  </HelpSection>\n                </>\n              ) : (\n                // Edge help\n                <>\n                  <HelpSection>\n                    <h3> {(() => {\n                      const sourceNode = nodes.find(n => n.id === selectedEdge?.source);\n                      const targetNode = nodes.find(n => n.id === selectedEdge?.target);\n                      return `${sourceNode?.data?.label || '?'}  ${targetNode?.data?.label || '?'}`;\n                    })()}</h3>\n                    <p><strong>Nadzen zskv prva vidt data od Podzenho</strong> podle nastaven.</p>\n                  </HelpSection>\n\n                  <HelpSection>\n                    <h3> Rozsah ({relationshipScope})</h3>\n                    <p>\n                      <code>OWN</code> - vlastn zznamy podzenho<br/>\n                      <code>TEAM</code> - cel sek podzenho<br/>\n                      <code>LOCATION</code> - cel lokalita podzenho<br/>\n                      <code>ALL</code> - kompletn pstup\n                    </p>\n                  </HelpSection>\n\n                  <HelpSection>\n                    <h3> rove prv</h3>\n                    <p>Uruje, CO me nadzen dlat se zznamy podzenho:</p>\n                    <HelpExample>\n                      <strong>Pklad:</strong>\n                      <span>\n                        Holovsk (THP) m prvo <code>CREATE + EDIT</code> vlastn objednvky.<br/>\n                        ernhorsk je nadzen s rovn <code>READ_ONLY</code>.<br/>\n                         ernhorsk <strong>vid</strong> Holovskho objednvky, ale <strong>neme je editovat</strong>.\n                      </span>\n                    </HelpExample>\n                    <p style={{ marginTop: '12px', fontSize: '0.85rem' }}>\n                      <code>READ_ONLY</code> - vid zznamy, neme editovat<br/>\n                      <code>READ_WRITE</code> - me editovat zznamy<br/>\n                      <code>READ_WRITE_DELETE</code> - pln pstup vetn mazn<br/>\n                      <code>INHERIT</code> - dd stejn prva jako podzen\n                    </p>\n                    {(moduleVisibility.orders || moduleVisibility.invoices || moduleVisibility.cashbook) && (\n                      <div style={{ marginTop: '8px', padding: '8px', background: '#f0fdf4', borderRadius: '6px', border: '1px solid #86efac' }}>\n                        <strong style={{ fontSize: '0.85rem', color: '#166534' }}>Aktuln nastaven:</strong>\n                        <div style={{ fontSize: '0.8rem', color: '#166534', marginTop: '4px' }}>\n                          {moduleVisibility.orders && ` Objednvky: ${permissionLevel.orders}`}<br/>\n                          {moduleVisibility.invoices && ` Faktury: ${permissionLevel.invoices}`}<br/>\n                          {moduleVisibility.cashbook && ` Pokladna: ${permissionLevel.cashbook}`}\n                        </div>\n                      </div>\n                    )}\n                  </HelpSection>\n\n                  <HelpSection>\n                    <h3> Rozen oprvnn</h3>\n                    <p>\n                      <strong>Lokality/seky:</strong> Nadzen vid data i z dalch mst mimo zkladn vztah.<br/>\n                      <strong>Notifikace:</strong> {notificationEmailEnabled ? 'Email ' : 'Email '} {notificationInAppEnabled ? 'In-app ' : 'In-app '}\n                    </p>\n                  </HelpSection>\n\n                  <HelpSection>\n                    <h3> Kompletn pklad</h3>\n                    <HelpExample>\n                      <span style={{ fontSize: '0.85rem' }}>\n                        <strong>Situace:</strong> Petr je nadzen Jana.<br/>\n                        <strong>Nastaven:</strong> TEAM scope, modul Objednvky, rove READ_ONLY<br/><br/>\n                        <strong>Vsledek:</strong><br/>\n                         Petr <strong>vid vechny objednvky</strong> z Janova seku (i od koleg)<br/>\n                         Petr <strong>neme editovat</strong> tyto objednvky (jen st)<br/>\n                         Pokud Jan m prvo vytvet, Petr to prvo <strong>nedostane</strong>\n                      </span>\n                    </HelpExample>\n                  </HelpSection>\n                </>\n              )}\n            </HelpModalContent>\n            <DialogActions style={{ marginTop: '20px' }}>\n              <DialogButton primary onClick={() => setShowDetailHelpModal(false)}>\n                Rozumm\n              </DialogButton>\n            </DialogActions>\n          </DialogBox>\n        </DialogOverlay>\n      )}\n\n      {/* Custom Confirm Dialog */}\n      {confirmDialog.isOpen && (\n        <ModalOverlay onClick={() => setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null })}>\n          <ModalContent onClick={(e) => e.stopPropagation()}>\n            <ModalHeader>\n              <FontAwesomeIcon icon={faTrash} />\n              {confirmDialog.title}\n            </ModalHeader>\n            <ModalBody>\n              {confirmDialog.message}\n            </ModalBody>\n            <ModalActions>\n              <ModalButton\n                onClick={() => setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null })}\n              >\n                Zruit\n              </ModalButton>\n              <ModalButton\n                variant=\"danger\"\n                onClick={confirmDialog.onConfirm}\n              >\n                Ano, smazat\n              </ModalButton>\n            </ModalActions>\n          </ModalContent>\n        </ModalOverlay>\n      )}\n      \n      {/* Profile Save As Dialog */}\n      {showProfileDialog && (\n        <ProfileDialog\n          mode={profileDialogMode}\n          onClose={() => setShowProfileDialog(false)}\n          onSave={handleProfileSaveConfirm}\n          existingProfiles={profiles}\n        />\n      )}\n      \n      {/* Fullscreen Email Modal */}\n      {showFullscreenEmailModal && (\n        <FullscreenEmailModal\n          isOpen={showFullscreenEmailModal}\n          onClose={() => {\n            setShowFullscreenEmailModal(false);\n            setFullscreenEmailData(null);\n          }}\n          emailData={fullscreenEmailData}\n        />\n      )}\n    </Container>\n  );\n};\n\n// Profile Dialog Component\nconst ProfileDialog = ({ mode, onClose, onSave, existingProfiles }) => {\n  const [profileName, setProfileName] = React.useState('');\n  const [profileDescription, setProfileDescription] = React.useState('');\n  const [error, setError] = React.useState('');\n  const [showConfirm, setShowConfirm] = React.useState(false);\n  \n  const handleSubmit = async () => {\n    if (!profileName.trim()) {\n      setError('Nazev profilu je povinny');\n      return;\n    }\n    \n    const result = await onSave(profileName, profileDescription);\n    \n    if (result.exists) {\n      setShowConfirm(true);\n    } else if (result.error) {\n      setError(result.error);\n    } else {\n      onClose();\n    }\n  };\n  \n  const handleOverwrite = async () => {\n    // TODO: Implementovat pepsn existujcho profilu\n    setShowConfirm(false);\n    onClose();\n  };\n  \n  if (showConfirm) {\n    return (\n      <DialogOverlay onClick={onClose}>\n        <DialogBox onClick={(e) => e.stopPropagation()}>\n          <DialogIcon></DialogIcon>\n          <DialogTitle>Profil jiz existuje</DialogTitle>\n          <DialogMessage>\n            Profil s nazvem \"<strong>{profileName}</strong>\" jiz existuje.\n            <br/><br/>\n            Chcete jej prepsat?\n          </DialogMessage>\n          <DialogActions>\n            <DialogButton onClick={() => setShowConfirm(false)}>\n              Zrusit\n            </DialogButton>\n            <DialogButton primary onClick={handleOverwrite}>\n              Ano, prepsat\n            </DialogButton>\n          </DialogActions>\n        </DialogBox>\n      </DialogOverlay>\n    );\n  }\n  \n  return (\n    <DialogOverlay onClick={onClose}>\n      <DialogBox onClick={(e) => e.stopPropagation()} style={{ maxWidth: '500px' }}>\n        <DialogIcon></DialogIcon>\n        <DialogTitle>{mode === 'saveAs' ? 'Ulozit jako novy profil' : 'Ulozit profil'}</DialogTitle>\n        <div style={{ padding: '20px', textAlign: 'left' }}>\n          <FormGroup>\n            <Label>Nazev profilu *</Label>\n            <Input\n              type=\"text\"\n              value={profileName}\n              onChange={(e) => {\n                setProfileName(e.target.value);\n                setError('');\n              }}\n              placeholder=\"napr. ZZSSK 2025, DEV DEMO...\"\n              autoFocus\n            />\n          </FormGroup>\n          <FormGroup>\n            <Label>Popis (volitelny)</Label>\n            <textarea\n              value={profileDescription}\n              onChange={(e) => setProfileDescription(e.target.value)}\n              placeholder=\"Strucny popis profilu...\"\n              rows={3}\n              style={{\n                width: '100%',\n                padding: '10px',\n                borderRadius: '6px',\n                border: '1px solid #e0e6ed',\n                fontSize: '0.95rem',\n                fontFamily: 'inherit',\n                resize: 'vertical'\n              }}\n            />\n          </FormGroup>\n          {error && (\n            <div style={{ \n              padding: '10px', \n              background: '#fee', \n              border: '1px solid #fcc',\n              borderRadius: '6px',\n              color: '#c00',\n              fontSize: '0.9rem',\n              marginTop: '10px'\n            }}>\n              {error}\n            </div>\n          )}\n        </div>\n        <DialogActions>\n          <DialogButton onClick={onClose}>\n            Zrusit\n          </DialogButton>\n          <DialogButton primary onClick={handleSubmit}>\n            Ulozit\n          </DialogButton>\n        </DialogActions>\n      </DialogBox>\n    </DialogOverlay>\n  );\n};\n\n// Fullscreen Email Modal Component\nconst FullscreenEmailModal = ({ isOpen, onClose, emailData }) => {\n  if (!isOpen || !emailData) return null;\n  \n  const { template, mockData, replacePlaceholders, selectedVariantType } = emailData;\n  \n  // Funkce pro extrakci sprvn varianty z email_body\n  const extractEmailVariant = (emailBody, variantType) => {\n    if (!emailBody) return emailBody;\n    \n    // Pokud je DEFAULT nebo nen delimiter, vra cel email_body\n    if (variantType === 'DEFAULT' || !emailBody.includes('<!-- RECIPIENT:')) {\n      return emailBody;\n    }\n    \n    // Extrahuj specifickou variantu\n    const delimiter = `<!-- RECIPIENT: ${variantType} -->`;\n    const startPos = emailBody.indexOf(delimiter);\n    \n    if (startPos === -1) {\n      return emailBody; // Fallback\n    }\n    \n    // Najdi zatek HTML (po delimiteru)\n    let htmlStart = startPos + delimiter.length;\n    \n    // Najdi konec (dal delimiter nebo konec stringu)\n    const otherDelimiters = ['APPROVER_NORMAL', 'APPROVER_URGENT', 'SUBMITTER']\n      .filter(d => d !== variantType)\n      .map(d => `<!-- RECIPIENT: ${d} -->`);\n    \n    let htmlEnd = emailBody.length;\n    for (const otherDelimiter of otherDelimiters) {\n      const pos = emailBody.indexOf(otherDelimiter, htmlStart);\n      if (pos !== -1 && pos < htmlEnd) {\n        htmlEnd = pos;\n      }\n    }\n    \n    return emailBody.substring(htmlStart, htmlEnd).trim();\n  };\n  \n  const emailBodyToDisplay = extractEmailVariant(template.email_body, selectedVariantType || 'DEFAULT');\n  \n  return (\n    <ModalOverlay onClick={onClose} style={{ zIndex: 20000 }}>\n      <div \n        onClick={(e) => e.stopPropagation()}\n        style={{\n          background: 'white',\n          borderRadius: '12px',\n          width: '98vw',\n          maxWidth: '1400px',\n          height: '75vh',\n          maxHeight: 'calc(100vh - 140px)',\n          display: 'flex',\n          flexDirection: 'column',\n          overflow: 'hidden',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.4)',\n          margin: '30px auto'\n        }}\n      >\n        {/* Header */}\n        <div style={{\n          padding: '16px 24px',\n          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n          color: 'white',\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          borderRadius: '12px 12px 0 0',\n          flexShrink: 0\n        }}>\n          <div>\n            <h2 style={{ margin: '0 0 6px 0', fontSize: '1.3rem', display: 'flex', alignItems: 'center', gap: '10px' }}>\n              <FontAwesomeIcon icon={faEnvelope} />\n              Email ablona\n              {selectedVariantType && selectedVariantType !== 'DEFAULT' && (() => {\n                const variantIcons = {\n                  'APPROVER_NORMAL': '',\n                  'APPROVER_URGENT': '',\n                  'SUBMITTER': ''\n                };\n                return variantIcons[selectedVariantType] || '';\n              })()}\n            </h2>\n            <div style={{ fontSize: '0.85rem', opacity: 0.95 }}>\n              <strong>ablona:</strong> {template.name || 'Bez nzvu'}\n              {selectedVariantType && selectedVariantType !== 'DEFAULT' && (\n                <>\n                  {'  '}\n                  <strong>Varianta:</strong> {\n                    selectedVariantType === 'APPROVER_NORMAL' ? 'Schvalovatel (normln)' :\n                    selectedVariantType === 'APPROVER_URGENT' ? 'Schvalovatel (mimodn)' :\n                    selectedVariantType === 'SUBMITTER' ? 'Autor objednvky' :\n                    selectedVariantType\n                  }\n                </>\n              )}\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'rgba(255,255,255,0.2)',\n              border: 'none',\n              color: 'white',\n              width: '40px',\n              height: '40px',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontSize: '1.5rem',\n              transition: 'all 0.2s'\n            }}\n            onMouseEnter={(e) => e.currentTarget.style.background = 'rgba(255,255,255,0.3)'}\n            onMouseLeave={(e) => e.currentTarget.style.background = 'rgba(255,255,255,0.2)'}\n          >\n            <FontAwesomeIcon icon={faTimes} />\n          </button>\n        </div>\n        \n        {/* Email Preview - IFRAME S JEDNM SCROLLEM */}\n        <div style={{\n          flex: 1,\n          overflow: 'hidden',\n          display: 'flex',\n          flexDirection: 'column',\n          background: 'white'\n        }}>\n          {/* Email Header */}\n          <div style={{\n            padding: '20px 30px',\n            borderBottom: '1px solid #e5e7eb',\n            background: '#fafbfc',\n            flexShrink: 0\n          }}>\n            <div style={{ marginBottom: '12px' }}>\n              <div style={{ fontSize: '1.1rem', fontWeight: '600', color: '#111827', lineHeight: '1.4' }}>\n                {replacePlaceholders(template.email_subject || 'Bez pedmtu')}\n              </div>\n            </div>\n            <div style={{ fontSize: '0.9rem', color: '#6b7280', marginBottom: '6px' }}>\n              <strong style={{ color: '#374151' }}>Od:</strong> EEO Systm &lt;noreply@eeo.cz&gt;\n            </div>\n            <div style={{ fontSize: '0.9rem', color: '#6b7280' }}>\n              <strong style={{ color: '#374151' }}>Komu:</strong> {mockData.recipient_name || mockData.user_name} &lt;{mockData.user_email}&gt;\n            </div>\n            <div style={{ fontSize: '0.85rem', color: '#9ca3af', marginTop: '8px' }}>\n              {mockData.datetime}\n            </div>\n          </div>\n          \n          {/* Email Body - IFRAME BEZ VLASTNHO SCROLLU */}\n          <iframe\n            title=\"Email Preview\"\n            style={{\n              width: '100%',\n              flex: 1,\n              border: 'none',\n              background: 'white',\n              overflow: 'hidden'\n            }}\n            srcDoc={`\n              <!DOCTYPE html>\n              <html>\n              <head>\n                <meta charset=\"UTF-8\">\n                <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                <style>\n                  html, body {\n                    margin: 0;\n                    padding: 0;\n                    font-family: Arial, sans-serif;\n                    background: #f9fafb;\n                    overflow: visible;\n                    height: auto;\n                  }\n                </style>\n              </head>\n              <body>\n                ${replacePlaceholders(emailBodyToDisplay || '<p style=\"color: #9ca3af; font-style: italic;\">Email tlo nen definovno v ablon</p>')}\n              </body>\n              </html>\n            `}\n          />\n        </div>\n      </div>\n    </ModalOverlay>\n  );\n};\n\nexport default OrganizationHierarchy;\n"],"names":["API_BASE_URL","process","replace","resizeObserverErr","window","console","error","_ref","errorMsg","arguments","length","undefined","message","includes","addEventListener","e","_e$message","_e$message$includes","_e$message2","_e$message2$includes","_e$message3","_e$message3$includes","call","stopImmediatePropagation","preventDefault","Container","styled","div","_templateObject","_taggedTemplateLiteral","Header","_templateObject2","Title","h1","_templateObject3","HeaderActions","_templateObject4","Button","button","_templateObject5","props","primary","ModalOverlay","_templateObject6","ModalContent","_templateObject7","ModalHeader","_templateObject8","ModalBody","_templateObject9","ModalActions","_templateObject0","ModalButton","_templateObject1","variant","MainContent","_templateObject10","Sidebar","_templateObject11","SidebarHeader","_templateObject12","SidebarTitle","h3","_templateObject13","SearchBox","_templateObject14","SearchInput","input","_templateObject15","SearchIcon","_templateObject16","SearchClearButton","_templateObject17","SidebarContent","_templateObject18","CollapsibleSection","_templateObject19","SectionHeader","_templateObject20","expanded","SectionContent","_templateObject21","UserItem","_templateObject22","isDragging","UserAvatar","_templateObject23","UserInfo","_templateObject24","UserName","_templateObject25","UserMeta","_templateObject26","LocationItem","_templateObject27","LocationIcon","_templateObject28","DepartmentIcon","_templateObject29","CanvasArea","_templateObject30","DetailPanel","_templateObject31","DetailHeader","_templateObject32","DetailHeaderTitle","_templateObject33","CloseButton","_templateObject34","InfoButton","_templateObject35","DetailContent","_templateObject36","DetailSection","_templateObject37","DetailSectionTitle","h4","_templateObject38","FormGroup","_templateObject39","Label","label","_templateObject40","Input","_templateObject41","ProfileSelectWrapper","_templateObject42","ProfileSelect","select","_templateObject43","ProfileSelectArrow","_templateObject44","ProfileDeleteButton","_templateObject45","disabled","Select","_templateObject46","CheckboxGroup","_templateObject47","CheckboxLabel","_templateObject48","Divider","_templateObject49","_templateObject50","_templateObject51","CombinationTable","table","_templateObject52","CombinationAddRow","_templateObject53","DialogOverlay","_templateObject54","DialogBox","_templateObject55","DialogIcon","_templateObject56","DialogTitle","h2","_templateObject57","DialogMessage","_templateObject58","DialogActions","_templateObject59","DialogButton","_templateObject60","DialogStats","_templateObject61","HelpModalContent","_templateObject62","HelpSection","_templateObject63","HelpExample","_templateObject64","nodeTypes","custom","_ref2","data","selected","isTemplate","type","isRole","isLocation","isDepartment","_jsxs","style","padding","borderRadius","background","border","concat","minWidth","boxShadow","transition","position","transform","children","_jsx","Handle","Position","Right","width","height","cursor","right","display","alignItems","gap","justifyContent","fontSize","flex","fontWeight","color","marginBottom","name","Left","left","_data$metadata","metadata","userCount","textAlign","Top","Bottom","FontAwesomeIcon","icon","faMapMarkerAlt","faUserTie","notifications","hasEmail","hasInApp","top","title","faEnvelope","faBell","initials","paddingTop","borderTop","flexDirection","location","department","types","marginTop","ProfileDialog","_ref0","mode","onClose","onSave","existingProfiles","profileName","setProfileName","React","profileDescription","setProfileDescription","setError","showConfirm","setShowConfirm","handleOverwrite","async","onClick","stopPropagation","maxWidth","value","onChange","target","placeholder","autoFocus","rows","fontFamily","resize","trim","result","exists","FullscreenEmailModal","_ref1","isOpen","emailData","template","mockData","replacePlaceholders","selectedVariantType","emailBodyToDisplay","extractEmailVariant","emailBody","variantType","delimiter","startPos","indexOf","htmlStart","otherDelimiters","filter","d","map","htmlEnd","otherDelimiter","pos","substring","email_body","zIndex","maxHeight","overflow","margin","flexShrink","opacity","_Fragment","onMouseEnter","currentTarget","onMouseLeave","faTimes","borderBottom","lineHeight","email_subject","recipient_name","user_name","user_email","datetime","srcDoc","OrganizationHierarchy","_selectedNode$data$me","_selectedNode$data$me2","_selectedNode$data$me3","_selectedNode$data2","useRef","showToast","useContext","ToastContext","hasError","setHasError","useState","useEffect","handleError","event","_event$message","_event$message2","warn","removeEventListener","searchUsers","setSearchUsers","localStorage","getItem","searchRoles","setSearchRoles","searchLocations","setSearchLocations","searchDepartments","setSearchDepartments","searchTemplates","setSearchTemplates","expandedSections","setExpandedSections","saved","JSON","parse","users","roles","locations","departments","notificationTemplates","selectedNode","setSelectedNode","selectedEdge","setSelectedEdge","showDetailPanel","setShowDetailPanel","loading","setLoading","nodes","setNodes","onNodesChange","useNodesState","edges","setEdges","onEdgesChange","useEdgesState","reactFlowInstance","setReactFlowInstance","allUsers","setAllUsers","allRoles","setAllRoles","allLocations","setAllLocations","allDepartments","setAllDepartments","notificationTypes","setNotificationTypes","allNotificationTemplates","setAllNotificationTemplates","selectedExtendedLocations","setSelectedExtendedLocations","selectedNotificationTypes","setSelectedNotificationTypes","notificationEmailEnabled","setNotificationEmailEnabled","notificationInAppEnabled","setNotificationInAppEnabled","notificationRecipientRole","setNotificationRecipientRole","relationshipType","setRelationshipType","relationshipScope","setRelationshipScope","templateNormalVariant","setTemplateNormalVariant","templateUrgentVariant","setTemplateUrgentVariant","templateInfoVariant","setTemplateInfoVariant","templatePreviewVariant","setTemplatePreviewVariant","permissionLevel","setPermissionLevel","orders","invoices","contracts","cashbook","moduleVisibility","setModuleVisibility","cashbookReadonly","isShiftPressed","setIsShiftPressed","toggleSelect","useCallback","fieldName","setSelectStates","prev","_objectSpread","filterOptions","options","searchTerm","normalized","toLowerCase","normalize","option","nazev","String","getOptionLabel","code","selectedExtendedDepartments","setSelectedExtendedDepartments","selectedCombinations","setSelectedCombinations","selectStates","searchStates","setSearchStates","touchedSelectFields","setTouchedSelectFields","profiles","setProfiles","currentProfile","setCurrentProfile","showProfileDialog","setShowProfileDialog","profileDialogMode","setProfileDialogMode","eds","_e$data","id","druh_vztahu","scope","modules","extended","combinations","email","inapp","recipientRole","_selectedNode$data","nds","n","normalVariant","urgentVariant","infoVariant","previewVariant","selectedUsers","setSelectedUsers","Set","selectedRoles","setSelectedRoles","selectedLocations","setSelectedLocations","selectedDepartments","setSelectedDepartments","selectedNotificationTemplates","setSelectedNotificationTemplates","confirmDialog","setConfirmDialog","onConfirm","showHelp","setShowHelp","showDetailHelpModal","setShowDetailHelpModal","showFullscreenEmailModal","setShowFullscreenEmailModal","fullscreenEmailData","setFullscreenEmailData","dialog","setDialog","show","onCancel","confirmText","cancelText","stats","LS_NODES_KEY","LS_EDGES_KEY","LS_TIMESTAMP_KEY","LS_PROFILE_KEY","hasDraft","setHasDraft","setItem","stringify","Date","toISOString","err","handleDeleteSelected","selectedNodes","selectedEdges","nodeIdsToDelete","source","edgeIdsToDelete","log","handleKeyDown","key","metaKey","handleKeyUp","handleBlur","draftLoaded","savedNodes","savedEdges","savedTimestamp","timestamp","now","getTime","parsedNodes","parsedEdges","removeItem","token","loadAuthData","userData","user","username","apiBase","fetchData","response","fetch","endpoint","method","headers","body","ok","Error","status","json","usersData","rolesData","locationsData","departmentsData","profilesData","notifTypesData","templatesData","Promise","all","rolesWithUserCount","role","Array","isArray","profilesList","selectedProfile","getGlobalSettings","globalSettings","hierarchy_profile_id","find","p","parseInt","_selectedProfile","isActive","structureData","success","relations","profilId","then","r","shouldLoadFromApi","_structureData","_structureData2","_structureData2$data","_structureData3","_structureData3$data","_structureData4","_structureData4$data","_structureData5","_structureData5$data","apiNodes","apiRelations","flowNodes","node","index","nodeId","nodeData","userId","locationId","departmentId","_node$settings","_node$settings2","_node$settings3","_node$settings4","templateId","settings","roleId","popis","position_1","position_2","x","y","Math","floor","getEdgeColor","relationType","flowEdges","rel","sourceNode","targetNode","relType","sourceType","targetType","split","user_id_1","role_id","lokalita_id","usek_id","template_id","user_id_2","edgeColor","edgeScope","level","animated","markerEnd","MarkerType","ArrowClosed","stroke","strokeWidth","visibility","loadHierarchyData","setTimeout","fitView","duration","onConnect","params","_sourceNode$data","_targetNode$data","addEdge","_node$data","nodeType","_n$data","onNodeClick","_node$data2","ctrlKey","onEdgeClick","edge","_edge$data","_edge$data$extended","_edge$data2","_edge$data2$permissio","_edge$data2$permissio2","_edge$data3","_edge$data3$extended","_edge$data4","_edge$data4$permissio","_edge$data4$permissio2","_edge$data5","_edge$data5$notificat","_edge$data6","_edge$data6$notificat","_edge$data7","_edge$data7$notificat","_edge$data8","_edge$data9","_edge$data0","_ref3","_edge$data$modules$or","_edge$data1","_edge$data1$modules","_edge$data10","_edge$data10$visibili","_ref4","_edge$data$modules$in","_edge$data11","_edge$data11$modules","_edge$data12","_edge$data12$visibili","_ref5","_edge$data$modules$co","_edge$data13","_edge$data13$modules","_edge$data14","_edge$data14$visibili","_ref6","_edge$data$modules$ca","_edge$data15","_edge$data15$modules","_edge$data16","_edge$data16$visibili","_edge$data$modules$ca2","_edge$data17","_edge$data17$modules","_ref7","_edge$data$modules$us","_edge$data18","_edge$data18$modules","_edge$data19","_edge$data19$visibili","_ref8","_edge$data$modules$lp","_edge$data20","_edge$data20$modules","_edge$data21","_edge$data21$visibili","_edge$data22","_edge$data22$permissi","_edge$data23","_edge$data23$permissi","_edge$data24","_edge$data24$permissi","_edge$data25","_edge$data25$permissi","_edge$data26","_edge$data26$extended","_edge$data27","_edge$data27$permissi","_edge$data27$permissi2","_edge$data28","_edge$data28$notifica","_edge$data29","_edge$data29$permissi","_edge$data29$permissi2","_sourceNode$data2","_targetNode$data2","_sourceNode$data3","_sourceNode$data3$met","_sourceNode$data4","_targetNode$data3","_targetNode$data3$met","_targetNode$data4","extendedLocs","permissions","extendedDepts","objednavky","faktury","smlouvy","pokladna","uzivatele","lp","combos","notifTypes","sourceName","targetName","getRelationshipTypeInfo","description","sourceLabel","targetLabel","showScope","showExtended","showModules","explanation","onNodeDragStop","updatedNode","_updatedNode$data","toggleSection","section","toggleNotificationTemplateSelection","newSet","has","delete","add","draggedItem","setDraggedItem","getLayoutedElements","direction","dagreGraph","graphlib","Graph","setDefaultEdgeLabel","setGraph","rankdir","nodesep","ranksep","marginx","marginy","forEach","setNode","setEdge","dagre","nodeWithPosition","nodeWidth","nodeHeight","generateHierarchyFromSelectedNodes","director","_n$data$position","deputies","_n$data$position2","heads","_n$data$position3","others","_n$data$position4","_n$data$position5","_n$data$position6","newEdges","deputy","push","head","_d$data$metadata","_head$data$metadata","selectedNodeIds","updatedEdges","layoutedNodes","layoutedEdges","loadProfiles","activeProfile","handleSave","targetProfileId","profileId","totalNodes","totalEdges","_n$data2","_n$data3","_n$data4","_edge$data30","_edge$data31","_edge$data32","_edge$data33","_edge$data34","_edge$data35","_edge$data36","_edge$data36$modules","_edge$data37","_edge$data37$visibili","_edge$data38","_edge$data38$modules","_edge$data39","_edge$data39$visibili","_edge$data40","_edge$data40$modules","_edge$data41","_edge$data41$visibili","_edge$data42","_edge$data42$modules","_edge$data43","_edge$data43$visibili","_edge$data44","_edge$data44$modules","_edge$data45","_edge$data45$visibili","_edge$data46","_edge$data46$modules","_edge$data47","_edge$data47$visibili","_edge$data48","_edge$data49","_edge$data50","_edge$data51","_sourceNode$data5","_sourceNode$data6","_sourceNode$data7","_sourceNode$data8","_targetNode$data5","_targetNode$data6","_targetNode$data7","_targetNode$data8","getNodeType","_node$data3","_node$data4","_node$data5","_node$data6","_node$data7","edgeLevel","relation","node_settings","payload","profile_id","_node$data8","_node$data9","_node$data0","_node$data1","_node$data10","_node$data11","_node$data12","_node$data13","_node$data14","_node$data15","_n$data5","_n$data6","statusText","errorText","text","details","savedProfile","toString","timeout","filteredUsers","u","filteredRoles","nazev_role","filteredLocations","loc","filteredDepartments","dept","filteredNotificationTemplates","faSitemap","reload","whiteSpace","profile","confirm","nodePositions","Map","node_1","set","node_2","size","nodeIdMap","transformedNodes","reactFlowId","get","transformedEdges","idx","sourceId","targetId","availableKeys","Object","keys","handleProfileChange","relationshipsCount","newActiveState","action","setProfileActive","alert","handleToggleProfileActive","marginRight","relationshipsText","handleDeleteProfile","handleAutoGenerateHierarchy","faEye","faSave","handleSaveAs","flexWrap","faLayerGroup","faSearch","faChevronDown","faChevronRight","faUsers","marginLeft","draggable","onDragStart","dataTransfer","effectAllowed","setData","onDragEnd","borderColor","checked","accentColor","faUserShield","l","faBuilding","deptId","t","_template$email","sendByDefault","priorityDefault","bottom","addSelectedToCanvas","newNodes","userIndex","locIndex","deptIndex","tplIndex","prevNodes","faPlus","faTrash","onDrop","dragId","reactFlowElement","querySelector","reactFlowBounds","getBoundingClientRect","screenToFlowPosition","clientX","clientY","bounds","viewport","getViewport","startsWith","notifId","newNode","toUpperCase","onDragOver","dropEffect","className","ReactFlow","onInit","attributionPosition","selectionOnDrag","panOnDrag","panOnScroll","zoomOnScroll","zoomOnDoubleClick","selectionMode","selectionKeyCode","multiSelectionKeyCode","selectNodesOnDrag","onSelectionChange","selectedNodesCount","selectedEdgesCount","totalSelected","Background","Controls","MiniMap","nodeColor","_node$data16","_node$data17","_node$data18","maskColor","pannable","zoomable","Panel","paddingBottom","overflowY","overflowX","paddingRight","faEdit","faInfoCircle","isSelected","readOnly","availableVariants","variants","variantDef","marker","parseAllVariants","defaultVariant","fontStyle","paddingLeft","order_number","order_id","ev_cislo","cislo_objednavky","old_status","new_status","datum_vytvoreni","datum_pozadavku","datum_zmeny","predmet","order_subject","subject","cena_celkem","cena_bez_dph","cena_s_dph","max_price_with_dph","dodavatel","supplier_name","supplier","pozadovatel_jmeno","pozadovatel_email","pozadovatel","requester_name","requester_email","schvalovatel_jmeno","schvalovatel_email","approver_name","approver_email","action_user_name","action_performed_by","action_date","url_objednavky","order_url","url","poznamka","reason","comment","date","time","regex1","RegExp","regex2","app_title","app_message","borderLeft","textOverflow","WebkitLineClamp","WebkitBoxOrient","faExpand","minHeight","zoom","transformOrigin","dangerouslySetInnerHTML","__html","recipients","_targetNode$data9","_targetNode$data0","_targetNode$data1","edgeId","recipient","i","bgColor","textColor","assignedUsers","_sourceNode$data9","_sourceNode$data0","_sourceNode$data1","module","hasPermission","supervisors","_sourceNode$data10","_e$data2","subordinates","_targetNode$data10","_e$data3","sup","sub","_sourceNode$data11","_sourceNode$data12","_sourceNode$data12$me","_sourceNode$data13","_targetNode$data11","_targetNode$data12","_targetNode$data12$me","_targetNode$data13","_sourceNode$data18","_sourceNode$data19","_targetNode$data20","_targetNode$data21","_sourceNode$data22","_sourceNode$data22$na","_targetNode$data22","_targetNode$data22$na","dataType","metadataType","_sourceNode$data14","_sourceNode$data14$me","_sourceNode$data15","_targetNode$data14","_targetNode$data14$me","_targetNode$data15","relationInfo","_sourceNode$data16","_sourceNode$data16$me","_sourceNode$data17","_targetNode$data16","_targetNode$data16$me","_targetNode$data17","_sourceNode$data20","_sourceNode$data20$me","_sourceNode$data21","_targetNode$data18","_targetNode$data18$me","_targetNode$data19","_sourceNode$data23","_sourceNode$data23$me","_sourceNode$data24","_targetNode$data23","_targetNode$data23$me","_targetNode$data24","_sourceNode$data25","_sourceNode$data25$me","_sourceNode$data26","_targetNode$data25","_targetNode$data25$me","_targetNode$data26","_sourceNode$data27","_sourceNode$data27$na","_sourceNode$data28","_sourceNode$data28$me","_sourceNode$data29","_targetNode$data27","_targetNode$data27$me","_targetNode$data28","textTransform","letterSpacing","_sourceNode$data30","_sourceNode$data30$me","_sourceNode$data31","_targetNode$data29","_targetNode$data29$me","_targetNode$data30","CustomSelect","newValues","field","multiple","hasTriedToSubmit","combo","_","locSelect","document","getElementById","deptSelect","some","c","_sourceNode$data32","_targetNode$data31","_sourceNode$data33","_templateNode$data","_targetNode$data32","templateNode","_dialog$onCancel","entries","_ref9","_sourceNode$data34","_targetNode$data33","createResponse","set_active","createResult","newProfileId"],"sourceRoot":""}