{"version":3,"file":"static/js/6704.87ff2731.chunk.js","mappings":"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","sources":["components/EditableCombobox.js","components/PokladniKnihaPDF.js","components/cashbook/BookStatusBadge.js","components/CashboxSelector.jsx","utils/cashbookPermissions.js","pages/CashBookPage.js","utils/pdfFonts.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport styled from '@emotion/styled';\n\n// =============================================================================\n// STYLED COMPONENTS\n// =============================================================================\n\nconst ComboboxWrapper = styled.div`\n  position: relative;\n  width: 100%;\n`;\n\nconst ComboboxInput = styled.input`\n  width: 100%;\n  padding: 0.5rem;\n  border: 1px solid ${props => props.hasError ? '#e53e3e' : '#cbd5e0'};\n  border-radius: 4px;\n  font-size: 0.9rem;\n  background-color: ${props => props.disabled ? '#f7fafc' : 'white'};\n  cursor: ${props => props.disabled ? 'not-allowed' : 'text'};\n  transition: all 0.2s;\n\n  &:focus {\n    outline: none;\n    border-color: ${props => props.hasError ? '#e53e3e' : '#4299e1'};\n    box-shadow: 0 0 0 3px ${props => props.hasError ? 'rgba(229, 62, 62, 0.1)' : 'rgba(66, 153, 225, 0.1)'};\n  }\n\n  &::placeholder {\n    color: #a0aec0;\n  }\n`;\n\nconst DropdownList = styled.ul`\n  position: fixed; /* Fixed msto absolute pro Portal */\n  min-width: 320px; /* ir dropdown kvli popisu LP kd */\n  max-width: 500px;\n  max-height: 250px;\n  overflow-y: auto;\n  background: white;\n  border: 1px solid #cbd5e0;\n  border-radius: 4px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  z-index: 10000; /* Vysok z-index pro Portal */\n  margin: 0;\n  padding: 0;\n  list-style: none;\n`;\n\nconst DropdownItem = styled.li`\n  padding: 0.6rem 0.85rem;\n  cursor: pointer;\n  transition: background-color 0.15s;\n  font-size: 0.9rem;\n  border-bottom: 1px solid #f7fafc;\n\n  &:hover,\n  &.highlighted {\n    background-color: #edf2f7;\n  }\n\n  &.selected {\n    background-color: #4299e1;\n    color: white;\n\n    small {\n      color: #e6f2ff;\n    }\n  }\n\n  strong {\n    font-family: monospace;\n    font-size: 0.95rem;\n    color: #2d3748;\n  }\n\n  &.selected strong {\n    color: white;\n  }\n\n  small {\n    display: block;\n    color: #718096;\n    font-size: 0.8rem;\n    margin-top: 0.2rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n`;\n\nconst NoResults = styled.div`\n  padding: 0.75rem;\n  color: #718096;\n  font-size: 0.85rem;\n  text-align: center;\n  font-style: italic;\n`;\n\n// =============================================================================\n// EDITABLE COMBOBOX COMPONENT\n// =============================================================================\n\n/**\n * EditableCombobox - Komponenta kombinujc input s autocomplete\n *\n * Umouje:\n * - Voln text (uivatel me napsat cokoliv)\n * - Naeptvn pi shod s polokami\n * - Vbr z naeptvanch poloek\n * - Neomezuje uivatele\n *\n * @param {string} value - Aktuln hodnota\n * @param {function} onChange - Callback pi zmn hodnoty\n * @param {function} onKeyDown - Callback pi stisku klvesy\n * @param {function} onBlur - Callback pi oputn inputu\n * @param {array} options - Pole monost pro naeptvn [{ code, name }, ...]\n * @param {string} placeholder - Placeholder text\n * @param {boolean} disabled - Zakzn inputu\n * @param {boolean} hasError - Indikace chyby\n * @param {boolean} loading - Indikace natn\n */\nconst EditableCombobox = ({\n  value = '',\n  onChange,\n  onKeyDown,\n  onBlur,\n  options = [],\n  placeholder = 'Zante pst...',\n  disabled = false,\n  hasError = false,\n  loading = false\n}) => {\n  const [inputValue, setInputValue] = useState(value);\n  const [isOpen, setIsOpen] = useState(false);\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\n  const [dropdownPosition, setDropdownPosition] = useState({ top: 0, left: 0, width: 0 });\n  const inputRef = useRef(null);\n  const wrapperRef = useRef(null);\n\n  // Synchronizace s vnj hodnotou\n  useEffect(() => {\n    setInputValue(value || '');\n  }, [value]);\n\n  // Vpoet pozice dropdownu\n  const updateDropdownPosition = () => {\n    if (inputRef.current) {\n      const rect = inputRef.current.getBoundingClientRect();\n      setDropdownPosition({\n        top: rect.bottom + window.scrollY,\n        left: rect.left + window.scrollX,\n        width: Math.max(rect.width, 320) // Minimln 320px\n      });\n    }\n  };\n\n  // Aktualizovat pozici pi oteven nebo scrollu\n  useEffect(() => {\n    if (isOpen) {\n      updateDropdownPosition();\n\n      const handleScroll = () => updateDropdownPosition();\n      const handleResize = () => updateDropdownPosition();\n\n      window.addEventListener('scroll', handleScroll, true);\n      window.addEventListener('resize', handleResize);\n\n      return () => {\n        window.removeEventListener('scroll', handleScroll, true);\n        window.removeEventListener('resize', handleResize);\n      };\n    }\n  }, [isOpen]);\n\n  // Filtrovn monost podle zadanho textu\n  const filteredOptions = React.useMemo(() => {\n    if (!inputValue || loading) return options;\n\n    const searchTerm = inputValue.toLowerCase().trim();\n    return options.filter(option => {\n      const code = (option.code || '').toLowerCase();\n      const name = (option.name || '').toLowerCase();\n      return code.includes(searchTerm) || name.includes(searchTerm);\n    });\n  }, [inputValue, options, loading]);\n\n  // Zaven dropdownu pi kliku mimo\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (wrapperRef.current && !wrapperRef.current.contains(event.target)) {\n        setIsOpen(false);\n        setHighlightedIndex(-1);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const handleInputChange = (e) => {\n    const newValue = e.target.value;\n    setInputValue(newValue);\n    setIsOpen(true);\n    setHighlightedIndex(-1);\n\n    // Propagace zmny nahoru\n    if (onChange) {\n      onChange({ target: { value: newValue } });\n    }\n  };\n\n  const handleInputFocus = () => {\n    if (!disabled && options.length > 0) {\n      setIsOpen(true);\n    }\n  };\n\n  const handleInputBlur = (e) => {\n    // Delay pro umonn kliku na poloku\n    // Poznmka: onMouseDown s preventDefault zajist, e blur se nespust pi kliku\n    setTimeout(() => {\n      setIsOpen(false);\n      setHighlightedIndex(-1);\n\n      if (onBlur) {\n        onBlur(e);\n      }\n    }, 200);\n  };\n\n  const selectOption = (option) => {\n    const newValue = option.code;\n    setInputValue(newValue);\n    setIsOpen(false);\n    setHighlightedIndex(-1);\n\n    // DLEIT: Propagace zmny s novm value PED fokusem\n    if (onChange) {\n      onChange({ target: { value: newValue } });\n    }\n\n    // Focus a po propagaci zmny\n    setTimeout(() => {\n      inputRef.current?.focus();\n    }, 0);\n  };\n\n  const handleKeyDown = (e) => {\n    // Propagace key eventu pro navigaci v tabulce\n    if (onKeyDown && !isOpen) {\n      onKeyDown(e);\n      return;\n    }\n\n    // Navigace v dropdown menu\n    if (isOpen && filteredOptions.length > 0) {\n      switch (e.key) {\n        case 'ArrowDown':\n          e.preventDefault();\n          setHighlightedIndex(prev =>\n            prev < filteredOptions.length - 1 ? prev + 1 : 0\n          );\n          break;\n\n        case 'ArrowUp':\n          e.preventDefault();\n          setHighlightedIndex(prev =>\n            prev > 0 ? prev - 1 : filteredOptions.length - 1\n          );\n          break;\n\n        case 'Enter':\n          if (highlightedIndex >= 0 && highlightedIndex < filteredOptions.length) {\n            e.preventDefault();\n            selectOption(filteredOptions[highlightedIndex]);\n          } else {\n            // Enter bez vbru z dropdown - propaguj event\n            if (onKeyDown) {\n              onKeyDown(e);\n            }\n          }\n          break;\n\n        case 'Escape':\n          e.preventDefault();\n          setIsOpen(false);\n          setHighlightedIndex(-1);\n          break;\n\n        case 'Tab':\n          // Tab zave dropdown a pokrauje v navigaci\n          setIsOpen(false);\n          setHighlightedIndex(-1);\n          if (onKeyDown) {\n            onKeyDown(e);\n          }\n          break;\n\n        default:\n          // Pro ostatn klvesy - propaguj event\n          if (onKeyDown) {\n            onKeyDown(e);\n          }\n      }\n    } else if (onKeyDown) {\n      // Dropdown nen oteven - propaguj vechny eventy\n      onKeyDown(e);\n    }\n  };\n\n  return (\n    <ComboboxWrapper ref={wrapperRef}>\n      <ComboboxInput\n        ref={inputRef}\n        type=\"text\"\n        value={inputValue}\n        onChange={handleInputChange}\n        onFocus={handleInputFocus}\n        onBlur={handleInputBlur}\n        onKeyDown={handleKeyDown}\n        placeholder={loading ? 'Natn...' : placeholder}\n        disabled={disabled || loading}\n        hasError={hasError}\n        autoComplete=\"off\"\n      />\n\n      {isOpen && !disabled && !loading && ReactDOM.createPortal(\n        <DropdownList\n          style={{\n            top: `${dropdownPosition.top}px`,\n            left: `${dropdownPosition.left}px`,\n            width: `${dropdownPosition.width}px`\n          }}\n        >\n          {filteredOptions.length > 0 ? (\n            filteredOptions.map((option, index) => (\n              <DropdownItem\n                key={option.code}\n                className={`${highlightedIndex === index ? 'highlighted' : ''} ${\n                  inputValue === option.code ? 'selected' : ''\n                }`}\n                onMouseDown={(e) => {\n                  e.preventDefault(); // Zabrn blur eventu\n                  selectOption(option);\n                }}\n                onMouseEnter={() => setHighlightedIndex(index)}\n              >\n                <strong>{option.code}</strong>\n                {option.name && <small>{option.name}</small>}\n              </DropdownItem>\n            ))\n          ) : (\n            <NoResults>\n              {inputValue ? 'dn shoda. Mete zadat vlastn text.' : 'Zante pst pro filtrovn...'}\n            </NoResults>\n          )}\n        </DropdownList>,\n        document.body\n      )}\n    </ComboboxWrapper>\n  );\n};\n\nexport default EditableCombobox;\n","import React from 'react';\nimport { Document, Page, Text, View, StyleSheet, Image } from '@react-pdf/renderer';\nimport '../utils/pdfFonts'; //  Automatick registrace Roboto font\nimport { ASSETS } from '../config/assets';\n\n// Styly pro PDF dokument\nconst styles = StyleSheet.create({\n  // Zkladn nastaven strnky\n  page: {\n    flexDirection: 'column',\n    backgroundColor: '#FFFFFF',\n    padding: 30,\n    paddingBottom: 60, // Vce msta pro patiku\n    fontFamily: 'Roboto',\n    fontSize: 9,\n  },\n\n  // Hlavika dokumentu\n  header: {\n    marginBottom: 20,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    gap: 15,\n  },\n\n  logoContainer: {\n    width: 60,\n    height: 60,\n  },\n\n  logo: {\n    width: '100%',\n    height: '100%',\n    objectFit: 'contain',\n  },\n\n  headerContent: {\n    flex: 1,\n    flexDirection: 'column',\n    justifyContent: 'center',\n  },\n\n  headerOrganization: {\n    fontSize: 16,\n    fontWeight: 600,\n    color: '#374151',\n    marginBottom: 4,\n  },\n\n  headerTitle: {\n    fontSize: 18,\n    fontWeight: 700,\n    color: '#1e40af',\n    marginBottom: 4,\n  },\n\n  headerSubtitle: {\n    fontSize: 10,\n    fontWeight: 400,\n    color: '#6b7280',\n    marginBottom: 2,\n  },\n\n  headerInfo: {\n    fontSize: 9,\n    fontWeight: 400,\n    color: '#6b7280',\n  },\n\n  // Msc a rok vpravo nahoe\n  headerPeriod: {\n    flexDirection: 'column',\n    alignItems: 'flex-end',\n    justifyContent: 'flex-start',\n    alignSelf: 'flex-start',\n  },\n\n  periodMonth: {\n    fontSize: 18,\n    fontWeight: 700,\n    color: '#1e40af',\n    textTransform: 'uppercase',\n  },\n\n  periodYear: {\n    fontSize: 16,\n    fontWeight: 500,\n    color: '#374151',\n  },\n\n  // Souhrn (summary block)\n  summaryBlock: {\n    marginBottom: 15,\n    padding: 10,\n    backgroundColor: '#f8fafc',\n    borderRadius: 4,\n  },\n\n  summaryGrid: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    flexWrap: 'nowrap',\n    gap: 8,\n  },\n\n  summaryItem: {\n    flex: 1,\n    minWidth: 0,\n  },\n\n  summaryLabel: {\n    fontSize: 7,\n    fontWeight: 400,\n    color: '#6b7280',\n    marginBottom: 2,\n  },\n\n  summaryValue: {\n    fontSize: 11,\n    fontWeight: 700,\n  },\n\n  summaryValuePositive: {\n    color: '#10b981',\n  },\n\n  summaryValueNegative: {\n    color: '#ef4444',\n  },\n\n  summaryValueNeutral: {\n    color: '#1e40af',\n  },\n\n  // Vizitka stavu knihy\n  bookStatusCard: {\n    marginBottom: 12,\n    padding: 10,\n    backgroundColor: '#fff7ed',\n    borderRadius: 4,\n    borderLeftWidth: 4,\n    borderLeftColor: '#f59e0b',\n    borderLeftStyle: 'solid',\n  },\n\n  bookStatusCardClosed: {\n    backgroundColor: '#fef3c7',\n    borderLeftColor: '#eab308',\n  },\n\n  bookStatusCardLocked: {\n    backgroundColor: '#fee2e2',\n    borderLeftColor: '#ef4444',\n  },\n\n  bookStatusTitle: {\n    fontSize: 10,\n    fontWeight: 700,\n    color: '#92400e',\n    marginBottom: 4,\n  },\n\n  bookStatusInfo: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    fontSize: 8,\n    color: '#78716c',\n  },\n\n  bookStatusInfoItem: {\n    flexDirection: 'row',\n    gap: 4,\n  },\n\n  bookStatusLabel: {\n    fontWeight: 500,\n  },\n\n  bookStatusValue: {\n    fontWeight: 400,\n    color: '#1c1917',\n  },\n\n  // Tabulka\n  table: {\n    display: 'table',\n    width: 'auto',\n    borderStyle: 'solid',\n    borderWidth: 1,\n    borderColor: '#d1d5db',\n    borderRightWidth: 0,\n    borderBottomWidth: 0,\n  },\n\n  tableRow: {\n    flexDirection: 'row',\n  },\n\n  // Hlavika tabulky\n  tableHeaderRow: {\n    flexDirection: 'row',\n    backgroundColor: '#1e40af',\n  },\n\n  tableHeaderCell: {\n    padding: 6,\n    fontSize: 8,\n    fontWeight: 700,\n    color: '#ffffff',\n    borderStyle: 'solid',\n    borderWidth: 1,\n    borderLeftWidth: 0,\n    borderTopWidth: 0,\n    borderColor: '#d1d5db',\n    textAlign: 'center',\n    verticalAlign: 'middle',\n  },\n\n  // Buky tabulky\n  tableCell: {\n    padding: 5,\n    fontSize: 8,\n    fontWeight: 400,\n    color: '#1f2937',\n    borderStyle: 'solid',\n    borderWidth: 1,\n    borderLeftWidth: 0,\n    borderTopWidth: 0,\n    borderColor: '#d1d5db',\n  },\n\n  tableCellAlternate: {\n    backgroundColor: '#f9fafb',\n  },\n\n  // Specifick ky sloupc\n  colNumber: {\n    width: '4%',\n    textAlign: 'center',\n  },\n\n  colDate: {\n    width: '8%',\n    textAlign: 'center',\n  },\n\n  colDocNumber: {\n    width: '8%',\n    textAlign: 'center',\n  },\n\n  colDescription: {\n    width: '22%',\n    textAlign: 'left',\n  },\n\n  colPerson: {\n    width: '15%',\n    textAlign: 'left',\n  },\n\n  colIncome: {\n    width: '10%',\n    textAlign: 'right',\n    fontWeight: 700,\n    color: '#10b981',\n  },\n\n  colExpense: {\n    width: '10%',\n    textAlign: 'right',\n    fontWeight: 700,\n    color: '#ef4444',\n  },\n\n  colBalance: {\n    width: '11%',\n    textAlign: 'right',\n    fontWeight: 700,\n    color: '#1e40af',\n  },\n\n  colLpCode: {\n    width: '7%',\n    textAlign: 'center',\n  },\n\n  colNote: {\n    width: '15%',\n    textAlign: 'left',\n    fontSize: 7,\n  },\n\n  // Speciln styly pro hlaviky sloupc s sly (vycentrovan)\n  colHeaderIncome: {\n    width: '10%',\n    textAlign: 'center',\n  },\n\n  colHeaderExpense: {\n    width: '10%',\n    textAlign: 'center',\n  },\n\n  colHeaderBalance: {\n    width: '11%',\n    textAlign: 'center',\n  },\n\n  // Patika\n  footer: {\n    position: 'absolute',\n    bottom: 20,\n    left: 30,\n    right: 30,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    fontSize: 8,\n    color: '#6b7280',\n    borderTopWidth: 1,\n    borderTopColor: '#e5e7eb',\n    paddingTop: 10,\n  },\n});\n\n// Komponenta pro formtovn mny\nconst formatCurrency = (amount) => {\n  if (amount === null || amount === undefined || amount === '') {\n    return '';\n  }\n  const num = parseFloat(amount);\n  if (isNaN(num)) {\n    return '';\n  }\n  return new Intl.NumberFormat('cs-CZ', {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(num) + ' K';\n};\n\n// Komponenta pro formtovn data\nconst formatDate = (dateString) => {\n  if (!dateString) return '';\n  try {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('cs-CZ', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric',\n    });\n  } catch (error) {\n    return dateString;\n  }\n};\n\n// Hlavn komponenta PDF dokumentu\nconst PokladniKnihaPDF = ({\n  organizationInfo,\n  carryOverAmount,\n  totals,\n  entries,\n  generatedBy, // Informace o tom, kdo generoval: { fullName, usekZkr, lokalita }\n  bookStatus // Stav knihy: { status: 'aktivni'|'uzavrena_uzivatelem'|'zamknuta_spravcem', closedDate, closedBy, lockedDate, lockedBy }\n}) => {\n  const currentDate = new Date().toLocaleString('cs-CZ', {\n    day: '2-digit',\n    month: '2-digit',\n    year: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n\n  return (\n    <Document>\n      <Page size=\"A4\" orientation=\"landscape\" style={styles.page}>\n        {/* Hlavika s logem */}\n        <View style={styles.header}>\n          {/* Logo vlevo */}\n          <View style={styles.logoContainer}>\n            <Image\n              src={ASSETS.LOGO_ZZS_MAIN}\n              style={styles.logo}\n            />\n          </View>\n\n          {/* Textov obsah hlaviky */}\n          <View style={styles.headerContent}>\n            <Text style={styles.headerOrganization}>\n              {organizationInfo.organizationName || 'Zdravotnick zchrann sluba Stedoeskho kraje, p.o.'}\n            </Text>\n            <Text style={styles.headerTitle}>POKLADN KNIHA</Text>\n            <Text style={styles.headerInfo}>\n              Pracovit: {organizationInfo.workplace || 'Pbram'} | Pokladna . {organizationInfo.cashboxNumber || '600'}\n            </Text>\n          </View>\n\n          {/* Msc a rok vpravo nahoe */}\n          <View style={styles.headerPeriod}>\n            <Text style={styles.periodMonth}>\n              {(organizationInfo.month || 'listopad').toUpperCase()}\n            </Text>\n            <Text style={styles.periodYear}>\n              {organizationInfo.year || '2025'}\n            </Text>\n          </View>\n        </View>\n\n        {/* Vizitka stavu knihy (pouze pokud je uzaven nebo zamen) */}\n        {bookStatus && (bookStatus.status === 'uzavrena_uzivatelem' || bookStatus.status === 'zamknuta_spravcem') && (\n          <View style={[\n            styles.bookStatusCard,\n            bookStatus.status === 'uzavrena_uzivatelem' && styles.bookStatusCardClosed,\n            bookStatus.status === 'zamknuta_spravcem' && styles.bookStatusCardLocked,\n          ]}>\n            {/* dek 1: Titulek */}\n            <Text style={styles.bookStatusTitle}>\n              {bookStatus.status === 'uzavrena_uzivatelem' ? ' KNIHA UZAVENA' : ' KNIHA ZAMENA'}\n            </Text>\n\n            {/* dek 2: Informace v jednom dku */}\n            <View style={styles.bookStatusInfo}>\n              {bookStatus.status === 'uzavrena_uzivatelem' && (\n                <>\n                  {bookStatus.closedDate && (\n                    <View style={styles.bookStatusInfoItem}>\n                      <Text style={styles.bookStatusLabel}>Uzaveno dne:</Text>\n                      <Text style={styles.bookStatusValue}>{formatDate(bookStatus.closedDate)}</Text>\n                    </View>\n                  )}\n                  {bookStatus.closedBy && (\n                    <View style={styles.bookStatusInfoItem}>\n                      <Text style={styles.bookStatusLabel}>Uzavel:</Text>\n                      <Text style={styles.bookStatusValue}>{bookStatus.closedBy}</Text>\n                    </View>\n                  )}\n                </>\n              )}\n\n              {bookStatus.status === 'zamknuta_spravcem' && (\n                <>\n                  {bookStatus.lockedDate && (\n                    <View style={styles.bookStatusInfoItem}>\n                      <Text style={styles.bookStatusLabel}>Zameno dne:</Text>\n                      <Text style={styles.bookStatusValue}>{formatDate(bookStatus.lockedDate)}</Text>\n                    </View>\n                  )}\n                  {bookStatus.lockedBy && (\n                    <View style={styles.bookStatusInfoItem}>\n                      <Text style={styles.bookStatusLabel}>Zamkl:</Text>\n                      <Text style={styles.bookStatusValue}>{bookStatus.lockedBy}</Text>\n                    </View>\n                  )}\n                </>\n              )}\n            </View>\n          </View>\n        )}\n\n        {/* Souhrn */}\n        <View style={styles.summaryBlock}>\n          <View style={styles.summaryGrid}>\n            <View style={styles.summaryItem}>\n              <Text style={styles.summaryLabel}>\n                Pevod z pedchozho msce:\n              </Text>\n              <Text style={[styles.summaryValue, styles.summaryValueNeutral]}>\n                {formatCurrency(carryOverAmount)}\n              </Text>\n            </View>\n\n            <View style={styles.summaryItem}>\n              <Text style={styles.summaryLabel}>\n                Celkov pjmy:\n              </Text>\n              <Text style={[styles.summaryValue, styles.summaryValuePositive]}>\n                {formatCurrency(totals.totalIncome)}\n              </Text>\n            </View>\n\n            <View style={styles.summaryItem}>\n              <Text style={styles.summaryLabel}>\n                Celkov vdaje:\n              </Text>\n              <Text style={[styles.summaryValue, styles.summaryValueNegative]}>\n                {formatCurrency(totals.totalExpenses)}\n              </Text>\n            </View>\n\n            <View style={styles.summaryItem}>\n              <Text style={styles.summaryLabel}>\n                Aktuln zstatek:\n              </Text>\n              <Text style={[\n                styles.summaryValue,\n                totals.currentBalance >= 0\n                  ? styles.summaryValuePositive\n                  : styles.summaryValueNegative\n              ]}>\n                {formatCurrency(totals.currentBalance)}\n              </Text>\n            </View>\n          </View>\n        </View>\n\n        {/* Tabulka */}\n        <View style={styles.table}>\n          {/* Hlavika tabulky */}\n          <View style={styles.tableHeaderRow}>\n            <Text style={[styles.tableHeaderCell, styles.colNumber]}>#</Text>\n            <Text style={[styles.tableHeaderCell, styles.colDate]}>Datum</Text>\n            <Text style={[styles.tableHeaderCell, styles.colDocNumber]}>Doklad .</Text>\n            <Text style={[styles.tableHeaderCell, styles.colDescription]}>Obsah zpisu</Text>\n            <Text style={[styles.tableHeaderCell, styles.colPerson]}>Komu/Od koho</Text>\n            <Text style={[styles.tableHeaderCell, styles.colHeaderIncome]}>Pjmy (K)</Text>\n            <Text style={[styles.tableHeaderCell, styles.colHeaderExpense]}>Vdaje (K)</Text>\n            <Text style={[styles.tableHeaderCell, styles.colHeaderBalance]}>Zstatek (K)</Text>\n            <Text style={[styles.tableHeaderCell, styles.colLpCode]}>LP kd</Text>\n            <Text style={[styles.tableHeaderCell, styles.colNote]}>Poznmka</Text>\n          </View>\n\n          {/* dky tabulky */}\n          {entries.map((entry, index) => (\n            <View\n              key={entry.id || index}\n              style={[\n                styles.tableRow,\n                index % 2 === 1 && styles.tableCellAlternate\n              ]}\n            >\n              <Text style={[styles.tableCell, styles.colNumber]}>\n                {index + 1}\n              </Text>\n              <Text style={[styles.tableCell, styles.colDate]}>\n                {formatDate(entry.date)}\n              </Text>\n              <Text style={[styles.tableCell, styles.colDocNumber]}>\n                {entry.documentNumber || ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colDescription]}>\n                {entry.description || ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colPerson]}>\n                {entry.person || ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colIncome]}>\n                {entry.income ? formatCurrency(entry.income) : ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colExpense]}>\n                {entry.expense ? formatCurrency(entry.expense) : ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colBalance]}>\n                {formatCurrency(entry.balance)}\n              </Text>\n              <Text style={[styles.tableCell, styles.colLpCode]}>\n                {entry.lpCode || ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colNote]}>\n                {entry.note || ''}\n              </Text>\n            </View>\n          ))}\n        </View>\n\n        {/* Patika */}\n        <View style={styles.footer} fixed>\n          <Text>\n            {generatedBy?.fullName || ''} | {generatedBy?.usekZkr || ''} | {generatedBy?.lokalita || organizationInfo.workplace || ''}\n          </Text>\n          <Text\n            render={({ pageNumber, totalPages }) =>\n              `Strana ${pageNumber} z ${totalPages}`\n            }\n          />\n          <Text>Vygenerovno: {currentDate}</Text>\n        </View>\n      </Page>\n    </Document>\n  );\n};\n\nexport default PokladniKnihaPDF;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './BookStatusBadge.css';\n\n/**\n * BookStatusBadge - komponenta pro zobrazen stavu pokladn knihy\n *\n * Stavy:\n * - aktivni: Zelen - kniha je oteven pro editaci\n * - uzavrena_uzivatelem: lut - uzaven uivatelem, me odemknout admin\n * - zamknuta_spravcem: erven - zamen sprvcem, nelze editovat\n */\nconst BookStatusBadge = ({ status }) => {\n  const getStatusConfig = () => {\n    switch (status) {\n      case 'aktivni':\n        return {\n          label: 'Aktivn',\n          className: 'status-badge status-active',\n          icon: '',\n          description: 'Kniha je oteven pro zpis'\n        };\n      case 'uzavrena_uzivatelem':\n        return {\n          label: 'Uzavena uivatelem',\n          className: 'status-badge status-closed',\n          icon: '',\n          description: 'Msc uzaven, lze odemknout sprvcem'\n        };\n      case 'zamknuta_spravcem':\n        return {\n          label: 'Zamena sprvcem',\n          className: 'status-badge status-locked',\n          icon: '',\n          description: 'Zameno sprvcem, nelze editovat'\n        };\n      default:\n        return {\n          label: 'Neznm stav',\n          className: 'status-badge status-unknown',\n          icon: '?',\n          description: status || 'Stav nen definovn'\n        };\n    }\n  };\n\n  const config = getStatusConfig();\n\n  return (\n    <div className={config.className} title={config.description}>\n      <span className=\"status-icon\">{config.icon}</span>\n      <span className=\"status-label\">{config.label}</span>\n    </div>\n  );\n};\n\nBookStatusBadge.propTypes = {\n  status: PropTypes.oneOf(['aktivni', 'uzavrena_uzivatelem', 'zamknuta_spravcem']).isRequired\n};\n\nexport default BookStatusBadge;\n","/**\n *  Vbr pokladny s vyhledvnm\n */\n\nimport React, { useMemo, useState, useRef, useEffect } from 'react';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCalculator, faCheckCircle, faSearch, faChevronDown } from '@fortawesome/free-solid-svg-icons';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem;\n  background: #f8f9fa;\n  border-radius: 8px;\n  border: 1px solid #dee2e6;\n`;\n\nconst Row = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n`;\n\nconst PeriodSelect = styled.select`\n  padding: 0.5rem;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  font-size: 1rem;\n  background: white;\n  cursor: pointer;\n\n  &:focus {\n    outline: none;\n    border-color: #007bff;\n  }\n`;\n\nconst Label = styled.label`\n  font-weight: 600;\n  color: #495057;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst SelectWrapper = styled.div`\n  position: relative;\n  flex: 1;\n  min-width: 300px;\n`;\n\nconst SelectButton = styled.button`\n  width: 100%;\n  padding: 0.5rem 2.5rem 0.5rem 1rem;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  font-size: 1rem;\n  background: white;\n  cursor: pointer;\n  text-align: left;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n\n  &:hover {\n    border-color: #007bff;\n  }\n\n  &:focus {\n    outline: none;\n    border-color: #007bff;\n    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);\n  }\n`;\n\nconst DropdownIcon = styled.span`\n  position: absolute;\n  right: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  pointer-events: none;\n  color: #6c757d;\n`;\n\nconst Dropdown = styled.div`\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  margin-top: 0.25rem;\n  background: white;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  max-height: 300px;\n  overflow-y: auto;\n  z-index: 1000;\n`;\n\nconst SearchWrapper = styled.div`\n  position: relative;\n  border-bottom: 1px solid #dee2e6;\n\n  &:focus-within .search-icon {\n    color: #007bff;\n  }\n`;\n\nconst SearchIcon = styled.span`\n  position: absolute;\n  left: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #6c757d;\n`;\n\nconst SearchInput = styled.input`\n  width: 100%;\n  padding: 0.75rem 0.75rem 0.75rem 2.5rem;\n  border: none;\n  font-size: 1rem;\n\n  &:focus {\n    outline: none;\n  }\n`;\n\nconst OptionsList = styled.div`\n  max-height: 240px;\n  overflow-y: auto;\n`;\n\nconst Option = styled.div`\n  padding: 0.75rem 1rem;\n  cursor: pointer;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n\n  &:hover {\n    background: #f8f9fa;\n  }\n\n  ${props => props.$selected && `\n    background: #e7f3ff;\n    font-weight: 600;\n  `}\n`;\n\nconst OptionLabel = styled.span`\n  flex: 1;\n`;\n\nconst OptionDetails = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n`;\n\nconst OptionTitle = styled.div`\n  font-weight: 500;\n`;\n\nconst OptionSubtitle = styled.div`\n  font-size: 0.875rem;\n  color: #6c757d;\n`;\n\nconst OptionBadge = styled.span`\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  background: #007bff;\n  color: white;\n  border-radius: 3px;\n  white-space: nowrap;\n`;\n\nconst StatusBadge = styled.span`\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  border-radius: 3px;\n  white-space: nowrap;\n  font-weight: 600;\n\n  ${props => {\n    if (props.$status === 'aktivni') {\n      return `\n        background: #28a745;\n        color: white;\n      `;\n    } else if (props.$status === 'uzavrena_uzivatelem') {\n      return `\n        background: #ffc107;\n        color: #212529;\n      `;\n    } else if (props.$status === 'zamknuta_spravcem') {\n      return `\n        background: #dc3545;\n        color: white;\n      `;\n    }\n    return `\n      background: #6c757d;\n      color: white;\n    `;\n  }}\n`;\n\nconst Info = styled.div`\n  font-size: 0.875rem;\n  color: #6c757d;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst CashboxSelector = ({\n  currentCashbox,\n  userCashboxes = [],\n  allCashboxes = [],\n  permissions = {},\n  canSeeAllCashboxes = false,\n  onCashboxChange,\n  currentYear,\n  currentMonth,\n  onPeriodChange,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const dropdownRef = useRef(null);\n  const searchInputRef = useRef(null);\n\n  // Zavt dropdown pi kliknut mimo\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(e.target)) {\n        setIsOpen(false);\n        setSearchQuery('');\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Focus na search input pi oteven\n  useEffect(() => {\n    if (isOpen && searchInputRef.current) {\n      searchInputRef.current.focus();\n    }\n  }, [isOpen]);\n\n  const canReadAll = permissions.canReadAll || permissions.canManage;\n\n  //  Stabiln detekce vlastnictv aktuln pokladny pomoc ID\n  const isCurrentCashboxOwned = useMemo(() => {\n    if (!currentCashbox) return false;\n    return userCashboxes.some(uc =>\n      String(uc.id) === String(currentCashbox.id) ||\n      (uc.cislo_pokladny && String(uc.cislo_pokladny) === String(currentCashbox.cislo_pokladny))\n    );\n  }, [currentCashbox, userCashboxes]);\n\n  const availableCashboxes = useMemo(() => {\n    let boxes = [];\n    if (canReadAll && allCashboxes.length > 0) {\n      //  FIX: Pro adminy - zobrazit JEN hlavn assignments (je_hlavni === 1)\n      // aby se kad pokladna zobrazila jen jednou\n      boxes = allCashboxes.filter(cb => parseInt(cb.je_hlavni, 10) === 1);\n\n      // Pokud dn assignment nem je_hlavni=1, vzt prvn z kad pokladny\n      if (boxes.length === 0) {\n        const seen = new Set();\n        boxes = allCashboxes.filter(cb => {\n          const key = cb.cislo_pokladny || cb.id;\n          if (seen.has(key)) return false;\n          seen.add(key);\n          return true;\n        });\n      }\n    } else {\n      boxes = userCashboxes;\n    }\n    return boxes;\n  }, [canReadAll, allCashboxes, userCashboxes]);\n\n  // Filtrovan pokladny podle hledn\n  const filteredCashboxes = useMemo(() => {\n    if (!searchQuery.trim()) return availableCashboxes;\n\n    const query = searchQuery.toLowerCase();\n    return availableCashboxes.filter(cb => {\n      const number = String(cb.cislo_pokladny || '').toLowerCase();\n      const name = (cb.nazev || cb.nazev_pracoviste || '').toLowerCase();\n      const userName = (cb.uzivatel_cele_jmeno ||\n                       (cb.uzivatel_jmeno && cb.uzivatel_prijmeni\n                         ? `${cb.uzivatel_jmeno} ${cb.uzivatel_prijmeni}`\n                         : '')).toLowerCase();\n      const lokalita = (cb.lokalita_nazev || cb.lokalita_kod || '').toLowerCase();\n      const usek = (cb.usek_nazev || '').toLowerCase();\n      const location = (cb.nazev_pracoviste || cb.kod_pracoviste || '').toLowerCase();\n\n      return number.includes(query) ||\n             name.includes(query) ||\n             userName.includes(query) ||\n             lokalita.includes(query) ||\n             usek.includes(query) ||\n             location.includes(query);\n    });\n  }, [availableCashboxes, searchQuery]);\n\n  const handleSelect = (cashbox) => {\n    if (onCashboxChange) {\n      onCashboxChange(cashbox);\n    }\n    setIsOpen(false);\n    setSearchQuery('');\n  };\n\n  const getCurrentLabel = () => {\n    if (!currentCashbox) return { label: 'Vyberte pokladnu...', isOwn: false };\n\n    const userName = currentCashbox.uzivatel_cele_jmeno ||\n                     (currentCashbox.uzivatel_jmeno && currentCashbox.uzivatel_prijmeni\n                       ? `${currentCashbox.uzivatel_jmeno} ${currentCashbox.uzivatel_prijmeni}`\n                       : null);\n    const lokalita = currentCashbox.lokalita_nazev || currentCashbox.lokalita_kod || null;\n    const usek = currentCashbox.usek_nazev || null;\n    const location = currentCashbox.nazev_pracoviste || currentCashbox.kod_pracoviste || null;\n    const cashboxName = currentCashbox.nazev || currentCashbox.nazev_pracoviste || '';\n\n    // Formt: . XXX - Nzev pokladny (Cel jmno uivatele, Lokalita, sek, Oddlen)\n    let label = '';\n    if (isCurrentCashboxOwned) label += ' '; // Hvzdika pro vlastn pokladny\n    label += `. ${currentCashbox.cislo_pokladny}`;\n    if (cashboxName) label += ` - ${cashboxName}`;\n\n    // Pidat zvorky s info\n    const details = [];\n    if (userName) details.push(userName);\n    if (lokalita) details.push(lokalita);\n    if (usek) details.push(usek);\n    if (location) details.push(location);\n    if (details.length > 0) {\n      label += ` (${details.join(', ')})`;\n    }\n\n    return { label, isOwn: isCurrentCashboxOwned };\n  };\n\n  // Msce pro select\n  const months = [\n    { value: 1, label: 'Leden' },\n    { value: 2, label: 'nor' },\n    { value: 3, label: 'Bezen' },\n    { value: 4, label: 'Duben' },\n    { value: 5, label: 'Kvten' },\n    { value: 6, label: 'erven' },\n    { value: 7, label: 'ervenec' },\n    { value: 8, label: 'Srpen' },\n    { value: 9, label: 'Z' },\n    { value: 10, label: 'jen' },\n    { value: 11, label: 'Listopad' },\n    { value: 12, label: 'Prosinec' }\n  ];\n\n  // Roky - od 2025 (fixn start) do aktulnho roku\n  const now = new Date();\n  const currentYearNow = now.getFullYear();\n  const currentMonthNow = now.getMonth() + 1; // 1-12\n  const MIN_YEAR = 2025; //  Minimln rok - zatek systmu pokladn knihy\n\n  const years = [];\n  for (let y = MIN_YEAR; y <= currentYearNow; y++) {\n    years.push(y);\n  }\n\n  //  Omezit msce kdy je vybran aktuln rok\n  const availableMonths = useMemo(() => {\n    if (currentYear === currentYearNow) {\n      // Aktuln rok - jen msce do te\n      return months.filter(m => m.value <= currentMonthNow);\n    }\n    // Star roky - vechny msce\n    return months;\n  }, [currentYear, currentYearNow, currentMonthNow]);\n\n  if (availableCashboxes.length <= 1 && !onPeriodChange) {\n    return null;\n  }\n\n  return (\n    <Container>\n      {/* dek 1: Vbr msce a roku */}\n      {onPeriodChange && (\n        <Row>\n          <Label>\n             Obdob:\n          </Label>\n          <PeriodSelect\n            value={currentMonth}\n            onChange={(e) => onPeriodChange(currentYear, parseInt(e.target.value))}\n          >\n            {availableMonths.map(m => (\n              <option key={m.value} value={m.value}>{m.label}</option>\n            ))}\n          </PeriodSelect>\n          <PeriodSelect\n            value={currentYear}\n            onChange={(e) => {\n              const newYear = parseInt(e.target.value);\n              //  Pokud je vybran aktuln rok a msc je v budoucnosti, upravit na aktuln msc\n              let newMonth = currentMonth;\n              if (newYear === currentYearNow && currentMonth > currentMonthNow) {\n                newMonth = currentMonthNow;\n              }\n              onPeriodChange(newYear, newMonth);\n            }}\n          >\n            {years.map(y => (\n              <option key={y} value={y}>{y}</option>\n            ))}\n          </PeriodSelect>\n          <span style={{ fontSize: '0.875rem', color: '#6c757d' }}>\n            {availableCashboxes.length} {availableCashboxes.length === 1 ? 'pokladna' :\n             availableCashboxes.length < 5 ? 'pokladny' : 'pokladen'} v tomto obdob\n          </span>\n        </Row>\n      )}\n\n      {/* dek 2: Vbr pokladny */}\n      {availableCashboxes.length > 1 && (\n        <Row>\n          <Label>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladna:\n          </Label>\n\n      <SelectWrapper ref={dropdownRef}>\n        <SelectButton\n          onClick={() => setIsOpen(!isOpen)}\n          type=\"button\"\n        >\n          {(() => {\n            const labelData = getCurrentLabel();\n            return (\n              <span style={{\n                flex: 1,\n                fontWeight: labelData.isOwn ? 'bold' : 'normal',\n                color: labelData.isOwn ? '#007bff' : 'inherit'\n              }}>\n                {labelData.label}\n              </span>\n            );\n          })()}\n          {currentCashbox?.stav_knihy && (\n            <StatusBadge\n              $status={currentCashbox.stav_knihy}\n              style={{ marginLeft: '0.5rem' }}\n            >\n              {currentCashbox.stav_knihy === 'aktivni' && ' Aktivn'}\n              {currentCashbox.stav_knihy === 'uzavrena_uzivatelem' && ' Uzavena'}\n              {currentCashbox.stav_knihy === 'zamknuta_spravcem' && ' Zamknuta'}\n            </StatusBadge>\n          )}\n        </SelectButton>\n\n        <DropdownIcon>\n          <FontAwesomeIcon icon={faChevronDown} />\n        </DropdownIcon>\n\n        {isOpen && (\n          <Dropdown>\n            <SearchWrapper>\n              <SearchInput\n                ref={searchInputRef}\n                type=\"text\"\n                placeholder=\"Hledat podle sla nebo nzvu...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n              />\n              <SearchIcon className=\"search-icon\">\n                <FontAwesomeIcon icon={faSearch} />\n              </SearchIcon>\n            </SearchWrapper>\n\n            <OptionsList>\n              {filteredCashboxes.length === 0 ? (\n                <Option style={{ color: '#6c757d', cursor: 'default' }}>\n                  dn vsledky\n                </Option>\n              ) : (\n                filteredCashboxes.map((cashbox, index) => {\n                  // Sestavit info o uivateli\n                  const userName = cashbox.uzivatel_cele_jmeno ||\n                                   (cashbox.uzivatel_jmeno && cashbox.uzivatel_prijmeni\n                                     ? `${cashbox.uzivatel_jmeno} ${cashbox.uzivatel_prijmeni}`\n                                     : null);\n                  const lokalita = cashbox.lokalita_nazev || cashbox.lokalita_kod || null;\n                  const usek = cashbox.usek_nazev || null;\n                  const location = cashbox.nazev_pracoviste || cashbox.kod_pracoviste || null;\n\n                  //  Zkontrolovat, jestli je to pokladna pihlenho uivatele\n                  // Zvrazn se pouze pokladny, kde je uivatel vlastnkem (v userCashboxes)\n                  // Porovnvme jak podle ID, tak podle sla pokladny pro jistotu\n                  const isMyOwnCashbox = userCashboxes.some(uc =>\n                    String(uc.id) === String(cashbox.id) ||\n                    (uc.cislo_pokladny && String(uc.cislo_pokladny) === String(cashbox.cislo_pokladny))\n                  );\n\n                  // Stav knihy\n                  const bookStatus = cashbox.stav_knihy || 'aktivni';\n                  const statusLabels = {\n                    'aktivni': ' Aktivn',\n                    'uzavrena_uzivatelem': ' Uzavena',\n                    'zamknuta_spravcem': ' Zamknuta'\n                  };\n\n                  return (\n                    <Option\n                      key={`${cashbox.id}-${cashbox.cislo_pokladny}-${index}`}\n                      onClick={() => handleSelect(cashbox)}\n                      $selected={currentCashbox?.id === cashbox.id}\n                    >\n                      <OptionLabel>\n                        <OptionDetails>\n                          <OptionTitle style={{\n                            fontWeight: isMyOwnCashbox ? 'bold' : 'normal',\n                            color: isMyOwnCashbox ? '#007bff' : 'inherit'\n                          }}>\n                            {isMyOwnCashbox && ' '}. {cashbox.cislo_pokladny} - {cashbox.nazev || cashbox.nazev_pracoviste || 'Bez nzvu'}\n                          </OptionTitle>\n                          {(userName || lokalita || usek || location) && (\n                            <OptionSubtitle>\n                              {userName && ` ${userName}`}\n                              {userName && (lokalita || usek || location) && '  '}\n                              {lokalita && ` ${lokalita}`}\n                              {lokalita && (usek || location) && '  '}\n                              {usek && ` ${usek}`}\n                              {usek && location && '  '}\n                              {location && ` ${location}`}\n                            </OptionSubtitle>\n                          )}\n                        </OptionDetails>\n                      </OptionLabel>\n                      <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n                        <StatusBadge $status={bookStatus}>\n                          {statusLabels[bookStatus] || bookStatus}\n                        </StatusBadge>\n                        {currentCashbox?.id === cashbox.id && (\n                          <OptionBadge>\n                            <FontAwesomeIcon icon={faCheckCircle} /> Vybrna\n                          </OptionBadge>\n                        )}\n                      </div>\n                    </Option>\n                  );\n                })\n              )}\n            </OptionsList>\n          </Dropdown>\n        )}\n        </SelectWrapper>\n\n        {currentCashbox && (\n          <Info>\n            <FontAwesomeIcon icon={faCheckCircle} />\n            {' '}{parseInt(currentCashbox.je_hlavni, 10) === 1\n              ? 'Hlavn pokladnk'\n              : 'Zstupce'}\n          </Info>\n        )}\n      </Row>\n      )}\n    </Container>\n  );\n};\n\nexport default CashboxSelector;\n","/**\n *  CASHBOOK PERMISSIONS - Pomocn funkce pro kontrolu oprvnn\n *\n * Definuje oprvnn pro prci s pokladn knihou:\n * - READ (zobrazen)\n * - EDIT (editace)\n * - DELETE (mazn)\n * - EXPORT (export dat)\n * - MANAGE (kompletn sprva vetn zamykn)\n *\n * Kad oprvnn existuje ve dvou variantch:\n * - _OWN - pouze vlastn pokladn kniha\n * - _ALL - vechny pokladn knihy\n *\n * @author FE Team\n * @date 9. listopadu 2025\n */\n\n// =============================================================================\n// KONSTANTY - Kdy oprvnn z databze\n// =============================================================================\n\nexport const PERMISSIONS = {\n  // Zobrazen\n  CASH_BOOK_READ_OWN: 'CASH_BOOK_READ_OWN',\n  CASH_BOOK_READ_ALL: 'CASH_BOOK_READ_ALL',\n\n  // Editace\n  CASH_BOOK_EDIT_OWN: 'CASH_BOOK_EDIT_OWN',\n  CASH_BOOK_EDIT_ALL: 'CASH_BOOK_EDIT_ALL',\n\n  // Mazn\n  CASH_BOOK_DELETE_OWN: 'CASH_BOOK_DELETE_OWN',\n  CASH_BOOK_DELETE_ALL: 'CASH_BOOK_DELETE_ALL',\n\n  // Export\n  CASH_BOOK_EXPORT_OWN: 'CASH_BOOK_EXPORT_OWN',\n  CASH_BOOK_EXPORT_ALL: 'CASH_BOOK_EXPORT_ALL',\n\n  // Kompletn sprva (vetn zamykn/odemykn)\n  CASH_BOOK_MANAGE: 'CASH_BOOK_MANAGE'\n};\n\n// =============================================================================\n// STAVY UZAMEN POKLADN KNIHY\n// =============================================================================\n\nexport const LOCK_STATUS = {\n  OPEN: 'open',           // Oteven - lze editovat\n  CLOSED: 'closed',       // Uzaven uivatelem - me otevt jen on sm nebo MANAGE\n  LOCKED: 'locked'        // Zamknuta administrtorem - me otevt jen MANAGE\n};\n\n// =============================================================================\n// HELPER FUNKCE\n// =============================================================================\n\n/**\n * Zsk vechna cashbook oprvnn z user objektu\n * @param {Object} userDetail - Detail uivatele z AuthContext\n * @returns {Set<string>} Mnoina kd oprvnn\n */\nexport const getUserCashbookPermissions = (userDetail) => {\n  if (!userDetail) {\n    return new Set();\n  }\n\n  const permissions = new Set();\n\n  // 1. Zkusit direct_rights (pole objekt s kod_prava)\n  const directRights = userDetail.direct_rights || userDetail.directRights || [];\n  if (Array.isArray(directRights)) {\n    directRights.forEach(p => {\n      if (p && typeof p === 'object') {\n        const code = p.kod_prava || p.kod_opravneni || p.code || '';\n        if (code.startsWith('CASH_BOOK_')) {\n          permissions.add(code);\n        }\n      }\n    });\n  }\n\n  // 2. Zkusit prava (pole objekt s kod_prava)\n  const prava = userDetail.prava || [];\n  if (Array.isArray(prava)) {\n    prava.forEach(p => {\n      if (p && typeof p === 'object') {\n        const code = p.kod_prava || p.kod_opravneni || p.code || '';\n        if (code.startsWith('CASH_BOOK_')) {\n          permissions.add(code);\n        }\n      }\n    });\n  }\n\n  // 3. Zkusit permissions (pole objekt nebo string)\n  const perms = userDetail.permissions || [];\n  if (Array.isArray(perms)) {\n    perms.forEach(p => {\n      if (typeof p === 'string' && p.startsWith('CASH_BOOK_')) {\n        permissions.add(p);\n      } else if (p && typeof p === 'object') {\n        const code = p.kod_prava || p.kod_opravneni || p.code || '';\n        if (code.startsWith('CASH_BOOK_')) {\n          permissions.add(code);\n        }\n      }\n    });\n  }\n\n  // 4. Zkusit roles -> prava\n  const roles = userDetail.roles || [];\n  if (Array.isArray(roles)) {\n    roles.forEach(role => {\n      if (role && typeof role === 'object') {\n        const rolePrava = role.prava || role.rights || role.permissions || [];\n        if (Array.isArray(rolePrava)) {\n          rolePrava.forEach(p => {\n            if (p && typeof p === 'object') {\n              const code = p.kod_prava || p.kod_opravneni || p.code || '';\n              if (code.startsWith('CASH_BOOK_')) {\n                permissions.add(code);\n              }\n            } else if (typeof p === 'string' && p.startsWith('CASH_BOOK_')) {\n              permissions.add(p);\n            }\n          });\n        }\n      }\n    });\n  }\n\n  return permissions;\n};\n\n/**\n * Kontrola, zda m uivatel konkrtn oprvnn\n * @param {Object} userDetail - Detail uivatele\n * @param {string} permission - Kd oprvnn\n * @returns {boolean}\n */\nexport const hasPermission = (userDetail, permission) => {\n  const permissions = getUserCashbookPermissions(userDetail);\n  return permissions.has(permission);\n};\n\n/**\n * Zsk objekt vech cashbook oprvnn pro snadn pouit\n * @param {Object} userDetail - Detail uivatele z AuthContext\n * @returns {Object} Objekt s boolean hodnotami pro kad oprvnn\n */\nexport const getCashbookPermissionsObject = (userDetail) => {\n  const permissions = getUserCashbookPermissions(userDetail);\n\n  return {\n    // Zobrazen\n    canReadOwn: permissions.has(PERMISSIONS.CASH_BOOK_READ_OWN),\n    canReadAll: permissions.has(PERMISSIONS.CASH_BOOK_READ_ALL) ||\n                permissions.has(PERMISSIONS.CASH_BOOK_MANAGE),\n\n    // Editace\n    canEditOwn: permissions.has(PERMISSIONS.CASH_BOOK_EDIT_OWN),\n    canEditAll: permissions.has(PERMISSIONS.CASH_BOOK_EDIT_ALL) ||\n                permissions.has(PERMISSIONS.CASH_BOOK_MANAGE),\n\n    // Mazn\n    canDeleteOwn: permissions.has(PERMISSIONS.CASH_BOOK_DELETE_OWN),\n    canDeleteAll: permissions.has(PERMISSIONS.CASH_BOOK_DELETE_ALL) ||\n                  permissions.has(PERMISSIONS.CASH_BOOK_MANAGE),\n\n    // Export\n    canExportOwn: permissions.has(PERMISSIONS.CASH_BOOK_EXPORT_OWN),\n    canExportAll: permissions.has(PERMISSIONS.CASH_BOOK_EXPORT_ALL) ||\n                  permissions.has(PERMISSIONS.CASH_BOOK_MANAGE),\n\n    // Kompletn sprva\n    canManage: permissions.has(PERMISSIONS.CASH_BOOK_MANAGE)\n  };\n};\n\n/**\n * Kontrola, zda me uivatel editovat konkrtn pokladn knihu\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @param {string} cashbook.stav_uzamceni - Stav uzamen (open/closed/locked)\n * @param {number} cashbook.uzivatel_id - ID vlastnka pokladn knihy\n * @returns {Object} { canEdit: boolean, reason: string }\n */\nexport const canEditCashbook = (userDetail, cashbook) => {\n  const perms = getCashbookPermissionsObject(userDetail);\n\n  // 1. Kontrola uzamen\n  if (cashbook.stav_uzamceni === LOCK_STATUS.LOCKED) {\n    // Zamknuto - me otevt jen MANAGE\n    if (!perms.canManage) {\n      return {\n        canEdit: false,\n        reason: 'Pokladn kniha je zamknuta. Me ji odemknout jen sprvce.'\n      };\n    }\n  } else if (cashbook.stav_uzamceni === LOCK_STATUS.CLOSED) {\n    // Uzaveno uivatelem\n    const isOwner = cashbook.uzivatel_id === userDetail.id;\n    if (!isOwner && !perms.canManage) {\n      return {\n        canEdit: false,\n        reason: 'Pokladn kniha je uzavena. Me ji otevt jen vlastnk nebo sprvce.'\n      };\n    }\n  }\n\n  // 2. Kontrola edit oprvnn\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n\n  if (perms.canEditAll) {\n    return { canEdit: true, reason: 'Mte oprvnn editovat vechny pokladn knihy' };\n  }\n\n  if (perms.canEditOwn && isOwner) {\n    return { canEdit: true, reason: 'Mete editovat vlastn pokladn knihu' };\n  }\n\n  return {\n    canEdit: false,\n    reason: 'Nemte oprvnn k editaci tto pokladn knihy'\n  };\n};\n\n/**\n * Kontrola, zda me uivatel zobrazit pokladn knihu\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @returns {boolean}\n */\nexport const canViewCashbook = (userDetail, cashbook) => {\n  const perms = getCashbookPermissionsObject(userDetail);\n\n  if (perms.canReadAll) {\n    return true;\n  }\n\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n  return perms.canReadOwn && isOwner;\n};\n\n/**\n * Kontrola, zda me uivatel smazat poloku v pokladn knize\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @returns {Object} { canDelete: boolean, reason: string }\n */\nexport const canDeleteFromCashbook = (userDetail, cashbook) => {\n  // Nejdv zkontrolovat, zda me editovat (zahrnuje kontrolu uzamen)\n  const editCheck = canEditCashbook(userDetail, cashbook);\n  if (!editCheck.canEdit) {\n    return { canDelete: false, reason: editCheck.reason };\n  }\n\n  const perms = getCashbookPermissionsObject(userDetail);\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n\n  if (perms.canDeleteAll) {\n    return { canDelete: true, reason: 'Mte oprvnn mazat ze vech pokladnch knih' };\n  }\n\n  if (perms.canDeleteOwn && isOwner) {\n    return { canDelete: true, reason: 'Mete mazat z vlastn pokladn knihy' };\n  }\n\n  return {\n    canDelete: false,\n    reason: 'Nemte oprvnn k mazn z tto pokladn knihy'\n  };\n};\n\n/**\n * Kontrola, zda me uivatel exportovat pokladn knihu\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @returns {boolean}\n */\nexport const canExportCashbook = (userDetail, cashbook) => {\n  const perms = getCashbookPermissionsObject(userDetail);\n\n  if (perms.canExportAll) {\n    return true;\n  }\n\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n  return perms.canExportOwn && isOwner;\n};\n\n/**\n * Kontrola, zda me uivatel zmnit stav uzamen\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @param {string} targetStatus - Clov stav (open/closed/locked)\n * @returns {Object} { canChange: boolean, reason: string }\n */\nexport const canChangeLockStatus = (userDetail, cashbook, targetStatus) => {\n  const perms = getCashbookPermissionsObject(userDetail);\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n  const currentStatus = cashbook.stav_uzamceni || LOCK_STATUS.OPEN;\n\n  // MANAGE me dlat cokoli\n  if (perms.canManage) {\n    return { canChange: true, reason: 'Mte kompletn sprvu pokladnch knih' };\n  }\n\n  // Uivatel me UZAVT svou vlastn knihu\n  if (targetStatus === LOCK_STATUS.CLOSED && isOwner && currentStatus === LOCK_STATUS.OPEN) {\n    return { canChange: true, reason: 'Mete uzavt vlastn pokladn knihu' };\n  }\n\n  // Uivatel me OTEVT svou vlastn UZAVENOU knihu\n  if (targetStatus === LOCK_STATUS.OPEN && isOwner && currentStatus === LOCK_STATUS.CLOSED) {\n    return { canChange: true, reason: 'Mete otevt vlastn uzavenou knihu' };\n  }\n\n  // ZAMKNOUT me jen MANAGE\n  if (targetStatus === LOCK_STATUS.LOCKED) {\n    return {\n      canChange: false,\n      reason: 'Zamknout pokladn knihu me jen sprvce s oprvnnm CASH_BOOK_MANAGE'\n    };\n  }\n\n  // ODEMKNOUT LOCKED me jen MANAGE\n  if (currentStatus === LOCK_STATUS.LOCKED) {\n    return {\n      canChange: false,\n      reason: 'Odemknout zamknutou knihu me jen sprvce s oprvnnm CASH_BOOK_MANAGE'\n    };\n  }\n\n  return {\n    canChange: false,\n    reason: 'Nemte oprvnn ke zmn stavu tto pokladn knihy'\n  };\n};\n\n/**\n * Zsk lidsky iteln popis stavu uzamen\n * @param {string} status - Stav uzamen\n * @returns {Object} { label: string, icon: string, color: string }\n */\nexport const getLockStatusInfo = (status) => {\n  switch (status) {\n    case LOCK_STATUS.OPEN:\n      return {\n        label: 'Oteven',\n        icon: '',\n        color: 'success',\n        description: 'Lze editovat'\n      };\n    case LOCK_STATUS.CLOSED:\n      return {\n        label: 'Uzaven',\n        icon: '',\n        color: 'warning',\n        description: 'Uzavena uivatelem - me otevt vlastnk nebo sprvce'\n      };\n    case LOCK_STATUS.LOCKED:\n      return {\n        label: 'Zamknuta',\n        icon: '',\n        color: 'error',\n        description: 'Zamknuta sprvcem - me otevt jen sprvce'\n      };\n    default:\n      return {\n        label: 'Neznm stav',\n        icon: '',\n        color: 'default',\n        description: 'Neznm stav uzamen'\n      };\n  }\n};\n\n// =============================================================================\n// EXPORT DEFAULT\n// =============================================================================\n\nexport default {\n  PERMISSIONS,\n  LOCK_STATUS,\n  getUserCashbookPermissions,\n  hasPermission,\n  getCashbookPermissionsObject,\n  canEditCashbook,\n  canViewCashbook,\n  canDeleteFromCashbook,\n  canExportCashbook,\n  canChangeLockStatus,\n  getLockStatusInfo\n};\n","import React, { useState, useContext, useEffect, useRef, useCallback, useMemo } from 'react';\nimport ReactDOM from 'react-dom';\nimport styled from '@emotion/styled';\nimport { keyframes } from '@emotion/react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faCalculator,\n  faPlus,\n  faTrash,\n  faEdit,\n  faPrint,\n  faFileExport,\n  faCheck,\n  faInfoCircle,\n  faChevronLeft,\n  faChevronRight,\n  faCalendarDay,\n  faLock,\n  faLockOpen,\n  faExclamationTriangle\n} from '@fortawesome/free-solid-svg-icons';\nimport { AuthContext } from '../context/AuthContext';\nimport { ToastContext } from '../context/ToastContext';\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport DatePicker from '../components/DatePicker';\nimport ConfirmDialog from '../components/ConfirmDialog';\nimport EditableCombobox from '../components/EditableCombobox';\nimport ModernHelper from '../components/ModernHelper';\nimport { fetchLimitovanePrisliby } from '../services/api2auth';\nimport { pdf } from '@react-pdf/renderer';\nimport PokladniKnihaPDF from '../components/PokladniKnihaPDF';\nimport { Global, css } from '@emotion/react';\nimport cashbookAPI from '../services/cashbookService';\nimport BookStatusBadge from '../components/cashbook/BookStatusBadge';\nimport CashboxSelector from '../components/CashboxSelector';\nimport { getCashbookPermissionsObject } from '../utils/cashbookPermissions';\n\n// =============================================================================\n// PRINT STYLES - Pro ist tisk pouze tabulky\n// =============================================================================\n\nconst printStyles = css`\n  @media print {\n    /* Skrt ve krom tabulky pi tisku */\n    body * {\n      visibility: hidden;\n    }\n\n    /* Zobrazit pouze obsah pokladn knihy */\n    .cashbook-print-area,\n    .cashbook-print-area * {\n      visibility: visible;\n    }\n\n    /* Odstranit padding/margin z body */\n    body {\n      margin: 0;\n      padding: 0;\n      background: white;\n    }\n\n    /* Tabulka na celou ku */\n    .cashbook-print-area {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      padding: 2rem;\n    }\n\n    /* Zobrazit hlaviku jen pi tisku */\n    .print-header {\n      display: block !important;\n    }\n\n    /* Skrt akn tlatka, navigaci atd. */\n    button,\n    .no-print {\n      display: none !important;\n    }\n\n    /* Optimalizace tabulky pro tisk */\n    table {\n      page-break-inside: auto;\n      border-collapse: collapse;\n      width: 100%;\n      font-size: 0.8rem;\n    }\n\n    tr {\n      page-break-inside: avoid;\n      page-break-after: auto;\n    }\n\n    thead {\n      display: table-header-group;\n    }\n\n    tfoot {\n      display: table-footer-group;\n    }\n\n    /* Men padding pro tisk */\n    td, th {\n      padding: 0.25rem 0.5rem !important;\n    }\n  }\n`;\n\n// =============================================================================\n// ANIMATIONS\n// =============================================================================\n\nconst fadeIn = keyframes`\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n`;\n\nconst slideIn = keyframes`\n  from {\n    opacity: 0;\n    transform: translateX(-20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n`;\n\nconst highlightPulse = keyframes`\n  0%, 100% {\n    background-color: #fff;\n  }\n  50% {\n    background-color: #dbeafe;\n  }\n`;\n\n// =============================================================================\n// STYLED COMPONENTS\n// =============================================================================\n\nconst PageContainer = styled.div`\n  min-height: 100vh;\n  padding: 2rem;\n  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n  animation: ${fadeIn} 0.6s ease-out;\n\n  @media (max-width: 768px) {\n    padding: 1rem;\n  }\n`;\n\nconst Header = styled.div`\n  background: linear-gradient(135deg, #1e40af, #3b82f6);\n  color: white;\n  padding: 2rem;\n  border-radius: 16px;\n  box-shadow: 0 8px 32px rgba(30, 64, 175, 0.3);\n  margin-bottom: 2rem;\n  animation: ${slideIn} 0.8s ease-out;\n\n  h1 {\n    font-size: 2.5rem;\n    font-weight: 700;\n    margin: 0 0 0.5rem 0;\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n  }\n\n  .subtitle {\n    font-size: 1.1rem;\n    opacity: 0.9;\n    margin: 0;\n  }\n\n  @media (max-width: 768px) {\n    padding: 1.5rem;\n    h1 {\n      font-size: 2rem;\n    }\n  }\n`;\n\nconst ActionBar = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n  padding: 1rem;\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  animation: ${slideIn} 0.6s ease-out 0.2s both;\n\n  @media (max-width: 768px) {\n    flex-direction: column;\n    gap: 1rem;\n  }\n`;\n\nconst ActionGroup = styled.div`\n  display: flex;\n  gap: 0.75rem;\n  align-items: center;\n`;\n\nconst ActionButton = styled.button`\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 0.75rem;\n  border: 2px solid ${props => {\n    switch (props.variant) {\n      case 'primary': return '#10b981';\n      case 'danger': return '#ef4444';\n      case 'warning': return '#f59e0b';\n      default: return '#3b82f6';\n    }\n  }};\n  border-radius: 8px;\n  background: ${props => {\n    if (props.$filled) {\n      switch (props.variant) {\n        case 'primary': return '#10b981';\n        case 'danger': return '#ef4444';\n        case 'warning': return '#f59e0b';\n        default: return '#3b82f6';\n      }\n    }\n    return 'white';\n  }};\n  color: ${props => {\n    if (props.$filled) return 'white';\n    switch (props.variant) {\n      case 'primary': return '#10b981';\n      case 'danger': return '#ef4444';\n      case 'warning': return '#f59e0b';\n      default: return '#3b82f6';\n    }\n  }};\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: ${props => {\n      if (props.$filled) {\n        switch (props.variant) {\n          case 'primary': return '#059669';\n          case 'danger': return '#dc2626';\n          case 'warning': return '#d97706';\n          default: return '#2563eb';\n        }\n      }\n      switch (props.variant) {\n        case 'primary': return '#d1fae5';\n        case 'danger': return '#fee2e2';\n        case 'warning': return '#fef3c7';\n        default: return '#eff6ff';\n      }\n    }};\n    border-color: ${props => {\n      switch (props.variant) {\n        case 'primary': return '#059669';\n        case 'danger': return '#dc2626';\n        case 'warning': return '#d97706';\n        default: return '#2563eb';\n      }\n    }};\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px ${props => {\n      switch (props.variant) {\n        case 'primary': return 'rgba(16, 185, 129, 0.25)';\n        case 'danger': return 'rgba(239, 68, 68, 0.25)';\n        case 'warning': return 'rgba(245, 158, 11, 0.25)';\n        default: return 'rgba(59, 130, 246, 0.25)';\n      }\n    }};\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none;\n    box-shadow: none;\n  }\n`;\n\nconst MonthNavigation = styled.div`\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);\n  color: white;\n  animation: ${slideIn} 0.6s ease-out 0.2s both;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 2rem;\n`;\n\nconst MonthInfo = styled.div`\n  flex: 1;\n\n  h2 {\n    margin: 0 0 0.5rem 0;\n    font-size: 1.5rem;\n    font-weight: 700;\n    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n  }\n\n  .carry-over {\n    font-size: 0.95rem;\n    opacity: 0.95;\n    margin: 0.25rem 0 0 0;\n\n    .amount {\n      font-weight: 600;\n      font-size: 1.1rem;\n      margin-left: 0.5rem;\n    }\n  }\n`;\n\nconst MonthControls = styled.div`\n  display: flex;\n  gap: 0.75rem;\n  align-items: center;\n`;\n\nconst MonthButton = styled.button`\n  background: rgba(255, 255, 255, 0.2);\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  color: white;\n  padding: 0.75rem 1.25rem;\n  border-radius: 8px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.95rem;\n\n  &:hover:not(:disabled) {\n    background: rgba(255, 255, 255, 0.3);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n  }\n\n  &:active:not(:disabled) {\n    transform: translateY(0);\n  }\n\n  &:disabled {\n    opacity: 0.4;\n    cursor: not-allowed;\n  }\n`;\n\nconst LockedBookWarning = styled.div`\n  background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);\n  border: 2px solid #dc2626;\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2);\n  animation: ${slideIn} 0.4s ease-out;\n\n  .warning-header {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    margin-bottom: 1rem;\n\n    .icon {\n      font-size: 2.5rem;\n      color: #dc2626;\n      animation: pulse 2s ease-in-out infinite;\n    }\n\n    h3 {\n      color: #991b1b;\n      margin: 0;\n      font-size: 1.3rem;\n      font-weight: 700;\n    }\n  }\n\n  .warning-content {\n    color: #7f1d1d;\n    line-height: 1.6;\n\n    p {\n      margin: 0.75rem 0;\n    }\n\n    strong {\n      color: #991b1b;\n      font-weight: 600;\n    }\n\n    .contact-info {\n      margin-top: 1rem;\n      padding: 1rem;\n      background: rgba(255, 255, 255, 0.5);\n      border-radius: 8px;\n      border-left: 4px solid #dc2626;\n    }\n  }\n\n  @keyframes pulse {\n    0%, 100% {\n      transform: scale(1);\n    }\n    50% {\n      transform: scale(1.1);\n    }\n  }\n`;\n\nconst PreviousMonthWarning = styled.div`\n  background: linear-gradient(135deg, #fff3cd 0%, #fff8e1 100%);\n  border: 2px solid #ffc107;\n  border-radius: 12px;\n  padding: 1.25rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 3px 10px rgba(255, 193, 7, 0.2);\n  animation: ${slideIn} 0.4s ease-out;\n\n  display: flex;\n  align-items: flex-start;\n  gap: 1rem;\n\n  @media print {\n    display: none;\n  }\n`;\n\nconst WarningIcon = styled.div`\n  font-size: 1.5rem;\n  color: #ff9800;\n  line-height: 1;\n  margin-top: 0.25rem;\n  flex-shrink: 0;\n`;\n\nconst WarningContent = styled.div`\n  flex: 1;\n\n  h4 {\n    margin: 0 0 0.5rem 0;\n    color: #f57c00;\n    font-size: 1rem;\n    font-weight: 600;\n  }\n\n  p {\n    margin: 0.25rem 0;\n    color: #5d4037;\n    font-size: 0.9rem;\n    line-height: 1.5;\n  }\n\n  strong {\n    color: #e65100;\n  }\n\n  .tip {\n    margin-top: 0.5rem;\n    font-size: 0.85rem;\n    color: #666;\n  }\n`;\n\nconst InfoPanel = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  border-left: 4px solid #3b82f6;\n  animation: ${slideIn} 0.6s ease-out 0.3s both;\n\n  .organization-info {\n    margin-bottom: 1rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 1rem;\n    flex-wrap: wrap;\n\n    .info-text {\n      flex: 1;\n      min-width: 300px;\n\n      h3 {\n        color: #1f2937;\n        margin: 0 0 0.5rem 0;\n        font-size: 1.2rem;\n        font-weight: 600;\n      }\n\n      p {\n        color: #6b7280;\n        margin: 0;\n        font-size: 0.95rem;\n      }\n    }\n\n    .info-actions {\n      display: flex;\n      align-items: center;\n      gap: 0.75rem;\n    }\n  }\n\n  .summary-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1rem;\n    margin-top: 1rem;\n  }\n\n  .summary-item {\n    text-align: center;\n\n    .label {\n      font-size: 0.875rem;\n      color: #6b7280;\n      margin-bottom: 0.25rem;\n    }\n\n    .value {\n      font-size: 1.5rem;\n      font-weight: 600;\n      color: #1f2937;\n    }\n\n    &.positive .value {\n      color: #059669;\n    }\n\n    &.negative .value {\n      color: #dc2626;\n    }\n  }\n`;\n\n//  Sticky kompaktn pehled pi scrollovn\nconst StickyCompactSummary = styled.div`\n  position: fixed;\n  top: var(--app-fixed-offset-actual, 130px);\n  left: 0;\n  right: 0;\n  z-index: 40;\n  background: white;\n  border-bottom: 2px solid #3b82f6;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  padding: 0.75rem 2rem;\n\n  /* Plynul pechod */\n  opacity: ${props => props.$visible ? '1' : '0'};\n  transform: translateY(${props => props.$visible ? '0' : '-100%'});\n  transition: opacity 0.3s ease, transform 0.3s ease;\n  pointer-events: ${props => props.$visible ? 'auto' : 'none'};\n\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1rem;\n  flex-wrap: wrap;\n\n  @media (max-width: 768px) {\n    padding: 0.75rem 1rem;\n  }\n\n  @media print {\n    display: none !important;\n  }\n\n  .compact-title {\n    font-weight: 600;\n    color: #1f2937;\n    font-size: 1rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .compact-values {\n    display: flex;\n    gap: 2rem;\n    flex-wrap: wrap;\n  }\n\n  .compact-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n\n    .compact-label {\n      font-size: 0.75rem;\n      color: #6b7280;\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n    }\n\n    .compact-value {\n      font-size: 1.1rem;\n      font-weight: 600;\n      color: #1f2937;\n      margin-top: 0.1rem;\n\n      &.positive {\n        color: #059669;\n      }\n\n      &.negative {\n        color: #dc2626;\n      }\n    }\n  }\n\n  @media print {\n    display: none !important;\n  }\n`;\n\nconst TableContainer = styled.div`\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n  overflow-x: auto;\n  overflow-y: visible;\n  animation: ${fadeIn} 0.8s ease-out 0.4s both;\n`;\n\nconst Table = styled.table`\n  width: 100%;\n  border-collapse: collapse;\n\n  th, td {\n    padding: 0.75rem;\n    text-align: left;\n    border-bottom: 1px solid #e5e7eb;\n  }\n\n  th {\n    background: #f8fafc;\n    color: #374151;\n    font-weight: 600;\n    font-size: 0.875rem;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n    position: sticky;\n    top: 0;\n    z-index: 10;\n    line-height: 1.3;\n    vertical-align: middle;\n  }\n\n  td {\n    color: #1f2937;\n  }\n\n  tbody tr:hover {\n    background: #f9fafb;\n  }\n\n  .row-number {\n    width: 60px;\n    text-align: center;\n    font-weight: 600;\n    color: #6b7280;\n  }\n\n  .date-cell {\n    width: 130px; /* Zeno z 220px - datum se nesm zalamovat */\n    min-width: 130px;\n    padding: 0.5rem;\n    position: relative;\n    overflow: visible;\n    white-space: nowrap; /* Zabrnn zalamovn datumu */\n\n    /* DatePicker m vlastn padding, resetujeme padding buky kdy je uvnit */\n    > div {\n      margin: -0.25rem;\n      position: relative;\n      z-index: 100;\n    }\n  }\n\n  .document-cell {\n    width: 120px;\n    font-family: monospace;\n    font-weight: 500;\n    text-align: left;\n  }\n\n  .description-cell {\n    width: 360px; /* 60% pomr - Obsah */\n    text-align: left;\n  }\n\n  .person-cell {\n    width: 150px; /* Vrceno na pvodn ku */\n    text-align: center;\n\n    /* V td zarovnat vlevo */\n    td& {\n      text-align: left;\n    }\n  }\n\n  .amount-cell {\n    width: 120px;\n    text-align: center;\n    font-family: monospace;\n    font-weight: 500;\n\n    /* V td zarovnat vpravo */\n    td& {\n      text-align: right;\n    }\n  }\n\n  .balance-cell {\n    width: 120px;\n    text-align: center;\n    font-family: monospace;\n    font-weight: 600;\n\n    /* V td zarovnat vpravo a zvraznit */\n    td& {\n      text-align: right;\n      background: #f0f9f4;\n    }\n  }\n\n  .lp-code-cell {\n    width: 180px; /* Rozeno ze 100px - kvli popisu LP kdu */\n    min-width: 180px;\n    font-family: monospace;\n    font-size: 0.875rem;\n    text-align: left;\n  }\n\n  .note-cell {\n    width: 240px; /* 40% pomr - Poznmka */\n    font-size: 0.875rem;\n    color: #6b7280;\n    text-align: left;\n  }\n\n  .actions-cell {\n    width: 80px;\n    text-align: center;\n  }\n\n  .income {\n    color: #059669;\n  }\n\n  .expense {\n    color: #dc2626;\n  }\n`;\n\n// Wrapper pro cenov input s K symbolem\nconst CurrencyInputWrapper = styled.div`\n  position: relative;\n  width: 100%;\n\n  /* K symbol vpravo */\n  &::after {\n    content: 'K';\n    position: absolute;\n    right: 0.75rem;\n    top: 50%;\n    transform: translateY(-50%);\n    color: #6b7280;\n    font-size: 0.875rem;\n    font-weight: 500;\n    pointer-events: none;\n  }\n`;\n\nconst EditableInput = styled.input`\n  width: 100%;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  padding: 0.5rem;\n  font-size: 0.875rem;\n  transition: all 0.2s ease;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n\n  &.date-input {\n    font-family: monospace;\n  }\n\n  &.amount-input {\n    text-align: right;\n    font-family: monospace;\n    padding-right: 2.5rem; /* msto pro K symbol */\n\n    /* Odstrann spinner ipek - WebKit */\n    &::-webkit-outer-spin-button,\n    &::-webkit-inner-spin-button {\n      -webkit-appearance: none;\n      margin: 0;\n    }\n\n    /* Odstrann spinner ipek - Firefox */\n    &[type=number] {\n      -moz-appearance: textfield;\n    }\n  }\n\n  &.readonly {\n    background: #f3f4f6;\n    border-color: #e5e7eb;\n    cursor: not-allowed;\n  }\n`;\n\nconst EditableSelect = styled.select`\n  width: 100%;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  padding: 0.5rem;\n  font-size: 0.875rem;\n  background: white;\n  transition: all 0.2s ease;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n`;\n\nconst ActionIcon = styled.button`\n  padding: 0.25rem;\n  border: none;\n  background: transparent;\n  color: #6b7280;\n  cursor: pointer;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f3f4f6;\n    color: ${props => props.danger ? '#dc2626' : '#374151'};\n  }\n\n  &:active {\n    transform: scale(0.95);\n  }\n`;\n\nconst AddRowButton = styled.button`\n  width: 100%;\n  padding: 1rem;\n  border: 2px dashed #d1d5db;\n  background: #f9fafb;\n  color: #6b7280;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n\n  &:hover {\n    border-color: #3b82f6;\n    background: #eff6ff;\n    color: #3b82f6;\n  }\n\n  &:active {\n    transform: scale(0.99);\n  }\n`;\n\n// =============================================================================\n// COMPONENT\n// =============================================================================\n\nconst CashBookPage = () => {\n  const { user, token, hasPermission, userDetail } = useContext(AuthContext);\n  const { showToast } = useContext(ToastContext);\n\n  //  Nast posledn vbr obdob z localStorage (hlavn pro adminy)\n  const loadSavedPeriod = () => {\n    try {\n      const saved = localStorage.getItem('cashbook_selector_period');\n      if (saved) {\n        const { year, month } = JSON.parse(saved);\n        return { year, month };\n      }\n    } catch (err) {\n      // Tich chyba\n    }\n    return { year: new Date().getFullYear(), month: new Date().getMonth() + 1 };\n  };\n\n  const savedPeriod = loadSavedPeriod();\n\n  // Aktuln msc a rok pro paging\n  const [currentMonth, setCurrentMonth] = useState(savedPeriod.month); // 1-12\n  const [currentYear, setCurrentYear] = useState(savedPeriod.year);\n  const [carryOverAmount, setCarryOverAmount] = useState(0); // Pevod z pedchozho msce\n\n  //  State pro sticky kompaktn pehled\n  const [showStickySummary, setShowStickySummary] = useState(false);\n\n\n\n  // State pro ConfirmDialog\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [entryToDelete, setEntryToDelete] = useState(null);\n  const [closeMonthDialogOpen, setCloseMonthDialogOpen] = useState(false);\n  const [lockBookDialogOpen, setLockBookDialogOpen] = useState(false);\n  const [reopenMonthDialogOpen, setReopenMonthDialogOpen] = useState(false);\n  const [unlockBookDialogOpen, setUnlockBookDialogOpen] = useState(false);\n  const [retroactiveCreationBlockedDialogOpen, setRetroactiveCreationBlockedDialogOpen] = useState(false);\n\n  // Stav pokladn knihy - VECHNY HOOKS MUS BT NA ZATKU\n  //  FIX: Przdn pole - data se natou z DB nebo localStorage v useEffect\n  const [cashBookEntries, setCashBookEntries] = useState([]);\n\n  //  REF: Pro pstup k aktulnmu stavu v intervalech (bez restart intervalu)\n  const cashBookEntriesRef = useRef(cashBookEntries);\n  useEffect(() => {\n    cashBookEntriesRef.current = cashBookEntries;\n  }, [cashBookEntries]);\n\n  const [lastSavedEntryId, setLastSavedEntryId] = useState(null);\n\n  // LP kdy naten z API\n  const [lpCodes, setLpCodes] = useState([]);\n  const [lpLoading, setLpLoading] = useState(true);\n  \n  //  MULTI-LP: Inline rozbalovac panel pro editaci poddk\n  const [expandedDetailEntryId, setExpandedDetailEntryId] = useState(null);\n  const [detailEditBuffer, setDetailEditBuffer] = useState([]);\n\n  //  CASHBOOK V2: Piazen pokladny\n  const [mainAssignment, setMainAssignment] = useState(null);\n  const [assignmentLoading, setAssignmentLoading] = useState(true);\n\n  //  CASHBOOK V3: Vechny pokladny (pro uivatele s _ALL oprvnnmi)\n  const [userAssignments, setUserAssignments] = useState([]); // Pokladny uivatele\n  const [allAssignments, setAllAssignments] = useState([]);   // Vechny pokladny (admin/MANAGE)\n\n  //  KROK 3: Stav pokladn knihy a nastaven prefixu\n  const [bookStatus, setBookStatus] = useState('aktivni'); // aktivni | uzavrena_uzivatelem | zamknuta_spravcem\n  const [bookStatusMetadata, setBookStatusMetadata] = useState(null); // { closedDate, closedBy, lockedDate, lockedBy }\n  const [usePrefixedNumbers, setUsePrefixedNumbers] = useState(false); // Z nastaven cashbook_use_prefix\n  const [settingsLoading, setSettingsLoading] = useState(true);\n\n  //  DB SYNC: Tracking aktuln knihy a sync stavu\n  const [currentBookId, setCurrentBookId] = useState(null); // ID knihy v DB\n  const [currentBookData, setCurrentBookData] = useState(null); //  Cel objekt knihy z BE (obsahuje lokalita_nazev, usek_nazev atd.)\n  const [isSyncing, setIsSyncing] = useState(false); // Probh synchronizace\n  const [lastSyncTimestamp, setLastSyncTimestamp] = useState(null); // Posledn spn sync\n\n  //  PREVIOUS MONTH WARNING: Varovn pokud pedchoz msc nen uzaven\n  const [showPreviousMonthWarning, setShowPreviousMonthWarning] = useState(false);\n  const [syncConflicts, setSyncConflicts] = useState([]); // Pole konflikt ke zobrazen\n\n  // Zskat lokalitu podle pihlenho uivatele\n  const getUserLocation = () => {\n    // Zskn lokality z userDetail - sprvn cesta je lokalita_nazev.nazev\n    const location = userDetail?.lokalita_nazev?.nazev || userDetail?.lokalita?.nazev || userDetail?.location || \"Pbram\";\n    return location;\n  };\n\n  //  DEBUG: Sledovat zmny mainAssignment (zakomentovno - zpsobovalo spam v konzoli)\n  // useEffect(() => {\n  //   console.log(' mainAssignment ZMNA:', {\n  //     id: mainAssignment?.id,\n  //     cislo_pokladny: mainAssignment?.cislo_pokladny,\n  //     uzivatel_id: mainAssignment?.uzivatel_id,\n  //     uzivatel_cele_jmeno: mainAssignment?.uzivatel_cele_jmeno,\n  //     nazev_pracoviste: mainAssignment?.nazev_pracoviste,\n  //     je_hlavni: mainAssignment?.je_hlavni\n  //   });\n  // }, [mainAssignment]);\n\n  // Organizan info\n  const organizationInfo = {\n    organizationName: \"Zdravotnick zchrann sluba Stedoeskho kraje, pspvkov organizace\",\n    workplace: mainAssignment?.nazev_pracoviste || mainAssignment?.kod_pracoviste || getUserLocation(), //  Z vlastnka pokladny\n    cashboxNumber: mainAssignment?.cislo_pokladny || 600, //  Z piazen, fallback 600\n    cashboxVpd: mainAssignment?.ciselna_rada_vpd || null, //  seln ada VPD\n    cashboxPpd: mainAssignment?.ciselna_rada_ppd || null, //  seln ada PPD\n    month: new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long' }),\n    year: currentYear\n  };\n\n  //  OPRAVA: LocalStorage kl mus bt v useMemo aby se aktualizoval kdy pijde userDetail\n  //  OPRAVA 2: Kl mus zahrnovat i mainAssignment.id, aby admin ml oddlen cache pro kadou pokladnu\n  const STORAGE_KEY = useMemo(() => {\n    const userId = userDetail?.id || 'default';\n    const assignmentId = mainAssignment?.id || 'noassignment';\n    const key = `cashbook_${userId}_${assignmentId}_${currentYear}_${currentMonth}`;\n    return key;\n  }, [userDetail?.id, mainAssignment?.id, currentYear, currentMonth]);\n\n  //  OPRVNN: Vpoet oprvnn uivatele\n  const cashbookPermissions = useMemo(() => {\n    return getCashbookPermissionsObject(userDetail);\n  }, [userDetail]);\n\n  //  Me vidt vechny pokladny?\n  // UPRAVENO: Selector se zobraz i bnmu uivateli, pokud m vce ne 1 pokladnu piazenu\n  const canSeeAllCashboxes = useMemo(() => {\n    // Admin/MANAGE me vidt vechny pokladny v systmu\n    const hasAllPermissions = cashbookPermissions.canReadAll ||\n                              cashbookPermissions.canEditAll ||\n                              cashbookPermissions.canDeleteAll ||\n                              cashbookPermissions.canManage;\n\n    // Bn uivatel s vce ne 1 pokladnou me pepnat mezi svmi pokladnami\n    const hasMultipleCashboxes = userAssignments && userAssignments.length > 1;\n\n    return hasAllPermissions || hasMultipleCashboxes;\n  }, [cashbookPermissions, userAssignments]);\n\n  // =============================================================================\n  //  DB SYNC HELPER FUNCTIONS (mus bt ped useEffect kter je vol)\n  // =============================================================================\n\n  /**\n   * Transformace DB entry  Frontend formt\n   */\n  const transformDBEntryToFrontend = useCallback((dbEntry) => {\n    //  Pout DB timestamp pro detekci zmn (admin mohl peslovat)\n    const dbTimestamp = dbEntry.aktualizovano || dbEntry.vytvoreno;\n\n    //  MULTI-LP: Nast detail poloky pokud existuj\n    const detailItems = dbEntry.detail_items || [];\n    const hasDetails = detailItems.length > 0;\n\n    return {\n      id: `local_${Date.now()}_${Math.random()}`, // Lokln ID\n      db_id: dbEntry.id,                           // DB ID\n      date: dbEntry.datum_zapisu,\n      documentNumber: dbEntry.cislo_dokladu,\n      description: dbEntry.obsah_zapisu || '',\n      person: dbEntry.komu_od_koho || '',\n      income: dbEntry.castka_prijem ? parseFloat(dbEntry.castka_prijem) : null,\n      expense: dbEntry.castka_vydaj ? parseFloat(dbEntry.castka_vydaj) : null,\n      balance: parseFloat(dbEntry.zustatek_po_operaci || 0),\n      lpCode: hasDetails ? '' : (dbEntry.lp_kod || ''), // Master LP kod jen pokud NEN multi-LP\n      note: dbEntry.poznamka || '',\n      isEditing: false,\n\n      //  MULTI-LP support\n      detailItems: detailItems.map(item => ({\n        lp_kod: item.lp_kod || '',\n        castka: parseFloat(item.castka || 0),\n        popis: item.popis || ''\n      })),\n\n      //  SYNC metadata pro detekci zmn v DB\n      last_modified_local: new Date().toISOString(),\n      last_synced_at: dbTimestamp,           // Kdy bylo naposledy syncnut z DB\n      db_updated_at: dbTimestamp,            // Kdy bylo v DB aktualizovno\n      changed: false,                        // Zda m lokln neuloen zmny\n      sync_status: 'synced'                  // synced | pending | error\n    };\n  }, []); // dn dependencies\n\n  /**\n   * Transformace Frontend entry  DB payload\n   */\n  const transformFrontendEntryToDB = useCallback((entry, bookId) => {\n    const payload = {\n      book_id: bookId,\n      datum_zapisu: entry.date,\n      cislo_dokladu: entry.documentNumber, //  Poslat slo dokladu (me bt zmnno pi zmn typu)\n      obsah_zapisu: entry.description || '', // Vdy poslat, i kdy przdn string\n      komu_od_koho: entry.person || '', // Vdy poslat\n      //  FIX: Explicitn poslat 0 msto null/undefined, aby se smazala pvodn hodnota\n      castka_prijem: entry.income || 0,\n      castka_vydaj: entry.expense || 0,\n      typ_dokladu: entry.expense > 0 ? 'vydaj' : 'prijem', //  MULTI-LP potebuje typ\n      poznamka: entry.note || '' // Vdy poslat\n    };\n    \n    //  MULTI-LP: Pokud m detailItems, poslat je (NEPOSLAT master lp_kod)\n    if (entry.detailItems && entry.detailItems.length > 0) {\n      payload.detail_items = entry.detailItems;\n      payload.castka_celkem = entry.detailItems.reduce((sum, item) => sum + (item.castka || 0), 0);\n      console.log(' MULTI-LP payload:', { \n        detail_items_count: entry.detailItems.length, \n        castka_celkem: payload.castka_celkem,\n        detail_items: entry.detailItems\n      });\n      // Master LP kd je przdn, kdy jsou detaily\n    } else if (entry.lpCode) {\n      // Pvodn flow - pouze pokud NEN multi-LP\n      payload.lp_kod = entry.lpCode;\n    }\n    \n    return payload;\n  }, []); // dn dependencies\n\n  /**\n   * Naten knihy z DB (nebo vytvoen nov)\n   */\n  const ensureBookExists = useCallback(async () => {\n    if (!mainAssignment?.id || !userDetail?.id) {\n      return null;\n    }\n\n    try {\n      //  FIX: Kdy admin pepne na jinou pokladnu, nast knihy pro UIVATELE T POKLADNY\n      const targetUserId = mainAssignment.uzivatel_id || userDetail.id;\n\n      // 1. Zkusit nast existujc knihu\n      const booksResult = await cashbookAPI.listBooks(targetUserId, currentYear, currentMonth);\n\n      if (booksResult.status === 'ok' && booksResult.data?.books?.length > 0) {\n        const book = booksResult.data.books[0];\n\n        setCurrentBookId(book.id);\n        setCurrentBookData(book); //  Uloit cel objekt knihy\n        setBookStatus(book.stav_knihy || 'aktivni');\n        setCarryOverAmount(parseFloat(book.prevod_z_predchoziho || 0));\n\n        // Nast detaily knihy vetn poloek (s force_recalc pro aktuln pevod)\n        const bookDetail = await cashbookAPI.getBook(book.id, true);\n\n        if (bookDetail.status === 'ok' && bookDetail.data?.entries) {\n          // Transformovat entries do frontend formtu\n          const transformedEntries = bookDetail.data.entries.map(transformDBEntryToFrontend);\n          return { book, entries: transformedEntries };\n        }\n\n        return { book, entries: [] };\n      } else {\n        // 2. Kniha neexistuje - zkusit vytvoit\n        //  Pokud m uivatel piazen (mainAssignment.id existuje), vytvo knihu\n        if (mainAssignment?.id) {\n\n          const createResult = await cashbookAPI.createBook(\n            mainAssignment.id,  // prirazeni_pokladny_id\n            currentYear,\n            currentMonth,\n            targetUserId        // uzivatel_id\n          );\n\n          if (createResult.status === 'ok') {\n            //  Backend vrac jen book_id (ne cel objekt)\n            const bookId = createResult.data?.book_id || createResult.data?.id;\n\n            if (bookId) {\n              // Nast kompletn knihu z DB (vetn prevod_z_predchoziho s force_recalc)\n              const bookDetail = await cashbookAPI.getBook(bookId, true);\n\n              if (bookDetail.status === 'ok') {\n                const newBook = bookDetail.data?.book || bookDetail.data;\n\n                setCurrentBookId(bookId);\n                setCurrentBookData(newBook); //  Uloit cel objekt knihy\n                setBookStatus(newBook.stav_knihy || 'aktivni');\n                setCarryOverAmount(parseFloat(newBook.prevod_z_predchoziho || 0));\n\n                const transformedEntries = (bookDetail.data?.entries || []).map(transformDBEntryToFrontend);\n                return { book: newBook, entries: transformedEntries };\n              }\n            }\n          }\n\n          // Pokud se sem dostaneme, nco se nepovedlo\n          const errorMsg = createResult.message || createResult.error || 'Backend nevrtil book_id';\n          throw new Error('Nepodailo se vytvoit knihu: ' + errorMsg);\n        } else {\n          //  Uivatel nem piazen pokladny - zobrazit chybu\n          console.warn(' Uivatel nem piazen k dn pokladn', { mainAssignment, userDetail });\n          throw new Error('NO_ASSIGNMENT');\n        }\n      }\n    } catch (error) {\n      console.error(' Chyba pi zajitn existence knihy:', error);\n\n      //  Speciln zpracovn chyby - uivatel nem piazen\n      if (error.message === 'NO_ASSIGNMENT') {\n        showToast('Bohuel Vm pokladn kniha nebyla pidlena. Kontaktujte sprvce.', 'error');\n        // Nastavit przdn stav\n        setCashBookEntries([]);\n        setCurrentBookId(null);\n        return null;\n      }\n\n      showToast('Chyba pi natn/vytven knihy: ' + error.message, 'error');\n      return null;\n    }\n  }, [mainAssignment, userDetail, currentYear, currentMonth, showToast, transformDBEntryToFrontend]);\n\n  /**\n   * Uloit data do localStorage (backup)\n   */\n  const saveToLocalStorage = useCallback((entries, status, carryOver) => {\n    const dataToSave = {\n      entries: entries,\n      bookStatus: status,\n      carryOverAmount: carryOver,\n      lastModified: new Date().toISOString(),\n      lastSyncTimestamp: lastSyncTimestamp\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n  }, [STORAGE_KEY, lastSyncTimestamp]);\n\n  /**\n   * Synchronizace loklnch zmn do DB\n   * @param {Array} entries - Pole poloek k synchronizaci\n   * @param {number} bookId - ID knihy (voliteln, pouije currentBookId ze state)\n   */\n  const syncLocalChangesToDB = useCallback(async (entries, bookId = null) => {\n    const targetBookId = bookId || currentBookId;\n\n    if (!targetBookId || isSyncing) {\n      return;\n    }\n\n    if (isSyncing) {\n      return;\n    }\n\n    try {\n      setIsSyncing(true);\n\n      let syncedCount = 0;\n      let errorCount = 0;\n\n      for (const entry of entries) {\n        // Peskoit poloky kter jsou ji syncnut\n        if (entry.sync_status === 'synced' && !entry.changed) {\n          continue;\n        }\n\n        try {\n          if (entry.db_id) {\n            // Existuje v DB - update\n            await cashbookAPI.updateEntry(entry.db_id, transformFrontendEntryToDB(entry, targetBookId));\n          } else {\n            // Neexistuje v DB - create\n            const result = await cashbookAPI.createEntry(transformFrontendEntryToDB(entry, targetBookId));\n\n            if (result.status === 'ok' && result.data?.entry) {\n              // Aktualizovat entry s DB ID\n              entry.db_id = result.data.entry.id;\n              entry.documentNumber = result.data.entry.cislo_dokladu;\n            }\n          }\n\n          // Oznait jako syncnut\n          entry.changed = false;\n          entry.sync_status = 'synced';\n          entry.last_synced_at = new Date().toISOString();\n          syncedCount++;\n\n        } catch (error) {\n          console.error(' Chyba pi sync entry:', error);\n          entry.sync_status = 'error';\n          errorCount++;\n        }\n      }\n\n      // Aktualizovat totals v DB\n      const totalIncome = entries.reduce((sum, e) => sum + (e.income || 0), 0);\n      const totalExpenses = entries.reduce((sum, e) => sum + (e.expense || 0), 0);\n      const endBalance = carryOverAmount + totalIncome - totalExpenses;\n\n      await cashbookAPI.updateBook(targetBookId, {\n        celkove_prijmy: totalIncome,\n        celkove_vydaje: totalExpenses,\n        koncovy_stav: endBalance,\n        pocet_zaznamu: entries.length\n      });\n\n      setLastSyncTimestamp(new Date().toISOString());\n\n      if (errorCount > 0) {\n        showToast(`Synchronizovno ${syncedCount} poloek, ${errorCount} chyb`, 'warning');\n      }\n\n    } catch (error) {\n      console.error(' Chyba pi synchronizaci:', error);\n      showToast('Chyba pi synchronizaci s databz', 'error');\n    } finally {\n      setIsSyncing(false);\n    }\n  }, [currentBookId, isSyncing, carryOverAmount, showToast, transformFrontendEntryToDB]);\n\n  //  DB SYNC: Nast data z DB pi naten komponenty nebo zmn msce\n  useEffect(() => {\n    //  DLEIT: Nepokrauj pokud jet nemme userDetail nebo mainAssignment\n    if (!userDetail?.id || !mainAssignment?.id) {\n      return;\n    }\n\n    const loadDataFromDB = async () => {\n      try {\n        // 1. Zajistit existenci knihy v DB (nebo vytvoit novou)\n        const result = await ensureBookExists();\n\n        if (!result) {\n          // Pokud je to chyba oprvnn, nechat przdnou tabulku (ji zobrazen chyba v ensureBookExists)\n          // Jinak zkusit localStorage jako fallback\n          if (currentBookId === null) {\n            // Nebyla vytvoena/natena dn kniha - zobrazit przdnou strnku\n            setCashBookEntries([]);\n            return;\n          }\n          loadFromLocalStorageOnly();\n          return;\n        }\n\n        const { book, entries } = result;\n\n        //  NASTAVIT STAV KNIHY HNED PO NATEN (priorita DB dat)\n        setBookStatus(book.stav_knihy || 'aktivni');\n\n        //  NASTAVIT METADATA O UZAVEN/ZAMEN\n        // Backend vrac kompletn jmna (uzivatel_jmeno_plne, zamknul_spravce_jmeno_plne)\n        const closedByName = book.uzivatel_jmeno_plne || `ID: ${book.uzivatel_id}`;\n        const lockedByName = book.zamknul_spravce_jmeno_plne || null;\n\n        setBookStatusMetadata({\n          closedDate: book.uzavrena_uzivatelem_kdy || null,\n          closedBy: closedByName,\n          lockedDate: book.zamknuta_spravcem_kdy || null,\n          lockedBy: lockedByName,\n        });\n\n        //  DETEKCE PAGE RELOAD (F5)\n        // Pokud je performance.navigation.type === 1, je to reload strnky\n        const isPageReload = window.performance?.navigation?.type === 1 ||\n                            window.performance?.getEntriesByType?.('navigation')?.[0]?.type === 'reload';\n\n        // 2. Nast localStorage pro porovnn (pouze pokud NEN page reload)\n        const savedData = localStorage.getItem(STORAGE_KEY);\n        let localEntries = [];\n        let localTimestamp = null;\n\n        if (savedData && !isPageReload) {\n          try {\n            const parsed = JSON.parse(savedData);\n            localEntries = parsed.entries || [];\n            localTimestamp = parsed.lastSyncTimestamp;\n          } catch (error) {\n            console.error(' Chyba parsovn localStorage:', error);\n          }\n        }\n\n        //  KONTROLA: Porovnat timestamp DB vs localStorage\n        // Pokud m DB novj data (nap. admin pesloval), pout DB\n        const dbIsNewer = book.aktualizovano && localTimestamp &&\n                         new Date(book.aktualizovano) > new Date(localTimestamp);\n\n\n\n        // 3. Rozhodnout, kter data pout\n        //  STRATEGIE: DB JE VDY ZDROJ PRAVDY\n        // localStorage slou POUZE jako doasn offline backup\n        // Po F5 nebo zmn uivatele se VDY nate erstv data z DB\n\n        //  PRAVIDLO 1: Pokud je page reload (F5), VDY ignorovat localStorage\n        if (isPageReload) {\n          // F5  nast jen z DB, smazat star localStorage\n          setCashBookEntries(entries);\n          if (entries.length > 0) {\n            saveToLocalStorage(entries, book.stav_knihy, parseFloat(book.prevod_z_predchoziho || 0));\n          } else {\n            localStorage.removeItem(STORAGE_KEY);\n          }\n          setLastSyncTimestamp(new Date().toISOString());\n        }\n        //  PRAVIDLO 2: Pokud DB m novj data ne localStorage (timestamp check)\n        else if (dbIsNewer) {\n          // Admin mohl zmnit data (peslovn doklad)  pout DB\n          setCashBookEntries(entries);\n          saveToLocalStorage(entries, book.stav_knihy, parseFloat(book.prevod_z_predchoziho || 0));\n          setLastSyncTimestamp(new Date().toISOString());\n        }\n        //  PRAVIDLO 3: Pokud DB m data, pout DB (standardn naten)\n        else if (entries.length > 0) {\n          // DB m data  pout DB jako zdroj pravdy\n          setCashBookEntries(entries);\n          saveToLocalStorage(entries, book.stav_knihy, parseFloat(book.prevod_z_predchoziho || 0));\n          setLastSyncTimestamp(new Date().toISOString());\n        }\n        //  PRAVIDLO 4: DB je przdn, ale localStorage m unsyncnut data\n        else if (entries.length === 0 && localEntries.length > 0) {\n          // Pouze pokud localStorage pat TTO pokladn a TOMUTO uivateli\n          const isValidCache = STORAGE_KEY.includes(`_${mainAssignment.id}_`) &&\n                              STORAGE_KEY.includes(`_${userDetail.id}_`);\n\n          if (isValidCache) {\n            // Offline reim - pout lokln data a pokusit se sync\n            setCashBookEntries(localEntries);\n            syncLocalChangesToDB(localEntries, book.id);\n          } else {\n            // Cache je pro jinou pokladnu/uivatele  smazat a zat ist\n            setCashBookEntries([]);\n            localStorage.removeItem(STORAGE_KEY);\n          }\n        }\n        //  PRAVIDLO 4: Ani DB ani localStorage nem data  przdn start\n        else {\n          setCashBookEntries([]);\n          localStorage.removeItem(STORAGE_KEY);\n        }\n\n      } catch (error) {\n        console.error(' Chyba pi natn z DB:', error);\n        loadFromLocalStorageOnly();\n      }\n    };\n\n    // Helper: Nast pouze z localStorage (fallback)\n    const loadFromLocalStorageOnly = () => {\n      const savedData = localStorage.getItem(STORAGE_KEY);\n\n      // Nast konen zstatek z pedchozho msce (pro vpoet carryOver pokud nen uloen)\n      const prevMonth = currentMonth === 1 ? 12 : currentMonth - 1;\n      const prevYear = currentMonth === 1 ? currentYear - 1 : currentYear;\n      const prevStorageKey = `cashbook_${userDetail.id}_${prevYear}_${prevMonth}`;\n\n      let calculatedCarryOver = 0;\n      const prevMonthData = localStorage.getItem(prevStorageKey);\n\n      if (prevMonthData) {\n        try {\n          const prevParsed = JSON.parse(prevMonthData);\n          const prevEntries = prevParsed.entries || [];\n\n          // Spotat konen zstatek pedchozho msce\n          const prevInitialBalance = prevParsed.carryOverAmount || 0;\n          const totalIncome = prevEntries.reduce((sum, entry) => sum + (entry.income || 0), 0);\n          const totalExpenses = prevEntries.reduce((sum, entry) => sum + (entry.expense || 0), 0);\n          calculatedCarryOver = prevInitialBalance + totalIncome - totalExpenses;\n\n        } catch (error) {\n          console.error(' Chyba pi natn dat pedchozho msce:', error);\n        }\n      }\n\n      if (savedData) {\n        try {\n          const parsed = JSON.parse(savedData);\n\n          // Nast entries z localStorage\n          setCashBookEntries(parsed.entries || []);\n          setBookStatus(parsed.bookStatus || 'aktivni');\n\n          const storedCarryOver = parsed.carryOverAmount;\n          if (typeof storedCarryOver === 'number') {\n            setCarryOverAmount(storedCarryOver);\n          } else {\n            setCarryOverAmount(calculatedCarryOver);\n            const updatedData = { ...parsed, carryOverAmount: calculatedCarryOver };\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedData));\n          }\n        } catch (error) {\n          console.error(' Chyba pi natn dat z localStorage:', error);\n          setCashBookEntries([]);\n          setCarryOverAmount(calculatedCarryOver);\n        }\n      } else {\n        setCashBookEntries([]);\n        setCarryOverAmount(calculatedCarryOver);\n      }\n    };\n\n    // Spustit natn z DB\n    loadDataFromDB();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [STORAGE_KEY, currentMonth, currentYear, userDetail?.id, mainAssignment?.id, mainAssignment?.cislo_pokladny]);\n\n  // Nast LP kdy z API pi naten komponenty (jednou)\n  useEffect(() => {\n    const loadLpCodes = async () => {\n\n      // OPRAVA: token je samostatn promnn, nen soust user objektu!\n      if (!token || !user?.username) {\n        setLpLoading(false);\n        return;\n      }\n\n      try {\n        setLpLoading(true);\n\n        // Pout stejnou funkci jako v OrderForm25\n        const data = await fetchLimitovanePrisliby({\n          token: token,\n          username: user.username\n        });\n\n        // Transformovat data do jednotnho formtu { code, name }\n        // SPRVN STRUKTURA: cislo_lp (nap. \"LPIT01\"), nazev_uctu (nzev LP kdu)\n        const transformedLps = Array.isArray(data) ? data.map(lp => {\n          const code = lp.cislo_lp || lp.kod || lp.code || lp.id;\n          const name = lp.nazev_uctu || lp.nazev || lp.name || lp.popis || '';\n          return { code, name };\n        }) : [];\n\n        setLpCodes(transformedLps);\n        setLpLoading(false);\n      } catch (error) {\n        console.error(' Chyba pi natn LP kd:', error);\n        showToast('Nepodailo se nast LP kdy', 'error');\n        setLpCodes([]);\n        setLpLoading(false);\n      }\n    };\n\n    loadLpCodes();\n  }, [token, user?.username, showToast]); // Nate se jednou kdy mme token a username\n\n  //  STICKY SUMMARY: Sledovn scrollu pro zobrazen kompaktnho pehledu\n  useEffect(() => {\n    const handleScroll = () => {\n      // Layout pouv fixed main element pro scrollovn\n      const mainElement = document.querySelector('main');\n      if (!mainElement) return;\n\n      const scrollTop = mainElement.scrollTop;\n\n      // Zobrazit sticky pi scrollu 575px\n      const threshold = 575;\n      const shouldShow = scrollTop > threshold;\n\n      // Debug - odkomentuj pro testovn\n      // console.log('Scroll:', scrollTop, 'Threshold:', threshold, 'Show:', shouldShow);\n\n      setShowStickySummary(shouldShow);\n    };\n\n    // Najt main element a pipojit listener\n    const mainElement = document.querySelector('main');\n    if (!mainElement) return;\n\n    mainElement.addEventListener('scroll', handleScroll);\n\n    // Kontrola pi mount (pokud u je scrollnut)\n    handleScroll();\n\n    // Re-kalkulovat threshold pi resize (mn se vka InfoPanel)\n    window.addEventListener('resize', handleScroll);\n\n    return () => {\n      if (mainElement) {\n        mainElement.removeEventListener('scroll', handleScroll);\n      }\n      window.removeEventListener('resize', handleScroll);\n    };\n  }, []);\n\n  //  AUTO REFRESH: Automatick refresh pi nvratu do okna + periodick refresh\n  useEffect(() => {\n    // Funkce pro refresh dat z DB\n    const refreshDataFromDB = async (showMessage = false) => {\n      if (!currentBookId) return;\n\n      try {\n        // 1. Nast fresh data z DB vetn book info (s force_recalc pro pepoet pevodu)\n        const bookData = await cashbookAPI.getBook(currentBookId, true);\n\n        if (bookData.status === 'ok') {\n          //  FIX: Aktualizovat carryOverAmount z DB (me se zmnit pi prav pedchozho msce)\n          const book = bookData.data?.book || bookData.data;\n          if (book && book.prevod_z_predchoziho !== undefined) {\n            const freshCarryOver = parseFloat(book.prevod_z_predchoziho || 0);\n            setCarryOverAmount(freshCarryOver);\n          }\n\n          const entries = bookData.data?.entries || [];\n          const dbEntries = entries.map(entry => ({\n            ...entry,\n            id: entry.id || `temp-${Date.now()}-${Math.random()}`,\n            db_id: entry.id,\n            date: entry.datum_zapisu || entry.datum || new Date().toISOString().split('T')[0],\n            documentNumber: entry.cislo_dokladu || '',\n            description: entry.obsah_zapisu || '',\n            person: entry.komu_od_koho || '',\n            income: entry.castka_prijem ? parseFloat(entry.castka_prijem) : null,\n            expense: entry.castka_vydaj ? parseFloat(entry.castka_vydaj) : null,\n            balance: parseFloat(entry.zustatek_po_operaci || 0),\n            lpCode: entry.lp_kod || '',\n            note: entry.poznamka || '',\n            isEditing: false,\n            changed: false,\n            sync_status: 'synced'\n          }));\n\n          // 2. Nast lokln data z localStorage\n          const stored = localStorage.getItem(STORAGE_KEY);\n          const localData = stored ? JSON.parse(stored) : null;\n\n          // 3. Slouit data - DB m pednost, ale zachovat lokln editace\n          if (localData?.entries && localData.entries.some(e => e.isEditing || e.changed)) {\n            // Jsou lokln zmny - mergovat opatrn\n            const mergedEntries = dbEntries.map(dbEntry => {\n              const localEntry = localData.entries.find(le => le.id === dbEntry.id);\n              return localEntry?.changed ? localEntry : dbEntry;\n            });\n\n            setCashBookEntries(mergedEntries);\n            if (showMessage) {\n              showToast('Data refreshnuta - zachovny lokln zmny', 'info');\n            }\n          } else {\n            // dn lokln zmny - prost nahradit\n            setCashBookEntries(dbEntries);\n            if (showMessage) {\n              showToast('Data aktualizovna z DB', 'success');\n            }\n          }\n        }\n      } catch (error) {\n        console.error(' Chyba pi auto-refresh:', error);\n        // Tich chyba - neomezovat UX\n      }\n    };\n\n    // Handler pro nvrat do okna\n    const handleVisibilityChange = () => {\n      // Pokud se uivatel vrt do okna (z hidden na visible)\n      if (!document.hidden && currentBookId) {\n        refreshDataFromDB(true); // S toast notifikac\n      }\n    };\n\n    // Periodick refresh na pozad kad 2 minuty\n    const intervalId = setInterval(() => {\n      //  KONTROLA: Pouze pokud uivatel NEUPRAVUJE dn zznam A NEM NEULOEN ZMNY\n      // Zkontroluj, zda nen njak entry v reimu editace nebo nesynchronizovan zmny\n      const stored = localStorage.getItem(STORAGE_KEY);\n      const localData = stored ? JSON.parse(stored) : null;\n      const hasEditingEntryInLocalStorage = localData?.entries?.some(e => e.isEditing) || false;\n      const hasUnsyncedChanges = localData?.entries?.some(e => e.changed || e.sync_status !== 'synced') || false;\n\n      //  FIX: Kontrola i aktulnho stavu cashBookEntries (pouit ref pro aktuln hodnotu)\n      const hasEditingEntryInState = cashBookEntriesRef.current?.some(e => e.isEditing) || false;\n\n      if (!hasEditingEntryInLocalStorage && !hasEditingEntryInState && !hasUnsyncedChanges) {\n        // Refresh POUZE kdy:\n        // 1. dn zznam nen v editaci (localStorage)\n        // 2. dn zznam nen v editaci (aktuln state)\n        // 3. dn zznam nem nesynchronizovan zmny\n        refreshDataFromDB(false); // Bez toast notifikace\n      }\n      // Pokud je njak zznam v editaci, peskome refresh\n    }, 120000); // 2 minuty (120 sekund)\n\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n\n    return () => {\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n      clearInterval(intervalId);\n    };\n  }, [currentBookId, STORAGE_KEY, showToast]);\n\n  //  UNIFIED: Nast assignments (vlastn + admin allAssignments) v JEDNOM useEffect\n  useEffect(() => {\n    const loadAllData = async () => {\n      if (!userDetail?.id) {\n        return;\n      }\n\n      try {\n        setAssignmentLoading(true);\n\n        // 1 VDY nast vlastn piazen\n        const userResult = await cashbookAPI.listAssignments(userDetail.id, true);\n        const userAssignments = userResult.data?.assignments || [];\n        setUserAssignments(userAssignments);\n\n        // 2 Pokud m admin oprvnn, nast i vechny pokladny\n        let allAvailableAssignments = userAssignments; // Default pro bn uivatele\n\n        if (canSeeAllCashboxes) {\n          try {\n            const allResult = await cashbookAPI.getCashboxListByPeriod(\n              currentYear,\n              currentMonth,\n              true,  // active_only\n              true   // include_users\n            );\n\n            if (allResult.status === 'ok' && allResult.data?.pokladny) {\n              const transformedData = allResult.data.pokladny.map(item => ({\n                ...item,\n                id: parseInt(item.prirazeni_id || item.id, 10),\n                pokladna_id: parseInt(item.id, 10),\n                cislo_pokladny: parseInt(item.cislo_pokladny, 10),\n                aktivni: parseInt(item.aktivni, 10),\n                uzivatel_id: parseInt(item.uzivatel_id, 10),\n                je_hlavni: 1,\n              }));\n\n              setAllAssignments(transformedData);\n              allAvailableAssignments = transformedData; // Admin vid vechny\n            }\n          } catch (err) {\n            // Tich chyba - nen kritick\n          }\n        }\n\n        // 3 Vybrat sprvnou pokladnu (localStorage  hlavn  prvn)\n        let selectedAssignment = null;\n\n        // Zkusit localStorage\n        try {\n          const saved = localStorage.getItem('cashbook_selector_cashbox');\n          if (saved) {\n            const savedData = JSON.parse(saved);\n            selectedAssignment = allAvailableAssignments.find(a => a.id === savedData.id);\n          }\n        } catch (err) {\n          // Tich chyba\n        }\n\n        // Fallback na hlavn nebo prvn\n        if (!selectedAssignment) {\n          const main = allAvailableAssignments.find(a => a.je_hlavni === 1);\n          selectedAssignment = main || allAvailableAssignments[0];\n        }\n\n        if (selectedAssignment) {\n          setMainAssignment(selectedAssignment);\n        } else {\n          showToast('Nemte piazenou pokladnu.', 'error');\n        }\n\n      } catch (error) {\n        console.error(' Chyba pi natn dat:', error);\n        showToast('Chyba pi natn dat: ' + error.message, 'error');\n      } finally {\n        setAssignmentLoading(false);\n      }\n    };\n\n    loadAllData();\n  }, [userDetail?.id, canSeeAllCashboxes, currentYear, currentMonth, showToast]);\n\n  //  Uloit vbr obdob do localStorage (hlavn pro adminy)\n  useEffect(() => {\n    try {\n      localStorage.setItem('cashbook_selector_period', JSON.stringify({\n        year: currentYear,\n        month: currentMonth\n      }));\n    } catch (err) {\n      // Tich chyba\n    }\n  }, [currentYear, currentMonth]);\n\n  //  KROK 4: Nast nastaven prefixovanch sel pi mount\n  useEffect(() => {\n    const loadSettings = async () => {\n      try {\n        setSettingsLoading(true);\n\n        // Backend API vrac pi dotazu na konkrtn kl: {status: 'ok', data: {key: 'cashbook_use_prefix', value: '0'}}\n        const result = await cashbookAPI.getSettings('cashbook_use_prefix');\n\n        if (result.status === 'ok' && result.data) {\n          // Backend vrac objekt s key a value, ne pole\n          const value = result.data.value;\n          const usePrefix = value === '1' || value === 1;\n          setUsePrefixedNumbers(usePrefix);\n        } else {\n          setUsePrefixedNumbers(false);\n        }\n      } catch (error) {\n        console.error(' CASHBOOK V2: Chyba pi natn nastaven:', error);\n        // V ppad chyby pouijeme false (bez prefix)\n        setUsePrefixedNumbers(false);\n      } finally {\n        setSettingsLoading(false);\n      }\n    };\n\n    loadSettings();\n  }, []);\n\n  // Poten zstatek = pevod z pedchozho msce\n  const initialBalance = carryOverAmount;\n\n  // Vypotan hodnoty\n  const totals = React.useMemo(() => {\n    const totalIncome = cashBookEntries.reduce((sum, entry) => sum + (entry.income || 0), 0);\n    const totalExpenses = cashBookEntries.reduce((sum, entry) => sum + (entry.expense || 0), 0);\n    const currentBalance = initialBalance + totalIncome - totalExpenses;\n\n    return {\n      totalIncome,\n      totalExpenses,\n      currentBalance,\n      entryCount: cashBookEntries.length\n    };\n  }, [cashBookEntries, carryOverAmount, initialBalance]);\n\n  //  ZJEDNODUENO: Pouvme data pmo z cashBookEntries jak pijdou z DB\n  // DB u obsahuje sprvn peslovan doklady, nen teba je pepotvat\n\n  //  Funkce pro naten poslednch P a V sel z pedchozho msce\n  const getLastDocumentNumbersFromPreviousMonth = useCallback(async () => {\n    if (!mainAssignment?.uzivatel_id) {\n      return { lastP: 0, lastV: 0 };\n    }\n\n    const userId = mainAssignment.uzivatel_id;\n    const prevMonth = currentMonth === 1 ? 12 : currentMonth - 1;\n    const prevYear = currentMonth === 1 ? currentYear - 1 : currentYear;\n\n    try {\n      // Najt knihu pro pedchoz msc\n      const booksResult = await cashbookAPI.listBooks(userId, prevYear, prevMonth);\n\n      if (booksResult.status !== 'ok' || !booksResult.data?.books || booksResult.data.books.length === 0) {\n        return { lastP: 0, lastV: 0 };\n      }\n\n      const prevBook = booksResult.data.books[0]; // Prvn kniha pro ten msc\n\n      // Nast entries z t knihy\n      const bookResult = await cashbookAPI.getBook(prevBook.id, false);\n\n      if (bookResult.status === 'ok' && bookResult.data?.entries?.length > 0) {\n        const entries = bookResult.data.entries;\n\n        // Najt nejvy P slo (z DB pole cislo_dokladu)\n        const pNumbers = entries\n          .filter(e => e.cislo_dokladu?.startsWith('P'))\n          .map(e => parseInt(e.cislo_dokladu.substring(1)) || 0);\n        const lastP = pNumbers.length > 0 ? Math.max(...pNumbers) : 0;\n\n        // Najt nejvy V slo\n        const vNumbers = entries\n          .filter(e => e.cislo_dokladu?.startsWith('V'))\n          .map(e => parseInt(e.cislo_dokladu.substring(1)) || 0);\n        const lastV = vNumbers.length > 0 ? Math.max(...vNumbers) : 0;\n\n        return { lastP, lastV };\n      }\n\n      return { lastP: 0, lastV: 0 };\n    } catch (error) {\n      console.error(' Chyba pi natn sel z pedchozho msce:', error);\n      return { lastP: 0, lastV: 0 };\n    }\n  }, [mainAssignment, currentMonth, currentYear]);\n\n  // Formtovn eskch korun\n  const formatCurrency = (amount) => {\n    if (amount === null || amount === undefined) return '';\n    return new Intl.NumberFormat('cs-CZ', {\n      style: 'currency',\n      currency: 'CZK',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    }).format(amount);\n  };\n\n  // Formtovn eskho data\n  const formatDate = (dateStr) => {\n    if (!dateStr) return '';\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('cs-CZ');\n  };\n\n  // Dnen datum ve formtu YYYY-MM-DD\n  const getTodayDate = () => {\n    const today = new Date();\n    return today.toISOString().split('T')[0];\n  };\n\n  //  ZJEDNODUENO: Generovn sla dokladu - pokrauje od poslednho v aktulnm msci\n  // Pokud je msc przdn, nate posledn slo z pedchozho msce\n  const generateDocumentNumber = async (isIncome) => {\n    const type = isIncome ? 'P' : 'V';\n\n    // Najt nejvy slo v aktulnm msci\n    const currentMonthNumbers = cashBookEntries\n      .filter(entry => entry.documentNumber?.startsWith(type))\n      .map(entry => parseInt(entry.documentNumber.substring(1)) || 0);\n\n    let nextNumber;\n\n    if (currentMonthNumbers.length > 0) {\n      // Pokud u mme doklady v tomto msci, pokrauj od nejvyho\n      nextNumber = Math.max(...currentMonthNumbers) + 1;\n    } else {\n      // Pokud je msc przdn, nati posledn slo z pedchozho msce\n      const { lastP, lastV } = await getLastDocumentNumbersFromPreviousMonth();\n      nextNumber = (type === 'P' ? lastP : lastV) + 1;\n    }\n\n    return `${type}${String(nextNumber).padStart(3, '0')}`;\n  };\n\n  //  Helper: Kontrola, zda existuj uzaven msce v budoucnosti\n  const checkForClosedFutureMonths = useCallback(async (targetYear, targetMonth) => {\n    if (!mainAssignment?.uzivatel_id) {\n      return { hasClosedFuture: false, closedMonths: [] };\n    }\n\n    try {\n      const userId = mainAssignment.uzivatel_id;\n      const closedMonths = [];\n\n      // Projt vechny msce od targetMonth+1 do aktulnho msce\n      const today = new Date();\n      const currentSystemMonth = today.getMonth() + 1;\n      const currentSystemYear = today.getFullYear();\n\n      let checkYear = targetYear;\n      let checkMonth = targetMonth + 1;\n\n      // Normalizace (pokud je targetMonth = 12, dal msc je 1 v dalm roce)\n      if (checkMonth > 12) {\n        checkMonth = 1;\n        checkYear++;\n      }\n\n      // Prochzet msce a do aktulnho\n      while (\n        checkYear < currentSystemYear ||\n        (checkYear === currentSystemYear && checkMonth <= currentSystemMonth)\n      ) {\n        const booksResult = await cashbookAPI.listBooks(userId, checkYear, checkMonth);\n\n        if (booksResult.status === 'ok' && booksResult.data?.books?.length > 0) {\n          const book = booksResult.data.books[0];\n          // Kontrola, zda je kniha uzaven nebo zamen\n          if (book.stav_knihy === 'uzavrena_uzivatelem' || book.stav_knihy === 'zamknuta_spravcem') {\n            closedMonths.push({\n              year: checkYear,\n              month: checkMonth,\n              status: book.stav_knihy,\n              monthName: new Date(checkYear, checkMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })\n            });\n          }\n        }\n\n        // Posun na dal msc\n        checkMonth++;\n        if (checkMonth > 12) {\n          checkMonth = 1;\n          checkYear++;\n        }\n      }\n\n      return {\n        hasClosedFuture: closedMonths.length > 0,\n        closedMonths: closedMonths\n      };\n    } catch (error) {\n      console.error(' Chyba pi kontrole budoucch uzavench msc:', error);\n      return { hasClosedFuture: false, closedMonths: [] };\n    }\n  }, [mainAssignment]);\n\n  //  Kontrola zda pedchoz msc je uzaven (pro warning)\n  const checkPreviousMonthStatus = useCallback(async () => {\n    if (!currentBookId || !mainAssignment?.uzivatel_id) {\n      setShowPreviousMonthWarning(false);\n      return;\n    }\n\n    const userId = mainAssignment.uzivatel_id;\n    const prevMonth = currentMonth === 1 ? 12 : currentMonth - 1;\n    const prevYear = currentMonth === 1 ? currentYear - 1 : currentYear;\n\n    try {\n      const result = await cashbookAPI.listBooks(userId, prevYear, prevMonth);\n\n      if (result.status === 'ok' && result.data?.books?.length > 0) {\n        const prevBook = result.data.books[0];\n\n        // Pokud je pedchoz msc AKTIVN (ne uzaven)  zobrazit warning\n        if (prevBook.stav_knihy === 'aktivni') {\n          setShowPreviousMonthWarning(true);\n        } else {\n          setShowPreviousMonthWarning(false);\n        }\n      } else {\n        // Pedchoz msc neexistuje  dn varovn\n        setShowPreviousMonthWarning(false);\n      }\n    } catch (error) {\n      console.error('Chyba pi kontrole pedchozho msce:', error);\n      setShowPreviousMonthWarning(false);\n    }\n  }, [mainAssignment, currentYear, currentMonth, currentBookId]);\n\n  // useEffect pro kontrolu pedchozho msce\n  useEffect(() => {\n    checkPreviousMonthStatus();\n  }, [checkPreviousMonthStatus]);\n\n  // Navigace na pedchoz msc\n  const goToPreviousMonth = async () => {\n    // Vypotat clov msc\n    let targetMonth = currentMonth - 1;\n    let targetYear = currentYear;\n\n    if (targetMonth < 1) {\n      targetMonth = 12;\n      targetYear--;\n    }\n\n    //  OCHRANA: Kontrola, zda pro clov msc ji kniha EXISTUJE\n    if (mainAssignment?.uzivatel_id) {\n      try {\n        const userId = mainAssignment.uzivatel_id;\n        const targetBooksResult = await cashbookAPI.listBooks(userId, targetYear, targetMonth);\n\n        // Pokud kniha NEEXISTUJE  zkontrolovat uzaven msce v budoucnosti\n        if (!targetBooksResult.data?.books || targetBooksResult.data.books.length === 0) {\n          const { hasClosedFuture, closedMonths } = await checkForClosedFutureMonths(targetYear, targetMonth);\n\n          if (hasClosedFuture) {\n            // Existuj uzaven msce  BLOKOVAT vytvoen nov knihy v minulosti\n            setRetroactiveCreationBlockedDialogOpen(true);\n            return; // ZASTAVIT navigaci\n          }\n        }\n        // Pokud kniha EXISTUJE  povolit navigaci (jen prohlen)\n      } catch (error) {\n        console.error(' Chyba pi kontrole existence knihy:', error);\n        // V ppad chyby povolit navigaci\n      }\n    }\n\n    // Uloit aktuln msc ped pepnutm\n    const dataToSave = {\n      entries: cashBookEntries.map(entry => ({ ...entry, isEditing: false })),\n      carryOverAmount: carryOverAmount,\n      lastModified: new Date().toISOString()\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n\n    // Pepnout msc\n    setCurrentMonth(targetMonth);\n    setCurrentYear(targetYear);\n  };\n\n  // Navigace na nsledujc msc (max do aktulnho msce)\n  const goToNextMonth = () => {\n    const today = new Date();\n    const currentSystemMonth = today.getMonth() + 1;\n    const currentSystemYear = today.getFullYear();\n\n    // Neumonit jt dl ne aktuln msc\n    if (currentYear === currentSystemYear && currentMonth === currentSystemMonth) {\n      showToast('Nelze pejt do budoucnosti', 'warning');\n      return;\n    }\n\n    // Uloit aktuln msc ped pepnutm\n    const dataToSave = {\n      entries: cashBookEntries.map(entry => ({ ...entry, isEditing: false })),\n      carryOverAmount: carryOverAmount,\n      lastModified: new Date().toISOString()\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n\n    // Pepnout msc\n    if (currentMonth === 12) {\n      setCurrentMonth(1);\n      setCurrentYear(prev => prev + 1);\n    } else {\n      setCurrentMonth(prev => prev + 1);\n    }\n  };\n\n  // Pejt na aktuln msc\n  const goToCurrentMonth = () => {\n    // Uloit souasn msc ped pepnutm\n    const dataToSave = {\n      entries: cashBookEntries.map(entry => ({ ...entry, isEditing: false })),\n      carryOverAmount: carryOverAmount,\n      lastModified: new Date().toISOString()\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n\n    const today = new Date();\n    setCurrentMonth(today.getMonth() + 1);\n    setCurrentYear(today.getFullYear());\n  };\n\n  // Pidn novho dku\n  const addNewEntry = () => {\n    const newId = Date.now();\n\n    // Urit sprvn datum: pokud jsme v minulm msci, pout posledn den toho msce\n    const today = new Date();\n    const isCurrentMonth = currentYear === today.getFullYear() && currentMonth === (today.getMonth() + 1);\n\n    let defaultDate;\n    if (isCurrentMonth) {\n      // Aktuln msc - dnen datum\n      defaultDate = getTodayDate();\n    } else {\n      // Minul msc - posledn den toho msce\n      const lastDayOfMonth = new Date(currentYear, currentMonth, 0); // Den 0 = posledn den pedchozho msce\n      const year = lastDayOfMonth.getFullYear();\n      const month = String(lastDayOfMonth.getMonth() + 1).padStart(2, '0');\n      const day = String(lastDayOfMonth.getDate()).padStart(2, '0');\n      defaultDate = `${year}-${month}-${day}`;\n    }\n\n    const newEntry = {\n      id: newId,\n      date: defaultDate,\n      documentNumber: \"\", // Ponechme przdn, vypln se automaticky podle typu\n      description: \"\",\n      person: \"\",\n      income: null,\n      expense: null,\n      balance: totals.currentBalance,\n      lpCode: \"\",\n      note: \"\",\n      isEditing: true,\n      //  MULTI-LP: Poddky s LP kdy\n      detailItems: [], // Pole {popis, castka, lp_kod, lp_popis}\n      hasDetails: false // Flag zda m poddky\n    };\n\n    setCashBookEntries(prev => [...prev, newEntry]);\n\n    //  OPTIMALIZACE: requestAnimationFrame pro focus (browser-friendly)\n    requestAnimationFrame(() => {\n      const descriptionInput = document.querySelector(`input[data-entry-id=\"${newId}\"][data-field=\"description\"]`);\n      if (descriptionInput) {\n        descriptionInput.focus();\n      }\n    });\n\n    return newId;\n  };\n\n  //  CASHBOX SELECTOR: Handler pro zmnu pokladny\n  const handleCashboxChange = useCallback(async (newAssignment) => {\n    if (!newAssignment || newAssignment.id === mainAssignment?.id) {\n      return; // Stejn pokladna, nic nedlat\n    }\n\n    // Nastavit novou pokladnu\n    setMainAssignment(newAssignment);\n\n    //  Uloit vbr pokladny do localStorage (hlavn pro adminy)\n    try {\n      const saveData = {\n        id: newAssignment.id,\n        cislo_pokladny: newAssignment.cislo_pokladny,\n        uzivatel_id: newAssignment.uzivatel_id\n      };\n      localStorage.setItem('cashbook_selector_cashbox', JSON.stringify(saveData));\n    } catch (err) {\n      // Tich chyba - nen kritick\n    }\n\n    // Vymazat aktuln data\n    setCashBookEntries([]);\n    setCurrentBookId(null);\n    setCarryOverAmount(0);\n\n    // Force reload - data se natou automaticky v useEffect kter sleduje mainAssignment\n    showToast(`Pepnuto na pokladnu ${newAssignment.cislo_pokladny} - ${newAssignment.nazev_pracoviste || newAssignment.nazev}`, 'success');\n  }, [mainAssignment, showToast]);\n\n  // Handler pro tlatko \"Pidat nov dek\" - stejn logika jako Shift+Insert\n  const handleAddNewRow = () => {\n    // Najt editovan dek\n    const editingEntry = cashBookEntries.find(entry => entry.isEditing);\n\n    if (editingEntry) {\n      // Kontrola, zda je dek przdn\n      const isEmpty = (\n        !editingEntry.documentNumber &&\n        !editingEntry.description &&\n        !editingEntry.person &&\n        !editingEntry.income &&\n        !editingEntry.expense &&\n        !editingEntry.lpCode &&\n        !editingEntry.note\n      );\n\n      if (isEmpty) {\n        // Przdn dek - jen pesu focus na \"Obsah zpisu\"\n        requestAnimationFrame(() => {\n          const descriptionInput = document.querySelector(`input[data-entry-id=\"${editingEntry.id}\"][data-field=\"description\"]`);\n          if (descriptionInput) {\n            descriptionInput.focus();\n          }\n        });\n      } else {\n        // dek m njak obsah - ulo ho a pidej nov\n\n        //  OPTIMALIZACE: Synchronn update pomoc flushSync\n        ReactDOM.flushSync(() => {\n          // Ukoni editaci vech dk (automaticky se ulo)\n          setCashBookEntries(prev =>\n            prev.map(entry => ({ ...entry, isEditing: false }))\n          );\n        });\n\n        // Okamit ulo a pidej nov dek\n        autoSave();\n        addNewEntry();\n      }\n    } else {\n      // dn dek nen editovn, rovnou pidej nov\n      addNewEntry();\n    }\n  };\n\n  // Odstrann dku - oteve ConfirmDialog\n  const removeEntry = (id) => {\n    setEntryToDelete(id);\n    setDeleteDialogOpen(true);\n  };\n\n  // Potvrzen smazn dku\n  const handleConfirmDelete = async () => {\n    if (entryToDelete) {\n      const entry = cashBookEntries.find(e => e.id === entryToDelete);\n\n      // Odstranit z frontendu\n      setCashBookEntries(prev => prev.filter(entry => entry.id !== entryToDelete));\n\n      // Pokud m DB ID, smazat i z DB\n      if (entry?.db_id) {\n        try {\n          await cashbookAPI.deleteEntry(entry.db_id);\n          showToast('Poloka byla smazna z databze', 'success');\n        } catch (error) {\n          console.error(' Chyba pi mazn z DB:', error);\n          showToast('Chyba pi mazn z databze', 'error');\n        }\n      } else {\n        showToast('Poloka byla odstranna', 'success');\n      }\n\n      // Uloit zmny do localStorage\n      const updatedEntries = cashBookEntries.filter(e => e.id !== entryToDelete);\n      saveToLocalStorage(updatedEntries, bookStatus, carryOverAmount);\n    }\n    setDeleteDialogOpen(false);\n    setEntryToDelete(null);\n  };\n\n  // Zruen smazn dku\n  const handleCancelDelete = () => {\n    setDeleteDialogOpen(false);\n    setEntryToDelete(null);\n  };\n\n  // Zapnut editace dku\n  const startEditing = (id) => {\n    setCashBookEntries(prev =>\n      prev.map(entry =>\n        entry.id === id ? { ...entry, isEditing: true } : entry\n      )\n    );\n  };\n\n  // Ukonen editace dku\n  const stopEditing = async (id) => {\n    const editedEntry = cashBookEntries.find(e => e.id === id);\n    if (!editedEntry) return;\n\n    //  VALIDACE: Pokud je entry przdn (nem popis), zruit ji msto ukldn\n    const isEmpty = !editedEntry.description?.trim() && \n                    !editedEntry.income && \n                    !editedEntry.expense && \n                    (!editedEntry.detailItems || editedEntry.detailItems.length === 0);\n    \n    if (isEmpty) {\n      // Pokud je to nov zznam (nem db_id), smazat ho\n      if (!editedEntry.db_id) {\n        setCashBookEntries(prev => {\n          const filtered = prev.filter(entry => entry.id !== id);\n          \n          // Uloit zmny do localStorage\n          const dataToSave = {\n            entries: filtered.map(entry => ({ ...entry, isEditing: false })),\n            carryOverAmount: carryOverAmount,\n            lastModified: new Date().toISOString()\n          };\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n          \n          return filtered;\n        });\n        return;\n      } else {\n        // Pokud existuje v DB, jen zruit editaci (obnovit pvodn data)\n        cancelEditing(id);\n        return;\n      }\n    }\n\n    //  VALIDACE: Zkontrolovat, jestli prefix sla dokladu odpovd typu (pjem/vdaj)\n    let documentNumber = editedEntry.documentNumber;\n    const hasIncome = editedEntry.income && editedEntry.income > 0;\n    const hasExpense = editedEntry.expense && editedEntry.expense > 0;\n    let typeChanged = false;\n\n    //  Pokud nem slo dokladu a m pjem/vdaj, vygenerovat nov slo\n    if (!documentNumber && (hasIncome || hasExpense)) {\n      const shouldBeP = hasIncome && !hasExpense;\n      const shouldBeV = hasExpense && !hasIncome;\n\n      if (shouldBeP) {\n        // Vygenerovat nov P slo\n        const currentMonthPNumbers = cashBookEntries\n          .filter(e => e.id !== id && e.documentNumber?.startsWith('P'))\n          .map(e => parseInt(e.documentNumber.substring(1)) || 0);\n\n        let nextP;\n        if (currentMonthPNumbers.length > 0) {\n          nextP = Math.max(...currentMonthPNumbers) + 1;\n        } else {\n          const { lastP } = await getLastDocumentNumbersFromPreviousMonth();\n          nextP = lastP + 1;\n        }\n\n        documentNumber = `P${String(nextP).padStart(3, '0')}`;\n        typeChanged = true;\n        console.log(` Nov entry - vygenerovno slo: ${documentNumber}`);\n\n      } else if (shouldBeV) {\n        // Vygenerovat nov V slo\n        const currentMonthVNumbers = cashBookEntries\n          .filter(e => e.id !== id && e.documentNumber?.startsWith('V'))\n          .map(e => parseInt(e.documentNumber.substring(1)) || 0);\n\n        let nextV;\n        if (currentMonthVNumbers.length > 0) {\n          nextV = Math.max(...currentMonthVNumbers) + 1;\n        } else {\n          const { lastV } = await getLastDocumentNumbersFromPreviousMonth();\n          nextV = lastV + 1;\n        }\n\n        documentNumber = `V${String(nextV).padStart(3, '0')}`;\n        typeChanged = true;\n        console.log(` Nov entry - vygenerovno slo: ${documentNumber}`);\n      }\n    }\n\n    // Validace existujcho sla dokladu\n    if (documentNumber && !typeChanged) {\n      const currentPrefix = documentNumber.charAt(0);\n      const shouldBeP = hasIncome && !hasExpense;\n      const shouldBeV = hasExpense && !hasIncome;\n\n      // Pokud je prefix patn, opravit ho\n      if (shouldBeP && currentPrefix !== 'P') {\n        // Zmna z V na P - vygenerovat nov P slo\n        // 1. Najt nejvy P slo v aktulnm msci\n        const currentMonthPNumbers = cashBookEntries\n          .filter(e => e.id !== id && e.documentNumber?.startsWith('P'))\n          .map(e => parseInt(e.documentNumber.substring(1)) || 0);\n\n        let nextP;\n        if (currentMonthPNumbers.length > 0) {\n          // Pokud u mme P doklady v tomto msci, pokrauj od nejvyho\n          nextP = Math.max(...currentMonthPNumbers) + 1;\n        } else {\n          // Pokud jet nemme dn P doklady, nati posledn z pedchozho msce\n          const { lastP } = await getLastDocumentNumbersFromPreviousMonth();\n          nextP = lastP + 1;\n        }\n\n        documentNumber = `P${String(nextP).padStart(3, '0')}`;\n        typeChanged = true;\n        console.log(` Zmna typu: V  P, nov slo: ${documentNumber}`);\n        showToast(`Zmna typu dokladu: vdaj  pjem. Nov slo: ${documentNumber}`, 'info');\n\n      } else if (shouldBeV && currentPrefix !== 'V') {\n        // Zmna z P na V - vygenerovat nov V slo\n        // 1. Najt nejvy V slo v aktulnm msci\n        const currentMonthVNumbers = cashBookEntries\n          .filter(e => e.id !== id && e.documentNumber?.startsWith('V'))\n          .map(e => parseInt(e.documentNumber.substring(1)) || 0);\n\n        let nextV;\n        if (currentMonthVNumbers.length > 0) {\n          // Pokud u mme V doklady v tomto msci, pokrauj od nejvyho\n          nextV = Math.max(...currentMonthVNumbers) + 1;\n        } else {\n          // Pokud jet nemme dn V doklady, nati posledn z pedchozho msce\n          const { lastV } = await getLastDocumentNumbersFromPreviousMonth();\n          nextV = lastV + 1;\n        }\n\n        documentNumber = `V${String(nextV).padStart(3, '0')}`;\n        typeChanged = true;\n        console.log(` Zmna typu: P  V, nov slo: ${documentNumber}`);\n        showToast(`Zmna typu dokladu: pjem  vdaj. Nov slo: ${documentNumber}`, 'info');\n      }\n    }\n\n    // Oznait entry jako zmnnou\n    const updatedEntry = {\n      ...editedEntry,\n      documentNumber, // Pout opraven slo dokladu\n      isEditing: false,\n      changed: true,\n      sync_status: 'pending',\n      last_modified_local: new Date().toISOString()\n    };\n\n    setCashBookEntries(prev => {\n      const updatedEntries = prev.map(entry =>\n        entry.id === id ? updatedEntry : entry\n      );\n\n      //  Uloit zmny do localStorage ihned (backup)\n      saveToLocalStorage(updatedEntries, bookStatus, carryOverAmount);\n\n      return updatedEntries;\n    });\n\n    setLastSavedEntryId(id);\n\n    setTimeout(() => {\n      setLastSavedEntryId(null);\n    }, 5000);\n\n    //  Sync do DB na pozad\n    if (currentBookId) {\n      try {\n        const payload = transformFrontendEntryToDB(updatedEntry, currentBookId);\n\n        if (updatedEntry.db_id) {\n          // Update existujc entry\n          console.log(' UPDATE payload:', { entry_id: updatedEntry.db_id, cislo_dokladu: payload.cislo_dokladu, typeChanged });\n          const updateResult = await cashbookAPI.updateEntry(updatedEntry.db_id, payload);\n\n          //  Pokud se zmnil typ (typeChanged), pout slo z frontendu, ne z backendu\n          if (updateResult.status === 'ok') {\n            console.log(' UPDATE result:', { backend_cislo: updateResult.data?.entry?.cislo_dokladu, frontend_cislo: documentNumber, typeChanged });\n            setCashBookEntries(prev => prev.map(e =>\n              e.id === id ? {\n                ...e,\n                // Pokud byl zmnn typ, pout nov slo z frontendu, jinak pout slo z backendu\n                documentNumber: typeChanged ? documentNumber : (updateResult.data?.entry?.cislo_dokladu || e.documentNumber),\n                sync_status: 'synced',\n                changed: false,\n                last_synced_at: new Date().toISOString()\n              } : e\n            ));\n          }\n        } else {\n          // Create novou entry\n          console.log(' CREATE payload:', { cislo_dokladu: payload.cislo_dokladu, typeChanged });\n          const result = await cashbookAPI.createEntry(payload);\n\n          if (result.status === 'ok' && result.data?.entry) {\n            console.log(' CREATE result:', { backend_cislo: result.data?.entry?.cislo_dokladu, frontend_cislo: documentNumber });\n            // Aktualizovat s DB ID a slem dokladu\n            //  Pokud jsme vygenerovali slo na frontendu (typeChanged), pout to, jinak slo z backendu\n            setCashBookEntries(prev => prev.map(e =>\n              e.id === id ? {\n                ...e,\n                db_id: result.data.entry.id,\n                documentNumber: typeChanged ? documentNumber : (result.data.entry.cislo_dokladu || documentNumber),\n                sync_status: 'synced',\n                changed: false,\n                last_synced_at: new Date().toISOString()\n              } : e\n            ));\n          }\n        }\n\n        // Update totals v DB\n        const totalIncome = cashBookEntries.reduce((sum, e) => sum + (e.income || 0), 0);\n        const totalExpenses = cashBookEntries.reduce((sum, e) => sum + (e.expense || 0), 0);\n        const endBalance = carryOverAmount + totalIncome - totalExpenses;\n\n        await cashbookAPI.updateBook(currentBookId, {\n          celkove_prijmy: totalIncome,\n          celkove_vydaje: totalExpenses,\n          koncovy_stav: endBalance\n        });\n\n      } catch (error) {\n        console.error(' Chyba pi ukldn do DB:', error);\n        showToast('Uloeno lokln, sync do DB selhala: ' + error.message, 'warning');\n\n        // Oznait jako error\n        setCashBookEntries(prev => prev.map(e =>\n          e.id === id ? { ...e, sync_status: 'error' } : e\n        ));\n      }\n    }\n  };\n\n  // Zruen editace dku bez uloen (ESC)\n  const cancelEditing = (id) => {\n    const originalEntry = cashBookEntries.find(entry => entry.id === id);\n\n    // Pokud je to nov dek (jet neuloen), pln ho smaeme\n    if (originalEntry && !originalEntry.description && !originalEntry.documentNumber) {\n      setCashBookEntries(prev => {\n        const filtered = prev.filter(entry => entry.id !== id);\n\n        // Uloit zmny do localStorage ihned po smazn\n        const dataToSave = {\n          entries: filtered.map(entry => ({ ...entry, isEditing: false })),\n          carryOverAmount: carryOverAmount,\n          lastModified: new Date().toISOString()\n        };\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n\n        return filtered;\n      });\n    } else {\n      // Jinak jen ukonme editaci\n      setCashBookEntries(prev =>\n        prev.map(entry =>\n          entry.id === id ? { ...entry, isEditing: false } : entry\n        )\n      );\n    }\n  };\n\n  // Handler pro Shift+Enter (uloit) a ESC (zruit)\n  const handleKeyDown = (e, entryId) => {\n    if (e.key === 'Enter' && e.shiftKey) {\n      e.preventDefault();\n      stopEditing(entryId);\n    } else if (e.key === 'Escape') {\n      e.preventDefault();\n      cancelEditing(entryId);\n    }\n  };\n\n  // Aktualizace hodnoty v dku s validacemi\n  const updateEntry = (id, field, value) => {\n    setCashBookEntries(prev => {\n      const newEntries = prev.map(entry => {\n        if (entry.id !== id) return entry;\n\n        let processedValue = value;\n\n        // Validace pro rzn typy pol\n        if (field === 'income' || field === 'expense') {\n          // Zajistit, e druh pole je przdn\n          // slo dokladu se pepot automaticky v derived state\n          const updatedEntry = { ...entry, [field]: processedValue };\n          if (field === 'income') {\n            updatedEntry.expense = null;\n          } else {\n            updatedEntry.income = null;\n          }\n          return updatedEntry;\n        }\n\n        // Validace data\n        if (field === 'date') {\n          const today = new Date();\n          const entryDate = new Date(value);\n\n          // Varovn pokud je datum v budoucnosti\n          if (entryDate > today) {\n            showToast('Pozor: Datum je v budoucnosti', 'warning');\n          }\n        }\n\n        // Poznmka: slo dokladu se negeneruje manuln - je automatick\n\n        return { ...entry, [field]: processedValue };\n      });\n\n      // Pepotn zstatk pro vechny zznamy\n      if (field === 'income' || field === 'expense') {\n        let runningBalance = initialBalance;\n        return newEntries.map(entry => {\n          if (entry.income) runningBalance += entry.income;\n          if (entry.expense) runningBalance -= entry.expense;\n          return { ...entry, balance: runningBalance };\n        });\n      }\n\n      return newEntries;\n    });\n  };\n\n  // Auto-save do localStorage bez ukonen editace (pro onBlur)\n  const autoSave = () => {\n    try {\n      const dataToSave = {\n        entries: cashBookEntries,\n        carryOverAmount: carryOverAmount,\n        lastModified: new Date().toISOString()\n      };\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n    } catch (error) {\n      console.error('Chyba pi auto-ukldn do localStorage:', error);\n    }\n  };\n\n  // Export do rznch formt\n  const exportData = (format) => {\n    try {\n      const filename = `Pokladni_kniha_${organizationInfo.workplace}_${organizationInfo.month}_${organizationInfo.year}`;\n\n      if (format === 'CSV') {\n        exportToCSV(filename);\n      } else if (format === 'PDF') {\n        generatePDFReport(filename);\n      }\n    } catch (error) {\n      showToast('Chyba pi exportu dat', 'error');\n    }\n  };\n\n  // Export do CSV\n  const exportToCSV = (filename) => {\n    // Hlavika tabulky\n    const headers = [\n      'dek', 'Datum', 'slo dokladu', 'Obsah zpisu', 'Komu/Od koho',\n      'Pjmy (K)', 'Vdaje (K)', 'Zstatek (K)', 'LP kd', 'Poznmka'\n    ];\n\n    // Data dk\n    const rows = cashBookEntries.map((entry, index) => [\n      index + 1,\n      formatDate(entry.date),\n      entry.documentNumber || '',\n      `\"${(entry.description || '').replace(/\"/g, '\"\"')}\"`, // Escapovn uvozovek\n      `\"${(entry.person || '').replace(/\"/g, '\"\"')}\"`,\n      entry.income ? entry.income.toFixed(2) : '',\n      entry.expense ? entry.expense.toFixed(2) : '',\n      entry.balance.toFixed(2),\n      entry.lpCode || '',\n      `\"${(entry.note || '').replace(/\"/g, '\"\"')}\"`\n    ]);\n\n    // Sestaven CSV obsahu (hlavika + dky)\n    const csvContent = [\n      headers.join(';'),\n      ...rows.map(row => row.join(';'))\n    ].join('\\n');\n\n    // BOM pro sprvn zobrazen etiny v Excelu\n    const BOM = '\\uFEFF';\n    const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });\n\n    // Staen souboru\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = `${filename}.csv`;\n    link.click();\n    URL.revokeObjectURL(link.href);\n\n    showToast('CSV soubor byl exportovn', 'success');\n  };\n\n  // Generovn PDF reportu\n  const generatePDFReport = async (filename) => {\n    try {\n      // Pprava informac o genertorovi PDF\n      const generatedBy = {\n        fullName: `${userDetail?.titul_pred || ''} ${userDetail?.jmeno || ''} ${userDetail?.prijmeni || ''} ${userDetail?.titul_za || ''}`.trim(),\n        usekZkr: userDetail?.usek_zkr?.[0] || '',\n        lokalita: getUserLocation(),\n      };\n\n      // Vytvoen PDF dokumentu pomoc @react-pdf/renderer\n      const blob = await pdf(\n        <PokladniKnihaPDF\n          organizationInfo={{\n            organizationName: organizationInfo.organizationName,\n            workplace: getUserLocation(),\n            cashboxNumber: organizationInfo.cashboxNumber,\n            month: organizationInfo.month,\n            year: organizationInfo.year,\n          }}\n          carryOverAmount={carryOverAmount}\n          totals={totals}\n          entries={cashBookEntries}\n          generatedBy={generatedBy}\n          bookStatus={{\n            status: bookStatus,\n            closedDate: bookStatusMetadata?.closedDate,\n            closedBy: bookStatusMetadata?.closedBy,\n            lockedDate: bookStatusMetadata?.lockedDate,\n            lockedBy: bookStatusMetadata?.lockedBy,\n          }}\n        />\n      ).toBlob();\n\n      // Vytvoen URL pro blob a staen\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `${filename}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n\n      showToast('PDF report byl spn vygenerovn', 'success');\n    } catch (error) {\n      console.error('Chyba pi generovn PDF:', error);\n      showToast('Chyba pi generovn PDF reportu', 'error');\n    }\n  };\n\n  // Tisk pomoc PDF (oteve PDF v novm okn pro tisk)\n  const printPDFReport = async () => {\n    try {\n      // Pprava informac o genertorovi PDF\n      const generatedBy = {\n        fullName: `${userDetail?.titul_pred || ''} ${userDetail?.jmeno || ''} ${userDetail?.prijmeni || ''} ${userDetail?.titul_za || ''}`.trim(),\n        usekZkr: userDetail?.usek_zkr?.[0] || '',\n        lokalita: getUserLocation(),\n      };\n\n      // Vytvoen PDF dokumentu pomoc @react-pdf/renderer\n      const blob = await pdf(\n        <PokladniKnihaPDF\n          organizationInfo={{\n            organizationName: organizationInfo.organizationName,\n            workplace: getUserLocation(),\n            cashboxNumber: organizationInfo.cashboxNumber,\n            month: organizationInfo.month,\n            year: organizationInfo.year,\n          }}\n          carryOverAmount={carryOverAmount}\n          totals={totals}\n          entries={cashBookEntries}\n          generatedBy={generatedBy}\n          bookStatus={{\n            status: bookStatus,\n            closedDate: bookStatusMetadata?.closedDate,\n            closedBy: bookStatusMetadata?.closedBy,\n            lockedDate: bookStatusMetadata?.lockedDate,\n            lockedBy: bookStatusMetadata?.lockedBy,\n          }}\n        />\n      ).toBlob();\n\n      // Vytvoen URL pro blob a oteven v novm okn pro tisk\n      const url = URL.createObjectURL(blob);\n      const printWindow = window.open(url, '_blank');\n\n      if (printWindow) {\n        // Pokat ne se PDF nate a otevt tiskov dialog\n        printWindow.onload = () => {\n          printWindow.print();\n          // URL se uvoln a po zaven okna\n          printWindow.onafterprint = () => {\n            URL.revokeObjectURL(url);\n          };\n        };\n      } else {\n        // Pokud se nepodailo otevt okno, uvolni URL\n        URL.revokeObjectURL(url);\n        showToast('Nepodailo se otevt tiskov dialog. Zkontrolujte blokovn vyskakovacch oken.', 'error');\n      }\n    } catch (error) {\n      console.error('Chyba pi tisku PDF:', error);\n      showToast('Chyba pi pprav tisku', 'error');\n    }\n  };\n\n  // ============================================================================\n  // HIERARCHIE OPRVNN PRO POKLADN KNIHU\n  // ============================================================================\n  //\n  // Hierarchie (sestupn):\n  // 1. SUPERADMIN/ADMINISTRATOR  me ve\n  // 2. CASH_BOOK_MANAGE  kompletn sprva vech pokladnch knih\n  // 3. *_ALL oprvnn  pstup ke vem pokladnm knihm\n  // 4. *_OWN oprvnn  pstup pouze ke vlastn pokladn knize\n  //\n  // Vlastnictv pokladn knihy = cel kniha za msc jednoho uivatele\n  // ============================================================================\n\n  // 1. Kontrola superadmin/admin role\n  const isSuperAdmin = userDetail?.roles?.some(r =>\n    r.kod_role === 'SUPERADMIN' || r.kod_role === 'ADMINISTRATOR'\n  );\n\n  // 2. Kontrola MANAGE oprvnn (me ve)\n  const hasManagePermission = hasPermission && hasPermission('CASH_BOOK_MANAGE');\n\n  // 3. Kontrola _ALL oprvnn (vechny pokladn knihy)\n  const canReadAll = hasPermission && hasPermission('CASH_BOOK_READ_ALL');\n  const canEditAll = hasPermission && hasPermission('CASH_BOOK_EDIT_ALL');\n  const canDeleteAll = hasPermission && hasPermission('CASH_BOOK_DELETE_ALL');\n  const canExportAll = hasPermission && hasPermission('CASH_BOOK_EXPORT_ALL');\n\n  // 4. Kontrola _OWN oprvnn (pouze vlastn pokladna)\n  const canReadOwn = hasPermission && hasPermission('CASH_BOOK_READ_OWN');\n  const canEditOwn = hasPermission && hasPermission('CASH_BOOK_EDIT_OWN');\n  const canDeleteOwn = hasPermission && hasPermission('CASH_BOOK_DELETE_OWN');\n  const canExportOwn = hasPermission && hasPermission('CASH_BOOK_EXPORT_OWN');\n\n  // 5. Kontrola CREATE oprvnn (spolen pro vlastn i vechny)\n  const canCreate = hasPermission && hasPermission('CASH_BOOK_CREATE');\n\n  // 6. Zjistit, jestli aktuln zobrazen pokladna pat pihlenmu uivateli\n  // UPRAVENO: Kontroluje nejen vlastnka, ale i piazen jako zstupce\n  const isCurrentUserCashbook = useMemo(() => {\n    if (!mainAssignment || !userDetail) return false;\n\n    // Kontrola 1: Je uivatel vlastnkem tto pokladny?\n    const isOwner = String(mainAssignment.uzivatel_id) === String(userDetail.id);\n\n    // Kontrola 2: Je uivatel piazen k tto pokladn (hlavn nebo zstupce)?\n    const isAssignedToThisCashbox = userAssignments?.some(assignment => {\n      return String(assignment.pokladna_id) === String(mainAssignment.pokladna_id) &&\n             String(assignment.uzivatel_id) === String(userDetail.id);\n    });\n\n    return isOwner || isAssignedToThisCashbox;\n  }, [mainAssignment, userDetail, userAssignments]);\n\n  //  CENTRLN FUNKCE PRO KONTROLU EDITOVATELNOSTI\n  // d VE - stav knihy (uzaven/zamen) + oprvnn\n  const isBookEditable = useMemo(() => {\n    // 1. Kontrola stavu knihy - uzaven nebo zamen\n    const isLocked = bookStatus === 'uzavrena_uzivatelem' || bookStatus === 'zamknuta_spravcem';\n\n    // 2.  ZAMEN/UZAVEN KNIHA  NIKDO NEME EDITOVAT!\n    //    Admin/MANAGE me jen ODEMKNOUT, ale dokud je zamen, NESM editovat poloky!\n    if (isLocked) {\n      return false;\n    }\n\n    // 3. Kniha je AKTIVN  kontrola bnch oprvnn\n    // Me editovat: SuperAdmin, MANAGE, EDIT_ALL, nebo (EDIT_OWN + vlastn pokladna)\n    return isSuperAdmin ||\n           hasManagePermission ||\n           canEditAll ||\n           (canEditOwn && isCurrentUserCashbook);\n  }, [bookStatus, isSuperAdmin, hasManagePermission, canEditAll, canEditOwn, isCurrentUserCashbook]);\n\n  //  Odvozen hodnoty z centrln funkce\n  const canViewCashBook = isSuperAdmin || hasManagePermission || canReadAll || (canReadOwn && isCurrentUserCashbook);\n  const canActuallyEdit = isBookEditable;\n  const canActuallyDelete = isBookEditable; // Stejn logika jako edit\n  const canActuallyCreate = isBookEditable; // Stejn logika jako edit\n  const canExportCashBook = isSuperAdmin || hasManagePermission || canExportAll || (canExportOwn && isCurrentUserCashbook);\n\n  // Pro kompatibilitu - budget oprvnn zstv\n  const canEditBudget = hasPermission && hasPermission('BUDGET_MANAGE');\n\n  //  Helper: Kontrola, zda lze msc uzavt/zamknout (mus bt ukonen)\n  // Nap. listopad 2025 lze uzavt a 1.12.2025\n  const canCloseCurrentPeriod = useMemo(() => {\n    const today = new Date();\n    const todayYear = today.getFullYear();\n    const todayMonth = today.getMonth() + 1; // 1-12\n\n    // Pokud je zobrazen msc v minulosti, lze uzavt\n    if (currentYear < todayYear) return true;\n    if (currentYear === todayYear && currentMonth < todayMonth) return true;\n\n    // Pokud je zobrazen msc aktuln nebo budouc, NELZE uzavt\n    return false;\n  }, [currentYear, currentMonth]);\n\n  //  KROK 3: Funkce pro workflow uzavrn - OTEVE DIALOG\n  const handleCloseMonth = () => {\n    if (!hasManagePermission && !(canEditOwn && isCurrentUserCashbook)) {\n      showToast('Nemte oprvnn uzavt tento msc', 'error');\n      return;\n    }\n\n    if (!canCloseCurrentPeriod) {\n      showToast('Nelze uzavt aktuln msc. Uzavt lze a od 1. dne nsledujcho msce.', 'warning');\n      return;\n    }\n\n    if (!currentBookId) {\n      showToast('Chyba: Kniha nen natena', 'error');\n      return;\n    }\n\n    // Otevt confirm dialog\n    setCloseMonthDialogOpen(true);\n  };\n\n  //  Peslovn vech entries v aktulnm a nsledujcch mscch\n  const renumberAllFutureMonths = async () => {\n    if (!mainAssignment?.uzivatel_id) return;\n\n    try {\n      // Zskat vechny knihy od aktulnho msce do budoucnosti\n      const allBooksResult = await cashbookAPI.listBooks(mainAssignment.uzivatel_id);\n\n      if (allBooksResult.status !== 'ok') {\n        throw new Error('Backend vrtil chybu: ' + (allBooksResult.message || 'neznm'));\n      }\n\n      // Backend me vracet rzn struktury - zkusme najt pole knih\n      let booksArray = null;\n\n      if (Array.isArray(allBooksResult.data)) {\n        booksArray = allBooksResult.data;\n      } else if (allBooksResult.data?.books && Array.isArray(allBooksResult.data.books)) {\n        booksArray = allBooksResult.data.books;\n      } else if (allBooksResult.books && Array.isArray(allBooksResult.books)) {\n        booksArray = allBooksResult.books;\n      }\n\n      if (!booksArray) {\n        console.error(' Nepodailo se najt pole knih v odpovdi:', allBooksResult);\n        throw new Error('Backend nevrtil pole knih');\n      }\n\n      // Filtrovat knihy >= aktuln msc a seadit chronologicky\n      const futureBooks = booksArray.filter(book => {\n        const bookDate = new Date(book.rok, book.mesic - 1);\n        const currentDate = new Date(currentYear, currentMonth - 1);\n        return bookDate >= currentDate;\n      }).sort((a, b) => {\n        if (a.rok !== b.rok) return a.rok - b.rok;\n        return a.mesic - b.mesic;\n      });\n\n      //  Nejprve zjistit posledn P/V sla z PEDCHOZHO msce (ped aktulnm)\n      const { lastP: prevLastP, lastV: prevLastV } = await getLastDocumentNumbersFromPreviousMonth();\n      let lastP = prevLastP;\n      let lastV = prevLastV;\n\n      // Projt vechny knihy chronologicky\n      for (const book of futureBooks) {\n\n        // Nast vechny entries pro tuto knihu pomoc getBook()\n        const bookResult = await cashbookAPI.getBook(book.id, false); // force_recalc = false\n\n        if (bookResult.status !== 'ok' || !bookResult.data?.entries) {\n          console.warn(` Nepodailo se nast entries pro knihu ${book.id}`);\n          continue;\n        }\n\n        const entries = bookResult.data.entries;\n\n        // Seadit entries podle data\n        const sortedEntries = [...entries].sort((a, b) => {\n          const dateA = new Date(a.datum_zapisu);\n          const dateB = new Date(b.datum_zapisu);\n          return dateA - dateB;\n        });\n\n        // Peslovat entries\n        for (const entry of sortedEntries) {\n          const hasIncome = entry.castka_prijem && parseFloat(entry.castka_prijem) > 0;\n          const hasExpense = entry.castka_vydaj && parseFloat(entry.castka_vydaj) > 0;\n\n          let newNumber = null;\n\n          if (hasIncome && !hasExpense) {\n            // Pjem - pout P\n            lastP++;\n            newNumber = `P${String(lastP).padStart(3, '0')}`;\n          } else if (hasExpense && !hasIncome) {\n            // Vdaj - pout V\n            lastV++;\n            newNumber = `V${String(lastV).padStart(3, '0')}`;\n          }\n\n          // Pokud se slo zmnilo, aktualizovat v DB\n          if (newNumber && newNumber !== entry.cislo_dokladu) {\n            console.log(`   ${entry.cislo_dokladu}  ${newNumber}`);\n            //  FIX: RAW data z API maj 'id', ne 'db_id'\n            await cashbookAPI.updateEntry(entry.id, {\n              cislo_dokladu: newNumber\n            });\n          }\n        }\n      }\n\n      return { success: true, lastP, lastV };\n\n    } catch (error) {\n      console.error(' Chyba pi peslovn:', error);\n      return { success: false, error: error.message };\n    }\n  };\n\n  //  Potvrzen uzaven msce (volno z dialogu)\n  const confirmCloseMonth = async () => {\n    setCloseMonthDialogOpen(false);\n\n    try {\n      //  KROK 0: Zkontrolovat aktuln stav knihy ped operac\n      const bookCheckResult = await cashbookAPI.getBook(currentBookId, false);\n      if (bookCheckResult.status === 'ok' && bookCheckResult.data?.stav_knihy) {\n        const currentState = bookCheckResult.data.stav_knihy;\n        \n        if (currentState !== 'aktivni') {\n          // Kniha u je uzaven - synchronizovat stav ve frontendu\n          setBookStatus(currentState);\n          showToast(`Kniha je ji ve stavu: ${currentState}`, 'warning');\n          return;\n        }\n      }\n\n      //  KROK 1: Nejprve peslovat vechny knihy od aktuln do budoucna\n      showToast('Probh peslovn doklad...', 'info');\n      const renumberResult = await renumberAllFutureMonths();\n\n      if (!renumberResult.success) {\n        throw new Error(`Chyba pi peslovn: ${renumberResult.error}`);\n      }\n\n      showToast(`Peslovn dokoneno (P: ${renumberResult.lastP}, V: ${renumberResult.lastV})`, 'success');\n\n      //  KROK 2: Znovu nast aktuln msc, aby se zobrazily nov slovn\n      const reloadResult = await cashbookAPI.getBook(currentBookId, false);\n      if (reloadResult.status === 'ok' && reloadResult.data?.entries) {\n        const transformedEntries = reloadResult.data.entries.map(transformDBEntryToFrontend);\n        setCashBookEntries(transformedEntries);\n      }\n\n      //  KROK 3: Uzavt msc\n      const result = await cashbookAPI.closeMonth(currentBookId);\n\n      if (result.status === 'ok') {\n        setBookStatus('uzavrena_uzivatelem');\n        showToast('Msc byl spn uzaven', 'success');\n\n        // Synchronizovat do localStorage\n        saveToLocalStorage(cashBookEntries, 'uzavrena_uzivatelem', carryOverAmount);\n      } else {\n        throw new Error(result.message || 'Neznm chyba');\n      }\n    } catch (error) {\n      console.error(' Chyba pi uzavrn msce:', error);\n      showToast('Chyba pi uzavrn msce: ' + error.message, 'error');\n      \n      //  Po chyb znovu nast stav knihy z DB\n      try {\n        const bookCheckResult = await cashbookAPI.getBook(currentBookId, false);\n        if (bookCheckResult.status === 'ok' && bookCheckResult.data?.stav_knihy) {\n          setBookStatus(bookCheckResult.data.stav_knihy);\n        }\n      } catch (recheckError) {\n        console.error('Nepodailo se znovu nast stav knihy:', recheckError);\n      }\n    }\n  };\n\n  const handleLockBook = () => {\n    if (!hasManagePermission) {\n      showToast('Nemte oprvnn zamknout knihu', 'error');\n      return;\n    }\n\n    if (!canCloseCurrentPeriod) {\n      showToast('Nelze zamknout aktuln msc. Zamknout lze a od 1. dne nsledujcho msce.', 'warning');\n      return;\n    }\n\n    if (!currentBookId) {\n      showToast('Chyba: Kniha nen natena', 'error');\n      return;\n    }\n\n    // Otevt confirm dialog\n    setLockBookDialogOpen(true);\n  };\n\n  //  Potvrzen zamknut msce (volno z dialogu)\n  const confirmLockBook = async () => {\n    setLockBookDialogOpen(false);\n\n    try {\n      //  Volat skuten API\n      const result = await cashbookAPI.lockBook(currentBookId);\n\n      if (result.status === 'ok') {\n        setBookStatus('zamknuta_spravcem');\n        showToast('Kniha byla zamena sprvcem', 'success');\n\n        // Synchronizovat do localStorage\n        saveToLocalStorage(cashBookEntries, 'zamknuta_spravcem', carryOverAmount);\n      } else {\n        throw new Error(result.message || 'Neznm chyba');\n      }\n    } catch (error) {\n      console.error(' Chyba pi zamykn knihy:', error);\n      showToast('Chyba pi zamykn knihy: ' + error.message, 'error');\n    }\n  };\n\n  const handleUnlockBook = () => {\n    //  Admin s MANAGE me odemknout cokoli (uzavrena_uzivatelem i zamknuta_spravcem)\n    //  Bn uivatel s EDIT_OWN me odemknout jen svou vlastn uzavrena_uzivatelem knihu\n    //  Bn uivatel NEME odemknout zamknuta_spravcem (ani svou)\n\n    if (bookStatus === 'zamknuta_spravcem' && !hasManagePermission) {\n      showToast('Kniha je zamen sprvcem. Kontaktujte administrtora.', 'error');\n      return;\n    }\n\n    if (bookStatus === 'uzavrena_uzivatelem' && !hasManagePermission && !(canEditOwn && isCurrentUserCashbook)) {\n      showToast('Nemte oprvnn odemknout tento msc', 'error');\n      return;\n    }\n\n    if (!currentBookId) {\n      showToast('Chyba: Kniha nen natena', 'error');\n      return;\n    }\n\n    // Otevt pslun dialog podle stavu knihy\n    if (bookStatus === 'zamknuta_spravcem') {\n      setUnlockBookDialogOpen(true);\n    } else if (bookStatus === 'uzavrena_uzivatelem') {\n      setReopenMonthDialogOpen(true);\n    }\n  };\n\n  //  Confirm handler pro oteven msce (uzavrena_uzivatelem)\n  const confirmReopenMonth = async () => {\n    setReopenMonthDialogOpen(false);\n\n    try {\n      const result = await cashbookAPI.reopenBook(currentBookId);\n\n      if (result.status === 'ok') {\n        setBookStatus('aktivni');\n        showToast('Msc byl znovu oteven', 'success');\n        saveToLocalStorage(cashBookEntries, 'aktivni', carryOverAmount);\n      } else {\n        throw new Error(result.message || 'Neznm chyba');\n      }\n    } catch (error) {\n      console.error(' Chyba pi otevrn msce:', error);\n      showToast('Chyba pi otevrn msce: ' + error.message, 'error');\n    }\n  };\n\n  //  Confirm handler pro odemknut zamenho msce (zamknuta_spravcem)\n  const confirmUnlockBook = async () => {\n    setUnlockBookDialogOpen(false);\n\n    try {\n      const result = await cashbookAPI.reopenBook(currentBookId);\n\n      if (result.status === 'ok') {\n        setBookStatus('aktivni');\n        showToast('Msc byl odemen administrtorem', 'success');\n        saveToLocalStorage(cashBookEntries, 'aktivni', carryOverAmount);\n      } else {\n        throw new Error(result.message || 'Neznm chyba');\n      }\n    } catch (error) {\n      console.error(' Chyba pi odemykn msce:', error);\n      showToast('Chyba pi odemykn msce: ' + error.message, 'error');\n    }\n  };\n\n  // Globln handler pro Shift+Insert (mus bt a po definici canActuallyCreate)\n  useEffect(() => {\n    const handleGlobalKeyDown = async (e) => {\n      if (e.shiftKey && e.key === 'Insert' && canActuallyCreate) {\n        e.preventDefault();\n\n        // Najt editovan dek\n        const editingEntry = cashBookEntries.find(entry => entry.isEditing);\n\n        if (editingEntry) {\n          //  NOV: Ulo aktuln dek do DB (stejn jako Shift+Enter)\n          await stopEditing(editingEntry.id);\n\n          //  OPTIMALIZACE: Okamit pidej nov dek\n          addNewEntry();\n\n          // Focus na prvn pole novho dku pomoc RAF\n          requestAnimationFrame(() => {\n            const firstInput = document.querySelector('.entry-row:last-child input');\n            if (firstInput) {\n              firstInput.focus();\n            }\n          });\n        } else {\n          // dn dek nen editovn, rovnou pidej nov\n          addNewEntry();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleGlobalKeyDown);\n    return () => {\n      document.removeEventListener('keydown', handleGlobalKeyDown);\n    };\n  }, [canActuallyCreate, totals.currentBalance, cashBookEntries, autoSave, addNewEntry]);\n\n  //  CASHBOOK V2: Loading state pi natn piazen\n  //  DLEIT: Kontrola oprvnn MUS bt a PO naten piazen!\n  if (assignmentLoading) {\n    return (\n      <PageContainer>\n        <Header>\n          <h1>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladn kniha\n          </h1>\n          <p className=\"subtitle\">Natn...</p>\n        </Header>\n        <InfoPanel>\n          <div style={{ textAlign: 'center', padding: '2rem' }}>\n            <FontAwesomeIcon icon={faCalculator} size=\"3x\" style={{ color: '#3b82f6', marginBottom: '1rem' }} className=\"fa-spin\" />\n            <h3>Natn piazen pokladny...</h3>\n            <p>Prosm vykejte</p>\n          </div>\n        </InfoPanel>\n      </PageContainer>\n    );\n  }\n\n  //  CASHBOOK V2: Varovn pokud uivatel nem piazenou pokladnu\n  if (!mainAssignment) {\n    return (\n      <PageContainer>\n        <Header>\n          <h1>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladn kniha\n          </h1>\n          <p className=\"subtitle\">Chyba konfigurace</p>\n        </Header>\n        <InfoPanel>\n          <div style={{ textAlign: 'center', padding: '2rem' }}>\n            <FontAwesomeIcon icon={faInfoCircle} size=\"3x\" style={{ color: '#f59e0b', marginBottom: '1rem' }} />\n            <h3>Nemte piazenou pokladnu</h3>\n            <p>Pro prci s pokladn knihou muste mt piazenou alespo jednu pokladnu.</p>\n            <p>Kontaktujte administrtora systmu pro piazen pokladny.</p>\n          </div>\n        </InfoPanel>\n      </PageContainer>\n    );\n  }\n\n  //  Pokud nem oprvnn, zobraz varovn (kontrola a po naten piazen!)\n  if (!canViewCashBook) {\n    return (\n      <PageContainer>\n        <Header>\n          <h1>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladn kniha\n          </h1>\n          <p className=\"subtitle\">Pstup odepen</p>\n        </Header>\n        <InfoPanel>\n          <div style={{ textAlign: 'center', padding: '2rem' }}>\n            <FontAwesomeIcon icon={faInfoCircle} size=\"3x\" style={{ color: '#dc2626', marginBottom: '1rem' }} />\n            <h3>Nedostaten oprvnn</h3>\n            <p>Pro pstup k pokladn knize potebujete oprvnn CASH_BOOK_READ_OWN nebo vy.</p>\n            <p>Kontaktujte sprvce systmu pro udlen potebnch oprvnn.</p>\n          </div>\n        </InfoPanel>\n      </PageContainer>\n    );\n  }\n\n  return (\n    <>\n      <Global styles={printStyles} />\n      <PageContainer>\n        <Header className=\"no-print\">\n          <h1>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladn kniha\n          </h1>\n          <p className=\"subtitle\">\n            {(() => {\n              //  Zskat informace o vlastnkovi pokladny z book objektu (currentBookData)\n              // Backend vrac ve z JOIN: uzivatel_jmeno_plne, lokalita_nazev, usek_nazev\n              const userName = currentBookData?.uzivatel_jmeno_plne ||\n                              currentBookData?.uzivatel_cele_jmeno ||\n                              mainAssignment?.uzivatel_cele_jmeno ||\n                              (mainAssignment?.uzivatel_jmeno && mainAssignment?.uzivatel_prijmeni\n                                ? `${mainAssignment.uzivatel_jmeno} ${mainAssignment.uzivatel_prijmeni}`\n                                : null);\n              const lokalita = currentBookData?.lokalita_nazev || mainAssignment?.lokalita_nazev || mainAssignment?.lokalita_kod;\n              const usek = currentBookData?.usek_nazev || mainAssignment?.usek_nazev;\n              const cashboxNum = organizationInfo.cashboxNumber;\n              const vpd = organizationInfo.cashboxVpd;\n              const ppd = organizationInfo.cashboxPpd;\n\n              return (\n                <>\n                  {userName ? `${userName} | ` : ''}\n                  {lokalita && `${lokalita} | `}\n                  {usek && `${usek} | `}\n                  Pokladna . {cashboxNum}\n                  {vpd && ppd && ` | VPD: ${vpd} | PPD: ${ppd}`}\n                </>\n              );\n            })()}\n          </p>\n        </Header>\n\n        {/*  CASHBOX SELECTOR - Pepnn mezi pokladnami (jen pro uivatele s _ALL oprvnnmi) */}\n        {canSeeAllCashboxes && !assignmentLoading && (\n          <div className=\"no-print\" style={{ marginBottom: '1rem' }}>\n            <CashboxSelector\n              currentCashbox={mainAssignment}\n              userCashboxes={userAssignments}\n              allCashboxes={allAssignments}\n              permissions={cashbookPermissions}\n              canSeeAllCashboxes={canSeeAllCashboxes}\n              onCashboxChange={handleCashboxChange}\n              currentYear={currentYear}\n              currentMonth={currentMonth}\n              onPeriodChange={(year, month) => {\n                setCurrentYear(year);\n                setCurrentMonth(month);\n              }}\n            />\n          </div>\n        )}\n\n        {/*  Sticky kompaktn pehled pi scrollovn */}\n        <StickyCompactSummary $visible={showStickySummary}>\n          <div className=\"compact-title\">\n            <FontAwesomeIcon icon={faCalculator} />\n            Pehled pokladny - {organizationInfo.month} {organizationInfo.year}\n            <BookStatusBadge status={bookStatus} />\n          </div>\n          <div className=\"compact-values\">\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Pevod</div>\n              <div className=\"compact-value\">{formatCurrency(carryOverAmount)}</div>\n            </div>\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Pjmy</div>\n              <div className=\"compact-value positive\">{formatCurrency(totals.totalIncome)}</div>\n            </div>\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Vdaje</div>\n              <div className=\"compact-value negative\">{formatCurrency(totals.totalExpenses)}</div>\n            </div>\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Zstatek</div>\n              <div className={`compact-value ${totals.currentBalance >= 0 ? 'positive' : 'negative'}`}>\n                {formatCurrency(totals.currentBalance)}\n              </div>\n            </div>\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Poet operac</div>\n              <div className=\"compact-value\">{totals.entryCount}</div>\n            </div>\n          </div>\n        </StickyCompactSummary>\n\n        {/* Informan panel */}\n        <InfoPanel className=\"no-print\">\n        <div className=\"organization-info\">\n          <div className=\"info-text\">\n            <h3>\n              <FontAwesomeIcon icon={faInfoCircle} style={{ marginRight: '0.5rem' }} />\n              Pehled pokladny\n              {/*  KROK 3: Status badge pmo u nadpisu */}\n              <span style={{ marginLeft: '1rem', display: 'inline-flex', verticalAlign: 'middle' }}>\n                <BookStatusBadge status={bookStatus} />\n              </span>\n            </h3>\n            <p>Aktuln stav pokladn knihy za msc {organizationInfo.month} {organizationInfo.year}</p>\n          </div>\n\n          {/*  KROK 3: Workflow tlatka vpravo */}\n          {/*  Zobrazit uivatelm s EDIT_OWN (jen pro vlastn knihu) nebo MANAGE (vechny knihy) */}\n          {((canEditOwn && isCurrentUserCashbook) || hasManagePermission) && (\n            <div className=\"info-actions\">\n              {bookStatus === 'aktivni' && (\n                <ActionButton\n                  type=\"button\"\n                  variant=\"warning\"\n                  onClick={handleCloseMonth}\n                  disabled={!canCloseCurrentPeriod}\n                  title={\n                    !canCloseCurrentPeriod\n                      ? `Nelze uzavt aktuln msc. Uzavt lze a od 1. dne nsledujcho msce.`\n                      : \"Uzavt msc - knihu nebude mon editovat\"\n                  }\n                >\n                  <FontAwesomeIcon icon={faCheck} />\n                  Uzavt msc\n                </ActionButton>\n              )}\n\n              {/*  Zamknout me jen sprvce - zobrazit i po uzaven msce */}\n              {hasManagePermission && (bookStatus === 'aktivni' || bookStatus === 'uzavrena_uzivatelem') && (\n                <ActionButton\n                  type=\"button\"\n                  variant=\"danger\"\n                  onClick={handleLockBook}\n                  disabled={!canCloseCurrentPeriod}\n                  title={\n                    !canCloseCurrentPeriod\n                      ? `Nelze zamknout aktuln msc. Zamknout lze a od 1. dne nsledujcho msce.`\n                      : \"Zamknout knihu sprvcem - nelze editovat ani odemknout\"\n                  }\n                >\n                   Zamknout\n                </ActionButton>\n              )}\n\n              {/* Otevt msc me bn uivatel (uzavrena_uzivatelem) nebo sprvce (ve) */}\n              {bookStatus === 'uzavrena_uzivatelem' && (\n                <ActionButton\n                  type=\"button\"\n                  variant=\"primary\"\n                  $filled\n                  onClick={handleUnlockBook}\n                  title=\"Otevt msc pro editaci\"\n                >\n                   Otevt msc\n                </ActionButton>\n              )}\n\n              {/* Zamen sprvcem - jen sprvce me odemknout */}\n              {bookStatus === 'zamknuta_spravcem' && hasManagePermission && (\n                <ActionButton\n                  type=\"button\"\n                  variant=\"primary\"\n                  $filled\n                  onClick={handleUnlockBook}\n                  title=\"Odemknout knihu zamenou sprvcem\"\n                >\n                   Odemknout (Admin)\n                </ActionButton>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"summary-grid\">\n          <div className=\"summary-item info\">\n            <div className=\"label\">Pevod z pedchozho msce</div>\n            <div className=\"value\">{formatCurrency(carryOverAmount)}</div>\n          </div>\n          <div className=\"summary-item positive\">\n            <div className=\"label\">Pjmy v msci</div>\n            <div className=\"value\">{formatCurrency(totals.totalIncome)}</div>\n          </div>\n          <div className=\"summary-item negative\">\n            <div className=\"label\">Vdaje v msci</div>\n            <div className=\"value\">{formatCurrency(totals.totalExpenses)}</div>\n          </div>\n          <div className={`summary-item ${totals.currentBalance >= 0 ? 'positive' : 'negative'}`}>\n            <div className=\"label\">Koncov stav msce</div>\n            <div className=\"value\">{formatCurrency(totals.currentBalance)}</div>\n          </div>\n          <div className=\"summary-item\">\n            <div className=\"label\">Poet operac</div>\n            <div className=\"value\">{totals.entryCount}</div>\n          </div>\n        </div>\n      </InfoPanel>\n\n      {/* Navigace mezi msci */}\n      <MonthNavigation className=\"no-print\">\n        <MonthInfo>\n          <h2>\n            {organizationInfo.month} {organizationInfo.year}\n          </h2>\n        </MonthInfo>\n        <MonthControls>\n          <MonthButton onClick={goToPreviousMonth} title=\"Pedchoz msc\">\n            <FontAwesomeIcon icon={faChevronLeft} />\n            Pedchoz\n          </MonthButton>\n          <MonthButton\n            onClick={goToCurrentMonth}\n            disabled={currentMonth === new Date().getMonth() + 1 && currentYear === new Date().getFullYear()}\n            title=\"Aktuln msc\"\n          >\n            <FontAwesomeIcon icon={faCalendarDay} />\n            Nyn\n          </MonthButton>\n          <MonthButton\n            onClick={goToNextMonth}\n            disabled={currentMonth === new Date().getMonth() + 1 && currentYear === new Date().getFullYear()}\n            title=\"Nsledujc msc\"\n          >\n            Dal\n            <FontAwesomeIcon icon={faChevronRight} />\n          </MonthButton>\n        </MonthControls>\n      </MonthNavigation>\n\n      {/*  Warning box pro oteven pedchoz msc */}\n      {showPreviousMonthWarning && (\n        <PreviousMonthWarning>\n          <WarningIcon>\n            <FontAwesomeIcon icon={faExclamationTriangle} />\n          </WarningIcon>\n          <WarningContent>\n            <h4> Pedchoz msc nen uzaven</h4>\n            <p>\n              <strong>Pozor:</strong> Pedchoz msc (\n              {new Date(\n                currentMonth === 1 ? currentYear - 1 : currentYear,\n                (currentMonth === 1 ? 12 : currentMonth - 1) - 1\n              ).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}) nen uzaven.\n            </p>\n            <p>\n              sla doklad <strong>PPD a VPD</strong> v tomto msci se mohou po uzaven pedchozho msce\n              <strong> automaticky pepotat</strong> pro zachovn sprvn posloupnosti.\n            </p>\n            <p className=\"tip\">\n               Doporuujeme nejprve uzavt pedchoz msce chronologicky od nejstarho.\n            </p>\n          </WarningContent>\n        </PreviousMonthWarning>\n      )}\n\n      {/* Tabulka pokladn knihy */}\n      <div className=\"cashbook-print-area\">\n        {/* Hlavika pro tisk */}\n        <div className=\"print-header\" style={{\n          display: 'none',\n          textAlign: 'center',\n          marginBottom: '2rem',\n          paddingBottom: '1rem',\n          borderBottom: '2px solid #1e40af'\n        }}>\n          <h1 style={{\n            fontSize: '1.8rem',\n            fontWeight: 'bold',\n            color: '#1e40af',\n            margin: '0 0 0.5rem 0'\n          }}>\n            Pokladn kniha\n          </h1>\n          <p style={{\n            fontSize: '1rem',\n            color: '#4b5563',\n            margin: '0'\n          }}>\n            {/*  Jmno vlastnka + oddlen + pokladna + obdob */}\n            {(() => {\n              const userName = mainAssignment?.uzivatel_cele_jmeno ||\n                              (mainAssignment?.uzivatel_jmeno && mainAssignment?.uzivatel_prijmeni\n                                ? `${mainAssignment.uzivatel_jmeno} ${mainAssignment.uzivatel_prijmeni}`\n                                : null);\n              const workplace = mainAssignment?.nazev_pracoviste || mainAssignment?.kod_pracoviste;\n              const cashboxNum = mainAssignment?.cislo_pokladny;\n\n              return (\n                <>\n                  {userName || 'Bez uivatele'}\n                  {' | '}\n                  {workplace || 'Bez oddlen'}\n                  {' | '}\n                  Pokladna . {cashboxNum || organizationInfo.cashboxNumber}\n                  {' | '}\n                  {organizationInfo.month} {organizationInfo.year}\n                </>\n              );\n            })()}\n          </p>\n          <p style={{\n            fontSize: '0.875rem',\n            color: '#6b7280',\n            margin: '0.5rem 0 0 0'\n          }}>\n            VPD: {organizationInfo.cashboxVpd || 'N/A'} |\n            PPD: {organizationInfo.cashboxPpd || 'N/A'} |\n            Pevod z pedchozho msce: {formatCurrency(carryOverAmount)}\n          </p>\n        </div>\n\n        <TableContainer>\n          <Table>\n            <thead>\n            <tr>\n              <th className=\"row-number\">#</th>\n              <th className=\"date-cell\">Datum</th>\n              <th className=\"document-cell\">Doklad .</th>\n              <th className=\"description-cell\">Obsah zpisu</th>\n              <th className=\"person-cell\">Komu/Od koho</th>\n              <th className=\"amount-cell income\">Pjmy<br/>(K)</th>\n              <th className=\"amount-cell expense\">Vdaje<br/>(K)</th>\n              <th className=\"balance-cell\">Zstatek<br/>(K)</th>\n              <th className=\"lp-code-cell\">LP kd</th>\n              <th className=\"note-cell\">Poznmka</th>\n              {canActuallyEdit && <th className=\"actions-cell\">Akce</th>}\n            </tr>\n          </thead>\n          <tbody>\n            {cashBookEntries.map((entry, index) => {\n              const isLastSaved = entry.id === lastSavedEntryId;\n              return (\n              <React.Fragment key={entry.id}>\n              <tr\n                onDoubleClick={() => {\n                  if (canActuallyEdit && !entry.isEditing) {\n                    startEditing(entry.id);\n                  }\n                }}\n                style={{\n                  cursor: canActuallyEdit && !entry.isEditing ? 'pointer' : 'default',\n                  animation: isLastSaved ? `${highlightPulse} 1s ease-in-out 5` : 'none'\n                }}\n              >\n                <td className=\"row-number\">{index + 1}</td>\n\n                <td className=\"date-cell\">\n                  {entry.isEditing ? (\n                    <DatePicker\n                      value={entry.date}\n                      onChange={(newDate) => updateEntry(entry.id, 'date', newDate)}\n                      placeholder=\"Vyberte datum\"\n                      limitToMonth={currentMonth}\n                      limitToYear={currentYear}\n                    />\n                  ) : (\n                    formatDate(entry.date)\n                  )}\n                </td>\n\n                <td className=\"document-cell\">\n                  {/*  KROK 4: Zobrazit prefixovan slo pokud je zapnuto nastaven */}\n                  {(() => {\n                    if (!entry.documentNumber) {\n                      return '';\n                    }\n\n                    //  OPRAVA: Pokud slo u obsahuje pomlku, je u prefixovan z DB  zobrazit jak je\n                    if (entry.documentNumber.includes('-')) {\n                      const type = entry.documentNumber.charAt(0); // P nebo V\n                      return (\n                        <span\n                          title={`slo dokladu: ${entry.documentNumber}`}\n                          style={{\n                            cursor: 'help',\n                            fontWeight: '500',\n                            color: type === 'P' ? '#059669' : '#dc2626'\n                          }}\n                        >\n                          {entry.documentNumber}\n                        </span>\n                      );\n                    }\n\n                    // slo nem prefix (nap. V012)  pidat prefix pokud je zapnuto\n                    if (!usePrefixedNumbers) {\n                      return entry.documentNumber;\n                    }\n\n                    const type = entry.documentNumber.charAt(0); // P nebo V\n                    const number = entry.documentNumber.substring(1); // 001\n\n                    // Urit selnou adu podle typu dokladu\n                    let prefix = '';\n                    if (type === 'V' && organizationInfo.cashboxVpd) {\n                      prefix = organizationInfo.cashboxVpd; // VPD = vdajov pokladn doklad\n                    } else if (type === 'P' && organizationInfo.cashboxPpd) {\n                      prefix = organizationInfo.cashboxPpd; // PPD = pjmov pokladn doklad\n                    }\n\n                    const prefixedNumber = prefix ? `${type}${prefix}-${number}` : entry.documentNumber;\n\n                    return (\n                      <span\n                        title={`Poadov slo dokladu v roce: ${entry.documentNumber}`}\n                        style={{\n                          cursor: 'help',\n                          fontWeight: '500',\n                          color: type === 'P' ? '#059669' : '#dc2626'\n                        }}\n                      >\n                        {prefixedNumber}\n                      </span>\n                    );\n                  })()}\n                </td>\n\n                <td className=\"description-cell\">\n                  {entry.isEditing ? (\n                    <EditableInput\n                      value={entry.description}\n                      onChange={(e) => updateEntry(entry.id, 'description', e.target.value)}\n                      onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                      onBlur={autoSave}\n                      data-entry-id={entry.id}\n                      data-field=\"description\"\n                      placeholder=\"Popis operace\"\n                    />\n                  ) : (\n                    entry.description\n                  )}\n                </td>\n\n                <td className=\"person-cell\">\n                  {entry.isEditing ? (\n                    <EditableInput\n                      value={entry.person}\n                      onChange={(e) => updateEntry(entry.id, 'person', e.target.value)}\n                      onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                      onBlur={autoSave}\n                      placeholder=\"Jmno osoby\"\n                    />\n                  ) : (\n                    entry.person\n                  )}\n                </td>\n\n                <td className=\"amount-cell income\">\n                  {entry.isEditing ? (\n                    <CurrencyInputWrapper>\n                      <EditableInput\n                        type=\"text\"\n                        value={entry.income ? entry.income.toLocaleString('cs-CZ', { minimumFractionDigits: 0, maximumFractionDigits: 2 }) : ''}\n                        onChange={(e) => {\n                          const cleanValue = e.target.value.replace(/[^\\d,.-]/g, '').replace(',', '.');\n                          const numValue = parseFloat(cleanValue);\n                          updateEntry(entry.id, 'income', isNaN(numValue) ? null : numValue);\n                        }}\n                        onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                        onBlur={autoSave}\n                        placeholder=\"0\"\n                        className=\"amount-input\"\n                      />\n                    </CurrencyInputWrapper>\n                  ) : (\n                    entry.income ? formatCurrency(entry.income) : ''\n                  )}\n                </td>\n\n                <td className=\"amount-cell expense\">\n                  {entry.isEditing ? (\n                    <CurrencyInputWrapper>\n                      <EditableInput\n                        type=\"text\"\n                        value={entry.expense ? entry.expense.toLocaleString('cs-CZ', { minimumFractionDigits: 0, maximumFractionDigits: 2 }) : ''}\n                        onChange={(e) => {\n                          const cleanValue = e.target.value.replace(/[^\\d,.-]/g, '').replace(',', '.');\n                          const numValue = parseFloat(cleanValue);\n                          updateEntry(entry.id, 'expense', isNaN(numValue) ? null : numValue);\n                        }}\n                        onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                        onBlur={autoSave}\n                        placeholder=\"0\"\n                        className=\"amount-input\"\n                      />\n                    </CurrencyInputWrapper>\n                  ) : (\n                    entry.expense ? formatCurrency(entry.expense) : ''\n                  )}\n                </td>\n\n                <td className=\"balance-cell\">\n                  {formatCurrency(entry.balance)}\n                </td>\n\n                <td className=\"lp-code-cell\">\n                  {entry.isEditing ? (\n                    <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\n                      {/* Master LP kd - disabled pokud jsou detail poloky, povinn u vdaj */}\n                      {!(entry.detailItems && entry.detailItems.length > 0) && (\n                        <div style={{ position: 'relative', flex: 1 }}>\n                          <EditableCombobox\n                            value={entry.lpCode || ''}\n                            onChange={(e) => updateEntry(entry.id, 'lpCode', e.target.value)}\n                            onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                            onBlur={autoSave}\n                            options={lpCodes}\n                            placeholder={lpLoading ? 'Natn...' : (entry.expense > 0 ? 'LP kd (povinn) *' : 'LP kd (nepovinn)')}\n                            disabled={lpLoading}\n                            loading={lpLoading}\n                            hasError={entry.expense > 0 && !entry.lpCode}\n                          />\n                          {entry.expense > 0 && !entry.lpCode && (\n                            <div style={{ \n                              position: 'absolute', \n                              top: '100%', \n                              left: 0, \n                              fontSize: '10px', \n                              color: '#f44336', \n                              marginTop: '2px',\n                              whiteSpace: 'nowrap'\n                            }}>\n                               LP kd je povinn u vdaj\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {/* Tlatko pro rozbalen inline panelu - pouze u vdaj */}\n                      {entry.expense > 0 && (\n                        <button\n                          onClick={() => {\n                            if (expandedDetailEntryId === entry.id) {\n                              setExpandedDetailEntryId(null);\n                              setDetailEditBuffer([]);\n                            } else {\n                              setExpandedDetailEntryId(entry.id);\n                              setDetailEditBuffer(entry.detailItems && entry.detailItems.length > 0 \n                                ? [...entry.detailItems] \n                                : [{ popis: '', castka: 0, lp_kod: '', lp_popis: '' }]\n                              );\n                            }\n                          }}\n                          style={{\n                            padding: '4px 8px',\n                            fontSize: '12px',\n                            background: expandedDetailEntryId === entry.id \n                              ? '#ff9800' \n                              : (entry.detailItems && entry.detailItems.length > 0 ? '#4caf50' : '#2196f3'),\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            minWidth: '24px'\n                          }}\n                          title={expandedDetailEntryId === entry.id \n                            ? 'Zavt panel' \n                            : (entry.detailItems && entry.detailItems.length > 0 \n                              ? entry.detailItems.map(item => `${item.lp_kod}: ${item.castka} K${item.popis ? ' - ' + item.popis : ''}`).join('\\n')\n                              : 'Pidat vce LP kd')\n                          }\n                        >\n                          {expandedDetailEntryId === entry.id \n                            ? '' \n                            : (entry.detailItems && entry.detailItems.length > 0 ? `${entry.detailItems.length}` : '+')}\n                        </button>\n                      )}\n                      {/* Zobrazen multi-LP v edit mdu */}\n                      {entry.detailItems && entry.detailItems.length > 0 && (\n                        <div style={{ fontSize: '11px', color: '#4caf50', fontWeight: 'bold' }}>\n                          Multi-LP ({entry.detailItems.length})\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <div>\n                      {entry.detailItems && entry.detailItems.length > 0 ? (\n                        <div style={{ fontSize: '11px', color: '#666' }}>\n                          {entry.detailItems.map((item, idx) => (\n                            <div key={idx}>{item.lp_kod} ({item.castka} K)</div>\n                          ))}\n                        </div>\n                      ) : (\n                        entry.lpCode || '-'\n                      )}\n                    </div>\n                  )}\n                </td>\n\n                <td className=\"note-cell\">\n                  {entry.isEditing ? (\n                    <EditableInput\n                      value={entry.note}\n                      onChange={(e) => updateEntry(entry.id, 'note', e.target.value)}\n                      onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                      onBlur={autoSave}\n                      placeholder=\"Poznmka\"\n                    />\n                  ) : (\n                    entry.note\n                  )}\n                </td>\n\n                {canActuallyEdit && (\n                  <td className=\"actions-cell\">\n                    {entry.isEditing ? (\n                      <>\n                        <ActionIcon onClick={() => stopEditing(entry.id)} title=\"Potvrdit\">\n                          <FontAwesomeIcon icon={faCheck} />\n                        </ActionIcon>\n                      </>\n                    ) : (\n                      <>\n                        <ActionIcon onClick={() => startEditing(entry.id)} title=\"Editovat\">\n                          <FontAwesomeIcon icon={faEdit} />\n                        </ActionIcon>\n                        {canActuallyDelete && (\n                          <ActionIcon\n                            onClick={() => removeEntry(entry.id)}\n                            title=\"Smazat\"\n                            danger\n                          >\n                            <FontAwesomeIcon icon={faTrash} />\n                          </ActionIcon>\n                        )}\n                      </>\n                    )}\n                  </td>\n                )}\n              </tr>\n              {/*  INLINE MULTI-LP PANEL */}\n              {expandedDetailEntryId === entry.id && (\n                <tr key={`detail-${entry.id}`} style={{ background: '#f8f9fa' }}>\n                  <td colSpan={1} style={{ padding: 0 }}></td>\n                  <td colSpan={2} style={{ padding: 0 }}></td>\n                  <td colSpan={canActuallyEdit ? 8 : 7} style={{ padding: '16px 16px 16px 8px' }}>\n                    <div style={{ \n                      background: 'white', \n                      border: '2px solid #2196f3', \n                      borderRadius: '8px', \n                      padding: '16px',\n                      boxShadow: '0 4px 12px rgba(0,0,0,0.1)'\n                    }}>\n                      <div style={{ \n                        display: 'flex', \n                        justifyContent: 'space-between', \n                        alignItems: 'center', \n                        marginBottom: '12px',\n                        borderBottom: '2px solid #e0e0e0',\n                        paddingBottom: '8px'\n                      }}>\n                        <h4 style={{ margin: 0, color: '#2196f3' }}>\n                           Rozpad LP kd pro doklad {entry.documentNumber || '(nov)'}\n                        </h4>\n                        <div style={{ fontSize: '14px', fontWeight: 'bold' }}>\n                          Celkem: {entry.expense || 0} K\n                        </div>\n                      </div>\n\n                      <table style={{ width: '100%', borderCollapse: 'collapse', marginBottom: '12px', tableLayout: 'fixed' }}>\n                        <thead>\n                          <tr style={{ background: '#f5f5f5' }}>\n                            <th style={{ padding: '8px', textAlign: 'left', border: '1px solid #ddd', width: '50%' }}>Popis poloky</th>\n                            <th style={{ padding: '8px', textAlign: 'left', border: '1px solid #ddd', width: '18%' }}>stka</th>\n                            <th style={{ padding: '8px', textAlign: 'left', border: '1px solid #ddd', width: '25%' }}>LP kd</th>\n                            <th style={{ padding: '8px', textAlign: 'center', border: '1px solid #ddd', width: '7%' }}></th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                          {detailEditBuffer.map((item, idx) => {\n                            const isValidLp = !item.lp_kod || lpCodes.find(lp => lp.code === item.lp_kod);\n                            return (\n                              <tr key={idx}>\n                                <td style={{ padding: '8px', border: '1px solid #ddd' }}>\n                                  <input\n                                    type=\"text\"\n                                    value={item.popis || ''}\n                                    onChange={(e) => {\n                                      const updated = [...detailEditBuffer];\n                                      updated[idx].popis = e.target.value;\n                                      setDetailEditBuffer(updated);\n                                    }}\n                                    style={{ \n                                      width: '100%', \n                                      padding: '0.5rem', \n                                      fontSize: '0.9rem', \n                                      border: '1px solid #ccc', \n                                      borderRadius: '4px',\n                                      boxSizing: 'border-box'\n                                    }}\n                                    placeholder=\"Nap. Oprava kavovaru\"\n                                  />\n                                </td>\n                                <td style={{ padding: '8px', border: '1px solid #ddd' }}>\n                                  <div style={{ position: 'relative', display: 'flex', alignItems: 'center' }}>\n                                    <input\n                                      type=\"text\"\n                                      value={item.castka ? item.castka.toLocaleString('cs-CZ', { minimumFractionDigits: 0, maximumFractionDigits: 2 }) : ''}\n                                      onChange={(e) => {\n                                        const updated = [...detailEditBuffer];\n                                        const cleanValue = e.target.value.replace(/[^\\d,.-]/g, '').replace(',', '.');\n                                        const numValue = parseFloat(cleanValue);\n                                        updated[idx].castka = isNaN(numValue) ? 0 : numValue;\n                                        setDetailEditBuffer(updated);\n                                      }}\n                                      style={{ \n                                        width: '100%', \n                                        padding: '0.5rem 35px 0.5rem 0.5rem', \n                                        fontSize: '0.9rem', \n                                        border: '1px solid #ccc', \n                                        borderRadius: '4px',\n                                        textAlign: 'right',\n                                        boxSizing: 'border-box'\n                                      }}\n                                      placeholder=\"0\"\n                                    />\n                                    <span style={{\n                                      position: 'absolute',\n                                      right: '8px',\n                                      color: '#374151',\n                                      fontWeight: '600',\n                                      fontSize: '13px',\n                                      pointerEvents: 'none',\n                                      userSelect: 'none'\n                                    }}>\n                                      K\n                                    </span>\n                                  </div>\n                                </td>\n                                <td style={{ padding: '8px', border: '1px solid #ddd' }}>\n                                  <EditableCombobox\n                                    value={item.lp_kod || ''}\n                                    onChange={(e) => {\n                                      const updated = [...detailEditBuffer];\n                                      const selectedLp = lpCodes.find(lp => lp.code === e.target.value);\n                                      updated[idx].lp_kod = e.target.value;\n                                      updated[idx].lp_popis = selectedLp?.name || '';\n                                      setDetailEditBuffer(updated);\n                                    }}\n                                    options={lpCodes}\n                                    placeholder={lpLoading ? 'Natn...' : 'LP kd (nap. LPIT01)'}\n                                    disabled={lpLoading}\n                                    loading={lpLoading}\n                                    hasError={!isValidLp}\n                                  />\n                                  {!isValidLp && (\n                                    <div style={{ color: '#f44336', fontSize: '10px', marginTop: '2px' }}>\n                                       Neplatn kd\n                                    </div>\n                                  )}\n                                </td>\n                                <td style={{ padding: '8px', border: '1px solid #ddd', textAlign: 'center' }}>\n                                  <button\n                                    onClick={() => {\n                                      const updated = detailEditBuffer.filter((_, i) => i !== idx);\n                                      setDetailEditBuffer(updated);\n                                    }}\n                                    style={{ \n                                      padding: '0.5rem', \n                                      background: '#dc3545', \n                                      color: 'white', \n                                      border: 'none', \n                                      borderRadius: '4px', \n                                      cursor: 'pointer',\n                                      fontSize: '18px',\n                                      minWidth: '40px',\n                                      display: 'inline-flex',\n                                      alignItems: 'center',\n                                      justifyContent: 'center',\n                                      lineHeight: 1\n                                    }}\n                                    title=\"Smazat dek\"\n                                  >\n                                    \n                                  </button>\n                                </td>\n                              </tr>\n                            );\n                          })}\n                        </tbody>\n                      </table>\n\n                      <button\n                        onClick={() => {\n                          setDetailEditBuffer([...detailEditBuffer, { popis: '', castka: 0, lp_kod: '', lp_popis: '' }]);\n                        }}\n                        style={{ \n                          padding: '6px 12px', \n                          background: '#4caf50', \n                          color: 'white', \n                          border: 'none', \n                          borderRadius: '4px', \n                          cursor: 'pointer',\n                          fontSize: '13px',\n                          marginBottom: '12px'\n                        }}\n                      >\n                        + Pidat poloku\n                      </button>\n\n                      <div style={{ \n                        display: 'flex', \n                        justifyContent: 'space-between', \n                        alignItems: 'center',\n                        marginTop: '12px',\n                        paddingTop: '12px',\n                        borderTop: '2px solid #e0e0e0'\n                      }}>\n                        <div style={{ fontSize: '14px' }}>\n                          Souet poloek: <strong>{detailEditBuffer.reduce((sum, item) => sum + (item.castka || 0), 0).toFixed(2)} K</strong>\n                          {Math.abs(detailEditBuffer.reduce((sum, item) => sum + (item.castka || 0), 0) - (entry.expense || 0)) > 0.01 && (\n                            <span style={{ color: '#f44336', marginLeft: '8px' }}>\n                               Nesouhlas s stkou vdaje!\n                            </span>\n                          )}\n                        </div>\n                        <div style={{ display: 'flex', gap: '8px' }}>\n                          <button\n                            onClick={() => {\n                              setExpandedDetailEntryId(null);\n                              setDetailEditBuffer([]);\n                            }}\n                            style={{ \n                              padding: '8px 16px', \n                              background: '#6c757d', \n                              color: 'white', \n                              border: 'none', \n                              borderRadius: '4px', \n                              cursor: 'pointer' \n                            }}\n                          >\n                            Zruit\n                          </button>\n                          <button\n                            onClick={() => {\n                              // Validace\n                              const totalDetail = detailEditBuffer.reduce((sum, item) => sum + (item.castka || 0), 0);\n                              if (Math.abs(totalDetail - (entry.expense || 0)) > 0.01) {\n                                toast.error(` Souet poloek (${totalDetail.toFixed(2)} K) se neshoduje s stkou vdaje (${entry.expense} K)`, {\n                                  position: \"top-center\",\n                                  autoClose: 4000\n                                });\n                                return;\n                              }\n                              \n                              for (const item of detailEditBuffer) {\n                                if (!item.lp_kod) {\n                                  toast.warning(' Vechny poloky mus mt vybran LP kd', {\n                                    position: \"top-center\",\n                                    autoClose: 3000\n                                  });\n                                  return;\n                                }\n                                if (!lpCodes.find(lp => lp.code === item.lp_kod)) {\n                                  toast.error(` LP kd '${item.lp_kod}' nen platn`, {\n                                    position: \"top-center\",\n                                    autoClose: 3000\n                                  });\n                                  return;\n                                }\n                              }\n                              \n                              // Uloit do entry\n                              setCashBookEntries(prev => prev.map(e => \n                                e.id === entry.id \n                                  ? { \n                                      ...e, \n                                      detailItems: detailEditBuffer,\n                                      lpCode: '',\n                                      hasDetails: true,\n                                      changed: true,\n                                      sync_status: 'pending'\n                                    }\n                                  : e\n                              ));\n                              \n                              toast.success(` Uloeno ${detailEditBuffer.length} LP kd pod dokladem ${entry.documentNumber}`, {\n                                position: \"top-right\",\n                                autoClose: 2000\n                              });\n                              \n                              setExpandedDetailEntryId(null);\n                              setDetailEditBuffer([]);\n                              autoSave();\n                            }}\n                            style={{ \n                              padding: '8px 16px', \n                              background: '#2196f3', \n                              color: 'white', \n                              border: 'none', \n                              borderRadius: '4px', \n                              cursor: 'pointer',\n                              fontWeight: 'bold'\n                            }}\n                          >\n                             Uloit\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  </td>\n                </tr>\n              )}\n              </React.Fragment>\n              );\n            })}\n          </tbody>\n        </Table>\n\n        {canActuallyCreate && (\n          <div style={{ padding: '1rem' }}>\n            <AddRowButton onClick={handleAddNewRow}>\n              <FontAwesomeIcon icon={faPlus} />\n              Pidat nov dek\n            </AddRowButton>\n          </div>\n        )}\n      </TableContainer>\n      \n      {/*  Kompaktn info box pro zamenou knihu */}\n      {bookStatus === 'zamknuta_spravcem' && (\n        <div className=\"no-print\" style={{\n          background: 'linear-gradient(135deg, #fee2e2 0%, #fecaca 100%)',\n          border: '2px solid #dc2626',\n          borderRadius: '8px',\n          padding: '1rem 1.25rem',\n          marginTop: '1rem',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '1rem'\n        }}>\n          <div style={{\n            fontSize: '2rem',\n            color: '#dc2626',\n            flexShrink: 0\n          }}>\n            <FontAwesomeIcon icon={faLock} />\n          </div>\n          <div style={{ flex: 1 }}>\n            <h4 style={{ \n              margin: '0 0 0.5rem 0', \n              color: '#991b1b', \n              fontSize: '1rem',\n              fontWeight: '600'\n            }}>\n               Pokladn kniha je finln uzamena sprvcem\n            </h4>\n            <p style={{ \n              margin: 0, \n              color: '#7f1d1d', \n              fontSize: '0.875rem',\n              lineHeight: '1.4'\n            }}>\n              Tento msc byl zamen administrtorem a je ji zatovn. \n              <strong> Nelze pidvat, upravovat ani mazat zznamy.</strong>\n              {' '}V ppad poteby zmn kontaktujte sprvce pokladn knihy.\n            </p>\n          </div>\n        </div>\n      )}\n      </div>\n\n      {/* Legenda horkch klves - pouze pro aktivn knihu */}\n      {bookStatus === 'aktivni' && (\n        <div className=\"no-print\" style={{\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          gap: '2rem',\n          padding: '0.75rem 1rem',\n          marginTop: '0.75rem',\n          background: 'linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)',\n          borderRadius: '8px',\n          fontSize: '0.8rem',\n          fontWeight: 600,\n          color: '#475569',\n          border: '1px solid #cbd5e1',\n          boxShadow: '0 1px 3px rgba(0, 0, 0, 0.05)'\n        }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Shift</kbd>\n          <span>+</span>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Insert</kbd>\n          <span style={{ marginLeft: '0.25rem' }}>Nov dek</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Shift</kbd>\n          <span>+</span>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Enter</kbd>\n          <span style={{ marginLeft: '0.25rem' }}>Uloit a ukonit editaci</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>ESC</kbd>\n          <span style={{ marginLeft: '0.25rem' }}>Zruit editaci bez uloen</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Double-click</kbd>\n          <span style={{ marginLeft: '0.25rem' }}>Editovat dek</span>\n        </div>\n        </div>\n      )}\n\n      {/* Panel vech tlatek pod tabulkou */}\n      <ActionBar className=\"no-print\" style={{ marginTop: '1rem' }}>\n        <ActionGroup>\n          {/* Przdn msto vlevo - mete pidat dal tlatka */}\n        </ActionGroup>\n\n        <ActionGroup>\n          {/* Export tlatka */}\n          {canExportCashBook && (\n            <>\n              <ActionButton type=\"button\" onClick={() => exportData('CSV')}>\n                <FontAwesomeIcon icon={faFileExport} />\n                Export CSV\n              </ActionButton>\n              <ActionButton type=\"button\" onClick={() => exportData('PDF')}>\n                <FontAwesomeIcon icon={faPrint} />\n                Export PDF\n              </ActionButton>\n              <ActionButton\n                type=\"button\"\n                onClick={printPDFReport}\n                title=\"Tisknout pokladn knihu (PDF formt, A4 na ku)\"\n              >\n                <FontAwesomeIcon icon={faPrint} />\n                Tisknout\n              </ActionButton>\n            </>\n          )}\n        </ActionGroup>\n      </ActionBar>\n\n      {/* ConfirmDialog pro smazn poloky */}\n      <ConfirmDialog\n        isOpen={deleteDialogOpen}\n        title=\"Smazn poloky\"\n        icon=\"trash\"\n        variant=\"danger\"\n        onConfirm={handleConfirmDelete}\n        onClose={handleCancelDelete}\n      >\n        Opravdu chcete odstranit tento zznam z pokladn knihy? Tato akce je nevratn.\n      </ConfirmDialog>\n\n      {/* ConfirmDialog pro uzaven msce */}\n      <ConfirmDialog\n        isOpen={closeMonthDialogOpen}\n        title={`Uzavt msc ${new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}`}\n        icon={faCheck}\n        variant=\"warning\"\n        onConfirm={confirmCloseMonth}\n        onClose={() => setCloseMonthDialogOpen(false)}\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p><strong>Po uzaven msce:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>Nebude mon pidvat nov zznamy</li>\n            <li>Nebude mon upravovat existujc zznamy</li>\n            <li>Msc lze znovu otevt tlatkem \"Otevt msc\"</li>\n          </ul>\n\n          <div style={{\n            background: '#fef3c7',\n            border: '2px solid #d97706',\n            borderRadius: '8px',\n            padding: '1rem',\n            marginTop: '1rem'\n          }}>\n            <p style={{ color: '#92400e', fontWeight: '600', marginBottom: '0.5rem' }}>\n               Automatick peslovn doklad\n            </p>\n            <p style={{ color: '#92400e', fontSize: '0.9rem' }}>\n              Ped uzavenm budou <strong>vechny doklady</strong> v tomto msci i ve vech nsledujcch mscch <strong>peslovny chronologicky</strong> podle data a typu (P/V).\n            </p>\n            <p style={{ color: '#92400e', fontSize: '0.9rem', marginTop: '0.5rem' }}>\n              Tm se zajist sprvn navazujc poad sel doklad.\n            </p>\n          </div>\n\n          <p style={{ marginTop: '1rem', fontWeight: '500' }}>Opravdu chcete pokraovat?</p>\n        </div>\n      </ConfirmDialog>\n\n      {/* ConfirmDialog pro zamknut msce (ADMIN) */}\n      <ConfirmDialog\n        isOpen={lockBookDialogOpen}\n        title={` Zamknout msc ${new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}`}\n        icon={faLock}\n        variant=\"danger\"\n        onConfirm={confirmLockBook}\n        onClose={() => setLockBookDialogOpen(false)}\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p style={{ color: '#dc3545', fontWeight: 'bold', marginBottom: '1rem' }}>\n            POZOR: Toto je finln uzaven msce!\n          </p>\n          <p><strong>Po zamknut sprvcem:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>Nikdo (ani bn uivatel) nebude moci upravovat zznamy</li>\n            <li>Nikdo (ani bn uivatel) nebude moci otevt msc</li>\n            <li>Odemknout me pouze sprvce tlatkem \"Odemknout (Admin)\"</li>\n            <li>Toto je <strong>FINLN</strong> uzaven msce</li>\n          </ul>\n          <p style={{ marginTop: '1rem' }}>Pokraovat s finlnm zamenm?</p>\n        </div>\n      </ConfirmDialog>\n\n      {/* ConfirmDialog pro oteven uzavenho msce (uzavrena_uzivatelem) */}\n      <ConfirmDialog\n        isOpen={reopenMonthDialogOpen}\n        title={` Otevt msc ${new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}`}\n        icon={faExclamationTriangle}\n        variant=\"warning\"\n        onConfirm={confirmReopenMonth}\n        onClose={() => setReopenMonthDialogOpen(false)}\n        confirmText=\"Ano, otevt msc\"\n        cancelText=\"Zruit\"\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p style={{ color: '#ff9800', fontWeight: 'bold', marginBottom: '1rem' }}>\n             POZOR: Znovu otevrte uzaven msc!\n          </p>\n          <p><strong>Po oteven msce:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>Bude mon znovu <strong>pidvat</strong> nov zznamy</li>\n            <li>Bude mon <strong>upravovat</strong> existujc zznamy</li>\n            <li>Bude mon <strong>mazat</strong> zznamy</li>\n            <li>Msc <strong>nebude uzaven</strong> pro etn operace</li>\n            <li style={{ color: '#d97706', fontWeight: '500', marginTop: '0.5rem' }}>\n               Pokud nsledn provedete zmny a znovu msc uzavete, sla doklad v nsledujcch mscch budou peslovna\n            </li>\n          </ul>\n          <p style={{ marginTop: '1rem', color: '#ff9800', fontWeight: 'bold' }}>\n             Tmto zrute uzaven msce! Opravdu pokraovat?\n          </p>\n        </div>\n      </ConfirmDialog>\n\n      {/* ConfirmDialog pro odemknut zamenho msce (zamknuta_spravcem) - ADMIN ONLY */}\n      <ConfirmDialog\n        isOpen={unlockBookDialogOpen}\n        title={` Odemknout msc ${new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}`}\n        icon={faLockOpen}\n        variant=\"danger\"\n        onConfirm={confirmUnlockBook}\n        onClose={() => setUnlockBookDialogOpen(false)}\n        confirmText=\"Ano, odemknout (Admin)\"\n        cancelText=\"Zruit\"\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p style={{ color: '#dc3545', fontWeight: 'bold', marginBottom: '1rem' }}>\n             ADMIN AKCE: Odemykte finln zamen msc!\n          </p>\n          <p><strong>Po odemknut sprvcem:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>Bude mon znovu <strong>pidvat a upravovat</strong> zznamy</li>\n            <li>Bude mon <strong>mazat</strong> zznamy</li>\n            <li>Msc <strong>ztrat finln uzaven</strong></li>\n            <li>Vichni uivatel budou moci opt editovat</li>\n          </ul>\n          <p style={{ marginTop: '1rem', color: '#dc3545', fontWeight: 'bold' }}>\n             POZOR: Toto ru finln administrativn uzamen! Opravdu pokraovat?\n          </p>\n        </div>\n      </ConfirmDialog>\n\n      {/* InfoDialog pro blokaci zptn tvorby knih (uzaven msce v budoucnosti) */}\n      <ConfirmDialog\n        isOpen={retroactiveCreationBlockedDialogOpen}\n        title=\" Zptn vytvoen knihy nen mon\"\n        icon={faExclamationTriangle}\n        variant=\"danger\"\n        onConfirm={() => setRetroactiveCreationBlockedDialogOpen(false)}\n        onClose={() => setRetroactiveCreationBlockedDialogOpen(false)}\n        confirmText=\"Rozumm\"\n        showCancel={false}\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p style={{ color: '#dc3545', fontWeight: 'bold', marginBottom: '1rem' }}>\n             NELZE VYTVOIT NOVOU KNIHU V TOMTO MSCI\n          </p>\n          <p>Pro tento msc <strong>nemte zaloenou pokladn knihu</strong> a existuj <strong>uzaven msce v budoucnosti</strong>.</p>\n          <p style={{ marginTop: '1rem' }}><strong>Dvody blokace:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>V nsledujcch mscch mte <strong>uzaven nebo zamen</strong> knihy</li>\n            <li>Zptn vytvoen knihy by <strong>poruilo kontinuitu</strong> etnictv</li>\n            <li>Nelze dodaten vytvet knihy <strong>ped uzavenmi msci</strong></li>\n          </ul>\n          <p style={{ marginTop: '1rem', color: '#28a745', fontWeight: 'bold' }}>\n             POZNMKA: Prohlen existujcch knih v minulosti je mon kdykoliv.\n          </p>\n          <p style={{ marginTop: '1rem', color: '#ff9800', fontWeight: 'bold' }}>\n             een: Nejprve otevete uzaven msce v budoucnosti, pak mete vytvoit nov knihy v minulosti.\n          </p>\n        </div>\n      </ConfirmDialog>\n\n      {/* Kontextov pomocnk - Modern Sponka */}\n      {hasPermission('HELPER_VIEW') && <ModernHelper pageContext=\"cashbook\" />}\n      \n      {/* Toast notifikace kontejner */}\n      <ToastContainer\n        position=\"top-right\"\n        autoClose={3000}\n        hideProgressBar={false}\n        newestOnTop={true}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n        theme=\"light\"\n      />\n      </PageContainer>\n    </>\n  );\n};\n\nexport default CashBookPage;","/**\n * ALTERNATIVN KONFIGURACE FONT PRO POKLADN KNIHU PDF\n *\n * Tento soubor obsahuje rzn zpsoby, jak nastavit fonty pro @react-pdf/renderer\n * s plnou podporou esk diakritiky.\n */\n\nimport { Font } from '@react-pdf/renderer';\n\n//  SINGLETON - fonty se registruj jen jednou\nlet fontsRegistered = false;\n\n/**\n * VARIANTA 1: CDN - Roboto (doporueno pro zatek)\n * Vhody: Jednoduch, bez stahovn soubor\n * Nevhody: Vyaduje internetov pipojen\n */\nexport const registerRobotoFromCDN = () => {\n  if (fontsRegistered) {\n    return;\n  }\n\n  try {\n    Font.register({\n      family: 'Roboto',\n      fonts: [\n        // Light\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-light-webfont.ttf',\n          fontWeight: 300,\n          fontStyle: 'normal',\n        },\n        // Regular\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-regular-webfont.ttf',\n          fontWeight: 400,\n          fontStyle: 'normal',\n        },\n        // Regular Italic\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-italic-webfont.ttf',\n          fontWeight: 400,\n          fontStyle: 'italic',\n        },\n        // Medium\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-medium-webfont.ttf',\n          fontWeight: 500,\n          fontStyle: 'normal',\n        },\n        // Bold\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-bold-webfont.ttf',\n          fontWeight: 700,\n          fontStyle: 'normal',\n        },\n      ],\n    });\n    fontsRegistered = true;\n  } catch (error) {\n    console.error(' Chyba pi registraci Roboto font:', error);\n  }\n};\n\n//  Automatick registrace pi importu modulu\nregisterRobotoFromCDN();\n\n/**\n * VARIANTA 2: Google Fonts API\n * Vhody: Spolehlivj ne CDN, vdy aktuln verze\n * Nevhody: Vyaduje internetov pipojen\n */\nexport const registerRobotoFromGoogle = () => {\n  Font.register({\n    family: 'Roboto',\n    fonts: [\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxIIzI.ttf',\n        fontWeight: 300,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.ttf',\n        fontWeight: 500,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfBBc4.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n};\n\n/**\n * VARIANTA 3: Lokln soubory (nejspolehlivj)\n *\n * KROK 1: Sthni Roboto fonty z Google Fonts\n * https://fonts.google.com/specimen/Roboto\n *\n * KROK 2: Umsti TTF soubory do sloky:\n * /public/fonts/Roboto/\n * - Roboto-Light.ttf\n * - Roboto-Regular.ttf\n * - Roboto-Medium.ttf\n * - Roboto-Bold.ttf\n *\n * KROK 3: Pouij tuto funkci\n */\nexport const registerRobotoLocal = () => {\n  Font.register({\n    family: 'Roboto',\n    fonts: [\n      {\n        src: '/fonts/Roboto/Roboto-Light.ttf',\n        fontWeight: 300,\n      },\n      {\n        src: '/fonts/Roboto/Roboto-Regular.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: '/fonts/Roboto/Roboto-Medium.ttf',\n        fontWeight: 500,\n      },\n      {\n        src: '/fonts/Roboto/Roboto-Bold.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n};\n\n/**\n * VARIANTA 4: Noto Sans (alternativa k Roboto)\n * Dobr volba pro jet lep podporu Unicode znak\n */\nexport const registerNotoSansFromGoogle = () => {\n  Font.register({\n    family: 'Noto Sans',\n    fonts: [\n      {\n        src: 'https://fonts.gstatic.com/s/notosans/v30/o-0IIpQlx3QUlC5A4PNb4j5Ba_2c7A.ttf',\n        fontWeight: 300,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/notosans/v30/o-0IIpQlx3QUlC5A4PNr4DRFSfiM7HBj.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/notosans/v30/o-0IIpQlx3QUlC5A4PNb4kZBa_2c7A.ttf',\n        fontWeight: 500,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/notosans/v30/o-0IIpQlx3QUlC5A4PNb4gBDa_2c7A.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n};\n\n/**\n * VARIANTA 5: Fallback s error handlingem\n * Pro produkn prosted - pokus se nast fonty, pi chyb pouije vchoz\n */\nexport const registerFontsWithFallback = async () => {\n  try {\n    // Pokus o naten z Google Fonts\n    registerRobotoFromGoogle();\n    console.log(' Fonty spn nateny z Google Fonts');\n  } catch (error) {\n    console.error(' Nepodailo se nast fonty. PDF bude pouvat vchoz font.', error);\n    // V tomto ppad @react-pdf/renderer pouije vchoz Helvetica\n    // ale bez podpory diakritiky\n  }\n};\n\n/**\n * VARIANTA 6: Registrace vce font pro rzn ely\n */\nexport const registerMultipleFonts = () => {\n  // Roboto pro bn text\n  Font.register({\n    family: 'Roboto',\n    fonts: [\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfBBc4.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n\n  // Roboto Mono pro sla a kdy (lep itelnost)\n  Font.register({\n    family: 'Roboto Mono',\n    fonts: [\n      {\n        src: 'https://fonts.gstatic.com/s/robotomono/v22/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW4.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/robotomono/v22/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_gPu_ROW4.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n};\n\n/**\n * DOPORUEN NASTAVEN PRO PRODUKCI\n */\nexport const registerProductionFonts = () => {\n  // Pro produkci doporuuji pout lokln fonty\n  // protoe zaruuj:\n  // 1. Offline funknost\n  // 2. Rychlej natn\n  // 3. Bez zvislosti na tetch stranch\n\n  const isLocal = process.env.NODE_ENV === 'production';\n\n  if (isLocal) {\n    console.log(' Produkn prosted: Natm lokln fonty');\n    registerRobotoLocal();\n  } else {\n    console.log(' Vvojov prosted: Natm fonty z Google Fonts');\n    registerRobotoFromGoogle();\n  }\n};\n\n/**\n * NVOD NA STAEN ROBOTO FONT\n *\n * Metoda 1: Pes Google Fonts\n * 1. Jdi na: https://fonts.google.com/specimen/Roboto\n * 2. Klikni na \"Download family\"\n * 3. Rozbal ZIP a zkopruj potebn TTF soubory\n * 4. Umsti je do /public/fonts/Roboto/\n *\n * Metoda 2: Pes terminl (Linux/Mac)\n *\n * mkdir -p public/fonts/Roboto\n * cd public/fonts/Roboto\n *\n * # Staen pmo z Google Fonts CDN\n * wget -O Roboto-Light.ttf \"https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxIIzI.ttf\"\n * wget -O Roboto-Regular.ttf \"https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.ttf\"\n * wget -O Roboto-Medium.ttf \"https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.ttf\"\n * wget -O Roboto-Bold.ttf \"https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfBBc4.ttf\"\n *\n * Metoda 3: Pomoc npm balku\n *\n * npm install @fontsource/roboto\n *\n * Pot importuj v komponente:\n * import '@fontsource/roboto/300.css';\n * import '@fontsource/roboto/400.css';\n * import '@fontsource/roboto/500.css';\n * import '@fontsource/roboto/700.css';\n */\n\nexport default {\n  registerRobotoFromCDN,\n  registerRobotoFromGoogle,\n  registerRobotoLocal,\n  registerNotoSansFromGoogle,\n  registerFontsWithFallback,\n  registerMultipleFonts,\n  registerProductionFonts,\n};\n"],"names":["ComboboxWrapper","styled","div","_templateObject","_taggedTemplateLiteral","ComboboxInput","input","_templateObject2","props","hasError","disabled","DropdownList","ul","_templateObject3","DropdownItem","li","_templateObject4","NoResults","_templateObject5","_ref","value","onChange","onKeyDown","onBlur","options","placeholder","loading","inputValue","setInputValue","useState","isOpen","setIsOpen","highlightedIndex","setHighlightedIndex","dropdownPosition","setDropdownPosition","top","left","width","inputRef","useRef","wrapperRef","useEffect","updateDropdownPosition","current","rect","getBoundingClientRect","bottom","window","scrollY","scrollX","Math","max","handleScroll","handleResize","addEventListener","removeEventListener","filteredOptions","React","searchTerm","toLowerCase","trim","filter","option","code","name","includes","handleClickOutside","event","contains","target","document","selectOption","newValue","setTimeout","_inputRef$current","focus","_jsxs","ref","children","_jsx","type","e","onFocus","handleInputFocus","length","key","preventDefault","prev","autoComplete","ReactDOM","style","concat","map","index","className","onMouseDown","onMouseEnter","body","styles","StyleSheet","create","page","flexDirection","backgroundColor","padding","paddingBottom","fontFamily","fontSize","header","marginBottom","alignItems","justifyContent","gap","logoContainer","height","logo","objectFit","headerContent","flex","headerOrganization","fontWeight","color","headerTitle","headerSubtitle","headerInfo","headerPeriod","alignSelf","periodMonth","textTransform","periodYear","summaryBlock","borderRadius","summaryGrid","flexWrap","summaryItem","minWidth","summaryLabel","summaryValue","summaryValuePositive","summaryValueNegative","summaryValueNeutral","bookStatusCard","borderLeftWidth","borderLeftColor","borderLeftStyle","bookStatusCardClosed","bookStatusCardLocked","bookStatusTitle","bookStatusInfo","bookStatusInfoItem","bookStatusLabel","bookStatusValue","table","display","borderStyle","borderWidth","borderColor","borderRightWidth","borderBottomWidth","tableRow","tableHeaderRow","tableHeaderCell","borderTopWidth","textAlign","verticalAlign","tableCell","tableCellAlternate","colNumber","colDate","colDocNumber","colDescription","colPerson","colIncome","colExpense","colBalance","colLpCode","colNote","colHeaderIncome","colHeaderExpense","colHeaderBalance","footer","position","right","borderTopColor","paddingTop","formatCurrency","amount","undefined","num","parseFloat","isNaN","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","format","formatDate","dateString","Date","toLocaleDateString","day","month","year","error","organizationInfo","carryOverAmount","totals","entries","generatedBy","bookStatus","currentDate","toLocaleString","hour","minute","Document","Page","size","orientation","View","Image","src","ASSETS","LOGO_ZZS_MAIN","Text","organizationName","workplace","cashboxNumber","toUpperCase","status","_Fragment","closedDate","closedBy","lockedDate","lockedBy","totalIncome","totalExpenses","currentBalance","entry","date","documentNumber","description","person","income","expense","balance","lpCode","note","id","fixed","fullName","usekZkr","lokalita","render","_ref2","pageNumber","totalPages","config","getStatusConfig","label","icon","title","Container","Row","PeriodSelect","select","Label","SelectWrapper","SelectButton","button","_templateObject6","DropdownIcon","span","_templateObject7","Dropdown","_templateObject8","SearchWrapper","_templateObject9","SearchIcon","_templateObject0","SearchInput","_templateObject1","OptionsList","_templateObject10","Option","_templateObject11","$selected","OptionLabel","_templateObject12","OptionDetails","_templateObject13","OptionTitle","_templateObject14","OptionSubtitle","_templateObject15","OptionBadge","_templateObject16","StatusBadge","_templateObject17","$status","Info","_templateObject18","currentCashbox","userCashboxes","allCashboxes","permissions","canSeeAllCashboxes","onCashboxChange","currentYear","currentMonth","onPeriodChange","searchQuery","setSearchQuery","dropdownRef","searchInputRef","canReadAll","canManage","isCurrentCashboxOwned","useMemo","some","uc","String","cislo_pokladny","availableCashboxes","boxes","cb","parseInt","je_hlavni","seen","Set","has","add","filteredCashboxes","query","number","nazev","nazev_pracoviste","userName","uzivatel_cele_jmeno","uzivatel_jmeno","uzivatel_prijmeni","lokalita_nazev","lokalita_kod","usek","usek_nazev","location","kod_pracoviste","months","now","currentYearNow","getFullYear","currentMonthNow","getMonth","years","y","push","availableMonths","m","newYear","newMonth","FontAwesomeIcon","faCalculator","onClick","labelData","getCurrentLabel","isOwn","cashboxName","details","join","stav_knihy","marginLeft","faChevronDown","faSearch","cursor","cashbox","isMyOwnCashbox","handleSelect","faCheckCircle","PERMISSIONS","CASH_BOOK_READ_OWN","CASH_BOOK_READ_ALL","CASH_BOOK_EDIT_OWN","CASH_BOOK_EDIT_ALL","CASH_BOOK_DELETE_OWN","CASH_BOOK_DELETE_ALL","CASH_BOOK_EXPORT_OWN","CASH_BOOK_EXPORT_ALL","CASH_BOOK_MANAGE","getUserCashbookPermissions","userDetail","directRights","direct_rights","Array","isArray","forEach","p","kod_prava","kod_opravneni","startsWith","prava","perms","roles","role","rolePrava","rights","getCashbookPermissionsObject","canReadOwn","canEditOwn","canEditAll","canDeleteOwn","canDeleteAll","canExportOwn","canExportAll","printStyles","css","fadeIn","keyframes","slideIn","highlightPulse","PageContainer","Header","ActionBar","ActionGroup","ActionButton","variant","$filled","MonthNavigation","MonthInfo","MonthControls","MonthButton","PreviousMonthWarning","WarningIcon","WarningContent","InfoPanel","StickyCompactSummary","$visible","TableContainer","Table","_templateObject19","CurrencyInputWrapper","_templateObject20","EditableInput","_templateObject21","ActionIcon","_templateObject22","_templateObject23","danger","AddRowButton","_templateObject24","CashBookPage","_userDetail$roles","user","token","hasPermission","useContext","AuthContext","showToast","ToastContext","savedPeriod","loadSavedPeriod","saved","localStorage","getItem","JSON","parse","err","setCurrentMonth","setCurrentYear","setCarryOverAmount","showStickySummary","setShowStickySummary","deleteDialogOpen","setDeleteDialogOpen","entryToDelete","setEntryToDelete","closeMonthDialogOpen","setCloseMonthDialogOpen","lockBookDialogOpen","setLockBookDialogOpen","reopenMonthDialogOpen","setReopenMonthDialogOpen","unlockBookDialogOpen","setUnlockBookDialogOpen","retroactiveCreationBlockedDialogOpen","setRetroactiveCreationBlockedDialogOpen","cashBookEntries","setCashBookEntries","cashBookEntriesRef","lastSavedEntryId","setLastSavedEntryId","lpCodes","setLpCodes","lpLoading","setLpLoading","expandedDetailEntryId","setExpandedDetailEntryId","detailEditBuffer","setDetailEditBuffer","mainAssignment","setMainAssignment","assignmentLoading","setAssignmentLoading","userAssignments","setUserAssignments","allAssignments","setAllAssignments","setBookStatus","bookStatusMetadata","setBookStatusMetadata","usePrefixedNumbers","setUsePrefixedNumbers","settingsLoading","setSettingsLoading","currentBookId","setCurrentBookId","currentBookData","setCurrentBookData","isSyncing","setIsSyncing","lastSyncTimestamp","setLastSyncTimestamp","showPreviousMonthWarning","setShowPreviousMonthWarning","syncConflicts","setSyncConflicts","getUserLocation","_userDetail$lokalita_","_userDetail$lokalita","cashboxVpd","ciselna_rada_vpd","cashboxPpd","ciselna_rada_ppd","STORAGE_KEY","userId","assignmentId","cashbookPermissions","hasAllPermissions","hasMultipleCashboxes","transformDBEntryToFrontend","useCallback","dbEntry","dbTimestamp","aktualizovano","vytvoreno","detailItems","detail_items","hasDetails","random","db_id","datum_zapisu","cislo_dokladu","obsah_zapisu","komu_od_koho","castka_prijem","castka_vydaj","zustatek_po_operaci","lp_kod","poznamka","isEditing","item","castka","popis","last_modified_local","toISOString","last_synced_at","db_updated_at","changed","sync_status","transformFrontendEntryToDB","bookId","payload","book_id","typ_dokladu","castka_celkem","reduce","sum","console","log","detail_items_count","ensureBookExists","async","_booksResult$data","_booksResult$data$boo","targetUserId","uzivatel_id","booksResult","cashbookAPI","listBooks","data","books","_bookDetail$data","book","prevod_z_predchoziho","bookDetail","getBook","createResult","createBook","_createResult$data","_createResult$data2","_bookDetail$data2","_bookDetail$data3","newBook","errorMsg","message","Error","warn","saveToLocalStorage","carryOver","dataToSave","lastModified","setItem","stringify","syncLocalChangesToDB","targetBookId","arguments","syncedCount","errorCount","updateEntry","_result$data","result","createEntry","endBalance","updateBook","celkove_prijmy","celkove_vydaje","koncovy_stav","pocet_zaznamu","loadFromLocalStorageOnly","savedData","prevMonth","prevYear","prevStorageKey","calculatedCarryOver","prevMonthData","prevParsed","prevEntries","prevInitialBalance","parsed","storedCarryOver","updatedData","_objectSpread","_window$performance","_window$performance$n","_window$performance2","_window$performance2$","_window$performance2$2","_window$performance2$3","closedByName","uzivatel_jmeno_plne","lockedByName","zamknul_spravce_jmeno_plne","uzavrena_uzivatelem_kdy","zamknuta_spravcem_kdy","isPageReload","performance","navigation","getEntriesByType","call","localEntries","localTimestamp","dbIsNewer","removeItem","loadDataFromDB","username","fetchLimitovanePrisliby","transformedLps","lp","cislo_lp","kod","nazev_uctu","loadLpCodes","mainElement","querySelector","scrollTop","refreshDataFromDB","showMessage","bookData","_bookData$data","_bookData$data2","freshCarryOver","dbEntries","datum","split","stored","localData","mergedEntries","localEntry","find","le","handleVisibilityChange","hidden","intervalId","setInterval","_localData$entries","_localData$entries2","_cashBookEntriesRef$c","hasEditingEntryInLocalStorage","hasUnsyncedChanges","hasEditingEntryInState","clearInterval","_userResult$data","listAssignments","assignments","allAvailableAssignments","_allResult$data","allResult","getCashboxListByPeriod","pokladny","transformedData","prirazeni_id","pokladna_id","aktivni","selectedAssignment","a","loadAllData","getSettings","loadSettings","initialBalance","entryCount","getLastDocumentNumbersFromPreviousMonth","lastP","lastV","_booksResult$data2","_bookResult$data","_bookResult$data$entr","prevBook","bookResult","pNumbers","_e$cislo_dokladu","substring","vNumbers","_e$cislo_dokladu2","currency","dateStr","checkForClosedFutureMonths","targetYear","targetMonth","hasClosedFuture","closedMonths","today","currentSystemMonth","currentSystemYear","checkYear","checkMonth","_booksResult$data3","_booksResult$data3$bo","monthName","checkPreviousMonthStatus","_result$data2","_result$data2$books","addNewEntry","newId","defaultDate","lastDayOfMonth","padStart","getDate","newEntry","requestAnimationFrame","descriptionInput","handleCashboxChange","newAssignment","saveData","startEditing","stopEditing","_editedEntry$descript","editedEntry","cancelEditing","filtered","hasIncome","hasExpense","typeChanged","shouldBeV","currentMonthPNumbers","_e$documentNumber","nextP","currentMonthVNumbers","_e$documentNumber2","nextV","currentPrefix","charAt","_e$documentNumber3","_e$documentNumber4","updatedEntry","updatedEntries","entry_id","updateResult","_updateResult$data","_updateResult$data$en","backend_cislo","frontend_cislo","_updateResult$data2","_updateResult$data2$e","_result$data3","_result$data4","_result$data4$entry","originalEntry","handleKeyDown","entryId","shiftKey","field","newEntries","processedValue","runningBalance","autoSave","exportData","filename","exportToCSV","generatePDFReport","rows","replace","toFixed","csvContent","row","blob","Blob","link","createElement","href","URL","createObjectURL","download","click","revokeObjectURL","_userDetail$usek_zkr","titul_pred","jmeno","prijmeni","titul_za","usek_zkr","pdf","PokladniKnihaPDF","toBlob","url","appendChild","removeChild","isSuperAdmin","r","kod_role","hasManagePermission","isCurrentUserCashbook","isOwner","isAssignedToThisCashbox","assignment","isBookEditable","canViewCashBook","canActuallyEdit","canActuallyDelete","canActuallyCreate","canExportCashBook","canCloseCurrentPeriod","todayYear","todayMonth","handleUnlockBook","handleGlobalKeyDown","editingEntry","firstInput","Global","cashboxNum","vpd","ppd","CashboxSelector","BookStatusBadge","faInfoCircle","marginRight","handleCloseMonth","faCheck","handleLockBook","_targetBooksResult$da","targetBooksResult","faChevronLeft","goToCurrentMonth","faCalendarDay","goToNextMonth","faChevronRight","faExclamationTriangle","borderBottom","margin","isLastSaved","onDoubleClick","animation","DatePicker","newDate","limitToMonth","limitToYear","prefix","prefixedNumber","cleanValue","numValue","EditableCombobox","marginTop","whiteSpace","lp_popis","background","border","idx","faEdit","removeEntry","faTrash","colSpan","boxShadow","borderCollapse","tableLayout","isValidLp","updated","boxSizing","pointerEvents","userSelect","selectedLp","_","i","lineHeight","borderTop","abs","totalDetail","toast","autoClose","warning","success","handleAddNewRow","faPlus","flexShrink","faLock","faFileExport","faPrint","_userDetail$usek_zkr2","printWindow","open","onload","print","onafterprint","ConfirmDialog","onConfirm","deleteEntry","onClose","handleCancelDelete","_bookCheckResult$data","_reloadResult$data","bookCheckResult","currentState","renumberResult","_allBooksResult$data","allBooksResult","booksArray","futureBooks","rok","mesic","sort","b","prevLastP","prevLastV","_bookResult$data2","sortedEntries","newNumber","renumberAllFutureMonths","reloadResult","transformedEntries","closeMonth","_bookCheckResult$data2","recheckError","lockBook","reopenBook","confirmText","cancelText","faLockOpen","showCancel","ModernHelper","pageContext","ToastContainer","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","theme","fontsRegistered","registerRobotoFromCDN","Font","register","family","fonts","fontStyle"],"sourceRoot":""}