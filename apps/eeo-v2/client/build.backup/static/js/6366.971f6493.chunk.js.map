{"version":3,"file":"static/js/6366.971f6493.chunk.js","mappings":"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","sources":["utils/docx/newDocxGenerator.js","components/DocxGeneratorModal.js","services/apiDocxOrders.js"],"sourcesContent":["/**\n * NOV√ù DOCX GENER√ÅTOR - DYNAMICK√â MAPOV√ÅN√ç ZE ≈†ABLONY Z DATAB√ÅZE\n *\n * KL√çƒåOV√â ZMƒöNY:\n * ‚úÖ Naƒç√≠t√° mapov√°n√≠ z datab√°ze (mapovani_json)\n * ‚úÖ ≈Ω√°dn√© hardcoded mapov√°n√≠\n * ‚úÖ Dynamick√© mapov√°n√≠ podle JSON definice ze ≈°ablony\n * ‚úÖ Podpora pro slouƒçen√≠ pol√≠ (+ oper√°tor)\n */\n\nimport JSZip from 'jszip';\nimport { getDocxOrderEnrichedData } from '../../services/apiDocxOrders';\nimport { downloadDocxSablonaAsFile, getDocxSablonaDetail } from '../../services/apiv2Dictionaries';\n\n/**\n * Form√°tuje datum do CZE form√°tu DD.MM.YYYY (bez mezer za teƒçkou)\n * @param {string|Date} value - Datum k form√°tov√°n√≠\n * @returns {string} - Form√°tovan√© datum nebo p≈Øvodn√≠ hodnota\n */\nfunction formatDateForDocx(value) {\n  if (!value) return value;\n\n  // Pokud je to u≈æ form√°tovan√© datum ve spr√°vn√©m form√°tu, vr√°t√≠me ho\n  if (typeof value === 'string' && /^\\d{2}\\.\\d{2}\\.\\d{4}$/.test(value)) {\n    return value;\n  }\n\n  try {\n    let date;\n\n    // Pokud je to string, zkus parsovat\n    if (typeof value === 'string') {\n      // ISO form√°t (YYYY-MM-DD nebo YYYY-MM-DDTHH:mm:ss)\n      if (/^\\d{4}-\\d{2}-\\d{2}/.test(value)) {\n        date = new Date(value);\n      }\n      // DD.MM.YYYY s mo≈æn√Ωmi mezerami\n      else if (/^\\d{1,2}\\.\\s*\\d{1,2}\\.\\s*\\d{4}/.test(value)) {\n        const parts = value.split('.').map(p => p.trim());\n        const day = parseInt(parts[0], 10);\n        const month = parseInt(parts[1], 10) - 1; // mƒõs√≠ce jsou 0-11\n        const year = parseInt(parts[2], 10);\n        date = new Date(year, month, day);\n      }\n      // Zkus√≠me obecn√© parsov√°n√≠\n      else {\n        date = new Date(value);\n      }\n    } else if (value instanceof Date) {\n      date = value;\n    } else {\n      return value; // Nen√≠ datum, vr√°t√≠me p≈Øvodn√≠ hodnotu\n    }\n\n    // Zkontroluj, jestli je datum validn√≠\n    if (isNaN(date.getTime())) {\n      return value; // Neplatn√© datum, vr√°t√≠me p≈Øvodn√≠ hodnotu\n    }\n\n    // Form√°tuj do DD.MM.YYYY (bez mezer)\n    const day = String(date.getDate()).padStart(2, '0');\n    const month = String(date.getMonth() + 1).padStart(2, '0');\n    const year = date.getFullYear();\n\n    return `${day}.${month}.${year}`;\n\n  } catch (error) {\n    // Pokud se nƒõco pokaz√≠, vr√°t√≠me p≈Øvodn√≠ hodnotu\n    return value;\n  }\n}\n\n/**\n * Form√°tuje ƒç√≠slo jako mƒõnu (s mezerami jako oddƒõlovaƒçi tis√≠c≈Ø a 2 desetinn√° m√≠sta)\n * @param {number|string} value - ƒå√≠slo k form√°tov√°n√≠\n * @returns {string} - Form√°tovan√° mƒõna (nap≈ô. \"1 234 567.89\")\n * \n * ‚ö†Ô∏è DEPRECATED: Backend teƒè vrac√≠ u≈æ naform√°tovan√© ceny v enriched endpointu\n * Tuto funkci ponech√°v√°me jen pro zpƒõtnou kompatibilitu\n */\nfunction formatCurrency(value) {\n  if (value === null || value === undefined || value === '') return '0.00';\n\n  const num = parseFloat(value);\n  if (isNaN(num)) return '0.00';\n\n  // Form√°tuj na 2 desetinn√° m√≠sta s mezerou jako oddƒõlovaƒçem tis√≠c≈Ø\n  return num.toFixed(2).replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\n}\n\n/**\n * ‚ö†Ô∏è DEPRECATED: Backend enriched endpoint u≈æ vrac√≠ v≈°echny vypoƒç√≠tan√© hodnoty\n * Tato funkce se NEPOU≈Ω√çV√Å p≈ôi pou≈æit√≠ nov√©ho enriched endpointu\n * \n * Ponech√°no pouze pro referenci nebo fallback\n */\nfunction addCalculatedVariables_DEPRECATED(apiData, selectedUserId = null) {\n\n  const calculated = { ...apiData };\n\n  // Inicializace kategorie pro vypoƒç√≠tan√© promƒõnn√©\n  if (!calculated.vypocitane) {\n    calculated.vypocitane = {};\n  }\n\n  // üßÆ V√ùPOƒåTY Z POLO≈ΩEK OBJEDN√ÅVKY\n  if (apiData.polozky && Array.isArray(apiData.polozky)) {\n\n    let celkovaCenaBezDph = 0;\n    let celkovaCenaSdph = 0;\n\n    apiData.polozky.forEach((polozka, index) => {\n      // ‚ö†Ô∏è OPRAVA: Polo≈æky maj√≠ pole cena_bez_dph a cena_s_dph, NE celkova_cena_*\n      const cena = parseFloat(polozka.cena_bez_dph || 0);\n      const cenaSdph = parseFloat(polozka.cena_s_dph || 0);\n\n      celkovaCenaBezDph += cena;\n      celkovaCenaSdph += cenaSdph;\n\n    });\n\n    const vypocteneDph = celkovaCenaSdph - celkovaCenaBezDph;\n\n    // ‚úÖ Ulo≈æen√≠ vypoƒç√≠tan√Ωch hodnot\n    calculated.vypocitane.celkova_cena_bez_dph = formatCurrency(celkovaCenaBezDph);\n    calculated.vypocitane.celkova_cena_s_dph = formatCurrency(celkovaCenaSdph);\n    calculated.vypocitane.vypoctene_dph = formatCurrency(vypocteneDph);\n\n    // P≈ôid√°me i varianty s jednotkami\n    calculated.vypocitane.celkova_cena_bez_dph_kc = `${formatCurrency(celkovaCenaBezDph)} Kƒç`;\n    calculated.vypocitane.celkova_cena_s_dph_kc = `${formatCurrency(celkovaCenaSdph)} Kƒç`;\n    calculated.vypocitane.vypoctene_dph_kc = `${formatCurrency(vypocteneDph)} Kƒç`;\n\n  } else {\n    calculated.vypocitane.celkova_cena_bez_dph = '0.00';\n    calculated.vypocitane.celkova_cena_s_dph = '0.00';\n    calculated.vypocitane.vypoctene_dph = '0.00';\n    calculated.vypocitane.celkova_cena_bez_dph_kc = '0.00 Kƒç';\n    calculated.vypocitane.celkova_cena_s_dph_kc = '0.00 Kƒç';\n    calculated.vypocitane.vypoctene_dph_kc = '0.00 Kƒç';\n  }\n\n  // üìÖ SPECI√ÅLN√ç PROMƒöNN√â\n  // üë§ U≈ΩIVATEL VYBRAN√ù V DIALOGU (pro podpis)\n  calculated.vypocitane.vybrany_uzivatel_cele_jmeno = '';\n  calculated.vypocitane.vybrany_uzivatel_jmeno = '';\n  calculated.vypocitane.vybrany_uzivatel_prijmeni = '';\n  calculated.vypocitane.vybrany_uzivatel_titul_pred = '';\n  calculated.vypocitane.vybrany_uzivatel_titul_za = '';\n  calculated.vypocitane.vybrany_uzivatel_email = '';\n  calculated.vypocitane.vybrany_uzivatel_telefon = '';\n\n  if (selectedUserId) {\n    // Najdi vybran√©ho u≈æivatele v datech objedn√°vky\n    let selectedUser = null;\n    \n    // ‚úÖ OPRAVA: Zkontroluj v≈°echny mo≈æn√© u≈æivatelsk√© objekty s CORRECT n√°zvy z enriched API\n    // ‚ö†Ô∏è POZOR: Enriched API vrac√≠: garant_uzivatel, prikazce_uzivatel, schvalovatel, uzivatel, atd.\n    // ‚ö†Ô∏è ID jsou ve form√°tu: garant_uzivatel_id, prikazce_id, schvalovatel_id, uzivatel_id\n    \n    if (apiData.garant_uzivatel_id === selectedUserId && apiData.garant_uzivatel) {\n      selectedUser = apiData.garant_uzivatel;\n    } else if (apiData.prikazce_id === selectedUserId && apiData.prikazce_uzivatel) {\n      selectedUser = apiData.prikazce_uzivatel;\n    } else if (apiData.schvalovatel_id === selectedUserId && apiData.schvalovatel) {\n      selectedUser = apiData.schvalovatel;\n    } else if (apiData.uzivatel_id === selectedUserId && apiData.uzivatel) {\n      selectedUser = apiData.uzivatel;\n    } else if (apiData.dodavatel_potvrdil_id === selectedUserId && apiData.dodavatel_potvrdil) {\n      selectedUser = apiData.dodavatel_potvrdil;\n    } else if (apiData.odesilatel_id === selectedUserId && apiData.odesilatel) {\n      selectedUser = apiData.odesilatel;\n    } else if (apiData.fakturant_id === selectedUserId && apiData.fakturant) {\n      selectedUser = apiData.fakturant;\n    } else if (apiData.potvrdil_vecnou_spravnost_id === selectedUserId && apiData.potvrdil_vecnou_spravnost) {\n      selectedUser = apiData.potvrdil_vecnou_spravnost;\n    } else if (apiData.dokoncil_id === selectedUserId && apiData.dokoncil) {\n      selectedUser = apiData.dokoncil;\n    }\n\n    if (selectedUser) {\n      \n      // ‚úÖ OPRAVA: API vrac√≠ 'cele_jmeno' ne 'plne_jmeno'\n      calculated.vypocitane.vybrany_uzivatel_cele_jmeno = selectedUser.cele_jmeno || \n        `${selectedUser.titul_pred || ''} ${selectedUser.jmeno || ''} ${selectedUser.prijmeni || ''} ${selectedUser.titul_za || ''}`.replace(/\\s+/g, ' ').trim();\n      calculated.vypocitane.vybrany_uzivatel_jmeno = selectedUser.jmeno || '';\n      calculated.vypocitane.vybrany_uzivatel_prijmeni = selectedUser.prijmeni || '';\n      calculated.vypocitane.vybrany_uzivatel_titul_pred = selectedUser.titul_pred || '';\n      calculated.vypocitane.vybrany_uzivatel_titul_za = selectedUser.titul_za || '';\n      calculated.vypocitane.vybrany_uzivatel_email = selectedUser.email || '';\n      calculated.vypocitane.vybrany_uzivatel_telefon = selectedUser.telefon || '';\n    }\n  }\n\n  // Placeholder pro u≈æivatelsky vybran√Ω text\n  calculated.vypocitane.uzivatelem_vybrany_text = '[TEXT_VYBRAN_U≈ΩIVATELEM]';\n\n  // üìä STATISTIKY\n  calculated.vypocitane.pocet_polozek = apiData.polozky?.length || 0;\n  calculated.vypocitane.pocet_priloh = apiData.prilohy?.length || 0;\n\n  // üìÖ DATUM GENEROV√ÅN√ç\n  const now = new Date();\n  calculated.vypocitane.datum_generovani = formatDateForDocx(now);\n  calculated.vypocitane.cas_generovani = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;\n  calculated.vypocitane.datum_cas_generovani = `${formatDateForDocx(now)} ${calculated.vypocitane.cas_generovani}`;\n\n\n  return calculated;\n}\n\n/**\n * Hlavn√≠ funkce pro generov√°n√≠ DOCX dokumentu - KOMPLETNƒö DYNAMICK√Å\n * @param {Object} params - Parametry generov√°n√≠\n * @returns {Promise<Blob>} - Vygenerovan√Ω DOCX soubor\n */\nexport async function generateDocxDocument({\n  templateId,\n  orderId,\n  token,\n  username,\n  template,\n  selectedUserId = null\n  // orderData parametr u≈æ NEN√ç POT≈òEBA - pou≈æ√≠v√°me enriched endpoint!\n}) {\n  try {\n    let sablonaData = null;\n\n    // === KROK 0: Naƒçten√≠ detailu ≈°ablony z datab√°ze ===\n\n    try {\n      const templateDetail = await getDocxSablonaDetail({\n        token,\n        username,\n        id: templateId\n      });\n\n      if (!templateDetail || !templateDetail.data) {\n        throw new Error('≈†ablona nenalezena nebo nem√° data');\n      }\n\n      sablonaData = templateDetail.data;\n    } catch (error) {\n      console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ detailu ≈°ablony:', error);\n      throw new Error(`Nepoda≈ôilo se naƒç√≠st ≈°ablonu ID ${templateId}: ${error.message}`);\n    }\n\n    // === KROK 1: Naƒçten√≠ DOCX ≈°ablony ze serveru ===\n\n    const templateFile = await downloadDocxSablonaAsFile({\n      token,\n      username,\n      id: templateId,\n      fileName: sablonaData.nazev || 'template.docx'\n    });\n\n    // === KROK 2: Rozbalen√≠ ZIP struktury ===\n\n    const docxZip = await JSZip.loadAsync(templateFile);\n\n    const documentXml = await docxZip.file('word/document.xml')?.async('text');\n    if (!documentXml) {\n      throw new Error('Neplatn√° DOCX ≈°ablona - chyb√≠ document.xml');\n    }\n\n    // === KROK 3: Naƒçten√≠ DYNAMICK√âHO MAPOV√ÅN√ç z datab√°ze ===\n\n    let templateMapping = {};\n\n    const mappingSource = sablonaData.docx_mapping || sablonaData.mapovani_json;\n\n    if (mappingSource) {\n      try {\n        templateMapping = typeof mappingSource === 'string'\n          ? JSON.parse(mappingSource)\n          : mappingSource;\n\n      } catch (error) {\n        console.error('‚ùå Chyba p≈ôi parsov√°n√≠ mapovani_json:', error);\n        throw new Error(`Neplatn√© JSON mapov√°n√≠ v ≈°ablonƒõ: ${error.message}`);\n      }\n    } else {\n      throw new Error('≈†ablona nem√° definovan√© mapov√°n√≠ pol√≠ (mapovani_json). Nejd≈ô√≠ve upravte ≈°ablonu a definujte mapov√°n√≠.');\n    }\n\n    // === KROK 4: Naƒçten√≠ ENRICHED DAT z nov√©ho endpointu ===\n    \n    // ‚úÖ NOV√ù ENDPOINT: sablona_docx/order-enriched-data\n    // Vrac√≠ KOMPLETN√ç data vƒçetnƒõ enriched u≈æivatel≈Ø a vypoƒç√≠tan√Ωch hodnot\n    const apiData = await getDocxOrderEnrichedData({\n      token,\n      username,\n      objednavka_id: orderId\n    });\n\n    if (!apiData) {\n      throw new Error('Nepoda≈ôilo se z√≠skat enriched data z backendu');\n    }\n    \n    // === KROK 4b: Vybran√Ω u≈æivatel pro podpis ===\n    if (selectedUserId && apiData.vypocitane) {\n      const vybranyUzivatel = apiData.dostupni_uzivatele_pro_podpis?.find(\n        u => parseInt(u.id) === parseInt(selectedUserId)\n      );\n      \n      if (vybranyUzivatel) {\n        \n        // P≈ôidej do vypoƒç√≠tan√Ωch hodnot\n        apiData.vypocitane.vybrany_uzivatel_cele_jmeno = vybranyUzivatel.cele_jmeno;\n        apiData.vypocitane.vybrany_uzivatel_role = vybranyUzivatel.role;\n        apiData.vypocitane.vybrany_uzivatel_lokalita = vybranyUzivatel.lokalita_nazev;\n      }\n    }\n\n    // ‚ö†Ô∏è POZN√ÅMKA: normalizeApiData() a addCalculatedVariables() u≈æ NEN√ç POT≈òEBA!\n    // Backend endpoint vrac√≠ data JI≈Ω NORMALIZOVAN√Å a S VYPOƒå√çTAN√ùMI HODNOTAMI\n\n    // === KROK 5: DYNAMICK√â MAPOV√ÅN√ç pol√≠ ===\n\n    const fieldMapping = createFieldMappingForDocx(apiData, templateMapping);\n\n    // === KROK 6: Vyplnƒõn√≠ XML dat ===\n\n    let filledXml = fillXmlWithFieldData(documentXml, fieldMapping);\n\n    // === KROK 7: Zabalen√≠ zpƒõt do ZIP ===\n\n    docxZip.file('word/document.xml', filledXml);\n\n    const outputBlob = await docxZip.generateAsync({\n      type: 'blob',\n      mimeType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n    });\n\n\n    return outputBlob;\n\n  } catch (error) {\n    console.error('‚ùå Chyba p≈ôi generov√°n√≠ DOCX:', error);\n    throw error;\n  }\n}\n\n/**\n * DYNAMICK√â MAPOV√ÅN√ç POL√ç - podle JSON definice ze ≈°ablony\n * @param {Object} apiData - Data z POST /api.eeo/sablona_docx/order-data\n * @param {Object} templateMapping - JSON mapov√°n√≠ ze ≈°ablony (mapovani_json)\n * @returns {Object} - Namapovan√° pole pro DOCX\n */\nfunction createFieldMappingForDocx(apiData, templateMapping) {\n\n  const mappedData = {};\n  const missingFields = [];\n\n  // PROCH√ÅZ√çME MAPOV√ÅN√ç ZE ≈†ABLONY - ka≈æd√© pole mapujeme podle definice\n  Object.entries(templateMapping).forEach(([docxField, dbPath]) => {\n    let value = '';\n\n    try {\n      // Zpracov√°n√≠ speci√°ln√≠ch p≈ô√≠pad≈Ø (+ oper√°tor pro slouƒçen√≠)\n      if (typeof dbPath === 'string' && dbPath.includes(' + ')) {\n        // Slouƒçen√≠ v√≠ce pol√≠ (nap≈ô. \"objednatel.prijmeni + objednatel.jmeno\")\n        const parts = dbPath.split(' + ').map(part => part.trim());\n        const values = parts.map(part => {\n          const v = getValueFromPath(apiData, part) || '';\n          // Form√°tuj datum pokud to vypad√° jako datum\n          return formatDateForDocx(v);\n        }).filter(v => v);\n        value = values.join(' ');\n\n      } else {\n        // Standardn√≠ mapov√°n√≠ pomoc√≠ teƒçkov√© notace\n        value = getValueFromPath(apiData, dbPath);\n\n        if (value === undefined || value === null) {\n          missingFields.push({ docxField, dbPath });\n          value = '';\n        } else {\n          // Form√°tuj datum pokud to vypad√° jako datum\n          value = formatDateForDocx(value);\n        }\n      }\n    } catch (error) {\n      value = '';\n    }\n\n    mappedData[docxField] = String(value || '');\n  });\n\n  return mappedData;\n}\n\n/**\n * ‚ö†Ô∏è DEPRECATED: Backend enriched endpoint u≈æ vrac√≠ normalizovan√° data\n * Tato funkce se NEPOU≈Ω√çV√Å p≈ôi pou≈æit√≠ nov√©ho enriched endpointu\n * \n * Ponech√°no pouze pro referenci nebo fallback\n */\nfunction normalizeApiData_DEPRECATED(data) {\n  if (!data || typeof data !== 'object') return data;\n\n\n  const normalized = Array.isArray(data) ? [] : {};\n\n  for (const [key, value] of Object.entries(data)) {\n    if (typeof value === 'string' && value.trim() !== '') {\n      // Zkus√≠me parsovat jako JSON\n      try {\n        const parsed = JSON.parse(value);\n        // Pokud je to objekt nebo array, pou≈æijeme parsovanou hodnotu a rekurzivnƒõ normalizujeme\n        if (typeof parsed === 'object' && parsed !== null) {\n          normalized[key] = normalizeApiData_DEPRECATED(parsed);\n        } else {\n          // Primitiva nech√°me jako string\n          normalized[key] = value;\n        }\n      } catch {\n        // Nen√≠ platn√Ω JSON, ponech√°me p≈Øvodn√≠ string\n        normalized[key] = value;\n      }\n    } else if (typeof value === 'object' && value !== null) {\n      // Rekurzivnƒõ normalizujeme vno≈ôen√© objekty/arrays\n      normalized[key] = normalizeApiData_DEPRECATED(value);\n    } else {\n      // Primitiva (ƒç√≠sla, bool, null) ponech√°me\n      normalized[key] = value;\n    }\n  }\n\n  return normalized;\n}\n\n/**\n * Z√≠sk√° hodnotu z vno≈ôen√©ho objektu podle cesty\n * Podporuje:\n * - Teƒçkovou notaci: \"objednatel.jmeno\" (pro vno≈ôen√© objekty)\n * - Flat notaci: \"dodavatel_kontakt_telefon\" (pro flat fields)\n * - Array indexy: \"prilohy[0].nazev\"\n * - Kombinace: \"prilohy[0].nahrano_uzivatel.jmeno\"\n */\nfunction getValueFromPath(obj, path) {\n  if (!obj || !path) return undefined;\n\n  try {\n    // Rozdƒõl cestu na ƒç√°sti a zpracuj array indexy\n    // Nap≈ô: \"prilohy[0].originalni_nazev_souboru\" ‚Üí [\"prilohy\", \"0\", \"originalni_nazev_souboru\"]\n    const parts = path\n      .replace(/\\[(\\d+)\\]/g, '.$1') // P≈ôeveƒè [0] na .0\n      .split('.')\n      .filter(part => part !== ''); // Odstra≈à pr√°zdn√© ƒç√°sti\n\n    return parts.reduce((current, key) => {\n      if (current === undefined || current === null) return undefined;\n\n      // Pokud je kl√≠ƒç ƒç√≠slo, p≈ôistupuj jako k array indexu\n      if (/^\\d+$/.test(key)) {\n        const index = parseInt(key, 10);\n        return Array.isArray(current) && current[index] !== undefined\n          ? current[index]\n          : undefined;\n      }\n\n      // Jinak p≈ôistupuj jako k property objektu\n      return current[key];\n    }, obj);\n  } catch (error) {\n    return undefined;\n  }\n}\n\n/**\n * Napln√≠ XML data - SPR√ÅVN√ù ALGORITMUS z plugins/processDocx.js\n * Parsuje XML a nahrazuje DOCVARIABLE/MERGEFIELD pole pomoc√≠ DOM\n * NEMAPOVAN√Å POLE SE ODSTRAN√ç Z DOKUMENTU\n */\nfunction fillXmlWithFieldData(xmlContent, fieldValues) {\n\n  try {\n    const parser = new window.DOMParser();\n    const serializer = new window.XMLSerializer();\n    const xmlDoc = parser.parseFromString(xmlContent, 'application/xml');\n\n    let replacementCount = 0;\n    let removedCount = 0;\n\n    function processNode(node) {\n      if (!node || !node.childNodes) return;\n\n      // Najdi v≈°echny <w:r> elementy (runs)\n      let runs = [];\n      for (let i = 0; i < node.childNodes.length; i++) {\n        const n = node.childNodes[i];\n        if (n.nodeType === 1 && n.localName === 'r') runs.push(n);\n      }\n\n      let i = 0;\n      while (i < runs.length) {\n        let beginIdx = -1, endIdx = -1, fieldName = null, instr = '';\n\n        // Najdi begin fldChar\n        for (let j = i; j < runs.length; j++) {\n          const r = runs[j];\n          for (let k = 0; k < r.childNodes.length; k++) {\n            const n = r.childNodes[k];\n            if (n.nodeType === 1 && n.localName === 'fldChar') {\n              const typ = n.getAttribute('w:fldCharType') || n.getAttribute('fldCharType');\n              if (typ === 'begin') {\n                beginIdx = j;\n\n                // Najdi instrText a end fldChar\n                let foundEnd = false;\n                for (let m = j + 1; m < runs.length; m++) {\n                  const r2 = runs[m];\n                  for (let n2 = 0; n2 < r2.childNodes.length; n2++) {\n                    const nInstr = r2.childNodes[n2];\n                    if (nInstr.nodeType === 1 && nInstr.localName === 'instrText') {\n                      instr += nInstr.textContent;\n                    }\n                    if (nInstr.nodeType === 1 && nInstr.localName === 'fldChar') {\n                      const typ2 = nInstr.getAttribute('w:fldCharType') || nInstr.getAttribute('fldCharType');\n                      if (typ2 === 'end') {\n                        endIdx = m;\n                        foundEnd = true;\n                        break;\n                      }\n                    }\n                  }\n                  if (foundEnd) break;\n                }\n\n                // Parsuj n√°zev pole z instrText\n                const m = /(DOCVARIABLE|MERGEFIELD)\\s+([A-Z0-9_._ ]{1,})/i.exec(instr.replace(/\\s+/g, ' '));\n                if (m) {\n                  fieldName = m[2].replace(/\\s+/g, '');\n                }\n                break;\n              }\n            }\n          }\n          if (beginIdx !== -1) break;\n        }\n\n        // Pokud m√°me kompletn√≠ pole (begin...end)\n        if (beginIdx !== -1 && endIdx !== -1 && fieldName) {\n          const val = fieldValues[fieldName];\n\n          // KONTROLA: Pokud pole NEN√ç v mapov√°n√≠, ODSTRAN√çME ho\n          if (!(fieldName in fieldValues)) {\n\n            // Sma≈æ v≈°echny runs vƒçetnƒõ begin a end\n            for (let del = endIdx; del >= beginIdx; del--) {\n              node.removeChild(runs[del]);\n            }\n\n            // Refresh seznam runs\n            runs = Array.from(node.childNodes).filter(n => n.nodeType === 1 && n.localName === 'r');\n            i = 0;\n            removedCount++;\n            continue;\n          }\n\n          // Pokud m√°me hodnotu (i kdy≈æ je pr√°zdn√°), vypln√≠me ji\n          if (val !== undefined && val !== null) {\n\n            // Nahraƒè prvn√≠ run hodnotou\n            const firstR = runs[beginIdx];\n            while (firstR.firstChild) firstR.removeChild(firstR.firstChild);\n            const tNew = xmlDoc.createElementNS(firstR.namespaceURI, 'w:t');\n            tNew.textContent = String(val);\n            firstR.appendChild(tNew);\n\n            // Sma≈æ v≈°echny runs mezi begin a end\n            for (let del = endIdx; del > beginIdx; del--) {\n              node.removeChild(runs[del]);\n            }\n\n            // Refresh seznam runs\n            runs = Array.from(node.childNodes).filter(n => n.nodeType === 1 && n.localName === 'r');\n            i = 0;\n            replacementCount++;\n            continue;\n          }\n        }\n\n        i++;\n      }\n\n      // Rekurzivnƒõ zpracuj child nodes\n      for (let i = 0; i < node.childNodes.length; i++) {\n        processNode(node.childNodes[i]);\n      }\n    }\n\n    processNode(xmlDoc.documentElement);\n\n    return serializer.serializeToString(xmlDoc);\n\n  } catch (error) {\n    console.error('‚ùå Chyba p≈ôi DOM parsov√°n√≠ XML:', error);\n\n    // Fallback - jednoduch√Ω string replace pro {FIELD_NAME}\n    let filledXml = xmlContent;\n    Object.entries(fieldValues).forEach(([fieldName, value]) => {\n      const pattern = `{${fieldName}}`;\n      if (filledXml.includes(pattern)) {\n        filledXml = filledXml.replace(new RegExp(escapeRegExp(pattern), 'g'), String(value || ''));\n      }\n    });\n\n    return filledXml;\n  }\n}\n\n/**\n * Escape regex special characters\n */\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\n/**\n * St√°hne vygenerovan√Ω DOCX soubor\n */\nexport function downloadGeneratedDocx(docxBlob, fileName) {\n  const url = window.URL.createObjectURL(docxBlob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = fileName;\n  document.body.appendChild(a);\n  a.click();\n  window.URL.revokeObjectURL(url);\n  document.body.removeChild(a);\n}\n","import React, { useState, useEffect, useContext } from 'react';\nimport ReactDOM from 'react-dom';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faTimes,\n  faFileWord,\n  faDownload,\n  faSpinner,\n  faExclamationTriangle,\n  faInfoCircle,\n  faUser\n} from '@fortawesome/free-solid-svg-icons';\nimport { AuthContext } from '../context/AuthContext';\nimport { ToastContext } from '../context/ToastContext';\nimport { getDocxSablonyList } from '../services/apiv2Dictionaries';\nimport { getDocxOrderData } from '../services/apiDocxOrders';\n// ‚úÖ NOV√ù DYNAMICK√ù SYST√âM - pou≈æ√≠v√° POUZE mapov√°n√≠ z DB (mapovani_json)\nimport { generateDocxDocument, downloadGeneratedDocx } from '../utils/docx/newDocxGenerator';\n\n// ============================================================================\n// ‚úÖ SJEDNOCEN√ù STYLING - stejn√Ω jako ostatn√≠ dialogy v Orders25List\n// ============================================================================\n\nconst ModalOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(12px);\n  -webkit-backdrop-filter: blur(12px);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 9999;\n  animation: fadeIn 0.2s ease-out;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n`;\n\nconst ModalContainer = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 0;\n  max-width: 1200px;\n  width: 95%;\n  max-height: 90vh;\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\n  border: 1px solid #e5e7eb;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  animation: slideUp 0.3s ease-out;\n\n  @keyframes slideUp {\n    from {\n      opacity: 0;\n      transform: translateY(20px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n`;\n\nconst ModalHeader = styled.div`\n  padding: 1.5rem;\n  border-bottom: 1px solid #e5e7eb;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n\n  h2 {\n    margin: 0;\n    color: white;\n    font-size: 1.25rem;\n    font-weight: 700;\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n\n    svg {\n      color: white;\n    }\n  }\n`;\n\nconst CloseButton = styled.button`\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  padding: 0.5rem;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.2);\n    color: white;\n  }\n\n  &:active {\n    transform: scale(0.95);\n  }\n`;\n\nconst ModalBody = styled.div`\n  padding: 1.5rem;\n  overflow-y: auto;\n  flex: 1;\n  display: flex;\n  gap: 1.5rem;\n\n  @media (max-width: 1200px) {\n    flex-direction: column;\n  }\n`;\n\n// Lev√Ω sloupec - Info + V√Ωbƒõr u≈æivatele\nconst LeftColumn = styled.div`\n  flex: 0 0 400px;\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n\n  @media (max-width: 1200px) {\n    flex: 1;\n  }\n`;\n\n// Prav√Ω sloupec - Seznam ≈°ablon\nconst RightColumn = styled.div`\n  flex: 1;\n  min-width: 0; /* Umo≈æn√≠ spr√°vn√© shrinkov√°n√≠ */\n`;\n\nconst InfoGrid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 0.75rem;\n\n  @media (max-width: 640px) {\n    grid-template-columns: 1fr;\n  }\n`;\n\nconst InfoItem = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n\n  &.full-width {\n    grid-column: 1 / -1;\n  }\n`;\n\nconst InfoDivider = styled.div`\n  grid-column: 1 / -1;\n  border-top: 1px solid #cbd5e1;\n  margin: 0.5rem 0;\n`;\n\n// ‚úÖ Styled komponenta pro info box objedn√°vky\nconst OrderInfoBox = styled.div`\n  background: linear-gradient(135deg, #dbeafe 0%, #f0f9ff 100%);\n  border: 2px solid #93c5fd;\n  border-radius: 12px;\n  padding: 1.25rem;\n  margin-bottom: 1.5rem;\n\n  h3 {\n    margin: 0 0 1rem 0;\n    color: #1e40af;\n    font-size: 1.05rem;\n    font-weight: 700;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n\n    svg {\n      color: #3b82f6;\n    }\n  }\n`;\n\n// ‚úÖ NOV√â: Styled komponenty pro v√Ωbƒõr u≈æivatele\nconst UserSelectSection = styled.div`\n  background: linear-gradient(135deg, #fef3c7 0%, #fef9f5 100%);\n  border: 2px solid #fcd34d;\n  border-radius: 12px;\n  padding: 1.25rem;\n  margin-bottom: 1.5rem;\n\n  h3 {\n    margin: 0 0 1rem 0;\n    color: #92400e;\n    font-size: 1.05rem;\n    font-weight: 700;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n\n    svg {\n      color: #f59e0b;\n    }\n  }\n\n  p {\n    margin: 0 0 1rem 0;\n    color: #78350f;\n    font-size: 0.875rem;\n    line-height: 1.5;\n  }\n`;\n\nconst Select = styled.select`\n  width: 100%;\n  padding: 0.75rem;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  font-weight: 500;\n  color: #1e293b;\n  background: white;\n  cursor: pointer;\n  transition: all 0.2s;\n\n  &:hover {\n    border-color: #10b981;\n  }\n\n  &:focus {\n    outline: none;\n    border-color: #10b981;\n    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);\n  }\n\n  &:disabled {\n    background: #f1f5f9;\n    cursor: not-allowed;\n    opacity: 0.6;\n  }\n\n  option {\n    padding: 0.5rem;\n  }\n\n  option:disabled {\n    color: #94a3b8;\n    font-style: italic;\n  }\n`;\n\nconst InfoLabel = styled.span`\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n`;\n\nconst InfoValue = styled.span`\n  font-size: 0.95rem;\n  color: #1e293b;\n  font-weight: 500;\n\n  &.highlighted {\n    color: #3b82f6;\n    font-weight: 700;\n    font-size: 1.05rem;\n  }\n\n  &.price {\n    color: #059669;\n    font-weight: 700;\n  }\n\n  &.missing {\n    color: #94a3b8;\n    font-style: italic;\n  }\n`;\n\nconst TemplatesList = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n`;\n\nconst TemplatesHeader = styled.div`\n  margin-bottom: 1rem;\n\n  h3 {\n    margin: 0 0 0.5rem 0;\n    color: #374151;\n    font-size: 1.05rem;\n    font-weight: 700;\n  }\n\n  p {\n    margin: 0;\n    color: #64748b;\n    font-size: 0.875rem;\n  }\n`;\n\nconst TemplateItem = styled.div`\n  border: 2px solid ${props => props.$selected ? '#3b82f6' : '#e5e7eb'};\n  border-radius: 10px;\n  padding: 1.25rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  background: ${props => props.$selected ? '#eff6ff' : 'white'};\n  position: relative;\n\n  &:hover {\n    border-color: ${props => props.$selected ? '#2563eb' : '#cbd5e1'};\n    background: ${props => props.$selected ? '#eff6ff' : '#f8fafc'};\n    transform: translateX(4px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n\n  &:active {\n    transform: translateX(2px);\n  }\n\n  ${props => props.$selected && `\n    &::after {\n      content: '‚úì';\n      position: absolute;\n      top: 1rem;\n      right: 1rem;\n      width: 28px;\n      height: 28px;\n      background: #3b82f6;\n      color: white;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-weight: 700;\n      font-size: 0.875rem;\n    }\n  `}\n\n  h4 {\n    margin: 0 0 0.5rem 0;\n    color: #1e293b;\n    font-size: 1.05rem;\n    font-weight: 700;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding-right: ${props => props.$selected ? '2.5rem' : '0'};\n\n    svg {\n      color: ${props => props.$selected ? '#3b82f6' : '#64748b'};\n    }\n\n    .template-type {\n      font-size: 0.8rem;\n      font-weight: 400;\n      color: #94a3b8;\n      margin-left: 0.25rem;\n    }\n  }\n\n  p {\n    margin: 0.5rem 0;\n    color: #64748b;\n    font-size: 0.875rem;\n    line-height: 1.5;\n  }\n\n  .meta {\n    font-size: 0.75rem;\n    color: #94a3b8;\n    margin-top: 0.75rem;\n    padding-top: 0.75rem;\n    border-top: 1px solid #e5e7eb;\n    display: flex;\n    gap: 0.75rem;\n    flex-wrap: wrap;\n\n    span {\n      display: inline-flex;\n      align-items: center;\n      gap: 0.25rem;\n\n      &::before {\n        content: '‚Ä¢';\n        color: #cbd5e1;\n      }\n\n      &:first-of-type::before {\n        content: '';\n      }\n    }\n  }\n`;\n\nconst ModalFooter = styled.div`\n  padding: 1.5rem;\n  border-top: 1px solid #e5e7eb;\n  display: flex;\n  gap: 1rem;\n  justify-content: flex-end;\n  background: #f8fafc;\n`;\n\nconst Button = styled.button`\n  padding: 0.75rem 1.5rem;\n  border-radius: 8px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  border: 2px solid;\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  &:not(:disabled):active {\n    transform: translateY(1px);\n  }\n`;\n\nconst CancelButton = styled(Button)`\n  background: white;\n  border-color: #d1d5db;\n  color: #6b7280;\n\n  &:hover:not(:disabled) {\n    background: #f9fafb;\n    border-color: #9ca3af;\n    color: #374151;\n  }\n`;\n\nconst GenerateButton = styled(Button)`\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  border-color: #10b981;\n  color: white;\n\n  &:hover:not(:disabled) {\n    background: linear-gradient(135deg, #059669 0%, #047857 100%);\n    border-color: #059669;\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.25);\n  }\n`;\n\nconst LoadingMessage = styled.div`\n  text-align: center;\n  padding: 3rem 2rem;\n  color: #64748b;\n\n  .spinner {\n    margin-bottom: 1rem;\n    font-size: 2.5rem;\n    color: #3b82f6;\n    animation: spin 1s linear infinite;\n  }\n\n  p {\n    margin: 0;\n    font-size: 1rem;\n  }\n\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n  }\n`;\n\nconst ErrorMessage = styled.div`\n  text-align: center;\n  padding: 3rem 2rem;\n  color: #dc2626;\n\n  .icon {\n    margin-bottom: 1rem;\n    font-size: 2.5rem;\n  }\n\n  p {\n    margin: 0;\n    font-size: 1rem;\n    line-height: 1.6;\n  }\n`;\n\nconst NoTemplatesMessage = styled.div`\n  text-align: center;\n  padding: 3rem 2rem;\n  color: #64748b;\n\n  .icon {\n    margin-bottom: 1rem;\n    font-size: 2.5rem;\n  }\n\n  p {\n    margin: 0;\n    font-size: 1rem;\n  }\n`;\n\nexport const DocxGeneratorModal = ({ order, isOpen, onClose }) => {\n  const { user, token } = useContext(AuthContext);\n  const { showToast } = useContext(ToastContext);\n\n  const [templates, setTemplates] = useState([]);\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [error, setError] = useState(null);\n  const [selectedUserIndex, setSelectedUserIndex] = useState(-1); // ‚úÖ INDEX vybran√©ho u≈æivatele v poli\n  const [availableUsers, setAvailableUsers] = useState([]); // ‚úÖ Dostupn√≠ u≈æivatel√© z workflow\n\n  // Naƒçten√≠ ≈°ablon a u≈æivatel≈Ø p≈ôi otev≈ôen√≠ modalu\n  useEffect(() => {\n    if (!isOpen || !order) return;\n\n    // ‚úÖ Naƒçti u≈æivatele p≈ô√≠mo z order objektu (ji≈æ je enriched ze seznamu)\n    // ‚ö†Ô∏è POZOR: Enriched API vrac√≠ objekty s podtr≈æ√≠tky: garant_uzivatel, prikazce_uzivatel, ...\n    // \n    // üîÆ FUTURE: Backend enriched endpoint vrac√≠ p≈ô√≠mo pole `dostupni_uzivatele_pro_podpis[]`\n    // kter√© obsahuje v≈°echny tyto u≈æivatele v jednotn√© struktu≈ôe:\n    // { id, cele_jmeno, role, lokalita_nazev }\n    // A≈æ bude backend ready, m≈Ø≈æeme pou≈æ√≠t p≈ô√≠mo ten seznam.\n    const loadAvailableUsers = () => {\n      const users = [];\n\n      // Garant (order.garant_uzivatel objekt, ID na order.garant_uzivatel_id)\n      if (order.garant_uzivatel_id && order.garant_uzivatel?.cele_jmeno &&\n          order.garant_uzivatel.cele_jmeno !== 'Nezad√°no' && order.garant_uzivatel.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.garant_uzivatel_id,\n          name: order.garant_uzivatel.cele_jmeno,\n          role: 'Garant'\n        });\n      }\n\n      // P≈ô√≠kazce (order.prikazce_uzivatel objekt, ID na order.prikazce_id)\n      if (order.prikazce_id && order.prikazce_uzivatel?.cele_jmeno &&\n          order.prikazce_uzivatel.cele_jmeno !== 'Nezad√°no' && order.prikazce_uzivatel.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.prikazce_id,\n          name: order.prikazce_uzivatel.cele_jmeno,\n          role: 'P≈ô√≠kazce'\n        });\n      }\n\n      // Schvalovatel (order.schvalovatel objekt, ID na order.schvalovatel_id)\n      if (order.schvalovatel_id && order.schvalovatel?.cele_jmeno &&\n          order.schvalovatel.cele_jmeno !== 'Nezad√°no' && order.schvalovatel.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.schvalovatel_id,\n          name: order.schvalovatel.cele_jmeno,\n          role: 'Schvalovatel'\n        });\n      }\n\n      // Objednatel (order.uzivatel objekt - ten kdo vytvo≈ôil, ID na order.uzivatel_id)\n      if (order.uzivatel_id && order.uzivatel?.cele_jmeno &&\n          order.uzivatel.cele_jmeno !== 'Nezad√°no' && order.uzivatel.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.uzivatel_id,\n          name: order.uzivatel.cele_jmeno,\n          role: 'Objednatel'\n        });\n      }\n\n      // Dodavatel potvrdil (order.dodavatel_potvrdil objekt, ID na order.dodavatel_potvrdil_id)\n      if (order.dodavatel_potvrdil_id && order.dodavatel_potvrdil?.cele_jmeno &&\n          order.dodavatel_potvrdil.cele_jmeno !== 'Nezad√°no' && order.dodavatel_potvrdil.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.dodavatel_potvrdil_id,\n          name: order.dodavatel_potvrdil.cele_jmeno,\n          role: 'Dodavatel potvrdil'\n        });\n      }\n\n      // Odes√≠latel (order.odesilatel objekt, ID na order.odesilatel_id)\n      if (order.odesilatel_id && order.odesilatel?.cele_jmeno &&\n          order.odesilatel.cele_jmeno !== 'Nezad√°no' && order.odesilatel.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.odesilatel_id,\n          name: order.odesilatel.cele_jmeno,\n          role: 'Odes√≠latel'\n        });\n      }\n\n      // Fakturant (order.fakturant objekt, ID na order.fakturant_id)\n      if (order.fakturant_id && order.fakturant?.cele_jmeno &&\n          order.fakturant.cele_jmeno !== 'Nezad√°no' && order.fakturant.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.fakturant_id,\n          name: order.fakturant.cele_jmeno,\n          role: 'Fakturant'\n        });\n      }\n\n      // Potvrdil vƒõcnou spr√°vnost (order.potvrdil_vecnou_spravnost objekt, ID na order.potvrdil_vecnou_spravnost_id)\n      if (order.potvrdil_vecnou_spravnost_id && order.potvrdil_vecnou_spravnost?.cele_jmeno &&\n          order.potvrdil_vecnou_spravnost.cele_jmeno !== 'Nezad√°no' && order.potvrdil_vecnou_spravnost.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.potvrdil_vecnou_spravnost_id,\n          name: order.potvrdil_vecnou_spravnost.cele_jmeno,\n          role: 'Potvrdil vƒõcnou spr√°vnost'\n        });\n      }\n\n      // Dokonƒçil objedn√°vku (order.dokoncil objekt, ID na order.dokoncil_id)\n      if (order.dokoncil_id && order.dokoncil?.cele_jmeno &&\n          order.dokoncil.cele_jmeno !== 'Nezad√°no' && order.dokoncil.cele_jmeno !== 'Nezadano') {\n        users.push({\n          id: order.dokoncil_id,\n          name: order.dokoncil.cele_jmeno,\n          role: 'Dokonƒçil objedn√°vku'\n        });\n      }\n\n      setAvailableUsers(users);\n\n      // Automaticky vyber p≈ô√≠kazce, pokud existuje, jinak prvn√≠ho u≈æivatele\n      if (users.length > 0) {\n        const prikazceIndex = users.findIndex(u => u.role === 'P≈ô√≠kazce');\n        setSelectedUserIndex(prikazceIndex !== -1 ? prikazceIndex : 0);\n      }\n    };\n\n    const loadTemplates = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n\n        const response = await getDocxSablonyList({\n          token,\n          username: user?.username,\n          aktivni: 1 // Pouze aktivn√≠ ≈°ablony\n        });\n\n        const templates = response?.data || [];\n        setTemplates(templates);\n\n        if (templates.length === 0) {\n          setError('V datab√°zi nejsou k dispozici ≈æ√°dn√© aktivn√≠ DOCX ≈°ablony');\n        } else if (templates.length === 1) {\n          // Automaticky vyber prvn√≠ ≈°ablonu pokud je jen jedna\n          setSelectedTemplate(templates[0]);\n        }\n\n      } catch (error) {\n        setError(`Nepoda≈ôilo se naƒç√≠st seznam DOCX ≈°ablon: ${error.message}`);\n        showToast?.(`Chyba p≈ôi naƒç√≠t√°n√≠ DOCX ≈°ablon: ${error.message}`, { type: 'error' });\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    // Naƒçti u≈æivatele z u≈æ enriched order objektu\n    loadAvailableUsers();\n    // Naƒçti ≈°ablony paralelnƒõ\n    loadTemplates();\n\n  }, [isOpen, order, token, user, showToast]); // ‚úÖ V≈°echny z√°vislosti\n\n  const handleGenerateDocx = async () => {\n    if (!selectedTemplate || !order) return;\n\n    // ‚úÖ VALIDACE: Zkontroluj, jestli je vybr√°n u≈æivatel\n    if (selectedUserIndex === -1 || !availableUsers[selectedUserIndex]) {\n      showToast?.('Pros√≠m vyberte u≈æivatele, kter√Ω bude dosazen do dokumentu', { type: 'warning' });\n      return;\n    }\n\n    const selectedUser = availableUsers[selectedUserIndex];\n    const selectedUserId = selectedUser.id;\n\n\n    try {\n      setGenerating(true);\n\n      // KRITICK√â: Detekuj ID objedn√°vky\n      const orderId = order.id || order.objednavka_id || order.order_id;\n\n      if (!orderId) {\n        throw new Error('Chyb√≠ ID objedn√°vky');\n      }\n\n      // ‚úÖ POU≈ΩIJEME order Z MODALU - u≈æ m√° enriched u≈æivatele (garant_uzivatel, prikazce_uzivatel atd.)\n\n      // === NOV√ù SYST√âM - DOCX gener√°tor: enriched endpoint ===\n      // ‚úÖ orderData parametr u≈æ NEN√ç POT≈òEBA - pou≈æ√≠v√°me enriched endpoint!\n      // Backend vrac√≠ KOMPLETN√ç data vƒçetnƒõ v≈°ech enriched u≈æivatel≈Ø\n      const generatedDocx = await generateDocxDocument({\n        templateId: selectedTemplate.id,\n        orderId: orderId,\n        token: token,\n        username: user?.username,\n        template: selectedTemplate,\n        selectedUserId: selectedUserId // ‚úÖ ID vybran√©ho u≈æivatele pro podpis\n      });\n\n      // St√°hni vygenerovan√Ω dokument\n      const fileName = `objednavka_${order.cislo_objednavky || orderId}_${selectedTemplate.nazev}.docx`;\n      downloadGeneratedDocx(generatedDocx, fileName);\n\n      showToast?.(\n        `üìÑ DOCX dokument \"${selectedTemplate.nazev}\" byl √∫spƒõ≈°nƒõ vygenerov√°n a sta≈æen`,\n        { type: 'success' }\n      );\n\n      onClose();\n\n    } catch (error) {\n      showToast?.(\n        `Chyba p≈ôi generov√°n√≠ DOCX dokumentu: ${error.message}`,\n        { type: 'error' }\n      );\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  // ‚úÖ HELPER: Form√°tov√°n√≠ ceny\n  const formatPrice = (price) => {\n    if (!price) return null;\n    return new Intl.NumberFormat('cs-CZ', {\n      style: 'currency',\n      currency: 'CZK',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2\n    }).format(price);\n  };\n\n\n\n  if (!isOpen) return null;\n\n  return ReactDOM.createPortal(\n    <ModalOverlay onClick={onClose}>\n      <ModalContainer onClick={e => e.stopPropagation()}>\n        <ModalHeader>\n          <h2>\n            <FontAwesomeIcon icon={faFileWord} />\n            Generovat DOCX dokument\n          </h2>\n          <CloseButton onClick={onClose} title=\"Zav≈ô√≠t\">\n            <FontAwesomeIcon icon={faTimes} />\n          </CloseButton>\n        </ModalHeader>\n\n        <ModalBody>\n          {/* LEV√ù SLOUPEC - Info o objedn√°vce + V√Ωbƒõr u≈æivatele */}\n          <LeftColumn>\n            {/* ‚úÖ ZOBRAZEN√ç OBJEDN√ÅVKY */}\n            {order && (\n              <OrderInfoBox>\n                <h3>\n                  <FontAwesomeIcon icon={faInfoCircle} />\n                  Informace o objedn√°vce\n                </h3>\n                <InfoGrid>\n                  <InfoItem className=\"full-width\">\n                    <InfoLabel>ƒå√çSLO OBJEDN√ÅVKY</InfoLabel>\n                    <InfoValue className=\"highlighted\">\n                      {order?.cislo_objednavky || order?.id || 'N/A'}\n                    </InfoValue>\n                  </InfoItem>\n\n                  <InfoItem className=\"full-width\">\n                    <InfoLabel>P≈òEDMƒöT</InfoLabel>\n                    <InfoValue>\n                      {order?.predmet || order?.nazev || <span className=\"missing\">Bez p≈ôedmƒõtu</span>}\n                    </InfoValue>\n                  </InfoItem>\n\n                  <InfoDivider />\n\n                  <InfoItem>\n                    <InfoLabel>STAV</InfoLabel>\n                    <InfoValue>\n                      {order?.stav_objednavky || <span className=\"missing\">Nezn√°m√Ω</span>}\n                    </InfoValue>\n                  </InfoItem>\n\n                  <InfoItem>\n                    <InfoLabel>CELKOV√Å CENA S DPH</InfoLabel>\n                    <InfoValue className=\"price\">\n                      {formatPrice(order?.max_cena_s_dph || order?.polozky_celkova_cena_s_dph) || <span className=\"missing\">Nezad√°no</span>}\n                    </InfoValue>\n                  </InfoItem>\n\n                  <InfoItem>\n                    <InfoLabel>DODAVATEL</InfoLabel>\n                    <InfoValue>\n                      {order?.dodavatel_nazev || <span className=\"missing\">Nezad√°no</span>}\n                    </InfoValue>\n                  </InfoItem>\n\n                  <InfoItem>\n                    <InfoLabel>IƒåO</InfoLabel>\n                    <InfoValue>\n                      {order?.dodavatel_ico || <span className=\"missing\">Nezad√°no</span>}\n                    </InfoValue>\n                  </InfoItem>\n\n                  <InfoItem>\n                    <InfoLabel>GARANT</InfoLabel>\n                    <InfoValue>\n                      {order?.garant_uzivatel?.cele_jmeno || <span className=\"missing\">Nezad√°no</span>}\n                    </InfoValue>\n                  </InfoItem>\n                </InfoGrid>\n              </OrderInfoBox>\n            )}\n\n            {/* ‚úÖ V√ùBƒöR U≈ΩIVATELE */}\n            {!loading && !error && order && (\n              <UserSelectSection>\n                <h3>\n                  <FontAwesomeIcon icon={faUser} />\n                  Vyberte u≈æivatele pro dokument\n                </h3>\n                <p>\n                  Vybran√Ω u≈æivatel bude dosazen do vypoƒç√≠tan√Ωch pol√≠ dokumentu (cel√© jm√©no vƒçetnƒõ titul≈Ø).\n                  {availableUsers.length > 0\n                    ? ' M≈Ø≈æete vybrat garanta, p≈ôikazce, schvalovatele nebo jin√©ho u≈æivatele z workflow.'\n                    : ' ‚ö†Ô∏è V t√©to objedn√°vce nejsou definov√°ni ≈æ√°dn√≠ u≈æivatel√© (v≈°ichni jsou \"Nezad√°no\").'}\n                </p>\n                {availableUsers.length > 0 ? (\n                  <Select\n                    value={selectedUserIndex}\n                    onChange={(e) => setSelectedUserIndex(parseInt(e.target.value, 10))}\n                    disabled={generating}\n                  >\n                    <option value=\"-1\" disabled>-- Vyberte u≈æivatele --</option>\n                    {availableUsers.map((user, index) => (\n                      <option key={index} value={index}>\n                        {user.name} ({user.role})\n                      </option>\n                    ))}\n                  </Select>\n                ) : (\n                  <div style={{\n                    padding: '1rem',\n                    background: '#fee2e2',\n                    border: '2px solid #fca5a5',\n                    borderRadius: '8px',\n                    color: '#991b1b',\n                    fontWeight: 500\n                  }}>\n                    ‚ö†Ô∏è Nelze generovat DOCX - v objedn√°vce nejsou definov√°ni ≈æ√°dn√≠ u≈æivatel√©!\n                    <br />\n                    <small style={{ fontSize: '0.875rem', marginTop: '0.5rem', display: 'block' }}>\n                      Pros√≠m dopl≈àte garanta, p≈ôikazce nebo jin√©ho u≈æivatele v objedn√°vce.\n                    </small>\n                  </div>\n                )}\n              </UserSelectSection>\n            )}\n          </LeftColumn>\n\n          {/* PRAV√ù SLOUPEC - Seznam DOCX ≈°ablon */}\n          <RightColumn>\n            {loading && (\n              <LoadingMessage>\n                <div className=\"spinner\">\n                  <FontAwesomeIcon icon={faSpinner} />\n                </div>\n                <p>Naƒç√≠t√°m DOCX ≈°ablony...</p>\n              </LoadingMessage>\n            )}\n\n            {error && (\n              <ErrorMessage>\n                <div className=\"icon\">\n                  <FontAwesomeIcon icon={faExclamationTriangle} />\n                </div>\n                <p>{error}</p>\n              </ErrorMessage>\n            )}\n\n            {!loading && !error && templates.length === 0 && (\n              <NoTemplatesMessage>\n                <div className=\"icon\">\n                  <FontAwesomeIcon icon={faFileWord} />\n                </div>\n                <p>Nejsou k dispozici ≈æ√°dn√© aktivn√≠ DOCX ≈°ablony</p>\n              </NoTemplatesMessage>\n            )}\n\n            {!loading && !error && templates.length > 0 && (\n              <div>\n                <TemplatesHeader>\n                  <h3>Vyberte DOCX ≈°ablonu</h3>\n                  <p>K dispozici {templates.length} {templates.length === 1 ? '≈°ablona' : templates.length < 5 ? '≈°ablony' : '≈°ablon'}</p>\n                </TemplatesHeader>\n                <TemplatesList>\n                  {templates.map(template => (\n                    <TemplateItem\n                      key={template.id}\n                      $selected={selectedTemplate?.id === template.id}\n                      onClick={() => setSelectedTemplate(template)}\n                    >\n                      <h4>\n                        <FontAwesomeIcon icon={faFileWord} />\n                        {template.nazev || `≈†ablona ${template.id}`}\n                        {template.typ_dokumentu && (\n                          <span className=\"template-type\"> ({template.typ_dokumentu})</span>\n                        )}\n                      </h4>\n                      {template.popis && <p>{template.popis}</p>}\n                    </TemplateItem>\n                  ))}\n                </TemplatesList>\n              </div>\n            )}\n          </RightColumn>\n        </ModalBody>\n\n        <ModalFooter>\n          <CancelButton onClick={onClose}>\n            <FontAwesomeIcon icon={faTimes} />\n            Zru≈°it\n          </CancelButton>\n          <GenerateButton\n            onClick={handleGenerateDocx}\n            disabled={!selectedTemplate || generating || availableUsers.length === 0}\n            title={\n              !selectedTemplate ? 'Vyberte DOCX ≈°ablonu' :\n              availableUsers.length === 0 ? 'V objedn√°vce nejsou definov√°ni ≈æ√°dn√≠ u≈æivatel√©' :\n              generating ? 'Generov√°n√≠ prob√≠h√°...' :\n              'Generovat DOCX dokument'\n            }\n          >\n            {generating ? (\n              <>\n                <FontAwesomeIcon icon={faSpinner} className=\"fa-spin\" />\n                Generuji...\n              </>\n            ) : (\n              <>\n                <FontAwesomeIcon icon={faDownload} />\n                Generovat DOCX\n              </>\n            )}\n          </GenerateButton>\n        </ModalFooter>\n      </ModalContainer>\n    </ModalOverlay>,\n    document.body\n  );\n};\n","/**\n * DOCX Orders API Service\n * Speci√°ln√≠ endpoint pro naƒç√≠t√°n√≠ dat objedn√°vek pro DOCX generov√°n√≠\n *\n * Endpoint: POST /api.eeo/sablona_docx/order-data\n * Datum: 22. ≈ô√≠jna 2025\n *\n * Kl√≠ƒçov√© vlastnosti:\n * - Bez ID pol√≠ (pro ƒçist≈°√≠ DOCX ≈°ablony)\n * - Boolean jako \"ano\"/\"\" m√≠sto true/false\n * - Null hodnoty jako pr√°zdn√© stringy\n * - Vno≈ôen√© objekty (objednatel, dodavatel, stav)\n * - DOCX template p≈ô√°telsk√© form√°ty\n */\n\nimport axios from 'axios';\n\n// Axios instance pro DOCX order data endpoint\nconst apiDocxOrders = axios.create({\n  baseURL: process.env.REACT_APP_API2_BASE_URL,\n  headers: { 'Content-Type': 'application/json' }\n});\n\n// Response interceptor pro error handling\napiDocxOrders.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    // Check for authentication errors\n    if (error.response?.status === 401 || error.response?.status === 403) {\n      if (typeof window !== 'undefined') {\n        const event = new CustomEvent('authError', {\n          detail: { message: 'Va≈°e p≈ôihl√°≈°en√≠ vypr≈°elo. P≈ôihlaste se pros√≠m znovu.' }\n        });\n        window.dispatchEvent(event);\n      }\n    }\n\n    // Check for HTML response (login page instead of JSON)\n    const responseText = error.response?.data || '';\n    if (typeof responseText === 'string' && responseText.includes('<!doctype')) {\n      if (typeof window !== 'undefined') {\n        const event = new CustomEvent('authError', {\n          detail: { message: 'Va≈°e p≈ôihl√°≈°en√≠ vypr≈°elo. Obnovte str√°nku a p≈ôihlaste se znovu.' }\n        });\n        window.dispatchEvent(event);\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\n/**\n * Normalize error messages from API responses\n */\nexport function normalizeDocxOrdersError(err) {\n  if (err.response?.data?.message) return err.response.data.message;\n  if (err.response?.data?.error) return err.response.data.error;\n  if (err.response?.data?.err) return err.response.data.err;\n  if (err.response?.data) return err.response.data;\n  if (err.message) return err.message;\n  return 'Nezn√°m√° chyba p≈ôi komunikaci se serverem';\n}\n\n/**\n * Z√≠sk√° data objedn√°vky optimalizovan√° pro DOCX generov√°n√≠\n *\n * @param {Object} params - Parametry po≈æadavku\n * @param {string} params.token - Autentifikaƒçn√≠ token\n * @param {string} params.username - U≈æivatelsk√© jm√©no\n * @param {number} params.objednavka_id - ID objedn√°vky\n * @returns {Promise<Object>} - DOCX p≈ô√°telsk√° data objedn√°vky\n */\nexport async function getDocxOrderData({ token, username, objednavka_id }) {\n  if (!token || !username) {\n    throw new Error('Chyb√≠ p≈ô√≠stupov√Ω token nebo u≈æivatelsk√© jm√©no. P≈ôihlaste se pros√≠m znovu.');\n  }\n\n  if (objednavka_id === null || objednavka_id === undefined) {\n    throw new Error('Chyb√≠ ID objedn√°vky.');\n  }\n\n  try {\n    const payload = {\n      token,\n      username,\n      objednavka_id: parseInt(objednavka_id)\n    };\n\n    const response = await apiDocxOrders.post('sablona_docx/order-data', payload, { timeout: 8000 });\n\n    if (response.status !== 200) {\n      const error = 'Neoƒçek√°van√Ω k√≥d odpovƒõdi p≈ôi naƒç√≠t√°n√≠ DOCX dat objedn√°vky';\n      throw new Error(error);\n    }\n\n    const data = response.data;\n\n    if (data.err) {\n      throw new Error(data.err);\n    }\n\n    if (data.status === 'ok' && data.data) {\n      return data.data;\n    }\n\n    throw new Error('Neoƒçek√°van√° struktura odpovƒõdi ze serveru');\n\n  } catch (error) {\n    console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ DOCX order data:', error);\n    throw new Error(normalizeDocxOrdersError(error));\n  }\n}\n\n/**\n * üÜï NOV√ù ENDPOINT - Z√≠sk√° ENRICHED data objedn√°vky pro DOCX generov√°n√≠\n * \n * Tento endpoint vrac√≠ KOMPLETN√ç data vƒçetnƒõ:\n * - Enriched u≈æivatelsk√Ωch objekt≈Ø (s lokalitami, telefony, emaily)\n * - Vypoƒç√≠tan√Ωch hodnot (ceny, DPH, kombinace jmen)\n * - Seznamu u≈æivatel≈Ø pro v√Ωbƒõr podpisu\n * - Polo≈æek a p≈ô√≠loh objedn√°vky\n *\n * @param {Object} params - Parametry po≈æadavku\n * @param {string} params.token - Autentifikaƒçn√≠ token\n * @param {string} params.username - U≈æivatelsk√© jm√©no\n * @param {number} params.objednavka_id - ID objedn√°vky\n * @returns {Promise<Object>} - Kompletn√≠ enriched data\n * \n * @see docs/DOCX-ENRICHED-ENDPOINT-SPEC.md\n */\nexport async function getDocxOrderEnrichedData({ token, username, objednavka_id }) {\n  if (!token || !username) {\n    throw new Error('Chyb√≠ p≈ô√≠stupov√Ω token nebo u≈æivatelsk√© jm√©no. P≈ôihlaste se pros√≠m znovu.');\n  }\n\n  if (objednavka_id === null || objednavka_id === undefined) {\n    throw new Error('Chyb√≠ ID objedn√°vky.');\n  }\n\n  try {\n    const payload = {\n      token,\n      username,\n      objednavka_id: parseInt(objednavka_id)\n    };\n\n    const response = await apiDocxOrders.post(\n      'sablona_docx/order-enriched-data', \n      payload, \n      { timeout: 10000 }\n    );\n\n    if (response.status !== 200) {\n      throw new Error('Neoƒçek√°van√Ω k√≥d odpovƒõdi p≈ôi naƒç√≠t√°n√≠ enriched dat');\n    }\n\n    const data = response.data;\n\n    if (data.err) {\n      throw new Error(data.err);\n    }\n\n    if (data.status === 'ok' && data.data) {\n      return data.data;\n    }\n\n    throw new Error('Neoƒçek√°van√° struktura odpovƒõdi ze serveru');\n\n  } catch (error) {\n    console.error('‚ùå Chyba p≈ôi naƒç√≠t√°n√≠ DOCX enriched data:', error);\n    throw new Error(normalizeDocxOrdersError(error));\n  }\n}\n\n/**\n * Testovac√≠ funkce pro ovƒõ≈ôen√≠ struktury dat\n */\nexport function validateDocxOrderData(orderData) {\n  const requiredFields = [\n    'cislo_objednavky',\n    'nazev_objednavky',\n    'objednatel',\n    'dodavatel',\n    'stav',\n    'polozky',\n    'celkova_cena_s_dph'\n  ];\n\n  const missingFields = requiredFields.filter(field => !orderData[field]);\n\n  if (missingFields.length > 0) {\n    console.warn('‚ö†Ô∏è Chybƒõj√≠c√≠ pole v DOCX order data:', missingFields);\n    return false;\n  }\n\n  // Kontrola vno≈ôen√Ωch objekt≈Ø\n  if (!orderData.objednatel?.plne_jmeno) {\n    console.warn('‚ö†Ô∏è Chyb√≠ objednatel.plne_jmeno v DOCX order data');\n    return false;\n  }\n\n  if (!orderData.dodavatel?.nazev) {\n    console.warn('‚ö†Ô∏è Chyb√≠ dodavatel.nazev v DOCX order data');\n    return false;\n  }\n\n  return true;\n}\n\nexport default {\n  getDocxOrderData,\n  getDocxOrderEnrichedData, // üÜï NOV√Å FUNKCE\n  validateDocxOrderData,\n  normalizeDocxOrdersError\n};"],"names":["formatDateForDocx","value","test","date","Date","parts","split","map","p","trim","day","parseInt","month","year","isNaN","getTime","String","getDate","padStart","getMonth","getFullYear","concat","error","async","generateDocxDocument","_ref","templateId","orderId","token","username","template","selectedUserId","_docxZip$file","sablonaData","templateDetail","getDocxSablonaDetail","id","data","Error","console","message","templateFile","downloadDocxSablonaAsFile","fileName","nazev","docxZip","JSZip","documentXml","file","templateMapping","mappingSource","docx_mapping","mapovani_json","JSON","parse","apiData","getDocxOrderEnrichedData","objednavka_id","vypocitane","_apiData$dostupni_uzi","vybranyUzivatel","dostupni_uzivatele_pro_podpis","find","u","vybrany_uzivatel_cele_jmeno","cele_jmeno","vybrany_uzivatel_role","role","vybrany_uzivatel_lokalita","lokalita_nazev","fieldMapping","mappedData","missingFields","Object","entries","forEach","_ref2","docxField","dbPath","includes","part","getValueFromPath","filter","v","join","undefined","push","createFieldMappingForDocx","filledXml","xmlContent","fieldValues","parser","window","DOMParser","serializer","XMLSerializer","xmlDoc","parseFromString","replacementCount","removedCount","processNode","node","childNodes","runs","i","length","n","nodeType","localName","beginIdx","endIdx","fieldName","instr","j","r","k","getAttribute","foundEnd","m","r2","n2","nInstr","textContent","exec","replace","val","del","removeChild","Array","from","firstR","firstChild","tNew","createElementNS","namespaceURI","appendChild","documentElement","serializeToString","_ref3","pattern","RegExp","fillXmlWithFieldData","generateAsync","type","mimeType","obj","path","reduce","current","key","index","isArray","ModalOverlay","styled","div","_templateObject","_taggedTemplateLiteral","ModalContainer","_templateObject2","ModalHeader","_templateObject3","CloseButton","button","_templateObject4","ModalBody","_templateObject5","LeftColumn","_templateObject6","RightColumn","_templateObject7","InfoGrid","_templateObject8","InfoItem","_templateObject9","InfoDivider","_templateObject0","OrderInfoBox","_templateObject1","UserSelectSection","_templateObject10","Select","select","_templateObject11","InfoLabel","span","_templateObject12","InfoValue","_templateObject13","TemplatesList","_templateObject14","TemplatesHeader","_templateObject15","TemplateItem","_templateObject16","props","$selected","ModalFooter","_templateObject17","Button","_templateObject18","CancelButton","_templateObject19","GenerateButton","_templateObject20","LoadingMessage","_templateObject21","ErrorMessage","_templateObject22","NoTemplatesMessage","_templateObject23","DocxGeneratorModal","_order$garant_uzivate2","order","isOpen","onClose","user","useContext","AuthContext","showToast","ToastContext","templates","setTemplates","useState","selectedTemplate","setSelectedTemplate","loading","setLoading","generating","setGenerating","setError","selectedUserIndex","setSelectedUserIndex","availableUsers","setAvailableUsers","useEffect","loadAvailableUsers","_order$garant_uzivate","_order$prikazce_uziva","_order$schvalovatel","_order$uzivatel","_order$dodavatel_potv","_order$odesilatel","_order$fakturant","_order$potvrdil_vecno","_order$dokoncil","users","garant_uzivatel_id","garant_uzivatel","name","prikazce_id","prikazce_uzivatel","schvalovatel_id","schvalovatel","uzivatel_id","uzivatel","dodavatel_potvrdil_id","dodavatel_potvrdil","odesilatel_id","odesilatel","fakturant_id","fakturant","potvrdil_vecnou_spravnost_id","potvrdil_vecnou_spravnost","dokoncil_id","dokoncil","prikazceIndex","findIndex","response","getDocxSablonyList","aktivni","loadTemplates","ReactDOM","_jsx","onClick","children","_jsxs","e","stopPropagation","FontAwesomeIcon","icon","faFileWord","title","faTimes","faInfoCircle","className","cislo_objednavky","predmet","stav_objednavky","price","max_cena_s_dph","polozky_celkova_cena_s_dph","Intl","NumberFormat","style","currency","minimumFractionDigits","maximumFractionDigits","format","dodavatel_nazev","dodavatel_ico","faUser","onChange","target","disabled","padding","background","border","borderRadius","color","fontWeight","fontSize","marginTop","display","faSpinner","faExclamationTriangle","typ_dokumentu","popis","order_id","generatedDocx","docxBlob","url","URL","createObjectURL","a","document","createElement","href","download","body","click","revokeObjectURL","downloadGeneratedDocx","_Fragment","faDownload","apiDocxOrders","axios","create","baseURL","process","headers","normalizeDocxOrdersError","err","_err$response","_err$response$data","_err$response2","_err$response2$data","_err$response3","_err$response3$data","_err$response4","payload","post","timeout","status","interceptors","use","_error$response","_error$response2","_error$response3","event","CustomEvent","detail","dispatchEvent","responseText","Promise","reject"],"sourceRoot":""}