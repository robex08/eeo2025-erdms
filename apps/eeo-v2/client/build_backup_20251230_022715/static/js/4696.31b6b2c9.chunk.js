"use strict";(self.webpackChunkr_app_zzs_eeo=self.webpackChunkr_app_zzs_eeo||[]).push([[4696],{42161:(e,n,o)=>{o.r(n),o.d(n,{default:()=>Zn});var t,i,a,r,l,d,s,c,p,x,u,h,g,v,m,f,b,y,j,k,z,S,w,A,T,R,E,C,I,_,N,L,O,P,D,B,V,M,W,F,U,H,K,J,Y,Z,G,X,$,q,Q,ee,ne,oe,te,ie,ae,re,le,de,se,ce,pe,xe,ue,he,ge=o(89379),ve=o(57528),me=o(65043),fe=o(45903),be=o(12014),ye=o(54110),je=o(54077),ke=o(63227),ze=(o(96299),o(83910)),Se=o(63974),we=o(63577),Ae=o.n(we),Te=o(74373),Re=o(88720),Ee=o(97929),Ce=o(70579);const Ie="https://erdms.zachranka.cz/api.eeo/".replace(/\/$/,""),_e=window.console.error;window.console.error=function(){var e;const n="string"===typeof(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:(null===(e=arguments.length<=0?void 0:arguments[0])||void 0===e?void 0:e.message)||"";n.includes("ResizeObserver loop completed")||n.includes("ResizeObserver loop limit exceeded")||_e(...arguments)},window.addEventListener("error",e=>{var n,o,t,i,a,r;(null!==(n=e.message)&&void 0!==n&&null!==(o=n.includes)&&void 0!==o&&o.call(n,"ResizeObserver loop completed")||null!==(t=e.message)&&void 0!==t&&null!==(i=t.includes)&&void 0!==i&&i.call(t,"ResizeObserver loop limit exceeded")||null!==(a=e.message)&&void 0!==a&&null!==(r=a.includes)&&void 0!==r&&r.call(a,"undelivered notifications"))&&(e.stopImmediatePropagation(),e.preventDefault())},!0);const Ne=fe.A.div(t||(t=(0,ve.A)(["\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: #f5f7fa;\n  margin-top: -1em; /* Kompenzace padding-top z Layout Content */\n  user-select: none;\n  -webkit-user-select: none;\n"]))),Le=fe.A.div(i||(i=(0,ve.A)(["\n  padding: 16px 24px;\n  background: white;\n  border-bottom: 1px solid #e0e6ed;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n  flex-shrink: 0;\n  user-select: none;\n"]))),Oe=fe.A.h1(a||(a=(0,ve.A)(["\n  color: #2c3e50;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  font-size: 1.5rem;\n"]))),Pe=fe.A.div(r||(r=(0,ve.A)(["\n  display: flex;\n  gap: 12px;\n"]))),De=fe.A.button(l||(l=(0,ve.A)(["\n  padding: 8px 16px;\n  background: ",";\n  color: ",";\n  border: 1px solid ",";\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n  font-weight: 500;\n\n  &:hover {\n    background: ",";\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"])),e=>e.primary?"#3b82f6":"white",e=>e.primary?"#fff":"#2c3e50",e=>e.primary?"#3b82f6":"#e0e6ed",e=>e.primary?"#2563eb":"#f8fafc"),Be=fe.A.div(d||(d=(0,ve.A)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  animation: fadeIn 0.2s ease-in-out;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n"]))),Ve=fe.A.div(s||(s=(0,ve.A)(["\n  background: white;\n  border-radius: 12px;\n  padding: 24px;\n  max-width: 500px;\n  width: 90%;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  animation: slideUp 0.3s ease-out;\n\n  @keyframes slideUp {\n    from {\n      transform: translateY(20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n"]))),Me=fe.A.div(c||(c=(0,ve.A)(["\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 16px;\n  color: #dc2626;\n  font-size: 1.25rem;\n  font-weight: 700;\n"]))),We=fe.A.div(p||(p=(0,ve.A)(["\n  color: #475569;\n  font-size: 1rem;\n  line-height: 1.6;\n  margin-bottom: 24px;\n"]))),Fe=fe.A.div(x||(x=(0,ve.A)(["\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n"]))),Ue=fe.A.button(u||(u=(0,ve.A)(["\n  padding: 10px 20px;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n\n  ","\n"])),e=>"danger"===e.variant?"\n    background: #dc2626;\n    color: white;\n    &:hover {\n      background: #b91c1c;\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.4);\n    }\n  ":"\n    background: #f1f5f9;\n    color: #475569;\n    &:hover {\n      background: #e2e8f0;\n    }\n  "),He=fe.A.div(h||(h=(0,ve.A)(["\n  flex: 1;\n  display: flex;\n  overflow: hidden;\n"]))),Ke=fe.A.div(g||(g=(0,ve.A)(["\n  width: 400px;\n  background: white;\n  border-right: 1px solid #e0e6ed;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  position: relative;\n  user-select: none;\n"]))),Je=fe.A.div(v||(v=(0,ve.A)(["\n  padding: 16px;\n  border-bottom: 1px solid #e0e6ed;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n"]))),Ye=fe.A.h3(m||(m=(0,ve.A)(["\n  margin: 0;\n  color: white;\n  font-size: 1rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),Ze=fe.A.div(f||(f=(0,ve.A)(["\n  padding: 12px 16px;\n  border-bottom: 1px solid #e0e6ed;\n  position: relative;\n"]))),Ge=fe.A.input(b||(b=(0,ve.A)(["\n  width: 100%;\n  padding: 8px 32px 8px 36px;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  background: #f8fafc;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    background: white;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n"]))),Xe=fe.A.div(y||(y=(0,ve.A)(["\n  position: absolute;\n  left: 28px;\n  top: 22px;\n  color: #94a3b8;\n"]))),$e=fe.A.button(j||(j=(0,ve.A)(["\n  position: absolute;\n  right: 24px;\n  top: 20px;\n  background: none;\n  border: none;\n  color: #94a3b8;\n  cursor: pointer;\n  padding: 4px 6px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.1rem;\n  border-radius: 4px;\n  transition: all 0.2s;\n  \n  &:hover {\n    background: #e2e8f0;\n    color: #475569;\n  }\n  \n  &:active {\n    transform: scale(0.95);\n  }\n"]))),qe=fe.A.div(k||(k=(0,ve.A)(["\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n  padding-bottom: 190px; /* Prostor pro ob\u011b fixn\xed tla\u010d\xedtka (P\u0159idat vybran\xe9 + Resetovat plochu) */\n\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n"]))),Qe=fe.A.div(z||(z=(0,ve.A)(["\n  margin-bottom: 8px;\n"]))),en=fe.A.div(S||(S=(0,ve.A)(["\n  padding: 10px 12px;\n  background: ",";\n  border-radius: 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #475569;\n  font-weight: 600;\n  font-size: 0.85rem;\n  transition: all 0.2s;\n\n  &:hover {\n    background: #f1f5f9;\n  }\n\n  svg:first-of-type {\n    width: 12px;\n  }\n"])),e=>e.expanded?"#f1f5f9":"transparent"),nn=fe.A.div(w||(w=(0,ve.A)(["\n  margin-top: 4px;\n  padding-left: 8px;\n  display: ",";\n"])),e=>e.expanded?"block":"none"),on=fe.A.div(A||(A=(0,ve.A)(["\n  padding: 10px 12px;\n  margin-bottom: 6px;\n  background: ",";\n  border: 2px solid ",";\n  border-radius: 8px;\n  cursor: grab;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  transition: all 0.2s;\n  color: ",";\n  box-shadow: ",";\n\n  &:hover {\n    border-color: #3b82f6;\n    transform: translateX(4px);\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n  }\n\n  &:active {\n    cursor: grabbing;\n  }\n"])),e=>e.isDragging?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"white",e=>e.isDragging?"#667eea":"#e0e6ed",e=>e.isDragging?"#fff":"#2c3e50",e=>e.isDragging?"0 8px 24px rgba(102, 126, 234, 0.3)":"0 1px 3px rgba(0,0,0,0.05)"),tn=fe.A.div(T||(T=(0,ve.A)(["\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 700;\n  font-size: 0.85rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n"]))),an=fe.A.div(R||(R=(0,ve.A)(["\n  flex: 1;\n  min-width: 0;\n"]))),rn=fe.A.div(E||(E=(0,ve.A)(["\n  font-weight: 600;\n  font-size: 0.9rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 2px;\n"]))),ln=fe.A.div(C||(C=(0,ve.A)(["\n  font-size: 0.75rem;\n  color: #64748b;\n  display: flex;\n  gap: 6px;\n  align-items: center;\n"]))),dn=(0,fe.A)(on)(I||(I=(0,ve.A)(["\n  cursor: ",";\n  opacity: ",";\n  transform: ",";\n  \n  &:hover {\n    transform: ",";\n  }\n"])),e=>e.isDragging?"grabbing":"grab",e=>e.isDragging?.8:1,e=>e.isDragging?"rotate(2deg) scale(1.05)":"none",e=>e.isDragging?"rotate(2deg) scale(1.05)":"translateX(4px)"),sn=fe.A.div(_||(_=(0,ve.A)(["\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  background: linear-gradient(135deg, #92400e 0%, #78350f 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(146, 64, 14, 0.3);\n"]))),cn=fe.A.div(N||(N=(0,ve.A)(["\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  background: linear-gradient(135deg, #059669 0%, #047857 100%);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1rem;\n  flex-shrink: 0;\n  box-shadow: 0 2px 8px rgba(5, 150, 105, 0.3);\n"]))),pn=fe.A.div(L||(L=(0,ve.A)(["\n  flex: 1;\n  position: relative;\n  background: #f5f7fa;\n  user-select: none; /* Zak\xe1zat v\xfdb\u011br textu v cel\xe9 canvas oblasti */\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  \n  /* Animace pro \u010d\xe1rkovanou \u010d\xe1ru */\n  @keyframes dashdraw {\n    to {\n      stroke-dashoffset: -10;\n    }\n  }\n  \n  /* Pointer kurzor p\u0159i hover nad nodem nebo edge */\n  .react-flow__node,\n  .react-flow__edge {\n    cursor: pointer !important;\n  }\n  \n  /* Crosshair p\u0159i SHIFT (selection mode) - NEJVY\u0160\u0160\xcd PRIORITA */\n  &.selection-mode .react-flow__pane,\n  &.selection-mode .react-flow__pane:hover,\n  &.selection-mode .react-flow__pane:active,\n  &.selection-mode .react-flow__pane:focus {\n    cursor: crosshair !important;\n  }\n  \n  /* V\xfdchoz\xed grab kurzor pro pan - JEN pokud NEN\xcd selection mode */\n  &:not(.selection-mode) .react-flow__pane {\n    cursor: grab !important;\n  }\n  \n  /* Grabbing kurzor p\u0159i aktivn\xedm panov\xe1n\xed - JEN pokud NEN\xcd selection mode */\n  &:not(.selection-mode) .react-flow__pane:active {\n    cursor: grabbing !important;\n  }\n  \n  /* Styl pro v\xfdb\u011brov\xfd obd\xe9ln\xedk (box-select) */\n  .react-flow__selection {\n    background: rgba(102, 126, 234, 0.08) !important;\n    border: 2px dashed #667eea !important;\n    border-radius: 8px !important;\n  }\n  \n  .react-flow__nodesselection {\n    background: transparent !important;\n    border: none !important;\n  }\n"]))),xn=fe.A.div(O||(O=(0,ve.A)(["\n  width: 380px;\n  background: white;\n  border-left: 1px solid #e0e6ed;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  box-shadow: -2px 0 8px rgba(0,0,0,0.05);\n"]))),un=fe.A.div(P||(P=(0,ve.A)(["\n  padding: 16px;\n  border-bottom: 1px solid #e0e6ed;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n"]))),hn=fe.A.h3(D||(D=(0,ve.A)(["\n  margin: 0;\n  color: white;\n  font-size: 1rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),gn=fe.A.button(B||(B=(0,ve.A)(["\n  background: rgba(255,255,255,0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(255,255,255,0.3);\n  }\n"]))),vn=fe.A.button(V||(V=(0,ve.A)(["\n  background: rgba(255,255,255,0.15);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  margin-left: auto;\n  margin-right: 8px;\n  font-size: 16px;\n\n  &:hover {\n    background: rgba(255,255,255,0.3);\n  }\n"]))),mn=fe.A.div(M||(M=(0,ve.A)(["\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 3px;\n  }\n  \n  /* Scrollbar pro email preview */\n  .email-preview-body {\n    &::-webkit-scrollbar {\n      width: 8px;\n    }\n    \n    &::-webkit-scrollbar-track {\n      background: #f1f5f9;\n      border-radius: 4px;\n    }\n    \n    &::-webkit-scrollbar-thumb {\n      background: #cbd5e1;\n      border-radius: 4px;\n      \n      &:hover {\n        background: #94a3b8;\n      }\n    }\n  }\n"]))),fn=fe.A.div(W||(W=(0,ve.A)(["\n  margin-bottom: 28px;\n"]))),bn=fe.A.h4(F||(F=(0,ve.A)(["\n  margin: 0 0 16px 0;\n  color: #475569;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  font-weight: 700;\n"]))),yn=fe.A.div(U||(U=(0,ve.A)(["\n  margin-bottom: 16px;\n"]))),jn=fe.A.label(H||(H=(0,ve.A)(["\n  display: block;\n  margin-bottom: 8px;\n  color: #475569;\n  font-size: 0.85rem;\n  font-weight: 600;\n"]))),kn=fe.A.input(K||(K=(0,ve.A)(["\n  width: 100%;\n  padding: 10px 12px;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  background: #f8fafc;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  transition: all 0.2s;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    background: white;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n\n  &:read-only {\n    background: #e2e8f0;\n    cursor: not-allowed;\n  }\n"]))),zn=fe.A.div(J||(J=(0,ve.A)(["\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 8px;\n  padding: 2px;\n  transition: all 0.2s;\n  \n  &:focus-within {\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n  \n  &:hover {\n    border-color: #d1d5db;\n  }\n"]))),Sn=fe.A.select(Y||(Y=(0,ve.A)(["\n  flex: 1;\n  padding: 8px 12px;\n  border: none;\n  background: transparent;\n  color: #111827;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  outline: none;\n  appearance: none;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\");\n  background-position: right 8px center;\n  background-repeat: no-repeat;\n  background-size: 20px;\n  padding-right: 36px;\n  \n  option {\n    padding: 10px;\n    font-size: 0.875rem;\n  }\n"]))),wn=fe.A.div(Z||(Z=(0,ve.A)(["\n  display: none;\n"]))),An=fe.A.button(G||(G=(0,ve.A)(["\n  padding: 4px 8px;\n  background: transparent;\n  border: 1px solid #e5e7eb;\n  color: ",";\n  cursor: ",";\n  font-size: 0.875rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s;\n  border-radius: 6px;\n  min-width: 32px;\n  height: 32px;\n  \n  &:hover:not(:disabled) {\n    background: #f9fafb;\n    border-color: #d1d5db;\n  }\n  \n  &:active:not(:disabled) {\n    background: #f3f4f6;\n  }\n"])),e=>e.disabled?"#d1d5db":"#6b7280",e=>e.disabled?"not-allowed":"pointer"),Tn=fe.A.select(X||(X=(0,ve.A)(["\n  width: 100%;\n  padding: 8px 16px;\n  border: 1px solid #e0e6ed;\n  border-radius: 6px;\n  background: white;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  box-sizing: border-box;\n  height: 40px;\n  font-weight: 500;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n"]))),Rn=fe.A.div($||($=(0,ve.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n"]))),En=fe.A.label(q||(q=(0,ve.A)(['\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  color: #2c3e50;\n  font-size: 0.9rem;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 6px;\n  transition: background 0.2s;\n\n  &:hover {\n    background: #f8fafc;\n  }\n\n  input[type="checkbox"] {\n    width: 20px;\n    height: 20px;\n    cursor: pointer;\n    accent-color: #667eea;\n  }\n']))),Cn=(fe.A.div(Q||(Q=(0,ve.A)(["\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  margin-top: 8px;\n"]))),fe.A.div(ee||(ee=(0,ve.A)(["\n  padding: 6px 12px;\n  background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);\n  color: #667eea;\n  border-radius: 6px;\n  font-size: 0.85rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 500;\n  border: 1px solid #667eea30;\n\n  button {\n    background: none;\n    border: none;\n    color: inherit;\n    cursor: pointer;\n    padding: 0;\n    display: flex;\n    align-items: center;\n    opacity: 0.6;\n    transition: opacity 0.2s;\n\n    &:hover {\n      opacity: 1;\n    }\n  }\n"]))),fe.A.div(ne||(ne=(0,ve.A)(["\n  height: 1px;\n  background: #e0e6ed;\n  margin: 20px 0;\n"])))),In=fe.A.table(oe||(oe=(0,ve.A)(["\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 12px;\n  font-size: 0.9rem;\n\n  th {\n    background: #f8f9fa;\n    padding: 8px;\n    text-align: left;\n    font-weight: 600;\n    color: #495057;\n    border-bottom: 2px solid #dee2e6;\n  }\n\n  td {\n    padding: 8px;\n    border-bottom: 1px solid #e9ecef;\n  }\n\n  tr:hover {\n    background: #f8f9fa;\n  }\n\n  button {\n    background: none;\n    border: none;\n    color: #dc3545;\n    cursor: pointer;\n    padding: 4px;\n    display: flex;\n    align-items: center;\n    opacity: 0.7;\n    transition: opacity 0.2s;\n\n    &:hover {\n      opacity: 1;\n    }\n  }\n"]))),_n=fe.A.div(te||(te=(0,ve.A)(["\n  display: flex;\n  gap: 8px;\n  align-items: flex-end;\n  margin-top: 12px;\n\n  > div {\n    flex: 1;\n  }\n\n  button {\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-weight: 500;\n    transition: transform 0.2s, box-shadow 0.2s;\n    white-space: nowrap;\n\n    &:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n\n    &:active {\n      transform: translateY(0);\n    }\n  }\n"]))),Nn=fe.A.div(ie||(ie=(0,ve.A)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  animation: fadeIn 0.2s ease;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n"]))),Ln=fe.A.div(ae||(ae=(0,ve.A)(["\n  background: white;\n  border-radius: 16px;\n  padding: 32px;\n  max-width: 500px;\n  width: 90%;\n  box-shadow: 0 20px 60px rgba(0,0,0,0.3);\n  animation: slideUp 0.3s ease;\n\n  @keyframes slideUp {\n    from {\n      transform: translateY(20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n"]))),On=fe.A.div(re||(re=(0,ve.A)(["\n  font-size: 3rem;\n  text-align: center;\n  margin-bottom: 16px;\n"]))),Pn=fe.A.h2(le||(le=(0,ve.A)(["\n  margin: 0 0 12px 0;\n  color: #2c3e50;\n  font-size: 1.5rem;\n  text-align: center;\n"]))),Dn=fe.A.div(de||(de=(0,ve.A)(["\n  color: #64748b;\n  font-size: 0.95rem;\n  line-height: 1.6;\n  margin-bottom: 24px;\n  white-space: pre-line;\n"]))),Bn=fe.A.div(se||(se=(0,ve.A)(["\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n"]))),Vn=fe.A.button(ce||(ce=(0,ve.A)(["\n  padding: 10px 24px;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  border: none;\n  transition: all 0.2s;\n  \n  ","\n"])),e=>e.primary?"\n    background: #667eea;\n    color: white;\n    &:hover {\n      background: #5568d3;\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n  ":"\n    background: #e0e6ed;\n    color: #64748b;\n    &:hover {\n      background: #cbd5e1;\n    }\n  "),Mn=fe.A.div(pe||(pe=(0,ve.A)(["\n  background: #f8fafc;\n  border: 1px solid #e0e6ed;\n  border-radius: 8px;\n  padding: 16px;\n  margin: 16px 0;\n  \n  div {\n    display: flex;\n    justify-content: space-between;\n    padding: 8px 0;\n    font-size: 0.9rem;\n    \n    &:not(:last-child) {\n      border-bottom: 1px solid #e0e6ed;\n    }\n    \n    strong {\n      color: #2c3e50;\n      font-weight: 600;\n    }\n    \n    span {\n      color: #667eea;\n      font-weight: 700;\n    }\n  }\n"]))),Wn=fe.A.div(xe||(xe=(0,ve.A)(["\n  max-height: 80vh;\n  overflow-y: auto;\n  padding: 0 4px;\n"]))),Fn=fe.A.div(ue||(ue=(0,ve.A)(["\n  margin-bottom: 24px;\n  \n  h3 {\n    color: #2c3e50;\n    font-size: 1.1rem;\n    margin: 0 0 12px 0;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n  \n  p {\n    color: #64748b;\n    font-size: 0.9rem;\n    line-height: 1.6;\n    margin: 0 0 8px 0;\n  }\n  \n  code {\n    background: #f1f5f9;\n    padding: 2px 6px;\n    border-radius: 4px;\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #667eea;\n  }\n"]))),Un=fe.A.div(he||(he=(0,ve.A)(["\n  background: #f8fafc;\n  border-left: 3px solid #667eea;\n  padding: 12px;\n  border-radius: 4px;\n  margin: 8px 0;\n  font-size: 0.9rem;\n  \n  strong {\n    color: #2c3e50;\n    display: block;\n    margin-bottom: 4px;\n  }\n  \n  span {\n    color: #64748b;\n  }\n"]))),Hn={custom:e=>{let{data:n,selected:o}=e;const t="template"===n.type,i="role"===n.type,a="location"===n.type,r="department"===n.type;return t?(0,Ce.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",background:o?"linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)":"white",border:"3px solid ".concat("#f59e0b"),minWidth:"200px",boxShadow:o?"0 6px 16px rgba(245, 158, 11, 0.4)":"0 2px 8px rgba(245, 158, 11, 0.15)",transition:"all 0.2s",position:"relative",transform:o?"scale(1.05)":"scale(1)"},children:[(0,Ce.jsx)(be.h7,{type:"source",position:be.yX.Right,style:{width:"16px",height:"16px",background:"#10b981",border:"3px solid white",boxShadow:"0 2px 8px rgba(16, 185, 129, 0.5)",cursor:"crosshair",right:"-10px"}}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,Ce.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.3rem",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.3)"},children:"\ud83d\udd14"}),(0,Ce.jsxs)("div",{style:{flex:1},children:[(0,Ce.jsx)("div",{style:{fontWeight:700,color:"#78350f",fontSize:"0.85rem",marginBottom:"2px"},children:n.name}),(0,Ce.jsx)("div",{style:{fontSize:"0.7rem",color:"#92400e",fontWeight:500},children:n.position})]})]})]}):i?(0,Ce.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",background:o?"linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%)":"white",border:"3px solid ".concat("#8b5cf6"),minWidth:"200px",boxShadow:o?"0 6px 16px rgba(139, 92, 246, 0.4)":"0 2px 8px rgba(139, 92, 246, 0.15)",transition:"all 0.2s",position:"relative",transform:o?"scale(1.05)":"scale(1)"},children:[(0,Ce.jsx)(be.h7,{type:"source",position:be.yX.Right,style:{width:"16px",height:"16px",background:"#10b981",border:"3px solid white",boxShadow:"0 2px 8px rgba(16, 185, 129, 0.5)",cursor:"crosshair",right:"-10px"}}),(0,Ce.jsx)(be.h7,{type:"target",position:be.yX.Left,style:{width:"16px",height:"16px",background:"#ef4444",border:"3px solid white",boxShadow:"0 2px 8px rgba(239, 68, 68, 0.5)",cursor:"crosshair",left:"-10px"}}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,Ce.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.3rem",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.3)",color:"white"},children:"\ud83d\udee1\ufe0f"}),(0,Ce.jsxs)("div",{style:{flex:1},children:[(0,Ce.jsx)("div",{style:{fontWeight:700,color:"#6d28d9",fontSize:"0.85rem",marginBottom:"2px"},children:n.name}),(0,Ce.jsx)("div",{style:{fontSize:"0.7rem",color:"#8b5cf6",fontWeight:500},children:null!==(l=n.metadata)&&void 0!==l&&l.userCount?"\ud83d\udc65 ".concat(n.metadata.userCount," u\u017eivatel\u016f"):"Role"})]})]})]}):a||r?(0,Ce.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",background:o?a?"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)":"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)":"white",border:"3px solid ".concat(a?"#92400e":"#059669"),minWidth:"160px",boxShadow:o?"0 6px 16px ".concat(a?"rgba(146, 64, 14, 0.4)":"rgba(5, 150, 105, 0.4)"):"0 2px 8px ".concat(a?"rgba(146, 64, 14, 0.15)":"rgba(5, 150, 105, 0.15)"),transition:"all 0.2s",position:"relative",transform:o?"scale(1.05)":"scale(1)",textAlign:"center"},children:[(0,Ce.jsx)(be.h7,{type:"target",position:be.yX.Top,style:{width:"14px",height:"14px",background:a?"#92400e":"#059669",border:"2px solid white",boxShadow:"0 2px 6px ".concat(a?"rgba(146, 64, 14, 0.4)":"rgba(5, 150, 105, 0.4)"),cursor:"crosshair"}}),(0,Ce.jsx)(be.h7,{type:"source",position:be.yX.Bottom,style:{width:"14px",height:"14px",background:a?"#92400e":"#059669",border:"2px solid white",boxShadow:"0 2px 6px ".concat(a?"rgba(146, 64, 14, 0.4)":"rgba(5, 150, 105, 0.4)"),cursor:"crosshair"}}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,Ce.jsx)(ze.g,{icon:a?Ee.Pcr:Ee.BzA,style:{color:a?"#92400e":"#059669",fontSize:"1.1rem"}}),(0,Ce.jsx)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:"0.9rem"},children:n.name})]})]}):(0,Ce.jsxs)("div",{style:{padding:"14px",borderRadius:"12px",background:o?"linear-gradient(135deg, #dbeafe 0%, #e0f2fe 100%)":"white",border:"3px solid ".concat("#3b82f6"),minWidth:"220px",boxShadow:o?"0 8px 24px rgba(59, 130, 246, 0.5), 0 0 0 2px #93c5fd":"0 4px 12px rgba(59, 130, 246, 0.15)",transition:"all 0.2s",position:"relative",transform:o?"scale(1.02)":"scale(1)"},children:[(0,Ce.jsx)(be.h7,{type:"target",position:be.yX.Top,style:{width:"16px",height:"16px",background:"#3b82f6",border:"3px solid white",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.4)",cursor:"crosshair"}}),(0,Ce.jsx)(be.h7,{type:"source",position:be.yX.Bottom,style:{width:"16px",height:"16px",background:"#10b981",border:"3px solid white",boxShadow:"0 2px 8px rgba(16, 185, 129, 0.4)",cursor:"crosshair"}}),n.notifications&&(n.notifications.hasEmail||n.notifications.hasInApp)&&(0,Ce.jsxs)("div",{style:{position:"absolute",top:"8px",right:"8px",display:"flex",gap:"4px",alignItems:"center"},children:[n.notifications.hasEmail&&(0,Ce.jsx)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 6px rgba(102, 126, 234, 0.4)",cursor:"help"},title:"Email notifikace aktivn\xed",children:(0,Ce.jsx)(ze.g,{icon:Ee.y_8,style:{color:"white",fontSize:"0.7rem"}})}),n.notifications.hasInApp&&(0,Ce.jsx)("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 6px rgba(245, 87, 108, 0.4)",cursor:"help"},title:"In-app notifikace aktivn\xed",children:(0,Ce.jsx)(ze.g,{icon:Ee.z$e,style:{color:"white",fontSize:"0.7rem"}})})]}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px"},children:[(0,Ce.jsx)(tn,{children:n.initials}),(0,Ce.jsxs)("div",{style:{flex:1},children:[(0,Ce.jsx)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:"0.95rem",marginBottom:"2px"},children:n.name}),(0,Ce.jsx)("div",{style:{fontSize:"0.8rem",color:"#64748b",fontWeight:500},children:n.position})]})]}),n.metadata&&(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",paddingTop:"10px",borderTop:"1px solid #e0e6ed",display:"flex",flexDirection:"column",gap:"4px"},children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.Pcr,style:{color:"#f5576c"}}),n.metadata.location]}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.BzA,style:{color:"#00f2fe"}}),n.metadata.department]}),n.notifications&&n.notifications.types&&n.notifications.types.length>0&&(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"4px",paddingTop:"6px",borderTop:"1px dashed #e0e6ed"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.z$e,style:{color:"#667eea"}}),(0,Ce.jsxs)("span",{style:{fontSize:"0.7rem",color:"#667eea",fontWeight:600},children:[n.notifications.types.length," typ",n.notifications.types.length>1?"y":""," notifikac\xed"]})]})]})]});var l}},Kn={custom:e=>{var n,o,t;let{id:i,sourceX:a,sourceY:r,targetX:l,targetY:d,sourcePosition:s,targetPosition:c,style:p={},markerEnd:x,data:u,source:h}=e;const{getNode:g}=(0,be.VH)(),[v]=(0,be.oN)({sourceX:a,sourceY:r,sourcePosition:s,targetX:l,targetY:d,targetPosition:c}),m=g(h);let f="#94a3b8";return"template"===(null===m||void 0===m||null===(n=m.data)||void 0===n?void 0:n.type)?f="#f59e0b":"location"===(null===m||void 0===m||null===(o=m.data)||void 0===o?void 0:o.type)?f="#92400e":"department"===(null===m||void 0===m||null===(t=m.data)||void 0===t?void 0:t.type)?f="#059669":"custom"===(null===m||void 0===m?void 0:m.type)&&(f="#3b82f6"),(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsx)("path",{d:v,fill:"none",stroke:"transparent",strokeWidth:20,className:"react-flow__edge-interaction"}),(0,Ce.jsx)("path",{id:i,style:(0,ge.A)((0,ge.A)({},p),{},{stroke:f,strokeWidth:2.5,strokeDasharray:"8, 4",animation:"dashdraw 0.5s linear infinite"}),className:"react-flow__edge-path",d:v,markerEnd:x})]})}},Jn=e=>{let{mode:n,onClose:o,onSave:t,existingProfiles:i}=e;const[a,r]=me.useState(""),[l,d]=me.useState(""),[s,c]=me.useState(""),[p,x]=me.useState(!1),u=async()=>{x(!1),o()};return p?(0,Ce.jsx)(Nn,{onClick:o,children:(0,Ce.jsxs)(Ln,{onClick:e=>e.stopPropagation(),children:[(0,Ce.jsx)(On,{children:"\u26a0\ufe0f"}),(0,Ce.jsx)(Pn,{children:"Profil jiz existuje"}),(0,Ce.jsxs)(Dn,{children:['Profil s nazvem "',(0,Ce.jsx)("strong",{children:a}),'" jiz existuje.',(0,Ce.jsx)("br",{}),(0,Ce.jsx)("br",{}),"Chcete jej prepsat?"]}),(0,Ce.jsxs)(Bn,{children:[(0,Ce.jsx)(Vn,{onClick:()=>x(!1),children:"Zrusit"}),(0,Ce.jsx)(Vn,{primary:!0,onClick:u,children:"Ano, prepsat"})]})]})}):(0,Ce.jsx)(Nn,{onClick:o,children:(0,Ce.jsxs)(Ln,{onClick:e=>e.stopPropagation(),style:{maxWidth:"500px"},children:[(0,Ce.jsx)(On,{children:"\ud83d\udcbe"}),(0,Ce.jsx)(Pn,{children:"saveAs"===n?"Ulozit jako novy profil":"Ulozit profil"}),(0,Ce.jsxs)("div",{style:{padding:"20px",textAlign:"left"},children:[(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"Nazev profilu *"}),(0,Ce.jsx)(kn,{type:"text",value:a,onChange:e=>{r(e.target.value),c("")},placeholder:"napr. ZZSSK 2025, DEV DEMO...",autoFocus:!0})]}),(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"Popis (volitelny)"}),(0,Ce.jsx)("textarea",{value:l,onChange:e=>d(e.target.value),placeholder:"Strucny popis profilu...",rows:3,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #e0e6ed",fontSize:"0.95rem",fontFamily:"inherit",resize:"vertical"}})]}),s&&(0,Ce.jsx)("div",{style:{padding:"10px",background:"#fee",border:"1px solid #fcc",borderRadius:"6px",color:"#c00",fontSize:"0.9rem",marginTop:"10px"},children:s})]}),(0,Ce.jsxs)(Bn,{children:[(0,Ce.jsx)(Vn,{onClick:o,children:"Zrusit"}),(0,Ce.jsx)(Vn,{primary:!0,onClick:async()=>{if(!a.trim())return void c("Nazev profilu je povinny");const e=await t(a,l);e.exists?x(!0):e.error?c(e.error):o()},children:"Ulozit"})]})]})})},Yn=e=>{let{isOpen:n,onClose:o,emailData:t}=e;if(!n||!t)return null;const{template:i,mockData:a,replacePlaceholders:r,selectedVariantType:l}=t,d=((e,n)=>{if(!e)return e;if("DEFAULT"===n||!e.includes("\x3c!-- RECIPIENT:"))return e;const o="\x3c!-- RECIPIENT: ".concat(n," --\x3e"),t=e.indexOf(o);if(-1===t)return e;let i=t+o.length;const a=["APPROVER_NORMAL","APPROVER_URGENT","SUBMITTER"].filter(e=>e!==n).map(e=>"\x3c!-- RECIPIENT: ".concat(e," --\x3e"));let r=e.length;for(const l of a){const n=e.indexOf(l,i);-1!==n&&n<r&&(r=n)}return e.substring(i,r).trim()})(i.email_telo||i.email_body,l||"DEFAULT");return(0,Ce.jsx)(Be,{onClick:o,style:{zIndex:2e4},children:(0,Ce.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",width:"98vw",maxWidth:"1400px",height:"75vh",maxHeight:"calc(100vh - 140px)",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.4)",margin:"30px auto"},children:[(0,Ce.jsxs)("div",{style:{padding:"16px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"12px 12px 0 0",flexShrink:0},children:[(0,Ce.jsxs)("div",{children:[(0,Ce.jsxs)("h2",{style:{margin:"0 0 6px 0",fontSize:"1.3rem",display:"flex",alignItems:"center",gap:"10px"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.y_8}),"Email \u0160ablona",l&&"DEFAULT"!==l&&({APPROVER_NORMAL:"\ud83d\udd34",APPROVER_URGENT:"\ud83d\udfe0",SUBMITTER:"\ud83d\udfe2"}[l]||"")]}),(0,Ce.jsxs)("div",{style:{fontSize:"0.85rem",opacity:.95},children:[(0,Ce.jsx)("strong",{children:"\u0160ablona:"})," ",i.nazev||i.name||"Bez n\xe1zvu",l&&"DEFAULT"!==l&&(0,Ce.jsxs)(Ce.Fragment,{children:[" \u2022 ",(0,Ce.jsx)("strong",{children:"Varianta:"})," ","APPROVER_NORMAL"===l?"Schvalovatel (norm\xe1ln\xed)":"APPROVER_URGENT"===l?"Schvalovatel (mimo\u0159\xe1dn\xfd)":"SUBMITTER"===l?"Autor objedn\xe1vky":l]})]})]}),(0,Ce.jsx)("button",{onClick:o,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",width:"40px",height:"40px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",transition:"all 0.2s"},onMouseEnter:e=>e.currentTarget.style.background="rgba(255,255,255,0.3)",onMouseLeave:e=>e.currentTarget.style.background="rgba(255,255,255,0.2)",children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})]}),(0,Ce.jsxs)("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",background:"white"},children:[(0,Ce.jsxs)("div",{style:{padding:"20px 30px",borderBottom:"1px solid #e5e7eb",background:"#fafbfc",flexShrink:0},children:[(0,Ce.jsx)("div",{style:{marginBottom:"12px"},children:(0,Ce.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#111827",lineHeight:"1.4"},children:r(i.email_predmet||i.email_subject||"Bez p\u0159edm\u011btu")})}),(0,Ce.jsxs)("div",{style:{fontSize:"0.9rem",color:"#6b7280",marginBottom:"6px"},children:[(0,Ce.jsx)("strong",{style:{color:"#374151"},children:"Od:"})," EEO Syst\xe9m <noreply@eeo.cz>"]}),(0,Ce.jsxs)("div",{style:{fontSize:"0.9rem",color:"#6b7280"},children:[(0,Ce.jsx)("strong",{style:{color:"#374151"},children:"Komu:"})," ",a.recipient_name||a.user_name," <",a.user_email,">"]}),(0,Ce.jsx)("div",{style:{fontSize:"0.85rem",color:"#9ca3af",marginTop:"8px"},children:a.datetime})]}),(0,Ce.jsx)("iframe",{title:"Email Preview",style:{width:"100%",flex:1,border:"none",background:"white",overflow:"hidden"},srcDoc:'\n              <!DOCTYPE html>\n              <html>\n              <head>\n                <meta charset="UTF-8">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <style>\n                  html, body {\n                    margin: 0;\n                    padding: 0;\n                    font-family: Arial, sans-serif;\n                    background: #f9fafb;\n                    overflow: visible;\n                    height: auto;\n                  }\n                </style>\n              </head>\n              <body>\n                '.concat(r(d||'<p style="color: #9ca3af; font-style: italic;">Email t\u011blo nen\xed definov\xe1no v \u0161ablon\u011b</p>'),"\n              </body>\n              </html>\n            ")})]})]})})},Zn=()=>{var e,n,t,i;(0,me.useRef)(null);const{showToast:a}=(0,me.useContext)(Re.$o),[r,l]=(0,me.useState)(!1);(0,me.useEffect)(()=>{const e=e=>{var n,o;(null!==(n=e.message)&&void 0!==n&&n.includes("useNodesState")||null!==(o=e.message)&&void 0!==o&&o.includes("useEdgesState"))&&(console.warn("ReactFlow HMR error - refresh needed"),l(!0))};return window.addEventListener("error",e),()=>window.removeEventListener("error",e)},[]);const[d,s]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_users")||""),[c,p]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_roles")||""),[x,u]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_locations")||""),[h,g]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_departments")||""),[v,m]=(0,me.useState)(()=>localStorage.getItem("hierarchy_search_templates")||""),[f,b]=(0,me.useState)(()=>{const e=localStorage.getItem("hierarchy_expanded_sections");return e?JSON.parse(e):{users:!0,roles:!1,locations:!1,departments:!1,genericRecipients:!1,notificationTemplates:!1}}),[y,j]=(0,me.useState)(null),[k,z]=(0,me.useState)(null),[S,w]=(0,me.useState)(!1),[A,T]=(0,me.useState)(!0),[R,E]=(0,me.useState)(null),[C,I,_]=(0,be.ck)([]),[N,L,O]=(0,be.fM)([]),[P,D]=(0,me.useState)(null),[B,V]=(0,me.useState)([]),[M,W]=(0,me.useState)([]),[F,U]=(0,me.useState)([]),[H,K]=(0,me.useState)([]),[J,Y]=(0,me.useState)([]),[Z,G]=(0,me.useState)([]),[X,$]=(0,me.useState)([]),[q,Q]=(0,me.useState)([]),[ee,ne]=(0,me.useState)([]),[oe,te]=(0,me.useState)([]),[ie,ae]=(0,me.useState)("NONE"),[re,le]=(0,me.useState)(!1),[de,se]=(0,me.useState)(!0),[ce,pe]=(0,me.useState)("APPROVAL"),[xe,ue]=(0,me.useState)(!0),[he,ve]=(0,me.useState)(["uzivatel_id","garant_uzivatel_id","objednatel_id"]),[fe,_e]=(0,me.useState)("prime"),[Zn,Gn]=(0,me.useState)("OWN"),[Xn,$n]=(0,me.useState)(""),[qn,Qn]=(0,me.useState)(""),[eo,no]=(0,me.useState)(""),[oo,to]=(0,me.useState)(""),[io,ao]=(0,me.useState)([]),[ro,lo]=(0,me.useState)({orders:"READ_ONLY",invoices:"READ_ONLY",contracts:"READ_ONLY",cashbook:"READ_ONLY"}),[so,co]=(0,me.useState)({orders:!0,invoices:!0,contracts:!1,cashbook:!0,cashbookReadonly:!0}),[po,xo]=(0,me.useState)(!1),uo=(0,me.useCallback)(e=>{jo(n=>(0,ge.A)((0,ge.A)({},n),{},{[e]:!n[e]}))},[]),ho=((0,me.useCallback)(()=>{jo({})},[]),(0,me.useCallback)((e,n,o)=>{if(!n)return e;const t=n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.filter(e=>(e.name||e.label||e.nazev||String(e)).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))},[])),go=(0,me.useCallback)((e,n)=>"extendedLocations"===n||"extendedDepartments"===n?e.name+(e.code?" (".concat(e.code,")"):""):"notificationTypes"===n?e.name||e.label||String(e):e.name||e.label||e.nazev||String(e),[]),[vo,mo]=(0,me.useState)([]),[fo,bo]=(0,me.useState)([]),[yo,jo]=(0,me.useState)({}),[ko,zo]=(0,me.useState)({}),[So,wo]=(0,me.useState)({}),[Ao,To]=(0,me.useState)([]),[Ro,Eo]=(0,me.useState)(null),[Co,Io]=(0,me.useState)(!1),[_o,No]=(0,me.useState)("save");me.useEffect(()=>{k&&L(e=>e.map(e=>{var n;return e.id===k.id?(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{relationshipType:fe,druh_vztahu:fe,scope:Zn,modules:so,permissionLevel:ro,extended:{locations:q,departments:vo,combinations:fo},notifications:(0,ge.A)((0,ge.A)({},(null===(n=e.data)||void 0===n?void 0:n.notifications)||{}),{},{types:oe})})}):e}))},[q,vo,fo,oe,fe,Zn,so,ro,k]);const Lo=me.useRef(null);me.useEffect(()=>{if(k){if(Lo.current!==k.id)return void(Lo.current=k.id);L(e=>e.map(e=>e.id===k.id?(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{scope_filter:ie,sendEmail:re,sendInApp:de,recipientRole:ce,source_info_recipients:{enabled:xe,fields:he}})}):e))}else Lo.current=null},[ie,re,de,ce,xe,he,k]),me.useEffect(()=>{var e;y&&"template"===(null===(e=y.data)||void 0===e?void 0:e.type)&&I(e=>e.map(e=>e.id===y.id?(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{normalVariant:Xn,urgentVariant:qn,infoVariant:eo,previewVariant:oo,eventTypes:io})}):e))},[Xn,qn,eo,oo,io,y]);const[Oo,Po]=(0,me.useState)(new Set),[Do,Bo]=(0,me.useState)(new Set),[Vo,Mo]=(0,me.useState)(new Set),[Wo,Fo]=(0,me.useState)(new Set),[Uo,Ho]=(0,me.useState)(new Set),[Ko,Jo]=(0,me.useState)({isOpen:!1,title:"",message:"",onConfirm:null}),[Yo,Zo]=(0,me.useState)(()=>{const e=localStorage.getItem("hierarchy_help_collapsed");return!e||"false"===e}),[Go,Xo]=(0,me.useState)(!1),[$o,qo]=(0,me.useState)(!1),[Qo,et]=(0,me.useState)(null),[nt,ot]=(0,me.useState)({show:!1,type:"confirm",icon:"\u2753",title:"",message:"",onConfirm:null,onCancel:null,confirmText:"Pokra\u010dovat",cancelText:"Zru\u0161it",stats:null}),tt="hierarchy_draft_nodes",it="hierarchy_draft_edges",at="hierarchy_draft_timestamp",rt="hierarchy_selected_profile",[lt,dt]=(0,me.useState)(!1);(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_search_users",d)},[d]),(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_search_locations",x)},[x]),(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_search_departments",h)},[h]),(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_search_templates",v)},[v]),(0,me.useEffect)(()=>{localStorage.setItem("hierarchy_expanded_sections",JSON.stringify(f))},[f]),(0,me.useEffect)(()=>{if(C.length>0||N.length>0)try{localStorage.setItem(tt,JSON.stringify(C)),localStorage.setItem(it,JSON.stringify(N)),localStorage.setItem(at,(new Date).toISOString())}catch(e){console.warn("Failed to save draft:",e)}},[C,N]);const st=(0,me.useCallback)(()=>{const e=C.filter(e=>e.selected),n=N.filter(e=>e.selected);0===e.length&&0===n.length||ot({show:!0,type:"confirm",icon:"\ud83d\uddd1\ufe0f",title:"Smazat vybran\xe9 prvky?",message:"Opravdu chcete smazat ".concat(e.length," uzl\u016f a ").concat(n.length," vztah\u016f?"),confirmText:"Smazat",cancelText:"Zru\u0161it",onConfirm:()=>{if(e.length>0){const n=e.map(e=>e.id);I(e=>e.filter(e=>!n.includes(e.id))),L(e=>e.filter(e=>!n.includes(e.source)&&!n.includes(e.target)))}if(n.length>0){const e=n.map(e=>e.id);L(n=>n.filter(n=>!e.includes(n.id)))}ot((0,ge.A)((0,ge.A)({},nt),{},{show:!1})),console.log("\u2705 Deleted ".concat(e.length," nodes and ").concat(n.length," edges"))},onCancel:()=>{ot((0,ge.A)((0,ge.A)({},nt),{},{show:!1}))}})},[C,N,I,L,nt]);(0,me.useEffect)(()=>{const e=e=>{("Delete"===e.key||"Backspace"===e.key&&e.metaKey)&&(e.preventDefault(),st())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[st]),(0,me.useEffect)(()=>{const e=e=>{"Shift"!==e.key||po||xo(!0)},n=e=>{"Shift"===e.key&&xo(!1)},o=()=>{xo(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",n),window.addEventListener("blur",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n),window.removeEventListener("blur",o)}},[po]),(0,me.useEffect)(()=>{(async()=>{try{var e,n,t,i;T(!0),E(null);let g=!1;try{const e=localStorage.getItem(tt),n=localStorage.getItem(it),o=localStorage.getItem(at);if(e&&n&&o){const t=new Date(o);if((Date.now()-t.getTime())/36e5<24){const o=JSON.parse(e),t=JSON.parse(n);(o.length>0||t.length>0)&&(g=!0,dt(!0),I(o),L(t))}else localStorage.removeItem(tt),localStorage.removeItem(it),localStorage.removeItem(at)}}catch(h){console.warn("Failed to restore draft:",h)}const v=await Te.jK.token(),m=await Te.jK.user(),f=(null===m||void 0===m?void 0:m.username)||localStorage.getItem("username"),b="https://erdms.zachranka.cz/api.eeo/",y=async e=>{const n=await fetch("".concat(b,"/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v,username:f})});if(!n.ok)throw new Error("HTTP ".concat(n.status,": ").concat(e));return n.json()},[j,k,z,S,w,A,R,C]=await Promise.all([y("hierarchy/users"),y("ciselniky/role/list"),y("hierarchy/locations"),y("hierarchy/departments"),y("hierarchy/profiles/list"),y("hierarchy/notification-types"),y("notifications/templates/list"),y("notifications/event-types/list")]),_=j.data||[],N=(k.data||[]).map(e=>{const n=_.filter(n=>n.roles&&Array.isArray(n.roles)&&n.roles.includes(e.id)).length;return(0,ge.A)((0,ge.A)({},e),{},{userCount:n})});V(_),W(N),U(z.data||[]),K(S.data||[]),Y(A.data||[]),G(R.data||[]),$(C.data||[]);const O=w.data||[];To(O);let P=null;const D=localStorage.getItem(rt);if(D&&(P=O.find(e=>e.id===parseInt(D)),P&&console.log("\u2705 Loaded profile from localStorage:",P.name)),!P)try{const{getGlobalSettings:e}=await o.e(8319).then(o.bind(o,58319)),n=await e(v,f);n.hierarchy_profile_id&&(P=O.find(e=>e.id===parseInt(n.hierarchy_profile_id)),P&&console.log("\u2705 Loaded profile from Global Settings:",P.name))}catch(h){console.warn("\u26a0\ufe0f Failed to load profile from Global Settings:",h)}var a;if(!P)P=O.find(e=>e.isActive)||O[0],console.log("\u26a0\ufe0f Using fallback profile (active or first):",null===(a=P)||void 0===a?void 0:a.name);Eo(P||null);let B={success:!0,data:{nodes:[],edges:[]}};P&&(B=await fetch("".concat(Ie,"/hierarchy/profiles/load-structure"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v,username:f,profile_id:P.id})}).then(e=>e.json())),console.log("\ud83d\udd0d Loaded structure from DB:",B);const M=B.success&&B.data&&(B.data.nodes&&B.data.nodes.length>0||B.data.edges&&B.data.edges.length>0);if(console.log("\ud83d\udcca Should load from API?",M,{nodes:(null===(e=B.data)||void 0===e||null===(n=e.nodes)||void 0===n?void 0:n.length)||0,edges:(null===(t=B.data)||void 0===t||null===(i=t.edges)||void 0===i?void 0:i.length)||0}),M){var r,l,d,s,c,p,x,u;console.log("\u2705 Loading structure from API..."),console.log("\ud83d\udd0d Structure data.data.nodes:",null===(r=B)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.nodes),console.log("\ud83d\udd0d Structure data.data.edges:",null===(d=B)||void 0===d||null===(s=d.data)||void 0===s?void 0:s.edges);const e=Array.isArray(null===(c=B)||void 0===c||null===(p=c.data)||void 0===p?void 0:p.nodes)?B.data.nodes:[],n=Array.isArray(null===(x=B)||void 0===x||null===(u=x.data)||void 0===u?void 0:u.edges)?B.data.edges:[];if(0===e.length&&0===n.length)return console.warn("\u26a0\ufe0f Empty structure data from API - will load empty canvas"),I([]),L([]),void T(!1);console.log("\ud83d\udcca Converting ".concat(e.length," nodes and ").concat(n.length," edges from API"));const o=e.map(e=>({id:e.id,type:"custom",position:e.pozice||{x:100,y:100},data:e.data||{}})),t=n.map(e=>({id:e.id,source:e.source,target:e.target,type:"custom",animated:!1,data:e.data||{}}));console.log("\u2705 Loaded from API:",{nodes:o.length,edges:t.length}),I(o),L(t),dt(!1),localStorage.removeItem(tt),localStorage.removeItem(it),localStorage.removeItem(at)}else{console.log("\u26a0\ufe0f No API data, checking localStorage draft...");const e=localStorage.getItem(tt),n=localStorage.getItem(it);e&&n?(console.log("\u2705 Loading draft from localStorage"),I(JSON.parse(e)),L(JSON.parse(n)),dt(!0)):(console.log("\u2139\ufe0f No draft found - empty canvas"),I([]),L([]),dt(!1))}T(!1)}catch(R){console.error("\u274c Error loading initial data:",R),T(!1)}})()},[]),(0,me.useEffect)(()=>{(C.length>0||N.length>0)&&(localStorage.setItem(tt,JSON.stringify(C)),localStorage.setItem(it,JSON.stringify(N)),localStorage.setItem(at,Date.now().toString()))},[C,N]),(0,me.useEffect)(()=>{Ro&&Ro.id&&(I([]),L([]),T(!0),setTimeout(()=>T(!1),500))},[null===Ro||void 0===Ro?void 0:Ro.id]),(0,me.useEffect)(()=>{C.length>0&&P&&setTimeout(()=>{P.fitView({padding:.2,duration:400})},100)},[C.length,P]),(0,me.useEffect)(()=>{const e=e=>{};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);const ct=(0,me.useCallback)(e=>{const n=C.find(n=>n.id===e.source),o=C.find(n=>n.id===e.target);let t="user-user";if(n&&o){var i,a;const e=(null===(i=n.data)||void 0===i?void 0:i.type)||"user",r=(null===(a=o.data)||void 0===a?void 0:a.type)||"user";t="".concat(e,"-").concat(r)}let r="#3b82f6";t.includes("template")?r="#f59e0b":t.includes("role")?r="#8b5cf6":t.includes("location")?r="#92400e":t.includes("department")?r="#059669":"user-user"===t&&(r="#3b82f6"),L(n=>(0,be.rN)((0,ge.A)((0,ge.A)({},e),{},{type:"smoothstep",animated:!0,markerEnd:{type:be.TG.ArrowClosed,color:r},style:{stroke:r,strokeWidth:3},data:{type:t}}),n))},[C]);(0,me.useEffect)(()=>{I(e=>e.map(e=>{var n;const o=null===(n=e.data)||void 0===n?void 0:n.type;if("role"===o||"location"===o||"department"===o){const n=N.filter(n=>n.target===e.id).map(e=>C.find(n=>n.id===e.source)).filter(e=>{var n;return"user"===(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.type)}).length;return(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{metadata:(0,ge.A)((0,ge.A)({},e.data.metadata),{},{userCount:n})})})}return e}))},[N,C.length]);const pt=(0,me.useCallback)((e,n)=>{var o;e.ctrlKey||e.metaKey?(w(!1),j(null),z(null)):(j(n),z(null),w(!0),"template"===(null===(o=n.data)||void 0===o?void 0:o.type)&&($n(n.data.normalVariant||""),Qn(n.data.urgentVariant||""),no(n.data.infoVariant||""),to(n.data.previewVariant||n.data.normalVariant||""),ao(n.data.eventTypes||[])))},[]),xt=(0,me.useCallback)((e,n)=>{var o,t,i,a,r,l,d,s,c,p,x,u,h,g,v,m,f,b,y,k,S,A,T,R,E,I,_,N,L,O,P,D,B,V,M,W,F,U,H,K,J,Y,Z,G,X,$,q,ee,oe,ie,re,de,ce,xe,he,me,fe,be,ye,je,ke,ze,Se,we,Ae,Te,Re,Ee,Ce,Ie,Ne,Le,Oe,Pe,De,Be,Ve,Me,We,Fe,Ue,He,Ke,Je,Ye,Ze,Ge,Xe;z(n),j(null),w(!0);const $e=C.find(e=>e.id===n.source),qe=C.find(e=>e.id===n.target),Qe=(null===(o=n.data)||void 0===o||null===(t=o.extended)||void 0===t?void 0:t.locations)||(null===(i=n.data)||void 0===i||null===(a=i.permissions)||void 0===a||null===(r=a.extended)||void 0===r?void 0:r.locations)||[];Q(Qe);const en=(null===(l=n.data)||void 0===l||null===(d=l.extended)||void 0===d?void 0:d.departments)||(null===(s=n.data)||void 0===s||null===(c=s.permissions)||void 0===c||null===(p=c.extended)||void 0===p?void 0:p.departments)||[];mo(en),ae((null===(x=n.data)||void 0===x?void 0:x.scope_filter)||"NONE"),le((null===(u=n.data)||void 0===u?void 0:u.sendEmail)||!1),se(!1!==(null===(h=n.data)||void 0===h?void 0:h.sendInApp)),pe((null===(g=n.data)||void 0===g?void 0:g.recipientRole)||"APPROVAL"),te((null===(v=n.data)||void 0===v||null===(m=v.notifications)||void 0===m?void 0:m.types)||[]),_e((null===(f=n.data)||void 0===f?void 0:f.relationshipType)||(null===(b=n.data)||void 0===b?void 0:b.druh_vztahu)||"prime"),Gn((null===(y=n.data)||void 0===y?void 0:y.scope)||"OWN"),ue(!1!==(null===(k=n.data)||void 0===k||null===(S=k.source_info_recipients)||void 0===S?void 0:S.enabled)),ve((null===(A=n.data)||void 0===A||null===(T=A.source_info_recipients)||void 0===T?void 0:T.fields)||["uzivatel_id","garant_uzivatel_id","objednatel_id"]),co({orders:null!==(R=null!==(E=null===(I=n.data)||void 0===I||null===(_=I.modules)||void 0===_?void 0:_.orders)&&void 0!==E?E:null===(N=n.data)||void 0===N||null===(L=N.visibility)||void 0===L?void 0:L.objednavky)&&void 0!==R&&R,invoices:null!==(O=null!==(P=null===(D=n.data)||void 0===D||null===(B=D.modules)||void 0===B?void 0:B.invoices)&&void 0!==P?P:null===(V=n.data)||void 0===V||null===(M=V.visibility)||void 0===M?void 0:M.faktury)&&void 0!==O&&O,contracts:null!==(W=null!==(F=null===(U=n.data)||void 0===U||null===(H=U.modules)||void 0===H?void 0:H.contracts)&&void 0!==F?F:null===(K=n.data)||void 0===K||null===(J=K.visibility)||void 0===J?void 0:J.smlouvy)&&void 0!==W&&W,cashbook:null!==(Y=null!==(Z=null===(G=n.data)||void 0===G||null===(X=G.modules)||void 0===X?void 0:X.cashbook)&&void 0!==Z?Z:null===($=n.data)||void 0===$||null===(q=$.visibility)||void 0===q?void 0:q.pokladna)&&void 0!==Y&&Y,cashbookReadonly:null!==(ee=null===(oe=n.data)||void 0===oe||null===(ie=oe.modules)||void 0===ie?void 0:ie.cashbookReadonly)&&void 0!==ee&&ee,users:null!==(re=null!==(de=null===(ce=n.data)||void 0===ce||null===(xe=ce.modules)||void 0===xe?void 0:xe.users)&&void 0!==de?de:null===(he=n.data)||void 0===he||null===(me=he.visibility)||void 0===me?void 0:me.uzivatele)&&void 0!==re&&re,lp:null!==(fe=null!==(be=null===(ye=n.data)||void 0===ye||null===(je=ye.modules)||void 0===je?void 0:je.lp)&&void 0!==be?be:null===(ke=n.data)||void 0===ke||null===(ze=ke.visibility)||void 0===ze?void 0:ze.lp)&&void 0!==fe&&fe}),lo({orders:(null===(Se=n.data)||void 0===Se||null===(we=Se.permissionLevel)||void 0===we?void 0:we.orders)||"READ_ONLY",invoices:(null===(Ae=n.data)||void 0===Ae||null===(Te=Ae.permissionLevel)||void 0===Te?void 0:Te.invoices)||"READ_ONLY",contracts:(null===(Re=n.data)||void 0===Re||null===(Ee=Re.permissionLevel)||void 0===Ee?void 0:Ee.contracts)||"READ_ONLY",cashbook:(null===(Ce=n.data)||void 0===Ce||null===(Ie=Ce.permissionLevel)||void 0===Ie?void 0:Ie.cashbook)||"READ_ONLY"});const nn=(null===(Ne=n.data)||void 0===Ne||null===(Le=Ne.extended)||void 0===Le?void 0:Le.combinations)||(null===(Oe=n.data)||void 0===Oe||null===(Pe=Oe.permissions)||void 0===Pe||null===(De=Pe.extended)||void 0===De?void 0:De.combinations)||[];bo(nn);const on=(null===(Be=n.data)||void 0===Be||null===(Ve=Be.notifications)||void 0===Ve?void 0:Ve.types)||(null===(Me=n.data)||void 0===Me||null===(We=Me.permissions)||void 0===We||null===(Fe=We.notifications)||void 0===Fe?void 0:Fe.types)||[];ne(on),z((0,ge.A)((0,ge.A)({},n),{},{metadata:{sourceName:(null===$e||void 0===$e||null===(Ue=$e.data)||void 0===Ue?void 0:Ue.name)||"Neznamy",targetName:(null===qe||void 0===qe||null===(He=qe.data)||void 0===He?void 0:He.name)||"Neznamy",sourceType:(null===$e||void 0===$e||null===(Ke=$e.data)||void 0===Ke||null===(Je=Ke.metadata)||void 0===Je?void 0:Je.type)||(null===$e||void 0===$e||null===(Ye=$e.data)||void 0===Ye?void 0:Ye.type)||"user",targetType:(null===qe||void 0===qe||null===(Ze=qe.data)||void 0===Ze||null===(Ge=Ze.metadata)||void 0===Ge?void 0:Ge.type)||(null===qe||void 0===qe||null===(Xe=qe.data)||void 0===Xe?void 0:Xe.type)||"user"}}))},[C]),ut=(0,me.useCallback)((e,n)=>{const o={"user-user":{label:"U\u017eivatel \u2192 U\u017eivatel",icon:"\ud83d\udc64\u2192\ud83d\udc64",description:"Klasick\xfd nad\u0159\xedzen\xfd-pod\u0159\xedzen\xfd vztah",sourceLabel:"Nad\u0159\xedzen\xfd (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"Pod\u0159\xedzen\xfd (sd\xedl\xed data)",showScope:!0,showExtended:!0,showModules:!0,explanation:(e,n)=>"".concat(e," z\xedsk\xe1 pr\xe1va vid\u011bt data od ").concat(n," podle nastaven\xed rozsahu a modul\u016f.")},"location-user":{label:"Lokalita \u2192 U\u017eivatel",icon:"\ud83d\udccd\u2192\ud83d\udc64",description:"V\u0161ichni u\u017eivatel\xe9 z lokality sd\xedl\xed data nad\u0159\xedzen\xe9mu",sourceLabel:"Lokalita (zdroj dat)",targetLabel:"Nad\u0159\xedzen\xfd u\u017eivatel (z\xedsk\xe1v\xe1 data)",showScope:!1,showExtended:!1,showModules:!0,explanation:(e,n)=>"".concat(n," z\xedsk\xe1 pr\xe1va vid\u011bt data od V\u0160ECH u\u017eivatel\u016f v lokalit\u011b ").concat(e,".")},"user-location":{label:"U\u017eivatel \u2192 Lokalita",icon:"\ud83d\udc64\u2192\ud83d\udccd",description:"Nad\u0159\xedzen\xfd vid\xed v\u0161echny u\u017eivatele v lokalit\u011b",sourceLabel:"Nad\u0159\xedzen\xfd u\u017eivatel (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"Lokalita (zdroj dat)",showScope:!1,showExtended:!0,showModules:!0,explanation:(e,n)=>"".concat(e," z\xedsk\xe1 pr\xe1va vid\u011bt data od V\u0160ECH u\u017eivatel\u016f v lokalit\u011b ").concat(n,".")},"department-user":{label:"\xdasek \u2192 U\u017eivatel",icon:"\ud83c\udfe2\u2192\ud83d\udc64",description:"V\u0161ichni u\u017eivatel\xe9 z \xfaseku sd\xedl\xed data nad\u0159\xedzen\xe9mu",sourceLabel:"\xdasek (zdroj dat)",targetLabel:"Nad\u0159\xedzen\xfd u\u017eivatel (z\xedsk\xe1v\xe1 data)",showScope:!1,showExtended:!1,showModules:!0,explanation:(e,n)=>"".concat(n," z\xedsk\xe1 pr\xe1va vid\u011bt data od V\u0160ECH u\u017eivatel\u016f v \xfaseku ").concat(e,".")},"user-department":{label:"U\u017eivatel \u2192 \xdasek",icon:"\ud83d\udc64\u2192\ud83c\udfe2",description:"Nad\u0159\xedzen\xfd vid\xed v\u0161echny u\u017eivatele v \xfaseku",sourceLabel:"Nad\u0159\xedzen\xfd u\u017eivatel (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"\xdasek (zdroj dat)",showScope:!1,showExtended:!0,showModules:!0,explanation:(e,n)=>"".concat(e," z\xedsk\xe1 pr\xe1va vid\u011bt data od V\u0160ECH u\u017eivatel\u016f v \xfaseku ").concat(n,".")},"template-user":{label:"Notifika\u010dn\xed \u0161ablona \u2192 U\u017eivatel",icon:"\ud83d\udce7\u2192\ud83d\udc64",description:"U\u017eivatel bude dost\xe1vat notifikace z t\xe9to \u0161ablony",sourceLabel:"Notifika\u010dn\xed \u0161ablona",targetLabel:"P\u0159\xedjemce (u\u017eivatel)",showScope:!1,showExtended:!1,showModules:!1,explanation:(e,n)=>"".concat(n,' bude dost\xe1vat notifikace typu "').concat(e,'".')},"template-location":{label:"Notifika\u010dn\xed \u0161ablona \u2192 Lokalita",icon:"\ud83d\udce7\u2192\ud83d\udccd",description:"V\u0161ichni u\u017eivatel\xe9 v lokalit\u011b budou dost\xe1vat notifikace",sourceLabel:"Notifika\u010dn\xed \u0161ablona",targetLabel:"P\u0159\xedjemci (lokalita)",showScope:!1,showExtended:!1,showModules:!1,explanation:(e,n)=>"V\u0160ICHNI u\u017eivatel\xe9 v lokalit\u011b ".concat(n,' budou dost\xe1vat notifikace typu "').concat(e,'".')},"template-department":{label:"Notifika\u010dn\xed \u0161ablona \u2192 \xdasek",icon:"\ud83d\udce7\u2192\ud83c\udfe2",description:"V\u0161ichni u\u017eivatel\xe9 v \xfaseku budou dost\xe1vat notifikace",sourceLabel:"Notifika\u010dn\xed \u0161ablona",targetLabel:"P\u0159\xedjemci (\xfasek)",showScope:!1,showExtended:!1,showModules:!1,explanation:(e,n)=>"V\u0160ICHNI u\u017eivatel\xe9 v \xfaseku ".concat(n,' budou dost\xe1vat notifikace typu "').concat(e,'".')},"user-role":{label:"U\u017eivatel \u2192 Role",icon:"\ud83d\udc64\u2192\ud83d\udee1\ufe0f",description:"U\u017eivatel z\xedsk\xe1v\xe1 opr\xe1vn\u011bn\xed z role",sourceLabel:"U\u017eivatel (p\u0159\xedjemce pr\xe1v)",targetLabel:"Role (zdroj opr\xe1vn\u011bn\xed)",showScope:!1,showExtended:!1,showModules:!0,explanation:(e,n)=>"".concat(e," m\xe1 p\u0159i\u0159azenou roli ").concat(n," a z\xedsk\xe1v\xe1 z n\xed opr\xe1vn\u011bn\xed pro moduly.")},"role-user":{label:"Role \u2192 U\u017eivatel",icon:"\ud83d\udee1\ufe0f\u2192\ud83d\udc64",description:"Role p\u0159i\u0159azuje opr\xe1vn\u011bn\xed u\u017eivateli",sourceLabel:"Role (zdroj opr\xe1vn\u011bn\xed)",targetLabel:"U\u017eivatel (p\u0159\xedjemce pr\xe1v)",showScope:!1,showExtended:!1,showModules:!0,explanation:(e,n)=>"Role ".concat(e," p\u0159i\u0159azuje opr\xe1vn\u011bn\xed u\u017eivateli ").concat(n,".")},"template-role":{label:"Notifika\u010dn\xed \u0161ablona \u2192 Role",icon:"\ud83d\udce7\u2192\ud83d\udee1\ufe0f",description:"V\u0161ichni u\u017eivatel\xe9 s rol\xed budou dost\xe1vat notifikace",sourceLabel:"Notifika\u010dn\xed \u0161ablona",targetLabel:"P\u0159\xedjemci (role)",showScope:!1,showExtended:!1,showModules:!1,explanation:(e,n)=>"V\u0160ICHNI u\u017eivatel\xe9 s rol\xed ".concat(n,' budou dost\xe1vat notifikace typu "').concat(e,'".')},"department-role":{label:"\xdasek \u2192 Role",icon:"\ud83c\udfe2\u2192\ud83d\udee1\ufe0f",description:"U\u017eivatel\xe9 s danou rol\xed v \xfaseku z\xedsk\xe1vaj\xed viditelnost dat",sourceLabel:"\xdasek (zdroj dat)",targetLabel:"Role (z\xedsk\xe1v\xe1 pr\xe1va)",showScope:!0,showExtended:!1,showModules:!0,explanation:(e,n)=>"V\u0161ichni u\u017eivatel\xe9 s rol\xed ".concat(n," z\xedskaj\xed pr\xe1va vid\u011bt data z \xfaseku ").concat(e,".")},"role-department":{label:"Role \u2192 \xdasek",icon:"\ud83d\udee1\ufe0f\u2192\ud83c\udfe2",description:"Role z\xedsk\xe1v\xe1 viditelnost dat z \xfaseku",sourceLabel:"Role (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"\xdasek (zdroj dat)",showScope:!0,showExtended:!1,showModules:!0,explanation:(e,n)=>"U\u017eivatel\xe9 s rol\xed ".concat(e," z\xedskaj\xed pr\xe1va vid\u011bt data z \xfaseku ").concat(n,".")},"location-role":{label:"Lokalita \u2192 Role",icon:"\ud83d\udccd\u2192\ud83d\udee1\ufe0f",description:"U\u017eivatel\xe9 s danou rol\xed v lokalit\u011b z\xedsk\xe1vaj\xed viditelnost dat",sourceLabel:"Lokalita (zdroj dat)",targetLabel:"Role (z\xedsk\xe1v\xe1 pr\xe1va)",showScope:!0,showExtended:!1,showModules:!0,explanation:(e,n)=>"V\u0161ichni u\u017eivatel\xe9 s rol\xed ".concat(n," z\xedskaj\xed pr\xe1va vid\u011bt data z lokality ").concat(e,".")},"role-location":{label:"Role \u2192 Lokalita",icon:"\ud83d\udee1\ufe0f\u2192\ud83d\udccd",description:"Role z\xedsk\xe1v\xe1 viditelnost dat z lokality",sourceLabel:"Role (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"Lokalita (zdroj dat)",showScope:!0,showExtended:!1,showModules:!0,explanation:(e,n)=>"U\u017eivatel\xe9 s rol\xed ".concat(e," z\xedskaj\xed pr\xe1va vid\u011bt data z lokality ").concat(n,".")},"role-role":{label:"Role \u2192 Role",icon:"\ud83d\udee1\ufe0f\u2192\ud83d\udee1\ufe0f",description:"Hierarchick\xfd vztah mezi rolemi (nad\u0159\xedzen\xe1 \u2192 pod\u0159\xedzen\xe1)",sourceLabel:"Nad\u0159\xedzen\xe1 role (z\xedsk\xe1v\xe1 pr\xe1va)",targetLabel:"Pod\u0159\xedzen\xe1 role (sd\xedl\xed data)",showScope:!0,showExtended:!0,showModules:!0,explanation:(e,n)=>"".concat(e," z\xedsk\xe1 pr\xe1va vid\u011bt data od u\u017eivatel\u016f s rol\xed ").concat(n,". Rozsah a Moduly ur\u010duj\xed, co p\u0159esn\u011b uvid\xed (objedn\xe1vky/faktury/pokladnu).")}};return o["".concat(e,"-").concat(n)]||o["user-user"]},[]),ht=(0,me.useCallback)(async(e,n)=>{console.log("\ud83c\udfaf Node drag stopped:",n.id,"Position:",n.position);const o=C.find(e=>e.id===n.id);var t;o&&console.log("\ud83d\udccd Updated node position saved to local state:",{id:o.id,userId:null===(t=o.data)||void 0===t?void 0:t.userId,position:o.position})},[C]),gt=e=>{b(n=>(0,ge.A)((0,ge.A)({},n),{},{[e]:!n[e]}))},vt=e=>{Ho(n=>{const o=new Set(n);return o.has(e)?o.delete(e):o.add(e),o})},[mt,ft]=me.useState(null),bt=function(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TB";const t=new we.graphlib.Graph;t.setDefaultEdgeLabel(()=>({}));t.setGraph({rankdir:o,nodesep:80,ranksep:120,marginx:50,marginy:50}),e.forEach(e=>{t.setNode(e.id,{width:200,height:120})}),n.forEach(e=>{t.setEdge(e.source,e.target)}),Ae().layout(t);return{nodes:e.map(e=>{const n=t.node(e.id);return(0,ge.A)((0,ge.A)({},e),{},{position:{x:n.x-100,y:n.y-60}})}),edges:n}},yt=e=>{if(console.log("\ud83e\udd16 AI: Reorganizing hierarchy from SELECTED NODES on canvas...",e.length),0===e.length)return;const n=e.find(e=>{var n;const o=(null===(n=e.data.position)||void 0===n?void 0:n.toLowerCase())||"";return"\u0159editel"===o||"\u0159editelka"===o}),o=e.filter(e=>{var n;return null===(n=e.data.position)||void 0===n?void 0:n.toLowerCase().includes("n\xe1m\u011bstek")}),t=e.filter(e=>{var n;return null===(n=e.data.position)||void 0===n?void 0:n.toLowerCase().includes("vedouc\xed")}),i=e.filter(e=>{var n,o,t;return!(null!==(n=e.data.position)&&void 0!==n&&n.toLowerCase().includes("\u0159editel"))&&!(null!==(o=e.data.position)&&void 0!==o&&o.toLowerCase().includes("n\xe1m\u011bstek"))&&!(null!==(t=e.data.position)&&void 0!==t&&t.toLowerCase().includes("vedouc\xed"))}),a=[],r=Date.now();n&&(o.forEach(e=>{a.push({id:"e-".concat(n.id,"-").concat(e.id,"-").concat(r),source:n.id,target:e.id,type:"smoothstep",animated:!0,markerEnd:{type:be.TG.ArrowClosed},style:{stroke:"#667eea",strokeWidth:3}})}),t.forEach(e=>{const t=o.find(n=>{var o,t;return(null===(o=n.data.metadata)||void 0===o?void 0:o.department)===(null===(t=e.data.metadata)||void 0===t?void 0:t.department)})||n;a.push({id:"e-".concat(t.id,"-").concat(e.id,"-").concat(r),source:t.id,target:e.id,type:"smoothstep",animated:!0,markerEnd:{type:be.TG.ArrowClosed},style:{stroke:"#667eea",strokeWidth:3}})}));const l=new Set(e.map(e=>e.id)),d=[...N.filter(e=>!l.has(e.source)||!l.has(e.target)),...a],{nodes:s,edges:c}=bt(C,d,"TB");I(s),L(c),ot({show:!0,type:"success",icon:"\u2705",title:"Hierarchie reorganizov\xe1na!",message:"Vybran\xe9 nody (".concat(e.length,") byly reorganizov\xe1ny podle rol\xed.\nZkontrolujte strukturu a p\u0159\xedpadn\u011b upravte."),stats:{"\u0158editel":n?"1":"0","N\xe1m\u011bstci":o.length,"Vedouc\xed":t.length,"Ostatn\xed":i.length,"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":"\u2500\u2500\u2500\u2500\u2500","Nov\xe9 vztahy":a.length},onConfirm:()=>ot(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null})},jt=async()=>{try{const e=await Te.jK.token(),n=await Te.jK.user(),o=(null===n||void 0===n?void 0:n.username)||localStorage.getItem("username"),t="https://erdms.zachranka.cz/api.eeo/",i=await fetch("".concat(t,"/hierarchy/profiles/list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,username:o})}),a=await i.json();if(a.success){To(a.data||[]);const e=a.data.find(e=>e.isActive)||a.data[0];Eo(e||null)}}catch(e){console.error("Failed to load profiles:",e)}},kt=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const n=await Te.jK.token(),o=await Te.jK.user(),t=(null===o||void 0===o?void 0:o.username)||localStorage.getItem("username"),i="https://erdms.zachranka.cz/api.eeo/",r=e||(null===Ro||void 0===Ro?void 0:Ro.id)||1;console.log("\ud83d\udcca HIERARCHY SAVE START - Current state:",{profileId:r,totalNodes:C.length,totalEdges:N.length});const l={token:n,username:t,profile_id:r,nodes:C.map(e=>{var n,o,t,i,a,r;return{id:e.id,typ:(null===(n=e.data)||void 0===n?void 0:n.type)||(null!==(o=e.data)&&void 0!==o&&o.userId?"user":null!==(t=e.data)&&void 0!==t&&t.locationId?"location":null!==(i=e.data)&&void 0!==i&&i.departmentId?"department":null!==(a=e.data)&&void 0!==a&&a.templateId?"template":null!==(r=e.data)&&void 0!==r&&r.roleId?"role":"user"),pozice:e.position,data:e.data}}),edges:N.map(e=>{var n,o;return{id:e.id,source:e.source,target:e.target,typ:(null===(n=e.data)||void 0===n?void 0:n.typ)||(null!==(o=e.data)&&void 0!==o&&o.notifications?"notification":"relation"),data:e.data||{}}})};console.log("\ud83d\udcbe HIERARCHY SAVE - Payload:",JSON.stringify(l,null,2));const d=await fetch("".concat(i,"/hierarchy/profiles/save-structure"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(console.log("\ud83d\udce1 SAVE Response status:",d.status,d.statusText),!d.ok){const e=await d.text();throw console.error("\u274c SAVE Error response:",e),new Error("Chyba pri ukladani")}const s=await d.json();if(console.log("\u2705 SAVE Result:",s),!s.success)throw console.error("\u274c SAVE Failed:",s.error,s.details),new Error(s.error||"Neznama chyba");if(localStorage.removeItem(tt),localStorage.removeItem(it),localStorage.removeItem(at),dt(!1),s.profile_id&&s.profile_id!==(null===Ro||void 0===Ro?void 0:Ro.id)){const e=Ao.find(e=>e.id===s.profile_id);e&&(Eo(e),localStorage.setItem(rt,e.id.toString()),console.log("\ud83d\udd04 Automaticky p\u0159epnuto na profil:",e.name))}a("\u2705 Hierarchie \xfasp\u011b\u0161n\u011b ulo\u017eena! Ulo\u017eeno ".concat(C.length," uzl\u016f a ").concat(N.length," vztah\u016f."),{type:"success",timeout:5e3})}catch(n){console.error("\ud83d\udca5 SAVE Exception:",n),ot({show:!0,type:"alert",icon:"\u274c",title:"Chyba pri ukladani",message:n.message,onConfirm:()=>ot(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null})}},zt=B.filter(e=>{var n,o,t;return(null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(d.toLowerCase()))||(null===(o=e.position)||void 0===o?void 0:o.toLowerCase().includes(d.toLowerCase()))||(null===(t=e.location)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase()))}),St=M.filter(e=>{var n;return(null===(n=e.nazev_role)||void 0===n?void 0:n.toLowerCase().includes(c.toLowerCase()))||e.popis&&e.popis.toLowerCase().includes(c.toLowerCase())}),wt=F.filter(e=>{var n,o;return(null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(x.toLowerCase()))||(null===(o=e.code)||void 0===o?void 0:o.toLowerCase().includes(x.toLowerCase()))}),At=H.filter(e=>{var n,o;return(null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(h.toLowerCase()))||(null===(o=e.code)||void 0===o?void 0:o.toLowerCase().includes(h.toLowerCase()))}),Tt=Z.filter(e=>{var n,o;return(null===(n=e.nazev||e.name)||void 0===n?void 0:n.toLowerCase().includes(v.toLowerCase()))||(null===(o=e.typ||e.type)||void 0===o?void 0:o.toLowerCase().includes(v.toLowerCase()))||e.description&&e.description.toLowerCase().includes(v.toLowerCase())});return r?(0,Ce.jsxs)(Ne,{children:[(0,Ce.jsx)(Le,{children:(0,Ce.jsxs)(Oe,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.FFg}),"Syst\xe9m workflow a notifikac\xed"]})}),(0,Ce.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#f59e0b",fontSize:"1.1rem"},children:(0,Ce.jsxs)("div",{style:{textAlign:"center"},children:[(0,Ce.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\u26a0\ufe0f"}),(0,Ce.jsx)("div",{style:{marginBottom:"1rem"},children:"Hot-reload chyba detekov\xe1na"}),(0,Ce.jsx)("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"600"},children:"Obnovit str\xe1nku (F5)"})]})})]}):A?(0,Ce.jsxs)(Ne,{children:[(0,Ce.jsx)(Le,{children:(0,Ce.jsxs)(Oe,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.FFg}),"Syst\xe9m workflow a notifikac\xed"]})}),(0,Ce.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#64748b",fontSize:"1.1rem"},children:(0,Ce.jsxs)("div",{style:{textAlign:"center"},children:[(0,Ce.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\u23f3"}),(0,Ce.jsx)("div",{children:"Na\u010d\xedt\xe1n\xed hierarchie..."})]})})]}):R?(0,Ce.jsxs)(Ne,{children:[(0,Ce.jsx)(Le,{children:(0,Ce.jsxs)(Oe,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.FFg}),"Syst\xe9m workflow a notifikac\xed"]})}),(0,Ce.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#ef4444",fontSize:"1.1rem"},children:(0,Ce.jsxs)("div",{style:{textAlign:"center"},children:[(0,Ce.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\u274c"}),(0,Ce.jsxs)("div",{children:["Chyba p\u0159i na\u010d\xedt\xe1n\xed: ",R]})]})})]}):(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsx)("style",{children:"\n        .email-preview-body::-webkit-scrollbar {\n          width: 8px;\n        }\n        .email-preview-body::-webkit-scrollbar-track {\n          background: #f9fafb;\n        }\n        .email-preview-body::-webkit-scrollbar-thumb {\n          background: #d1d5db;\n          border-radius: 4px;\n        }\n        .email-preview-body::-webkit-scrollbar-thumb:hover {\n          background: #9ca3af;\n        }\n      "}),(0,Ce.jsxs)(Ne,{children:[(0,Ce.jsxs)(Le,{children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,Ce.jsxs)(Oe,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.FFg}),"Syst\xe9m workflow a notifikac\xed"]}),(C.length>0||N.length>0)&&(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:lt?"#dbeafe":"#fef3c7",border:"1px solid ".concat(lt?"#60a5fa":"#fbbf24"),borderRadius:"6px",fontSize:"0.85rem",color:lt?"#1e3a8a":"#92400e"},children:[(0,Ce.jsx)("span",{style:{fontSize:"1.2rem"},children:lt?"\ud83d\udcbe":"\u26a0\ufe0f"}),(0,Ce.jsxs)("span",{children:[(0,Ce.jsx)("strong",{children:C.length})," uzl\u016f, ",(0,Ce.jsx)("strong",{children:N.length})," vztah\u016f",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:lt?"Nacteno z auto-draftu":"Neulozeno (auto-draft)"})]})]})]}),(0,Ce.jsxs)(Pe,{children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",minWidth:"320px"},children:[(0,Ce.jsx)("label",{style:{fontSize:"0.85rem",fontWeight:600,color:"#6b7280",whiteSpace:"nowrap"},children:"Profil:"}),(0,Ce.jsxs)(zn,{children:[(0,Ce.jsx)(Sn,{value:(null===Ro||void 0===Ro?void 0:Ro.id)||"",onChange:e=>(async e=>{console.log("\ud83d\udd04 handleProfileChange called with profileId:",e);const n=Ao.find(n=>n.id===parseInt(e));if(console.log("\ud83d\udd0d Found profile:",n),n){if(!lt||!(C.length>0||N.length>0)||window.confirm('M\xe1te neulo\u017een\xe9 zm\u011bny v auto-draftu.\n\nChcete na\u010d\xedst profil "'.concat(n.name,'"?\n\nNeulo\u017een\xe9 zm\u011bny budou ztraceny.'))){Eo(n),localStorage.setItem(rt,e.toString()),console.log("\ud83d\udcc2 Loading profile:",n.name,"ID:",e);try{const n=await Te.jK.token(),o=await Te.jK.user(),t=(null===o||void 0===o?void 0:o.username)||localStorage.getItem("username"),i="https://erdms.zachranka.cz/api.eeo/",a=await fetch("".concat(i,"/hierarchy/profiles/load-structure"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n,username:t,profile_id:e})}),r=await a.json();if(console.log("\ud83d\udce5 Profile structure response:",r),r.success&&r.data){const e=r.data.nodes||[],n=r.data.edges||[];if(0===e.length&&0===n.length)I([]),L([]),console.log("\ud83d\udced Empty profile loaded");else{console.log("\ud83d\udce6 Received nodes:",e.length,"edges:",n.length);const o=e.map((e,n)=>(0,ge.A)((0,ge.A)({},e),{},{position:e.position||{x:100+n%5*200,y:100+150*Math.floor(n/5)}}));I(o),L(n),console.log("\u2705 Profile loaded:",o.length,"nodes,",n.length,"edges"),setTimeout(()=>{P&&(P.fitView({padding:.2,duration:800}),console.log("\ud83d\udd04 ReactFlow viewport refitted after profile load"))},100)}localStorage.removeItem(tt),localStorage.removeItem(it),localStorage.removeItem(at),dt(!1)}}catch(o){console.error("Failed to load profile structure:",o)}}}else console.log("\u274c Profile not found!")})(e.target.value),children:Ao.map(e=>(0,Ce.jsxs)("option",{value:e.id,children:[e.name,e.isActive?" \u2705":" \u26aa",e.relationshipsCount>0?" (".concat(e.relationshipsCount,")"):""]},e.id))}),(0,Ce.jsx)(wn,{children:"\u25bc"}),(0,Ce.jsx)(An,{onClick:e=>{e.stopPropagation(),(async()=>{if(!Ro)return;const e=!Ro.isActive,n=e?"aktivovat":"deaktivovat";try{const n=await Te.jK.token(),t=await Te.jK.user(),i=(null===t||void 0===t?void 0:t.username)||localStorage.getItem("username"),{setProfileActive:a}=await o.e(6102).then(o.bind(o,96102));await a(n,i,Ro.id,e),To(Ao.map(n=>n.id===Ro.id?(0,ge.A)((0,ge.A)({},n),{},{isActive:e}):n)),Eo((0,ge.A)((0,ge.A)({},Ro),{},{isActive:e}));const r=e?"aktivov\xe1n (viditeln\xfd v AppSettings)":"deaktivov\xe1n (skryt\xfd v AppSettings)";console.log('\u2705 Profil "'.concat(Ro.name,'" byl ').concat(r))}catch(R){console.error("Chyba p\u0159i pokusu ".concat(n," profil:"),R),alert("Nepoda\u0159ilo se ".concat(n," profil: ").concat(R.message))}})()},disabled:!Ro,title:null!==Ro&&void 0!==Ro&&Ro.isActive?"Deaktivovat profil (skryje se v AppSettings)":"Aktivovat profil (zobraz\xed se v AppSettings)",style:{background:null!==Ro&&void 0!==Ro&&Ro.isActive?"#10b981":"#6b7280",marginRight:"4px",fontSize:"0.85rem",padding:"4px 8px"},children:null!==Ro&&void 0!==Ro&&Ro.isActive?"\u2713":"\u25cb"}),(0,Ce.jsx)(An,{onClick:e=>{e.stopPropagation(),(async()=>{if(!Ro||Ao.length<=1)return;const e=Ro.relationshipsCount>0?"\n\n\u26a0\ufe0f Profil obsahuje ".concat(Ro.relationshipsCount," vztah\u016f, kter\xe9 budou tak\xe9 smaz\xe1ny!"):"";ot({show:!0,type:"confirm",icon:"\ud83d\uddd1\ufe0f",title:"Smazat profil?",message:'Opravdu chcete smazat profil "'.concat(Ro.name,'"?').concat(e,"\n\nTato akce je nevratn\xe1!"),onConfirm:async()=>{try{const e=await Te.jK.token(),n=await Te.jK.user(),o=(null===n||void 0===n?void 0:n.username)||localStorage.getItem("username"),t="https://erdms.zachranka.cz/api.eeo/",i=await fetch("".concat(t,"/hierarchy/profiles/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,username:o,profile_id:Ro.id})}),a=await i.json();if(!a.success)throw new Error(a.error||"Chyba p\u0159i maz\xe1n\xed profilu");ot({show:!0,type:"success",icon:"\u2705",title:"Profil smaz\xe1n",message:'Profil "'.concat(Ro.name,'" byl \xfasp\u011b\u0161n\u011b smaz\xe1n.'),onConfirm:()=>ot(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null}),await jt(),I([]),L([])}catch(e){console.error("Delete profile error:",e),ot({show:!0,type:"alert",icon:"\u274c",title:"Chyba p\u0159i maz\xe1n\xed",message:e.message,onConfirm:()=>ot(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null})}},onCancel:()=>ot(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"Smazat",cancelText:"Zru\u0161it"})})()},disabled:!Ro||Ao.length<=1,title:Ao.length<=1?"Nelze smazat posledn\xed profil":"Smazat aktu\xe1ln\xed profil",children:"\ud83d\uddd1\ufe0f"})]})]}),(0,Ce.jsxs)(De,{onClick:()=>{const e=C.filter(e=>e.selected);0!==e.length?yt(e):ot({show:!0,type:"alert",icon:"\u26a0\ufe0f",title:"\u017d\xe1dn\xe9 polo\u017eky nevybr\xe1ny na plo\u0161e",message:"Pro vytvo\u0159en\xed AI hierarchie mus\xedte nejprve vybrat nody na plo\u0161e.\n\nPou\u017eijte:\n\u2022 T\xe1hn\u011bte my\u0161\xed pro v\xfdb\u011br oblasti (crosshair kurzor)\n\u2022 CTRL+klik pro individu\xe1ln\xed v\xfdb\u011br\n\u2022 SHIFT+klik pro rozsah",onConfirm:()=>ot(e=>(0,ge.A)((0,ge.A)({},e),{},{show:!1})),confirmText:"OK",cancelText:null})},disabled:A||0===B.length,children:[(0,Ce.jsx)("span",{style:{fontSize:"1.1rem",marginRight:"4px"},children:"\ud83e\udd16"}),"AI Asistent"]}),(0,Ce.jsxs)(De,{onClick:()=>{if(C.length>0){const{nodes:e,edges:n}=bt(C,N,"TB");I(e),L(n),console.log("\ud83d\udcd0 Manual layout applied")}},disabled:0===C.length,title:"Automaticky prerovnat existujici strukturu",children:[(0,Ce.jsx)("span",{style:{fontSize:"1.1rem",marginRight:"4px"},children:"\ud83d\udcd0"}),"P\u0159erovnat"]}),(0,Ce.jsxs)(De,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.pS3}),"N\xe1hled"]}),(0,Ce.jsxs)(De,{primary:!0,onClick:()=>kt(),disabled:A||0===C.length&&0===N.length,children:[(0,Ce.jsx)(ze.g,{icon:Ee.hSh}),"Ulo\u017eit"]}),(0,Ce.jsxs)(De,{onClick:()=>{No("saveAs"),Io(!0)},disabled:A||0===C.length&&0===N.length,children:[(0,Ce.jsx)(ze.g,{icon:Ee.hSh}),"Ulo\u017eit jako..."]})]})]}),(0,Ce.jsxs)("div",{style:{padding:"8px 16px",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",borderBottom:"2px solid #e0e6ed",display:"flex",alignItems:"center",gap:"20px",fontSize:"0.8rem",flexWrap:"wrap"},children:[(0,Ce.jsx)("span",{style:{fontWeight:700,color:"#475569"},children:"Legenda vztah\u016f:"}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Ce.jsx)("div",{style:{width:"30px",height:"3px",background:"#3b82f6",borderRadius:"2px"}}),(0,Ce.jsx)("span",{style:{color:"#1e40af"},children:"U\u017eivatel"})]}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Ce.jsx)("div",{style:{width:"30px",height:"3px",background:"#92400e",borderRadius:"2px"}}),(0,Ce.jsx)("span",{style:{color:"#78350f"},children:"Lokalita"})]}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Ce.jsx)("div",{style:{width:"30px",height:"3px",background:"#059669",borderRadius:"2px"}}),(0,Ce.jsx)("span",{style:{color:"#065f46"},children:"\xdasek"})]}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Ce.jsx)("div",{style:{width:"30px",height:"3px",background:"#f59e0b",borderRadius:"2px"}}),(0,Ce.jsx)("span",{style:{color:"#d97706"},children:"Notifikace"})]}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,Ce.jsx)("div",{style:{width:"30px",height:"3px",background:"#8b5cf6",borderRadius:"2px"}}),(0,Ce.jsx)("span",{style:{color:"#6d28d9"},children:"Role"})]})]}),(0,Ce.jsxs)(He,{children:[(0,Ce.jsxs)(Ke,{children:[(0,Ce.jsx)(Je,{children:(0,Ce.jsxs)(Ye,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.qIE}),"P\u0159ehled polo\u017eek workflow"]})}),(0,Ce.jsxs)(Ze,{children:[(0,Ce.jsx)(Xe,{children:(0,Ce.jsx)(ze.g,{icon:Ee.MjD})}),(0,Ce.jsx)(Ge,{placeholder:"Hledat ve v\u0161ech sekc\xedch...",value:d,onChange:e=>{const n=e.target.value;s(n),u(n),g(n),m(n)}}),d&&(0,Ce.jsx)($e,{onClick:()=>{s(""),u(""),g(""),m("")},title:"Vymazat vyhled\xe1v\xe1n\xed ve v\u0161ech sekc\xedch",children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})]}),(0,Ce.jsxs)(qe,{children:[(0,Ce.jsxs)(Qe,{children:[(0,Ce.jsxs)(en,{expanded:f.users,onClick:()=>gt("users"),children:[(0,Ce.jsx)(ze.g,{icon:f.users?Ee.Jt$:Ee.XkK}),(0,Ce.jsx)(ze.g,{icon:Ee.gdJ}),"U\u017dIVATEL\xc9 (",zt.length,")",Oo.size>0&&(0,Ce.jsxs)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#667eea",fontWeight:"bold"},children:[Oo.size," vybr\xe1no"]})]}),(0,Ce.jsxs)(nn,{expanded:f.users,children:[(0,Ce.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:(0,Ce.jsxs)(Ze,{style:{margin:0},children:[(0,Ce.jsx)(Xe,{children:(0,Ce.jsx)(ze.g,{icon:Ee.MjD})}),(0,Ce.jsx)(Ge,{placeholder:"Hledat u\u017eivatele...",value:d,onChange:e=>s(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),d&&(0,Ce.jsx)($e,{onClick:()=>s(""),title:"Vymazat",children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})]})}),(0,Ce.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed",display:"flex",gap:"8px"},children:(0,Ce.jsx)("button",{onClick:e=>{e.stopPropagation(),Oo.size===zt.length?Po(new Set):Po(new Set(zt.map(e=>e.id)))},style:{flex:1,padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:Oo.size===zt.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})}),(0,Ce.jsx)("div",{children:zt.map(e=>(0,Ce.jsxs)(on,{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow",e.id),ft(e.id),console.log("\ud83d\udc49 Drag start:",e.id,e.name)},onDragEnd:()=>{ft(null),console.log("\ud83d\udea9 Drag end")},style:{background:Oo.has(e.id)?"#ede9fe":"white",borderColor:Oo.has(e.id)?"#8b5cf6":"#e0e6ed",cursor:"grab"},children:[(0,Ce.jsx)("input",{type:"checkbox",checked:Oo.has(e.id),onChange:n=>{var o;n.stopPropagation(),o=e.id,Po(e=>{const n=new Set(e);return n.has(o)?n.delete(o):n.add(o),n})},onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#8b5cf6",flexShrink:0}}),(0,Ce.jsx)(tn,{children:e.initials}),(0,Ce.jsxs)(an,{children:[(0,Ce.jsx)(rn,{children:e.name}),(0,Ce.jsxs)(ln,{children:[e.position," \u2022 ",e.location]})]})]},e.id))})]})]}),(0,Ce.jsxs)(Qe,{children:[(0,Ce.jsxs)(en,{expanded:f.roles,onClick:()=>gt("roles"),children:[(0,Ce.jsx)(ze.g,{icon:f.roles?Ee.Jt$:Ee.XkK}),(0,Ce.jsx)(ze.g,{icon:Ee.CN3}),"ROLE (",St.length,")"]}),(0,Ce.jsxs)(nn,{expanded:f.roles,children:[(0,Ce.jsxs)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:[(0,Ce.jsxs)(Ze,{style:{margin:0},children:[(0,Ce.jsx)(Xe,{children:(0,Ce.jsx)(ze.g,{icon:Ee.MjD})}),(0,Ce.jsx)(Ge,{placeholder:"Hledat roli...",value:c,onChange:e=>p(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),c&&(0,Ce.jsx)($e,{onClick:()=>p(""),title:"Vymazat",children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})]}),(0,Ce.jsx)("button",{onClick:()=>{Do.size===St.length?Bo(new Set):Bo(new Set(St.map(e=>e.id)))},style:{width:"100%",marginTop:"8px",padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:Do.size===St.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})]}),(0,Ce.jsx)("div",{children:St.map(e=>(0,Ce.jsxs)(on,{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow","role-".concat(e.id)),ft("role-".concat(e.id))},onDragEnd:()=>ft(null),style:{background:Do.has(e.id)?"#f5f3ff":"white",borderColor:Do.has(e.id)?"#8b5cf6":"#e0e6ed",cursor:"grab"},children:[(0,Ce.jsx)("input",{type:"checkbox",checked:Do.has(e.id),onChange:n=>{var o;n.stopPropagation(),o=e.id,Bo(e=>{const n=new Set(e);return n.has(o)?n.delete(o):n.add(o),n})},onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#8b5cf6",flexShrink:0}}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",flex:1},children:[(0,Ce.jsx)(ze.g,{icon:Ee.CN3,style:{color:"#8b5cf6",fontSize:"1.1rem"}}),(0,Ce.jsxs)("div",{style:{flex:1},children:[(0,Ce.jsx)("div",{style:{fontWeight:"600",fontSize:"0.85rem",color:"#6d28d9"},children:e.nazev_role}),(0,Ce.jsxs)("div",{style:{fontSize:"0.7rem",color:"#8b5cf6",marginTop:"2px"},children:[e.userCount||0," u\u017eivatel\u016f",e.popis?" \u2022 ".concat(e.popis):""]})]})]})]},"role-".concat(e.id)))})]})]}),(0,Ce.jsxs)(Qe,{children:[(0,Ce.jsxs)(en,{expanded:f.locations,onClick:()=>gt("locations"),children:[(0,Ce.jsx)(ze.g,{icon:f.locations?Ee.Jt$:Ee.XkK}),(0,Ce.jsx)(ze.g,{icon:Ee.Pcr}),"LOKALITY (",wt.length,")",Vo.size>0&&(0,Ce.jsxs)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#f5576c",fontWeight:"bold"},children:[Vo.size," vybr\xe1no"]})]}),(0,Ce.jsxs)(nn,{expanded:f.locations,children:[(0,Ce.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:(0,Ce.jsxs)(Ze,{style:{margin:0},children:[(0,Ce.jsx)(Xe,{children:(0,Ce.jsx)(ze.g,{icon:Ee.MjD})}),(0,Ce.jsx)(Ge,{placeholder:"Hledat lokalitu...",value:x,onChange:e=>u(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),x&&(0,Ce.jsx)($e,{onClick:()=>u(""),title:"Vymazat",children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})]})}),(0,Ce.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed",display:"flex",gap:"8px"},children:(0,Ce.jsx)("button",{onClick:e=>{e.stopPropagation(),Vo.size===wt.length?Mo(new Set):Mo(new Set(wt.map(e=>e.id)))},style:{flex:1,padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:Vo.size===wt.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})}),(0,Ce.jsx)("div",{children:wt.map(e=>(0,Ce.jsxs)(dn,{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow","loc-".concat(e.id)),ft("loc-".concat(e.id)),console.log("\ud83d\udccd Drag start location:",e.id,e.name)},onDragEnd:()=>{ft(null),console.log("\ud83c\udfc1 Drag end")},style:{background:Vo.has(e.id)?"#fef3c7":"white",borderColor:Vo.has(e.id)?"#fbbf24":"#e0e6ed",cursor:"grab"},children:[(0,Ce.jsx)("input",{type:"checkbox",checked:Vo.has(e.id),onChange:n=>{var o;n.stopPropagation(),o=e.id,Mo(e=>{const n=new Set(e);return n.has(o)?n.delete(o):n.add(o),n})},onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#f59e0b",flexShrink:0}}),(0,Ce.jsx)(sn,{children:(0,Ce.jsx)(ze.g,{icon:Ee.URI})}),(0,Ce.jsxs)(an,{children:[(0,Ce.jsx)(rn,{children:e.name}),(0,Ce.jsxs)(ln,{children:[e.userCount," u\u017eivatel\u016f \u2022 ",e.code]})]})]},e.id))})]})]}),(0,Ce.jsxs)(Qe,{children:[(0,Ce.jsxs)(en,{expanded:f.departments,onClick:()=>gt("departments"),children:[(0,Ce.jsx)(ze.g,{icon:f.departments?Ee.Jt$:Ee.XkK}),(0,Ce.jsx)(ze.g,{icon:Ee.BzA}),"\xdaSEKY (",At.length,")",Wo.size>0&&(0,Ce.jsxs)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#00f2fe",fontWeight:"bold"},children:[Wo.size," vybr\xe1no"]})]}),(0,Ce.jsxs)(nn,{expanded:f.departments,children:[(0,Ce.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:(0,Ce.jsxs)(Ze,{style:{margin:0},children:[(0,Ce.jsx)(Xe,{children:(0,Ce.jsx)(ze.g,{icon:Ee.MjD})}),(0,Ce.jsx)(Ge,{placeholder:"Hledat \xfatvar...",value:h,onChange:e=>g(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),h&&(0,Ce.jsx)($e,{onClick:()=>g(""),title:"Vymazat",children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})]})}),(0,Ce.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed",display:"flex",gap:"8px"},children:(0,Ce.jsx)("button",{onClick:e=>{e.stopPropagation(),Wo.size===At.length?Fo(new Set):Fo(new Set(At.map(e=>e.id)))},style:{flex:1,padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:Wo.size===At.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})}),(0,Ce.jsx)("div",{children:At.map(e=>(0,Ce.jsxs)(dn,{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow","dept-".concat(e.id)),ft("dept-".concat(e.id)),console.log("\ud83c\udfe2 Drag start department:",e.id,e.name)},onDragEnd:()=>{ft(null),console.log("\ud83c\udfc1 Drag end")},style:{background:Wo.has(e.id)?"#dbeafe":"white",borderColor:Wo.has(e.id)?"#60a5fa":"#e0e6ed",cursor:"grab"},children:[(0,Ce.jsx)("input",{type:"checkbox",checked:Wo.has(e.id),onChange:n=>{var o;n.stopPropagation(),o=e.id,Fo(e=>{const n=new Set(e);return n.has(o)?n.delete(o):n.add(o),n})},onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#3b82f6",flexShrink:0}}),(0,Ce.jsx)(cn,{children:(0,Ce.jsx)(ze.g,{icon:Ee.BzA})}),(0,Ce.jsxs)(an,{children:[(0,Ce.jsx)(rn,{children:e.name}),(0,Ce.jsxs)(ln,{children:[e.userCount," u\u017eivatel\u016f \u2022 ",e.code]})]})]},e.id))})]})]}),(0,Ce.jsxs)(Qe,{children:[(0,Ce.jsxs)(en,{expanded:f.notificationTemplates,onClick:()=>gt("notificationTemplates"),children:[(0,Ce.jsx)(ze.g,{icon:f.notificationTemplates?Ee.Jt$:Ee.XkK}),(0,Ce.jsx)(ze.g,{icon:Ee.z$e}),"NOTIFIKA\u010cN\xcd \u0160ABLONY (",Tt.length,")",Uo.size>0&&(0,Ce.jsxs)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#f59e0b",fontWeight:"bold"},children:[Uo.size," vybr\xe1no"]})]}),(0,Ce.jsxs)(nn,{expanded:f.notificationTemplates,children:[(0,Ce.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed"},children:(0,Ce.jsxs)(Ze,{style:{margin:0},children:[(0,Ce.jsx)(Xe,{children:(0,Ce.jsx)(ze.g,{icon:Ee.MjD})}),(0,Ce.jsx)(Ge,{placeholder:"Hledat \u0161ablonu...",value:v,onChange:e=>m(e.target.value),style:{fontSize:"0.85rem",padding:"8px 32px"}}),v&&(0,Ce.jsx)($e,{onClick:()=>m(""),title:"Vymazat",children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})]})}),(0,Ce.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e6ed",display:"flex",gap:"8px"},children:(0,Ce.jsx)("button",{onClick:e=>{e.stopPropagation(),Uo.size===Tt.length?Ho(new Set):Ho(new Set(Tt.map(e=>e.id)))},style:{flex:1,padding:"6px 12px",background:"#f8fafc",border:"1px solid #e0e6ed",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",color:"#475569",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#e2e8f0",onMouseLeave:e=>e.target.style.background="#f8fafc",children:Uo.size===Tt.length?"\u2610 Zru\u0161it v\u0161e":"\u2611 Vybrat v\u0161e"})}),(0,Ce.jsx)("div",{children:Tt.map(e=>{var n;return(0,Ce.jsxs)("div",{draggable:!0,onDragStart:n=>{n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("application/reactflow","notif-".concat(e.id)),ft("notif-".concat(e.id)),console.log("\ud83d\udd14 Drag start notification template:",e.id,e.nazev||e.name)},onDragEnd:()=>{ft(null),console.log("\ud83c\udfc1 Drag end")},style:{padding:"12px",borderBottom:"1px solid #e0e6ed",display:"flex",alignItems:"flex-start",gap:"10px",cursor:"grab",background:Uo.has(e.id)?"#fef3c7":"white",transition:"all 0.2s"},onClick:()=>vt(e.id),children:[(0,Ce.jsx)("input",{type:"checkbox",checked:Uo.has(e.id),onChange:()=>vt(e.id),onClick:e=>e.stopPropagation(),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#f59e0b",flexShrink:0,marginTop:"2px"}}),(0,Ce.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:"linear-gradient(135deg, #f59e0b 0%, #ea580c 100%)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1rem",flexShrink:0,boxShadow:"0 2px 8px rgba(245, 158, 11, 0.3)"},children:(0,Ce.jsx)(ze.g,{icon:Ee.z$e})}),(0,Ce.jsxs)("div",{style:{flex:1},children:[(0,Ce.jsx)("div",{style:{fontWeight:"600",color:"#2c3e50",fontSize:"0.9rem",marginBottom:"4px"},children:e.nazev||e.name}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",display:"flex",alignItems:"center",gap:"8px"},children:[(0,Ce.jsx)("code",{style:{background:"#f1f5f9",padding:"2px 6px",borderRadius:"4px",fontSize:"0.7rem"},children:e.typ||e.type}),(null===(n=e.email)||void 0===n?void 0:n.sendByDefault)&&(0,Ce.jsxs)("span",{style:{color:"#3b82f6"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.y_8})," Email"]}),(0,Ce.jsx)("span",{style:{color:"urgent"===e.priorityDefault?"#dc2626":"high"===e.priorityDefault?"#f59e0b":"#64748b",fontWeight:"600"},children:e.priorityDefault})]})]})]},e.id)})})]})]})]}),(Oo.size>0||Vo.size>0||Wo.size>0||Uo.size>0)&&(0,Ce.jsxs)("div",{style:{position:"absolute",bottom:"66px",left:0,right:0,padding:"16px",borderTop:"2px solid #e0e6ed",background:"linear-gradient(180deg, #f8fafc 0%, white 100%)",boxShadow:"0 -4px 12px rgba(0,0,0,0.05)",zIndex:9},children:[(0,Ce.jsxs)("button",{onClick:()=>{const e=[];let n=C.length;const o=Date.now();Oo.forEach((t,i)=>{const a=B.find(e=>e.id===t);a&&(e.push({id:"user-".concat(t,"-").concat(o,"-").concat(i),type:"custom",position:{x:100+n%5*250,y:100+180*Math.floor(n/5)},data:{userId:t,name:a.name,position:a.position,initials:a.initials,metadata:{location:a.location,department:a.department}}}),n++)}),Vo.forEach((t,i)=>{const a=F.find(e=>e.id===t);a&&(e.push({id:"location-".concat(t,"-").concat(o,"-").concat(i),type:"custom",position:{x:100+n%5*250,y:100+180*Math.floor(n/5)},data:{type:"location",locationId:t,name:a.name}}),n++)}),Wo.forEach((t,i)=>{const a=H.find(e=>e.id===t);a&&(e.push({id:"department-".concat(t,"-").concat(o,"-").concat(i),type:"custom",position:{x:100+n%5*250,y:100+180*Math.floor(n/5)},data:{type:"department",departmentId:t,name:a.name}}),n++)}),Uo.forEach((t,i)=>{const a=Z.find(e=>e.id===t);a&&(e.push({id:"template-".concat(t,"-").concat(o,"-").concat(i),type:"custom",position:{x:100+n%5*250,y:100+180*Math.floor(n/5)},data:{type:"template",templateId:t,name:a.nazev||a.name,position:"Notifika\u010dn\xed \u0161ablona",initials:"\ud83d\udd14",metadata:{type:"template",template:a.nazev||a.name}}}),n++)}),e.length>0&&(I(n=>[...n,...e]),console.log("\u2705 Added ".concat(e.length," nodes to canvas")),Po(new Set),Mo(new Set),Fo(new Set))},style:{width:"100%",padding:"12px 16px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"0.95rem",fontWeight:"700",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.4)",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 16px rgba(102, 126, 234, 0.5)"},onMouseLeave:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.QLR}),(0,Ce.jsxs)("span",{children:["P\u0159idat vybran\xe9 (",Oo.size+Vo.size+Wo.size+Uo.size,")"]})]}),(0,Ce.jsxs)("div",{style:{marginTop:"8px",fontSize:"0.75rem",color:"#64748b",textAlign:"center"},children:[Oo.size>0&&"".concat(Oo.size," u\u017eivatel\u016f"),Oo.size>0&&(Vo.size>0||Wo.size>0||Uo.size>0)&&" \u2022 ",Vo.size>0&&"".concat(Vo.size," lokalit"),Vo.size>0&&(Wo.size>0||Uo.size>0)&&" \u2022 ",Wo.size>0&&"".concat(Wo.size," \xfatvar\u016f"),Wo.size>0&&Uo.size>0&&" \u2022 ",Uo.size>0&&"".concat(Uo.size," \u0161ablon")]})]}),(0,Ce.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"12px 16px",background:"white",borderTop:"2px solid #e0e6ed",boxShadow:"0 -4px 12px rgba(0,0,0,0.05)",zIndex:10},children:(0,Ce.jsxs)("button",{onClick:()=>{Jo({isOpen:!0,title:"Resetovat plochu",message:"Opravdu chcete smazat celou plochu a za\u010d\xedt znovu od za\u010d\xe1tku? Tato akce je nevratn\xe1.",onConfirm:()=>{I([]),L([]),localStorage.removeItem("hierarchy_draft_nodes"),localStorage.removeItem("hierarchy_draft_edges"),localStorage.removeItem("hierarchy_draft_timestamp"),dt(!1),Jo({isOpen:!1,title:"",message:"",onConfirm:null})}})},disabled:0===C.length,style:{width:"100%",padding:"10px 16px",background:0===C.length?"#f1f5f9":"white",color:0===C.length?"#94a3b8":"#dc2626",border:"2px solid ".concat(0===C.length?"#e2e8f0":"#fecaca"),borderRadius:"8px",cursor:0===C.length?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s"},onMouseEnter:e=>{C.length>0&&(e.target.style.background="#fef2f2",e.target.style.borderColor="#dc2626")},onMouseLeave:e=>{C.length>0&&(e.target.style.background="white",e.target.style.borderColor="#fecaca")},children:[(0,Ce.jsx)(ze.g,{icon:Ee.yLS}),(0,Ce.jsx)("span",{children:"Resetovat plochu"})]})})]}),(0,Ce.jsx)(pn,{onDrop:e=>{if(e.preventDefault(),!mt)return void console.log("\u26a0\ufe0f No dragged item");if(!P)return void console.log("\u26a0\ufe0f ReactFlow instance not ready");const n=mt,o=e.currentTarget.querySelector(".react-flow");if(!o)return void console.error("\u26a0\ufe0f ReactFlow element not found");const t=o.getBoundingClientRect(),i=P.screenToFlowPosition({x:e.clientX-110,y:e.clientY-40});if(console.log("\ud83d\udce6 Drop:",{dragId:n,position:i,clientX:e.clientX,clientY:e.clientY,bounds:{left:t.left,top:t.top},viewport:P.getViewport()}),n.startsWith("notif-")){const e=parseInt(n.replace("notif-",""),10),o=Z.find(n=>n.id===e);if(o){const n={id:"template-".concat(e,"-").concat(Date.now()),type:"custom",position:i,data:{type:"template",templateId:e,name:o.nazev||o.name,position:"Notifika\u010dn\xed \u0161ablona",initials:"\ud83d\udd14",metadata:{type:"template",template:o.nazev||o.name}}};I(e=>[...e,n]),console.log("\u2705 Added notification template node: ".concat(o.nazev||o.name))}return}if(n.startsWith("role-")){const e=parseInt(n.replace("role-",""),10),o=M.find(n=>n.id===e);if(o){const n={id:"role-".concat(e,"-").concat(Date.now()),type:"custom",position:i,data:{type:"role",roleId:e,name:o.nazev_role,label:o.nazev_role,metadata:{type:"role",popis:o.popis||"",orders:o.orders||0,invoices:o.invoices||0,cashbook:o.cashbook||0}}};I(e=>[...e,n]),console.log("\u2705 Added role node: ".concat(o.nazev_role),n)}return}if(!n.startsWith("loc-")&&!n.startsWith("dept-")&&!n.startsWith("role-")){const e=B.find(e=>e.id===n);if(e){const o={id:"user-".concat(n,"-").concat(Date.now()),type:"custom",position:i,data:{type:"user",userId:n,name:e.name,position:e.position,initials:e.initials,metadata:{location:e.location,department:e.department}}};I(e=>[...e,o])}return}if(n.startsWith("loc-")){const e=n.replace("loc-","");console.log("\ud83d\udccd LOCATION DROP - ID:",e);const o=F.find(n=>n.id===e);if(!o)return void console.error("\u274c Location not found:",e);const t={id:"location-".concat(e,"-").concat(Date.now()),type:"custom",position:i,data:{type:"location",locationId:e,name:o.name,position:"Lokalita",initials:o.name.substring(0,2).toUpperCase(),metadata:{type:"location",location:o.name}}};return I(e=>[...e,t]),void console.log("\u2705 Added location node: ".concat(o.name))}if(n.startsWith("dept-")){const e=n.replace("dept-","");console.log("\ud83c\udfe2 DEPARTMENT DROP - ID:",e);const o=H.find(n=>n.id===e);if(!o)return void console.error("\u274c Department not found:",e);const t={id:"department-".concat(e,"-").concat(Date.now()),type:"custom",position:i,data:{type:"department",departmentId:e,name:o.name,position:"Utvar",initials:o.name.substring(0,2).toUpperCase(),metadata:{type:"department",department:o.name}}};return I(e=>[...e,t]),void console.log("\u2705 Added department node: ".concat(o.name))}},onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},className:po?"selection-mode":"",children:(0,Ce.jsxs)(be.Gc,{nodes:C,edges:N,onNodesChange:_,onEdgesChange:O,onConnect:ct,onNodeClick:pt,onEdgeClick:xt,onNodeDragStop:ht,onInit:e=>{D(e),setTimeout(()=>{e.fitView({padding:.2,duration:800}),console.log("\ud83d\udd04 ReactFlow fitted on init")},100)},nodeTypes:Hn,edgeTypes:Kn,fitView:!0,attributionPosition:"bottom-left",selectionOnDrag:!0,panOnDrag:!0,panOnScroll:!0,zoomOnScroll:!0,zoomOnDoubleClick:!1,selectionMode:"partial",selectionKeyCode:"Shift",multiSelectionKeyCode:"Control",selectNodesOnDrag:!1,onSelectionChange:e=>{const n=e.nodes.length,o=e.edges.length,t=n+o;1===t?1===n?(j(e.nodes[0]),z(null),w(!0)):1===o&&(z(e.edges[0]),j(null),w(!0)):(w(!1),j(null),z(null))},children:[(0,Ce.jsx)(ke.V,{color:"#cbd5e1",gap:20,size:1}),(0,Ce.jsx)(je.H,{}),(0,Ce.jsx)(ye.o,{nodeColor:e=>{var n,o,t;return"template"===(null===(n=e.data)||void 0===n?void 0:n.type)?"#f59e0b":"location"===(null===(o=e.data)||void 0===o?void 0:o.type)?"#92400e":"department"===(null===(t=e.data)||void 0===t?void 0:t.type)?"#059669":"#3b82f6"},maskColor:"rgba(245, 247, 250, 0.8)",pannable:!0,zoomable:!0,style:{background:"white",border:"1px solid #e0e6ed",borderRadius:"8px",cursor:"pointer"}}),Yo?(0,Ce.jsxs)(be.Zk,{position:"top-left",style:{background:"white",borderRadius:"12px",border:"1px solid #e0e6ed",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",padding:"16px",width:"360px",maxHeight:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px",paddingBottom:"10px",borderBottom:"1px solid #e0e6ed"},children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Ce.jsx)("span",{style:{fontSize:"1.4rem"},children:"\ud83d\udca1"}),(0,Ce.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.95rem"},children:"N\xe1pov\u011bda"})]}),(0,Ce.jsx)("button",{onClick:()=>{Zo(!1),localStorage.setItem("hierarchy_help_collapsed","true")},style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"1.3rem",color:"#94a3b8",padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"6px",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#f1f5f9",e.currentTarget.style.color="#64748b"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},title:"Skr\xfdt n\xe1pov\u011bdu",children:"\u2715"})]}),(0,Ce.jsxs)("div",{style:{overflowY:"auto",overflowX:"hidden",color:"#64748b",fontSize:"0.82rem",lineHeight:"1.5",paddingRight:"8px"},children:[(0,Ce.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Ce.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"1. Ovl\xe1d\xe1n\xed pl\xe1tna:"}),"\u2022 ",(0,Ce.jsx)("strong",{children:"Posun:"})," T\xe1hn\u011bte my\u0161\xed (bez kl\xe1vesy)",(0,Ce.jsx)("br",{}),"\u2022 ",(0,Ce.jsx)("strong",{children:"SHIFT + ta\u017een\xed:"})," V\xfdb\u011br v\xedce nod\u016f najednou",(0,Ce.jsx)("br",{}),"\u2022 ",(0,Ce.jsx)("strong",{children:"CTRL + klik:"})," P\u0159idat/odebrat node do v\xfdb\u011bru"]}),(0,Ce.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Ce.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"2. P\u0159idejte u\u017eivatele:"}),"\u2022 P\u0159et\xe1hn\u011bte z lev\xe9ho panelu",(0,Ce.jsx)("br",{}),"\u2022 Nebo pou\u017eijte \ud83e\udd16 AI Struktura"]}),(0,Ce.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Ce.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"3. Vytvo\u0159te vztah (\u0161ipku):"}),"\u2022 Najd\u011bte \ud83d\udfe2 zelen\xfd krou\u017eek DOLE u nad\u0159\xedzen\xe9ho",(0,Ce.jsx)("br",{}),"\u2022 Dr\u017ete a t\xe1hn\u011bte my\u0161\xed",(0,Ce.jsx)("br",{}),"\u2022 Pus\u0165te na \ud83d\udd35 modr\xfd krou\u017eek NAHO\u0158E u pod\u0159\xedzen\xe9ho"]}),(0,Ce.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Ce.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"4. P\u0159erovn\xe1n\xed:"}),"\u2022 Tlacitko \ud83d\udcd0 Prerovnat = automaticky layout",(0,Ce.jsx)("br",{}),"\u2022 Nebo p\u0159etahujte uzly ru\u010dn\u011b"]}),(0,Ce.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Ce.jsx)("strong",{style:{color:"#2c3e50",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"5. Detail vztahu:"}),"\u2022 Klikn\u011bte na \u0161ipku \u2192 otev\u0159e se prav\xfd panel",(0,Ce.jsx)("br",{}),"\u2022 Nastavte pr\xe1va a lokality"]}),(0,Ce.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Ce.jsx)("strong",{style:{color:"#f5576c",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"6. Ulozeni:"}),'\u2022 Tla\u010d\xedtko "Ulo\u017eit do DB" vpravo naho\u0159e']}),(0,Ce.jsxs)("div",{style:{padding:"10px",background:"#f0fdf4",borderRadius:"8px",border:"1px solid #86efac"},children:[(0,Ce.jsx)("strong",{style:{color:"#10b981",fontSize:"0.85rem",display:"block",marginBottom:"4px"},children:"\ud83d\udcbe Auto-save:"}),(0,Ce.jsx)("span",{style:{fontSize:"0.8rem"},children:"Pozice uzlu se ukladaji automaticky do localStorage a obnovi se po refreshi. Draft se vymaze po ulozeni do DB."})]})]})]}):(0,Ce.jsx)(be.Zk,{position:"top-left",style:{background:"white",borderRadius:"12px",border:"1px solid #e0e6ed",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",width:"52px",height:"52px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},onClick:()=>{Zo(!0),localStorage.setItem("hierarchy_help_collapsed","false")},children:(0,Ce.jsx)("span",{style:{fontSize:"1.7rem",transition:"transform 0.2s"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.2)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",title:"Zobrazit n\xe1pov\u011bdu",children:"\ud83d\udca1"})})]})}),S&&(y||k)&&(0,Ce.jsxs)(xn,{children:[(0,Ce.jsxs)(un,{children:[(0,Ce.jsxs)(hn,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.MT7}),y?"Detail uzlu":"Detail vztahu"]}),(0,Ce.jsx)(vn,{onClick:()=>Xo(!0),children:(0,Ce.jsx)(ze.g,{icon:Ee.iW_})}),(0,Ce.jsx)(gn,{onClick:()=>{w(!1),j(null),z(null),I(e=>e.map(e=>(0,ge.A)((0,ge.A)({},e),{},{data:(0,ge.A)((0,ge.A)({},e.data),{},{isSelected:!1})})))},children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})]}),(0,Ce.jsxs)(mn,{children:[(0,Ce.jsxs)(fn,{children:[(0,Ce.jsxs)(bn,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.BzA}),"Z\xe1kladn\xed informace"]}),y&&"template"===y.data.type&&(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"N\xe1zev \u0161ablony"}),(0,Ce.jsx)(kn,{value:y.data.label||y.data.name,readOnly:!0})]}),(0,Ce.jsxs)("div",{style:{padding:"14px",background:"linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%)",border:"2px solid #3b82f6",borderRadius:"8px",marginBottom:"16px"},children:[(0,Ce.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"#1e40af",marginBottom:"8px"},children:"\ud83c\udfaf Jak funguje nov\xfd notifika\u010dn\xed syst\xe9m"}),(0,Ce.jsxs)("div",{style:{fontSize:"0.8rem",color:"#1e3a8a",lineHeight:"1.6"},children:[(0,Ce.jsx)("strong",{children:"1\ufe0f\u20e3 \u0160ablona obsahuje text a design emailu"}),(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"2\ufe0f\u20e3 Propojte \u0161ablonu se \u0161ipkou na p\u0159\xedjemce:"}),(0,Ce.jsxs)("ul",{style:{margin:"4px 0 4px 20px",padding:0},children:[(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"\ud83d\udc64 Konkr\xe9tn\xed u\u017eivatel"})," - nap\u0159. Jan Nov\xe1k"]}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"\ud83c\udfad Role"}),' - nap\u0159. v\u0161ichni s rol\xed "Schvalovatel"']}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"\ud83c\udfaf Dynamick\xfd p\u0159\xedjemce"})," - nap\u0159. Spou\u0161t\u011b\u010d akce, Objednatel, P\u0159\xedkazce"]})]}),(0,Ce.jsx)("strong",{children:"3\ufe0f\u20e3 Na \u0161ipce nastavte:"}),(0,Ce.jsxs)("ul",{style:{margin:"4px 0 4px 20px",padding:0},children:[(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"Scope Filter"})," - koho zahrnout (v\u0161ichni/jen \xfa\u010dastn\xedci entity...)"]}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"Event Types"})," - kdy poslat (ORDER_SENT_FOR_APPROVAL...)"]})]}),(0,Ce.jsxs)("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #93c5fd",fontStyle:"italic",fontSize:"0.75rem"},children:["\ud83d\udca1 ",(0,Ce.jsx)("strong",{children:"Tip:"})," Klikn\u011bte na ",(0,Ce.jsx)("strong",{children:"\u0161ipku"})," pro nastaven\xed routingu, nebo skrolujte dol\u016f pro p\u0159ehled v\u0161ech p\u0159ipojen\xfdch p\u0159\xedjemc\u016f"]})]})]}),(()=>{const e=Z.find(e=>e.id===y.data.templateId);if(!e)return null;const n=(e=>{if(!e)return[];const n=[];return[{type:"RECIPIENT",icon:"\ud83d\udfe0",name:"P\u0159\xedjemce (oran\u017eov\xe1 - norm\xe1ln\xed)"},{type:"APPROVER_NORMAL",icon:"\ud83d\udfe0",name:"Schvalovatel (oran\u017eov\xe1 - norm\xe1ln\xed)"},{type:"APPROVER_URGENT",icon:"\ud83d\udd34",name:"Schvalovatel (\u010derven\xe1 - urgentn\xed)"},{type:"SUBMITTER",icon:"\ud83d\udfe2",name:"Autor objedn\xe1vky (zelen\xe1 - info)"}].forEach(o=>{const t="\x3c!-- RECIPIENT: ".concat(o.type," --\x3e");e.includes(t)&&n.push({type:o.type,icon:o.icon,name:o.name})}),n})(e.email_telo||e.email_body),o=n.length>0?n[0].type:"";return 0===n.length?(0,Ce.jsxs)("div",{style:{padding:"12px",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"6px",color:"#991b1b",fontSize:"0.85rem"},children:["\u26a0\ufe0f ",(0,Ce.jsx)("strong",{children:"Varov\xe1n\xed:"})," Email \u0161ablona neobsahuje \u017e\xe1dn\xe9 varianty"]}):(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(yn,{children:[(0,Ce.jsxs)(jn,{children:["\ud83d\udfe0 Barva emailu pro B\u011a\u017dN\xc9 p\u0159\xedpady",(0,Ce.jsx)("span",{style:{color:"#f59e0b",marginLeft:"4px"},children:"*"})]}),(0,Ce.jsx)("select",{value:Xn||o,onChange:e=>$n(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e6ed",borderRadius:"6px",fontSize:"0.9rem",background:"white",cursor:"pointer",fontWeight:"500"},children:n.map(e=>(0,Ce.jsxs)("option",{value:e.type,children:[e.icon," ",e.name]},e.type))}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"4px",lineHeight:"1.4"},children:["\ud83d\udca1 B\u011b\u017en\xe9 p\u0159\xedpady = standardn\xed schvalov\xe1n\xed, zm\u011bna stavu apod.",(0,Ce.jsx)("br",{}),"Doporu\u010deno: ",(0,Ce.jsx)("strong",{children:"\ud83d\udfe0 oran\u017eov\xe1"})," varianta"]})]}),(0,Ce.jsxs)(yn,{children:[(0,Ce.jsxs)(jn,{children:["\ud83d\udd34 Barva emailu pro URGENTN\xcd p\u0159\xedpady",(0,Ce.jsx)("span",{style:{color:"#f59e0b",marginLeft:"4px"},children:"*"})]}),(0,Ce.jsx)("select",{value:qn||o,onChange:e=>Qn(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e6ed",borderRadius:"6px",fontSize:"0.9rem",background:"white",cursor:"pointer",fontWeight:"500"},children:n.map(e=>(0,Ce.jsxs)("option",{value:e.type,children:[e.icon," ",e.name]},e.type))}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"4px",lineHeight:"1.4"},children:["\ud83d\udca1 Urgentn\xed p\u0159\xedpady = kritick\xe9 schvalov\xe1n\xed, upozorn\u011bn\xed na probl\xe9m apod.",(0,Ce.jsx)("br",{}),"Doporu\u010deno: ",(0,Ce.jsx)("strong",{children:"\ud83d\udd34 \u010derven\xe1"})," varianta"]})]}),(0,Ce.jsxs)(yn,{children:[(0,Ce.jsxs)(jn,{children:["\ud83d\udfe2 Barva emailu pro INFORMA\u010cN\xcd zpr\xe1vy",(0,Ce.jsx)("span",{style:{color:"#f59e0b",marginLeft:"4px"},children:"*"})]}),(0,Ce.jsx)("select",{value:eo||o,onChange:e=>no(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e0e6ed",borderRadius:"6px",fontSize:"0.9rem",background:"white",cursor:"pointer",fontWeight:"500"},children:n.map(e=>(0,Ce.jsxs)("option",{value:e.type,children:[e.icon," ",e.name]},e.type))}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"4px",lineHeight:"1.4"},children:['\ud83d\udca1 Informa\u010dn\xed zpr\xe1vy = potvrzen\xed dokon\u010den\xed, FYI, "jen pro v\u011bdom\xed" apod.',(0,Ce.jsx)("br",{}),"Doporu\u010deno: ",(0,Ce.jsx)("strong",{children:"\ud83d\udfe2 zelen\xe1"})," varianta"]})]}),(0,Ce.jsxs)("div",{style:{padding:"12px",background:"#f0fdf4",border:"2px solid #10b981",borderRadius:"6px",fontSize:"0.8rem",color:"#065f46",marginTop:"8px"},children:[(0,Ce.jsx)("strong",{children:"\ud83d\udca1 Jak barvy email\u016f funguj\xed:"}),(0,Ce.jsxs)("ul",{style:{margin:"6px 0 0 0",paddingLeft:"18px",lineHeight:"1.6"},children:[(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"\u0160ablona = obsah emailu"})," (text, placeholdery, design)"]}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"Barva = priorita/n\xe1lada"})," emailu (\ud83d\udfe0 norm\xe1ln\xed, \ud83d\udd34 urgentn\xed, \ud83d\udfe2 info)"]}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"Backend automaticky vybere barvu"})," podle typu ud\xe1losti a p\u0159\xedjemce"]}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"P\u0159\xedjemce ur\u010d\xedte \u0161ipkou"})," - propojte \u0161ablonu s u\u017eivatelem/rol\xed/Generic Recipient"]})]})]}),(0,Ce.jsxs)(yn,{style:{marginTop:"16px"},children:[(0,Ce.jsx)(jn,{children:"Varianta pro n\xe1hled n\xed\u017ee"}),(0,Ce.jsx)("select",{value:oo||Xn||o,onChange:e=>to(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #cbd5e1",borderRadius:"6px",fontSize:"0.85rem",background:"#f8fafc",cursor:"pointer"},children:n.map(e=>(0,Ce.jsxs)("option",{value:e.type,children:[e.icon," ",e.name]},e.type))}),(0,Ce.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",marginTop:"4px",fontStyle:"italic"},children:"\u2699\ufe0f Toto ovl\xe1d\xe1 pouze n\xe1hled emailu n\xed\u017ee (nem\xe1 vliv na odes\xedl\xe1n\xed)"})]})]})})(),(0,Ce.jsxs)(yn,{style:{marginTop:"16px"},children:[(0,Ce.jsxs)(jn,{children:["Event Types (kdy se \u0161ablona pou\u017eije)",(0,Ce.jsx)("span",{style:{color:"#10b981",marginLeft:"4px",fontWeight:"normal"},children:"voliteln\xe9"})]}),(0,Ce.jsx)(Se.A,{multiple:!0,value:io,onChange:e=>ao(e),options:(X||[]).map(e=>({id:e.kod||e.code,value:e.kod||e.code,label:"".concat(e.nazev||e.name," (").concat(e.kod||e.code,")")})),placeholder:"Vyberte event types...",field:"templateEventTypes",selectStates:yo,setSelectStates:jo,searchStates:ko,setSearchStates:zo,touchedSelectFields:So,setTouchedSelectFields:wo,toggleSelect:uo,filterOptions:ho,getOptionLabel:go,hasTriedToSubmit:!1}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"6px",lineHeight:"1.5"},children:["\ud83d\udca1 ",(0,Ce.jsx)("strong",{children:"Event Types = kdy syst\xe9m po\u0161le tuto \u0161ablonu"}),(0,Ce.jsx)("br",{}),"Nap\u0159. vyberete ",(0,Ce.jsx)("strong",{children:"ORDER_SENT_FOR_APPROVAL"})," \u2192 kdy\u017e n\u011bkdo ode\u0161le objedn\xe1vku ke schv\xe1len\xed, syst\xe9m automaticky po\u0161le tento email p\u0159\xedjemc\u016fm (kte\u0159\xed jsou propojeni \u0161ipkou)",(0,Ce.jsx)("br",{}),"\u26a0\ufe0f Pokud nevyberete \u017e\xe1dn\xfd \u2192 \u0161ablona se nepou\u017eije automaticky"]})]}),(()=>{const e=Z.find(e=>e.id===y.data.templateId);if(!e)return null;const n={order_number:"O-2025-00142",order_id:"142",ev_cislo:"O-2025-00142",cislo_objednavky:"O-2025-00142",status:"Ke schv\xe1len\xed",old_status:"Nov\xe1",new_status:"Ke schv\xe1len\xed",datum_vytvoreni:"14.12.2025",datum_pozadavku:"14.12.2025",datum_zmeny:"14.12.2025 15:30",predmet:"N\xe1kup kancel\xe1\u0159sk\xe9ho vybaven\xed pro odd\u011blen\xed IT",order_subject:"N\xe1kup kancel\xe1\u0159sk\xe9ho vybaven\xed pro odd\u011blen\xed IT",subject:"N\xe1kup kancel\xe1\u0159sk\xe9ho vybaven\xed pro odd\u011blen\xed IT",cena_celkem:"45 670 K\u010d",cena_bez_dph:"37 743 K\u010d",cena_s_dph:"45 670 K\u010d",max_price_with_dph:"50 000 K\u010d",dodavatel:"ALZA.cz s.r.o.",supplier_name:"ALZA.cz s.r.o.",supplier:"ALZA.cz s.r.o.",pozadovatel_jmeno:"Jan Nov\xe1k",pozadovatel_email:"jan.novak@example.com",pozadovatel:"Jan Nov\xe1k",requester_name:"Jan Nov\xe1k",requester_email:"jan.novak@example.com",schvalovatel_jmeno:"Ing. Petr Svoboda",schvalovatel_email:"petr.svoboda@example.com",approver_name:"Ing. Petr Svoboda",approver_email:"petr.svoboda@example.com",action_user_name:"Jan Nov\xe1k",action_performed_by:"Jan Nov\xe1k",action_date:"14.12.2025 15:30",url_objednavky:"https://eeo.example.com/order-form-25?edit=142",order_url:"https://eeo.example.com/order-form-25?edit=142",url:"https://eeo.example.com/order-form-25?edit=142",poznamka:"Nutn\xe9 schv\xe1lit do konce t\xfddne kv\u016fli slevov\xe9 akci",reason:"Zm\u011bna schvalov\xe1n\xed dle intern\xedch sm\u011brnic",comment:"\u017d\xe1dn\xe9 dal\u0161\xed pozn\xe1mky",user_name:"Jan Nov\xe1k",user_email:"jan.novak@example.com",recipient_name:"Ing. Petr Svoboda",date:"14.12.2025",time:"15:30",datetime:"14.12.2025 15:30"},o=e=>{if(!e)return e;let o=e;return Object.keys(n).forEach(e=>{const t=new RegExp("\\{".concat(e,"\\}"),"g"),i=new RegExp("\\{\\{".concat(e,"\\}\\}"),"g");o=o.replace(t,n[e]),o=o.replace(i,n[e])}),o};return(0,Ce.jsxs)(Ce.Fragment,{children:[(e.app_nadpis||e.app_title||e.app_zprava||e.app_message)&&(0,Ce.jsxs)("div",{style:{marginTop:"16px"},children:[(0,Ce.jsxs)(jn,{style:{marginBottom:"8px",display:"block"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.z$e,style:{marginRight:"6px",color:"#f5576c"}}),"N\xe1hled In-App notifikace (zvon\u011b\u010dek)"]}),(0,Ce.jsxs)("div",{style:{padding:"16px",borderLeft:"4px solid #3b82f6",cursor:"pointer",display:"flex",gap:"12px",alignItems:"start",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:"8px",border:"1px solid #93c5fd"},children:[(0,Ce.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",flexShrink:0,background:"linear-gradient(135deg, #3b82f6, #2563eb)",color:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:"\u2139\ufe0f"}),(0,Ce.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,Ce.jsx)("div",{style:{fontWeight:700,color:"#111827",fontSize:"14px",lineHeight:1.4,marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:o(e.app_nadpis||e.app_title)||"Schv\xe1lena: O-1958/75030926/2025/IT"}),(e.app_zprava||e.app_message)&&(0,Ce.jsx)("div",{style:{fontSize:"13px",color:"#6b7280",lineHeight:1.5,marginBottom:"6px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:o(e.app_zprava||e.app_message)}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",fontSize:"12px",color:"#9ca3af",marginTop:"6px"},children:[(0,Ce.jsx)("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:"\ud83d\udd50 P\u0159ed 1 h"}),(0,Ce.jsxs)("span",{style:{background:"#f3e8ff",color:"#6b21a8",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:500},children:["\ud83d\udc64 ",n.action_performed_by||"Jan Nov\xe1k"]})]})]})]}),(0,Ce.jsx)("div",{style:{marginTop:"6px",fontSize:"0.7rem",color:"#64748b",fontStyle:"italic"},children:"\ud83d\udca1 P\u0159esn\u011b toto uvid\xed u\u017eivatel ve zvone\u010dku \u2022 Mock data pro uk\xe1zku"})]}),(0,Ce.jsxs)("div",{style:{marginTop:"16px"},children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,Ce.jsxs)(jn,{style:{marginBottom:"0",display:"flex",alignItems:"center",gap:"8px"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.y_8,style:{marginRight:"6px",color:"#667eea"}}),"N\xe1hled Email \u0161ablony",(()=>{const e=oo||Xn||"APPROVER_NORMAL";return(0,Ce.jsxs)("span",{style:{padding:"4px 10px",background:"#f3f4f6",borderRadius:"6px",fontSize:"0.75rem",fontWeight:"600",color:"#374151"},children:[{APPROVER_NORMAL:"\ud83d\udfe0",APPROVER_URGENT:"\ud83d\udd34",SUBMITTER:"\ud83d\udfe2",DEFAULT:"\ud83d\udccb"}[e]||"\ud83d\udccb"," ","APPROVER_NORMAL"===e?"Norm\xe1ln\xed":"APPROVER_URGENT"===e?"Mimo\u0159\xe1dn\xfd":"SUBMITTER"===e?"Autor":"V\xfdchoz\xed"]})})()]}),(0,Ce.jsx)("button",{onClick:()=>{et({template:e,mockData:n,replacePlaceholders:o,selectedVariantType:oo||Xn||"APPROVER_NORMAL"}),qo(!0)},style:{padding:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"36px",transition:"all 0.2s",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px) scale(1.05)",e.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.5)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) scale(1)",e.currentTarget.style.boxShadow="0 2px 8px rgba(102, 126, 234, 0.3)"},title:"Otev\u0159\xedt fullscreen n\xe1hled",children:(0,Ce.jsx)(ze.g,{icon:Ee.oZK})})]}),(0,Ce.jsxs)("div",{style:{border:"2px solid #667eea",borderRadius:"12px",overflow:"hidden",background:"white",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.15)"},children:[(0,Ce.jsxs)("div",{style:{padding:"8px 12px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:"0.75rem"},children:[(0,Ce.jsx)("div",{style:{marginBottom:"4px",display:"flex",alignItems:"center",gap:"6px"},children:(0,Ce.jsx)("strong",{style:{fontSize:"0.8rem"},children:"\ud83d\udce7 Email Preview"})}),(0,Ce.jsxs)("div",{style:{marginBottom:"3px",opacity:.95,fontSize:"0.7rem"},children:[(0,Ce.jsx)("strong",{children:"P\u0159edm\u011bt:"})," ",o(e.email_predmet||e.email_subject||"Bez p\u0159edm\u011btu")]}),(0,Ce.jsxs)("div",{style:{marginBottom:"3px",opacity:.95,fontSize:"0.7rem"},children:[(0,Ce.jsx)("strong",{children:"Odes\xedlatel:"})," EEO Syst\xe9m <noreply@eeo.cz>"]}),(0,Ce.jsxs)("div",{style:{opacity:.95,fontSize:"0.7rem"},children:[(0,Ce.jsx)("strong",{children:"P\u0159\xedjemce:"})," ",n.recipient_name||n.user_name," <",n.user_email,">"]})]}),(0,Ce.jsx)("div",{style:{padding:"8px",fontSize:"0.5rem",lineHeight:"1.3",color:"#1f2937",maxHeight:"400px",minHeight:"150px",overflowY:"auto",overflowX:"hidden",background:"#ffffff",zoom:"0.6",transformOrigin:"top left"},className:"email-preview-body",children:(0,Ce.jsx)("div",{dangerouslySetInnerHTML:{__html:o((()=>{const n=oo||Xn||"APPROVER_NORMAL",o=e.email_telo||e.email_body||'<p style="color: #9ca3af; font-style: italic;">Email t\u011blo nen\xed definov\xe1no v \u0161ablon\u011b</p>';if(!o.includes("\x3c!-- RECIPIENT:"))return o;const t="\x3c!-- RECIPIENT: ".concat(n," --\x3e"),i=o.indexOf(t);if(-1===i)return o;let a=i+t.length;const r=["APPROVER_NORMAL","APPROVER_URGENT","SUBMITTER"].filter(e=>e!==n).map(e=>"\x3c!-- RECIPIENT: ".concat(e," --\x3e"));let l=o.length;for(const e of r){const n=o.indexOf(e,a);-1!==n&&n<l&&(l=n)}return o.substring(a,l).trim()})()).replace(/\n/g,"<br />")}})}),(0,Ce.jsxs)("div",{style:{padding:"12px 20px",background:"#f9fafb",borderTop:"1px solid #e5e7eb",fontSize:"0.75rem",color:"#6b7280",textAlign:"center"},children:["\ud83d\udcc5 ",n.datetime," \u2022 \ud83d\udd14 Automatick\xe1 notifikace z EEO syst\xe9mu"]})]}),(0,Ce.jsxs)("div",{style:{marginTop:"8px",padding:"8px 12px",background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:"6px",fontSize:"0.75rem",color:"#1e40af",display:"flex",alignItems:"center",gap:"6px"},children:[(0,Ce.jsx)("span",{children:"\ud83d\udca1"}),(0,Ce.jsx)("span",{children:"Pln\u011b scrollovateln\xfd n\xe1hled HTML \u0161ablony s nahrazen\xfdmi placeholdery mock daty"})]})]})]})})(),(0,Ce.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"#fef3c7",border:"2px solid #f59e0b",borderRadius:"8px",fontSize:"0.85rem",color:"#92400e"},children:[(0,Ce.jsx)("strong",{children:"\ud83d\udce7 Co tato \u0161ablona definuje:"}),(0,Ce.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",lineHeight:"1.6"},children:[(0,Ce.jsxs)("li",{children:["Kter\xe9mu ",(0,Ce.jsx)("strong",{children:"u\u017eivateli"})," se notifikace po\u0161le"]}),(0,Ce.jsxs)("li",{children:["Zda m\xe1 u\u017eivatel ",(0,Ce.jsx)("strong",{children:"notifikace zapnut\xe9"})]}),(0,Ce.jsxs)("li",{children:["Zda m\xe1 u\u017eivatel ",(0,Ce.jsx)("strong",{children:"roli/pr\xe1va"})," pro p\u0159\xedjem notifikace"]}),(0,Ce.jsx)("li",{children:"Scope viditelnosti m\u016f\u017ee ur\u010dovat, zda notifikaci dostane"})]})]}),(()=>{const e=N.filter(e=>e.source===y.id).map(e=>{var n,o,t;const i=C.find(n=>n.id===e.target);return{id:null===i||void 0===i?void 0:i.id,name:(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.label)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.name)||"Nezn\xe1m\xfd",type:(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.type)||"user",edgeId:e.id}});return(0,Ce.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"8px"},children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:"600",color:"#1e40af",fontSize:"0.9rem"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.z$e}),"Notifikace je p\u0159i\u0159azena na:"]}),e.length>0?(0,Ce.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:e.map((e,n)=>{let o="\ud83d\udc64",t="#dbeafe",i="#1e40af";return"location"===e.type?(o="\ud83d\udccd",t="#d1fae5",i="#065f46"):"department"===e.type&&(o="\ud83c\udfe2",t="#dbeafe",i="#1e40af"),(0,Ce.jsxs)("div",{style:{padding:"8px 12px",background:t,borderRadius:"6px",fontSize:"0.85rem",color:i,fontWeight:"500",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"8px"},onClick:()=>{const n=C.find(n=>n.id===e.id);n&&(j(n),z(null))},onMouseEnter:e=>e.currentTarget.style.opacity="0.7",onMouseLeave:e=>e.currentTarget.style.opacity="1",title:"Klikn\u011bte pro zobrazen\xed detailu",children:[(0,Ce.jsx)("span",{style:{fontSize:"1.1rem"},children:o}),(0,Ce.jsx)("span",{children:e.name}),"location"===e.type&&(0,Ce.jsx)("span",{style:{fontSize:"0.75rem",opacity:.7},children:"(lokalita)"}),"department"===e.type&&(0,Ce.jsx)("span",{style:{fontSize:"0.75rem",opacity:.7},children:"(\xfasek)"}),"user"===e.type&&(0,Ce.jsx)("span",{style:{fontSize:"0.75rem",opacity:.7},children:"(u\u017eivatel)"})]},n)})}):(0,Ce.jsx)("div",{style:{fontSize:"0.8rem",color:"#64748b",fontStyle:"italic"},children:"\u0160ablona zat\xedm nen\xed p\u0159i\u0159azena k \u017e\xe1dn\xe9mu u\u017eivateli, lokalit\u011b ani \xfaseku"})]})})(),(()=>{const e=N.filter(e=>e.source===y.id);return 0===e.length?(0,Ce.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#fef3c7",border:"2px solid #fbbf24",borderRadius:"8px",fontSize:"0.85rem",color:"#92400e"},children:["\u26a0\ufe0f ",(0,Ce.jsx)("strong",{children:"\u0160ablona nen\xed propojena s \u017e\xe1dn\xfdm p\u0159\xedjemcem!"}),(0,Ce.jsx)("div",{style:{fontSize:"0.8rem",marginTop:"6px"},children:"P\u0159et\xe1hn\u011bte \u0161ipku z t\xe9to \u0161ablony na u\u017eivatele, roli nebo dynamick\xe9ho p\u0159\xedjemce."})]}):(0,Ce.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#f0fdf4",border:"2px solid #10b981",borderRadius:"8px"},children:[(0,Ce.jsxs)("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"#065f46",marginBottom:"10px"},children:["\ud83d\udce4 Odchoz\xed notifikace (",e.length,"):"]}),e.map((n,o)=>{var t,i,a,r,l,d,s;const c=C.find(e=>e.id===n.target),p="genericRecipient"===(null===c||void 0===c||null===(t=c.data)||void 0===t?void 0:t.type)?c.data.genericType:(null===c||void 0===c||null===(i=c.data)||void 0===i||null===(a=i.type)||void 0===a?void 0:a.toUpperCase())||"UNKNOWN",x=(null===(r=n.data)||void 0===r?void 0:r.scope_filter)||"NONE",u=(null===(l=n.data)||void 0===l?void 0:l.recipientRole)||"INFO",h=(null===(d=n.data)||void 0===d?void 0:d.eventTypes)||[],g={TRIGGER_USER:{bg:"#d1fae5",border:"#10b981",text:"#065f46",icon:"\ud83c\udfaf"},ENTITY_AUTHOR:{bg:"#dbeafe",border:"#3b82f6",text:"#1e40af",icon:"\u270d\ufe0f"},ENTITY_OWNER:{bg:"#fef3c7",border:"#f59e0b",text:"#92400e",icon:"\ud83d\udc64"},USER:{bg:"#f3e8ff",border:"#a855f7",text:"#6b21a8",icon:"\ud83d\udc64"},ROLE:{bg:"#e0e7ff",border:"#6366f1",text:"#3730a3",icon:"\ud83c\udfad"}}[p]||{bg:"#f3f4f6",border:"#9ca3af",text:"#374151",icon:"\u2753"};return(0,Ce.jsxs)("div",{style:{padding:"10px",background:g.bg,border:"2px solid ".concat(g.border),borderRadius:"6px",marginBottom:o<e.length-1?"8px":"0",fontSize:"0.85rem"},children:[(0,Ce.jsxs)("div",{style:{fontWeight:"700",color:g.text,marginBottom:"6px"},children:[g.icon," ",(null===c||void 0===c||null===(s=c.data)||void 0===s?void 0:s.name)||"Unknown",(0,Ce.jsxs)("span",{style:{fontWeight:"600",opacity:.8,marginLeft:"6px"},children:["(",p,")"]})]}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:g.text,lineHeight:"1.5"},children:[(0,Ce.jsx)("strong",{children:"\ud83c\udfaf Typ notifikace:"})," ",u,(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"\ud83d\udccd Scope Filter:"})," ",x,"ENTITY_PARTICIPANTS"===x&&(0,Ce.jsx)("span",{style:{color:"#10b981"},children:" \u2b50"}),h.length>0&&(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"\u26a1 Event Types:"})," ",h.slice(0,2).join(", "),h.length>2&&" +".concat(h.length-2," dal\u0161\xedch")]})]})]},n.id)}),(0,Ce.jsxs)("div",{style:{fontSize:"0.7rem",color:"#047857",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid #d1fae5"},children:["\ud83d\udca1 Klikn\u011bte na ",(0,Ce.jsx)("strong",{children:"\u0161ipku (hranu)"})," pro \xfapravu Scope Filter a typu notifikace"]})]})})()]}),y&&"location"===y.data.type&&(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"N\xe1zev lokality"}),(0,Ce.jsx)(kn,{value:y.data.label||y.data.name,readOnly:!0})]}),(0,Ce.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"#f0fdf4",border:"2px solid #10b981",borderRadius:"8px",fontSize:"0.85rem",color:"#065f46"},children:[(0,Ce.jsx)("strong",{children:"\ud83d\udccd Co lokalita definuje:"}),(0,Ce.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",lineHeight:"1.6"},children:[(0,Ce.jsxs)("li",{children:["Roz\u0161\xed\u0159en\xed ",(0,Ce.jsx)("strong",{children:"viditelnosti"})," v r\xe1mci lokality"]}),(0,Ce.jsxs)("li",{children:["Ur\u010duje ",(0,Ce.jsx)("strong",{children:"scope"})," pro data (objedn\xe1vky, faktury, pokladna)"]}),(0,Ce.jsxs)("li",{children:["M\u016f\u017ee m\xedt dodate\u010dn\xe1 ",(0,Ce.jsx)("strong",{children:"pr\xe1va"})," v\xe1zan\xe1 na lokalitu"]})]})]})]}),y&&"department"===y.data.type&&(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"N\xe1zev \xfaseku"}),(0,Ce.jsx)(kn,{value:y.data.label||y.data.name,readOnly:!0})]}),(0,Ce.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"#eff6ff",border:"2px solid #3b82f6",borderRadius:"8px",fontSize:"0.85rem",color:"#1e40af"},children:[(0,Ce.jsx)("strong",{children:"\ud83c\udfe2 Co \xfasek definuje:"}),(0,Ce.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",lineHeight:"1.6"},children:[(0,Ce.jsxs)("li",{children:["Roz\u0161\xed\u0159en\xed ",(0,Ce.jsx)("strong",{children:"viditelnosti"})," v r\xe1mci \xfaseku"]}),(0,Ce.jsxs)("li",{children:["Ur\u010duje ",(0,Ce.jsx)("strong",{children:"scope"})," pro data (objedn\xe1vky, faktury, pokladna)"]}),(0,Ce.jsxs)("li",{children:["M\u016f\u017ee m\xedt dodate\u010dn\xe1 ",(0,Ce.jsx)("strong",{children:"pr\xe1va"})," v\xe1zan\xe1 na \xfasek"]})]})]})]}),y&&"role"===y.data.type&&(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"N\xe1zev role"}),(0,Ce.jsx)(kn,{value:y.data.label||y.data.name,readOnly:!0})]}),(null===(e=y.data.metadata)||void 0===e?void 0:e.popis)&&(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"Popis"}),(0,Ce.jsx)(kn,{value:y.data.metadata.popis,readOnly:!0})]}),(0,Ce.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"#f5f3ff",border:"2px solid #8b5cf6",borderRadius:"8px",fontSize:"0.85rem",color:"#6b21a8"},children:[(0,Ce.jsx)("strong",{children:"\ud83d\udee1\ufe0f Co role definuje:"}),(0,Ce.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",lineHeight:"1.6"},children:[(0,Ce.jsxs)("li",{children:["Sadu ",(0,Ce.jsx)("strong",{children:"opr\xe1vn\u011bn\xed"})," pro moduly (objedn\xe1vky, faktury, pokladna)"]}),(0,Ce.jsxs)("li",{children:["P\u0159i\u0159azen\xed ",(0,Ce.jsx)("strong",{children:"u\u017eivatel\u016fm"})," pro d\u011bd\u011bn\xed pr\xe1v"]}),(0,Ce.jsxs)("li",{children:["Mo\u017enost p\u0159ij\xedmat ",(0,Ce.jsx)("strong",{children:"notifikace"})," pro celou roli"]})]})]}),(()=>{const e=N.filter(e=>e.target===y.id).map(e=>{var n,o,t;const i=C.find(n=>n.id===e.source);return{id:null===i||void 0===i?void 0:i.id,name:(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.label)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.name)||"Nezn\xe1m\xfd",position:(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.position)||"",edgeId:e.id}});return(0,Ce.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#eff6ff",border:"2px solid #3b82f6",borderRadius:"8px"},children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:"600",color:"#1e40af",fontSize:"0.9rem"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.gdJ}),"U\u017eivatel\xe9 s touto rol\xed (",e.length,")"]}),e.length>0?(0,Ce.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:e.map((e,n)=>(0,Ce.jsxs)("div",{style:{padding:"8px 12px",background:"#dbeafe",borderRadius:"6px",fontSize:"0.85rem",color:"#1e40af",fontWeight:"500",cursor:"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",gap:"2px"},onClick:()=>{const n=C.find(n=>n.id===e.id);n&&(j(n),z(null))},onMouseEnter:e=>e.currentTarget.style.opacity="0.7",onMouseLeave:e=>e.currentTarget.style.opacity="1",title:"Klikn\u011bte pro zobrazen\xed detailu u\u017eivatele",children:[(0,Ce.jsxs)("span",{style:{fontSize:"1rem"},children:["\ud83d\udc64 ",e.name]}),e.position&&(0,Ce.jsx)("span",{style:{fontSize:"0.75rem",opacity:.7},children:e.position})]},n))}):(0,Ce.jsx)("div",{style:{fontSize:"0.8rem",color:"#64748b",fontStyle:"italic"},children:"Role zat\xedm nen\xed p\u0159i\u0159azena \u017e\xe1dn\xe9mu u\u017eivateli"})]})})(),(0,Ce.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#fef3c7",border:"2px solid #f59e0b",borderRadius:"8px"},children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:"600",color:"#92400e",fontSize:"0.9rem"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.CN3}),"Opr\xe1vn\u011bn\xed modul\u016f"]}),(0,Ce.jsx)("div",{style:{fontSize:"0.8rem",color:"#92400e",marginBottom:"10px"},children:"Tato role m\xe1 p\u0159\xedstup k n\xe1sleduj\xedc\xedm modul\u016fm:"}),(0,Ce.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:(()=>{const e=M.find(e=>e.id===y.data.roleId),n=(null===e||void 0===e?void 0:e.modules)||{orders:!1,invoices:!1,cashbook:!1};return["orders","invoices","cashbook"].map(e=>{const o=!0===n[e]||1===n[e];return(0,Ce.jsxs)("div",{style:{padding:"8px 12px",background:o?"#d1fae5":"#fee2e2",borderRadius:"6px",fontSize:"0.85rem",color:o?"#065f46":"#991b1b",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px"},children:[(0,Ce.jsx)("span",{style:{fontSize:"1.2rem"},children:o?"\u2705":"\u274c"}),(0,Ce.jsx)("span",{children:{orders:"\ud83d\udce6 Objedn\xe1vky",invoices:"\ud83d\udcc4 Faktury",cashbook:"\ud83d\udcb0 Pokladna"}[e]})]},e)})})()})]})]}),y&&(!y.data.type||"user"===y.data.type)&&(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"U\u017eivatel"}),(0,Ce.jsx)(kn,{value:y.data.name,readOnly:!0})]}),(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"Pozice"}),(0,Ce.jsx)(kn,{value:y.data.position,readOnly:!0})]}),(0,Ce.jsxs)(yn,{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e0e6ed"},children:[(0,Ce.jsx)(jn,{style:{color:"#10b981"},children:"\ud83d\udccd V\xfdchoz\xed lokalita (z DB)"}),(0,Ce.jsx)(kn,{value:(null===(n=y.data.metadata)||void 0===n?void 0:n.location)||"Neuvedeno",readOnly:!0,style:{background:"#f0fdf4",fontWeight:"500",border:"1px solid #86efac"}})]}),(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{style:{color:"#10b981"},children:"\ud83c\udfe2 V\xfdchoz\xed \xfasek (z DB)"}),(0,Ce.jsx)(kn,{value:(null===(t=y.data.metadata)||void 0===t?void 0:t.department)||"Neuvedeno",readOnly:!0,style:{background:"#f0fdf4",fontWeight:"500",border:"1px solid #86efac"}})]})]}),y&&(!y.data.type||"user"===y.data.type)&&(0,Ce.jsxs)("div",{style:{marginTop:"24px",padding:"12px",background:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"8px"},children:[(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:"600",color:"#1e40af",fontSize:"0.9rem"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.FFg}),"Aktu\xe1ln\xed vztahy v diagramu"]}),(()=>{const e=N.filter(e=>e.target===y.id).map(e=>{var n,o;const t=C.find(n=>n.id===e.source);return{name:(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.name)||"Nezn\xe1m\xfd",edgeId:e.id,type:(null===(o=e.data)||void 0===o?void 0:o.relationshipType)||"prime"}}),n=N.filter(e=>e.source===y.id).map(e=>{var n,o;const t=C.find(n=>n.id===e.target);return{name:(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.name)||"Nezn\xe1m\xfd",edgeId:e.id,type:(null===(o=e.data)||void 0===o?void 0:o.relationshipType)||"prime"}});return(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,Ce.jsxs)("strong",{style:{fontSize:"0.8rem",color:"#475569",display:"block",marginBottom:"6px"},children:["\u2b06\ufe0f Nad\u0159\xedzen\xed (",e.length,")"]}),e.length>0?(0,Ce.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:e.map((e,n)=>(0,Ce.jsxs)("div",{style:{padding:"6px 10px",background:"#dbeafe",borderRadius:"4px",fontSize:"0.8rem",color:"#1e40af",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},onClick:()=>{const n=N.find(n=>n.id===e.edgeId);n&&(z(n),j(null))},onMouseEnter:e=>e.currentTarget.style.background="#bfdbfe",onMouseLeave:e=>e.currentTarget.style.background="#dbeafe",title:"Klikn\u011bte pro zobrazen\xed detailu vztahu",children:[e.name,"zastupovani"===e.type&&" (zastupov\xe1n\xed)"]},n))}):(0,Ce.jsx)("div",{style:{fontSize:"0.75rem",color:"#94a3b8",fontStyle:"italic"},children:"Nem\xe1 nad\u0159\xedzen\xe9ho v diagramu"})]}),(0,Ce.jsxs)("div",{children:[(0,Ce.jsxs)("strong",{style:{fontSize:"0.8rem",color:"#475569",display:"block",marginBottom:"6px"},children:["\u2b07\ufe0f Pod\u0159\xedzen\xed (",n.length,")"]}),n.length>0?(0,Ce.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:n.map((e,n)=>(0,Ce.jsxs)("div",{style:{padding:"6px 10px",background:"#dbeafe",borderRadius:"4px",fontSize:"0.8rem",color:"#1e40af",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},onClick:()=>{const n=N.find(n=>n.id===e.edgeId);n&&(z(n),j(null))},onMouseEnter:e=>e.currentTarget.style.background="#bfdbfe",onMouseLeave:e=>e.currentTarget.style.background="#dbeafe",title:"Klikn\u011bte pro zobrazen\xed detailu vztahu",children:[e.name,"zastupovani"===e.type&&" (zastupov\xe1n\xed)"]},n))}):(0,Ce.jsx)("div",{style:{fontSize:"0.75rem",color:"#94a3b8",fontStyle:"italic"},children:"Nem\xe1 pod\u0159\xedzen\xe9 v diagramu"})]})]})})()]}),k&&((e,n,o,t)=>{const i=C.find(e=>e.id===k.source),a=C.find(e=>e.id===k.target);return(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsx)("div",{style:{marginBottom:"16px",padding:"10px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"8px",color:"white",fontSize:"0.9rem",fontWeight:"600",textAlign:"center",boxShadow:"0 2px 8px rgba(102,126,234,0.3)"},children:((e,n,o,t,r,l)=>{const d=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.type)||"user",s=(null===a||void 0===a||null===(t=a.data)||void 0===t||null===(r=t.metadata)||void 0===r?void 0:r.type)||(null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.type)||"user",c=ut(d,s);return"".concat(c.icon," ").concat(c.label)})()}),(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:((e,n,o,t,r,l)=>{const d=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.type)||"user",s=(null===a||void 0===a||null===(t=a.data)||void 0===t||null===(r=t.metadata)||void 0===r?void 0:r.type)||(null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.type)||"user";return ut(d,s).sourceLabel})()}),(0,Ce.jsx)(kn,{value:(null===i||void 0===i||null===(e=i.data)||void 0===e?void 0:e.label)||(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.name)||"Nezn\xe1m\xfd",readOnly:!0,style:{fontWeight:"600",color:"#059669"}})]}),(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:((e,n,o,t,r,l)=>{const d=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.type)||"user",s=(null===a||void 0===a||null===(t=a.data)||void 0===t||null===(r=t.metadata)||void 0===r?void 0:r.type)||(null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.type)||"user";return ut(d,s).targetLabel})()}),(0,Ce.jsx)(kn,{value:(null===a||void 0===a||null===(o=a.data)||void 0===o?void 0:o.label)||(null===a||void 0===a||null===(t=a.data)||void 0===t?void 0:t.name)||"Nezn\xe1m\xfd",readOnly:!0,style:{fontWeight:"600",color:"#3b82f6"}})]}),(0,Ce.jsx)("div",{style:{marginTop:"16px",marginBottom:"16px",padding:"12px",background:"#f0fdf4",border:"2px solid #86efac",borderRadius:"8px",fontSize:"0.85rem",color:"#15803d"},children:(0,Ce.jsx)("div",{style:{marginTop:"8px",fontSize:"0.8rem",lineHeight:"1.6"},children:((e,n,o,t,r,l,d,s,c,p)=>{const x=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.type)||"user",u=(null===a||void 0===a||null===(t=a.data)||void 0===t||null===(r=t.metadata)||void 0===r?void 0:r.type)||(null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.type)||"user",h=(null===i||void 0===i||null===(d=i.data)||void 0===d||null===(s=d.name)||void 0===s?void 0:s.split(" ")[0])||"Zdroj",g=(null===a||void 0===a||null===(c=a.data)||void 0===c||null===(p=c.name)||void 0===p?void 0:p.split(" ")[0])||"C\xedl";return"template"===x?"user"===u?(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsx)("strong",{children:g})," bude dost\xe1vat notifikace podle \u0161ablony ",(0,Ce.jsx)("strong",{children:h}),".",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"Typ notifikace"})," ur\u010duje prioritu (d\u016fle\u017eit\xe1/schvalovac\xed/informa\u010dn\xed).",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"Event Types"})," ur\u010duj\xed, kdy se notifikace ode\u0161le."]}):(0,Ce.jsxs)(Ce.Fragment,{children:["V\u0161ichni u\u017eivatel\xe9 v ",(0,Ce.jsx)("strong",{children:g})," dostanou notifikace podle \u0161ablony ",(0,Ce.jsx)("strong",{children:h}),".",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"Event Types"})," ur\u010duj\xed, kdy se notifikace ode\u0161le."]}):(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsx)("strong",{children:h})," z\xedsk\xe1 pr\xe1va vid\u011bt data od ",(0,Ce.jsx)("strong",{children:g}),".",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"Rozsah"})," a ",(0,Ce.jsx)("strong",{children:"Moduly"})," ur\u010duj\xed, co p\u0159esn\u011b uvid\xed (objedn\xe1vky/faktury/pokladnu).",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"Roz\u0161\xed\u0159en\xe9 lokality/\xfaseky"})," p\u0159id\xe1vaj\xed dal\u0161\xed data mimo z\xe1kladn\xed vztah."]})})()})}),((e,n,o,t,r,l)=>{const d=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.type)||"user",s=(null===a||void 0===a||null===(t=a.data)||void 0===t||null===(r=t.metadata)||void 0===r?void 0:r.type)||(null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.type)||"user";return"user"===d&&"user"===s?(0,Ce.jsxs)(yn,{children:[(0,Ce.jsx)(jn,{children:"Typ vztahu"}),(0,Ce.jsxs)(Tn,{value:fe,onChange:e=>_e(e.target.value),children:[(0,Ce.jsx)("option",{value:"prime",children:"P\u0159\xedm\xfd nad\u0159\xedzen\xfd"}),(0,Ce.jsx)("option",{value:"zastupovani",children:"Zastupov\xe1n\xed"}),(0,Ce.jsx)("option",{value:"delegovani",disabled:!0,style:{color:"#9ca3af"},children:"Delegov\xe1n\xed (TODO)"}),(0,Ce.jsx)("option",{value:"rozsirene",disabled:!0,style:{color:"#9ca3af"},children:"Roz\u0161\xed\u0159en\xe9 opr\xe1vn\u011bn\xed (TODO)"})]})]}):null})()]})})(),k&&((e,n,o,t,i,a,r,l)=>{const d=C.find(e=>e.id===k.source),s=C.find(e=>e.id===k.target),c=(null===d||void 0===d||null===(e=d.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===d||void 0===d||null===(o=d.data)||void 0===o?void 0:o.type)||"user",p=(null===s||void 0===s||null===(t=s.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===s||void 0===s||null===(a=s.data)||void 0===a?void 0:a.type)||"user";return ut(c,p).showScope?(0,Ce.jsxs)(yn,{children:[(0,Ce.jsxs)(jn,{children:["Rozsah viditelnosti (Scope)",(0,Ce.jsxs)("span",{style:{fontSize:"0.75rem",color:"#059669",fontWeight:"600",marginLeft:"8px"},children:["\u2192 co uvid\xed ",(null===d||void 0===d||null===(r=d.data)||void 0===r||null===(l=r.name)||void 0===l?void 0:l.split(" ")[0])||"nadr\u030c\xedzen\xfd","?"]})]}),(0,Ce.jsxs)(Tn,{value:Zn,onChange:e=>Gn(e.target.value),children:[(0,Ce.jsx)("option",{value:"OWN",children:"\ud83d\udd12 OWN - Jen sv\xe9 vlastn\xed z\xe1znamy"}),(0,Ce.jsx)("option",{value:"TEAM",children:"\ud83d\udc65 TEAM - Z\xe1znamy sv\xe9ho \xfaseku"}),(0,Ce.jsx)("option",{value:"LOCATION",children:"\ud83d\udccd LOCATION - V\u0161e v r\xe1mci lokality"}),(0,Ce.jsx)("option",{value:"ALL",children:"\ud83c\udf10 ALL - V\u0161e (admin p\u0159\xedstup)"})]}),(0,Ce.jsxs)("div",{style:{marginTop:"8px",padding:"8px",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"4px",fontSize:"0.75rem",color:"#475569"},children:[(0,Ce.jsx)("strong",{children:"Vysv\u011btlen\xed:"}),(0,Ce.jsxs)("ul",{style:{margin:"6px 0 0 16px",padding:0},children:[(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"OWN:"})," Vid\xed jen sv\xe9 z\xe1znamy (vlastn\xed objedn\xe1vky/faktury)"]}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"TEAM:"})," Vid\xed z\xe1znamy cel\xe9ho \xfaseku"]}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"LOCATION:"})," Vid\xed v\u0161e v r\xe1mci lokality (nap\u0159. v\u0161echny \xfaseky v Beroun\u011b)"]}),(0,Ce.jsxs)("li",{children:[(0,Ce.jsx)("strong",{children:"ALL:"})," Vid\xed v\u0161echny z\xe1znamy v syst\xe9mu (nad\u0159azen\xfd p\u0159\xedstup)"]})]})]})]}):null})(),k&&((e,n,o,t,i,a)=>{const r=C.find(e=>e.id===k.source),l=C.find(e=>e.id===k.target),d=(null===r||void 0===r||null===(e=r.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===r||void 0===r||null===(o=r.data)||void 0===o?void 0:o.type)||"user",s=(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===l||void 0===l||null===(a=l.data)||void 0===a?void 0:a.type)||"user";var c;return"user"!==d||"department"!==s&&"location"!==s?null:(0,Ce.jsx)(yn,{style:{marginTop:"16px"},children:(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",padding:"12px",background:"#f0fdf4",border:"2px solid #86efac",borderRadius:"8px"},children:[(0,Ce.jsx)("input",{type:"checkbox",id:"applyToOrdersOnly",checked:(null===(c=k.data)||void 0===c?void 0:c.applyToOrdersOnly)||!1,onChange:e=>{L(N.map(n=>n.id===k.id?(0,ge.A)((0,ge.A)({},n),{},{data:(0,ge.A)((0,ge.A)({},n.data),{},{applyToOrdersOnly:e.target.checked})}):n))},style:{width:"18px",height:"18px",cursor:"pointer",marginTop:"2px"}}),(0,Ce.jsxs)("label",{htmlFor:"applyToOrdersOnly",style:{cursor:"pointer",flex:1},children:[(0,Ce.jsxs)("div",{style:{fontSize:"0.85rem",fontWeight:"600",color:"#15803d",marginBottom:"4px"},children:["\ud83c\udfaf Plat\xed jen pro objedn\xe1vky z tohoto ","department"===s?"\xfaseku":"lokality"]}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#166534",lineHeight:"1.5"},children:[(0,Ce.jsx)("strong",{children:"\u2705 Zapnuto:"})," U\u017eivatel uvid\xed/uprav\xed jen objedn\xe1vky vytvo\u0159en\xe9 v tomto ","department"===s?"\xfaseku":"lokalit\u011b",".",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"\u274c Vypnuto:"})," Viditelnost se \u0159\xedd\xed podle nastaven\xe9ho Scope (OWN/TEAM/LOCATION/ALL)."]})]})]})})})()]}),k&&((e,n,o,t,i,a)=>{const r=C.find(e=>e.id===k.source),l=C.find(e=>e.id===k.target),d=(null===r||void 0===r||null===(e=r.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===r||void 0===r||null===(o=r.data)||void 0===o?void 0:o.type)||"user",s=(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===l||void 0===l||null===(a=l.data)||void 0===a?void 0:a.type)||"user";return ut(d,s).showModules?(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsx)(Cn,{}),(0,Ce.jsxs)(fn,{children:[(0,Ce.jsxs)(bn,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.pS3}),"Opr\xe1vn\u011bn\xed pro moduly (workflow)"]}),(0,Ce.jsxs)("div",{style:{padding:"12px",background:"#f0f9ff",border:"1px solid #bfdbfe",borderRadius:"8px",fontSize:"0.85rem",color:"#1e40af",marginBottom:"16px"},children:[(0,Ce.jsx)("strong",{children:"\u2139\ufe0f Jak to funguje:"}),(0,Ce.jsx)("div",{style:{marginTop:"6px",fontSize:"0.8rem",color:"#3b82f6"},children:"Vztah roz\u0161\xed\u0159\xed viditelnost dat podle lokalit a \xfasek\u016f. U\u017eivatel MUS\xcd m\xedt z\xe1kladn\xed pr\xe1vo (roli) pro p\u0159\xedstup k modulu."})]}),(0,Ce.jsxs)(Rn,{children:[(0,Ce.jsxs)(En,{children:[(0,Ce.jsx)("input",{type:"checkbox",checked:so.orders,onChange:e=>co(n=>(0,ge.A)((0,ge.A)({},n),{},{orders:e.target.checked}))}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1},children:[(0,Ce.jsxs)("span",{children:["\ud83d\udccb ",(0,Ce.jsx)("strong",{children:"Objedn\xe1vky"})]}),(0,Ce.jsx)("span",{style:{fontSize:"0.75rem",color:"#10b981",background:"#f0fdf4",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"AKTIVN\xcd"})]})]}),so.orders&&(0,Ce.jsxs)("div",{style:{marginLeft:"32px",marginTop:"6px",marginBottom:"12px"},children:[(0,Ce.jsx)("label",{style:{fontSize:"0.8rem",color:"#64748b",display:"block",marginBottom:"4px"},children:"\xdarove\u0148 pr\xe1v pro nad\u0159\xedzen\xe9ho:"}),(0,Ce.jsxs)("select",{value:ro.orders,onChange:e=>lo(n=>(0,ge.A)((0,ge.A)({},n),{},{orders:e.target.value})),style:{width:"100%",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cbd5e1",fontSize:"0.85rem",cursor:"pointer",background:"white"},children:[(0,Ce.jsx)("option",{value:"READ_ONLY",children:"\ud83d\udc41\ufe0f Jen \u010dten\xed (vid\xed z\xe1znamy)"}),(0,Ce.jsx)("option",{value:"READ_WRITE",children:"\u270f\ufe0f \u010cten\xed + Editace"}),(0,Ce.jsx)("option",{value:"READ_WRITE_DELETE",children:"\ud83d\uddd1\ufe0f Pln\xfd p\u0159\xedstup (i maz\xe1n\xed)"}),(0,Ce.jsx)("option",{value:"INHERIT",children:"\ud83d\udd17 D\u011bdit pr\xe1va pod\u0159\xedzen\xe9ho"})]})]}),(0,Ce.jsxs)(En,{children:[(0,Ce.jsx)("input",{type:"checkbox",checked:so.invoices,onChange:e=>co(n=>(0,ge.A)((0,ge.A)({},n),{},{invoices:e.target.checked}))}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1},children:[(0,Ce.jsxs)("span",{children:["\ud83e\uddfe ",(0,Ce.jsx)("strong",{children:"Faktury"})]}),(0,Ce.jsx)("span",{style:{fontSize:"0.75rem",color:"#10b981",background:"#f0fdf4",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"AKTIVN\xcd"})]})]}),so.invoices&&(0,Ce.jsxs)("div",{style:{marginLeft:"32px",marginTop:"6px",marginBottom:"12px"},children:[(0,Ce.jsx)("label",{style:{fontSize:"0.8rem",color:"#64748b",display:"block",marginBottom:"4px"},children:"\xdarove\u0148 pr\xe1v pro nad\u0159\xedzen\xe9ho:"}),(0,Ce.jsxs)("select",{value:ro.invoices,onChange:e=>lo(n=>(0,ge.A)((0,ge.A)({},n),{},{invoices:e.target.value})),style:{width:"100%",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cbd5e1",fontSize:"0.85rem",cursor:"pointer",background:"white"},children:[(0,Ce.jsx)("option",{value:"READ_ONLY",children:"\ud83d\udc41\ufe0f Jen \u010dten\xed (vid\xed z\xe1znamy)"}),(0,Ce.jsx)("option",{value:"READ_WRITE",children:"\u270f\ufe0f \u010cten\xed + Editace"}),(0,Ce.jsx)("option",{value:"READ_WRITE_DELETE",children:"\ud83d\uddd1\ufe0f Pln\xfd p\u0159\xedstup (i maz\xe1n\xed)"}),(0,Ce.jsx)("option",{value:"INHERIT",children:"\ud83d\udd17 D\u011bdit pr\xe1va pod\u0159\xedzen\xe9ho"})]})]}),(0,Ce.jsxs)("div",{style:{marginLeft:"0px",paddingLeft:"0px"},children:[(0,Ce.jsxs)(En,{children:[(0,Ce.jsx)("input",{type:"checkbox",checked:so.cashbook,onChange:e=>co(n=>(0,ge.A)((0,ge.A)({},n),{},{cashbook:e.target.checked}))}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1},children:[(0,Ce.jsxs)("span",{children:["\ud83d\udcb0 ",(0,Ce.jsx)("strong",{children:"Pokladna"})]}),(0,Ce.jsx)("span",{style:{fontSize:"0.75rem",color:"#f59e0b",background:"#fef3c7",padding:"2px 6px",borderRadius:"4px",fontWeight:600},children:"\u010c\xc1STE\u010cN\u011a"})]})]}),(0,Ce.jsx)("div",{style:{marginLeft:"32px",marginTop:"6px",marginBottom:"6px"},children:(0,Ce.jsxs)(En,{style:{fontSize:"0.85rem",padding:"4px 8px"},children:[(0,Ce.jsx)("input",{type:"checkbox",checked:so.cashbookReadonly,onChange:e=>co(n=>(0,ge.A)((0,ge.A)({},n),{},{cashbookReadonly:e.target.checked})),disabled:!so.cashbook}),(0,Ce.jsx)("span",{style:{color:"#64748b"},children:"\ud83d\udcd6 Jen pro \u010dten\xed (read-only)"})]})}),so.cashbook&&(0,Ce.jsxs)("div",{style:{marginLeft:"32px",marginTop:"6px",marginBottom:"12px"},children:[(0,Ce.jsx)("label",{style:{fontSize:"0.8rem",color:"#64748b",display:"block",marginBottom:"4px"},children:"\xdarove\u0148 pr\xe1v pro nad\u0159\xedzen\xe9ho:"}),(0,Ce.jsxs)("select",{value:ro.cashbook,onChange:e=>lo(n=>(0,ge.A)((0,ge.A)({},n),{},{cashbook:e.target.value})),style:{width:"100%",padding:"6px 10px",borderRadius:"6px",border:"1px solid #cbd5e1",fontSize:"0.85rem",cursor:"pointer",background:"white"},children:[(0,Ce.jsx)("option",{value:"READ_ONLY",children:"\ud83d\udc41\ufe0f Jen \u010dten\xed (vid\xed z\xe1znamy)"}),(0,Ce.jsx)("option",{value:"READ_WRITE",children:"\u270f\ufe0f \u010cten\xed + Editace"}),(0,Ce.jsx)("option",{value:"READ_WRITE_DELETE",children:"\ud83d\uddd1\ufe0f Pln\xfd p\u0159\xedstup (i maz\xe1n\xed)"}),(0,Ce.jsx)("option",{value:"INHERIT",children:"\ud83d\udd17 D\u011bdit pr\xe1va pod\u0159\xedzen\xe9ho"})]})]})]}),(0,Ce.jsxs)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px dashed #e5e7eb"},children:[(0,Ce.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"8px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Pl\xe1novan\xe9 moduly (TODO):"}),(0,Ce.jsxs)(En,{style:{opacity:.5,cursor:"not-allowed"},children:[(0,Ce.jsx)("input",{type:"checkbox",disabled:!0,checked:so.contracts,onChange:e=>co(n=>(0,ge.A)((0,ge.A)({},n),{},{contracts:e.target.checked}))}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Ce.jsx)("span",{children:"\ud83d\udcc4 Smlouvy"}),(0,Ce.jsx)("span",{style:{fontSize:"0.7rem",color:"#6b7280"},children:"(p\u0159ipravujeme)"})]})]})]})]}),(0,Ce.jsxs)("div",{style:{marginTop:"12px",padding:"10px",background:"#fffbeb",border:"1px solid #fde68a",borderRadius:"6px",fontSize:"0.75rem",color:"#92400e"},children:[(0,Ce.jsx)("strong",{children:"\u26a0\ufe0f D\u016fle\u017eit\xe9:"})," Vztah funguje jen pokud m\xe1 u\u017eivatel glob\xe1ln\xed pr\xe1vo (nap\u0159. ",(0,Ce.jsx)("code",{style:{background:"#fef3c7",padding:"2px 4px",borderRadius:"3px"},children:"ORDER_EDIT_OWN"}),")."]})]})]}):null})(),k&&((e,n,o,t,i,a)=>{const r=C.find(e=>e.id===k.source),l=C.find(e=>e.id===k.target),d=(null===r||void 0===r||null===(e=r.data)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)||(null===r||void 0===r||null===(o=r.data)||void 0===o?void 0:o.type)||"user",s=(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(i=t.metadata)||void 0===i?void 0:i.type)||(null===l||void 0===l||null===(a=l.data)||void 0===a?void 0:a.type)||"user";return ut(d,s).showExtended?(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsx)(Cn,{}),(0,Ce.jsxs)(fn,{children:[(0,Ce.jsxs)(bn,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.Pcr}),"Roz\u0161\xed\u0159en\xe9 lokality"]}),(0,Ce.jsx)(yn,{children:(0,Ce.jsx)(Se.A,{value:q,onChange:e=>Q(e),options:F,placeholder:"Vyberte lokality...",field:"extendedLocations",multiple:!0,selectStates:yo,setSelectStates:jo,searchStates:ko,setSearchStates:zo,touchedSelectFields:So,setTouchedSelectFields:wo,toggleSelect:uo,filterOptions:ho,getOptionLabel:go,hasTriedToSubmit:!1})})]}),(0,Ce.jsx)(Cn,{}),(0,Ce.jsxs)(fn,{children:[(0,Ce.jsxs)(bn,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.URI}),"Roz\u0161\xed\u0159en\xe9 \xfaseky"]}),(0,Ce.jsx)(yn,{children:(0,Ce.jsx)(Se.A,{value:vo,onChange:e=>mo(e),options:H,placeholder:"Vyberte \xfaseky...",field:"extendedDepartments",multiple:!0,selectStates:yo,setSelectStates:jo,searchStates:ko,setSearchStates:zo,touchedSelectFields:So,setTouchedSelectFields:wo,toggleSelect:uo,filterOptions:ho,getOptionLabel:go,hasTriedToSubmit:!1})})]}),(0,Ce.jsx)(Cn,{}),(0,Ce.jsxs)(fn,{children:[(0,Ce.jsxs)(bn,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.qIE}),"Kombinace lokalita + \xfasek"]}),(0,Ce.jsx)("p",{style:{fontSize:"0.85rem",color:"#6c757d",marginBottom:"12px"},children:'Specifick\xe9 kombinace lokalita+\xfasek (AND logika). Nap\u0159. "jen IT z Berouna".'}),fo.length>0?(0,Ce.jsxs)(In,{children:[(0,Ce.jsx)("thead",{children:(0,Ce.jsxs)("tr",{children:[(0,Ce.jsx)("th",{children:"Lokalita"}),(0,Ce.jsx)("th",{children:"\xdasek"}),(0,Ce.jsx)("th",{style:{width:"40px"}})]})}),(0,Ce.jsx)("tbody",{children:fo.map((e,n)=>{const o=F.find(n=>n.id===e.locationId),t=H.find(n=>n.id===e.departmentId);return(0,Ce.jsxs)("tr",{children:[(0,Ce.jsx)("td",{children:(null===o||void 0===o?void 0:o.name)||"N/A"}),(0,Ce.jsx)("td",{children:(null===t||void 0===t?void 0:t.name)||"N/A"}),(0,Ce.jsx)("td",{children:(0,Ce.jsx)("button",{onClick:()=>{bo(e=>e.filter((e,o)=>o!==n))},children:(0,Ce.jsx)(ze.g,{icon:Ee.GRI})})})]},n)})})]}):(0,Ce.jsx)("p",{style:{fontSize:"0.85rem",color:"#adb5bd",fontStyle:"italic",marginTop:"8px"},children:"Zatim zadne kombinace"}),(0,Ce.jsxs)(_n,{children:[(0,Ce.jsxs)(yn,{style:{marginBottom:0},children:[(0,Ce.jsx)(jn,{children:"Lokalita"}),(0,Ce.jsxs)(Tn,{id:"combo-location-select",children:[(0,Ce.jsx)("option",{value:"",children:"-- Vyberte lokalitu --"}),F.map(e=>(0,Ce.jsxs)("option",{value:e.id,children:[e.name," ",e.code?"(".concat(e.code,")"):""]},e.id))]})]}),(0,Ce.jsxs)(yn,{style:{marginBottom:0},children:[(0,Ce.jsx)(jn,{children:"\xdasek"}),(0,Ce.jsxs)(Tn,{id:"combo-department-select",children:[(0,Ce.jsx)("option",{value:"",children:"-- Vyberte \xfasek --"}),H.map(e=>(0,Ce.jsxs)("option",{value:e.id,children:[e.name," ",e.code?"(".concat(e.code,")"):""]},e.id))]})]}),(0,Ce.jsx)("button",{onClick:()=>{const e=document.getElementById("combo-location-select"),n=document.getElementById("combo-department-select"),o=e.value,t=n.value;if(o&&t){fo.some(e=>e.locationId===o&&e.departmentId===t)||(bo(e=>[...e,{locationId:o,departmentId:t}]),e.value="",n.value="")}},children:"Pridat"})]})]})]}):null})(),k&&((e,n,o,t,i,a,r,l,d,s,c,p,x,u)=>{const h=C.find(e=>e.id===k.source),g=C.find(e=>e.id===k.target);if(!("template"===(null===h||void 0===h||null===(e=h.data)||void 0===e?void 0:e.type)||"template"===(null===g||void 0===g||null===(n=g.data)||void 0===n?void 0:n.type)))return null;const v="template"===(null===h||void 0===h||null===(o=h.data)||void 0===o?void 0:o.type)?h:g;return(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(fn,{children:[(0,Ce.jsxs)(bn,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.z$e}),"Nastaven\xed notifikac\xed"]}),(0,Ce.jsxs)("div",{style:{padding:"12px",background:"#fef3c7",borderRadius:"6px",marginBottom:"12px",border:"1px solid #fbbf24"},children:[(0,Ce.jsxs)("div",{style:{fontSize:"0.8rem",color:"#78350f",fontWeight:500},children:["\ud83d\udd14 ",(0,Ce.jsx)("strong",{children:null===v||void 0===v||null===(t=v.data)||void 0===t?void 0:t.name})]}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#92400e",marginTop:"4px"},children:["Bude odes\xedl\xe1na: ","template"===(null===g||void 0===g||null===(i=g.data)||void 0===i?void 0:i.type)?h.data.name:g.data.name]}),(0,Ce.jsx)("div",{style:{fontSize:"0.7rem",color:"#92400e",marginTop:"6px",fontStyle:"italic",paddingTop:"6px",borderTop:"1px solid #fbbf24"},children:"\ud83d\udca1 Variantu HTML emailu vyberte v detailu notifika\u010dn\xedho uzlu (klikn\u011bte na uzel)"})]}),(0,Ce.jsxs)("div",{style:{padding:"10px",background:"#e0f2fe",borderRadius:"6px",marginBottom:"12px",border:"2px solid #0ea5e9"},children:[(0,Ce.jsx)("div",{style:{fontSize:"0.8rem",color:"#0c4a6e",fontWeight:600,marginBottom:"4px"},children:"\ud83d\udc64 Typ p\u0159\xedjemce"}),(0,Ce.jsx)("div",{style:{fontSize:"0.85rem",color:"#0369a1",fontWeight:700},children:((e,n,o)=>{const t="template"===(null===g||void 0===g||null===(e=g.data)||void 0===e?void 0:e.type)?h:g,i=null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.type,a=null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.genericType;if("genericRecipient"===i&&a){return{TRIGGER_USER:"\ud83c\udfaf Spou\u0161t\u011b\u010d akce",ENTITY_AUTHOR:"\u270d\ufe0f Objednatel / Autor",ENTITY_OWNER:"\ud83d\udc64 P\u0159\xedkazce / Vlastn\xedk"}[a]||a}return"user"===i?"\ud83d\udc64 Konkr\xe9tn\xed u\u017eivatel":"role"===i?"\ud83c\udfad Role (v\u0161ichni s touto rol\xed)":"group"===i?"\ud83d\udc65 Skupina":(null===i||void 0===i?void 0:i.toUpperCase())||"NEZN\xc1M\xdd"})()}),(0,Ce.jsx)("div",{style:{fontSize:"0.7rem",color:"#0c4a6e",marginTop:"4px",fontStyle:"italic"},children:"Ur\u010duje, komu se bude notifikace pos\xedlat"})]}),(0,Ce.jsxs)(yn,{style:{marginBottom:"16px"},children:[(0,Ce.jsxs)(jn,{children:["\ud83c\udfaf Jak d\u016fle\u017eit\xe1 je tato notifikace?",(0,Ce.jsx)("span",{style:{color:"#f59e0b",marginLeft:"4px"},children:"*"})]}),(0,Ce.jsxs)(Tn,{value:ce,onChange:e=>pe(e.target.value),title:"Ur\u010duje, kterou barvu emailu pou\u017e\xedt",children:[(0,Ce.jsx)("option",{value:"EXCEPTIONAL",children:"\ud83d\udd34 URGENTN\xcd - kritick\xe9, vy\u017eaduje rychlou akci"}),(0,Ce.jsx)("option",{value:"APPROVAL",children:"\ud83d\udfe0 NORM\xc1LN\xcd - standardn\xed notifikace"}),(0,Ce.jsx)("option",{value:"INFO",children:"\ud83d\udfe2 INFORMACE - jen pro v\u011bdom\xed, nic ned\u011blat"})]}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"6px",lineHeight:"1.5"},children:["\ud83d\udca1 ",(0,Ce.jsx)("strong",{children:"Toto ur\u010duje, kterou BARVU emailu pou\u017e\xedt"})," (z nastaven\xed \u0161ablony):",(0,Ce.jsx)("br",{}),"\u2022 ",(0,Ce.jsx)("strong",{children:"URGENTN\xcd"})," = pou\u017eije se \ud83d\udd34 \u010derven\xe1 varianta emailu",(0,Ce.jsx)("br",{}),"\u2022 ",(0,Ce.jsx)("strong",{children:"NORM\xc1LN\xcd"})," = pou\u017eije se \ud83d\udfe0 oran\u017eov\xe1 varianta emailu",(0,Ce.jsx)("br",{}),"\u2022 ",(0,Ce.jsx)("strong",{children:"INFORMACE"})," = pou\u017eije se \ud83d\udfe2 zelen\xe1 varianta emailu"]})]}),(0,Ce.jsxs)(yn,{style:{marginBottom:"16px"},children:[(0,Ce.jsxs)(jn,{children:["Typy ud\xe1lost\xed (Event Types)",(0,Ce.jsx)("span",{style:{color:"#10b981",marginLeft:"4px",fontWeight:"normal"},children:"voliteln\xe9"})]}),(0,Ce.jsx)(Se.A,{multiple:!0,value:oe,onChange:e=>te(e),options:(X||[]).map(e=>({id:e.kod||e.code,value:e.kod||e.code,label:"".concat(e.nazev||e.name," (").concat(e.kod||e.code,")")})),placeholder:"Vyberte typy ud\xe1lost\xed...",field:"selectedNotificationEventTypes",selectStates:yo,setSelectStates:jo,searchStates:ko,setSearchStates:zo,touchedSelectFields:So,setTouchedSelectFields:wo,toggleSelect:uo,filterOptions:ho,getOptionLabel:go,hasTriedToSubmit:!1}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"6px",lineHeight:"1.5"},children:["\ud83d\udca1 ",(0,Ce.jsx)("strong",{children:"Kdy poslat tuto notifikace?"})," Vyberte ud\xe1losti:",(0,Ce.jsx)("br",{}),"\u2022 Nap\u0159. ",(0,Ce.jsx)("strong",{children:"ORDER_SENT_FOR_APPROVAL"})," = kdy\u017e n\u011bkdo ode\u0161le objedn\xe1vku ke schv\xe1len\xed",(0,Ce.jsx)("br",{}),"\u2022 M\u016f\u017eete vybrat v\xedce ud\xe1lost\xed najednou",(0,Ce.jsx)("br",{}),"\u26a0\ufe0f Pokud nevyberete \u017e\xe1dnou \u2192 notifikace se nepou\u017eije automaticky"]})]}),(0,Ce.jsx)(yn,{style:{marginBottom:"16px"},children:(0,Ce.jsxs)("div",{style:{padding:"12px",background:"#f0fdf4",border:"2px solid #10b981",borderRadius:"8px"},children:[(0,Ce.jsx)("label",{style:{fontSize:"0.85rem",fontWeight:"600",color:"#065f46",marginBottom:"8px",display:"block"},children:"\ud83c\udfaf Komu poslat (Scope Filter)"}),(0,Ce.jsxs)("select",{value:ie,onChange:e=>ae(e.target.value),style:{width:"100%",padding:"8px",fontSize:"0.85rem",border:"2px solid #10b981",borderRadius:"6px",backgroundColor:"white",cursor:"pointer",marginBottom:"8px"},children:[(0,Ce.jsxs)("optgroup",{label:"\u2500\u2500\u2500 Z\xc1KLADN\xcd FILTRY \u2500\u2500\u2500",children:[(0,Ce.jsx)("option",{value:"NONE",children:"Bez filtru - v\u0161ichni dan\xe9ho typu"}),(0,Ce.jsx)("option",{value:"LOCATION",children:"Z lokality entity"}),(0,Ce.jsx)("option",{value:"DEPARTMENT",children:"Z \xfaseku entity"})]}),(0,Ce.jsxs)("optgroup",{label:"\u2500\u2500\u2500 \xda\u010cASTN\xcdCI T\xc9TO ENTITY \u2b50 \u2500\u2500\u2500",children:[(0,Ce.jsx)("option",{value:"PARTICIPANTS_ALL",children:"\u2b50 V\u0161ichni \xfa\u010dastn\xedci"}),(0,Ce.jsx)("option",{value:"PARTICIPANTS_OBJEDNATEL",children:"Jen objednatel"}),(0,Ce.jsx)("option",{value:"PARTICIPANTS_PRIKAZCE",children:"Jen p\u0159\xedkazce"}),(0,Ce.jsx)("option",{value:"PARTICIPANTS_GARANT",children:"Jen garant"}),(0,Ce.jsx)("option",{value:"PARTICIPANTS_SCHVALOVATEL",children:"Jen schvalovatel\xe9"})]})]}),(0,Ce.jsxs)("div",{style:{fontSize:"0.75rem",color:"#047857",lineHeight:"1.5",marginTop:"4px"},children:[(!(null!==(a=k.data)&&void 0!==a&&a.scope_filter)||"NONE"===(null===(r=k.data)||void 0===r?void 0:r.scope_filter))&&(0,Ce.jsxs)("span",{children:["\ud83d\udd13 ",(0,Ce.jsx)("strong",{children:"Bez filtru:"})," Po\u0161le v\u0161em u\u017eivatel\u016fm dan\xe9ho typu (role/\xfasek/lokalita) bez omezen\xed."]}),"LOCATION"===(null===(l=k.data)||void 0===l?void 0:l.scope_filter)&&(0,Ce.jsxs)("span",{children:["\ud83d\udccd ",(0,Ce.jsx)("strong",{children:"Z lokality:"})," Po\u0161le jen u\u017eivatel\u016fm z lokality, kde je objedn\xe1vka/faktura."]}),"DEPARTMENT"===(null===(d=k.data)||void 0===d?void 0:d.scope_filter)&&(0,Ce.jsxs)("span",{children:["\ud83c\udfe2 ",(0,Ce.jsx)("strong",{children:"Z \xfaseku:"})," Po\u0161le jen u\u017eivatel\u016fm z \xfaseku, kde je objedn\xe1vka/faktura."]}),"PARTICIPANTS_ALL"===(null===(s=k.data)||void 0===s?void 0:s.scope_filter)&&(0,Ce.jsxs)("span",{children:["\u2b50 ",(0,Ce.jsx)("strong",{children:"V\u0161ichni \xfa\u010dastn\xedci:"})," Po\u0161le V\u0160EM, kdo jsou p\u0159i\u0159azeni k t\xe9to konkr\xe9tn\xed objedn\xe1vce (objednatel, garant, p\u0159\xedkazce, schvalovatel\xe9)."]}),"PARTICIPANTS_OBJEDNATEL"===(null===(c=k.data)||void 0===c?void 0:c.scope_filter)&&(0,Ce.jsxs)("span",{children:["\u270d\ufe0f ",(0,Ce.jsx)("strong",{children:"Jen objednatel:"})," Po\u0161le JEN objednateli t\xe9to konkr\xe9tn\xed objedn\xe1vky (pole objednatel_id)."]}),"PARTICIPANTS_PRIKAZCE"===(null===(p=k.data)||void 0===p?void 0:p.scope_filter)&&(0,Ce.jsxs)("span",{children:["\ud83d\udc64 ",(0,Ce.jsx)("strong",{children:"Jen p\u0159\xedkazce:"})," Po\u0161le JEN p\u0159\xedkazci t\xe9to konkr\xe9tn\xed objedn\xe1vky (pole prikazce_id)."]}),"PARTICIPANTS_GARANT"===(null===(x=k.data)||void 0===x?void 0:x.scope_filter)&&(0,Ce.jsxs)("span",{children:["\ud83d\udee1\ufe0f ",(0,Ce.jsx)("strong",{children:"Jen garant:"})," Po\u0161le JEN garantovi t\xe9to konkr\xe9tn\xed objedn\xe1vky (pole garant_id)."]}),"PARTICIPANTS_SCHVALOVATEL"===(null===(u=k.data)||void 0===u?void 0:u.scope_filter)&&(0,Ce.jsxs)("span",{children:["\u2705 ",(0,Ce.jsx)("strong",{children:"Jen schvalovatel\xe9:"})," Po\u0161le JEN schvalovatel\u016fm t\xe9to konkr\xe9tn\xed objedn\xe1vky (schvalovatel_1_id, schvalovatel_2_id...)."]})]})]})}),(0,Ce.jsxs)(Rn,{children:[(0,Ce.jsxs)(En,{children:[(0,Ce.jsx)("input",{type:"checkbox",checked:re,onChange:e=>le(e.target.checked)}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.y_8,style:{color:"#667eea"}}),(0,Ce.jsx)("span",{children:"Poslat emailem"})]})]}),(0,Ce.jsxs)(En,{children:[(0,Ce.jsx)("input",{type:"checkbox",checked:de,onChange:e=>se(e.target.checked)}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.z$e,style:{color:"#f5576c"}}),(0,Ce.jsx)("span",{children:"Zobrazit ve zvone\u010dku (in-app)"})]})]})]}),(0,Ce.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"#eff6ff",borderRadius:"8px",border:"1px solid #bfdbfe"},children:[(0,Ce.jsxs)(En,{style:{marginBottom:"12px"},children:[(0,Ce.jsx)("input",{type:"checkbox",checked:xe,onChange:e=>ue(e.target.checked)}),(0,Ce.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.iW_,style:{color:"#3b82f6"}}),(0,Ce.jsx)("span",{children:(0,Ce.jsx)("strong",{children:"Odeslat INFO potvrzen\xed tv\u016frc\u016fm ud\xe1losti"})})]})]}),xe&&(0,Ce.jsxs)("div",{style:{marginLeft:"24px",marginTop:"8px"},children:[(0,Ce.jsx)("div",{style:{fontSize:"0.75rem",color:"#64748b",marginBottom:"8px"},children:"Vyberte pole z objedn\xe1vky, jejich\u017e u\u017eivatel\xe9 dostanou INFO notifikaci:"}),(0,Ce.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px",fontSize:"0.85rem"},children:[{value:"uzivatel_id",label:"Autor (uzivatel_id)"},{value:"garant_uzivatel_id",label:"Garant (garant_uzivatel_id)"},{value:"objednatel_id",label:"Objednatel (objednatel_id)"},{value:"schvalovatel_id",label:"Schvalovatel (schvalovatel_id)"},{value:"prikazce_id",label:"P\u0159\xedkazce (prikazce_id)"},{value:"dodavatel_id",label:"Dodavatel (dodavatel_id)"},{value:"odesilatel_id",label:"Odes\xedlatel (odesilatel_id)"},{value:"fakturant_id",label:"Fakturant (fakturant_id)"},{value:"zverejnil_id",label:"Zve\u0159ejnil (zverejnil_id)"},{value:"dokoncil_id",label:"Dokon\u010dil (dokoncil_id)"}].map(e=>(0,Ce.jsxs)(En,{style:{fontSize:"0.85rem"},children:[(0,Ce.jsx)("input",{type:"checkbox",checked:he.includes(e.value),onChange:n=>{n.target.checked?ve([...he,e.value]):ve(he.filter(n=>n!==e.value))}}),(0,Ce.jsx)("span",{children:e.label})]},e.value))}),(0,Ce.jsx)("div",{style:{marginTop:"8px",fontSize:"0.7rem",color:"#64748b",fontStyle:"italic"},children:"\ud83d\udca1 NULL hodnoty se automaticky p\u0159esko\u010d\xed"})]})]}),(0,Ce.jsxs)("div",{style:{marginTop:"12px",padding:"10px",background:"#f0fdf4",borderRadius:"6px",fontSize:"0.75rem",color:"#166534",border:"1px solid #86efac"},children:[(0,Ce.jsx)("strong",{children:"\u2139\ufe0f Hierarchie rozhodov\xe1n\xed:"}),(0,Ce.jsxs)("ol",{style:{margin:"6px 0 0 18px",padding:0},children:[(0,Ce.jsx)("li",{children:"Glob\xe1ln\xed nastaven\xed aplikace"}),(0,Ce.jsx)("li",{children:"Nastaven\xed tohoto vztahu (zde)"}),(0,Ce.jsx)("li",{children:"U\u017eivatelsk\xe9 preference v profilu"})]}),(0,Ce.jsx)("div",{style:{marginTop:"6px",fontSize:"0.7rem",color:"#15803d"},children:"Notifikace se ode\u0161le pouze kdy\u017e jsou v\u0161echny 3 \xfarovn\u011b povoleny."})]})]}),(0,Ce.jsx)(Cn,{})]})})(),(y||k)&&(0,Ce.jsx)(fn,{children:(0,Ce.jsxs)("button",{onClick:y?async()=>{y&&(console.log("\ud83d\uddd1\ufe0f Deleting node:",y.id),I(e=>e.filter(e=>e.id!==y.id)),L(e=>e.filter(e=>e.source!==y.id&&e.target!==y.id)),j(null),w(!1),console.log("\u2705 Node removed from UI (will be deleted from DB on next save)"))}:async()=>{k&&(console.log("\ud83d\uddd1\ufe0f Deleting edge:",k),L(e=>e.filter(e=>e.id!==k.id)),z(null),w(!1),console.log("\u2705 Edge removed from UI (will be deleted from DB on next save)"))},style:{width:"100%",padding:"10px 16px",background:"#dc2626",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:"0.9rem",fontWeight:"600",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="#b91c1c",e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px rgba(220, 38, 38, 0.4)"},onMouseLeave:e=>{e.target.style.background="#dc2626",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},children:[(0,Ce.jsx)(ze.g,{icon:Ee.yLS}),(0,Ce.jsx)("span",{children:y?"Odstranit uzel":"Odstranit vztah"})]})})]})]})]}),nt.show&&(0,Ce.jsx)(Nn,{onClick:()=>{var e;return null===(e=nt.onCancel)||void 0===e?void 0:e.call(nt)},children:(0,Ce.jsxs)(Ln,{onClick:e=>e.stopPropagation(),children:[(0,Ce.jsx)(On,{children:nt.icon}),(0,Ce.jsx)(Pn,{children:nt.title}),(0,Ce.jsx)(Dn,{children:nt.message}),nt.stats&&(0,Ce.jsx)(Mn,{children:Object.entries(nt.stats).map(e=>{let[n,o]=e;return(0,Ce.jsxs)("div",{children:[(0,Ce.jsxs)("strong",{children:[n,":"]}),(0,Ce.jsx)("span",{children:o})]},n)})}),(0,Ce.jsxs)(Bn,{children:[nt.cancelText&&(0,Ce.jsx)(Vn,{onClick:nt.onCancel,children:nt.cancelText}),(0,Ce.jsx)(Vn,{primary:!0,onClick:nt.onConfirm,children:nt.confirmText})]})]})}),Go&&(0,Ce.jsx)(Nn,{onClick:e=>{e.target===e.currentTarget&&Xo(!1)},children:(0,Ce.jsxs)(Ln,{onClick:e=>e.stopPropagation(),style:{maxWidth:"700px"},children:[(0,Ce.jsx)(On,{children:"\ud83d\udca1"}),(0,Ce.jsx)(Pn,{children:y?"N\xe1pov\u011bda k detailu uzlu":"N\xe1pov\u011bda k detailu vztahu"}),(0,Ce.jsx)(Wn,{children:y?(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(Fn,{children:[(0,Ce.jsxs)("h3",{children:["\ud83d\udccb ",null===(i=y.data)||void 0===i?void 0:i.label]}),(0,Ce.jsx)("p",{children:"Panel zobrazuje vztahy tohoto uzlu v diagramu:"}),(0,Ce.jsxs)("p",{style:{marginTop:"8px"},children:[(0,Ce.jsx)("strong",{children:"\u2b06\ufe0f Nad\u0159\xedzen\xed"})," - komu tento uzel podl\xe9h\xe1",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"\u2b07\ufe0f Pod\u0159\xedzen\xed"})," - kdo tomuto uzlu podl\xe9h\xe1"]})]}),(0,Ce.jsxs)(Fn,{children:[(0,Ce.jsx)("h3",{children:"\ud83d\udcbe Ukl\xe1d\xe1n\xed"}),(0,Ce.jsxs)("p",{children:["Zm\u011bny se automaticky ukl\xe1daj\xed do ",(0,Ce.jsx)("code",{children:"localStorage"}),". Pro trval\xe9 ulo\u017een\xed do DB pou\u017eijte tla\u010d\xedtko ",(0,Ce.jsx)("strong",{children:'"\ud83d\udcbe Ulo\u017eit do DB"'}),"."]})]})]}):(0,Ce.jsxs)(Ce.Fragment,{children:[(0,Ce.jsxs)(Fn,{children:[(0,Ce.jsxs)("h3",{children:["\ud83d\udd17 ",((e,n)=>{const o=C.find(e=>e.id===(null===k||void 0===k?void 0:k.source)),t=C.find(e=>e.id===(null===k||void 0===k?void 0:k.target));return"".concat((null===o||void 0===o||null===(e=o.data)||void 0===e?void 0:e.label)||"?"," \u2192 ").concat((null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.label)||"?")})()]}),(0,Ce.jsxs)("p",{children:[(0,Ce.jsx)("strong",{children:"Nad\u0159\xedzen\xfd z\xedsk\xe1v\xe1 pr\xe1va vid\u011bt data od Pod\u0159\xedzen\xe9ho"})," podle nastaven\xed."]})]}),(0,Ce.jsxs)(Fn,{children:[(0,Ce.jsxs)("h3",{children:["\ud83c\udfaf Rozsah (",Zn,")"]}),(0,Ce.jsxs)("p",{children:[(0,Ce.jsx)("code",{children:"OWN"})," - vlastn\xed z\xe1znamy pod\u0159\xedzen\xe9ho",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("code",{children:"TEAM"})," - cel\xfd \xfasek pod\u0159\xedzen\xe9ho",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("code",{children:"LOCATION"})," - cel\xe1 lokalita pod\u0159\xedzen\xe9ho",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("code",{children:"ALL"})," - kompletn\xed p\u0159\xedstup"]})]}),(0,Ce.jsxs)(Fn,{children:[(0,Ce.jsx)("h3",{children:"\ud83d\udd10 \xdarove\u0148 pr\xe1v"}),(0,Ce.jsx)("p",{children:"Ur\u010duje, CO m\u016f\u017ee nad\u0159\xedzen\xfd d\u011blat se z\xe1znamy pod\u0159\xedzen\xe9ho:"}),(0,Ce.jsxs)(Un,{children:[(0,Ce.jsx)("strong",{children:"P\u0159\xedklad:"}),(0,Ce.jsxs)("span",{children:["Holovsk\xfd (THP) m\xe1 pr\xe1vo ",(0,Ce.jsx)("code",{children:"CREATE + EDIT"})," vlastn\xed objedn\xe1vky.",(0,Ce.jsx)("br",{}),"\u010cernhorsk\xfd je nad\u0159\xedzen\xfd s \xfarovn\xed ",(0,Ce.jsx)("code",{children:"READ_ONLY"}),".",(0,Ce.jsx)("br",{}),"\u2192 \u010cernhorsk\xfd ",(0,Ce.jsx)("strong",{children:"vid\xed"})," Holovsk\xe9ho objedn\xe1vky, ale ",(0,Ce.jsx)("strong",{children:"nem\u016f\u017ee je editovat"}),"."]})]}),(0,Ce.jsxs)("p",{style:{marginTop:"12px",fontSize:"0.85rem"},children:[(0,Ce.jsx)("code",{children:"READ_ONLY"})," - vid\xed z\xe1znamy, nem\u016f\u017ee editovat",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("code",{children:"READ_WRITE"})," - m\u016f\u017ee editovat z\xe1znamy",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("code",{children:"READ_WRITE_DELETE"})," - pln\xfd p\u0159\xedstup v\u010detn\u011b maz\xe1n\xed",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("code",{children:"INHERIT"})," - d\u011bd\xed stejn\xe1 pr\xe1va jako pod\u0159\xedzen\xfd"]}),(so.orders||so.invoices||so.cashbook)&&(0,Ce.jsxs)("div",{style:{marginTop:"8px",padding:"8px",background:"#f0fdf4",borderRadius:"6px",border:"1px solid #86efac"},children:[(0,Ce.jsx)("strong",{style:{fontSize:"0.85rem",color:"#166534"},children:"Aktu\xe1ln\xed nastaven\xed:"}),(0,Ce.jsxs)("div",{style:{fontSize:"0.8rem",color:"#166534",marginTop:"4px"},children:[so.orders&&"\ud83d\udccb Objedn\xe1vky: ".concat(ro.orders),(0,Ce.jsx)("br",{}),so.invoices&&"\ud83e\uddfe Faktury: ".concat(ro.invoices),(0,Ce.jsx)("br",{}),so.cashbook&&"\ud83d\udcb0 Pokladna: ".concat(ro.cashbook)]})]})]}),(0,Ce.jsxs)(Fn,{children:[(0,Ce.jsx)("h3",{children:"\ud83d\udce6 Roz\u0161\xed\u0159en\xe1 opr\xe1vn\u011bn\xed"}),(0,Ce.jsxs)("p",{children:[(0,Ce.jsx)("strong",{children:"Lokality/\xdaseky:"})," Nad\u0159\xedzen\xfd vid\xed data i z dal\u0161\xedch m\xedst mimo z\xe1kladn\xed vztah.",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"Notifikace:"})," ",re?"Email \u2713":"Email \u2717"," ",de?"In-app \u2713":"In-app \u2717"]})]}),(0,Ce.jsxs)(Fn,{children:[(0,Ce.jsx)("h3",{children:"\ud83d\udca1 Kompletn\xed p\u0159\xedklad"}),(0,Ce.jsx)(Un,{children:(0,Ce.jsxs)("span",{style:{fontSize:"0.85rem"},children:[(0,Ce.jsx)("strong",{children:"Situace:"})," Petr je nad\u0159\xedzen\xfd Jana.",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"Nastaven\xed:"})," TEAM scope, modul Objedn\xe1vky, \xfarove\u0148 READ_ONLY",(0,Ce.jsx)("br",{}),(0,Ce.jsx)("br",{}),(0,Ce.jsx)("strong",{children:"V\xfdsledek:"}),(0,Ce.jsx)("br",{}),"\u2192 Petr ",(0,Ce.jsx)("strong",{children:"vid\xed v\u0161echny objedn\xe1vky"})," z Janova \xfaseku (i od koleg\u016f)",(0,Ce.jsx)("br",{}),"\u2192 Petr ",(0,Ce.jsx)("strong",{children:"nem\u016f\u017ee editovat"})," tyto objedn\xe1vky (jen \u010d\xedst)",(0,Ce.jsx)("br",{}),"\u2192 Pokud Jan m\xe1 pr\xe1vo vytv\xe1\u0159et, Petr to pr\xe1vo ",(0,Ce.jsx)("strong",{children:"nedostane"})]})})]})]})}),(0,Ce.jsx)(Bn,{style:{marginTop:"20px"},children:(0,Ce.jsx)(Vn,{primary:!0,onClick:()=>Xo(!1),children:"Rozum\xedm"})})]})}),Ko.isOpen&&(0,Ce.jsx)(Be,{onClick:()=>Jo({isOpen:!1,title:"",message:"",onConfirm:null}),children:(0,Ce.jsxs)(Ve,{onClick:e=>e.stopPropagation(),children:[(0,Ce.jsxs)(Me,{children:[(0,Ce.jsx)(ze.g,{icon:Ee.yLS}),Ko.title]}),(0,Ce.jsx)(We,{children:Ko.message}),(0,Ce.jsxs)(Fe,{children:[(0,Ce.jsx)(Ue,{onClick:()=>Jo({isOpen:!1,title:"",message:"",onConfirm:null}),children:"Zru\u0161it"}),(0,Ce.jsx)(Ue,{variant:"danger",onClick:Ko.onConfirm,children:"Ano, smazat"})]})]})}),Co&&(0,Ce.jsx)(Jn,{mode:_o,onClose:()=>Io(!1),onSave:async(e,n)=>{try{const o=await Te.jK.token(),t=await Te.jK.user(),i=(null===t||void 0===t?void 0:t.username)||localStorage.getItem("username"),a="https://erdms.zachranka.cz/api.eeo/",r=await fetch("".concat(a,"/hierarchy/profiles/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:o,username:i,name:e,description:n,set_active:!1})}),l=await r.json();if("PROFILE_EXISTS"===l.code)return{exists:!0,profileName:e};if(!l.success)throw new Error(l.error||"Chyba pri vytvareni profilu");const d=l.profile_id;return await kt(d),await jt(),Io(!1),{success:!0}}catch(o){return console.error("Profile save error:",o),{error:o.message}}},existingProfiles:Ao}),$o&&(0,Ce.jsx)(Yn,{isOpen:$o,onClose:()=>{qo(!1),et(null)},emailData:Qo})]})]})}}}]);
//# sourceMappingURL=4696.31b6b2c9.chunk.js.map