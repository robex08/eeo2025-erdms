"use strict";(self.webpackChunkr_app_zzs_eeo=self.webpackChunkr_app_zzs_eeo||[]).push([[6872],{66872:(n,e,t)=>{t.r(e),t.d(e,{default:()=>W});var o,r,i,a,d,s,l,c,f,p,u,x,h,g=t(57528),b=t(65043),v=t(97950),m=t(45903),y=t(83910),k=t(97929),w=t(9227),j=t(68951),A=t(27837),C=t(36629),z=t(33637),_=t(70579);const F=m.A.div(o||(o=(0,g.A)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.85);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  padding: 0;\n"]))),L=m.A.div(r||(r=(0,g.A)(["\n  background: white;\n  border-radius: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n"]))),P=m.A.div(i||(i=(0,g.A)(["\n  padding: 20px 24px;\n  border-bottom: 2px solid #e5e7eb;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: linear-gradient(135deg, #059669 0%, #047857 100%);\n  color: white;\n  border-radius: 12px 12px 0 0;\n"]))),R=m.A.h2(a||(a=(0,g.A)(["\n  margin: 0;\n  font-size: 1.5rem;\n  font-weight: 700;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n"]))),U=m.A.div(d||(d=(0,g.A)(["\n  display: flex;\n  gap: 12px;\n  align-items: center;\n"]))),D=m.A.button(s||(s=(0,g.A)(["\n  padding: 10px 20px;\n  border: none;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  transition: all 0.2s;\n  background: ",";\n  color: ",";\n\n  &:hover {\n    background: ",";\n    transform: translateY(-2px);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none;\n  }\n"])),n=>"primary"===n.variant?"#ffffff":"rgba(255, 255, 255, 0.2)",n=>"primary"===n.variant?"#059669":"#ffffff",n=>"primary"===n.variant?"#f0fdf4":"rgba(255, 255, 255, 0.3)"),E=m.A.button(l||(l=(0,g.A)(["\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  border-radius: 50%;\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n  color: white;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: rotate(90deg);\n  }\n"]))),S=m.A.div(c||(c=(0,g.A)(["\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  background: #f9fafb;\n"]))),B=m.A.div(f||(f=(0,g.A)(["\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  position: relative;\n"]))),N=m.A.iframe(p||(p=(0,g.A)(["\n  width: 100%;\n  height: 100%;\n  border: none;\n"]))),O=m.A.div(u||(u=(0,g.A)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  background: rgba(249, 250, 251, 0.95);\n  z-index: 10;\n"]))),G=m.A.p(x||(x=(0,g.A)(["\n  margin-top: 16px;\n  font-size: 1.1rem;\n  color: #6b7280;\n  font-weight: 500;\n"]))),I=(0,m.A)(y.g)(h||(h=(0,g.A)(["\n  font-size: 3rem;\n  color: #059669;\n  animation: spin 1s linear infinite;\n\n  @keyframes spin {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(360deg);\n    }\n  }\n"]))),W=n=>{let{order:e,onClose:t,generatedBy:o}=n;const{token:r,username:i}=(0,b.useContext)(A.cy),[a,d]=(0,b.useState)(null),[s,l]=(0,b.useState)(!0),[c,f]=(0,b.useState)(null),[p,u]=(0,b.useState)({});(0,b.useEffect)(()=>((async()=>{try{l(!0);let t=null;try{t=await(0,C.ZF)({token:r,username:i,id:1}),f(t)}catch(n){console.error("Nepoda\u0159ilo se na\u010d\xedst vizitku organizace:",n)}let a={};try{a=(await(0,z.CR)({token:r,username:i,aktivni:null})).reduce((n,e)=>{var t;return e.value&&(n[e.value]=e.label||e.value),null!==(t=e.raw)&&void 0!==t&&t.kod_stavu&&(n[e.raw.kod_stavu]=e.raw.nazev_stavu||e.raw.kod_stavu),n},{}),u(a)}catch(n){console.error("Nepoda\u0159ilo se na\u010d\xedst st\u0159ediska:",n)}const s=await(0,w.x8)((0,_.jsx)(j.A,{order:e,generatedBy:o,organizace:t,strediskaMap:a})).toBlob(),c=URL.createObjectURL(s);d(c)}catch(n){console.error("Chyba p\u0159i generov\xe1n\xed PDF n\xe1hledu:",n),alert("Chyba p\u0159i generov\xe1n\xed PDF n\xe1hledu"),t()}finally{l(!1)}})(),()=>{a&&URL.revokeObjectURL(a)}),[e,o]);return(0,b.useEffect)(()=>{const n=n=>{"Escape"===n.key&&t()};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[t]),(0,v.createPortal)((0,_.jsx)(F,{onClick:t,children:(0,_.jsxs)(L,{onClick:n=>n.stopPropagation(),children:[(0,_.jsxs)(P,{children:[(0,_.jsxs)(R,{children:["\ud83d\udccb Finan\u010dn\xed kontrola - ",(null===e||void 0===e?void 0:e.cislo_objednavky)||"N\xe1hled"]}),(0,_.jsxs)(U,{children:[(0,_.jsxs)(D,{variant:"secondary",onClick:async()=>{try{const n=await(0,w.x8)((0,_.jsx)(j.A,{order:e,generatedBy:o})).toBlob(),t=URL.createObjectURL(n),r=document.createElement("a");r.href=t,r.download="financni-kontrola-".concat((null===e||void 0===e?void 0:e.cislo_objednavky)||"dokument",".pdf"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}catch(n){console.error("Chyba p\u0159i stahov\xe1n\xed PDF:",n),alert("Chyba p\u0159i stahov\xe1n\xed PDF")}},disabled:s,title:"St\xe1hnout PDF",children:[(0,_.jsx)(y.g,{icon:k.mHA}),"St\xe1hnout"]}),(0,_.jsxs)(D,{variant:"primary",onClick:()=>{if(a){const n=document.getElementById("pdf-iframe");n&&n.contentWindow&&n.contentWindow.print()}},disabled:s,title:"Vytisknout PDF",children:[(0,_.jsx)(y.g,{icon:k.JxU}),"Tisknout"]}),(0,_.jsx)(E,{onClick:t,title:"Zav\u0159\xedt (ESC)",children:(0,_.jsx)(y.g,{icon:k.GRI})})]})]}),(0,_.jsx)(S,{children:(0,_.jsxs)(B,{children:[s&&(0,_.jsxs)(O,{children:[(0,_.jsx)(I,{icon:k.z1G}),(0,_.jsx)(G,{children:"Generuji PDF n\xe1hled..."})]}),a&&(0,_.jsx)(N,{id:"pdf-iframe",src:a,title:"PDF N\xe1hled - Finan\u010dn\xed kontrola"})]})})]})}),document.body)}}}]);
//# sourceMappingURL=6872.b31b1b30.chunk.js.map