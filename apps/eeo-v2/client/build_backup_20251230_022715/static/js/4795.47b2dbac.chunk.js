"use strict";(self.webpackChunkr_app_zzs_eeo=self.webpackChunkr_app_zzs_eeo||[]).push([[4795,8319],{34795:(e,n,t)=>{t.d(n,{Ay:()=>l,fb:()=>o,getHierarchyConfig:()=>s});var a=t(58319);const o={ORDERS:"orders",INVOICES:"invoices",CASHBOOK:"cashbook"},r={DISABLED:"disabled",IMMUNE:"immune",ACTIVE:"active",NO_PROFILE:"no_profile",ERROR:"error"},s=async(e,n)=>{try{const s=await(0,a.getGlobalSettings)(e,n),i=Boolean(s.hierarchy_enabled),l=s.hierarchy_profile_id||null,u=s.hierarchy_logic||"OR";let h=null;if(l)try{const{getHierarchyProfiles:a}=await t.e(6102).then(t.bind(t,96102)),o=(await a(e,n)).find(e=>e.id===parseInt(l,10));h=o?o.name:null}catch(o){console.warn("\u26a0\ufe0f [HierarchyService] Nelze na\u010d\xedst n\xe1zev profilu:",o)}let d=r.DISABLED;return i&&(d=l?r.ACTIVE:r.NO_PROFILE),{status:d,enabled:i,profileId:l,profileName:h,logic:u,logicDescription:c(u),modules:{orders:i&&null!==l,invoices:!1,cashbook:!1}}}catch(o){return console.error("\u274c [HierarchyService] Chyba p\u0159i na\u010d\xedt\xe1n\xed nastaven\xed:",o),{status:r.ERROR,enabled:!1,profileId:null,profileName:null,logic:"OR",logicDescription:c("OR"),error:o.message,modules:{orders:!1,invoices:!1,cashbook:!1}}}},c=e=>"AND"===e?"Restriktivn\xed (A Z\xc1ROVE\u0147) - mus\xed spl\u0148ovat v\u0161echny \xfarovn\u011b sou\u010dasn\u011b":"Liber\xe1ln\xed (NEBO) - sta\u010d\xed splnit alespo\u0148 jednu \xfarove\u0148",i=(()=>{let e=null,n=0;return async function(t,a){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=Date.now();return!o&&e&&r-n<6e4||(e=await s(t,a),n=r),e}})(),l={HierarchyModules:o,HierarchyStatus:r,getHierarchyConfig:s,getHierarchyConfigCached:i,isHierarchyActiveForModule:async(e,n,t)=>{try{const a=await s(n,t);switch(e){case o.ORDERS:return a.modules.orders;case o.INVOICES:return a.modules.invoices;case o.CASHBOOK:return a.modules.cashbook;default:return console.warn("\u26a0\ufe0f [HierarchyService] Nezn\xe1m\xfd modul: ".concat(e)),!1}}catch(a){return console.error("\u274c [HierarchyService] Chyba p\u0159i kontrole modulu:",a),!1}},getLogicDescription:c,getHierarchyInfoMessage:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.ORDERS;if(!e)return null;switch(e.status){case r.DISABLED:return null;case r.NO_PROFILE:return"\u26a0\ufe0f Hierarchie je zapnut\xe1, ale nen\xed vybr\xe1n \u017e\xe1dn\xfd profil. Kontaktujte administr\xe1tora.";case r.IMMUNE:return"\ud83d\udee1\ufe0f M\xe1te neomezen\xfd p\u0159\xedstup k dat\u016fm (HIERARCHY_IMMUNE).";case r.ACTIVE:const t={[o.ORDERS]:"objedn\xe1vky",[o.INVOICES]:"faktury",[o.CASHBOOK]:"pokladnu"}[n]||"data";return"\ud83c\udfe2 Hierarchie aktivn\xed: Vid\xedte ".concat(t,' podle organiza\u010dn\xedho \u0159\xe1du "').concat(e.profileName,'" (').concat(e.logicDescription,").");case r.ERROR:return"\u274c Chyba p\u0159i na\u010d\xedt\xe1n\xed hierarchie. Kontaktujte administr\xe1tora.";default:return null}},getHierarchyBannerColor:e=>{if(!e)return"info";switch(e.status){case r.DISABLED:return"info";case r.NO_PROFILE:return"warning";case r.IMMUNE:return"success";case r.ACTIVE:return"info";case r.ERROR:return"error";default:return"info"}},clearHierarchyCache:()=>{}}},58319:(e,n,t)=>{t.d(n,{checkMaintenanceMode:()=>c,getGlobalSettings:()=>o,l:()=>s,saveGlobalSettings:()=>r});const a="https://erdms.zachranka.cz/api.eeo/".replace(/\/$/,""),o=async(e,n)=>{try{const t=await fetch("".concat(a,"/global-settings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,username:n,operation:"get"})});if(!t.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));const o=await t.json();return o.data||o}catch(t){throw console.error("Chyba p\u0159i na\u010d\xedt\xe1n\xed glob\xe1ln\xedho nastaven\xed:",t),t}},r=async(e,n,t)=>{try{const o={token:n,username:t,operation:"save",settings:e};console.group("\ud83d\udcbe SAVE GLOBAL SETTINGS"),console.log("Settings to save:",e),console.log("Full payload:",o),console.groupEnd();const r=await fetch("".concat(a,"/global-settings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!r.ok)throw new Error("HTTP ".concat(r.status,": ").concat(r.statusText));return await r.json()}catch(o){throw console.error("Chyba p\u0159i ukl\xe1d\xe1n\xed glob\xe1ln\xedho nastaven\xed:",o),o}},s=async(e,n)=>{try{const t=await fetch("".concat(a,"/maintenance-message"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,username:n})});if(!t.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));return(await t.json()).message||"Syst\xe9m je moment\xe1ln\u011b v \xfadr\u017eb\u011b. Omlouv\xe1me se za komplikace."}catch(t){throw console.error("Chyba p\u0159i na\u010d\xedt\xe1n\xed \xfadr\u017ebov\xe9 zpr\xe1vy:",t),t}},c=async()=>{try{const e=await fetch("".concat(a,"/maintenance-status"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)return 404===e.status?console.warn("Maintenance check endpoint not found (404)"):console.warn("Maintenance check failed with status:",e.status),!1;const n=e.headers.get("content-type");if(!n||!n.includes("application/json"))return console.warn("Maintenance check: Response is not JSON, got:",n),!1;const t=await e.json();return!0===t.maintenance_mode||1===t.maintenance_mode}catch(e){return console.debug("Chyba p\u0159i kontrole maintenance mode:",e.message),!1}}}}]);
//# sourceMappingURL=4795.47b2dbac.chunk.js.map