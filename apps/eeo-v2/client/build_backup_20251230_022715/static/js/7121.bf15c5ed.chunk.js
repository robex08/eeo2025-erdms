"use strict";(self.webpackChunkr_app_zzs_eeo=self.webpackChunkr_app_zzs_eeo||[]).push([[7121],{27121:(e,n,o)=>{o.r(n),o.d(n,{default:()=>ui});var t,r,a,i,s,l,d,c,u,p,m,f,v,h,g,x,b,_,y,k,j=o(53986),w=o(89379),z=o(57528),A=o(65043),S=o(97950),C=o(91357),I=o(45903),E=o(83910),O=o(97929),N=o(27837),T=o(88720),D=o(32730),R=o(30264),P=o(44649),$=o(77220),M=o(84856),B=o(75949),L=o(33637),F=o(19439),V=o(70579);const W=I.A.div(t||(t=(0,z.A)(["\n  background: #fafbfc;\n  border-radius: 8px;\n  overflow: hidden;\n"]))),U=I.A.div(r||(r=(0,z.A)(["\n  background: white;\n  border-radius: 12px;\n  margin-bottom: 0.75rem;\n  border: 2px solid #e5e7eb;\n  overflow: hidden;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n"]))),Z=I.A.div(a||(a=(0,z.A)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.5rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  border-left: 5px solid transparent;\n  position: relative;\n  \n  /* 3D efekt na lev\xe9 lince */\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 5px;\n    box-shadow: \n      inset 2px 0 3px rgba(0, 0, 0, 0.15),\n      inset -1px 0 2px rgba(255, 255, 255, 0.5);\n  }\n  \n  /* Barevn\xe1 sch\xe9mata podle OF25 */\n  ","\n"])),e=>{switch(e.$theme){case"grey":return"\n          background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n          border-left-color: #64748b;\n          &:hover { background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); }\n        ";case"orange":return"\n          background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\n          border-left-color: #f97316;\n          &:hover { background: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%); }\n        ";case"blue":return"\n          background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\n          border-left-color: #3b82f6;\n          &:hover { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); }\n        ";case"purple":return"\n          background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);\n          border-left-color: #a855f7;\n          &:hover { background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%); }\n        ";case"green":return"\n          background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n          border-left-color: #22c55e;\n          &:hover { background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); }\n        ";case"red":return"\n          background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n          border-left-color: #ef4444;\n          &:hover { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); }\n        ";default:return"\n          background: ".concat(e.$isActive?"#f8fafc":"#fff",";\n          &:hover { background: #f1f5f9; }\n        ")}}),J=I.A.h3(i||(i=(0,z.A)(["\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  \n  svg {\n    ","\n  }\n"])),e=>{switch(e.$theme){case"grey":return"color: #64748b;";case"orange":return"color: #f97316;";case"blue":default:return"color: #3b82f6;";case"purple":return"color: #a855f7;";case"green":return"color: #22c55e;";case"red":return"color: #ef4444;"}}),K=I.A.div(s||(s=(0,z.A)(["\n  transition: transform 0.3s ease;\n  transform: ",";\n  color: #64748b;\n  font-size: 1.2rem;\n"])),e=>e.$collapsed?"rotate(180deg)":"rotate(0deg)"),H=I.A.div(l||(l=(0,z.A)(["\n  max-height: ",";\n  overflow: hidden;\n  transition: max-height 0.3s ease;\n  padding: ",";\n  border-left: 5px solid transparent;\n  position: relative;\n  background: #fafbfc;\n  \n  /* 3D efekt na lev\xe9 lince - pokra\u010dov\xe1n\xed z headeru */\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 5px;\n    box-shadow: \n      inset 2px 0 3px rgba(0, 0, 0, 0.15),\n      inset -1px 0 2px rgba(255, 255, 255, 0.5);\n  }\n  \n  /* Barevn\xe1 linka podle t\xe9matu */\n  ","\n"])),e=>e.$collapsed?"0":"5000px",e=>e.$collapsed?"0 1.5rem":"1.5rem",e=>{switch(e.$theme){case"grey":return"border-left-color: #64748b;";case"orange":return"border-left-color: #f97316;";case"blue":return"border-left-color: #3b82f6;";case"purple":return"border-left-color: #a855f7;";case"green":return"border-left-color: #22c55e;";case"red":return"border-left-color: #ef4444;";default:return""}}),Y=I.A.div(d||(d=(0,z.A)(["\n  display: grid;\n  grid-template-columns: ",";\n  gap: 1rem;\n  margin-bottom: 1rem;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n"])),e=>e.$columns||"1fr"),G=I.A.div(c||(c=(0,z.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n"]))),q=I.A.div(u||(u=(0,z.A)(["\n  font-weight: 600;\n  color: #64748b;\n  font-size: 0.85rem;\n  text-transform: uppercase;\n  letter-spacing: 0.025em;\n"]))),X=I.A.div(p||(p=(0,z.A)(["\n  font-size: 0.95rem;\n  color: #1e293b;\n  padding: 0.5rem 0;\n  \n  &.empty {\n    color: #94a3b8;\n    font-style: italic;\n  }\n  \n  &.highlight {\n    font-weight: 600;\n    color: #1e40af;\n  }\n"]))),Q=I.A.span(m||(m=(0,z.A)(["\n  display: inline-block;\n  padding: 0.25rem 0.75rem;\n  border-radius: 9999px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  background: ",";\n  color: ",";\n"])),e=>e.$bg||"#f1f5f9",e=>e.$color||"#475569"),ee=I.A.div(f||(f=(0,z.A)(["\n  background: white;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1rem;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n"]))),ne=I.A.div(v||(v=(0,z.A)(["\n  font-weight: 600;\n  color: #475569;\n  font-size: 0.875rem;\n  margin-bottom: 0.75rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 2px solid #e2e8f0;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  \n  svg {\n    color: #64748b;\n    font-size: 1rem;\n  }\n"]))),oe=I.A.div(h||(h=(0,z.A)(["\n  display: grid;\n  grid-template-columns: ",";\n  gap: 1.25rem;\n  \n  @media (max-width: 768px) {\n    grid-template-columns: 1fr;\n  }\n"])),e=>e.$columns||"repeat(auto-fit, minmax(200px, 1fr))"),te=I.A.div(g||(g=(0,z.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n  min-width: 0;\n"]))),re=I.A.div(x||(x=(0,z.A)(["\n  font-weight: 600;\n  color: #64748b;\n  font-size: 0.8rem;\n  text-transform: uppercase;\n  letter-spacing: 0.025em;\n"]))),ae=I.A.div(b||(b=(0,z.A)(["\n  font-size: 0.95rem;\n  color: #1e293b;\n  word-wrap: break-word;\n  \n  &.empty {\n    color: #94a3b8;\n    font-style: italic;\n  }\n  \n  &.highlight {\n    font-weight: 600;\n    color: #1e40af;\n    font-size: 1.05rem;\n    white-space: nowrap;\n  }\n  \n  &.currency {\n    font-weight: 600;\n    color: #059669;\n    font-size: 1.05rem;\n  }\n"]))),ie=(I.A.div(_||(_=(0,z.A)(["\n  height: 1px;\n  background: linear-gradient(to right, #e2e8f0, #f1f5f9, #e2e8f0);\n  margin: 1.5rem 0;\n"]))),I.A.button(y||(y=(0,z.A)(["\n  position: sticky;\n  top: 1rem;\n  right: 1rem;\n  float: right;\n  margin-bottom: 1rem;\n  padding: 0.5rem 1rem;\n  background: #3b82f6;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.2s;\n  z-index: 10;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n  \n  &:hover {\n    background: #2563eb;\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);\n  }\n"]))),I.A.button(k||(k=(0,z.A)(["\n  padding: 0.5rem 1rem;\n  background: #f97316;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.2s;\n  box-shadow: 0 2px 8px rgba(249, 115, 22, 0.3);\n  \n  &:hover {\n    background: #ea580c;\n    box-shadow: 0 4px 12px rgba(249, 115, 22, 0.4);\n    transform: translateY(-1px);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n"])))),se=(0,A.forwardRef)((e,n)=>{var o,t,r,a,i,s,l,d,c,u,p,m,f,v,h,g,x;let{orderData:b,onCollapseChange:_,onEditInvoice:y,canEditInvoice:k=!0,editingInvoiceId:j,isReadOnlyMode:z=!1,token:S,username:C}=e;const[I,N]=(0,A.useState)({objednatel:!1,schvaleni:!1,dodavatel:!1,detaily:!1,dodani:!1,fakturace:!1,poznamky:!1,registr:!1,vecna_spravnost:!1,dokonceni:!1,prilohy:!1}),T=e=>{N(n=>{const o=(0,w.A)((0,w.A)({},n),{},{[e]:!n[e]});if(_){const e=Object.values(o).some(e=>!0===e);_(e)}return o})},D=()=>{const e={};Object.keys(I).forEach(n=>{e[n]=!0}),N(e),_&&_(!0)},R=()=>{const e={};Object.keys(I).forEach(n=>{e[n]=!1}),N(e),_&&_(!1)},$=Object.values(I).every(e=>!0===e),M=Object.values(I).every(e=>!1===e);if((0,A.useImperativeHandle)(n,()=>({collapseAll:D,expandAll:R,areAllCollapsed:$,areAllExpanded:M})),!b)return(0,V.jsxs)("div",{style:{padding:"3rem",textAlign:"center",color:"#94a3b8"},children:[(0,V.jsx)(E.g,{icon:O.h8M,size:"3x",style:{marginBottom:"1rem",opacity:.3}}),(0,V.jsx)("div",{children:"\u017d\xe1dn\xe1 data k zobrazen\xed"})]});const B=e=>e?"".concat(parseFloat(e).toLocaleString("cs-CZ")," K\u010d"):"\u2014";return(0,V.jsxs)(W,{children:[(0,V.jsxs)(U,{children:[(0,V.jsxs)(Z,{$theme:"grey",$isActive:!I.objednatel,onClick:()=>T("objednatel"),children:[(0,V.jsxs)(J,{$theme:"grey",children:[(0,V.jsx)(E.g,{icon:O.X46}),"Informace o objednateli"]}),(0,V.jsx)(K,{$collapsed:I.objednatel,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsxs)(H,{$collapsed:I.objednatel,$theme:"grey",children:[(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.X46}),"Objednatel"]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Jm\xe9no"}),(0,V.jsx)(ae,{className:"highlight",children:((e,n,o)=>{const t=(null===(e=b._enriched)||void 0===e?void 0:e.uzivatel)||(null===(n=b._enriched)||void 0===n?void 0:n.objednatel);if(t){const e=t.titul_pred?"".concat(t.titul_pred," "):"",n=t.titul_za?", ".concat(t.titul_za):"";return"".concat(e).concat(t.jmeno," ").concat(t.prijmeni).concat(n)}return(null===(o=b.uzivatel)||void 0===o?void 0:o.cele_jmeno)||b.jmeno||"\u2014"})()})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Telefon"}),(0,V.jsx)(ae,{children:((e,n,o)=>{const t=(null===(e=b._enriched)||void 0===e?void 0:e.uzivatel)||(null===(n=b._enriched)||void 0===n?void 0:n.objednatel);return(null===t||void 0===t?void 0:t.telefon)||b.objednatel_telefon||(null===(o=b.uzivatel)||void 0===o?void 0:o.telefon)||b.telefon||"\u2014"})()})]})]}),(0,V.jsx)(oe,{$columns:"1fr",style:{marginTop:"1rem"},children:(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"E-mail"}),(0,V.jsx)(ae,{children:((e,n,o)=>{const t=(null===(e=b._enriched)||void 0===e?void 0:e.uzivatel)||(null===(n=b._enriched)||void 0===n?void 0:n.objednatel);return(null===t||void 0===t?void 0:t.email)||(null===(o=b.uzivatel)||void 0===o?void 0:o.email)||b.email||"\u2014"})()})]})})]}),(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.SGM}),"Garant objedn\xe1vky"]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Jm\xe9no"}),(0,V.jsx)(ae,{className:"highlight",children:((e,n)=>{const o=null===(e=b._enriched)||void 0===e?void 0:e.garant_uzivatel;if(o){const e=o.titul_pred?"".concat(o.titul_pred," "):"",n=o.titul_za?", ".concat(o.titul_za):"";return"".concat(e).concat(o.jmeno," ").concat(o.prijmeni).concat(n)}return(null===(n=b.garant_uzivatel)||void 0===n?void 0:n.cele_jmeno)||"\u2014"})()})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Telefon"}),(0,V.jsx)(ae,{children:(null===(o=b._enriched)||void 0===o||null===(t=o.garant_uzivatel)||void 0===t?void 0:t.telefon)||"\u2014"})]})]}),(0,V.jsx)(oe,{$columns:"1fr",style:{marginTop:"1rem"},children:(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"E-mail"}),(0,V.jsx)(ae,{children:(null===(r=b._enriched)||void 0===r||null===(a=r.garant_uzivatel)||void 0===a?void 0:a.email)||"\u2014"})]})})]})]})]}),(0,V.jsxs)(U,{"data-section":"schvaleni",children:[(0,V.jsxs)(Z,{$theme:"grey",$isActive:!I.schvaleni,onClick:()=>T("schvaleni"),children:[(0,V.jsxs)(J,{$theme:"grey",children:[(0,V.jsx)(E.g,{icon:O.Iae}),"Schv\xe1len\xed n\xe1kupu PO"]}),(0,V.jsx)(K,{$collapsed:I.schvaleni,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsxs)(H,{$collapsed:I.schvaleni,$theme:"grey",children:[(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.h8M}),"Z\xe1kladn\xed \xfadaje"]}),(0,V.jsxs)(te,{style:{marginBottom:"1rem"},children:[(0,V.jsx)(re,{children:"P\u0159edm\u011bt objedn\xe1vky"}),(0,V.jsx)(ae,{className:"highlight",children:b.predmet||"\u2014"})]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"\u010c\xedslo objedn\xe1vky"}),(0,V.jsx)(ae,{className:"highlight",children:b.cislo_objednavky||"#".concat(b.id)})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Datum objedn\xe1vky"}),(0,V.jsx)(ae,{children:b.dt_objednavky?(0,F.iS)(b.dt_objednavky):"\u2014"})]})]}),(0,V.jsx)(oe,{$columns:"1fr",children:(0,V.jsxs)(te,{style:{textAlign:"right"},children:[(0,V.jsx)(re,{style:{textAlign:"right"},children:"Max. cena s DPH"}),(0,V.jsx)(ae,{className:"currency",style:{textAlign:"right"},children:B(b.max_cena_s_dph)})]})})]}),(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.X46}),"P\u0159\xedkazce rozpo\u010dtu"]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Jm\xe9no"}),(0,V.jsx)(ae,{className:"highlight",children:((e,n)=>{const o=null===(e=b._enriched)||void 0===e?void 0:e.prikazce;if(o){const e=o.titul_pred?"".concat(o.titul_pred," "):"",n=o.titul_za?", ".concat(o.titul_za):"";return"".concat(e).concat(o.jmeno," ").concat(o.prijmeni).concat(n)}return(null===(n=b.prikazce)||void 0===n?void 0:n.cele_jmeno)||"\u2014"})()})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Telefon"}),(0,V.jsx)(ae,{children:(null===(i=b._enriched)||void 0===i||null===(s=i.prikazce)||void 0===s?void 0:s.telefon)||"\u2014"})]})]}),(0,V.jsx)(oe,{$columns:"1fr",style:{marginTop:"1rem"},children:(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"E-mail"}),(0,V.jsx)(ae,{children:(null===(l=b._enriched)||void 0===l||null===(d=l.prikazce)||void 0===d?void 0:d.email)||"\u2014"})]})})]}),(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.SGM}),"Schvalovatel"]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Jm\xe9no"}),(0,V.jsx)(ae,{className:"highlight",children:((e,n)=>{const o=null===(e=b._enriched)||void 0===e?void 0:e.schvalovatel;if(o){const e=o.titul_pred?"".concat(o.titul_pred," "):"",n=o.titul_za?", ".concat(o.titul_za):"";return"".concat(e).concat(o.jmeno," ").concat(o.prijmeni).concat(n)}return(null===(n=b.schvalovatel)||void 0===n?void 0:n.cele_jmeno)||"\u2014"})()})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Telefon"}),(0,V.jsx)(ae,{children:(null===(c=b._enriched)||void 0===c||null===(u=c.schvalovatel)||void 0===u?void 0:u.telefon)||"\u2014"})]})]}),(0,V.jsx)(oe,{$columns:"1fr",style:{marginTop:"1rem"},children:(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"E-mail"}),(0,V.jsx)(ae,{children:(null===(p=b._enriched)||void 0===p||null===(m=p.schvalovatel)||void 0===m?void 0:m.email)||"\u2014"})]})})]}),(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.URI}),"St\u0159ediska"]}),(0,V.jsx)(te,{children:(0,V.jsx)(ae,{children:null!==(L=b._enriched)&&void 0!==L&&L.strediska&&Array.isArray(b._enriched.strediska)?b._enriched.strediska.map(e=>e.nazev||e.kod).join(", ")||"\u2014":b.strediska_kod&&Array.isArray(b.strediska_kod)?b.strediska_kod.join(", "):"\u2014"})})]}),(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.wq_}),"Zp\u016fsob financov\xe1n\xed a workflow"]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Typ financov\xe1n\xed"}),(0,V.jsx)(ae,{className:"highlight",children:(null===(f=b.financovani)||void 0===f?void 0:f.typ_nazev)||(null===(v=b.financovani)||void 0===v?void 0:v.typ)||"\u2014"})]}),(null===(h=b.financovani)||void 0===h?void 0:h.lp_nazvy)&&b.financovani.lp_nazvy.length>0&&(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"Limitovan\xe9 p\u0159\xedsliby"}),(0,V.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.5rem"},children:b.financovani.lp_nazvy.map((e,n)=>{let o="";if("object"===typeof e){const n=e.cislo_lp||e.kod||e.id,t=e.nazev||e.nazev_uctu||e.label;o=n&&t?"".concat(n," - ").concat(t):t||n||"LP"}else o=String(e);return(0,V.jsx)(Q,{$bg:"#dbeafe",$color:"#1e40af",children:o},n)})})]}),((e,n,o)=>{const t=(null===(e=b.financovani)||void 0===e?void 0:e.typ_kod)||(null===(n=b.financovani)||void 0===n?void 0:n.typ)||b.zpusob_financovani;var r,a;return"SMLOUVA"===t||"SMLOUVA"===(null===t||void 0===t||null===(o=t.toUpperCase)||void 0===o?void 0:o.call(t))?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"\u010c\xedslo smlouvy"}),(0,V.jsx)(ae,{children:(null===(r=b.financovani)||void 0===r?void 0:r.cislo_smlouvy)||b.cislo_smlouvy||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"Nen\xed vypln\u011bno"})})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Pozn\xe1mka ke smlouv\u011b"}),(0,V.jsx)(ae,{children:(null===(a=b.financovani)||void 0===a?void 0:a.smlouva_poznamka)||b.smlouva_poznamka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"Nen\xed vypln\u011bno"})})]})]}):null})(),((e,n,o,t)=>{const r=(null===(e=b.financovani)||void 0===e?void 0:e.typ_kod)||(null===(n=b.financovani)||void 0===n?void 0:n.typ)||b.zpusob_financovani;var a,i;return"INDIVIDUALNI_SCHVALENI"===r||"INDIVIDUALNI_SCHVALENI"===(null===r||void 0===r||null===(o=r.toUpperCase)||void 0===o?void 0:o.call(r))||"INDIVIDUALNI SCHVALENI"===r||(null===r||void 0===r||null===(t=r.includes)||void 0===t?void 0:t.call(r,"INDIVIDUALNI"))?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"\u010c\xedslo v\xfdzvy"}),(0,V.jsx)(ae,{children:(null===(a=b.financovani)||void 0===a?void 0:a.individualni_schvaleni)||b.individualni_schvaleni||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"Nen\xed vypln\u011bno"})})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Pozn\xe1mka"}),(0,V.jsx)(ae,{children:(null===(i=b.financovani)||void 0===i?void 0:i.individualni_poznamka)||b.individualni_poznamka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"Nen\xed vypln\u011bno"})})]})]}):null})(),((e,n,o,t)=>{const r=(null===(e=b.financovani)||void 0===e?void 0:e.typ_kod)||(null===(n=b.financovani)||void 0===n?void 0:n.typ)||b.zpusob_financovani;var a,i;return"POJISTNA_UDALOST"===r||"POJISTNA_UDALOST"===(null===r||void 0===r||null===(o=r.toUpperCase)||void 0===o?void 0:o.call(r))||"POJISTNA UDALOST"===r||(null===r||void 0===r||null===(t=r.includes)||void 0===t?void 0:t.call(r,"POJISTNA"))?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"\u010c\xedslo pojistn\xe9 ud\xe1losti"}),(0,V.jsx)(ae,{children:(null===(a=b.financovani)||void 0===a?void 0:a.pojistna_udalost_cislo)||b.pojistna_udalost_cislo||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"Nen\xed vypln\u011bno"})})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Pozn\xe1mka k pojistn\xe9 ud\xe1losti"}),(0,V.jsx)(ae,{children:(null===(i=b.financovani)||void 0===i?void 0:i.pojistna_udalost_poznamka)||b.pojistna_udalost_poznamka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"Nen\xed vypln\u011bno"})})]})]}):null})(),(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"Stavy workflow"}),(0,V.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",marginTop:"0.5rem"},children:(()=>{if(!b.stav_workflow_kod||!Array.isArray(b.stav_workflow_kod))return null;const e={SCHVALENA:{bg:"#dcfce7",color:"#166534"},ODESLANA:{bg:"#dbeafe",color:"#1e40af"},POTVRZENA:{bg:"#e0e7ff",color:"#4338ca"},NEUVEREJNIT:{bg:"#fef3c7",color:"#92400e"},FAKTURACE:{bg:"#fce7f3",color:"#9f1239"},VECNA_SPRAVNOST:{bg:"#f3e8ff",color:"#6b21a8"},ZKONTROLOVANA:{bg:"#d1fae5",color:"#065f46"},DOKONCENA:{bg:"#ccfbf1",color:"#115e59"}};return b.stav_workflow_kod.map((n,o)=>{const t=e[n]||{bg:"#f1f5f9",color:"#475569"};return(0,V.jsxs)(A.Fragment,{children:[(0,V.jsx)(Q,{$bg:t.bg,$color:t.color,style:{marginBottom:"0.5rem"},children:n.replace("_"," ")}),o<b.stav_workflow_kod.length-1&&(0,V.jsx)("span",{style:{margin:"0 0.5rem",color:"#64748b",fontWeight:"600"},children:"\u2192"})]},n)})})()})]})]})]})]})]}),(0,V.jsxs)(U,{children:[(0,V.jsxs)(Z,{$theme:"orange",$isActive:!I.dodavatel,onClick:()=>T("dodavatel"),children:[(0,V.jsxs)(J,{$theme:"orange",children:[(0,V.jsx)(E.g,{icon:O.URI}),"Dodavatel"]}),(0,V.jsx)(K,{$collapsed:I.dodavatel,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsxs)(H,{$collapsed:I.dodavatel,$theme:"orange",children:[(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.URI}),"Z\xe1kladn\xed \xfadaje"]}),(0,V.jsxs)(te,{style:{marginBottom:"1rem"},children:[(0,V.jsx)(re,{children:"N\xe1zev dodavatele"}),(0,V.jsx)(ae,{className:"highlight",children:b.dodavatel_nazev||"\u2014"})]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"I\u010cO"}),(0,V.jsx)(ae,{children:b.dodavatel_ico||"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"DI\u010c"}),(0,V.jsx)(ae,{children:b.dodavatel_dic||"\u2014"})]})]}),(0,V.jsxs)(te,{style:{marginTop:"1rem"},children:[(0,V.jsx)(re,{children:"Adresa"}),(0,V.jsx)(ae,{children:b.dodavatel_adresa||"\u2014"})]})]}),(0,V.jsxs)(ee,{children:[(0,V.jsxs)(ne,{children:[(0,V.jsx)(E.g,{icon:O.X46}),"Kontaktn\xed osoba"]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Jm\xe9no"}),(0,V.jsx)(ae,{children:b.dodavatel_kontakt_jmeno||"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"E-mail"}),(0,V.jsx)(ae,{children:b.dodavatel_kontakt_email||"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Telefon"}),(0,V.jsx)(ae,{children:b.dodavatel_kontakt_telefon||"\u2014"})]})]})]})]})]}),b.polozky&&b.polozky.length>0&&(0,V.jsxs)(U,{"data-section":"detaily",children:[(0,V.jsxs)(Z,{$theme:"orange",$isActive:!I.detaily,onClick:()=>T("detaily"),children:[(0,V.jsxs)(J,{$theme:"orange",children:[(0,V.jsx)(E.g,{icon:O.THi}),"Detaily objedn\xe1vky (",b.polozky_count||b.polozky.length," ",1===b.polozky.length?"polo\u017eka":"polo\u017eek",")"]}),(0,V.jsx)(K,{$collapsed:I.detaily,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsxs)(H,{$collapsed:I.detaily,$theme:"orange",children:[(0,V.jsx)(Y,{children:(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"Druh objedn\xe1vky"}),(0,V.jsx)(X,{children:(null===(g=b._enriched)||void 0===g||null===(x=g.druh_objednavky)||void 0===x?void 0:x.nazev)||b.druh_objednavky_nazev||b.druh_objednavky||"\u2014"})]})}),(0,V.jsxs)("div",{style:{marginTop:"1.5rem"},children:[(0,V.jsx)("div",{style:{fontWeight:"600",marginBottom:"1rem",color:"#374151"},children:"Polo\u017eky objedn\xe1vky"}),b.polozky.map((e,n)=>(0,V.jsxs)("div",{style:{padding:"1rem",background:"#fafafa",border:"1px solid #e5e7eb",borderRadius:"8px",marginBottom:"1rem"},children:[(0,V.jsxs)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"1rem",fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,V.jsxs)("span",{children:["POLO\u017dKA ",n+1]}),e.lp_id&&((n,o)=>{const t=null===(n=b.financovani)||void 0===n||null===(o=n.lp_nazvy)||void 0===o?void 0:o.find(n=>n.id===e.lp_id);return t?(0,V.jsxs)(Q,{$bg:!1!==e.lp_je_platne?"#dcfce7":"#fee2e2",$color:!1!==e.lp_je_platne?"#166534":"#991b1b",children:["\ud83c\udfaf LP: ",t.cislo_lp," - ",t.nazev]}):null})()]}),(0,V.jsx)(Y,{children:(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"N\xe1zev / popis"}),(0,V.jsx)(X,{children:e.popis||"\u2014"})]})}),(0,V.jsxs)(Y,{$columns:"1fr auto 1fr",children:[(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"Cena bez DPH"}),(0,V.jsx)(X,{children:B(e.cena_bez_dph)})]}),(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"DPH"}),(0,V.jsxs)(X,{children:[e.sazba_dph||"21","%"]})]}),(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"Cena s DPH"}),(0,V.jsx)(X,{className:"highlight",children:B(e.cena_s_dph)})]})]}),(e.usek_kod||e.budova_kod||e.mistnost_kod||e.poznamka)&&(0,V.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px dashed #d1d5db"},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#6b7280",marginBottom:"0.75rem",fontSize:"0.85rem"},children:"UM\xcdST\u011aN\xcd MAJETKU"}),(0,V.jsxs)(Y,{$columns:"1fr 1fr 1fr",children:[e.usek_kod&&(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"\xdasek"}),(0,V.jsx)(X,{children:e.usek_kod})]}),e.budova_kod&&(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"Budova"}),(0,V.jsx)(X,{children:e.budova_kod})]}),e.mistnost_kod&&(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"M\xedstnost"}),(0,V.jsx)(X,{children:e.mistnost_kod})]})]}),(e.usek_kod||e.budova_kod||e.mistnost_kod)&&(0,V.jsx)(Y,{style:{marginTop:"0.5rem"},children:(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"Pozn\xe1mka k m\xedstu"}),(0,V.jsx)(X,{children:e.poznamka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"---"})})]})})]})]},n)),(0,V.jsxs)("div",{style:{marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"2px solid #e5e7eb",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"1rem"},children:[(0,V.jsx)("div",{style:{fontWeight:"600",fontSize:"1.1rem",color:"#374151"},children:"Celkem s DPH:"}),(0,V.jsx)("div",{style:{fontWeight:"700",fontSize:"1.3rem",color:"#1e40af"},children:B(b.polozky_celkova_cena_s_dph)})]})]}),(0,V.jsx)(Y,{style:{marginTop:"1.5rem"},children:(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"Pozn\xe1mka k objedn\xe1vce"}),(0,V.jsx)(X,{children:b.poznamka_objednavky||b.poznamka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"---"})})]})})]})]}),(0,V.jsxs)(U,{children:[(0,V.jsxs)(Z,{$theme:"orange",$isActive:!I.dodani,onClick:()=>T("dodani"),children:[(0,V.jsxs)(J,{$theme:"orange",children:[(0,V.jsx)(E.g,{icon:O.raf}),"Dod\xe1n\xed"]}),(0,V.jsx)(K,{$collapsed:I.dodani,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsx)(H,{$collapsed:I.dodani,$theme:"orange",children:(0,V.jsx)(ee,{children:(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"M\xedsto dod\xe1n\xed"}),(0,V.jsx)(ae,{children:b.misto_dodani||"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"P\u0159edpokl\xe1dan\xfd term\xedn dod\xe1n\xed"}),(0,V.jsx)(ae,{children:b.dt_predpokladany_termin_dodani?(0,F.iS)(b.dt_predpokladany_termin_dodani):"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Z\xe1ruka"}),(0,V.jsx)(ae,{children:b.zaruka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"---"})})]}),b.dt_akceptace&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Datum akceptace dodavatelem"}),(0,V.jsx)(ae,{children:(0,F.iS)(b.dt_akceptace)})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Potvrdil dodavatel"}),(0,V.jsx)(ae,{children:(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.dodavatel_potvrdil;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return"".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return b.dodavatel_potvrdil_jmeno||"\u2014"})()})]})]})]})})})]}),"zverejnit"in b&&(0,V.jsxs)(U,{children:[(0,V.jsxs)(Z,{$theme:"blue",$isActive:!I.registr,onClick:()=>T("registr"),children:[(0,V.jsxs)(J,{$theme:"blue",children:[(0,V.jsx)(E.g,{icon:O.h8M}),"Rozhodnut\xed o zve\u0159ejn\u011bn\xed v registru smluv"]}),(0,V.jsx)(K,{$collapsed:I.registr,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsx)(H,{$collapsed:I.registr,$theme:"blue",children:(()=>{const e="1"===String(b.zverejnit);return(0,V.jsx)(ee,{children:(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"M\xe1 b\xfdt zve\u0159ejn\u011bna v registru smluv"}),(0,V.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",background:e?"#dcfce7":"#fee2e2",border:"2px solid ".concat(e?"#16a34a":"#ef4444"),borderRadius:"8px",color:e?"#166534":"#991b1b",fontWeight:"600",marginTop:"0.5rem"},children:[(0,V.jsx)(E.g,{icon:e?O.SGM:O.s0Q}),e?"ANO":"NE"]})]}),!e&&(0,V.jsx)(te,{style:{gridColumn:"1 / -1"},children:(0,V.jsx)(ae,{style:{color:"#6b7280",fontStyle:"italic"},children:"Objedn\xe1vka nebyla zve\u0159ejn\u011bna v registru smluv."})}),e&&b.dt_zverejneni&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Datum zve\u0159ejn\u011bn\xed"}),(0,V.jsx)(ae,{children:(0,F.iS)(b.dt_zverejneni)})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Zve\u0159ejnil"}),(0,V.jsx)(ae,{children:(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.zverejnil;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return"".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return b.zverejnil_jmeno||"\u2014"})()})]})]}),e&&b.registr_iddt&&(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"ID smlouvy v registru"}),(0,V.jsx)(ae,{children:b.registr_iddt})]})]})})})()})]}),b.faktury&&b.faktury.length>0&&(0,V.jsxs)(U,{"data-section":"faktury",children:[(0,V.jsxs)(Z,{$theme:"blue",$isActive:!I.fakturace,onClick:()=>T("fakturace"),children:[(0,V.jsxs)(J,{$theme:"blue",children:[(0,V.jsx)(E.g,{icon:O.ymQ}),"Fakturace k objedn\xe1vce (",b.faktury.length,")"]}),(0,V.jsx)(K,{$collapsed:I.fakturace,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsx)(H,{$collapsed:I.fakturace,$theme:"blue",children:b.faktury.map((e,n)=>{const o=1===e.vecna_spravnost_potvrzeno,t=j&&(e.id===j||e.id===Number(j));return(0,V.jsxs)("div",{style:{border:t?"3px solid #f59e0b":"2px solid #3b82f6",borderRadius:"12px",padding:"0",marginBottom:n<b.faktury.length-1?"1.5rem":0,background:t?"#fffbeb":o?"#f0fdf4":"#ffffff",boxShadow:t?"0 4px 16px rgba(245, 158, 11, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.08)",overflow:"hidden",position:"relative",transition:"all 0.2s ease"},children:[(0,V.jsxs)("div",{style:{background:t?"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)":"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white",padding:"1rem 1.25rem",fontWeight:"700",fontSize:"1.1rem",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem",borderBottom:t?"3px solid #b45309":"3px solid #1e40af",letterSpacing:"0.5px",textTransform:"uppercase"},children:[(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,V.jsx)(E.g,{icon:t?O.MT7:O.ymQ,style:{fontSize:"1.2rem"}}),"Faktura #",n+1,e.fa_cislo_vema&&(0,V.jsx)("span",{style:{fontWeight:"600",fontSize:"0.9rem",background:"rgba(255, 255, 255, 0.2)",padding:"0.25rem 0.75rem",borderRadius:"6px",letterSpacing:"normal",textTransform:"none"},children:e.fa_cislo_vema})]}),t?(0,V.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.25)",color:"white",border:"1px solid rgba(255, 255, 255, 0.4)",padding:"0.5rem 1rem",fontWeight:"600",borderRadius:"8px",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.5rem",letterSpacing:"0.05em"},children:[(0,V.jsx)(E.g,{icon:O.MT7}),z?"PR\xc1V\u011a KONTROLUJETE":"PR\xc1V\u011a EDITUJETE"]}):y&&k&&(0,V.jsxs)(ie,{onClick:n=>{n.stopPropagation(),y(e)},style:{background:"rgba(255, 255, 255, 0.25)",color:"white",border:"1px solid rgba(255, 255, 255, 0.4)",padding:"0.5rem 1rem",fontWeight:"600"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.35)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.25)"},children:[(0,V.jsx)(E.g,{icon:O.MT7}),"Upravit"]})]}),(0,V.jsxs)("div",{style:{padding:"1.25rem"},children:[(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"\u010c\xedslo faktury"}),(0,V.jsx)(ae,{children:e.fa_cislo_vema||"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"\u010c\xe1stka"}),(0,V.jsx)(ae,{className:"highlight",children:B(e.fa_castka)})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Datum vystaven\xed"}),(0,V.jsx)(ae,{children:e.fa_datum_vystaveni?(0,F.iS)(e.fa_datum_vystaveni):"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Datum splatnosti"}),(0,V.jsx)(ae,{children:e.fa_datum_splatnosti||e.fa_splatnost?(0,F.iS)(e.fa_datum_splatnosti||e.fa_splatnost):"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Datum doru\u010den\xed"}),(0,V.jsx)(ae,{children:e.fa_datum_doruceni?(0,F.iS)(e.fa_datum_doruceni):"\u2014"})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Typ faktury"}),(0,V.jsx)(ae,{children:(()=>{const n=e.fa_typ||"BEZNA",o={BEZNA:{bg:"#f1f5f9",color:"#475569"},ZALOHOVA:{bg:"#dbeafe",color:"#1e40af"},OPRAVNA:{bg:"#fef3c7",color:"#92400e"},PROFORMA:{bg:"#f3e8ff",color:"#6b21a8"},DOBROPIS:{bg:"#d1fae5",color:"#065f46"}},t=o[n]||o.BEZNA;return(0,V.jsx)(Q,{$bg:t.bg,$color:t.color,children:n})})()})]}),e.fa_strediska_kod&&(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"St\u0159ediska"}),(0,V.jsx)(ae,{children:(()=>{const n=e.fa_strediska_kod;if(Array.isArray(n)){return n.map(e=>{if("object"===typeof e){const n=e.kod||e.value,o=e.nazev||e.label;return n&&o?"".concat(n," - ").concat(o):o||n||e}return e}).filter(Boolean).join(", ")||"\u2014"}return"string"===typeof n&&n||"\u2014"})()})]}),(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"Pozn\xe1mka"}),(0,V.jsx)(ae,{children:e.fa_poznamka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"---"})})]}),e._isdoc_dodavatel&&(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"ISDOC Dodavatel"}),(0,V.jsxs)(ae,{children:[e._isdoc_dodavatel.nazev,e._isdoc_dodavatel.ico&&" (I\u010cO: ".concat(e._isdoc_dodavatel.ico,")")]})]})]}),e.prilohy&&e.prilohy.length>0&&(0,V.jsxs)("div",{style:{margin:"1.5rem 0 1rem 0",borderTop:"2px solid #e5e7eb",paddingTop:"1rem"},children:[(0,V.jsxs)("div",{style:{fontWeight:"600",color:"#1e40af",fontSize:"0.9rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,V.jsx)(E.g,{icon:O.WMI,style:{color:"#3b82f6"}}),"P\u0158\xcdLOHY FAKTURY \u010c. ",n+1," (",e.prilohy.length,")"]}),(0,V.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:e.prilohy.map((n,o)=>(0,V.jsxs)("div",{onClick:async()=>{try{const o=await(0,P.TD)(e.id,n.id,C,S),t=window.URL.createObjectURL(o),r=document.createElement("a");r.href=t,r.download=n.originalni_nazev_souboru||"attachment",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(t),document.body.removeChild(r)}catch(o){console.error("Error downloading invoice attachment:",o),alert(o.message||"Nepoda\u0159ilo se st\xe1hnout p\u0159\xedlohu faktury")}},style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.5rem 0.75rem",background:"#f9fafb",borderRadius:"6px",border:"1px solid #e5e7eb",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#f3f4f6",e.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:e=>{e.currentTarget.style.background="#f9fafb",e.currentTarget.style.borderColor="#e5e7eb"},title:"Klikn\u011bte pro sta\u017een\xed",children:[(0,V.jsx)(E.g,{icon:O.A4h,style:{color:"#6b7280",fontSize:"1rem"}}),(0,V.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,V.jsx)("div",{style:{fontSize:"0.875rem",color:"#374151",fontWeight:"500",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.originalni_nazev_souboru||"Nepojmenovan\xfd soubor"}),(0,V.jsx)("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"2px"},children:(e=>{if(!e||0===e)return"0 B";const n=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,n)*100)/100+" "+["B","KB","MB","GB"][n]})(n.velikost_souboru_b)})]}),(e=>{const n={FAKTURA:{bg:"#dbeafe",color:"#1e40af",label:"Faktura"},ISDOC:{bg:"#e0e7ff",color:"#4338ca",label:"ISDOC"},PRILOHA:{bg:"#f3e8ff",color:"#6b21a8",label:"P\u0159\xedloha"},SMLOUVA:{bg:"#fef3c7",color:"#92400e",label:"Smlouva"},IMPORT:{bg:"#fce7f3",color:"#9f1239",label:"Import"},JINE:{bg:"#f1f5f9",color:"#475569",label:"Jin\xe9"},JINA:{bg:"#f1f5f9",color:"#475569",label:"Jin\xe1"}},o=n[e]||n.JINA;return(0,V.jsx)(Q,{$bg:o.bg,$color:o.color,children:o.label})})(n.typ_prilohy),(0,V.jsx)(E.g,{icon:O.cbP,style:{color:"#3b82f6",fontSize:"0.875rem",marginLeft:"0.5rem"}})]},n.id||o))})]}),(0,V.jsxs)("div",{style:{margin:"1.5rem 0 1rem 0",borderTop:"2px solid #e5e7eb",paddingTop:"1rem"},children:[(0,V.jsxs)("div",{style:{fontWeight:"600",color:"#6b21a8",fontSize:"0.9rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,V.jsx)(E.g,{icon:O.Iae,style:{color:"#a855f7"}}),"V\u011aCN\xc1 KONTROLA FAKTURY ",n+1]}),(0,V.jsxs)(oe,{$columns:"1fr 1fr",children:[(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"Stav v\u011bcn\xe9 kontroly"}),(0,V.jsx)(ae,{children:1===e.vecna_spravnost_potvrzeno||"1"===e.vecna_spravnost_potvrzeno?(0,V.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"#dcfce7",border:"2px solid #16a34a",borderRadius:"8px",color:"#166534",fontWeight:"600"},children:[(0,V.jsx)(E.g,{icon:O.SGM}),"Potvrzeno"]}):(0,V.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"#fee2e2",border:"2px solid #ef4444",borderRadius:"8px",color:"#991b1b",fontWeight:"600"},children:[(0,V.jsx)(E.g,{icon:O.s0Q}),"Nepotvrzeno"]})})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Datum potvrzen\xed"}),(0,V.jsx)(ae,{children:e.dt_potvrzeni_vecne_spravnosti?(0,V.jsx)("span",{style:{fontWeight:"600",color:"#059669"},children:(0,F.iS)(e.dt_potvrzeni_vecne_spravnosti)}):(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"Nepotvrzeno"})})]}),(0,V.jsxs)(te,{children:[(0,V.jsx)(re,{children:"Potvrdil"}),(0,V.jsx)(ae,{children:(n=>{if(e.potvrdil_vecnou_spravnost_jmeno){const n=e.potvrdil_vecnou_spravnost_titul_pred?"".concat(e.potvrdil_vecnou_spravnost_titul_pred," "):"",o=e.potvrdil_vecnou_spravnost_titul_za?", ".concat(e.potvrdil_vecnou_spravnost_titul_za):"",t="".concat(n).concat(e.potvrdil_vecnou_spravnost_jmeno," ").concat(e.potvrdil_vecnou_spravnost_prijmeni||"").concat(o).trim();return(0,V.jsx)("span",{style:{fontWeight:"600",color:"#059669"},children:t})}const o=null===(n=e._enriched)||void 0===n?void 0:n.potvrdil_vecnou_spravnost;if(o){const e=o.titul_pred?"".concat(o.titul_pred," "):"",n=o.titul_za?", ".concat(o.titul_za):"",t="".concat(e).concat(o.jmeno," ").concat(o.prijmeni).concat(n);return(0,V.jsx)("span",{style:{fontWeight:"600",color:"#059669"},children:t})}return(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"\u2014"})})()})]}),(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"Um\xedst\u011bn\xed majetku"}),(0,V.jsx)(ae,{children:e.vecna_spravnost_umisteni_majetku||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"---"})})]}),(0,V.jsxs)(te,{style:{gridColumn:"1 / -1"},children:[(0,V.jsx)(re,{children:"Pozn\xe1mka k v\u011bcn\xe9 kontrole"}),(0,V.jsx)(ae,{children:e.vecna_spravnost_poznamka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"---"})})]})]})]})]})]},e.id||n)})})]}),b.poznamka&&(0,V.jsxs)(U,{children:[(0,V.jsxs)(Z,{$theme:"orange",$isActive:!I.poznamky,onClick:()=>T("poznamky"),children:[(0,V.jsxs)(J,{$theme:"orange",children:[(0,V.jsx)(E.g,{icon:O.h8M}),"Pozn\xe1mky"]}),(0,V.jsx)(K,{$collapsed:I.poznamky,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsx)(H,{$collapsed:I.poznamky,$theme:"orange",children:(0,V.jsx)(ee,{children:(0,V.jsx)(ae,{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:b.poznamka})})})]}),b.stav_workflow_kod&&b.stav_workflow_kod.includes("DOKONCENA")&&(0,V.jsxs)(U,{children:[(0,V.jsxs)(Z,{$theme:"green",$isActive:!I.dokonceni,onClick:()=>T("dokonceni"),children:[(0,V.jsxs)(J,{$theme:"green",children:[(0,V.jsx)(E.g,{icon:O.e68}),"Dokon\u010den\xed objedn\xe1vky"]}),(0,V.jsx)(K,{$collapsed:I.dokonceni,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsxs)(H,{$collapsed:I.dokonceni,$theme:"green",children:[(0,V.jsxs)("div",{style:{padding:"1rem",background:"#dcfce7",border:"2px solid #16a34a",borderRadius:"8px",color:"#166534",display:"flex",alignItems:"center",gap:"0.75rem",fontWeight:"600",marginBottom:"1.5rem"},children:[(0,V.jsx)(E.g,{icon:O.SGM,size:"lg"}),"Objedn\xe1vka byla \xfasp\u011b\u0161n\u011b dokon\u010dena"]}),(0,V.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,V.jsx)("h4",{style:{marginBottom:"1rem",color:"#166534",fontSize:"0.95rem",fontWeight:"600"},children:"Historie workflow"}),b.dt_schvaleni&&(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:"0.75rem",paddingBottom:"0.75rem",borderBottom:"1px solid #e5e7eb"},children:[(0,V.jsx)("span",{style:{color:"#16a34a",fontSize:"1.1rem",lineHeight:"1.4"},children:"\u2705"}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"Schv\xe1len\xed objedn\xe1vky"}),(0,V.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,F.iS)(b.dt_schvaleni),(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.schvalovatel;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return" \u2022 ".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return""})()]})]})]}),b.dt_odeslani&&(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:"0.75rem",paddingBottom:"0.75rem",borderBottom:"1px solid #e5e7eb"},children:[(0,V.jsx)("span",{style:{color:"#16a34a",fontSize:"1.1rem",lineHeight:"1.4"},children:"\u2705"}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"Odesl\xe1n\xed dodavateli"}),(0,V.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,F.iS)(b.dt_odeslani),(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.odesilatel;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return" \u2022 ".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return""})()]})]})]}),b.dt_akceptace&&(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:"0.75rem",paddingBottom:"0.75rem",borderBottom:"1px solid #e5e7eb"},children:[(0,V.jsx)("span",{style:{color:"#16a34a",fontSize:"1.1rem",lineHeight:"1.4"},children:"\u2705"}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"Potvrzen\xed dodavatele"}),(0,V.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,F.iS)(b.dt_akceptace),(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.dodavatel_potvrdil;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return" \u2022 ".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return""})()]})]})]}),b.dt_zverejneni&&(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:"0.75rem",paddingBottom:"0.75rem",borderBottom:"1px solid #e5e7eb"},children:[(0,V.jsx)("span",{style:{color:"#16a34a",fontSize:"1.1rem",lineHeight:"1.4"},children:"\u2705"}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"Zve\u0159ejn\u011bn\xed v registru smluv"}),(0,V.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,F.iS)(b.dt_zverejneni),(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.zverejnil;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return" \u2022 ".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return""})()]})]})]}),b.dt_faktura_pridana&&(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:"0.75rem",paddingBottom:"0.75rem",borderBottom:"1px solid #e5e7eb"},children:[(0,V.jsx)("span",{style:{color:"#16a34a",fontSize:"1.1rem",lineHeight:"1.4"},children:"\u2705"}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"P\u0159id\xe1n\xed faktury"}),(0,V.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,F.iS)(b.dt_faktura_pridana),(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.fakturant;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return" \u2022 ".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return""})()]})]})]}),b.dt_potvrzeni_vecne_spravnosti&&(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:"0.75rem",paddingBottom:"0.75rem",borderBottom:"1px solid #e5e7eb"},children:[(0,V.jsx)("span",{style:{color:"#16a34a",fontSize:"1.1rem",lineHeight:"1.4"},children:"\u2705"}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"Potvrzen\xed v\u011bcn\xe9 spr\xe1vnosti (objedn\xe1vka)"}),(0,V.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,F.iS)(b.dt_potvrzeni_vecne_spravnosti),(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.potvrdil_vecnou_spravnost;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return" \u2022 ".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return""})()]})]})]}),b.faktury&&b.faktury.some(e=>e.dt_potvrzeni_vecne_spravnosti)&&(0,V.jsxs)("div",{style:{marginBottom:"0.75rem",paddingBottom:"0.75rem",borderBottom:"1px solid #e5e7eb"},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"0.5rem",fontSize:"0.95rem"},children:"V\u011bcn\xe1 spr\xe1vnost jednotliv\xfdch faktur:"}),b.faktury.filter(e=>e.dt_potvrzeni_vecne_spravnosti).map((e,n)=>{const o=j&&(e.id===j||e.id===Number(j));return(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:n<b.faktury.filter(e=>e.dt_potvrzeni_vecne_spravnosti).length-1?"0.5rem":0,paddingLeft:"1rem",padding:o?"0.5rem 0.75rem 0.5rem 1rem":"0 0 0 1rem",background:o?"#fffbeb":"transparent",borderRadius:"6px",border:o?"2px solid #f59e0b":"none",transition:"all 0.2s ease"},children:[(0,V.jsx)("span",{style:{color:"#16a34a",fontSize:"1rem",lineHeight:"1.4"},children:"\u2713"}),(0,V.jsx)("div",{style:{flex:1},children:(0,V.jsxs)("div",{style:{fontSize:"0.875rem",color:o?"#78350f":"#6b7280"},children:[(0,V.jsxs)("span",{style:{fontWeight:o?"700":"500",color:o?"#92400e":"#4b5563"},children:[e.fa_cislo_vema||"Faktura #".concat(b.faktury.indexOf(e)+1),o&&" \u2190 PR\xc1V\u011a EDITUJETE"]})," \u2022 ",(0,F.iS)(e.dt_potvrzeni_vecne_spravnosti),(n=>{let o,t,r,a;if(e.potvrdil_vecnou_spravnost_jmeno)o=e.potvrdil_vecnou_spravnost_jmeno,t=e.potvrdil_vecnou_spravnost_prijmeni,r=e.potvrdil_vecnou_spravnost_titul_pred,a=e.potvrdil_vecnou_spravnost_titul_za;else if(null!==(n=e._enriched)&&void 0!==n&&n.potvrdil_vecnou_spravnost){const n=e._enriched.potvrdil_vecnou_spravnost;o=n.jmeno,t=n.prijmeni,r=n.titul_pred,a=n.titul_za}if(o&&t){const e=r?"".concat(r," "):"",n=a?", ".concat(a):"";return" \u2022 ".concat(e).concat(o," ").concat(t).concat(n)}return""})()]})})]},e.id||n)})]}),b.dt_dokonceni&&(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[(0,V.jsx)("span",{style:{color:"#16a34a",fontSize:"1.1rem",lineHeight:"1.4"},children:"\u2705"}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:"600",color:"#374151",marginBottom:"0.25rem"},children:"Dokon\u010den\xed objedn\xe1vky"}),(0,V.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:[(0,F.iS)(b.dt_dokonceni),(e=>{const n=null===(e=b._enriched)||void 0===e?void 0:e.dokoncil;if(n){const e=n.titul_pred?"".concat(n.titul_pred," "):"",o=n.titul_za?", ".concat(n.titul_za):"";return" \u2022 ".concat(e).concat(n.jmeno," ").concat(n.prijmeni).concat(o)}return""})()]})]})]})]}),b.faktury_celkem_s_dph&&b.max_cena_s_dph&&parseFloat(b.faktury_celkem_s_dph)>parseFloat(b.max_cena_s_dph)&&(0,V.jsxs)("div",{style:{padding:"0.75rem 1rem",background:"#fef2f2",border:"1px solid #fca5a5",borderRadius:"6px",color:"#991b1b",fontSize:"0.875rem",marginBottom:"1rem"},children:[(0,V.jsx)("strong",{children:"\u26a0\ufe0f Upozorn\u011bn\xed:"})," Celkov\xe1 cena faktur (",parseFloat(b.faktury_celkem_s_dph).toLocaleString("cs-CZ",{minimumFractionDigits:2,maximumFractionDigits:2})," K\u010d) p\u0159ekra\u010duje maxim\xe1ln\xed cenu objedn\xe1vky (",parseFloat(b.max_cena_s_dph).toLocaleString("cs-CZ",{minimumFractionDigits:2,maximumFractionDigits:2})," K\u010d)"]}),(0,V.jsxs)(G,{children:[(0,V.jsx)(q,{children:"Pozn\xe1mka k dokon\u010den\xed"}),(0,V.jsx)(X,{children:b.dokonceni_poznamka||(0,V.jsx)("span",{style:{color:"#9ca3af"},children:"---"})})]})]})]}),b.prilohy_count>0&&(0,V.jsxs)(U,{children:[(0,V.jsxs)(Z,{$theme:"red",$isActive:!I.prilohy,onClick:()=>T("prilohy"),children:[(0,V.jsxs)(J,{$theme:"red",children:[(0,V.jsx)(E.g,{icon:O.h8M}),"P\u0159\xedlohy (",b.prilohy_count,")"]}),(0,V.jsx)(K,{$collapsed:I.prilohy,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]}),(0,V.jsx)(H,{$collapsed:I.prilohy,$theme:"red",children:b.prilohy&&b.prilohy.length>0?(0,V.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:b.prilohy.map((e,n)=>(0,V.jsxs)("div",{onClick:async()=>{try{const n=await(0,P.downloadOrderAttachment)(b.id,e.id,C,S),o=window.URL.createObjectURL(n),t=document.createElement("a");t.href=o,t.download=e.originalni_nazev_souboru||e.nazev_souboru||"attachment",document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(o),document.body.removeChild(t)}catch(n){console.error("Error downloading order attachment:",n),alert(n.message||"Nepoda\u0159ilo se st\xe1hnout p\u0159\xedlohu objedn\xe1vky")}},style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#f3f4f6",e.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:e=>{e.currentTarget.style.background="#f9fafb",e.currentTarget.style.borderColor="#e5e7eb"},title:"Klikn\u011bte pro sta\u017een\xed",children:[(0,V.jsx)(E.g,{icon:O.A4h,style:{color:"#6b7280",fontSize:"1.25rem"}}),(0,V.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,V.jsx)("div",{style:{fontSize:"0.9rem",color:"#374151",fontWeight:"500",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.originalni_nazev_souboru||e.nazev_souboru||"Nepojmenovan\xfd soubor"}),(0,V.jsx)("div",{style:{fontSize:"0.8rem",color:"#9ca3af",marginTop:"2px"},children:(e=>{if(!e||0===e)return"0 B";const n=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,n)*100)/100+" "+["B","KB","MB","GB"][n]})(e.velikost_souboru_b||e.velikost)})]}),(e=>{const n={FAKTURA:{bg:"#dbeafe",color:"#1e40af",label:"Faktura"},ISDOC:{bg:"#e0e7ff",color:"#4338ca",label:"ISDOC"},PRILOHA:{bg:"#f3e8ff",color:"#6b21a8",label:"P\u0159\xedloha"},SMLOUVA:{bg:"#fef3c7",color:"#92400e",label:"Smlouva"},OBJEDNAVKA:{bg:"#d1fae5",color:"#065f46",label:"Objedn\xe1vka"},IMPORT:{bg:"#fce7f3",color:"#9f1239",label:"Import"},JINE:{bg:"#f1f5f9",color:"#475569",label:"Jin\xe9"},JINA:{bg:"#f1f5f9",color:"#475569",label:"Jin\xe1"}},o=n[e]||n.JINA;return(0,V.jsx)(Q,{$bg:o.bg,$color:o.color,children:o.label})})(e.typ_prilohy||e.typ),(0,V.jsx)(E.g,{icon:O.cbP,style:{color:"#3b82f6",fontSize:"1rem",marginLeft:"0.5rem"}})]},e.id||n))}):(0,V.jsxs)(X,{children:["Po\u010det p\u0159\xedloh: ",(0,V.jsx)("strong",{children:b.prilohy_count})]})})]})]});var L});se.displayName="OrderFormReadOnly";const le=se;var de,ce,ue,pe,me,fe,ve,he,ge,xe,be,_e,ye,ke,je,we,ze,Ae;const Se=I.A.div(de||(de=(0,z.A)(["\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  height: 100%;\n  overflow-y: auto;\n"]))),Ce=I.A.div(ce||(ce=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding-bottom: 1rem;\n  border-bottom: 2px solid #e5e7eb;\n  margin-bottom: 1.5rem;\n"]))),Ie=I.A.div(ue||(ue=(0,z.A)(["\n  width: 48px;\n  height: 48px;\n  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 1.5rem;\n  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);\n"]))),Ee=I.A.div(pe||(pe=(0,z.A)(["\n  flex: 1;\n"]))),Oe=I.A.div(me||(me=(0,z.A)(["\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: #1e40af;\n  margin-bottom: 0.25rem;\n"]))),Ne=I.A.div(fe||(fe=(0,z.A)(["\n  font-size: 0.95rem;\n  color: #6b7280;\n  font-weight: 500;\n"]))),Te=I.A.div(ve||(ve=(0,z.A)(["\n  margin-bottom: 1.5rem;\n"]))),De=I.A.div(he||(he=(0,z.A)(["\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: #6b7280;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-bottom: 0.75rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),Re=I.A.div(ge||(ge=(0,z.A)(["\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 1rem;\n"]))),Pe=I.A.div(xe||(xe=(0,z.A)(["\n  background: #f9fafb;\n  padding: 0.875rem;\n  border-radius: 8px;\n  border: 1px solid #e5e7eb;\n"]))),$e=I.A.div(be||(be=(0,z.A)(["\n  font-size: 0.75rem;\n  color: #9ca3af;\n  margin-bottom: 0.25rem;\n  font-weight: 500;\n"]))),Me=I.A.div(_e||(_e=(0,z.A)(["\n  font-size: 0.95rem;\n  color: #1f2937;\n  font-weight: 600;\n"]))),Be=(0,I.A)(Pe)(ye||(ye=(0,z.A)(["\n  grid-column: 1 / -1;\n"]))),Le=I.A.div(ke||(ke=(0,z.A)(["\n  background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);\n  border: 2px solid #10b981;\n  border-radius: 12px;\n  padding: 1.25rem;\n  margin-bottom: 1.5rem;\n  text-align: center;\n"]))),Fe=I.A.div(je||(je=(0,z.A)(["\n  font-size: 0.85rem;\n  color: #065f46;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n"]))),Ve=I.A.div(we||(we=(0,z.A)(["\n  font-size: 2rem;\n  font-weight: 700;\n  color: #065f46;\n"]))),We=I.A.div(ze||(ze=(0,z.A)(["\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 0.5rem 1rem;\n  background: ",";\n  border: 2px solid ",";\n  border-radius: 8px;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: ",";\n"])),e=>e.$active?"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)":"linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%)",e=>e.$active?"#10b981":"#d1d5db",e=>e.$active?"#065f46":"#6b7280"),Ue=I.A.div(Ae||(Ae=(0,z.A)(["\n  padding: 3rem;\n  text-align: center;\n  color: #9ca3af;\n  font-size: 0.95rem;\n"]))),Ze=e=>e||0===e?new Intl.NumberFormat("cs-CZ",{style:"currency",currency:"CZK",minimumFractionDigits:2,maximumFractionDigits:2}).format(e):"\u2014",Je=e=>{if(!e)return"\u2014";try{return new Date(e).toLocaleDateString("cs-CZ")}catch(n){return e}},Ke=e=>{let{smlouvaData:n,loading:o}=e;const t=n;return o?(0,V.jsx)(Se,{children:(0,V.jsxs)(Ue,{children:[(0,V.jsx)(E.g,{icon:O.IJd,size:"3x",style:{marginBottom:"1rem",opacity:.3}}),(0,V.jsx)("div",{children:"Na\u010d\xedt\xe1m smlouvu..."})]})}):t?(0,V.jsxs)(Se,{children:[(0,V.jsxs)(Ce,{children:[(0,V.jsx)(Ie,{children:(0,V.jsx)(E.g,{icon:O.IJd})}),(0,V.jsxs)(Ee,{children:[(0,V.jsx)(Oe,{children:t.cislo_smlouvy||"Bez \u010d\xedsla"}),(0,V.jsx)(Ne,{children:t.nazev_smlouvy||t.nazev||"Smlouva"})]}),(1===t.pouzit_v_obj_formu||"1"===t.pouzit_v_obj_formu||!0===t.pouzit_v_obj_formu)&&(0,V.jsx)(We,{$active:!1,style:{background:"#dbeafe",color:"#1e40af",marginRight:"8px"},children:"FORM"}),(0,V.jsx)(We,{$active:1===t.aktivni||"1"===t.aktivni||!0===t.aktivni,children:1===t.aktivni||"1"===t.aktivni||!0===t.aktivni?"Aktivn\xed":"Neaktivn\xed"})]}),(0,V.jsxs)(Le,{children:[(0,V.jsxs)(Fe,{children:[(0,V.jsx)(E.g,{icon:O.ymQ})," Celkem pln\u011bn\xed s DPH"]}),(0,V.jsx)(Ve,{children:Ze(t.hodnota_s_dph||0)})]}),(0,V.jsxs)(Te,{children:[(0,V.jsxs)(De,{children:[(0,V.jsx)(E.g,{icon:O.URI}),"Dodavatel"]}),(0,V.jsxs)(Re,{children:[(0,V.jsxs)(Be,{children:[(0,V.jsx)($e,{children:"N\xe1zev"}),(0,V.jsx)(Me,{children:t.nazev_firmy||"\u2014"})]}),t.ico&&(0,V.jsxs)(Pe,{children:[(0,V.jsx)($e,{children:"I\u010cO"}),(0,V.jsx)(Me,{children:t.ico})]}),t.dic&&(0,V.jsxs)(Pe,{children:[(0,V.jsx)($e,{children:"DI\u010c"}),(0,V.jsx)(Me,{children:t.dic})]})]})]}),(0,V.jsxs)(Te,{children:[(0,V.jsxs)(De,{children:[(0,V.jsx)(E.g,{icon:O.okg}),"Term\xedny"]}),(0,V.jsxs)(Re,{children:[(t.datum_uzavreni||t.datum_podpisu||t.datum_uzavreni_smlouvy||t.dt_vytvoreni)&&(0,V.jsxs)(Pe,{children:[(0,V.jsx)($e,{children:"Datum importu"}),(0,V.jsx)(Me,{children:Je(t.datum_uzavreni||t.datum_podpisu||t.datum_uzavreni_smlouvy||t.dt_vytvoreni)})]}),(t.platnost_od||t.datum_od)&&(0,V.jsxs)(Pe,{children:[(0,V.jsx)($e,{children:"Platnost od"}),(0,V.jsx)(Me,{children:Je(t.platnost_od||t.datum_od)})]}),(t.platnost_do||t.datum_do)&&(()=>{const e=t.platnost_do||t.datum_do,n=e&&new Date(e)<new Date;return(0,V.jsxs)(Pe,{style:{background:n?"#fee2e2":"#d1fae5",border:"2px solid ".concat(n?"#dc2626":"#10b981")},children:[(0,V.jsx)($e,{style:{color:n?"#7f1d1d":"#065f46"},children:"Platnost do"}),(0,V.jsx)(Me,{style:{color:n?"#7f1d1d":"#065f46"},children:Je(e)})]})})(),(t.datum_ukonceni||t.ukonceni)&&(0,V.jsxs)(Pe,{children:[(0,V.jsx)($e,{children:"Datum ukon\u010den\xed"}),(0,V.jsx)(Me,{children:Je(t.datum_ukonceni||t.ukonceni)})]})]})]}),t.predmet&&(0,V.jsxs)(Te,{children:[(0,V.jsxs)(De,{children:[(0,V.jsx)(E.g,{icon:O.YEm}),"P\u0159edm\u011bt smlouvy"]}),(0,V.jsx)(Be,{children:(0,V.jsx)(Me,{style:{whiteSpace:"pre-wrap"},children:t.predmet})})]}),(void 0!==t.cerpano_celkem||void 0!==t.cerpano)&&(0,V.jsxs)(Te,{children:[(0,V.jsxs)(De,{children:[(0,V.jsx)(E.g,{icon:O.ymQ}),"\u010cerp\xe1n\xed"]}),(0,V.jsxs)(Re,{children:[(0,V.jsxs)(Pe,{children:[(0,V.jsx)($e,{children:"\u010cerp\xe1no"}),(0,V.jsx)(Me,{children:Ze(t.cerpano_celkem||t.cerpano||0)})]}),(0,V.jsxs)(Pe,{children:[(0,V.jsx)($e,{children:"Zb\xfdv\xe1"}),(0,V.jsx)(Me,{children:Ze((t.hodnota_s_dph||t.celkova_castka||0)-(t.cerpano_celkem||t.cerpano||0))})]})]})]}),t.poznamka&&(0,V.jsxs)(Te,{children:[(0,V.jsx)(De,{children:"Pozn\xe1mka"}),(0,V.jsx)(Be,{children:(0,V.jsx)(Me,{style:{whiteSpace:"pre-wrap",fontSize:"0.875rem"},children:t.poznamka})})]})]}):(0,V.jsx)(Se,{children:(0,V.jsxs)(Ue,{children:[(0,V.jsx)(E.g,{icon:O.IJd,size:"3x",style:{marginBottom:"1rem",opacity:.3}}),(0,V.jsx)("div",{children:"\u017d\xe1dn\xe1 smlouva nen\xed vybr\xe1na"})]})})};var He,Ye,Ge,qe,Xe,Qe,en,nn,on,tn,rn,an=o(32575),sn=o(63974),ln=o(51833),dn=o(39292),cn=o(90087),un=o(43548),pn=o(56099),mn=o(24749),fn=o(29521),vn=o(77819),hn=o(40614);const gn=I.A.div(He||(He=(0,z.A)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 100010;\n  animation: fadeIn 0.2s ease;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n"]))),xn=I.A.div(Ye||(Ye=(0,z.A)(["\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);\n  max-width: 500px;\n  width: 90%;\n  max-height: 80vh;\n  overflow: hidden;\n  animation: slideIn 0.3s ease;\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(-20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n"]))),bn=I.A.div(Ge||(Ge=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 20px 24px;\n  border-bottom: 1px solid #e5e7eb;\n  background: linear-gradient(135deg, #dc2626, #991b1b);\n  color: white;\n"]))),_n=I.A.div(qe||(qe=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 40px;\n  height: 40px;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 50%;\n  flex-shrink: 0;\n"]))),yn=I.A.h2(Xe||(Xe=(0,z.A)(["\n  font-size: 1.25rem;\n  font-weight: 600;\n  margin: 0;\n  flex: 1;\n"]))),kn=I.A.button(Qe||(Qe=(0,z.A)(["\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  flex-shrink: 0;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.3);\n  }\n"]))),jn=I.A.div(en||(en=(0,z.A)(["\n  padding: 24px;\n  max-height: 60vh;\n  overflow-y: auto;\n"]))),wn=I.A.div(nn||(nn=(0,z.A)(["\n  font-size: 0.95rem;\n  line-height: 1.6;\n  color: #374151;\n  white-space: pre-wrap;\n  word-break: break-word;\n"]))),zn=I.A.details(on||(on=(0,z.A)(["\n  margin-top: 16px;\n  padding: 12px;\n  background: #f9fafb;\n  border-radius: 6px;\n  font-size: 0.85rem;\n  color: #6b7280;\n  cursor: pointer;\n\n  summary {\n    font-weight: 600;\n    user-select: none;\n    outline: none;\n  }\n\n  pre {\n    margin-top: 8px;\n    padding: 8px;\n    background: #1f2937;\n    color: #f3f4f6;\n    border-radius: 4px;\n    overflow-x: auto;\n    font-size: 0.75rem;\n    line-height: 1.4;\n  }\n"]))),An=I.A.div(tn||(tn=(0,z.A)(["\n  padding: 16px 24px;\n  border-top: 1px solid #e5e7eb;\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n"]))),Sn=I.A.button(rn||(rn=(0,z.A)(["\n  padding: 10px 20px;\n  border-radius: 6px;\n  font-weight: 600;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n  \n  ","\n"])),e=>e.primary?"\n    background: #dc2626;\n    color: white;\n    \n    &:hover {\n      background: #b91c1c;\n    }\n  ":"\n    background: #f3f4f6;\n    color: #374151;\n    \n    &:hover {\n      background: #e5e7eb;\n    }\n  "),Cn=e=>{let{isOpen:n,title:o="Chyba",message:t,details:r=null,onClose:a,onConfirm:i=null,confirmText:s="OK",cancelText:l="Zru\u0161it"}=e;if(!n)return null;return S.createPortal((0,V.jsx)(gn,{onClick:e=>{e.target===e.currentTarget&&a()},children:(0,V.jsxs)(xn,{children:[(0,V.jsxs)(bn,{children:[(0,V.jsx)(_n,{children:(0,V.jsx)(vn.A,{size:24})}),(0,V.jsx)(yn,{children:o}),(0,V.jsx)(kn,{onClick:a,children:(0,V.jsx)(hn.A,{size:18})})]}),(0,V.jsxs)(jn,{children:[(0,V.jsx)(wn,{children:t}),r&&(0,V.jsxs)(zn,{children:[(0,V.jsx)("summary",{children:"Technick\xe9 detaily"}),(0,V.jsx)("pre",{children:r})]})]}),(0,V.jsx)(An,{children:i?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(Sn,{onClick:a,children:l}),(0,V.jsx)(Sn,{primary:!0,onClick:i,children:s})]}):(0,V.jsx)(Sn,{primary:!0,onClick:a,children:s})})]})}),document.body)};const In=o(56263).A.create({baseURL:"https://erdms.zachranka.cz/api.eeo/",headers:{"Content-Type":"application/json"}});function En(e){var n,o,t,r,a,i;return null!==(n=e.response)&&void 0!==n&&null!==(o=n.data)&&void 0!==o&&o.message?e.response.data.message:null!==(t=e.response)&&void 0!==t&&null!==(r=t.data)&&void 0!==r&&r.error?e.response.data.error:null!==(a=e.response)&&void 0!==a&&null!==(i=a.data)&&void 0!==i&&i.err?e.response.data.err:e.message?e.message:"Nezn\xe1m\xe1 chyba"}async function On(e){let{username:n,token:o,uzivatel_id:t=null,stav:r=null,datum_od:a=null,datum_do:i=null,limit:s=100,offset:l=0}=e;try{return(await In.post("/spisovka-zpracovani/list",{username:n,token:o,uzivatel_id:t,stav:r,datum_od:a,datum_do:i,limit:s,offset:l})).data}catch(d){throw new Error(En(d))}}async function Nn(e){let{username:n,token:o,dokument_id:t,spisovka_priloha_id:r=null,faktura_id:a=null,fa_cislo_vema:i=null,stav:s="ZAEVIDOVANO",poznamka:l=null,doba_zpracovani_s:d=null,force:c=!1}=e;try{return{success:!0,data:(await In.post("/spisovka-zpracovani/mark",{username:n,token:o,dokument_id:t,spisovka_priloha_id:r,faktura_id:a,fa_cislo_vema:i,stav:s,poznamka:l,doba_zpracovani_s:d,force:c})).data}}catch(h){var u,p,m,f,v;if(409===(null===(u=h.response)||void 0===u?void 0:u.status))return{success:!1,conflict:!0,message:(null===(p=h.response)||void 0===p||null===(m=p.data)||void 0===m?void 0:m.message)||"Dokument ji\u017e byl zpracov\xe1n",existingRecord:(null===(f=h.response)||void 0===f||null===(v=f.data)||void 0===v?void 0:v.existing)||null};throw new Error(En(h))}}async function Tn(e){let{username:n,token:o,dokument_id:t}=e;try{if(!t)throw new Error("dokument_id je povinn\xfd parametr");return(await In.post("/spisovka-zpracovani/delete",{username:n,token:o,dokument_id:t})).data}catch(r){throw new Error(En(r))}}In.interceptors.response.use(e=>e,e=>{var n,o,t;if((401===(null===(n=e.response)||void 0===n?void 0:n.status)||403===(null===(o=e.response)||void 0===o?void 0:o.status))&&"undefined"!==typeof window){const e=new CustomEvent("authError",{detail:{message:"Va\u0161e p\u0159ihl\xe1\u0161en\xed vypr\u0161elo. P\u0159ihlaste se pros\xedm znovu."}});window.dispatchEvent(e)}const r=(null===(t=e.response)||void 0===t?void 0:t.data)||"";if("string"===typeof r&&r.includes("<!doctype")&&"undefined"!==typeof window){const e=new CustomEvent("authError",{detail:{message:"Va\u0161e p\u0159ihl\xe1\u0161en\xed vypr\u0161elo. Obnovte str\xe1nku a p\u0159ihlaste se znovu."}});window.dispatchEvent(e)}return Promise.reject(e)});var Dn,Rn,Pn,$n,Mn,Bn,Ln,Fn,Vn,Wn,Un,Zn,Jn,Kn,Hn,Yn,Gn,qn,Xn,Qn,eo,no,oo,to,ro,ao,io,so,lo,co,uo,po,mo,fo,vo;if("undefined"!==typeof document&&!document.getElementById("spisovka-pulse-animation")){const e=document.createElement("style");e.id="spisovka-pulse-animation",e.textContent="\n  @keyframes pulse {\n    0%, 100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n    50% {\n      opacity: 0.5;\n      transform: scale(1.2);\n    }\n  }\n",document.head.appendChild(e)}const ho=I.A.div(Dn||(Dn=(0,z.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  flex: 1;\n  min-height: 0;\n  /* \u017d\xe1dn\xe1 min-width - panel si ur\u010duje \u0161\xed\u0159ku s\xe1m */\n"]))),go=I.A.div(Rn||(Rn=(0,z.A)(["\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  padding: 0.875rem 1rem;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.25);\n  margin-bottom: 0.75rem;\n"]))),xo=I.A.div(Pn||(Pn=(0,z.A)(["\n  font-size: 0.95rem;\n  font-weight: 700;\n  color: white;\n  letter-spacing: 0.3px;\n  display: flex;\n  alignItems: 'center';\n  gap: 0.625rem;\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n"]))),bo=I.A.div($n||($n=(0,z.A)(["\n  font-size: 0.8rem;\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: 600;\n  background: rgba(255, 255, 255, 0.15);\n  padding: 0.25rem 0.625rem;\n  border-radius: 12px;\n"]))),_o=I.A.div(Mn||(Mn=(0,z.A)(["\n  flex: 1;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  padding: 0.5rem;\n  background: #f9fafb;\n  border-radius: 8px;\n  min-height: 0;\n  border: 1px solid #e5e7eb;\n\n  scrollbar-width: thin;\n  scrollbar-color: #10b981 #f3f4f6;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f3f4f6;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: linear-gradient(135deg, #10b981, #059669);\n    border-radius: 5px;\n    border: 2px solid #f9fafb;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: linear-gradient(135deg, #059669, #047857);\n  }\n"]))),yo=I.A.div(Bn||(Bn=(0,z.A)(["\n  display: inline-flex;\n  align-items: center;\n  gap: 0.4rem;\n  padding: 0.25rem 0.625rem;\n  border-radius: 12px;\n  font-size: 0.65rem;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  \n  ","\n"])),e=>{switch(e.$status){case"ZAEVIDOVANO":return"\n          background: #d1fae5;\n          color: #065f46;\n          border: 1px solid #10b981;\n        ";case"NENI_FAKTURA":return"\n          background: #fef3c7;\n          color: #92400e;\n          border: 1px solid #f59e0b;\n        ";case"CHYBA":return"\n          background: #fee2e2;\n          color: #991b1b;\n          border: 1px solid #ef4444;\n        ";case"DUPLIKAT":return"\n          background: #e0e7ff;\n          color: #3730a3;\n          border: 1px solid #6366f1;\n        ";default:return"\n          background: #f3f4f6;\n          color: #6b7280;\n          border: 1px solid #d1d5db;\n        "}}),ko=I.A.div(Ln||(Ln=(0,z.A)(["\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 10px;\n  padding: 1rem;\n  transition: all 0.2s ease;\n  cursor: pointer;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n\n  &:hover {\n    background: #f0fdf4;\n    border-color: #10b981;\n    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);\n    transform: translateY(-2px);\n  }\n"]))),jo=I.A.div(Fn||(Fn=(0,z.A)(["\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n"]))),wo=I.A.div(Vn||(Vn=(0,z.A)(["\n  font-size: 0.875rem;\n  font-weight: 700;\n  color: #1f2937;\n  line-height: 1.3;\n  flex: 1;\n"]))),zo=I.A.div(Wn||(Wn=(0,z.A)(["\n  font-size: 0.7rem;\n  color: #059669;\n  font-family: 'Courier New', monospace;\n  background: #d1fae5;\n  padding: 0.3rem 0.6rem;\n  border-radius: 5px;\n  white-space: nowrap;\n  font-weight: 600;\n"]))),Ao=I.A.div(Un||(Un=(0,z.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 0.4rem;\n  font-size: 0.75rem;\n  color: #4b5563;\n"]))),So=I.A.div(Zn||(Zn=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n"]))),Co=I.A.span(Jn||(Jn=(0,z.A)(["\n  color: #6b7280;\n  font-weight: 700;\n"]))),Io=I.A.span(Kn||(Kn=(0,z.A)(["\n  color: #374151;\n  font-weight: 500;\n"]))),Eo=I.A.div(Hn||(Hn=(0,z.A)(["\n  margin-top: 0.75rem;\n  padding-top: 0.75rem;\n  border-top: 2px solid #e5e7eb;\n"]))),Oo=I.A.div(Yn||(Yn=(0,z.A)(["\n  font-size: 0.75rem;\n  color: #6b7280;\n  font-weight: 700;\n  margin-bottom: 0.5rem;\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n"]))),No=I.A.div(Gn||(Gn=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0.65rem;\n  background: #f9fafb;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  margin-bottom: 0.4rem;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f0fdf4;\n    border-color: #10b981;\n  }\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n"]))),To=I.A.div(qn||(qn=(0,z.A)(["\n  flex: 1;\n  min-width: 0;\n"]))),Do=I.A.div(Xn||(Xn=(0,z.A)(["\n  font-size: 0.75rem;\n  color: #1f2937;\n  font-weight: 600;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),Ro=I.A.div(Qn||(Qn=(0,z.A)(["\n  font-size: 0.65rem;\n  color: #6b7280;\n  margin-top: 0.2rem;\n"]))),Po=I.A.a(eo||(eo=(0,z.A)(["\n  display: inline-flex;\n  align-items: center;\n  gap: 0.4rem;\n  padding: 0.5rem 0.75rem;\n  background: #10b981;\n  color: white;\n  border-radius: 6px;\n  text-decoration: none;\n  font-size: 0.7rem;\n  font-weight: 600;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n\n  &:hover {\n    background: #059669;\n    transform: translateY(-1px);\n    box-shadow: 0 4px 8px rgba(16, 185, 129, 0.25);\n  }\n\n  svg {\n    font-size: 0.75rem;\n  }\n"]))),$o=I.A.div(no||(no=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2.5rem;\n  color: #6b7280;\n  font-size: 0.875rem;\n  gap: 0.75rem;\n"]))),Mo=I.A.div(oo||(oo=(0,z.A)(["\n  background: #fef2f2;\n  border: 2px solid #fca5a5;\n  border-radius: 8px;\n  padding: 1rem;\n  color: #dc2626;\n  font-size: 0.8rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n"]))),Bo=I.A.div(to||(to=(0,z.A)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem 1.5rem;\n  color: #9ca3af;\n  font-size: 0.875rem;\n  text-align: center;\n  gap: 0.75rem;\n  opacity: 0.8;\n"]))),Lo=I.A.button(ro||(ro=(0,z.A)(["\n  background: white;\n  border: 2px solid #e5e7eb;\n  color: #6b7280;\n  padding: 0.5rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.75rem;\n  font-weight: 600;\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.2s ease;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n\n  &:hover {\n    background: #f0fdf4;\n    border-color: #10b981;\n    color: #10b981;\n    box-shadow: 0 2px 6px rgba(16, 185, 129, 0.15);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"]))),Fo=I.A.div(ao||(ao=(0,z.A)(["\n  position: fixed;\n  top: ","px;\n  left: ","px;\n  width: ","px;\n  height: ","px;\n  background: white;\n  border-radius: 12px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);\n  z-index: 100002;\n  resize: both;\n  min-width: 400px;\n  min-height: 300px;\n"])),e=>e.y||50,e=>e.x||window.innerWidth/2,e=>e.w||window.innerWidth/2-40,e=>e.h||window.innerHeight-100),Vo=I.A.div(io||(io=(0,z.A)(["\n  width: 100%;\n  height: 100%;\n  background: white;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n"]))),Wo=I.A.div(so||(so=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1rem 1.5rem;\n  background: linear-gradient(135deg, #10b981, #059669);\n  color: white;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n"]))),Uo=I.A.div(lo||(lo=(0,z.A)(["\n  font-size: 1rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n"]))),Zo=I.A.button(co||(co=(0,z.A)(["\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.3);\n  }\n"]))),Jo=(I.A.iframe(uo||(uo=(0,z.A)(["\n  flex: 1;\n  border: none;\n  width: 100%;\n  height: 100%;\n"]))),I.A.object(po||(po=(0,z.A)(["\n  flex: 1;\n  border: none;\n  width: 100%;\n  height: 100%;\n"])))),Ko=I.A.div(mo||(mo=(0,z.A)(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n  padding: 2rem;\n  background: #f8fafc;\n  color: #334155;\n"]))),Ho=I.A.a(fo||(fo=(0,z.A)(["\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1.5rem;\n  background: #10b981;\n  color: white;\n  border-radius: 8px;\n  text-decoration: none;\n  font-weight: 600;\n  transition: all 0.2s ease;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n\n  &:hover {\n    background: #059669;\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(16, 185, 129, 0.3);\n  }\n"]))),Yo=I.A.pre(vo||(vo=(0,z.A)(["\n  flex: 1;\n  overflow: auto;\n  padding: 2rem;\n  margin: 0;\n  font-family: 'Courier New', monospace;\n  font-size: 0.875rem;\n  line-height: 1.6;\n  background: #f9fafb;\n  color: #1f2937;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  border: 1px solid #e5e7eb;\n\n  scrollbar-width: thin;\n  scrollbar-color: #10b981 #f9fafb;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f9fafb;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: linear-gradient(180deg, #10b981, #059669);\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: linear-gradient(180deg, #059669, #047857);\n  }\n"]))),Go=e=>{let{panelState:n,setPanelState:o,beginDrag:t,onClose:r,onOCRDataExtracted:a,token:i,username:s,showToast:l}=e;const[d,c]=(0,A.useState)([]),[u,p]=(0,A.useState)(!1),[m,f]=(0,A.useState)(null),[v,h]=(0,A.useState)({total:0,limit:1e3,offset:0}),[g,x]=(0,A.useState)(new Set),[b,_]=(0,A.useState)(new Map),[y,k]=(0,A.useState)("nezaevidovane"),[j,z]=(0,A.useState)((new Date).getFullYear()),[C,I]=(0,A.useState)("dnes"),[N,T]=(0,A.useState)(null),[D,R]=(0,A.useState)(new Set),[P,$]=(0,A.useState)({visible:!1,url:"",filename:"",type:"",content:""}),[M,B]=(0,A.useState)({visible:!1,progress:0,message:""}),[L,F]=(0,A.useState)(()=>({x:window.innerWidth/2,y:50,w:window.innerWidth/2-40,h:window.innerHeight-100})),[W,U]=(0,A.useState)(!1),[Z,J]=(0,A.useState)({isOpen:!1,title:"",message:"",details:null,onConfirm:null}),K=(0,A.useCallback)(e=>{W&&(e.preventDefault(),F(n=>(0,w.A)((0,w.A)({},n),{},{x:e.clientX-200,y:e.clientY-20})))},[W]),H=(0,A.useCallback)(()=>{U(!1)},[]);(0,A.useEffect)(()=>{if(W)return window.addEventListener("mousemove",K),window.addEventListener("mouseup",H),()=>{window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",H)}},[W,K,H]);const Y=(0,A.useCallback)((e,n)=>{const o=new Date,t=n||o.getFullYear();let r,a;switch(e){case"dnes":r=new Date(o.getFullYear(),o.getMonth(),o.getDate()),a=new Date(o.getFullYear(),o.getMonth(),o.getDate(),23,59,59);break;case"tyden":const e=new Date(o);e.setDate(o.getDate()-7),r=e,a=o;break;case"mesic":const n=new Date(o);n.setMonth(o.getMonth()-1),r=n,a=o;break;case"kvartal":const i=new Date(o);i.setMonth(o.getMonth()-3),r=i,a=o;break;case"rok":r=new Date(t,0,1),a=new Date(t,11,31,23,59,59);break;default:r=new Date(o.getFullYear(),o.getMonth(),o.getDate()),a=o}return{dateFrom:r.toISOString().split("T")[0],dateTo:a.toISOString().split("T")[0]}},[]),G=(0,A.useCallback)(async()=>{try{if(!i||!s)return void console.warn("\u26a0\ufe0f Token nebo username chyb\xed - nelze na\u010d\xedst zpracovan\xe9 dokumenty");const e=await On({username:s,token:i,limit:1e3,offset:0});if("ok"===e.status&&e.data){const n=new Set(e.data.map(e=>e.dokument_id));x(n);const o=new Map;e.data.forEach(e=>{o.set(e.dokument_id,{uzivatel_jmeno:e.uzivatel_jmeno||"Nezn\xe1m\xfd",zpracovano_kdy:e.zpracovano_kdy,fa_cislo_vema:e.fa_cislo_vema,faktura_id:e.faktura_id,stav:e.stav})}),_(o)}}catch(e){console.warn("\u26a0\ufe0f Nepoda\u0159ilo se na\u010d\xedst zpracovan\xe9 dokumenty:",e)}},[i,s]),q=(0,A.useCallback)(async(e,n,o)=>{J({isOpen:!0,title:"\ud83d\uddd1\ufe0f Zru\u0161it zpracov\xe1n\xed dokumentu",message:(0,V.jsxs)("div",{style:{fontFamily:"system-ui",lineHeight:"1.6"},children:[(0,V.jsx)("p",{style:{marginBottom:"12px"},children:"Chcete zru\u0161it zpracov\xe1n\xed tohoto dokumentu ze Spisovky?"}),o&&(0,V.jsxs)("div",{style:{padding:"12px",backgroundColor:"#fef3c7",borderRadius:"6px",fontSize:"13px",marginBottom:"12px"},children:[(0,V.jsxs)("div",{children:[(0,V.jsx)("strong",{children:"Zaevidovan\xe1 faktura:"})," ",o]}),n&&(0,V.jsxs)("div",{style:{fontSize:"12px",color:"#78716c",marginTop:"4px"},children:["ID: ",n]})]}),(0,V.jsx)("p",{style:{marginBottom:"8px",fontWeight:600,color:"#dc2626"},children:"\u26a0\ufe0f Pozor: Toto pouze odstran\xed vazbu mezi dokumentem a fakturou."}),(0,V.jsx)("p",{style:{fontSize:"13px",color:"#6b7280"},children:"Fakturu m\u016f\u017eete smazat ru\u010dn\u011b z formul\xe1\u0159e editace faktury."})]}),onConfirm:async()=>{try{await Tn({username:s,token:i,dokument_id:e}),N===e&&(localStorage.removeItem("spisovka_active_dokument"),T(null)),await G(),l&&l("\u2705 Evidence zru\u0161ena",{type:"success"}),J({isOpen:!1,title:"",message:"",details:null,onConfirm:null})}catch(n){l&&l("\u274c Chyba: ".concat(n.message),{type:"error"}),J({isOpen:!1,title:"",message:"",details:null,onConfirm:null})}}})},[s,i,N,G,l,T,J]),X=(0,A.useCallback)(async()=>{p(!0),f(null);try{const e="".concat("https://erdms.zachranka.cz/api.eeo/","spisovka.php/faktury?limit=").concat(v.limit,"&offset=").concat(v.offset,"&rok=").concat(j),n=await fetch(e);if(!n.ok)throw new Error("HTTP error! status: ".concat(n.status));const o=await n.json();if("success"!==o.status)throw new Error(o.message||"Nepoda\u0159ilo se na\u010d\xedst faktury");c(o.data),h(e=>{var n;return(0,w.A)((0,w.A)({},e),{},{total:(null===(n=o.pagination)||void 0===n?void 0:n.total)||o.data.length})}),G()}catch(e){f(e.message),console.error("Chyba p\u0159i na\u010d\xedt\xe1n\xed faktur ze spisovky:",e)}finally{p(!1)}},[v.limit,v.offset,j,G,i,s]);(0,A.useEffect)(()=>{X()},[j]),(0,A.useEffect)(()=>{const e=setInterval(()=>{console.log("\ud83d\udd04 Spisovka auto-refresh (5 minut)"),X()},3e5);return()=>clearInterval(e)},[X]),(0,A.useEffect)(()=>{const e=()=>{const e=localStorage.getItem("spisovka_active_dokument"),n=e?parseInt(e,10):null;T(n)};e();const n=setInterval(e,500);return()=>clearInterval(n)},[]),(0,A.useEffect)(()=>{if(N&&d.length>0){const e=setTimeout(()=>{const e=document.querySelector('[data-section="dokument-'.concat(N,'"]'));e?(console.log("\ud83d\udcdc Scrolling to active document:",N),e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})):console.log("\u26a0\ufe0f Active document element not found:",N)},300);return()=>clearTimeout(e)}},[N,d]);const Q=e=>{if(!e)return"-";return new Date(e).toLocaleString("cs-CZ",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})},ee={left:"".concat(n.x,"px"),top:"".concat(n.y,"px"),width:"".concat(n.w,"px"),height:"".concat(n.h,"px"),minWidth:"320px",minHeight:"200px",maxHeight:"90vh"};return S.createPortal((0,V.jsxs)(mn.yW,{style:ee,children:[(0,mn.Jr)(t,"spisovkaInbox"),(0,V.jsxs)(mn.aO,{onMouseDown:e=>t(e,"spisovkaInbox","move"),style:{cursor:"move"},children:[(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:[(0,V.jsx)(E.g,{icon:O.ReK,style:{color:"#1f2937"}}),"Spisovka Inbox"]}),(0,V.jsxs)("div",{style:{display:"flex",gap:"0.3rem"},children:[(0,V.jsx)(mn.PJ,{onClick:()=>{X(),G()},title:"Obnovit data (Spisovka + Tracking)",style:{opacity:u?.5:1},children:(0,V.jsx)(E.g,{icon:O.VNe,spin:u})}),(0,V.jsx)(mn.PJ,{onClick:()=>{let e=n.w;const t=Array.from(document.querySelectorAll("div")).filter(e=>e.textContent.includes("N\xe1hled")&&e.style.width&&e.parentElement);if(t.length>0){let n=t[0].parentElement;for(;n&&(null===(r=n.style.width)||void 0===r||!r.includes("%"));){var r;n=n.parentElement}if(n){const o=n.getBoundingClientRect().width;e=Math.max(o,620)}}e===n.w&&(e=Math.max(Math.floor(.45*window.innerWidth),620)),o(n=>(0,w.A)((0,w.A)({},n),{},{x:window.innerWidth-e,y:144,w:e,h:window.innerHeight-144-54,minimized:!1}))},title:"Zarovnat doprava (cel\xe1 v\xfd\u0161ka)",children:(0,V.jsx)(E.g,{icon:O.oZK})}),(0,V.jsx)(mn.PJ,{onClick:()=>{r&&r()},title:n.minimized?"Obnovit":"Minimalizovat",children:(0,V.jsx)(E.g,{icon:n.minimized?O.aFw:O.EZy})}),(0,V.jsx)(mn.PJ,{onClick:()=>{r&&r()},title:"Zav\u0159\xedt",children:(0,V.jsx)(E.g,{icon:O.GRI})})]})]}),!n.minimized&&(()=>{const{dateFrom:e,dateTo:n}=Y(C,j),o=new Date(e).getTime(),t=new Date(n+" 23:59:59").getTime(),r=d.filter(e=>{const n=new Date(e.datum_vzniku).getTime();if(n<o||n>t)return!1;const r=g.has(e.dokument_id);return"nezaevidovane"===y?!r:"zaevidovane"!==y||r}).length;return(0,V.jsxs)(ho,{children:[(0,V.jsxs)(go,{children:[(0,V.jsxs)(xo,{children:[(0,V.jsx)(E.g,{icon:O.ReK}),"Faktury"]}),(0,V.jsxs)(bo,{children:[r," / ",v.total," celkem"]})]}),(0,V.jsxs)("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",borderBottom:"1px solid #bae6fd",alignItems:"center",flexWrap:"wrap"},children:[(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,V.jsx)("span",{style:{fontSize:"0.85rem",color:"#0369a1",fontWeight:600},children:"Rok:"}),(0,V.jsx)("select",{value:j,onChange:e=>z(parseInt(e.target.value)),style:{padding:"0.4rem 0.75rem",borderRadius:"6px",border:"2px solid #0284c7",background:"white",color:"#0c4a6e",fontSize:"0.85rem",fontWeight:600,cursor:"pointer"},children:(()=>{const e=[];for(let n=(new Date).getFullYear();n>=2025;n--)e.push(n);return e.map(e=>(0,V.jsx)("option",{value:e,children:e},e))})()})]}),(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flex:1},children:[(0,V.jsx)("span",{style:{fontSize:"0.85rem",color:"#0369a1",fontWeight:600},children:"Obdob\xed:"}),["dnes","tyden","mesic","kvartal","rok"].map(e=>(0,V.jsxs)("button",{onClick:()=>I(e),style:{padding:"0.4rem 0.75rem",borderRadius:"6px",border:C===e?"2px solid #0284c7":"1px solid #94a3b8",background:C===e?"#e0f2fe":"white",color:C===e?"#0c4a6e":"#64748b",fontSize:"0.8rem",fontWeight:C===e?600:500,cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},onMouseEnter:n=>{C!==e&&(n.currentTarget.style.borderColor="#0284c7",n.currentTarget.style.color="#0c4a6e")},onMouseLeave:n=>{C!==e&&(n.currentTarget.style.borderColor="#94a3b8",n.currentTarget.style.color="#64748b")},children:["dnes"===e&&"Dnes","tyden"===e&&"T\xfdden zp\u011bt","mesic"===e&&"M\u011bs\xedc zp\u011bt","kvartal"===e&&"Kvart\xe1l zp\u011bt","rok"===e&&"Cel\xfd rok"]},e))]})]}),(0,V.jsxs)("div",{style:{display:"flex",gap:"0.5rem",padding:"0.75rem 1rem",background:"#f9fafb",borderBottom:"1px solid #e5e7eb",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,V.jsx)("span",{style:{fontSize:"0.85rem",color:"#6b7280",fontWeight:600},children:"Zobrazit:"}),["vse","nezaevidovane","zaevidovane"].map(e=>(0,V.jsxs)("button",{onClick:()=>k(e),style:{padding:"0.4rem 0.75rem",borderRadius:"6px",border:y===e?"2px solid #10b981":"1px solid #d1d5db",background:y===e?"#ecfdf5":"white",color:y===e?"#059669":"#6b7280",fontSize:"0.8rem",fontWeight:y===e?600:500,cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},onMouseEnter:n=>{y!==e&&(n.currentTarget.style.borderColor="#10b981",n.currentTarget.style.color="#059669")},onMouseLeave:n=>{y!==e&&(n.currentTarget.style.borderColor="#d1d5db",n.currentTarget.style.color="#6b7280")},children:["vse"===e&&"V\u0161e","nezaevidovane"===e&&"Nezaevidovan\xe9 (".concat(d.filter(e=>!g.has(e.dokument_id)).length,")"),"zaevidovane"===e&&"Zaevidovan\xe9 (".concat(g.size,")")]},e))]}),N&&(0,V.jsx)("button",{onClick:()=>{const e=document.querySelector('[data-section="dokument-'.concat(N,'"]'));e&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",background:"rgba(59, 130, 246, 0.15)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"6px",color:"#1e40af",fontSize:"16px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(59, 130, 246, 0.25)",e.currentTarget.style.borderColor="rgba(59, 130, 246, 0.5)",e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(59, 130, 246, 0.15)",e.currentTarget.style.borderColor="rgba(59, 130, 246, 0.3)",e.currentTarget.style.transform="scale(1)"},title:"Jdi na fakturu, se kterou pr\xe1v\u011b pracuji",children:"\u26a1"})]}),u&&(0,V.jsxs)($o,{children:[(0,V.jsx)(E.g,{icon:O.z1G,spin:!0}),"Na\u010d\xedt\xe1m faktury..."]}),m&&(0,V.jsxs)(Mo,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),"Chyba: ",m,(0,V.jsxs)(Lo,{onClick:X,disabled:u,children:[(0,V.jsx)(E.g,{icon:O.VNe}),"Zkusit znovu"]})]}),!u&&!m&&0===d.length&&(0,V.jsxs)(Bo,{children:[(0,V.jsx)(E.g,{icon:O.ReK,size:"2x"}),"\u017d\xe1dn\xe9 faktury k zobrazen\xed"]}),!u&&!m&&d.length>0&&(()=>{const{dateFrom:e,dateTo:n}=Y(C,j),o=new Date(e).getTime(),t=new Date(n+" 23:59:59").getTime(),r=d.filter(e=>{const n=(e.nazev||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(!(/faktur[a\xe1u\xfa]|fa[\s\.]*(c|\u010d)[\s\.]?|fak[\s\.]*(c|\u010d)[\s\.]?|^fa\s/i.test(n)||/faktur[a\xe1u\xfa]|fa[\s\.]*(c|\u010d)[\s\.]?|fak[\s\.]*(c|\u010d)[\s\.]?|^fa\s/i.test(e.nazev||"")))return!1;const r=new Date(e.datum_vzniku).getTime();if(r<o||r>t)return!1;const a=g.has(e.dokument_id);return"nezaevidovane"===y?!a:"zaevidovane"!==y||a});return 0===r.length?(0,V.jsxs)(Bo,{children:[(0,V.jsx)(E.g,{icon:O.ReK,size:"2x"}),"nezaevidovane"===y&&"V\u0161echny faktury jsou zaevidovan\xe9 \u2713","zaevidovane"===y&&"Zat\xedm \u017e\xe1dn\xe9 zaevidovan\xe9 faktury"]}):(0,V.jsx)(_o,{children:r.map(e=>{const n=N===e.dokument_id,o=N&&!n;return(0,V.jsxs)(ko,{"data-section":"dokument-".concat(e.dokument_id),style:{opacity:o?.4:1,transition:"opacity 0.3s ease",position:"relative"},children:[n&&(0,V.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,height:"4px",background:"linear-gradient(90deg, #3b82f6, #60a5fa)",borderRadius:"6px 6px 0 0",zIndex:1}}),n&&(0,V.jsxs)("div",{style:{padding:"6px 12px",marginBottom:"12px",background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",borderBottom:"1px solid #93c5fd",display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",fontWeight:600,color:"#1e40af"},children:[(0,V.jsx)("span",{style:{fontSize:"16px"},children:"\u26a1"}),(0,V.jsx)("span",{children:"Pr\xe1v\u011b pracuji s touto fakturou"}),(0,V.jsx)("div",{style:{marginLeft:"auto",width:"8px",height:"8px",borderRadius:"50%",background:"#3b82f6",animation:"pulse 2s infinite"}})]}),(0,V.jsx)(jo,{draggable:e.prilohy&&e.prilohy.length>0,onDragStart:n=>{if(e.prilohy&&e.prilohy.length>0){n.stopPropagation(),n.currentTarget.style.cursor="grabbing",n.currentTarget.style.opacity="0.6";const o=e.prilohy.map(n=>({url:n.download_url,filename:n.filename,mime_type:n.mime_type||"application/octet-stream",spisovka_dokument_id:e.dokument_id,spisovka_file_id:n.file_id||n.priloha_id}));n.dataTransfer.setData("text/spisovka-attachments",JSON.stringify(o)),n.dataTransfer.effectAllowed="copy"}},onDragEnd:n=>{n.stopPropagation(),n.currentTarget.style.cursor=e.prilohy&&e.prilohy.length>0?"grab":"default",n.currentTarget.style.opacity="1"},style:{cursor:e.prilohy&&e.prilohy.length>0?"grab":"default"},title:e.prilohy&&e.prilohy.length>0?"P\u0159et\xe1hn\u011bte hlavi\u010dku pro nahr\xe1n\xed v\u0161ech ".concat(e.prilohy.length," p\u0159\xedloh"):"",children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",flex:1},children:[(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",justifyContent:"space-between"},children:[(0,V.jsx)(wo,{children:e.nazev}),(0,V.jsxs)(zo,{children:["#",e.dokument_id]})]}),g.has(e.dokument_id)&&(0,V.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,V.jsx)(yo,{$status:"ZAEVIDOVANO",children:"\u2713 Zaevidov\xe1no"})})]})}),(0,V.jsxs)(Ao,{children:[(0,V.jsxs)(So,{children:[(0,V.jsx)(Co,{children:"JID:"}),(0,V.jsx)(Io,{children:e.jid})]}),(0,V.jsxs)(So,{children:[(0,V.jsx)(Co,{children:"\u010c\xedslo jednac\xed:"}),(0,V.jsx)(Io,{children:e.cislo_jednaci})]}),(0,V.jsxs)(So,{children:[(0,V.jsx)(Co,{children:"Datum vzniku:"}),(0,V.jsx)(Io,{children:Q(e.datum_vzniku)})]})]}),g.has(e.dokument_id)&&b.has(e.dokument_id)&&(()=>{const n=b.get(e.dokument_id),o=new Date(n.zpracovano_kdy),t=Math.floor((Date.now()-o.getTime())/1e3);let r="";return r=t<60?"p\u0159ed chv\xedl\xed":t<3600?"p\u0159ed ".concat(Math.floor(t/60)," min"):t<86400?"p\u0159ed ".concat(Math.floor(t/3600)," h"):"p\u0159ed ".concat(Math.floor(t/86400)," dny"),(0,V.jsxs)("div",{style:{padding:"0.75rem 1rem",background:"linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)",borderTop:"1px solid #a7f3d0",borderBottom:"1px solid #a7f3d0",marginBottom:"0.5rem"},children:[(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",fontSize:"0.8rem",color:"#047857",fontWeight:500},children:[(0,V.jsx)("span",{children:"\u2713"}),(0,V.jsxs)("span",{children:["Zaevidov\xe1no ",(0,V.jsx)("strong",{children:r}),n.fa_cislo_vema&&(0,V.jsxs)(V.Fragment,{children:[" jako ",(0,V.jsx)("strong",{children:n.fa_cislo_vema})]})]}),(0,V.jsxs)("button",{onClick:o=>{o.stopPropagation(),q(e.dokument_id,n.faktura_id,n.fa_cislo_vema)},style:{marginLeft:"auto",padding:"4px 8px",fontSize:"0.75rem",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontWeight:600},title:"Zru\u0161it zpracov\xe1n\xed tohoto dokumentu",children:[(0,V.jsx)("span",{children:"\ud83d\uddd1\ufe0f"}),(0,V.jsx)("span",{children:"Zru\u0161it"})]})]}),(0,V.jsxs)("div",{style:{fontSize:"0.75rem",color:"#059669",marginTop:"0.25rem",paddingLeft:"1.5rem"},children:["U\u017eivatel: ",(0,V.jsx)("strong",{children:n.uzivatel_jmeno})," \u2022 ",o.toLocaleString("cs-CZ")]})]})})(),e.prilohy&&e.prilohy.length>0&&(0,V.jsxs)(Eo,{children:[(0,V.jsxs)(Oo,{children:["\ud83d\udcce P\u0159\xedlohy (",e.prilohy.length,")"]}),(D.has(e.dokument_id)?e.prilohy:e.prilohy.slice(0,3)).map(n=>{const o="application/pdf"===n.mime_type,t="text/plain"===n.mime_type||n.filename.toLowerCase().endsWith(".txt"),r=o||t;return(0,V.jsxs)(No,{draggable:!0,onDragStart:o=>{o.stopPropagation(),o.currentTarget.style.cursor="grabbing",o.currentTarget.style.opacity="0.6",o.dataTransfer.setData("text/spisovka-file-url",n.download_url),o.dataTransfer.setData("text/spisovka-file-name",n.filename),o.dataTransfer.setData("text/spisovka-file-mime",n.mime_type||"application/octet-stream"),o.dataTransfer.setData("text/spisovka-file-id",n.file_id),o.dataTransfer.setData("text/spisovka-dokument-id",e.dokument_id),o.dataTransfer.effectAllowed="copy"},style:{cursor:"grab"},onDragEnd:e=>{e.stopPropagation(),e.currentTarget.style.cursor="grab",e.currentTarget.style.opacity="1"},children:[(0,V.jsxs)(To,{children:[(0,V.jsxs)(Do,{children:[o&&"\ud83d\udcc4 ",t&&"\ud83d\udcdd ",n.filename]}),(0,V.jsx)(Ro,{children:(i=n.size,i<1024?"".concat(i," B"):i<1048576?"".concat((i/1024).toFixed(1)," KB"):"".concat((i/1048576).toFixed(1)," MB"))})]}),(0,V.jsxs)("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:[o&&(0,V.jsxs)("button",{onClick:o=>{o.stopPropagation(),(async(e,n)=>{try{a&&a({datumVystaveni:"",datumSplatnosti:"",variabilniSymbol:"",castka:""}),B({visible:!0,progress:0,message:"Stahuji PDF ze Spisovky..."});const o="".concat("https://erdms.zachranka.cz/api.eeo/","spisovka.php/proxy-file?url=").concat(encodeURIComponent(e.download_url));console.log("\ud83d\udcc4 Fetching PDF via proxy: ".concat(o)),console.log("\ud83d\udcc4 Original URL: ".concat(e.download_url));const t=await fetch(o);if(!t.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));const r=t.headers.get("content-type"),i=t.headers.get("content-length");if(console.log("\ud83d\udcc4 Response received, Content-Type: ".concat(r,", Length: ").concat(i)),!r||!r.includes("pdf"))throw new Error("Neplatn\xfd form\xe1t souboru: ".concat(r||"unknown",". O\u010dek\xe1v\xe1no PDF."));B({visible:!0,progress:3,message:"Stahuji PDF data..."});const s=await t.arrayBuffer();if(console.log("\u2705 PDF completely downloaded: ".concat(s.byteLength," bytes")),0===s.byteLength)throw new Error("Sta\u017een\xfd soubor je pr\xe1zdn\xfd. Zkuste to pros\xedm znovu.");if(s.byteLength<100)throw new Error("Sta\u017een\xfd soubor je p\u0159\xedli\u0161 mal\xfd (".concat(s.byteLength," bytes). Stahov\xe1n\xed mo\u017en\xe1 selhalo."));const l=new Uint8Array(s.slice(0,5)),d=String.fromCharCode(...l);if(!d.startsWith("%PDF"))throw console.error("Invalid PDF header:",d),new Error("Sta\u017een\xfd soubor nen\xed platn\xe9 PDF (chyb\xed PDF header).");console.log('\u2705 PDF validated: header="'.concat(d,'", size=').concat(s.byteLength," bytes")),B({visible:!0,progress:5,message:"PDF sta\u017eeno, p\u0159ipravuji OCR..."});const c=await(0,fn.p)(s,(e,n)=>{B({visible:!0,progress:e,message:n})}),u=(0,fn.N)(c);B({visible:!1,progress:100,message:"Hotovo!"}),u.warning&&await new Promise(e=>{J({isOpen:!0,title:"\u26a0\ufe0f Varov\xe1n\xed",message:u.warning,details:null,onConfirm:()=>{J({isOpen:!1,title:"",message:"",details:null,onConfirm:null}),e(!0)},onClose:()=>{J({isOpen:!1,title:"",message:"",details:null,onConfirm:null}),e(!1)}})}).then(e=>{if(!e)throw console.log("\ud83d\udcc4 OCR zru\u0161eno u\u017eivatelem - dokument nen\xed faktura"),new Error("OCR_CANCELLED")}),a&&a((0,w.A)((0,w.A)({},u),{},{spisovka_dokument_id:n,spisovka_priloha_id:e.priloha_id})),console.log("\ud83d\udcc4 OCR Data + Spisovka metadata:",(0,w.A)((0,w.A)({},u),{},{spisovka_dokument_id:n,spisovka_priloha_id:e.priloha_id})),console.log("\ud83d\udcc4 Opening PDF for verification..."),$({visible:!0,url:e.download_url,filename:e.filename,type:"pdf",content:""})}catch(o){if(console.error("\u274c OCR Error:",o),B({visible:!1,progress:0,message:""}),"OCR_CANCELLED"===o.message)return;J({isOpen:!0,title:"Chyba p\u0159i OCR extrakci",message:o.message||"Nepoda\u0159ilo se extrahovat data z dokumentu.",details:o.stack||null,onConfirm:()=>{J({isOpen:!1,title:"",message:"",details:null,onConfirm:null}),$({visible:!0,url:e.download_url,filename:e.filename,type:"pdf",content:""})},onClose:()=>{J({isOpen:!1,title:"",message:"",details:null,onConfirm:null})}})}})(n,e.dokument_id)},style:{background:"#3b82f6",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"0.4rem",color:"white",fontSize:"0.7rem",fontWeight:"600",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",transition:"all 0.2s ease",whiteSpace:"nowrap"},onMouseEnter:e=>{e.currentTarget.style.background="#2563eb",e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(59, 130, 246, 0.25)"},onMouseLeave:e=>{e.currentTarget.style.background="#3b82f6",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.1)"},title:"Vyt\u011b\u017eit \xfadaje pomoc\xed OCR",children:[(0,V.jsx)(pn.A,{size:14}),(0,V.jsx)("span",{children:"OCR"})]}),(0,V.jsxs)(Po,{as:r?"button":"a",href:r?void 0:n.download_url,target:r?void 0:"_blank",rel:r?void 0:"noopener noreferrer",onClick:async e=>{if(e.stopPropagation(),o)$({visible:!0,url:n.download_url,filename:n.filename,type:"pdf",content:""});else if(t){const e=await(async e=>{try{const n="".concat("https://erdms.zachranka.cz/api.eeo/","spisovka.php/proxy-txt?url=").concat(encodeURIComponent(e)),o=await fetch(n);if(!o.ok)throw new Error("HTTP ".concat(o.status,": ").concat(o.statusText));return await o.text()}catch(m){return console.error("Chyba p\u0159i na\u010d\xedt\xe1n\xed TXT souboru:",m),"Chyba p\u0159i na\u010d\xedt\xe1n\xed souboru:\n".concat(m.message,"\n\nURL: ").concat(e)}})(n.download_url);$({visible:!0,url:n.download_url,filename:n.filename,type:"txt",content:e})}},children:[(0,V.jsx)(E.g,{icon:o||t?O.h8M:O.cbP}),o?"PDF":t?"TXT":"DL"]})]})]},n.file_id);var i}),e.prilohy.length>3&&(0,V.jsx)("div",{style:{fontSize:"0.75rem",color:"#3b82f6",marginTop:"0.5rem",textAlign:"center",fontWeight:600,cursor:"pointer",padding:"0.5rem",borderRadius:"4px",background:"#eff6ff",transition:"all 0.2s ease"},onClick:n=>{n.stopPropagation(),R(n=>{const o=new Set(n);return o.has(e.dokument_id)?o.delete(e.dokument_id):o.add(e.dokument_id),o})},onMouseEnter:e=>{e.currentTarget.style.background="#dbeafe",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.background="#eff6ff",e.currentTarget.style.transform="translateY(0)"},children:D.has(e.dokument_id)?"\u25b2 Skr\xfdt p\u0159\xedlohy":"\u25bc Zobrazit +".concat(e.prilohy.length-3," dal\u0161\xed")})]})]},e.dokument_id)})})})()]})})(),M.visible&&(0,V.jsxs)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, rgba(249, 250, 251, 0.98) 0%, rgba(243, 244, 246, 0.98) 100%)",backdropFilter:"blur(8px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"1.25rem",zIndex:1e3,borderRadius:"8px",border:"2px solid #e5e7eb",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.1)"},children:[(0,V.jsx)("div",{style:{background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",borderRadius:"50%",width:"80px",height:"80px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:(0,V.jsx)(pn.A,{size:40,color:"white",style:{animation:"spin 2s linear infinite"}})}),(0,V.jsxs)("div",{style:{fontSize:"1.1rem",fontWeight:"700",color:"#1f2937",textAlign:"center"},children:[(0,V.jsx)(E.g,{icon:O.h8M,style:{marginRight:"0.5rem",color:"#3b82f6"}}),"OCR extrakce z PDF"]}),(0,V.jsx)("div",{style:{fontSize:"0.9rem",color:"#6b7280",textAlign:"center",maxWidth:"300px"},children:M.message}),(0,V.jsx)("div",{style:{width:"85%",maxWidth:"320px",height:"10px",backgroundColor:"#e5e7eb",borderRadius:"5px",overflow:"hidden",border:"1px solid #d1d5db",boxShadow:"inset 0 1px 3px rgba(0, 0, 0, 0.1)"},children:(0,V.jsx)("div",{style:{height:"100%",width:"".concat(M.progress,"%"),background:"linear-gradient(90deg, #3b82f6 0%, #2563eb 100%)",transition:"width 0.3s ease",boxShadow:"0 0 8px rgba(59, 130, 246, 0.5)"}})}),(0,V.jsxs)("div",{style:{fontSize:"0.85rem",color:"#1e40af",fontWeight:"700",background:"rgba(59, 130, 246, 0.1)",padding:"0.25rem 0.75rem",borderRadius:"12px"},children:[Math.round(M.progress),"%"]})]}),P.visible&&S.createPortal((0,V.jsx)(Fo,{x:L.x,y:L.y,w:L.w,h:L.h,children:(0,V.jsxs)(Vo,{children:[(0,V.jsxs)(Wo,{onMouseDown:e=>{U(!0),e.preventDefault()},style:{cursor:W?"grabbing":"grab"},children:[(0,V.jsxs)(Uo,{children:[(0,V.jsx)(E.g,{icon:O.h8M}),P.filename]}),(0,V.jsx)(Zo,{onClick:()=>$({visible:!1,url:"",filename:"",type:"",content:""}),children:(0,V.jsx)(E.g,{icon:O.GRI})})]}),"pdf"===P.type?(0,V.jsx)(Jo,{data:P.url,type:"application/pdf",title:P.filename,children:(0,V.jsxs)(Ko,{children:[(0,V.jsx)(E.g,{icon:O.h8M,size:"3x",style:{color:"#64748b"}}),(0,V.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:600},children:"PDF nelze zobrazit v prohl\xed\u017ee\u010di"}),(0,V.jsx)("div",{style:{fontSize:"0.9rem",color:"#64748b",textAlign:"center",maxWidth:"400px"},children:"V\xe1\u0161 prohl\xed\u017ee\u010d nepodporuje zobrazen\xed PDF soubor\u016f. M\u016f\u017eete soubor st\xe1hnout a otev\u0159\xedt extern\u011b."}),(0,V.jsxs)(Ho,{href:P.url,download:P.filename,children:[(0,V.jsx)(E.g,{icon:O.cbP}),"St\xe1hnout PDF"]})]})}):"txt"===P.type?(0,V.jsx)(Yo,{children:P.content}):null]})}),document.body),(0,V.jsx)(Cn,{isOpen:Z.isOpen,title:Z.title,message:Z.message,details:Z.details,onConfirm:Z.onConfirm,onClose:Z.onClose,confirmText:Z.onConfirm?Z.title.includes("Varov\xe1n\xed")?"Pokra\u010dovat":"Otev\u0159\xedt PDF":null,cancelText:"Zru\u0161it"})]}),document.body)};var qo=o(70692),Xo=o(29071),Qo=o(80293),et=o(90388);const nt=["fa_castka"];var ot,tt,rt,at,it,st,lt,dt,ct,ut,pt,mt,ft,vt,ht,gt,xt,bt,_t,yt,kt,jt,wt,zt,At,St,Ct,It,Et,Ot,Nt,Tt,Dt,Rt,Pt,$t,Mt,Bt,Lt,Ft,Vt,Wt,Ut,Zt,Jt,Kt,Ht,Yt,Gt,qt,Xt,Qt,er,nr,or,tr,rr,ar,ir,sr,lr,dr,cr,ur,pr,mr,fr,vr,hr,gr,xr,br,_r,yr,kr,jr,wr,zr,Ar,Sr,Cr,Ir,Er,Or,Nr,Tr,Dr,Rr,Pr,$r,Mr;const Br=e=>{if(!e)return"";const n=new Date(e);return isNaN(n)?"":n.toISOString().split("T")[0]};function Lr(e){let{fieldName:n,value:o,onChange:t,onBlur:r,disabled:a,hasError:i,placeholder:s}=e;const l=(0,A.useRef)(null),[d,c]=(0,A.useState)(""),[u,p]=(0,A.useState)(!1),m=e=>{if(!e&&0!==e)return"";const n=parseFloat(e.toString().replace(/[^0-9.-]/g,""));return isNaN(n)?"":n.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g," ").replace(".",",")};(0,A.useEffect)(()=>{if(!u){const e=m(o||"");d!==e&&c(e)}},[o,u,d]);return(0,V.jsxs)(Aa,{children:[(0,V.jsx)(Ca,{ref:l,type:"text",name:n,placeholder:s,value:d,onChange:e=>{const o=e.target.value;c(o);const r=o.replace(/[^\d,.-]/g,"").replace(",","."),a=parseFloat(r),i=isNaN(a)?"":a.toFixed(2);t&&t({target:{name:n,value:i}})},onFocus:()=>{p(!0)},onBlur:()=>{p(!1);const e=m(d);c(e);const o=d.replace(/[^\d,.-]/g,"").replace(",","."),t=parseFloat(o),a=isNaN(t)?"":t.toFixed(2);r&&r({target:{name:n,value:a}})},disabled:a,style:{textAlign:"right",paddingRight:"40px",fontWeight:u?"400":"600"},$hasError:i}),(0,V.jsx)(Sa,{children:"K\u010d"})]})}const Fr=I.A.div(ot||(ot=(0,z.A)(["\n  padding: 1rem;\n  background: #f8fafc;\n  border-left: 4px solid #3b82f6;\n  border-radius: 4px;\n  margin: 1rem 0;\n  font-size: 1.1rem;\n"]))),Vr=I.A.p(tt||(tt=(0,z.A)(["\n  margin: 0.75rem 0;\n  color: #64748b;\n  line-height: 1.6;\n"]))),Wr=(I.A.p(rt||(rt=(0,z.A)(["\n  margin: 0.75rem 0;\n  color: #dc2626;\n  font-weight: 600;\n  line-height: 1.6;\n"]))),I.A.div(at||(at=(0,z.A)(["\n  margin: 1rem 0;\n  padding: 1rem;\n  background: #f0f9ff;\n  border: 1px solid #bfdbfe;\n  border-radius: 8px;\n"])))),Ur=I.A.div(it||(it=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.5rem 0;\n  color: #1e40af;\n\n  &:not(:last-child) {\n    border-bottom: 1px solid #e0e7ff;\n  }\n\n  svg {\n    color: #3b82f6;\n    width: 18px;\n    height: 18px;\n  }\n\n  a {\n    color: #1e40af;\n    text-decoration: none;\n    font-weight: 500;\n    transition: all 0.2s ease;\n\n    &:hover {\n      color: #1e3a8a;\n      text-decoration: underline;\n    }\n  }\n"]))),Zr=I.A.span(st||(st=(0,z.A)(["\n  font-weight: 600;\n  min-width: 80px;\n  color: #64748b;\n"]))),Jr=I.A.div(lt||(lt=(0,z.A)(["\n  margin: 0.75rem 0;\n  padding: 0.75rem;\n  background: #fef3c7;\n  border-left: 4px solid #f59e0b;\n  border-radius: 4px;\n  font-size: 0.875rem;\n  color: #92400e;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n\n  svg {\n    color: #f59e0b;\n    width: 16px;\n    height: 16px;\n  }\n"]))),Kr=I.A.div(dt||(dt=(0,z.A)(["\n  position: relative;\n  width: 100%;\n  height: calc(100vh - 60px);\n  background: #f9fafb;\n  padding: 0;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n"]))),Hr=I.A.div(ct||(ct=(0,z.A)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: #ffffff;\n  z-index: 99999;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n"]))),Yr=I.A.div(ut||(ut=(0,z.A)(["\n  background: linear-gradient(135deg, #dbeafe 0%, #ffffff 100%);\n  color: #1f2937;\n  padding: 1.5rem 2rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 2px solid #e5e7eb;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n"]))),Gr=I.A.h1(pt||(pt=(0,z.A)(["\n  margin: 0;\n  font-size: 1.75rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n"]))),qr=I.A.div(mt||(mt=(0,z.A)(["\n  display: flex;\n  gap: 12px;\n  align-items: center;\n"]))),Xr=I.A.button(ft||(ft=(0,z.A)(["\n  background: #f9fafb;\n  border: 2px solid #e5e7eb;\n  color: #6b7280;\n  width: 44px;\n  height: 44px;\n  padding: 0;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 1.25rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  position: relative;\n\n  &:hover {\n    background: #ffffff;\n    border-color: #3b82f6;\n    color: #3b82f6;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n"]))),Qr=I.A.span(vt||(vt=(0,z.A)(["\n  position: absolute;\n  top: -6px;\n  right: -6px;\n  background: #10b981;\n  color: white;\n  font-size: 0.7rem;\n  font-weight: 700;\n  padding: 2px 6px;\n  border-radius: 10px;\n  min-width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 2px solid #ffffff;\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);\n"]))),ea=I.A.div(ht||(ht=(0,z.A)(["\n  position: relative;\n  display: inline-block;\n"]))),na=I.A.div(gt||(gt=(0,z.A)(["\n  position: fixed;\n  top: ","px;\n  left: ","px;\n  min-width: 350px;\n  max-width: 450px;\n  background: #ffffff;\n  border: 2px solid #e5e7eb;\n  border-radius: 10px;\n  padding: 0.75rem;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);\n  z-index: 10000;\n  opacity: ",";\n  visibility: ",";\n  transform: ",";\n  transition: all 0.2s ease;\n  pointer-events: none;\n\n  &::before {\n    content: '';\n    position: absolute;\n    bottom: 100%;\n    right: 20px;\n    border: 6px solid transparent;\n    border-bottom-color: #e5e7eb;\n  }\n  \n  &::after {\n    content: '';\n    position: absolute;\n    bottom: 100%;\n    right: 21px;\n    border: 5px solid transparent;\n    border-bottom-color: #ffffff;\n  }\n"])),e=>e.$top||0,e=>e.$left||0,e=>e.show?1:0,e=>e.show?"visible":"hidden",e=>e.show?"translateY(0)":"translateY(-10px)"),oa=I.A.div(xt||(xt=(0,z.A)(["\n  font-size: 0.7rem;\n  font-weight: 700;\n  color: #10b981;\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n"]))),ta=I.A.div(bt||(bt=(0,z.A)(["\n  padding: 0.4rem;\n  border-radius: 6px;\n  margin-bottom: 0.3rem;\n  background: #f0fdf4;\n  border: 1px solid #d1fae5;\n  font-size: 0.75rem;\n  color: #1f2937;\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n"]))),ra=I.A.div(_t||(_t=(0,z.A)(["\n  font-weight: 600;\n  color: #065f46;\n  margin-bottom: 0.2rem;\n"]))),aa=I.A.div(yt||(yt=(0,z.A)(["\n  font-size: 0.7rem;\n  color: #6b7280;\n  display: flex;\n  justify-content: space-between;\n"]))),ia=I.A.div(kt||(kt=(0,z.A)(["\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  min-height: 0;\n"]))),sa=I.A.div(jt||(jt=(0,z.A)(["\n  width: 55%;\n  background: white;\n  border-right: 2px solid #e5e7eb;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n"]))),la=I.A.div(wt||(wt=(0,z.A)(["\n  flex-shrink: 0;\n  background: white;\n  padding: 1.5rem 2rem 1rem 2rem;\n  border-bottom: 2px solid #e5e7eb;\n"]))),da=I.A.div(zt||(zt=(0,z.A)(["\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 2rem;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f1f1f1;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n"]))),ca=I.A.div(At||(At=(0,z.A)(["\n  width: 45%;\n  background: #f8fafc;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n"]))),ua=I.A.div(St||(St=(0,z.A)(["\n  flex-shrink: 0;\n  background: #f8fafc;\n  padding: 1.25rem 2rem 1.5rem 2rem;\n  border-bottom: 2px solid #e5e7eb;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 1rem;\n"]))),pa=I.A.button(Ct||(Ct=(0,z.A)(["\n  background: ",";\n  color: ",";\n  border: none;\n  border-radius: 6px;\n  padding: 0.5rem 1rem;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: ",";\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.15s ease;\n  white-space: nowrap;\n  align-self: center;\n  margin: 0;\n\n  &:hover:not(:disabled) {\n    background: #2563eb;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n\n  &:active:not(:disabled) {\n    transform: translateY(0);\n  }\n"])),e=>e.disabled?"#e5e7eb":"#3b82f6",e=>e.disabled?"#94a3b8":"white",e=>e.disabled?"not-allowed":"pointer"),ma=I.A.div(It||(It=(0,z.A)(["\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 2rem;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #e5e7eb;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #9ca3af;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #6b7280;\n  }\n"]))),fa=I.A.h2(Et||(Et=(0,z.A)(["\n  font-size: 1.3rem;\n  color: #1e293b;\n  margin: 0 0 1.5rem 0;\n  padding-bottom: 12px;\n  border-bottom: 2px solid #3498db;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n"]))),va=I.A.div(Ot||(Ot=(0,z.A)(["\n  background: #ffffff;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  margin-bottom: 1.5rem;\n  overflow: visible;\n  border: 2px solid #e2e8f0;\n"]))),ha=I.A.div(Nt||(Nt=(0,z.A)(["\n  padding: 1rem 1.25rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  border-bottom: 3px solid #1e40af;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  border-radius: 12px 12px 0 0;\n  color: white;\n  font-weight: 700;\n  font-size: 1.1rem;\n  letter-spacing: 0.5px;\n  text-transform: uppercase;\n\n  &:hover {\n    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n  }\n"]))),ga=I.A.div(Tt||(Tt=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  font-weight: 600;\n  font-size: 1.1rem;\n  color: white;\n"]))),xa=I.A.div(Dt||(Dt=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n"]))),ba=I.A.div(Rt||(Rt=(0,z.A)(["\n  padding: 1.5rem 1.25rem;\n  display: ",";\n"])),e=>e.$collapsed?"none":"block"),_a=I.A.button(Pt||(Pt=(0,z.A)(["\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  padding: 0.25rem;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.2rem;\n  transition: transform 0.3s ease;\n  transform: ",";\n\n  &:hover {\n    color: rgba(255, 255, 255, 0.8);\n  }\n"])),e=>e.$collapsed?"rotate(180deg)":"rotate(0deg)"),ya=I.A.div($t||($t=(0,z.A)(["\n  border: 2px solid ",";\n  border-radius: 12px;\n  padding: 1.5rem;\n  background: ",";\n  margin-bottom: 1.5rem;\n  transition: all 0.3s ease;\n\n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n"])),e=>e.$hasError?"#ef4444":"#e5e7eb",e=>e.$isEditing?"#f0f9ff":"#ffffff"),ka=I.A.div(Mt||(Mt=(0,z.A)(["\n  display: grid;\n  grid-template-columns: ",";\n  gap: ",";\n  margin-bottom: 1rem;\n"])),e=>e.$columns||"1fr",e=>e.$gap||"1rem"),ja=I.A.div(Bt||(Bt=(0,z.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n"]))),wa=I.A.label(Lt||(Lt=(0,z.A)(["\n  font-weight: 600;\n  color: #475569;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n"]))),za=I.A.span(Ft||(Ft=(0,z.A)(["\n  color: #ef4444;\n"]))),Aa=I.A.div(Vt||(Vt=(0,z.A)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n"]))),Sa=I.A.span(Wt||(Wt=(0,z.A)(["\n  position: absolute;\n  right: 12px;\n  color: #374151;\n  font-weight: 600;\n  font-size: 0.875rem;\n  font-family: inherit;\n  pointer-events: none;\n  user-select: none;\n  display: flex;\n  align-items: center;\n  height: 100%;\n"]))),Ca=I.A.input(Ut||(Ut=(0,z.A)(["\n  width: 100%;\n  height: 48px;\n  padding: 1px 0.875rem;\n  border: 2px solid ",";\n  border-radius: 8px;\n  font-size: 0.95rem;\n  transition: all 0.2s ease;\n  font-family: inherit;\n  box-sizing: border-box;\n\n  &:focus {\n    outline: none;\n    border-color: ",";\n    box-shadow: 0 0 0 3px ",";\n  }\n\n  &:disabled {\n    background: #f1f5f9;\n    cursor: not-allowed;\n  }\n\n  &::placeholder {\n    color: #94a3af;\n  }\n"])),e=>e.$hasError?"#ef4444":"#e2e8f0",e=>e.$hasError?"#ef4444":"#3b82f6",e=>e.$hasError?"rgba(239, 68, 68, 0.1)":"rgba(59, 130, 246, 0.1)"),Ia=I.A.textarea(Zt||(Zt=(0,z.A)(["\n  padding: 0.875rem;\n  border: 2px solid #e2e8f0;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  min-height: 100px;\n  resize: vertical;\n  font-family: inherit;\n  transition: all 0.2s ease;\n  box-sizing: border-box;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n"]))),Ea=(I.A.select(Jt||(Jt=(0,z.A)(["\n  width: 100%;\n  height: 48px;\n  padding: 1px 2.5rem 1px 0.875rem;\n  border: 2px solid ",";\n  border-radius: 8px;\n  font-size: 0.95rem;\n  cursor: pointer;\n  font-family: inherit;\n  background-color: white;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 9L1 4h10z'/%3E%3C/svg%3E\");\n  background-repeat: no-repeat;\n  background-position: right 0.75rem center;\n  background-size: 12px;\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  transition: all 0.2s ease;\n  box-sizing: border-box;\n\n  &:hover {\n    border-color: ",";\n  }\n\n  &:focus {\n    outline: none;\n    border-color: ",";\n    box-shadow: 0 0 0 3px ",";\n  }\n\n  option {\n    padding: 0.5rem;\n  }\n"])),e=>e.$hasError?"#ef4444":"#e2e8f0",e=>e.$hasError?"#ef4444":"#cbd5e1",e=>e.$hasError?"#ef4444":"#3b82f6",e=>e.$hasError?"rgba(239, 68, 68, 0.1)":"rgba(59, 130, 246, 0.1)"),I.A.div(Kt||(Kt=(0,z.A)(["\n  color: #ef4444;\n  font-size: 0.875rem;\n  margin-top: 0.5rem;\n"]))),I.A.div(Ht||(Ht=(0,z.A)(["\n  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n  border: 2px solid #86efac;\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-top: 2rem;\n"]))),I.A.h3(Yt||(Yt=(0,z.A)(["\n  margin: 0 0 1rem 0;\n  font-size: 1.1rem;\n  color: #166534;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),I.A.label(Gt||(Gt=(0,z.A)(['\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  cursor: pointer;\n  padding: 0.75rem;\n  background: white;\n  border-radius: 8px;\n  border: 2px solid #d1fae5;\n  transition: all 0.2s ease;\n\n  &:hover {\n    border-color: #86efac;\n    background: #f0fdf4;\n  }\n\n  input[type="checkbox"] {\n    width: 20px;\n    height: 20px;\n    cursor: pointer;\n  }\n\n  strong {\n    color: #166534;\n    font-size: 1rem;\n  }\n']))),I.A.div(qt||(qt=(0,z.A)(["\n  display: flex;\n  gap: 1rem;\n  margin-top: 2rem;\n  padding-top: 1.5rem;\n  border-top: 2px solid #e5e7eb;\n  justify-content: flex-end;\n"])))),Oa=I.A.button(Xt||(Xt=(0,z.A)(["\n  padding: 0.875rem 1.75rem;\n  border: none;\n  border-radius: 8px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n\n  ","\n\n  ","\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none !important;\n  }\n\n  &:active:not(:disabled) {\n    transform: scale(0.98);\n  }\n"])),e=>"primary"===e.$variant&&"\n    background: #3b82f6;\n    color: white;\n\n    &:hover {\n      background: #2563eb;\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);\n    }\n  ",e=>"secondary"===e.$variant&&"\n    background: #f1f5f9;\n    color: #475569;\n\n    &:hover {\n      background: #e2e8f0;\n    }\n  "),Na=(I.A.div(Qt||(Qt=(0,z.A)(["\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  margin-bottom: 1.5rem;\n"]))),I.A.div(er||(er=(0,z.A)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n  padding-bottom: 1rem;\n  border-bottom: 2px solid #e5e7eb;\n"]))),I.A.div(nr||(nr=(0,z.A)(["\n  font-size: 1.4rem;\n  font-weight: 700;\n  color: #1e293b;\n"]))),I.A.span(or||(or=(0,z.A)(["\n  padding: 6px 14px;\n  border-radius: 16px;\n  font-size: 0.85rem;\n  font-weight: 600;\n  background: ",";\n  color: white;\n"])),e=>e.$color||"#64748b"),I.A.div(tr||(tr=(0,z.A)(["\n  display: flex;\n  margin-bottom: 12px;\n  gap: 12px;\n"]))),I.A.div(rr||(rr=(0,z.A)(["\n  font-weight: 600;\n  color: #64748b;\n  min-width: 140px;\n  font-size: 0.9rem;\n"]))),I.A.div(ar||(ar=(0,z.A)(["\n  color: #1e293b;\n  flex: 1;\n  font-size: 0.9rem;\n"]))),I.A.div(ir||(ir=(0,z.A)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem;\n  color: #64748b;\n"])))),Ta=I.A.div(sr||(sr=(0,z.A)(["\n  width: 48px;\n  height: 48px;\n  border: 4px solid #e2e8f0;\n  border-top: 4px solid #3b82f6;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  margin-bottom: 1rem;\n\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n"]))),Da=I.A.div(lr||(lr=(0,z.A)(["\n  background: #fef2f2;\n  border: 2px solid #fecaca;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1.5rem;\n  color: #991b1b;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n"]))),Ra=I.A.div(dr||(dr=(0,z.A)(["\n  font-size: 0.85rem;\n  color: #64748b;\n  margin-top: 0.5rem;\n  font-style: italic;\n"]))),Pa=I.A.div(cr||(cr=(0,z.A)(["\n  font-size: 0.85rem;\n  color: #dc2626;\n  margin-top: 0.5rem;\n  display: flex;\n  align-items: center;\n  gap: 0.35rem;\n  font-weight: 500;\n"]))),$a=I.A.div(ur||(ur=(0,z.A)(["\n  position: relative;\n  width: 100%;\n"]))),Ma=(0,I.A)(Ca)(pr||(pr=(0,z.A)(["\n  padding-right: 2.5rem;\n"]))),Ba=I.A.button(mr||(mr=(0,z.A)(["\n  position: absolute;\n  right: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  background: none;\n  border: none;\n  color: #cbd5e1;\n  cursor: pointer;\n  padding: 0.25rem;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s ease;\n  font-size: 0.75rem;\n  opacity: 0.6;\n\n  &:hover {\n    color: #94a3b8;\n    opacity: 1;\n  }\n\n  &:active {\n    transform: translateY(-50%) scale(0.9);\n  }\n"]))),La=I.A.div(fr||(fr=(0,z.A)(["\n  position: absolute;\n  top: calc(100% + 4px);\n  left: 0;\n  width: 150%;\n  max-height: 400px;\n  overflow-y: auto;\n  background: white;\n  border: 2px solid #3b82f6;\n  border-radius: 8px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n"]))),Fa=I.A.div(vr||(vr=(0,z.A)(["\n  padding: 0.75rem 1rem;\n  cursor: pointer;\n  border-bottom: 1px solid #f3f4f6;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #eff6ff;\n  }\n\n  &:last-child {\n    border-bottom: none;\n  }\n"]))),Va=I.A.div(hr||(hr=(0,z.A)(["\n  font-weight: 600;\n  color: #1e40af;\n  font-size: 0.95rem;\n  margin-bottom: 0.25rem;\n"]))),Wa=I.A.div(gr||(gr=(0,z.A)(["\n  font-size: 0.85rem;\n  color: #6b7280;\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-top: 0.25rem;\n"]))),Ua=I.A.span(xr||(xr=(0,z.A)(["\n  background: ",";\n  color: ",";\n  padding: 0.125rem 0.5rem;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  font-weight: 500;\n"])),e=>e.$color||"#e5e7eb",e=>e.$textColor||"#374151"),Za=I.A.div(br||(br=(0,z.A)(["\n  padding: 1rem;\n  text-align: center;\n  color: #9ca3af;\n  font-size: 0.9rem;\n"]))),Ja=I.A.div(_r||(_r=(0,z.A)(["\n  padding: 1rem;\n  text-align: center;\n  color: #6b7280;\n"]))),Ka=I.A.div(yr||(yr=(0,z.A)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 100010;\n  animation: fadeIn 0.2s ease-in;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n"]))),Ha=I.A.div(kr||(kr=(0,z.A)(["\n  background: white;\n  border-radius: 12px;\n  padding: 2rem;\n  min-width: 400px;\n  max-width: 500px;\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);\n  animation: slideIn 0.3s ease-out;\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(-20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n"]))),Ya=I.A.div(jr||(jr=(0,z.A)(["\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n"]))),Ga=I.A.div(wr||(wr=(0,z.A)(["\n  width: 48px;\n  height: 48px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5rem;\n  background: ",";\n  color: white;\n  animation: ",";\n\n  @keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n  }\n"])),e=>"success"===e.status?"linear-gradient(135deg, #10b981 0%, #059669 100%)":"error"===e.status?"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)":"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",e=>"loading"===e.status?"pulse 2s ease-in-out infinite":"none"),qa=I.A.div(zr||(zr=(0,z.A)(["\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #111827;\n"]))),Xa=I.A.div(Ar||(Ar=(0,z.A)(["\n  font-size: 0.95rem;\n  color: #6b7280;\n  margin-bottom: 1.5rem;\n  line-height: 1.5;\n"]))),Qa=I.A.div(Sr||(Sr=(0,z.A)(["\n  width: 100%;\n  height: 8px;\n  background: #e5e7eb;\n  border-radius: 4px;\n  overflow: hidden;\n  margin-bottom: 1rem;\n"]))),ei=I.A.div(Cr||(Cr=(0,z.A)(["\n  height: 100%;\n  background: linear-gradient(90deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%);\n  border-radius: 4px;\n  transition: width 0.3s ease-out;\n  width: ","%;\n  background-size: 200% 100%;\n  animation: shimmer 2s infinite;\n\n  @keyframes shimmer {\n    0% { background-position: 200% 0; }\n    100% { background-position: -200% 0; }\n  }\n"])),e=>e.progress||0),ni=I.A.div(Ir||(Ir=(0,z.A)(["\n  display: flex;\n  justify-content: flex-end;\n  gap: 0.75rem;\n  margin-top: 1.5rem;\n"]))),oi=I.A.button(Er||(Er=(0,z.A)(["\n  padding: 0.5rem 1.25rem;\n  border-radius: 6px;\n  font-size: 0.9rem;\n  font-weight: 600;\n  cursor: pointer;\n  border: none;\n  transition: all 0.2s;\n  background: ",";\n  color: ",";\n\n  &:hover {\n    background: ",";\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"])),e=>"primary"===e.variant?"#3b82f6":"#e5e7eb",e=>"primary"===e.variant?"white":"#374151",e=>"primary"===e.variant?"#2563eb":"#d1d5db"),ti=I.A.div(Or||(Or=(0,z.A)(["\n  position: relative;\n  width: 100%;\n  z-index: ",";\n"])),e=>e.isOpen?1e4:1),ri=I.A.div(Nr||(Nr=(0,z.A)(["\n  width: 100%;\n  box-sizing: border-box;\n  height: 48px;\n  padding: 1px 2.5rem 1px 0.875rem;\n  border: 2px solid ",";\n  border-radius: 8px;\n  font-size: 0.95rem;\n  background: ",";\n  cursor: ",";\n  color: ",";\n  font-weight: ",";\n  display: flex;\n  align-items: center;\n  position: relative;\n  transition: all 0.2s ease;\n  appearance: none;\n  -moz-appearance: none;\n  -webkit-appearance: none;\n  background-image: ",";\n  background-repeat: no-repeat;\n  background-position: right 0.75rem center;\n  background-size: 12px 12px;\n\n  &:hover {\n    border-color: ",";\n  }\n\n  &:focus {\n    outline: none;\n    border-color: ",";\n    box-shadow: 0 0 0 3px ",";\n  }\n"])),e=>e.hasError?"#dc2626":"#e2e8f0",e=>e.disabled?"#f1f5f9":"#ffffff",e=>e.disabled?"not-allowed":"pointer",e=>e.disabled?"#6b7280":e.placeholder||!e.value||""===e.value?"#94a3af":"#1f2937",e=>e.disabled?"400":e.value&&""!==e.value&&"true"!==e.placeholder?"600":"400",e=>e.disabled?e.isOpen?"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")":"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")":e.hasError?e.isOpen?"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23b91c1c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")":"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23b91c1c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")":e.isOpen?"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23374151' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")":"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23374151' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")",e=>e.disabled?"#e2e8f0":e.hasError?"#dc2626":"#cbd5e1",e=>e.hasError?"#dc2626":"#3b82f6",e=>e.hasError?"rgba(239, 68, 68, 0.1)":"rgba(59, 130, 246, 0.1)"),ai=I.A.span(Tr||(Tr=(0,z.A)(["\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  color: ",";\n  font-weight: ",";\n"])),e=>e.isEmpty?"#9ca3af":"#1f2937",e=>e.isEmpty?"400":"600"),ii=I.A.div(Dr||(Dr=(0,z.A)(["\n  position: fixed;\n  z-index: 40;\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.1);\n  max-height: 300px;\n  overflow-y: auto;\n  min-width: 200px;\n  user-select: none;\n  scroll-behavior: auto;\n  contain: layout style paint;\n  will-change: scroll-position;\n  transform: translateZ(0);\n  scrollbar-width: thin;\n  scrollbar-color: #d1d5db #f9fafb;\n\n  &::-webkit-scrollbar {\n    width: 8px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f9fafb;\n    border-radius: 4px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #d1d5db;\n    border-radius: 4px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #9ca3af;\n  }\n"]))),si=I.A.div(Rr||(Rr=(0,z.A)(["\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n  padding: 0.75rem;\n  border-bottom: 1px solid #e5e7eb;\n"]))),li=I.A.input(Pr||(Pr=(0,z.A)(["\n  width: 100%;\n  padding: 0.75rem 0.75rem 0.75rem 2.5rem;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  font-size: 0.875rem;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n  }\n"]))),di=I.A.div($r||($r=(0,z.A)(["\n  position: absolute;\n  left: 1rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #6b7280;\n  pointer-events: none;\n"]))),ci=I.A.div(Mr||(Mr=(0,z.A)(["\n  padding: ",";\n  cursor: pointer;\n  font-size: 0.875rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  background: ",";\n  border-bottom: ",";\n  font-weight: ",";\n  color: ",";\n  position: relative;\n  will-change: transform;\n  backface-visibility: hidden;\n  outline: none;\n\n  &:hover {\n    background: ",';\n  }\n\n  &:focus {\n    background: #dbeafe;\n    box-shadow: inset 0 0 0 2px #3b82f6;\n  }\n\n  &:last-child {\n    border-bottom: none;\n  }\n\n  input[type="checkbox"] {\n    margin: 0;\n    pointer-events: none;\n  }\n\n  span {\n    padding-left: ',"px;\n    font-weight: ",";\n  }\n"])),e=>0===e.level?"0.75rem":"0.5rem 0.75rem 0.5rem 2rem",e=>0===e.level?"#f9fafb":"#ffffff",e=>0===e.level?"2px solid #e5e7eb":"1px solid #f3f4f6",e=>0===e.level?"600":"400",e=>0===e.level?"#111827":"#4b5563",e=>0===e.level?"#f3f4f6":"#f8fafc",e=>20*(e.level||0),e=>0===(e.level||0)?"600":"400");function ui(){var e,n,o,t;const r=(0,C.Zp)(),a=(0,C.zy)(),{orderId:i}=(0,C.g)(),{token:s,username:l,user_id:d,hasPermission:c}=(0,A.useContext)(N.cy),{showToast:u}=(0,A.useContext)(T.$o),{setProgress:p}=(0,A.useContext)(D.z)||{},m=(0,et.W)({token:s,username:l,showToast:u}),f=c("INVOICE_MANAGE")||c("ORDER_MANAGE")||c("ADMIN"),v=(0,A.useCallback)(e=>{if(!e||!e.stav_workflow_kod)return null;let n=[];try{"string"===typeof e.stav_workflow_kod?n=JSON.parse(e.stav_workflow_kod):Array.isArray(e.stav_workflow_kod)&&(n=e.stav_workflow_kod)}catch(o){return null}return n.length>0?n[n.length-1]:null},[]),h=(0,A.useCallback)(e=>{if(!e||!e.stav_workflow_kod)return{allowed:!1,reason:"Objedn\xe1vka nem\xe1 definovan\xfd stav"};let n=[];try{"string"===typeof e.stav_workflow_kod?n=JSON.parse(e.stav_workflow_kod):Array.isArray(e.stav_workflow_kod)&&(n=e.stav_workflow_kod)}catch(t){return{allowed:!1,reason:"Chyba p\u0159i parsov\xe1n\xed stavu objedn\xe1vky"}}const o=n.length>0?n[n.length-1]:null;if(!o)return{allowed:!1,reason:"Objedn\xe1vka nem\xe1 definovan\xfd aktu\xe1ln\xed stav"};return["NEUVEREJNIT","UVEREJNENA","FAKTURACE","VECNA_SPRAVNOST","ZKONTROLOVANA"].includes(o)?{allowed:!0,reason:null}:{allowed:!1,reason:"Fakturaci lze p\u0159idat pouze k objedn\xe1vk\xe1m ve stavu: NEUVE\u0158EJNIT, UVE\u0158EJN\u011aNA, FAKTURACE, V\u011aCN\xc1 SPR\xc1VNOST nebo ZKONTROLOVAN\xc1. Aktu\xe1ln\xed stav: ".concat(o)}},[]),g=!c("INVOICE_MANAGE")&&c("INVOICE_MATERIAL_CORRECTNESS"),[x,b]=(0,A.useState)(()=>{const e={invoiceData:!0,materialCorrectness:!c("INVOICE_MANAGE")};try{const n=localStorage.getItem("invoiceSections_".concat(d));if(n){const o=JSON.parse(n);return(0,w.A)((0,w.A)({},e),o)}}catch(n){console.warn("\u26a0\ufe0f Chyba p\u0159i na\u010d\xedt\xe1n\xed stavu sekc\xed z localStorage:",n)}return e}),_=(0,A.useCallback)(e=>{b(n=>(0,w.A)((0,w.A)({},n),{},{[e]:!n[e]}))},[]),[y,k]=(0,A.useState)(!1),[z,I]=(0,A.useState)(!1),[W,U]=(0,A.useState)(!1),[Z,J]=(0,A.useState)(null),[K,H]=(0,A.useState)(null),[Y,G]=(0,A.useState)("order"),[q,X]=(0,A.useState)(null),[Q,ee]=(0,A.useState)({}),[ne,oe]=(0,A.useState)(""),[te,re]=(0,A.useState)([]),[ae,ie]=(0,A.useState)(!1),[se,de]=(0,A.useState)(!1),ce=(0,A.useRef)(null),[ue,pe]=(0,A.useState)(!1),[me,fe]=(0,A.useState)(null),[ve,he]=(0,A.useState)(!1),ge=(0,A.useRef)(!1),[xe,be]=(0,A.useState)({isOpen:!1,title:"",message:"",onConfirm:null,onCancel:null}),[_e,ye]=(0,A.useState)(!1),[ke,je]=(0,A.useState)(null),[we,ze]=(0,A.useState)(!1),[Ae,Se]=(0,A.useState)(!1),[Ce,Ie]=(0,A.useState)({show:!1,status:"loading",progress:0,title:"",message:""}),[Ee,Oe]=(0,A.useState)(!1),[Ne,Te]=(0,A.useState)({x:Math.max(0,window.innerWidth-750),y:144,w:750,h:Math.max(400,window.innerHeight-144-54),minimized:!1}),[De,Re]=(0,A.useState)(0),[Pe,$e]=(0,A.useState)([]),[Me,Be]=(0,A.useState)(!1),[Le,Fe]=(0,A.useState)({top:0,left:0}),Ve=(0,A.useRef)(null);(0,A.useEffect)(()=>{const e=()=>{Te(e=>{const n=window.innerWidth-e.w-20,o=window.innerHeight-e.h-20;return(0,w.A)((0,w.A)({},e),{},{x:Math.min(Math.max(20,e.x),n),y:Math.min(Math.max(20,e.y),o)})})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const[We,Ue]=(0,A.useState)({order_id:i||"",smlouva_id:null,fa_cislo_vema:"",fa_typ:"BEZNA",fa_datum_doruceni:Br(new Date),fa_datum_vystaveni:"",fa_datum_splatnosti:"",fa_castka:"",fa_poznamka:"",fa_strediska_kod:[],fa_predana_zam_id:null,fa_datum_predani_zam:"",fa_datum_vraceni_zam:"",vecna_spravnost_umisteni_majetku:"",vecna_spravnost_poznamka:"",vecna_spravnost_potvrzeno:0,potvrdil_vecnou_spravnost_id:null,dt_potvrzeni_vecne_spravnosti:""}),[Ze,Je]=(0,A.useState)([]),[He,Ye]=(0,A.useState)(!1),[Ge,qe]=(0,A.useState)([]),[Xe,Qe]=(0,A.useState)(!1),[en,nn]=(0,A.useState)(!0),on=(0,A.useRef)(null),[tn,rn]=(0,A.useState)({}),[pn,mn]=(0,A.useState)({}),[fn,vn]=(0,A.useState)({}),[hn,gn]=(0,A.useState)([]),[xn,bn]=(0,A.useState)(!1),[_n,yn]=(0,A.useState)([]),[kn,jn]=(0,A.useState)(!1),[wn,zn]=(0,A.useState)([]),[An,Sn]=(0,A.useState)(!1),[Cn,In]=(0,A.useState)(null),[En,On]=(0,A.useState)(!1),Tn=(0,A.useMemo)(()=>!g&&!(We.order_id&&Z&&!h(Z).allowed),[g,We.order_id,Z,h]),Dn=(0,A.useMemo)(()=>{if(!Z||!Z.stav_workflow_kod)return!1;let e=[];try{"string"===typeof Z.stav_workflow_kod?e=JSON.parse(Z.stav_workflow_kod):Array.isArray(Z.stav_workflow_kod)&&(e=Z.stav_workflow_kod)}catch(n){return!1}return"DOKONCENA"===(e.length>0?e[e.length-1]:null)},[Z]);(0,A.useEffect)(()=>{s&&l&&m.loadAll()},[s,l]),(0,A.useEffect)(()=>{if(He&&d&&en)try{localStorage.setItem("invoiceForm_".concat(d),JSON.stringify(We)),localStorage.setItem("invoiceAttach_".concat(d),JSON.stringify(Ze)),me?localStorage.setItem("invoiceEdit_".concat(d),JSON.stringify(me)):localStorage.removeItem("invoiceEdit_".concat(d)),localStorage.setItem("invoiceOrigEntity_".concat(d),JSON.stringify(Ae)),Ge&&Array.isArray(Ge)&&Ge.length>0?localStorage.setItem("invoiceLpCerpani_".concat(d),JSON.stringify(Ge)):localStorage.removeItem("invoiceLpCerpani_".concat(d)),localStorage.setItem("invoiceSections_".concat(d),JSON.stringify(x))}catch(e){console.warn("\u274c Chyba p\u0159i ukl\xe1d\xe1n\xed do localStorage:",e)}},[We,Ze,me,Ae,Ge,x,d,He,en]),(0,A.useEffect)(()=>{var e,n,o;if(!d||He||ge.current)return;const t=sessionStorage.getItem("invoice_fresh_navigation"),r=null===(e=a.state)||void 0===e?void 0:e.editInvoiceId,i=null===(n=a.state)||void 0===n?void 0:n.orderIdForLoad,s=null===(o=a.state)||void 0===o?void 0:o.smlouvaIdForLoad;t&&sessionStorage.removeItem("invoice_fresh_navigation");if(t||r||i||s)Ye(!0);else{try{const e=localStorage.getItem("invoiceEdit_".concat(d));e&&(fe(JSON.parse(e)),he(!0));const n=localStorage.getItem("invoiceOrigEntity_".concat(d));n&&Se(JSON.parse(n));const o=localStorage.getItem("invoiceLpCerpani_".concat(d));if(o)try{const e=JSON.parse(o);Array.isArray(e)&&e.length>0&&qe(e)}catch(l){console.warn("\u26a0\ufe0f Chyba p\u0159i parsov\xe1n\xed LP \u010derp\xe1n\xed z localStorage:",l)}const t=localStorage.getItem("invoiceForm_".concat(d));if(t){const e=JSON.parse(t);Ue(e)}const r=localStorage.getItem("invoiceAttach_".concat(d));r&&Je(JSON.parse(r))}catch(c){console.warn("\u26a0\ufe0f Chyba p\u0159i na\u010d\xedt\xe1n\xed dat z localStorage:",c)}Ye(!0)}},[d,He]),(0,A.useEffect)(()=>{if(!s||!l||hn.length>0)return;bn(!0),jn(!0),Sn(!0);(async()=>{try{const[e,n,o]=await Promise.all([(0,L.CR)({token:s,username:l}),(0,L.Zz)({token:s,username:l,aktivni:1}),(0,B.Ym)({token:s,username:l})]);if(e&&Array.isArray(e)&&gn(e),n&&Array.isArray(n)&&yn(n),o&&Array.isArray(o)){const e=o.filter(e=>1===e.aktivni).sort((e,n)=>{const o="".concat(e.prijmeni||""," ").concat(e.jmeno||"").trim(),t="".concat(n.prijmeni||""," ").concat(n.jmeno||"").trim();return o.localeCompare(t,"cs")});zn(e)}}catch(e){console.error("Chyba p\u0159i na\u010d\xedt\xe1n\xed \u010d\xedseln\xedk\u016f:",e)}finally{bn(!1),jn(!1),Sn(!1)}})()},[s,l]),(0,A.useEffect)(()=>{if(!me||!Cn)return;const e=Cn.order_id||Cn.smlouva_id,n=!Cn.fa_predana_zam_id,o=1===Cn.vecna_spravnost_potvrzeno;if(!e||!n||!o)return void On(!1);const t=["fa_castka","fa_cislo_vema","fa_strediska_kod","fa_typ","fa_datum_vystaveni","fa_datum_splatnosti","fa_datum_doruceni"].some(e=>{const n=Cn[e],o=We[e];return Array.isArray(n)&&Array.isArray(o)?JSON.stringify(n.sort())!==JSON.stringify(o.sort()):n!==o});On(t)},[We,Cn,me]);const Rn=(0,A.useRef)(!1);(0,A.useEffect)(()=>{var e;if(ge.current)return;((null===(e=a.state)||void 0===e?void 0:e.editInvoiceId)||me)&&hn.length>0&&(async()=>{var e,n;const o=(null===(e=a.state)||void 0===e?void 0:e.editInvoiceId)||me,t=null===(n=a.state)||void 0===n?void 0:n.orderIdForLoad;if(!o||!s||!l)return;if(0===hn.length)return;if(Rn.current&&me===o)return;if(Ze.some(e=>"pending_upload"===e.status||"uploading"===e.status))fe(o);else{Rn.current=!0,I(!0),fe(o),he(!0);try{const e=await(0,R.V1)({token:s,username:l,id:o});if(e){let n=[];if(e.fa_strediska_kod){let o=[];if("string"===typeof e.fa_strediska_kod)try{o=JSON.parse(e.fa_strediska_kod)}catch(r){console.warn("Chyba p\u0159i parsov\xe1n\xed st\u0159edisek:",r)}else Array.isArray(e.fa_strediska_kod)&&(o=e.fa_strediska_kod);n=o.map(e=>"string"===typeof e?(hn.find(n=>n.value===e)||console.warn("\u26a0\ufe0f St\u0159edisko ".concat(e," nen\xed v options (neaktivn\xed)")),e):"object"===typeof e&&e.value?e.value:e)}const a={order_id:e.objednavka_id||"",smlouva_id:e.smlouva_id||null,fa_cislo_vema:e.fa_cislo_vema||"",fa_typ:e.fa_typ||"BEZNA",fa_datum_doruceni:Br(e.fa_datum_doruceni),fa_datum_vystaveni:Br(e.fa_datum_vystaveni),fa_datum_splatnosti:Br(e.fa_datum_splatnosti),fa_castka:e.fa_castka||"",fa_poznamka:e.fa_poznamka||"",fa_strediska_kod:n,file:null,fa_predana_zam_id:e.fa_predana_zam_id||null,fa_datum_predani_zam:Br(e.fa_datum_predani_zam),fa_datum_vraceni_zam:Br(e.fa_datum_vraceni_zam),vecna_spravnost_umisteni_majetku:e.vecna_spravnost_umisteni_majetku||"",vecna_spravnost_poznamka:e.vecna_spravnost_poznamka||"",vecna_spravnost_potvrzeno:e.vecna_spravnost_potvrzeno||0,potvrdil_vecnou_spravnost_id:e.potvrdil_vecnou_spravnost_id||null,dt_potvrzeni_vecne_spravnosti:e.dt_potvrzeni_vecne_spravnosti||""};if((0,S.unstable_batchedUpdates)(()=>{Ue(a),In(a);const n=!(!e.objednavka_id&&!e.smlouva_id);Se(n),localStorage.setItem("hadOriginalEntity",JSON.stringify(n))}),e.objednavka_id)try{const e=await(0,Qo.v)(o,s,l);e&&"ok"===e.status&&e.data&&e.data.lp_cerpani?(qe(e.data.lp_cerpani),Qe(!0)):(qe([]),Qe(!0))}catch(i){console.error("\u274c Chyba p\u0159i na\u010d\xedt\xe1n\xed LP \u010derp\xe1n\xed:",i),qe([]),Qe(!0)}if(t||e.objednavka_id){const n=t||e.objednavka_id;await Pn(n),(0,S.unstable_batchedUpdates)(()=>{G("order"),e.cislo_objednavky&&oe(e.cislo_objednavky)})}else e.smlouva_id&&(await $n(e.smlouva_id),G("smlouva"))}}catch(d){console.error("\u274c Chyba p\u0159i na\u010d\xedt\xe1n\xed faktury:",d),null===u||void 0===u||u(d.message||"Chyba p\u0159i na\u010d\xedt\xe1n\xed faktury",{type:"error"})}finally{I(!1)}}})()},[null===(e=a.state)||void 0===e?void 0:e.editInvoiceId,me,s,l,hn.length]);const Pn=(0,A.useCallback)(async e=>{if(e&&s&&l){(0,S.unstable_batchedUpdates)(()=>{U(!0),X(null)});try{await(0,P.A6)({orderId:e,token:s,username:l,force:!1});const n=await(0,P.getOrderV2)(e,s,l,!0);n&&n.id?(0,S.unstable_batchedUpdates)(()=>{J(n);const e=n.cislo_objednavky||n.evidencni_cislo||"#".concat(n.id);oe(e)}):(X("Nepoda\u0159ilo se na\u010d\xedst data objedn\xe1vky"),await(0,P.$_)({orderId:e,token:s,username:l}).catch(e=>console.warn("\u26a0\ufe0f Unlock failed:",e)))}catch(a){var n,o,t;console.error("\u274c Chyba p\u0159i na\u010d\xedt\xe1n\xed objedn\xe1vky:",a);const i=423===(null===a||void 0===a||null===(n=a.response)||void 0===n?void 0:n.status)||(null===a||void 0===a||null===(o=a.message)||void 0===o?void 0:o.includes("423"))||(null===a||void 0===a||null===(t=a.message)||void 0===t?void 0:t.includes("zam\u010den"));if(i)return X("Objedn\xe1vka je zam\u010den\xe1 jin\xfdm u\u017eivatelem"),u&&u("Objedn\xe1vka je zam\u010den\xe1 jin\xfdm u\u017eivatelem","error"),U(!1),void setTimeout(()=>{r("/invoices25-list",{replace:!0})},1500);X(a.message||"Chyba p\u0159i na\u010d\xedt\xe1n\xed objedn\xe1vky"),u&&u(a.message||"Chyba p\u0159i na\u010d\xedt\xe1n\xed objedn\xe1vky","error"),i||await(0,P.$_)({orderId:e,token:s,username:l}).catch(e=>console.warn("\u26a0\ufe0f Unlock failed:",e))}finally{U(!1)}}},[s,l,u]),$n=(0,A.useCallback)(async e=>{if(e&&s&&l){(0,S.unstable_batchedUpdates)(()=>{U(!0),X(null)});try{const n=await(0,$.hu)({token:s,username:l,id:e});if(n){const e=n.smlouva||n,o=(0,w.A)((0,w.A)({},e),{},{objednavky:n.objednavky||[],statistiky:n.statistiky||{}});(0,S.unstable_batchedUpdates)(()=>{H(o),G("smlouva")}),Ue(e=>(0,w.A)((0,w.A)({},e),{},{smlouva_id:o.id,order_id:null}));const t=o.cislo_smlouvy||"#".concat(o.id);oe(t),J(null)}else X("Nepoda\u0159ilo se na\u010d\xedst data smlouvy - pr\xe1zdn\xe1 odpov\u011b\u010f z API"),u&&u("Nepoda\u0159ilo se na\u010d\xedst data smlouvy","error")}catch(n){console.error("\u274c Chyba p\u0159i na\u010d\xedt\xe1n\xed smlouvy:",n),X(n.message||"Chyba p\u0159i na\u010d\xedt\xe1n\xed smlouvy"),u&&u(n.message||"Chyba p\u0159i na\u010d\xedt\xe1n\xed smlouvy","error")}finally{U(!1)}}},[s,l,u]);(0,A.useEffect)(()=>()=>{We.order_id&&s&&l&&(0,P.$_)({orderId:We.order_id,token:s,username:l}).catch(e=>console.warn("\u26a0\ufe0f Nepoda\u0159ilo se odemknout objedn\xe1vku:",e))},[We.order_id,s,l]),(0,A.useEffect)(()=>{var e,n,o;if(ge.current)return;const t=null===(e=a.state)||void 0===e?void 0:e.orderIdForLoad,r=null===(n=a.state)||void 0===n?void 0:n.smlouvaIdForLoad;(null===(o=a.state)||void 0===o?void 0:o.openMaterialCorrectness)&&(b(e=>(0,w.A)((0,w.A)({},e),{},{materialCorrectness:!0})),setTimeout(()=>{const e=document.querySelector('[data-section="material-correctness"]');e&&e.scrollIntoView({behavior:"smooth",block:"start"})},300)),t&&s&&l?(async()=>{try{var e,n,o;const r=await(0,P.getOrderV2)(t,s,l,!1);if(!0===(null===r||void 0===r||null===(e=r.lock_info)||void 0===e?void 0:e.locked)&&(null===r||void 0===r||null===(n=r.lock_info)||void 0===n||!n.is_owned_by_me)&&(null===r||void 0===r||null===(o=r.lock_info)||void 0===o||!o.is_expired)){const e=r.lock_info,n=e.locked_by_user_fullname||"u\u017eivatel #".concat(e.locked_by_user_id);return je({lockedByUserName:n,lockedByUserEmail:e.locked_by_user_email||null,lockedByUserTelefon:e.locked_by_user_telefon||null,lockedAt:e.locked_at||null,lockAgeMinutes:e.lock_age_minutes||null,canForceUnlock:!1,orderId:t}),ye(!0),void G("list")}Pn(t),G("order"),Ue(e=>(0,w.A)((0,w.A)({},e),{},{order_id:t,smlouva_id:null}))}catch(r){console.warn("\u26a0\ufe0f Chyba p\u0159i kontrole LOCK:",r),Pn(t),G("order"),Ue(e=>(0,w.A)((0,w.A)({},e),{},{order_id:t,smlouva_id:null}))}})():r&&s&&l&&($n(r),G("smlouva"),Ue(e=>(0,w.A)((0,w.A)({},e),{},{smlouva_id:r,order_id:null})))},[null===(n=a.state)||void 0===n?void 0:n.orderIdForLoad,null===(o=a.state)||void 0===o?void 0:o.smlouvaIdForLoad,s,l,Pn,$n]);const Mn=(0,A.useRef)(!1);(0,A.useEffect)(()=>{if(!ge.current&&me&&Z&&!W&&ce.current&&!Mn.current){var e,n;null===(e=(n=ce.current).expandSectionByName)||void 0===e||e.call(n,"faktury");const o=document.querySelector('[data-invoice-id="'.concat(me,'"]'));o&&(o.scrollIntoView({behavior:"smooth",block:"center"}),Mn.current=!0)}},[me,Z,W]);const Bn=(0,A.useCallback)(async e=>{if(!e||e.length<3)re([]);else{ie(!0);try{var n,o,t,r;const a={query:e,categories:["orders_2025","contracts"],limit:15,archivovano:0,search_all:f},i=await(0,M.C)(a),s=(null===i||void 0===i||null===(n=i.categories)||void 0===n||null===(o=n.orders_2025)||void 0===o?void 0:o.results)||[],l=(null===i||void 0===i||null===(t=i.categories)||void 0===t||null===(r=t.contracts)||void 0===r?void 0:r.results)||[],d=s.filter(e=>{let n=[];try{e.stav_kod&&(n=JSON.parse(e.stav_kod))}catch(r){}const o=["STORNOVANA","ZAMITNUTA"];if(n.some(e=>o.includes(e)))return!1;const t=["ODESLANA","ODESLANO","POTVRZENA","NEUVEREJNIT","FAKTURACE","VECNA_SPRAVNOST","ZKONTROLOVANA","DOKONCENA"];return!!n.some(e=>t.includes(e))&&(f||!0)}),c=l.filter(e=>1===e.aktivni),u=[...d.map(e=>(0,w.A)((0,w.A)({},e),{},{_type:"order"})),...c.map(e=>(0,w.A)((0,w.A)({},e),{},{_type:"smlouva"}))];re(u),de(!0)}catch(a){re([])}finally{ie(!1)}}},[f]);(0,A.useEffect)(()=>{const e=setTimeout(()=>{ne&&se&&Bn(ne)},300);return()=>clearTimeout(e)},[ne,se]),(0,A.useEffect)(()=>{const e=e=>{e.target.closest(".autocomplete-wrapper")||de(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,A.useEffect)(()=>{if(!c("ADMIN"))return;const e=async()=>{try{const e="".concat("https://erdms.zachranka.cz/api.eeo/","spisovka.php/count-today"),n=await fetch(e);if(n.ok){const e=await n.json();"success"===e.status&&Re(e.count)}const o="".concat("https://erdms.zachranka.cz/api.eeo/","spisovka.php/faktury?limit=5&offset=0&rok=2025"),t=await fetch(o);if(t.ok){const e=await t.json();"success"===e.status&&$e(e.data)}}catch(q){console.error("Chyba p\u0159i na\u010d\xedt\xe1n\xed dat ze spisovky:",q)}};e();const n=setInterval(e,3e5);return()=>clearInterval(n)},[]);const Ln=e=>{const{name:n,value:o}=e.target;Ue(e=>(0,w.A)((0,w.A)({},e),{},{[n]:o}))},Fn=async(e,n)=>{U(!0);try{var o,t,r;const n=await(0,P.getOrderV2)(e.id,s,l,!1);if(!0===(null===n||void 0===n||null===(o=n.lock_info)||void 0===o?void 0:o.locked)&&(null===n||void 0===n||null===(t=n.lock_info)||void 0===t||!t.is_owned_by_me)&&(null===n||void 0===n||null===(r=n.lock_info)||void 0===r||!r.is_expired)){const o=n.lock_info,t=o.locked_by_user_fullname||"u\u017eivatel #".concat(o.locked_by_user_id);return U(!1),je({lockedByUserName:t,lockedByUserEmail:o.locked_by_user_email||null,lockedByUserTelefon:o.locked_by_user_telefon||null,lockedAt:o.locked_at||null,lockAgeMinutes:o.lock_age_minutes||null,canForceUnlock:!1,orderId:e.id}),void ye(!0)}}catch(a){console.warn("\u26a0\ufe0f Nepoda\u0159ilo se zkontrolovat lock status:",a)}finally{U(!1)}Ue(n=>(0,w.A)((0,w.A)({},n),{},{order_id:e.id,smlouva_id:null})),oe(n),de(!1),G("order"),H(null),localStorage.setItem("activeOrderEditId",e.id),Pn(e.id)},Vn=(0,A.useCallback)(e=>{if(Z){const e=h(Z);if(!e.allowed)return void(u&&u("\u274c ".concat(e.reason),"error"))}Ue({order_id:e.objednavka_id||"",smlouva_id:e.smlouva_id||null,fa_cislo_vema:e.fa_cislo_vema||"",fa_typ:e.fa_typ||"BEZNA",fa_datum_vystaveni:e.fa_datum_vystaveni||"",fa_datum_splatnosti:e.fa_datum_splatnosti||"",fa_datum_doruceni:e.fa_datum_doruceni||"",fa_castka:e.fa_castka||"",fa_variabilni_symbol:e.fa_variabilni_symbol||"",fa_poznamka:e.fa_poznamka||"",fa_predana_zam_id:e.fa_predana_zam_id||null,fa_datum_predani_zam:e.fa_datum_predani_zam||"",fa_datum_vraceni_zam:e.fa_datum_vraceni_zam||"",file:null,invoice_id:e.id}),fe(e.id),he(!0);const n=!(!e.objednavka_id&&!e.smlouva_id);Se(n),localStorage.setItem("hadOriginalEntity",JSON.stringify(n)),window.scrollTo({top:0,behavior:"smooth"}),u&&u("\ud83d\udcdd Faktura na\u010dtena pro \xfapravu","info")},[u,Z,h]),Wn=(0,A.useCallback)(e=>{Je(n=>{const o="function"===typeof e?e(n):e;if(o&&o.length>0&&!on.current){const e=o[0];e&&e.spisovka_dokument_id&&e.spisovka_file_id&&!e.serverId&&(on.current={dokument_id:e.spisovka_dokument_id,spisovka_priloha_id:e.spisovka_file_id,filename:e.name},localStorage.setItem("spisovka_active_dokument",e.spisovka_dokument_id))}return o})},[]),Un=(0,A.useCallback)(e=>{if(e)if(on.current){const n=on.current;e.spisovka_dokument_id!==n.dokument_id&&e.spisovka_file_id!==n.spisovka_priloha_id||(on.current=null,localStorage.removeItem("spisovka_active_dokument"))}else e.spisovka_dokument_id&&localStorage.removeItem("spisovka_active_dokument");else console.warn("\u26a0\ufe0f handleAttachmentRemoved: removedAttachment je undefined")},[]),Zn=(0,A.useCallback)(async(e,n,o)=>new Promise(t=>{const r=(0,V.jsxs)("div",{style:{fontFamily:"system-ui",lineHeight:"1.6"},children:[(0,V.jsx)("p",{style:{marginBottom:"12px",fontWeight:600},children:"Tento dokument ze Spisovky ji\u017e byl d\u0159\xedve zaevidov\xe1n:"}),o&&(0,V.jsxs)("div",{style:{padding:"12px",backgroundColor:"#fef3c7",borderRadius:"6px",fontSize:"13px",marginBottom:"12px"},children:[(0,V.jsxs)("div",{children:[(0,V.jsx)("strong",{children:"Faktura:"})," ",o.fa_cislo_vema||o.faktura_id]}),(0,V.jsxs)("div",{children:[(0,V.jsx)("strong",{children:"Datum:"})," ",o.zpracovano_kdy?new Date(o.zpracovano_kdy).toLocaleString("cs-CZ"):"N/A"]}),(0,V.jsxs)("div",{children:[(0,V.jsx)("strong",{children:"U\u017eivatel:"})," ",o.uzivatel_id]})]}),(0,V.jsx)("p",{style:{marginBottom:"8px"},children:"Chcete p\u0159esto p\u0159idat tuto p\u0159\xedlohu k nov\xe9 faktu\u0159e?"}),(0,V.jsx)("p",{style:{fontSize:"12px",color:"#78716c",marginTop:"8px"},children:"\u26a0\ufe0f Vytvo\u0159\xed se duplicitn\xed z\xe1znam v trackingu."})]});be({isOpen:!0,title:"\u26a0\ufe0f Dokument ji\u017e evidov\xe1n",message:r,onConfirm:async()=>{try{const o=await Nn({username:l,token:s,dokument_id:e.dokument_id,spisovka_priloha_id:e.spisovka_priloha_id,faktura_id:n,fa_cislo_vema:We.fa_cislo_vema,stav:"ZAEVIDOVANO",poznamka:"DUPLICITA - Auto-tracking: P\u0159\xedloha ze Spisovky (file_id: ".concat(e.spisovka_priloha_id,")"),force:!0});o.success?u&&u("\u2705 P\u0159\xedloha p\u0159id\xe1na (duplicitn\xed z\xe1znam vytvo\u0159en)",{type:"success"}):console.warn("\u26a0\ufe0f Force tracking se nezda\u0159il:",o)}catch(o){console.error("\u274c Force tracking error:",o)}be({isOpen:!1,title:"",message:"",onConfirm:null,onCancel:null}),t(!0)},onCancel:()=>{be({isOpen:!1,title:"",message:"",onConfirm:null,onCancel:null}),t(!1)}})}),[l,s,We.fa_cislo_vema,be,u]),Jn=(0,A.useRef)(We.fa_cislo_vema);(0,A.useEffect)(()=>{Jn.current=We.fa_cislo_vema},[We.fa_cislo_vema]);const Kn=(0,A.useCallback)(async(e,n)=>{if(e)try{const n=on.current;if(n){const o=await Nn({username:l,token:s,dokument_id:n.dokument_id,spisovka_priloha_id:n.spisovka_priloha_id,faktura_id:e,fa_cislo_vema:Jn.current,stav:"ZAEVIDOVANO",poznamka:"Auto-tracking: P\u0159\xedloha ze Spisovky (file_id: ".concat(n.spisovka_priloha_id,")"),force:!1});o.success?on.current=null:o.conflict&&(console.warn("\u26a0\ufe0f Conflict detekov\xe1n:",o),await Zn(n,e,o.existingRecord),on.current=null)}}catch(o){console.error("\u26a0\ufe0f Nepoda\u0159ilo se ozna\u010dit Spisovka dokument jako zpracovan\xfd:",o),on.current=null,localStorage.removeItem("spisovka_active_dokument")}},[l,s,Zn]),Hn=(0,A.useCallback)((e,n)=>{if(me)return{isValid:!0,isISDOC:!1,categories:{}};if(n&&n.name&&n.name.toLowerCase().endsWith(".isdoc"))return{isValid:!0,isISDOC:!0,categories:{}};const o={objednateli:{label:"Informace o objednateli",errors:[]},schvaleni:{label:"Schv\xe1len\xed n\xe1kupu PO",errors:[]}};null!==e&&void 0!==e&&e.fa_cislo_vema||o.objednateli.errors.push("\u010c\xedslo faktury"),null!==e&&void 0!==e&&e.fa_datum_splatnosti||o.objednateli.errors.push("Datum splatnosti"),null!==e&&void 0!==e&&e.fa_castka||o.objednateli.errors.push("\u010c\xe1stka");return{isValid:0===[...o.objednateli.errors,...o.schvaleni.errors].length,isISDOC:!1,categories:o}},[me]),Yn=(0,A.useCallback)(async e=>{try{var n;const e={token:s,username:l,order_id:We.order_id||null,smlouva_id:We.smlouva_id||null,fa_cislo_vema:We.fa_cislo_vema,fa_typ:We.fa_typ||"BEZNA",fa_datum_vystaveni:We.fa_datum_vystaveni,fa_datum_splatnosti:We.fa_datum_splatnosti||null,fa_datum_doruceni:We.fa_datum_doruceni||null,fa_castka:We.fa_castka,fa_poznamka:We.fa_poznamka||"",fa_dorucena:We.fa_datum_doruceni?1:0,fa_strediska_kod:JSON.stringify(We.fa_strediska_kod||[]),fa_predana_zam_id:We.fa_predana_zam_id||null,fa_datum_predani_zam:We.fa_datum_predani_zam||null,fa_datum_vraceni_zam:We.fa_datum_vraceni_zam||null},o=await(0,R.We)(e),t=(null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.invoice_id)||(null===o||void 0===o?void 0:o.invoice_id)||(null===o||void 0===o?void 0:o.id);if(!t)throw console.error("\u274c Neplatn\xfd result z createInvoiceV2:",o),new Error("Nepoda\u0159ilo se vytvo\u0159it fakturu v DB - backend nevr\xe1til ID");return fe(t),(We.order_id||We.smlouva_id)&&Se(!0),We.order_id&&Z&&await Pn(We.order_id),We.smlouva_id&&K&&await $n(We.smlouva_id),t}catch(q){throw console.error("\u274c Chyba p\u0159i vytv\xe1\u0159en\xed faktury v DB:",q),q}},[s,l,We]),Gn=(0,A.useCallback)((e,n)=>{try{const n=(0,Xo.GC)(e,{strediska:hn,orderStrediska:(null===Z||void 0===Z?void 0:Z.strediska_kod)||We.fa_strediska_kod});Ue(e=>(0,w.A)((0,w.A)({},e),{},{fa_cislo_vema:n.fa_cislo_vema||e.fa_cislo_vema,fa_datum_vystaveni:n.fa_datum_vystaveni||e.fa_datum_vystaveni,fa_datum_splatnosti:n.fa_datum_splatnosti||e.fa_datum_splatnosti,fa_castka:n.fa_castka||e.fa_castka,fa_strediska_kod:n.fa_strediska_kod||e.fa_strediska_kod,fa_poznamka:n.fa_poznamka||e.fa_poznamka})),u&&u("\u2705 Data z ISDOC byla \xfasp\u011b\u0161n\u011b na\u010dtena\n\n\u010c\xedslo faktury: ".concat(n.fa_cislo_vema,"\n\u010c\xe1stka: ").concat(n.fa_castka," K\u010d"),{type:"success"})}catch(q){console.error("\u274c Chyba p\u0159i zpracov\xe1n\xed ISDOC:",q),u&&u("Chyba p\u0159i zpracov\xe1n\xed ISDOC: ".concat(q.message),{type:"error"})}},[We,Z,hn,u]),qn=(0,A.useCallback)(e=>{try{Ue(n=>{const o={};return e.variabilniSymbol&&(o.fa_cislo_vema=e.variabilniSymbol),e.datumVystaveni&&(o.fa_datum_vystaveni=e.datumVystaveni),e.datumSplatnosti&&(o.fa_datum_splatnosti=e.datumSplatnosti),e.castka&&(o.fa_castka=e.castka),e.spisovka_dokument_id&&e.spisovka_priloha_id&&n.file&&(o.file=(0,w.A)((0,w.A)({},n.file),{},{spisovka_dokument_id:e.spisovka_dokument_id,spisovka_file_id:e.spisovka_priloha_id})),(0,w.A)((0,w.A)({},n),o)})}catch(q){console.error("\u274c Chyba p\u0159i aplikaci OCR dat:",q),u&&u("Chyba p\u0159i aplikaci OCR dat: ".concat(q.message),{type:"error"})}},[u]),Xn=(0,A.useCallback)((e,n,o)=>{e.preventDefault(),e.stopPropagation();const t=e.clientX,r=e.clientY,a=(0,w.A)({},Ne),i=e=>{const n=e.clientX-t,i=e.clientY-r;Te(e=>{let t=(0,w.A)({},e);const r=620,s=400;if("move"===o)t.x=Math.max(0,Math.min(a.x+n,window.innerWidth-e.w)),t.y=Math.max(0,Math.min(a.y+i,window.innerHeight-e.h));else if("right"===o)t.w=Math.max(r,a.w+n);else if("left"===o){const e=Math.max(r,a.w-n);e>r&&(t.w=e,t.x=a.x+n)}else if("top"===o){const e=Math.max(s,a.h-i);e>s&&(t.h=e,t.y=a.y+i)}else if("bottom"===o)t.h=Math.max(s,a.h+i);else if("top-left"===o){const e=Math.max(r,a.w-n),o=Math.max(s,a.h-i);e>r&&(t.w=e,t.x=a.x+n),o>s&&(t.h=o,t.y=a.y+i)}else if("top-right"===o){const e=Math.max(s,a.h-i);t.w=Math.max(r,a.w+n),e>s&&(t.h=e,t.y=a.y+i)}else if("bottom-left"===o){const e=Math.max(r,a.w-n);t.h=Math.max(s,a.h+i),e>r&&(t.w=e,t.x=a.x+n)}else"bottom-right"===o&&(t.w=Math.max(r,a.w+n),t.h=Math.max(s,a.h+i));return t})},s=()=>{document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",s)},[Ne]),Qn=async()=>{if(!(me?En:!(!We.fa_cislo_vema&&!We.fa_castka&&!We.order_id&&!We.file))){try{localStorage.removeItem("invoiceForm_".concat(d)),localStorage.removeItem("invoiceAttach_".concat(d)),localStorage.removeItem("invoiceEdit_".concat(d)),localStorage.removeItem("invoiceOrigEntity_".concat(d)),localStorage.removeItem("spisovka_active_dokument")}catch(n){console.warn("Chyba p\u0159i maz\xe1n\xed localStorage:",n)}return void r(-1)}const e=me?"M\xe1te neulo\u017een\xe9 zm\u011bny faktury. Chcete odej\xedt bez ulo\u017een\xed? V\u0161echny zm\u011bny budou ztraceny.":We.file?"M\xe1te rozd\u011blanou fakturu s nahranou p\u0159\xedlohou. Chcete zru\u0161it evidenci? V\u0161echna data a nahran\xe9 p\u0159\xedlohy budou ztraceny.":"M\xe1te rozd\u011blanou fakturu. Chcete zru\u0161it evidenci? V\u0161echna vypln\u011bn\xe1 data budou ztracena.";be({isOpen:!0,title:me?"\u26a0\ufe0f Neulo\u017een\xe9 zm\u011bny":"\u26a0\ufe0f Zru\u0161it evidenci faktury?",message:e,onConfirm:async()=>{be({isOpen:!1,title:"",message:"",onConfirm:null,onCancel:null});if(!(me&&Number(me)>0&&Ae)){const e=Ze.filter(e=>e.serverId),o=me&&Number(me)>0;if(e.length>0&&o)for(const t of e)try{await(0,R.vd)({token:s,username:l,faktura_id:me,priloha_id:t.serverId,objednavka_id:We.order_id||null,hard_delete:1})}catch(n){console.error("\u274c Chyba p\u0159i maz\xe1n\xed p\u0159\xedlohy ".concat(t.name,":"),n)}else e.length}Ue({fa_cislo_vema:"",fa_datum_vystaveni:"",fa_datum_zdanitelneho_plneni:"",fa_datum_splatnosti:"",fa_castka:"",order_id:"",dodavatel_id:"",stredisko_id:"",typ_faktury:"",fa_poznamka:"",fa_predana_zam_id:"",file:null,klasifikace:null}),Je([]);try{localStorage.removeItem("invoiceForm_".concat(d)),localStorage.removeItem("invoiceAttach_".concat(d)),localStorage.removeItem("invoiceEdit_".concat(d)),localStorage.removeItem("invoiceOrigEntity_".concat(d)),localStorage.removeItem("spisovka_active_dokument")}catch(n){console.warn("Chyba p\u0159i maz\xe1n\xed localStorage:",n)}r(-1)},onCancel:()=>{be({isOpen:!1,title:"",message:"",onConfirm:null,onCancel:null})}})},eo=e=>(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.value)||e,no=e=>{let{values:n=[],onChange:o,options:t=[],placeholder:r,disabled:a=!1}=e;const i=Array.isArray(n)?n:[],s=tn.strediska,l=pn.strediska||"",d=(0,A.useRef)(null),c=(0,A.useRef)(null),u=(0,A.useRef)(null),p=((e,n)=>{if(!n)return e;const o=n.toLowerCase();return e.filter(e=>(e.label||e).toLowerCase().includes(o))})(t,l);(0,A.useEffect)(()=>{if(!s)return;const e=e=>{d.current&&c.current&&!d.current.contains(e.target)&&!c.current.contains(e.target)&&rn(e=>(0,w.A)((0,w.A)({},e),{},{strediska:!1}))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s]),(0,A.useEffect)(()=>{if(s&&c.current&&d.current){const e=()=>{if(!c.current||!d.current)return;const e=c.current.getBoundingClientRect(),n=d.current;n.style.left=e.left+"px",n.style.width=e.width+"px",n.style.top=e.bottom+2+"px"};return e(),window.addEventListener("scroll",e,{passive:!0,capture:!0}),window.addEventListener("resize",e,{passive:!0}),()=>{window.removeEventListener("scroll",e,{capture:!0}),window.removeEventListener("resize",e)}}},[s]),(0,A.useEffect)(()=>{if(s&&u.current){const e=requestAnimationFrame(()=>{var e;null===(e=u.current)||void 0===e||e.focus()});return()=>cancelAnimationFrame(e)}},[s]);const m=i.length>0?i.map(e=>{const n=t.find(n=>n.value===e||n===e);return n?eo(n):e}).join(", "):r;return(0,V.jsxs)(ti,{isOpen:s,children:[(0,V.jsx)(ri,{ref:c,onClick:()=>{return!a&&(e="strediska",void rn(n=>(0,w.A)((0,w.A)({},n),{},{[e]:!n[e]})));var e},disabled:a,placeholder:0===i.length?"true":"false",value:i.length>0?"selected":"",isOpen:s,children:(0,V.jsx)(ai,{isEmpty:0===i.length,children:m})}),s&&!a&&(0,V.jsxs)(ii,{ref:d,children:[(0,V.jsxs)(si,{children:[(0,V.jsx)(di,{children:(0,V.jsx)(dn.A,{size:16})}),(0,V.jsx)(li,{ref:u,type:"text",placeholder:"Vyhledat st\u0159edisko...",value:l,onChange:e=>mn(n=>(0,w.A)((0,w.A)({},n),{},{strediska:e.target.value}))})]}),p.map((e,n)=>{const t=e.value||e,r=i.includes(t);return(0,V.jsxs)(ci,{level:e.level||0,onClick:()=>(e=>{const n=e.value||e,t=i.includes(n)?i.filter(e=>e!==n):[...i,n];o({target:{value:t}})})(e),children:[(0,V.jsx)("input",{type:"checkbox",checked:r,readOnly:!0}),(0,V.jsx)("span",{children:eo(e)})]},e.value||n)}),0===p.length&&(0,V.jsx)("div",{style:{padding:"1rem",textAlign:"center",color:"#9ca3af"},children:"\u017d\xe1dn\xe9 st\u0159edisko nenalezeno"})]})]})};if(!(hn.length>0&&_n.length>0&&wn.length>0))return(0,V.jsxs)(Kr,{children:[(0,V.jsx)(Yr,{children:(0,V.jsxs)(Gr,{children:[(0,V.jsx)(E.g,{icon:O.p4e}),"Na\u010d\xedtaj\xed se data..."]})}),(0,V.jsx)(ia,{children:(0,V.jsx)(sa,{children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",gap:"1.5rem"},children:[(0,V.jsx)("div",{style:{width:"80px",height:"80px",border:"6px solid #e5e7eb",borderTop:"6px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,V.jsx)("div",{style:{color:"#6b7280",fontSize:"1.1rem",fontWeight:"500"},children:"Na\u010d\xedtaj\xed se \u010d\xedseln\xedky..."}),(0,V.jsx)("div",{style:{color:"#9ca3af",fontSize:"0.9rem"},children:"St\u0159ediska, typy faktur, zam\u011bstnanci"})]})})}),(0,V.jsx)("style",{children:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        "})]});const oo=(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(Yr,{children:[(0,V.jsxs)(Gr,{children:[(0,V.jsx)(E.g,{icon:me&&ve?O.MT7:O.p4e}),me&&ve?g?"Dopln\u011bn\xed v\u011bcn\xe9 spr\xe1vnosti k faktu\u0159e":"Upravit fakturu":"Zaevidovat fakturu"]}),(0,V.jsxs)(qr,{children:[c("ADMIN")&&(0,V.jsxs)(ea,{ref:Ve,onMouseEnter:()=>{if(Be(!0),Ve.current){const e=Ve.current.getBoundingClientRect(),n=350;let o=e.right-n;o<10&&(o=10),o+n>window.innerWidth-10&&(o=window.innerWidth-n-10),Fe({top:e.bottom+10,left:o})}},onMouseLeave:()=>Be(!1),children:[(0,V.jsxs)(Xr,{onClick:()=>{Be(!1),Oe(!Ee)},title:Ee?"Zav\u0159\xedt Spisovka InBox":"Otev\u0159\xedt Spisovka InBox",style:{backgroundColor:Ee?"rgba(16, 185, 129, 0.2)":"transparent",color:Ee?"#10b981":"#9ca3af"},children:[(0,V.jsx)(E.g,{icon:O.ReK}),De>0&&(0,V.jsx)(Qr,{children:De})]}),(0,V.jsxs)(na,{show:Me&&Pe.length>0,$top:Le.top,$left:Le.left,children:[(0,V.jsx)(oa,{children:"Posledn\xedch 5 z\xe1znam\u016f"}),Pe.map(e=>(0,V.jsxs)(ta,{children:[(0,V.jsx)(ra,{children:e.nazev}),(0,V.jsxs)(aa,{children:[(0,V.jsxs)("span",{children:["\ud83d\udcce ",e.pocet_priloh," p\u0159\xedlohy"]}),(0,V.jsxs)("span",{children:["#",e.dokument_id]})]})]},e.dokument_id))]})]}),(0,V.jsx)(Xr,{onClick:()=>{k(e=>!e)},title:y?"Norm\xe1ln\xed re\u017eim":"Cel\xe1 obrazovka",children:(0,V.jsx)(E.g,{icon:y?O.gr3:O.oZK})}),(0,V.jsx)(Xr,{onClick:Qn,title:"Zav\u0159\xedt a vr\xe1tit se na seznam faktur",children:(0,V.jsx)(E.g,{icon:O.GRI})})]})]}),(0,V.jsxs)(ia,{$fullscreen:y,children:[(0,V.jsxs)(sa,{children:[(0,V.jsx)(la,{style:{minHeight:"0px",padding:"0"}}),(0,V.jsxs)(da,{children:[(0,V.jsxs)(va,{children:[(0,V.jsxs)(ha,{onClick:()=>_("invoiceData"),children:[(0,V.jsxs)(ga,{children:[(0,V.jsx)(E.g,{icon:O.$O8}),"\xdadaje faktury",me&&(0,V.jsxs)("span",{style:{marginLeft:"1rem",color:"rgba(255, 255, 255, 0.9)",fontSize:"0.9rem",fontWeight:400},children:["- Re\u017eim \xfaprav #",me]})]}),(0,V.jsxs)(xa,{children:[g&&(0,V.jsx)("span",{style:{marginRight:"1rem",background:"rgba(255, 255, 255, 0.95)",padding:"0.25rem 0.75rem",borderRadius:"4px",color:"#1e40af",fontSize:"0.8rem",fontWeight:600,border:"2px solid rgba(255, 255, 255, 0.3)"},children:"POUZE PRO \u010cTEN\xcd"}),me&&!g&&(0,V.jsxs)("button",{onClick:e=>{e.stopPropagation(),ge.current=!0,nn(!1);try{localStorage.removeItem("invoiceForm_".concat(d)),localStorage.removeItem("invoiceAttach_".concat(d)),localStorage.removeItem("invoiceEdit_".concat(d)),localStorage.removeItem("invoiceOrigEntity_".concat(d))}catch(n){console.warn("Chyba p\u0159i maz\xe1n\xed localStorage:",n)}fe(null),he(!1),Je([]),In(null),On(!1),ze(!1),Se(!1),ee({}),Rn.current=!1,Ue({order_id:"",smlouva_id:null,fa_cislo_vema:"",fa_typ:"BEZNA",fa_datum_doruceni:Br(new Date),fa_datum_vystaveni:"",fa_datum_splatnosti:"",fa_castka:"",fa_poznamka:"",fa_strediska_kod:[],file:null,fa_predana_zam_id:null,fa_datum_predani_zam:"",fa_datum_vraceni_zam:"",vecna_spravnost_umisteni_majetku:"",vecna_spravnost_poznamka:"",vecna_spravnost_potvrzeno:0,potvrdil_vecnou_spravnost_id:null,dt_potvrzeni_vecne_spravnosti:""}),J(null),H(null),oe(""),de(!1),G("order"),r(a.pathname,{replace:!0,state:{}}),u&&u("\u2728 Formul\xe1\u0159 resetov\xe1n pro novou fakturu","info"),setTimeout(()=>{ge.current=!1,nn(!0)},100)},style:{background:"#dc2626",color:"white",border:"none",padding:"0.4rem 0.8rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",marginRight:"0.5rem",display:"flex",alignItems:"center",gap:"0.4rem"},title:"Zru\u0161it \xfapravy a vr\xe1tit se k nov\xe9mu z\xe1znamu",children:[(0,V.jsx)(E.g,{icon:O.GRI})," Zru\u0161it \xfapravu"]}),(0,V.jsx)(_a,{$collapsed:!x.invoiceData,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]})]}),(0,V.jsxs)(ba,{$collapsed:!x.invoiceData,children:[q&&(0,V.jsxs)(Da,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),q]}),(0,V.jsxs)(ya,{$isEditing:!0,children:[(0,V.jsx)(ka,{$columns:"1fr",children:(0,V.jsxs)(ja,{children:[(0,V.jsx)(wa,{children:"smlouva"===Y?"N\xe1zev smlouvy":"P\u0159edm\u011bt objedn\xe1vky"}),(0,V.jsx)("div",{style:{minHeight:"62px",padding:"0.75rem",display:"flex",alignItems:"center",background:Z||K?"#f0f9ff":"#f9fafb",border:Z||K?"2px solid #3b82f6":"2px solid #e5e7eb",borderRadius:"8px",color:Z||K?"#1e40af":"#9ca3af",fontWeight:Z||K?"600":"400",fontSize:"0.95rem",boxSizing:"border-box"},children:"order"===Y&&Z?Z.predmet||"\u2014":"smlouva"===Y&&K&&(K.nazev_smlouvy||K.nazev)||"\u2014"})]})}),(0,V.jsxs)(ka,{$columns:"2fr 1fr 1fr",children:[(0,V.jsxs)(ja,{style:{width:"100%"},children:[(0,V.jsx)(wa,{children:"Vyberte objedn\xe1vku nebo smlouvu"}),(0,V.jsxs)($a,{className:"autocomplete-wrapper",style:{width:"100%",position:"relative"},children:[me&&Ae&&(We.order_id||We.smlouva_id)&&!we&&(0,V.jsx)("div",{onClick:()=>{be({isOpen:!0,title:"\u26a0\ufe0f Zm\u011bna objedn\xe1vky/smlouvy",message:(0,V.jsxs)("div",{style:{lineHeight:"1.6"},children:[(0,V.jsx)("p",{style:{marginBottom:"1rem",fontWeight:600},children:"Opravdu chcete zm\u011bnit p\u0159i\u0159azen\xed faktury k jin\xe9 objedn\xe1vce nebo smlouv\u011b?"}),(0,V.jsxs)("div",{style:{background:"#fef3c7",border:"2px solid #f59e0b",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[(0,V.jsx)("strong",{style:{color:"#92400e"},children:"\u26a0\ufe0f VAROV\xc1N\xcd - Mo\u017en\xe9 dopady:"}),(0,V.jsxs)("ul",{style:{margin:"0.5rem 0 0 1.25rem",color:"#78350f"},children:[(0,V.jsxs)("li",{children:["P\u016fvodn\xed objedn\xe1vka m\u016f\u017ee b\xfdt vr\xe1cena na ",(0,V.jsx)("strong",{children:"v\u011bcnou spr\xe1vnost"})]}),(0,V.jsxs)("li",{children:["M\u016f\u017ee doj\xedt ke zm\u011bn\u011b ",(0,V.jsx)("strong",{children:"workflow stavu"})," objedn\xe1vky"]}),(0,V.jsxs)("li",{children:["\u010c\xe1stka faktury ovlivn\xed ",(0,V.jsx)("strong",{children:"\u010derp\xe1n\xed rozpo\u010dtu"})," nov\xe9 entity"]}),(0,V.jsx)("li",{children:"Historie a notifikace budou nav\xe1z\xe1ny na novou entitu"})]})]}),(0,V.jsx)("p",{style:{fontSize:"0.9rem",color:"#6b7280"},children:"Po odem\u010den\xed budete moci vybrat jinou objedn\xe1vku nebo smlouvu."})]}),onConfirm:()=>{ze(!0),be({isOpen:!1,title:"",message:"",onConfirm:null,onCancel:null})},onCancel:()=>{be({isOpen:!1,title:"",message:"",onConfirm:null,onCancel:null})}})},style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"#f59e0b",fontSize:"0.875rem",zIndex:1,cursor:"pointer",transition:"color 0.2s"},onMouseEnter:e=>e.currentTarget.style.color="#d97706",onMouseLeave:e=>e.currentTarget.style.color="#f59e0b",title:"Klikn\u011bte pro odem\u010den\xed zm\u011bny objedn\xe1vky/smlouvy",children:(0,V.jsx)(E.g,{icon:O.DW4})}),(0,V.jsx)(Ma,{type:"text",value:ne,onChange:e=>{const n=e.target.value;oe(n),de(!0),n!==ne&&(Ue(e=>(0,w.A)((0,w.A)({},e),{},{order_id:""})),J(null))},onFocus:()=>de(!0),disabled:g||!!i||me&&Ae&&(We.order_id||We.smlouva_id)&&!we,placeholder:"Za\u010dn\u011bte ps\xe1t ev. \u010d\xedslo objedn\xe1vky nebo smlouvy (min. 3 znaky)...",style:{width:"100%",paddingLeft:me&&Ae&&(We.order_id||We.smlouva_id)&&!we?"2.5rem":"0.75rem",paddingRight:ne?"2.5rem":"0.75rem"}}),ne&&(0,V.jsx)(Ba,{type:"button",onClick:()=>{oe(""),re([]),de(!1),Ue(e=>(0,w.A)((0,w.A)({},e),{},{order_id:"",smlouva_id:null})),J(null),H(null),G("order")},title:"Vymazat text",children:(0,V.jsx)(E.g,{icon:O.GRI})}),se&&ne&&(0,V.jsx)(La,{children:ae?(0,V.jsxs)(Ja,{children:[(0,V.jsx)(E.g,{icon:O.p4e,spin:!0})," Vyhled\xe1v\xe1m..."]}):ne.length<3?(0,V.jsxs)(Za,{children:[(0,V.jsx)(E.g,{icon:O.MjD,style:{marginRight:"0.5rem"}}),"Zadejte alespo\u0148 3 znaky pro vyhled\xe1v\xe1n\xed"]}):te.length>0?te.map(e=>{const n="order"===e._type,o="smlouva"===e._type;if(n){const n=e.stav||"",o=(e=>{const n=(e||"").toLowerCase();return n.includes("dokon\u010den")||n.includes("zkontrolovan")?{bg:"#d1fae5",text:"#065f46"}:n.includes("fakturac")||n.includes("v\u011bcn\xe1 spr\xe1vnost")?{bg:"#dbeafe",text:"#1e40af"}:n.includes("odeslan")||n.includes("potvr")?{bg:"#e0e7ff",text:"#3730a3"}:n.includes("schval")?{bg:"#fef3c7",text:"#92400e"}:{bg:"#e5e7eb",text:"#374151"}})(n);return(0,V.jsxs)(Fa,{onClick:()=>(async e=>{const n=e.cislo_objednavky||e.evidencni_cislo||"#".concat(e.id);cn.default.setCurrentUser(d);const o=await cn.default.loadDraft();if(o&&o.formData&&parseInt(o.formData.id)===parseInt(e.id)){const n=o.formData.cislo_objednavky||o.formData.evidencni_cislo||"#".concat(e.id);return void be({isOpen:!0,title:"\u26a0\ufe0f Objedn\xe1vka je otev\u0159en\xe1 na formul\xe1\u0159i",message:"Objedn\xe1vka ".concat(n," je pr\xe1v\u011b otev\u0159en\xe1 v edita\u010dn\xedm formul\xe1\u0159i.\n\n\u26a0\ufe0f NEJD\u0158\xcdVE JI ZAV\u0158ETE!\n\nTeprve pot\xe9 m\u016f\u017eete p\u0159id\xe1vat nebo aktualizovat faktury."),onConfirm:()=>{be({isOpen:!1,title:"",message:"",onConfirm:null,onCancel:null})},onCancel:null})}U(!0);try{var t,r,a;const n=await(0,P.getOrderV2)(e.id,s,l,!1);if(!0===(null===n||void 0===n||null===(t=n.lock_info)||void 0===t?void 0:t.locked)&&(null===n||void 0===n||null===(r=n.lock_info)||void 0===r||!r.is_owned_by_me)&&(null===n||void 0===n||null===(a=n.lock_info)||void 0===a||!a.is_expired)){const o=n.lock_info,t=o.locked_by_user_fullname||"u\u017eivatel #".concat(o.locked_by_user_id);return U(!1),je({lockedByUserName:t,lockedByUserEmail:o.locked_by_user_email||null,lockedByUserTelefon:o.locked_by_user_telefon||null,lockedAt:o.locked_at||null,lockAgeMinutes:o.lock_age_minutes||null,canForceUnlock:!1,orderId:e.id}),void ye(!0)}}catch(i){console.warn("\u26a0\ufe0f Nepoda\u0159ilo se zkontrolovat lock status:",i)}finally{U(!1)}await Fn(e,n)})(e),children:[(0,V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.5rem"},children:[(0,V.jsxs)(Va,{style:{flex:1},children:[(0,V.jsx)(Ua,{$color:"#3b82f6",$textColor:"white",style:{marginRight:"0.5rem"},children:"OBJ"}),e.cislo_objednavky||e.evidencni_cislo||"#".concat(e.id),n&&(0,V.jsx)(Ua,{$color:o.bg,$textColor:o.text,style:{marginLeft:"0.5rem"},children:n}),e.max_cena_s_dph&&(0,V.jsxs)(Ua,{$color:"#fef3c7",$textColor:"#92400e",style:{marginLeft:"0.5rem"},children:[parseFloat(e.max_cena_s_dph).toLocaleString("cs-CZ")," K\u010d"]})]}),void 0!==e.pocet_faktur&&(0,V.jsxs)(Ua,{$color:e.pocet_faktur>0?"#e0f2fe":"#f1f5f9",$textColor:e.pocet_faktur>0?"#0369a1":"#64748b",style:{flexShrink:0,display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,V.jsx)(E.g,{icon:O.p4e,style:{fontSize:"0.7rem"}}),e.pocet_faktur||0]})]}),(0,V.jsxs)(Wa,{children:[e.predmet&&(0,V.jsxs)("span",{children:[(0,V.jsx)("strong",{children:"P\u0159edm\u011bt:"})," ",e.predmet]}),e.dodavatel_nazev&&(0,V.jsxs)("span",{children:[(0,V.jsx)("strong",{children:e.dodavatel_nazev}),e.dodavatel_ico&&" (I\u010cO: ".concat(e.dodavatel_ico,")")]})]})]},"order-".concat(e.id))}return o?(0,V.jsxs)(Fa,{onClick:()=>{G("smlouva"),$n(e.id),de(!1)},children:[(0,V.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.5rem"},children:(0,V.jsxs)(Va,{style:{flex:1},children:[(0,V.jsx)(Ua,{$color:"#10b981",$textColor:"white",style:{marginRight:"0.5rem"},children:"SML"}),e.cislo_smlouvy,e.hodnota_s_dph&&(0,V.jsxs)(Ua,{$color:"#fef3c7",$textColor:"#92400e",style:{marginLeft:"0.5rem"},children:[parseFloat(e.hodnota_s_dph).toLocaleString("cs-CZ")," K\u010d"]})]})}),(0,V.jsxs)(Wa,{children:[e.nazev_smlouvy&&(0,V.jsxs)("span",{children:[(0,V.jsx)("strong",{children:"N\xe1zev:"})," ",e.nazev_smlouvy]}),e.nazev_firmy&&(0,V.jsxs)("span",{children:[(0,V.jsx)("strong",{children:e.nazev_firmy}),e.ico&&" (I\u010cO: ".concat(e.ico,")")]})]})]},"smlouva-".concat(e.id)):null}):(0,V.jsxs)(Za,{children:[(0,V.jsx)(E.g,{icon:O.MjD,style:{marginRight:"0.5rem"}}),"\u017d\xe1dn\xe9 objedn\xe1vky ani smlouvy nenalezeny",(0,V.jsx)("div",{style:{fontSize:"0.75rem",marginTop:"0.5rem",color:"#9ca3af"},children:"Hledaj\xed se odeslan\xe9 objedn\xe1vky a aktivn\xed smlouvy"})]})})]}),(0,V.jsx)(Ra,{children:i?"Objedn\xe1vka je p\u0159edvypln\u011bna z kontextu":"Nepovinn\xe9 - pokud faktura nen\xed v\xe1z\xe1na na objedn\xe1vku ani smlouvu, nechte pr\xe1zdn\xe9"})]}),(0,V.jsxs)(ja,{children:[(0,V.jsx)(wa,{children:"smlouva"===Y?"Platnost do":"Datum vytvo\u0159en\xed"}),(0,V.jsx)("div",{style:{height:"48px",padding:"1px 0.875rem",display:"flex",alignItems:"center",background:Z||K?"#fef3c7":"#f9fafb",border:Z||K?"2px solid #f59e0b":"2px solid #e5e7eb",borderRadius:"8px",color:Z||K?"#92400e":"#9ca3af",fontWeight:Z||K?"600":"400",fontSize:"0.875rem",boxSizing:"border-box"},children:(()=>{if(Z){const e=Z.dt_objednavky||Z.datum_objednavky||Z.created_at||Z.dt_vytvoreni||Z.datum_vytvoreni;if(e)return(0,F.iS)(e)}return K&&K.platnost_do?(0,F.iS)(K.platnost_do):"\u2014"})()})]}),(0,V.jsxs)(ja,{children:[(0,V.jsx)(wa,{children:"smlouva"===Y?"Celkem pln\u011bn\xed s DPH":"Celkov\xe1 cena"}),(0,V.jsx)("div",{style:{height:"48px",padding:"1px 0.875rem",display:"flex",alignItems:"center",justifyContent:"flex-end",background:Z||K?"#f0fdf4":"#f9fafb",border:Z||K?"2px solid #10b981":"2px solid #e5e7eb",borderRadius:"8px",color:Z||K?"#065f46":"#9ca3af",fontWeight:Z||K?"700":"400",fontSize:"0.875rem",boxSizing:"border-box"},children:(()=>{let e=null;return"order"===Y&&null!==Z&&void 0!==Z&&Z.max_cena_s_dph?e=Z.max_cena_s_dph:"smlouva"===Y&&K&&(e=K.hodnota_s_dph||K.celkova_castka),e?new Intl.NumberFormat("cs-CZ",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(parseFloat(e))+" K\u010d":"\u2014"})()})]})]}),(0,V.jsxs)(ka,{$columns:"1fr 1fr 1fr",children:[(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{children:["Datum doru\u010den\xed ",(0,V.jsx)(za,{children:"*"})]}),(0,V.jsx)(an.A,{value:We.fa_datum_doruceni,onChange:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_doruceni:e})),onBlur:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_doruceni:e})),disabled:!Tn||z,placeholder:"dd.mm.rrrr",hasError:!!Q.fa_datum_doruceni}),Q.fa_datum_doruceni&&(0,V.jsxs)(Pa,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),Q.fa_datum_doruceni]})]}),(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{children:["Datum vystaven\xed ",(0,V.jsx)(za,{children:"*"})]}),(0,V.jsx)(an.A,{value:We.fa_datum_vystaveni,onChange:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_vystaveni:e})),onBlur:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_vystaveni:e})),disabled:!Tn||z,placeholder:"dd.mm.rrrr",hasError:!!Q.fa_datum_vystaveni}),Q.fa_datum_vystaveni&&(0,V.jsxs)(Pa,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),Q.fa_datum_vystaveni]})]}),(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{children:["Datum splatnosti ",(0,V.jsx)(za,{children:"*"})]}),(0,V.jsx)(an.A,{value:We.fa_datum_splatnosti,onChange:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_splatnosti:e})),onBlur:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_splatnosti:e})),disabled:!Tn||z,placeholder:"dd.mm.rrrr",hasError:!!Q.fa_datum_splatnosti}),Q.fa_datum_splatnosti&&(0,V.jsxs)(Pa,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),Q.fa_datum_splatnosti]})]})]}),(0,V.jsxs)(ka,{$columns:"minmax(0, 1fr) minmax(0, 1fr) minmax(0, 1fr)",$gap:"1rem",children:[(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{children:["Typ faktury ",(0,V.jsx)(za,{children:"*"})]}),(0,V.jsx)(sn.A,{field:"fa_typ",value:We.fa_typ,onChange:e=>{Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_typ:e.target.value}))},disabled:!Tn||z,options:[{id:"BEZNA",nazev:"B\u011b\u017en\xe1 faktura"},{id:"ZALOHOVA",nazev:"Z\xe1lohov\xe1 faktura"},{id:"OPRAVNA",nazev:"Opravn\xe1 faktura"},{id:"PROFORMA",nazev:"Proforma"},{id:"DOBROPIS",nazev:"Dobropis"}],placeholder:"-- Vyberte typ --",required:!0,selectStates:tn,setSelectStates:rn,searchStates:pn,setSearchStates:mn,touchedSelectFields:fn,setTouchedSelectFields:vn,toggleSelect:e=>rn(n=>(0,w.A)((0,w.A)({},n),{},{[e]:!n[e]})),filterOptions:(e,n)=>n?e.filter(e=>{var o;return null===(o=e.nazev)||void 0===o?void 0:o.toLowerCase().includes(n.toLowerCase())}):e,getOptionLabel:e=>(null===e||void 0===e?void 0:e.nazev)||""})]}),(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsxs)("span",{children:["Variabiln\xed symbol ",(0,V.jsx)(za,{children:"*"})]}),We.fa_cislo_vema&&(0,V.jsx)("button",{type:"button",onClick:()=>Ue(e=>(0,w.A)((0,w.A)({},e),{},{fa_cislo_vema:""})),disabled:!Tn,style:{background:"none",border:"none",color:Tn?"#9ca3af":"#d1d5db",cursor:Tn?"pointer":"not-allowed",padding:"0.25rem",display:"flex",alignItems:"center",fontSize:"0.875rem"},onMouseEnter:e=>{Tn&&(e.currentTarget.style.color="#6b7280")},onMouseLeave:e=>{Tn&&(e.currentTarget.style.color="#9ca3af")},title:"Vymazat variabiln\xed symbol",children:(0,V.jsx)(E.g,{icon:O.GRI})})]}),(0,V.jsx)(Ca,{type:"text",name:"fa_cislo_vema",value:We.fa_cislo_vema,onChange:Ln,disabled:!Tn||z,onBlur:e=>{e.target.value&&(e.target.style.fontWeight="600")},onFocus:e=>{e.target.style.fontWeight="400"},placeholder:"12345678",style:{fontWeight:We.fa_cislo_vema?"600":"400"},$hasError:!!Q.fa_cislo_vema}),Q.fa_cislo_vema&&(0,V.jsxs)(Pa,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),Q.fa_cislo_vema]})]}),(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsxs)("span",{children:["\u010c\xe1stka v\u010d. DPH ",(0,V.jsx)(za,{children:"*"})]}),We.fa_castka&&(0,V.jsx)("button",{type:"button",onClick:()=>Ue(e=>(0,w.A)((0,w.A)({},e),{},{fa_castka:""})),disabled:!Tn,style:{background:"none",border:"none",color:Tn?"#9ca3af":"#d1d5db",cursor:Tn?"pointer":"not-allowed",padding:"0.25rem",display:"flex",alignItems:"center",fontSize:"0.875rem"},onMouseEnter:e=>{Tn&&(e.currentTarget.style.color="#6b7280")},onMouseLeave:e=>{Tn&&(e.currentTarget.style.color="#9ca3af")},title:"Vymazat \u010d\xe1stku",children:(0,V.jsx)(E.g,{icon:O.GRI})})]}),(0,V.jsx)(Lr,{fieldName:"fa_castka",value:We.fa_castka,onChange:Ln,onBlur:e=>{const n=e.target.value;if(n){const e=parseFloat(n);isNaN(e)||e<=0?ee(e=>(0,w.A)((0,w.A)({},e),{},{fa_castka:"Zadejte platnou \u010d\xe1stku (\u010d\xedslo v\u011bt\u0161\xed ne\u017e 0)"})):ee(e=>{const{fa_castka:n}=e;return(0,j.A)(e,nt)})}},disabled:!Tn||z,hasError:!!Q.fa_castka,placeholder:"25 000,50"}),Q.fa_castka&&(0,V.jsxs)(Pa,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),Q.fa_castka]})]})]}),(0,V.jsx)(ka,{$columns:"1fr",children:(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)("span",{children:"St\u0159ediska"}),We.fa_strediska_kod&&We.fa_strediska_kod.length>0&&(0,V.jsx)("button",{type:"button",onClick:()=>Ue(e=>(0,w.A)((0,w.A)({},e),{},{fa_strediska_kod:[]})),disabled:!Tn,style:{background:"none",border:"none",color:Tn?"#9ca3af":"#d1d5db",cursor:Tn?"pointer":"not-allowed",padding:"0.25rem",display:"flex",alignItems:"center",fontSize:"0.875rem"},onMouseEnter:e=>{Tn&&(e.currentTarget.style.color="#6b7280")},onMouseLeave:e=>{Tn&&(e.currentTarget.style.color="#9ca3af")},title:"Vymazat st\u0159ediska",children:(0,V.jsx)(E.g,{icon:O.GRI})})]}),(0,V.jsx)(no,{values:We.fa_strediska_kod,onChange:e=>{Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_strediska_kod:e.target.value}))},options:hn,placeholder:xn?"Na\u010d\xedt\xe1m st\u0159ediska...":"Vyberte st\u0159ediska...",disabled:!Tn||z||xn})]})}),(0,V.jsx)(ka,{$columns:"1fr",children:(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)("span",{children:"Pozn\xe1mka"}),We.fa_poznamka&&(0,V.jsx)("button",{type:"button",onClick:()=>Ue(e=>(0,w.A)((0,w.A)({},e),{},{fa_poznamka:""})),disabled:!Tn,style:{background:"none",border:"none",color:Tn?"#9ca3af":"#d1d5db",cursor:Tn?"pointer":"not-allowed",padding:"0.25rem",display:"flex",alignItems:"center",fontSize:"0.875rem"},onMouseEnter:e=>{Tn&&(e.currentTarget.style.color="#6b7280")},onMouseLeave:e=>{Tn&&(e.currentTarget.style.color="#9ca3af")},title:"Vymazat pozn\xe1mku",children:(0,V.jsx)(E.g,{icon:O.GRI})})]}),(0,V.jsx)(Ia,{name:"fa_poznamka",value:We.fa_poznamka,onChange:Ln,disabled:!Tn||z,placeholder:"Voliteln\xe1 pozn\xe1mka..."})]})}),(0,V.jsx)(qo.r6,{fakturaId:me||"temp-new-invoice",objednavkaId:We.order_id||null,fakturaTypyPrilohOptions:_n,readOnly:!Tn,onISDOCParsed:Gn,formData:We,faktura:{fa_cislo_vema:We.fa_cislo_vema,fa_datum_vystaveni:We.fa_datum_vystaveni,fa_datum_splatnosti:We.fa_datum_splatnosti,fa_castka:We.fa_castka,fa_strediska_kod:We.fa_strediska_kod},validateInvoiceForAttachments:Hn,allUsers:wn,attachments:Ze,onAttachmentsChange:Wn,onAttachmentUploaded:Kn,onAttachmentRemoved:Un,onCreateInvoiceInDB:Yn,onOCRDataExtracted:qn}),(0,V.jsx)("div",{style:{borderTop:"2px solid #e5e7eb",margin:"1.5rem 0",position:"relative"},children:(0,V.jsx)("div",{style:{position:"absolute",top:"-12px",left:"50%",transform:"translateX(-50%)",background:"#f9fafb",padding:"0 1rem",fontSize:"0.875rem",color:"#6b7280",fontWeight:600},children:"Dopl\u0148uj\xedc\xed \xfadaje (nepovinn\xe9)"})}),(0,V.jsxs)(ka,{$columns:"1fr 1fr",children:[(0,V.jsxs)(ja,{children:[(0,V.jsx)(wa,{children:"Datum p\u0159ed\xe1n\xed"}),(0,V.jsx)(an.A,{value:We.fa_datum_predani_zam,onChange:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_predani_zam:e})),onBlur:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_predani_zam:e})),disabled:!Tn||z,placeholder:"dd.mm.rrrr"})]}),(0,V.jsxs)(ja,{children:[(0,V.jsx)(wa,{children:"Datum vr\xe1cen\xed"}),(0,V.jsx)(an.A,{value:We.fa_datum_vraceni_zam,onChange:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_vraceni_zam:e})),onBlur:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_datum_vraceni_zam:e})),disabled:!Tn||z,placeholder:"dd.mm.rrrr"}),We.fa_datum_predani_zam&&We.fa_datum_vraceni_zam&&new Date(We.fa_datum_vraceni_zam)<new Date(We.fa_datum_predani_zam)&&(0,V.jsxs)(Pa,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),"Datum vr\xe1cen\xed nem\u016f\u017ee b\xfdt d\u0159\xedv\u011bj\u0161\xed ne\u017e datum p\u0159ed\xe1n\xed"]})]})]}),(0,V.jsx)(ka,{$columns:"1fr",children:(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,V.jsx)("span",{children:"P\u0159ed\xe1no zam\u011bstnanci"}),We.fa_predana_zam_id&&(0,V.jsx)("button",{type:"button",onClick:()=>Ue(e=>(0,w.A)((0,w.A)({},e),{},{fa_predana_zam_id:null,fa_datum_predani_zam:"",fa_datum_vraceni_zam:""})),disabled:!Tn,style:{background:"none",border:"none",color:Tn?"#9ca3af":"#d1d5db",cursor:Tn?"pointer":"not-allowed",padding:"0.25rem",display:"flex",alignItems:"center",fontSize:"0.875rem"},onMouseEnter:e=>{Tn&&(e.currentTarget.style.color="#6b7280")},onMouseLeave:e=>{Tn&&(e.currentTarget.style.color="#9ca3af")},title:"Vymazat zam\u011bstnance (v\u010detn\u011b datum\u016f p\u0159ed\xe1n\xed/vr\xe1cen\xed)",children:(0,V.jsx)(E.g,{icon:O.GRI})})]}),(0,V.jsx)(sn.A,{value:We.fa_predana_zam_id,onChange:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{fa_predana_zam_id:e.target.value?parseInt(e.target.value):null})),options:wn,placeholder:An?"Na\u010d\xedt\xe1m zam\u011bstnance...":"-- Nevybr\xe1no --",disabled:!Tn||z||An,field:"fa_predana_zam_id",selectStates:tn,setSelectStates:rn,searchStates:pn,setSearchStates:mn,touchedSelectFields:fn,setTouchedSelectFields:vn,toggleSelect:e=>rn(n=>(0,w.A)((0,w.A)({},n),{},{[e]:!n[e]})),filterOptions:(e,n)=>n?e.filter(e=>"".concat(e.prijmeni||""," ").concat(e.jmeno||""," ").concat(e.titul_za||"").toLowerCase().includes(n.toLowerCase())):e,getOptionLabel:e=>e?"".concat(e.prijmeni||""," ").concat(e.jmeno||""," ").concat(e.titul_za?", ".concat(e.titul_za):"").trim():"",allowEmpty:!0}),An&&(0,V.jsxs)("div",{style:{fontSize:"0.85rem",color:"#6b7280",marginTop:"0.5rem"},children:[(0,V.jsx)(E.g,{icon:O.z1G,spin:!0})," Na\u010d\xedt\xe1m zam\u011bstnance..."]})]})})]}),me&&We.order_id&&Z&&h(Z).allowed&&!g&&(0,V.jsxs)("div",{style:{background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",border:"3px solid #f59e0b",borderRadius:"12px",padding:"1.25rem",marginBottom:"1.5rem",boxShadow:"0 4px 12px rgba(245, 158, 11, 0.25)"},children:[(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem",marginBottom:"1rem"},children:[(0,V.jsx)("div",{style:{background:"#f59e0b",color:"white",borderRadius:"50%",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",flexShrink:0},children:(0,V.jsx)(E.g,{icon:O.zpE})}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:700,color:"#92400e",fontSize:"1.1rem",marginBottom:"0.5rem"},children:"\u26a0\ufe0f D\u016eLE\u017dIT\xc9: Aktualizace faktury v\xe1zan\xe9 na objedn\xe1vku"}),(0,V.jsxs)("div",{style:{fontSize:"0.95rem",color:"#78350f",lineHeight:"1.6"},children:["Editace faktury v\xe1zan\xe9 na objedn\xe1vku ",(0,V.jsx)("strong",{children:Z.cislo_objednavky||Z.evidencni_cislo})," zp\u016fsob\xed, \u017ee objedn\xe1vka bude muset znovu proj\xedt ",(0,V.jsx)("strong",{children:"v\u011bcnou spr\xe1vnost\xed"})," a kontrolou."]})]})]}),(0,V.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.5)",borderRadius:"6px",padding:"0.75rem",fontSize:"0.9rem",color:"#78350f"},children:[(0,V.jsx)("strong",{children:"Co se stane po ulo\u017een\xed:"}),(0,V.jsxs)("ul",{style:{margin:"0.5rem 0 0 1.5rem",paddingLeft:0},children:[(0,V.jsxs)("li",{children:["Objedn\xe1vka bude vr\xe1cena do stavu ",(0,V.jsx)("strong",{children:'"V\u011bcn\xe1 spr\xe1vnost"'})]}),(0,V.jsx)("li",{children:"Objednatel, garant a schvalovatel obdr\u017e\xed notifikaci"}),(0,V.jsx)("li",{children:"Bude nutn\xe9 prov\xe9st novou kontrolu a schv\xe1len\xed"})]})]})]}),We.order_id&&Z&&!h(Z).allowed&&(0,V.jsxs)("div",{style:{background:me?"#fee2e2":"#fef3c7",border:me?"3px solid #dc2626":"2px solid #f59e0b",borderRadius:"8px",padding:"1rem",marginBottom:"1rem",display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[(0,V.jsx)(E.g,{icon:O.zpE,style:{color:me?"#dc2626":"#f59e0b",marginTop:"0.25rem",fontSize:"1.25rem"}}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsxs)("div",{style:{fontWeight:600,color:me?"#991b1b":"#92400e",marginBottom:"0.25rem"},children:["\u26a0\ufe0f ",me?"Nelze aktualizovat fakturu u t\xe9to objedn\xe1vky":"Nelze p\u0159idat fakturu k t\xe9to objedn\xe1vce"]}),(0,V.jsx)("div",{style:{fontSize:"0.9rem",color:me?"#991b1b":"#78350f"},children:h(Z).reason})]})]}),me&&En&&(0,V.jsxs)("div",{style:{background:"linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)",border:"2px solid #fb923c",borderRadius:"8px",padding:"1rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,V.jsx)(E.g,{icon:O.zpE,style:{color:"#ea580c",fontSize:"1.25rem"}}),(0,V.jsxs)("div",{style:{flex:1,fontSize:"0.9rem",color:"#9a3412"},children:[(0,V.jsx)("strong",{children:"Pozor:"})," Zm\u011bnili jste kritick\xe9 pole faktury (\u010d\xe1stka, \u010d\xedslo, st\u0159edisko, typ nebo datum). Po ulo\u017een\xed bude nutn\xe9 ",(0,V.jsx)("strong",{children:"znovu schv\xe1lit v\u011bcnou spr\xe1vnost"}),"."]})]}),!g&&(0,V.jsxs)(Ea,{children:[(0,V.jsxs)(Oa,{$variant:"secondary",onClick:Qn,disabled:z,children:[(0,V.jsx)(E.g,{icon:O.GRI}),"Zru\u0161it"]}),(0,V.jsxs)(Oa,{$variant:"primary",onClick:async()=>{X(null),ee({}),he(!0);const e=me&&!Ae&&We.order_id;if(We.order_id&&Z&&(!me||e)){const e=h(Z);if(!e.allowed)return X(e.reason),void(u&&u(e.reason,"error"))}Ie({show:!0,status:"loading",progress:10,title:me?"Ukl\xe1d\xe1m zm\u011bny faktury...":"Eviduji novou fakturu...",message:"Ov\u011b\u0159uji zadan\xe9 \xfadaje a p\u0159ipravuji data k ulo\u017een\xed..."});const n={};if(We.fa_cislo_vema&&We.fa_cislo_vema.trim()||(n.fa_cislo_vema="Vypl\u0148te \u010d\xedslo faktury"),We.fa_typ||(n.fa_typ="Vyberte typ faktury"),We.fa_datum_doruceni||(n.fa_datum_doruceni="Vypl\u0148te datum doru\u010den\xed"),We.fa_datum_vystaveni||(n.fa_datum_vystaveni="Vypl\u0148te datum vystaven\xed"),We.fa_datum_splatnosti||(n.fa_datum_splatnosti="Vypl\u0148te datum splatnosti"),(!We.fa_castka||parseFloat(We.fa_castka)<=0)&&(n.fa_castka="Vypl\u0148te platnou \u010d\xe1stku faktury"),We.fa_datum_predani_zam&&We.fa_datum_vraceni_zam){const e=new Date(We.fa_datum_predani_zam);new Date(We.fa_datum_vraceni_zam)<e&&(n.fa_datum_vraceni_zam="Datum vr\xe1cen\xed nem\u016f\u017ee b\xfdt d\u0159\xedv\u011bj\u0161\xed ne\u017e datum p\u0159ed\xe1n\xed")}if(Object.keys(n).length>0)return ee(n),X("Opravte pros\xedm chyby ve formul\xe1\u0159i p\u0159ed odesl\xe1n\xedm"),void Ie({show:!1,status:"error",progress:0,title:"",message:""});I(!0),null===p||void 0===p||p(50),Ie(e=>(0,w.A)((0,w.A)({},e),{},{progress:30,message:"Validace formul\xe1\u0159e dokon\u010dena, odes\xedl\xe1m data na server..."}));try{var o,t;const e={token:s,username:l,order_id:We.order_id||null,smlouva_id:We.smlouva_id||null,fa_cislo_vema:We.fa_cislo_vema,fa_typ:We.fa_typ||"BEZNA",fa_datum_vystaveni:We.fa_datum_vystaveni,fa_datum_splatnosti:We.fa_datum_splatnosti||null,fa_datum_doruceni:We.fa_datum_doruceni||null,fa_castka:We.fa_castka,fa_poznamka:We.fa_poznamka||"",fa_dorucena:We.fa_datum_doruceni?1:0,fa_strediska_kod:JSON.stringify(We.fa_strediska_kod||[]),fa_predana_zam_id:We.fa_predana_zam_id||null,fa_datum_predani_zam:We.fa_datum_predani_zam||null,fa_datum_vraceni_zam:We.fa_datum_vraceni_zam||null};let n;if(me){const e={objednavka_id:We.order_id||null,smlouva_id:We.smlouva_id||null,fa_cislo_vema:We.fa_cislo_vema,fa_typ:We.fa_typ||"BEZNA",fa_datum_vystaveni:We.fa_datum_vystaveni,fa_datum_splatnosti:We.fa_datum_splatnosti||null,fa_datum_doruceni:We.fa_datum_doruceni||null,fa_castka:We.fa_castka,fa_poznamka:We.fa_poznamka||"",fa_dorucena:We.fa_datum_doruceni?1:0,fa_predana_zam_id:We.fa_predana_zam_id||null,fa_datum_predani_zam:We.fa_datum_predani_zam||null,fa_datum_vraceni_zam:We.fa_datum_vraceni_zam||null,fa_strediska_kod:JSON.stringify(We.fa_strediska_kod||[])};if(Ie(e=>(0,w.A)((0,w.A)({},e),{},{progress:60,message:"Aktualizuji \xfadaje faktury v datab\xe1zi..."})),n=await(0,R.Br)({token:s,username:l,invoice_id:me,updateData:e}),Ge&&Ge.length>0)try{await(0,Qo.M)(me,Ge,s,l)}catch(v){console.error("\u274c Chyba p\u0159i ukl\xe1d\xe1n\xed LP \u010derp\xe1n\xed:",v),u&&u("Faktura ulo\u017eena, ale \u010derp\xe1n\xed LP se nepoda\u0159ilo ulo\u017eit: "+v.message,"warning")}null===p||void 0===p||p(100),Ie(e=>(0,w.A)((0,w.A)({},e),{},{progress:100,status:"success",title:"Faktura byla aktualizov\xe1na",message:"Faktura ".concat(We.fa_cislo_vema," byla \xfasp\u011b\u0161n\u011b ulo\u017eena do datab\xe1ze.")}))}else{var r,a,i,c,m,f;Ie(e=>(0,w.A)((0,w.A)({},e),{},{progress:60,message:We.file?"Nahr\xe1v\xe1m p\u0159\xedlohu a vytv\xe1\u0159\xedm fakturu...":"Vytv\xe1\u0159\xedm novou fakturu v datab\xe1zi..."})),n=We.file?await(0,R.BG)((0,w.A)((0,w.A)({},e),{},{file:We.file,klasifikace:We.klasifikace||null})):await(0,R.We)(e);const o=(null===(r=n)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.invoice_id)||(null===(i=n)||void 0===i||null===(c=i.data)||void 0===c?void 0:c.id)||(null===(m=n)||void 0===m?void 0:m.invoice_id)||(null===(f=n)||void 0===f?void 0:f.id);if(o&&Ge&&Ge.length>0)try{await(0,Qo.M)(o,Ge,s,l)}catch(v){console.error("\u274c Chyba p\u0159i ukl\xe1d\xe1n\xed LP \u010derp\xe1n\xed:",v),u&&u("Faktura vytvo\u0159ena, ale \u010derp\xe1n\xed LP se nepoda\u0159ilo ulo\u017eit: "+v.message,"warning")}null===p||void 0===p||p(100),Ie(e=>(0,w.A)((0,w.A)({},e),{},{progress:100,status:"success",title:"Faktura byla zaevidov\xe1na",message:"Faktura ".concat(We.fa_cislo_vema," byla \xfasp\u011b\u0161n\u011b ulo\u017eena do syst\xe9mu.")}))}if(We.order_id&&Z)try{let e=[];try{"string"===typeof Z.stav_workflow_kod?e=JSON.parse(Z.stav_workflow_kod):Array.isArray(Z.stav_workflow_kod)&&(e=[...Z.stav_workflow_kod])}catch(g){console.error("Chyba p\u0159i parsov\xe1n\xed workflow stav\u016f:",g),e=[]}const n=e.length>0?e[e.length-1]:null,o=me&&!Ae&&We.order_id;let t=!1;me&&!o?"ZKONTROLOVANA"!==n&&"DOKONCENA"!==n||(e.pop(),"DOKONCENA"===n&&"ZKONTROLOVANA"===e[e.length-1]&&e.pop(),"VECNA_SPRAVNOST"!==e[e.length-1]&&e.push("VECNA_SPRAVNOST"),t=!0,console.log("\u26a0\ufe0f EDITACE FAKTURY: Objedn\xe1vka vr\xe1cena na v\u011bcnou spr\xe1vnost")):"NEUVEREJNIT"===n||"UVEREJNENA"===n?(e.push("FAKTURACE"),e.push("VECNA_SPRAVNOST"),t=!0):"FAKTURACE"===n?(e.push("VECNA_SPRAVNOST"),t=!0):"ZKONTROLOVANA"===n&&(e.pop(),t=!0),t&&(Ie(e=>(0,w.A)((0,w.A)({},e),{},{progress:85,message:"Aktualizuji stav objedn\xe1vky a odes\xedl\xe1m notifikace..."})),await(0,P.qA)(We.order_id,{stav_workflow_kod:JSON.stringify(e),stav_objednavky:"V\u011bcn\xe1 spr\xe1vnost"},s,l),await(async e=>{try{const n=await un.lY.trigger("ORDER_MATERIAL_CORRECTNESS",e,d);n.errors&&n.errors.length>0&&console.warn("\u26a0\ufe0f N\u011bkter\xe9 notifikace se nepoda\u0159ilo odeslat:",n.errors)}catch(q){var n;console.error("\u274c Chyba p\u0159i odes\xedl\xe1n\xed notifikac\xed:",q),console.error("   Error message:",q.message),console.error("   Error details:",null===(n=q.response)||void 0===n?void 0:n.data)}})(We.order_id),await Pn(We.order_id))}catch(x){console.error("\u26a0\ufe0f Nepoda\u0159ilo se aktualizovat workflow objedn\xe1vky:",x)}const h=!!me;if(In(null),On(!1),Ie(e=>(0,w.A)((0,w.A)({},e),{},{resetData:{wasEditing:h,currentOrderId:We.order_id,currentSmlouvaId:We.smlouva_id}})),!me&&null!==(o=n)&&void 0!==o&&null!==(t=o.data)&&void 0!==t&&t.id)try{const e=null===Ze||void 0===Ze?void 0:Ze[0];if(null!==e&&void 0!==e&&e.spisovka_file_id&&null!==e&&void 0!==e&&e.spisovka_dokument_id)await Nn({username:l,token:s,dokument_id:e.spisovka_dokument_id,spisovka_priloha_id:e.spisovka_file_id,faktura_id:n.data.id,fa_cislo_vema:We.fa_cislo_vema,stav:"ZAEVIDOVANO",poznamka:"Auto-tracking: P\u0159\xedloha ze Spisovky (file_id: ".concat(e.spisovka_file_id,")")});else if(We.file&&Pe&&Pe.length>0){const e=Pe.find(e=>!!(e.prilohy&&e.prilohy.length>0)&&e.prilohy.some(e=>e.filename===We.file.name));null!==e&&void 0!==e&&e.dokument_id&&await Nn({username:l,token:s,dokument_id:e.dokument_id,faktura_id:n.data.id,fa_cislo_vema:We.fa_cislo_vema,stav:"ZAEVIDOVANO",poznamka:"Auto-tracking: P\xe1rov\xe1n\xed podle n\xe1zvu souboru (fallback)"})}}catch(b){console.warn("\u26a0\ufe0f Nepoda\u0159ilo se ozna\u010dit Spisovka dokument jako zpracovan\xfd:",b)}}catch(_){console.error("Error creating invoice:",_),X(_.message||"Chyba p\u0159i evidenci faktury"),null===p||void 0===p||p(0),Ie({show:!0,status:"error",progress:0,title:"Chyba p\u0159i ukl\xe1d\xe1n\xed faktury",message:_.message||"Do\u0161lo k neo\u010dek\xe1van\xe9 chyb\u011b p\u0159i ukl\xe1d\xe1n\xed faktury. Zkuste to pros\xedm znovu."})}finally{I(!1)}},disabled:z||We.order_id&&Z&&!h(Z).allowed,title:We.order_id&&Z&&!h(Z).allowed?h(Z).reason:"",children:[(0,V.jsx)(E.g,{icon:z?O.zpE:O.hSh}),z?"Ukl\xe1d\xe1m...":me&&ve?!We.order_id&&!We.smlouva_id||Ae?"Aktualizovat fakturu":We.smlouva_id?"P\u0159i\u0159adit fakturu ke smlouv\u011b":"P\u0159i\u0159adit fakturu k objedn\xe1vce":We.order_id&&Z?"P\u0159i\u0159adit fakturu k objedn\xe1vce":We.smlouva_id&&K?"P\u0159i\u0159adit fakturu ke smlouv\u011b":"Zaevidovat fakturu"]})]})]})]}),(0,V.jsxs)(va,{"data-section":"material-correctness",children:[(0,V.jsxs)(ha,{onClick:()=>_("materialCorrectness"),children:[(0,V.jsxs)(ga,{children:[(0,V.jsx)(E.g,{icon:O.Iae}),"V\u011bcn\xe1 spr\xe1vnost k faktu\u0159e"]}),(0,V.jsxs)(xa,{children:[!c("INVOICE_MANAGE")&&c("INVOICE_MATERIAL_CORRECTNESS")&&(0,V.jsx)("span",{style:{marginRight:"1rem",background:"#fef3c7",padding:"0.25rem 0.75rem",borderRadius:"4px",color:"#92400e",fontSize:"0.8rem",fontWeight:600,border:"2px solid #fbbf24"},children:"V\xc1\u0160 \xdaKOL"}),(0,V.jsx)(_a,{$collapsed:!x.materialCorrectness,children:(0,V.jsx)(E.g,{icon:O.Jt$})})]})]}),(0,V.jsx)(ba,{$collapsed:!x.materialCorrectness,children:(0,V.jsxs)(ya,{children:[Dn&&(0,V.jsxs)("div",{style:{background:"#f0f9ff",border:"2px solid #0284c7",borderRadius:"8px",padding:"1rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,V.jsx)(E.g,{icon:O.SGM,style:{color:"#0284c7",fontSize:"1.5rem"}}),(0,V.jsxs)("div",{style:{flex:1},children:[(0,V.jsx)("div",{style:{fontWeight:700,color:"#075985",fontSize:"0.95rem",marginBottom:"0.25rem"},children:"Objedn\xe1vka je dokon\u010dena"}),(0,V.jsx)("div",{style:{fontSize:"0.85rem",color:"#0c4a6e"},children:"V\u011bcn\xe1 kontrola ji\u017e byla provedena. Pole jsou pouze pro \u010dten\xed."})]})]}),Z&&Z.max_cena_s_dph&&We.fa_castka&&(()=>{const e=parseFloat(Z.max_cena_s_dph)||0,n=parseFloat(We.fa_castka)||0,o=n-e,t=o>0;return(0,V.jsxs)("div",{style:{background:t?"#fef2f2":"#f0fdf4",border:"1px solid ".concat(t?"#ef4444":"#22c55e"),borderRadius:"6px",padding:"0.75rem",marginBottom:"1rem",fontSize:"0.85rem"},children:[(0,V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,V.jsx)("span",{style:{color:"#6b7280"},children:"Max. cena objedn\xe1vky s DPH:"}),(0,V.jsxs)("span",{style:{fontWeight:"600",color:"#374151"},children:[e.toLocaleString("cs-CZ",{minimumFractionDigits:2,maximumFractionDigits:2})," K\u010d"]})]}),(0,V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,V.jsx)("span",{style:{color:"#6b7280"},children:"\u010c\xe1stka faktury s DPH:"}),(0,V.jsxs)("span",{style:{fontWeight:"600",color:"#374151"},children:[n.toLocaleString("cs-CZ",{minimumFractionDigits:2,maximumFractionDigits:2})," K\u010d"]})]}),(0,V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"0.5rem",borderTop:"1px solid #e5e7eb",fontWeight:"700"},children:[(0,V.jsx)("span",{style:{color:t?"#dc2626":"#16a34a"},children:t?"\u26a0\ufe0f P\u0159ekro\u010den\xed:":"\u2705 Rozd\xedl:"}),(0,V.jsxs)("span",{style:{color:t?"#dc2626":"#16a34a"},children:[t?"+":"",o.toLocaleString("cs-CZ",{minimumFractionDigits:2,maximumFractionDigits:2})," K\u010d"]})]})]})})(),(0,V.jsx)(ka,{$columns:"1fr",children:(0,V.jsxs)(ja,{children:[(0,V.jsx)(wa,{children:"Um\xedst\u011bn\xed majetku"}),(0,V.jsx)("input",{type:"text",value:We.vecna_spravnost_umisteni_majetku||"",disabled:Dn||z,onChange:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{vecna_spravnost_umisteni_majetku:e.target.value})),placeholder:"Nap\u0159. Kladno, budova K2, m\xedstnost 203",style:{width:"100%",padding:"0.75rem",fontSize:"0.95rem",border:"2px solid #e5e7eb",borderRadius:"8px",outline:"none",transition:"all 0.2s",background:Dn||z?"#f9fafb":"white",cursor:Dn||z?"not-allowed":"text"},onFocus:e=>{Dn||z||(e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)")},onBlur:e=>{e.target.style.borderColor="#e5e7eb",e.target.style.boxShadow="none"}})]})}),(0,V.jsx)(ka,{$columns:"1fr",children:(0,V.jsxs)(ja,{children:[(0,V.jsxs)(wa,{required:Z&&We.fa_castka&&parseFloat(We.fa_castka)>parseFloat(Z.max_cena_s_dph||0),style:Z&&We.fa_castka&&parseFloat(We.fa_castka)>parseFloat(Z.max_cena_s_dph||0)?{color:"#dc2626",fontWeight:"700"}:{},children:["Pozn\xe1mka k v\u011bcn\xe9 spr\xe1vnosti",Z&&We.fa_castka&&parseFloat(We.fa_castka)>parseFloat(Z.max_cena_s_dph||0)&&" (POVINN\xc1 - faktura p\u0159ekra\u010duje MAX cenu)"]}),(0,V.jsx)("textarea",{value:We.vecna_spravnost_poznamka||"",disabled:Dn||z,onChange:e=>Ue(n=>(0,w.A)((0,w.A)({},n),{},{vecna_spravnost_poznamka:e.target.value})),placeholder:"Voliteln\xe1 pozn\xe1mka k v\u011bcn\xe9 spr\xe1vnosti...",rows:2,style:{width:"100%",padding:"0.75rem",fontSize:"0.95rem",border:"2px solid #e5e7eb",borderRadius:"8px",outline:"none",transition:"all 0.2s",background:Dn||z?"#f9fafb":"white",cursor:Dn||z?"not-allowed":"text",resize:"vertical",fontFamily:"inherit"},onFocus:e=>{Dn||z||(e.target.style.borderColor="#3b82f6",e.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)")},onBlur:e=>{e.target.style.borderColor="#e5e7eb",e.target.style.boxShadow="none"}})]})}),(()=>{if(!Z||!Z.financovani)return null;try{const n="string"===typeof Z.financovani?JSON.parse(Z.financovani):Z.financovani;var e;return"LP"===(null===n||void 0===n?void 0:n.typ)?(0,V.jsx)(qo.cy,{faktura:We,orderData:Z,lpCerpani:Ge,availableLPCodes:(null===(e=m.data)||void 0===e?void 0:e.lpKodyOptions)||[],onChange:e=>qe(e),disabled:Dn||z}):null}catch(n){return console.error("\u274c [LP Editor] Chyba p\u0159i parsov\xe1n\xed financov\xe1n\xed:",n),null}})(),(0,V.jsx)("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#ffffff",border:"1px solid #d1d5db",borderRadius:"6px"},children:(0,V.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:Dn||z?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:Dn||z?"400":"600",color:Dn||z?"#9ca3af":"#374151"},children:[(0,V.jsx)("input",{type:"checkbox",checked:1===We.vecna_spravnost_potvrzeno,disabled:Dn||z,onChange:e=>{const n=e.target.checked?1:0;let o={vecna_spravnost_potvrzeno:n};if(1===n&&d&&!We.potvrdil_vecnou_spravnost_id){const e=new Date,n=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0"),s=String(e.getSeconds()).padStart(2,"0"),l="".concat(n,"-").concat(t,"-").concat(r," ").concat(a,":").concat(i,":").concat(s);o.potvrdil_vecnou_spravnost_id=d,o.dt_potvrzeni_vecne_spravnosti=l}Ue(e=>(0,w.A)((0,w.A)({},e),o))},style:{width:"18px",height:"18px",cursor:Dn||z?"not-allowed":"pointer",accentColor:Dn||z?"#9ca3af":"#16a34a"}}),(0,V.jsx)("span",{style:{flex:1},children:"Potvrzuji v\u011bcnou spr\xe1vnost faktury"}),1===We.vecna_spravnost_potvrzeno&&(0,V.jsx)("span",{style:{fontSize:"0.75rem",color:"#16a34a",background:"#dcfce7",padding:"0.25rem 0.5rem",borderRadius:"4px",fontWeight:"600"},children:"\u2713 ZKONTROLOV\xc1NO"})]})}),me&&(0,V.jsxs)("div",{style:{marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"2px solid #e5e7eb",display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,V.jsx)("button",{onClick:()=>{g?r("/invoices25-list"):(Cn&&Ue(e=>(0,w.A)((0,w.A)({},e),{},{vecna_spravnost_umisteni_majetku:Cn.vecna_spravnost_umisteni_majetku||"",vecna_spravnost_poznamka:Cn.vecna_spravnost_poznamka||"",vecna_spravnost_potvrzeno:Cn.vecna_spravnost_potvrzeno||0,potvrdil_vecnou_spravnost_id:Cn.potvrdil_vecnou_spravnost_id||null,dt_potvrzeni_vecne_spravnosti:Cn.dt_potvrzeni_vecne_spravnosti||""})),u&&u("Zm\u011bny v\u011bcn\xe9 spr\xe1vnosti zru\u0161eny","info"))},disabled:z,style:{padding:"0.75rem 1.5rem",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:"600",cursor:z?"not-allowed":"pointer",opacity:z?.6:1,transition:"all 0.2s"},onMouseEnter:e=>!z&&(e.target.style.background="#4b5563"),onMouseLeave:e=>!z&&(e.target.style.background="#6b7280"),children:g?"Opustit formul\xe1\u0159":"Zru\u0161it"}),(0,V.jsxs)("button",{onClick:async()=>{if(me){I(!0),X(null);try{if(1!==We.vecna_spravnost_potvrzeno)return u&&u('Za\u0161krtn\u011bte pol\xed\u010dko "Potvrzuji v\u011bcnou spr\xe1vnost faktury"',"error"),void I(!1);if(Z&&Z.financovani)try{if("LP"===("string"===typeof Z.financovani?JSON.parse(Z.financovani):Z.financovani).typ){if(!Ge||0===Ge.length||Ge.every(e=>!e.lp_cislo||e.castka<=0))return u&&u("\u26a0\ufe0f Objedn\xe1vka je financov\xe1na z LP. Mus\xedte p\u0159i\u0159adit alespo\u0148 jeden LP k\xf3d!","error"),void I(!1);const e=Ge.reduce((e,n)=>e+(parseFloat(n.castka)||0),0);if(e>(parseFloat(We.fa_castka)||0))return u&&u("\u274c Sou\u010det LP \u010derp\xe1n\xed p\u0159ekra\u010duje \u010d\xe1stku faktury","error"),void I(!1)}}catch(e){console.error("Chyba p\u0159i validaci LP:",e)}if(Z&&Z.max_cena_s_dph&&We.fa_castka){const e=parseFloat(Z.max_cena_s_dph)||0;if((parseFloat(We.fa_castka)||0)>e&&(!We.vecna_spravnost_poznamka||""===We.vecna_spravnost_poznamka.trim()))return u&&u("Vysv\u011btlete v pozn\xe1mce, pro\u010d faktura p\u0159ekra\u010duje max. cenu objedn\xe1vky","error"),void I(!1)}const t={vecna_spravnost_umisteni_majetku:We.vecna_spravnost_umisteni_majetku||"",vecna_spravnost_poznamka:We.vecna_spravnost_poznamka||"",vecna_spravnost_potvrzeno:We.vecna_spravnost_potvrzeno,potvrdil_vecnou_spravnost_id:We.potvrdil_vecnou_spravnost_id,dt_potvrzeni_vecne_spravnosti:We.dt_potvrzeni_vecne_spravnosti},r=await(0,R.Br)({token:s,username:l,invoice_id:me,updateData:t});if(!(!0===(null===r||void 0===r?void 0:r.success)||"success"===(null===r||void 0===r?void 0:r.status)||(null===r||void 0===r?void 0:r.message)&&r.message.includes("\xfasp\u011b\u0161n\u011b"))){const e=(null===r||void 0===r?void 0:r.message)||(null===r||void 0===r?void 0:r.error)||"Nepoda\u0159ilo se aktualizovat v\u011bcnou spr\xe1vnost";throw new Error(e)}if(In(e=>(0,w.A)((0,w.A)({},e),t)),Ge&&Ge.length>0)try{await(0,Qo.M)(me,Ge,s,l)}catch(n){console.error("\u274c Chyba p\u0159i ukl\xe1d\xe1n\xed LP \u010derp\xe1n\xed:",n),u&&u("V\u011bcn\xe1 spr\xe1vnost ulo\u017eena, ale \u010derp\xe1n\xed LP se nepoda\u0159ilo ulo\u017eit: "+n.message,"warning")}if(We.order_id)try{await un.lY.trigger("ORDER_MATERIAL_CORRECTNESS",We.order_id,d)}catch(o){console.error("\u274c Chyba p\u0159i odes\xedl\xe1n\xed notifikace:",o)}Ie({show:!0,status:"success",title:"V\u011bcn\xe1 spr\xe1vnost ulo\u017eena",message:g?"V\u011bcn\xe1 spr\xe1vnost faktury byla \xfasp\u011b\u0161n\u011b zaznamen\xe1na. Budete p\u0159esm\u011brov\xe1ni na seznam faktur.":"V\u011bcn\xe1 spr\xe1vnost faktury byla \xfasp\u011b\u0161n\u011b aktualizov\xe1na.",resetData:{isVecnaSpravnost:!0,isReadOnlyMode:g}})}catch(t){console.error("\u274c Chyba p\u0159i aktualizaci v\u011bcn\xe9 kontroly:",t),X(t.message||"Nepoda\u0159ilo se aktualizovat v\u011bcnou kontrolu"),u&&u(t.message||"Nepoda\u0159ilo se aktualizovat v\u011bcnou kontrolu","error")}finally{I(!1)}}else u&&u("Chyba: Nen\xed vybr\xe1na faktura k aktualizaci","error")},disabled:z,style:{padding:"0.75rem 1.5rem",background:z?"#9ca3af":"#16a34a",color:"white",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:"600",cursor:z?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s"},onMouseEnter:e=>!z&&(e.target.style.background="#15803d"),onMouseLeave:e=>!z&&(e.target.style.background="#16a34a"),children:[(0,V.jsx)(E.g,{icon:z?O.z1G:O.hSh,spin:z}),"Aktualizovat v\u011bcnou spr\xe1vnost"]})]})]})})]})]})]}),(0,V.jsxs)(ca,{children:[(0,V.jsx)(ua,{children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",flex:1},children:[(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem",paddingBottom:"12px",borderBottom:Z||K?"smlouva"===Y?"2px solid #10b981":"2px solid #3498db":"2px solid #e5e7eb",marginBottom:"1rem"},children:[(0,V.jsx)(fa,{style:{margin:0,border:"none",paddingBottom:0,whiteSpace:"nowrap"},children:Z||K?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(E.g,{icon:"smlouva"===Y?O.IJd:O.URI}),"smlouva"===Y?"N\xe1hled smlouvy":"N\xe1hled objedn\xe1vky"]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(E.g,{icon:O.URI}),"N\xe1hled"]})}),Z&&"order"===Y&&(0,V.jsx)("span",{style:{fontWeight:700,color:"#1e40af",fontSize:"1.05rem",whiteSpace:"nowrap"},children:Z.cislo_objednavky||"#".concat(Z.id)}),K&&"smlouva"===Y&&(0,V.jsx)("span",{style:{fontWeight:700,color:"#059669",fontSize:"1.05rem",whiteSpace:"nowrap"},children:K.cislo_smlouvy||"#".concat(K.id)})]}),Z&&(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",flexWrap:"wrap"},children:[(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[(0,V.jsx)("div",{onClick:()=>{var e;null!==(e=ce.current)&&void 0!==e&&e.expandSectionByName&&ce.current.expandSectionByName("schvaleni"),setTimeout(()=>{const e=document.querySelector('[data-section="schvaleni"]');e&&e.scrollIntoView({behavior:"smooth",block:"start"})},100)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"0.4rem 0.75rem",background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",border:"2px solid #10b981",borderRadius:"6px",fontSize:"0.7rem",fontWeight:600,color:"#065f46",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 4px 8px rgba(16, 185, 129, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.05)"},children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1px"},children:[(0,V.jsx)("div",{style:{fontSize:"0.6rem",opacity:.8,fontWeight:500},children:"STAV"}),(0,V.jsx)("div",{style:{fontSize:"0.85rem",fontWeight:700},children:Z.stav_objednavky||(null===(t=v(Z))||void 0===t?void 0:t.replace(/_/g," "))||"N/A"})]})}),(0,V.jsx)("div",{onClick:()=>{var e;null!==(e=ce.current)&&void 0!==e&&e.expandSectionByName&&ce.current.expandSectionByName("schvaleni"),setTimeout(()=>{const e=document.querySelector('[data-section="schvaleni"]');e&&e.scrollIntoView({behavior:"smooth",block:"start"})},100)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"0.4rem 0.75rem",background:"linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%)",border:"2px solid #64748b",borderRadius:"6px",fontSize:"0.7rem",fontWeight:600,color:"#1e293b",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 4px 8px rgba(100, 116, 139, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.05)"},children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1px"},children:[(0,V.jsx)("div",{style:{fontSize:"0.6rem",opacity:.8,fontWeight:500},children:"MAX CENA S DPH"}),(0,V.jsxs)("div",{style:{fontSize:"0.85rem",fontWeight:700},children:[parseFloat(Z.max_cena_s_dph||0).toLocaleString("cs-CZ",{minimumFractionDigits:2,maximumFractionDigits:2})," K\u010d"]})]})}),(0,V.jsx)("div",{onClick:()=>{var e;null!==(e=ce.current)&&void 0!==e&&e.expandSectionByName&&ce.current.expandSectionByName("detaily"),setTimeout(()=>{const e=document.querySelector('[data-section="detaily"]');e&&e.scrollIntoView({behavior:"smooth",block:"start"})},100)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"0.4rem 0.75rem",background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",border:"2px solid #fbbf24",borderRadius:"6px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 4px 8px rgba(251, 191, 36, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.05)"},children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1px"},children:[(0,V.jsx)("div",{style:{fontSize:"0.6rem",opacity:.8,fontWeight:500},children:"POLO\u017dKY (DPH)"}),(0,V.jsxs)("div",{style:{fontSize:"0.85rem",fontWeight:700},children:[parseFloat(Z.polozky_celkova_cena_s_dph||0).toLocaleString("cs-CZ",{minimumFractionDigits:2,maximumFractionDigits:2})," K\u010d"]})]})}),(0,V.jsx)("div",{onClick:()=>{var e;null!==(e=ce.current)&&void 0!==e&&e.expandSectionByName&&ce.current.expandSectionByName("faktury"),setTimeout(()=>{const e=document.querySelector('[data-section="faktury"]');e&&e.scrollIntoView({behavior:"smooth",block:"start"})},100)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"0.4rem 0.75rem",background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",border:"2px solid #3b82f6",borderRadius:"6px",fontSize:"0.7rem",fontWeight:600,color:"#1e40af",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",whiteSpace:"nowrap",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 4px 8px rgba(59, 130, 246, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.05)"},children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1px"},children:[(0,V.jsx)("div",{style:{fontSize:"0.6rem",opacity:.8,fontWeight:500},children:"FAKTURY"}),(0,V.jsx)("div",{style:{fontSize:"0.85rem",fontWeight:700},children:((null===(to=Z.faktury)||void 0===to?void 0:to.reduce((e,n)=>e+parseFloat(n.fa_castka||0),0))||0).toLocaleString("cs-CZ",{minimumFractionDigits:2,maximumFractionDigits:2})+" K\u010d"})]})})]}),(0,V.jsxs)(pa,{onClick:()=>{var e,n;ue?null===(e=ce.current)||void 0===e||e.expandAll():null===(n=ce.current)||void 0===n||n.collapseAll()},children:[(0,V.jsx)(E.g,{icon:ue?O.Jt$:O.w2A}),ue?"Rozbalit v\u0161e":"Sbalit v\u0161e"]})]})]})}),(0,V.jsxs)(ma,{children:[W&&(0,V.jsxs)(Na,{children:[(0,V.jsx)(Ta,{}),(0,V.jsxs)("div",{children:["Na\u010d\xedt\xe1m ","smlouva"===Y?"smlouvu":"objedn\xe1vku","..."]})]}),!W&&!Z&&!K&&We.order_id&&(0,V.jsxs)(Da,{children:[(0,V.jsx)(E.g,{icon:O.zpE}),"Nepoda\u0159ilo se na\u010d\xedst objedn\xe1vku ID ",We.order_id]}),!W&&!Z&&!K&&!We.order_id&&(0,V.jsxs)("div",{style:{color:"#94a3af",textAlign:"center",padding:"3rem"},children:[(0,V.jsx)(E.g,{icon:"smlouva"===Y?O.IJd:O.URI,size:"3x",style:{marginBottom:"1rem",opacity:.3}}),(0,V.jsx)("div",{style:{fontSize:"1.1rem",marginBottom:"0.5rem"},children:"smlouva"===Y?"\u017d\xe1dn\xe1 smlouva nevybr\xe1na":"\u017d\xe1dn\xe1 objedn\xe1vka nevybr\xe1na"}),(0,V.jsx)("div",{style:{fontSize:"0.9rem"},children:'Za\u010dn\u011bte ps\xe1t do pole "Vyberte objedn\xe1vku nebo smlouvu"'})]}),!W&&Z&&"order"===Y&&(0,V.jsx)(le,{ref:ce,orderData:Z,onCollapseChange:pe,onEditInvoice:g?null:Vn,canEditInvoice:!g&&h(Z).allowed,editingInvoiceId:me,isReadOnlyMode:g,token:s,username:l}),!W&&K&&"smlouva"===Y&&(0,V.jsx)(Ke,{smlouvaData:K}),!1]})]})]})]});var to;return(0,V.jsxs)(V.Fragment,{children:[y?(0,S.createPortal)((0,V.jsx)(Hr,{children:oo}),document.body):(0,V.jsx)(Kr,{children:oo}),ke&&(0,S.createPortal)((0,V.jsxs)(ln.A,{isOpen:_e,onClose:()=>{ye(!1),je(null)},onConfirm:()=>{ye(!1),je(null)},title:"Objedn\xe1vka nen\xed dostupn\xe1",icon:O.DW4,variant:"warning",confirmText:"Zav\u0159\xedt",showCancel:!1,children:[(0,V.jsx)(Vr,{children:"Objedn\xe1vka je aktu\xe1ln\u011b editov\xe1na u\u017eivatelem:"}),(0,V.jsx)(Fr,{children:(0,V.jsx)("strong",{children:ke.lockedByUserName})}),(ke.lockedByUserEmail||ke.lockedByUserTelefon)&&(0,V.jsxs)(Wr,{children:[ke.lockedByUserEmail&&(0,V.jsxs)(Ur,{children:[(0,V.jsx)(E.g,{icon:O.y_8}),(0,V.jsx)(Zr,{children:"Email:"}),(0,V.jsx)("a",{href:"mailto:".concat(ke.lockedByUserEmail),children:ke.lockedByUserEmail})]}),ke.lockedByUserTelefon&&(0,V.jsxs)(Ur,{children:[(0,V.jsx)(E.g,{icon:O.KKr}),(0,V.jsx)(Zr,{children:"Telefon:"}),(0,V.jsx)("a",{href:"tel:".concat(ke.lockedByUserTelefon),children:ke.lockedByUserTelefon})]})]}),null!==ke.lockAgeMinutes&&void 0!==ke.lockAgeMinutes&&(0,V.jsxs)(Jr,{children:[(0,V.jsx)(E.g,{icon:O.a$}),"Zam\u010deno p\u0159ed ",ke.lockAgeMinutes," ",1===ke.lockAgeMinutes?"minutou":(ke.lockAgeMinutes,"minutami")]}),(0,V.jsx)(Vr,{children:"Objedn\xe1vku nelze na\u010d\xedst, dokud ji m\xe1 otev\u0159enou jin\xfd u\u017eivatel. Pros\xedm, kontaktujte u\u017eivatele v\xfd\u0161e a po\u017e\xe1dejte ho o ulo\u017een\xed a zav\u0159en\xed objedn\xe1vky."})]}),document.body),xe.isOpen&&(0,S.createPortal)((0,V.jsx)(ln.A,{isOpen:xe.isOpen,title:xe.title,message:xe.message,confirmText:xe.onCancel?"Ano, pokra\u010dovat":"OK",cancelText:"Zru\u0161it",showCancel:!!xe.onCancel,variant:"warning",icon:O.zpE,onConfirm:()=>{xe.onConfirm&&xe.onConfirm()},onClose:xe.onCancel?()=>{xe.onCancel&&xe.onCancel()}:()=>{}}),document.body),c("ADMIN")&&Ee&&(0,V.jsx)(Go,{panelState:Ne,setPanelState:Te,beginDrag:Xn,onClose:()=>Oe(!1),onOCRDataExtracted:qn,token:s,username:l,showToast:u}),Ce.show&&(0,S.createPortal)((0,V.jsx)(Ka,{children:(0,V.jsxs)(Ha,{children:[(0,V.jsxs)(Ya,{children:[(0,V.jsxs)(Ga,{status:Ce.status,children:["loading"===Ce.status&&(0,V.jsx)(E.g,{icon:O.z1G,spin:!0}),"success"===Ce.status&&(0,V.jsx)(E.g,{icon:O.SGM}),"error"===Ce.status&&(0,V.jsx)(E.g,{icon:O.s0Q})]}),(0,V.jsx)(qa,{children:Ce.title})]}),(0,V.jsx)(Xa,{children:Ce.message}),"loading"===Ce.status&&(0,V.jsx)(Qa,{children:(0,V.jsx)(ei,{progress:Ce.progress})}),(0,V.jsxs)(ni,{children:["success"===Ce.status&&(0,V.jsx)(oi,{variant:"primary",onClick:async()=>{var e,n,o;if(null!==(e=Ce.resetData)&&void 0!==e&&e.isVecnaSpravnost)return Ie({show:!1,status:"loading",progress:0,title:"",message:"",resetData:null}),void(null!==(o=Ce.resetData)&&void 0!==o&&o.isReadOnlyMode&&r("/invoices25-list"));Je([]),fe(null),Se(!1),null!==(n=a.state)&&void 0!==n&&n.editInvoiceId&&r(a.pathname,{replace:!0,state:{}});try{localStorage.removeItem("invoiceForm_".concat(d)),localStorage.removeItem("invoiceAttach_".concat(d)),localStorage.removeItem("invoiceEdit_".concat(d)),localStorage.removeItem("invoiceOrigEntity_".concat(d)),localStorage.removeItem("spisovka_active_dokument")}catch(u){console.warn("Chyba p\u0159i maz\xe1n\xed localStorage:",u)}const t=Ce.resetData||{},{wasEditing:i,currentOrderId:s,currentSmlouvaId:l}=t,c=i;Ue({order_id:c?"":s,smlouva_id:c?null:l,fa_cislo_vema:"",fa_typ:"BEZNA",fa_datum_doruceni:Br(new Date),fa_datum_vystaveni:"",fa_datum_splatnosti:"",fa_castka:"",fa_poznamka:"",fa_strediska_kod:[],file:null,fa_predana_zam_id:null,fa_datum_predani_zam:"",fa_datum_vraceni_zam:"",vecna_spravnost_umisteni_majetku:"",vecna_spravnost_poznamka:"",vecna_spravnost_potvrzeno:0,potvrdil_vecnou_spravnost_id:null,dt_potvrzeni_vecne_spravnosti:""}),c?(J(null),H(null),oe(""),de(!1),ze(!1),Se(!1)):(s&&Z&&await Pn(s),l&&K&&await $n(l)),ee({}),In(null),On(!1),qe([]),Qe(!1),fe(null),he(!1),Ie({show:!1,status:"loading",progress:0,title:"",message:"",resetData:null})},children:"Pokra\u010dovat"}),"error"===Ce.status&&(0,V.jsx)(oi,{variant:"primary",onClick:()=>{Ie({show:!1,status:"loading",progress:0,title:"",message:""})},children:"Zav\u0159\xedt"})]})]})}),document.body)]})}}}]);
//# sourceMappingURL=7121.bf15c5ed.chunk.js.map