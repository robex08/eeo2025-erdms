{"version":3,"file":"static/js/7121.bf15c5ed.chunk.js","mappings":"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","sources":["components/OrderFormReadOnly.js","components/SmlouvaPreview.js","components/ErrorDialog.js","services/apiSpisovkaZpracovani.js","components/panels/SpisovkaInboxPanel.js","pages/InvoiceEvidencePage.js"],"sourcesContent":["/**\n * OrderFormReadOnly - Read-only nhled objednvky\n * \n * Pesn 1:1 kopie OrderForm25 struktury jen pro zobrazen\n * Vetn svinovacch sekc a stejnho poad jako OrderForm25\n */\n\nimport React, { useState, useImperativeHandle, forwardRef } from 'react';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faUser, faBuilding, faFileAlt, faMoneyBillWave, faCalendar,\n  faCheckCircle, faClock, faMapMarkerAlt, faTruck, faChevronDown,\n  faClipboardCheck, faBox, faCoins, faCheck, faTimesCircle, faEdit,\n  faPaperclip, faFile, faDownload\n} from '@fortawesome/free-solid-svg-icons';\nimport { formatDateOnly } from '../utils/format';\nimport { downloadOrderAttachment, downloadInvoiceAttachment } from '../services/apiOrderV2';\n\n// ===================================================================\n// STYLED COMPONENTS - Zkoprovan z OrderForm25\n// ===================================================================\n\nconst FormContainer = styled.div`\n  background: #fafbfc;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst Section = styled.div`\n  background: white;\n  border-radius: 12px;\n  margin-bottom: 0.75rem;\n  border: 2px solid #e5e7eb;\n  overflow: hidden;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst SectionHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.5rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  border-left: 5px solid transparent;\n  position: relative;\n  \n  /* 3D efekt na lev lince */\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 5px;\n    box-shadow: \n      inset 2px 0 3px rgba(0, 0, 0, 0.15),\n      inset -1px 0 2px rgba(255, 255, 255, 0.5);\n  }\n  \n  /* Barevn schmata podle OF25 */\n  ${props => {\n    switch(props.$theme) {\n      case 'grey':\n        return `\n          background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n          border-left-color: #64748b;\n          &:hover { background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); }\n        `;\n      case 'orange':\n        return `\n          background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);\n          border-left-color: #f97316;\n          &:hover { background: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%); }\n        `;\n      case 'blue':\n        return `\n          background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\n          border-left-color: #3b82f6;\n          &:hover { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); }\n        `;\n      case 'purple':\n        return `\n          background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);\n          border-left-color: #a855f7;\n          &:hover { background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%); }\n        `;\n      case 'green':\n        return `\n          background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n          border-left-color: #22c55e;\n          &:hover { background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); }\n        `;\n      case 'red':\n        return `\n          background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n          border-left-color: #ef4444;\n          &:hover { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); }\n        `;\n      default:\n        return `\n          background: ${props.$isActive ? '#f8fafc' : '#fff'};\n          &:hover { background: #f1f5f9; }\n        `;\n    }\n  }}\n`;\n\nconst SectionTitle = styled.h3`\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  \n  svg {\n    ${props => {\n      switch(props.$theme) {\n        case 'grey': return 'color: #64748b;';\n        case 'orange': return 'color: #f97316;';\n        case 'blue': return 'color: #3b82f6;';\n        case 'purple': return 'color: #a855f7;';\n        case 'green': return 'color: #22c55e;';\n        case 'red': return 'color: #ef4444;';\n        default: return 'color: #3b82f6;';\n      }\n    }}\n  }\n`;\n\nconst CollapseIcon = styled.div`\n  transition: transform 0.3s ease;\n  transform: ${props => props.$collapsed ? 'rotate(180deg)' : 'rotate(0deg)'};\n  color: #64748b;\n  font-size: 1.2rem;\n`;\n\nconst SectionContent = styled.div`\n  max-height: ${props => props.$collapsed ? '0' : '5000px'};\n  overflow: hidden;\n  transition: max-height 0.3s ease;\n  padding: ${props => props.$collapsed ? '0 1.5rem' : '1.5rem'};\n  border-left: 5px solid transparent;\n  position: relative;\n  background: #fafbfc;\n  \n  /* 3D efekt na lev lince - pokraovn z headeru */\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 5px;\n    box-shadow: \n      inset 2px 0 3px rgba(0, 0, 0, 0.15),\n      inset -1px 0 2px rgba(255, 255, 255, 0.5);\n  }\n  \n  /* Barevn linka podle tmatu */\n  ${props => {\n    switch(props.$theme) {\n      case 'grey': return 'border-left-color: #64748b;';\n      case 'orange': return 'border-left-color: #f97316;';\n      case 'blue': return 'border-left-color: #3b82f6;';\n      case 'purple': return 'border-left-color: #a855f7;';\n      case 'green': return 'border-left-color: #22c55e;';\n      case 'red': return 'border-left-color: #ef4444;';\n      default: return '';\n    }\n  }}\n`;\n\nconst FieldRow = styled.div`\n  display: grid;\n  grid-template-columns: ${props => props.$columns || '1fr'};\n  gap: 1rem;\n  margin-bottom: 1rem;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst FieldGroup = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n`;\n\nconst FieldLabel = styled.div`\n  font-weight: 600;\n  color: #64748b;\n  font-size: 0.85rem;\n  text-transform: uppercase;\n  letter-spacing: 0.025em;\n`;\n\nconst FieldValue = styled.div`\n  font-size: 0.95rem;\n  color: #1e293b;\n  padding: 0.5rem 0;\n  \n  &.empty {\n    color: #94a3b8;\n    font-style: italic;\n  }\n  \n  &.highlight {\n    font-weight: 600;\n    color: #1e40af;\n  }\n`;\n\nconst Badge = styled.span`\n  display: inline-block;\n  padding: 0.25rem 0.75rem;\n  border-radius: 9999px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  background: ${props => props.$bg || '#f1f5f9'};\n  color: ${props => props.$color || '#475569'};\n`;\n\n// Nov komponenty pro lep organizaci\nconst InfoCard = styled.div`\n  background: white;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1rem;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst CardTitle = styled.div`\n  font-weight: 600;\n  color: #475569;\n  font-size: 0.875rem;\n  margin-bottom: 0.75rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 2px solid #e2e8f0;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  \n  svg {\n    color: #64748b;\n    font-size: 1rem;\n  }\n`;\n\nconst DataGrid = styled.div`\n  display: grid;\n  grid-template-columns: ${props => props.$columns || 'repeat(auto-fit, minmax(200px, 1fr))'};\n  gap: 1.25rem;\n  \n  @media (max-width: 768px) {\n    grid-template-columns: 1fr;\n  }\n`;\n\nconst KeyValuePair = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n  min-width: 0;\n`;\n\nconst KeyLabel = styled.div`\n  font-weight: 600;\n  color: #64748b;\n  font-size: 0.8rem;\n  text-transform: uppercase;\n  letter-spacing: 0.025em;\n`;\n\nconst ValueText = styled.div`\n  font-size: 0.95rem;\n  color: #1e293b;\n  word-wrap: break-word;\n  \n  &.empty {\n    color: #94a3b8;\n    font-style: italic;\n  }\n  \n  &.highlight {\n    font-weight: 600;\n    color: #1e40af;\n    font-size: 1.05rem;\n    white-space: nowrap;\n  }\n  \n  &.currency {\n    font-weight: 600;\n    color: #059669;\n    font-size: 1.05rem;\n  }\n`;\n\nconst Divider = styled.div`\n  height: 1px;\n  background: linear-gradient(to right, #e2e8f0, #f1f5f9, #e2e8f0);\n  margin: 1.5rem 0;\n`;\n\nconst ExpandCollapseButton = styled.button`\n  position: sticky;\n  top: 1rem;\n  right: 1rem;\n  float: right;\n  margin-bottom: 1rem;\n  padding: 0.5rem 1rem;\n  background: #3b82f6;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.2s;\n  z-index: 10;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n  \n  &:hover {\n    background: #2563eb;\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);\n  }\n`;\n\nconst EditInvoiceButton = styled.button`\n  padding: 0.5rem 1rem;\n  background: #f97316;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.2s;\n  box-shadow: 0 2px 8px rgba(249, 115, 22, 0.3);\n  \n  &:hover {\n    background: #ea580c;\n    box-shadow: 0 4px 12px rgba(249, 115, 22, 0.4);\n    transform: translateY(-1px);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n`;\n\nconst OrderFormReadOnly = forwardRef(({ orderData, onCollapseChange, onEditInvoice, canEditInvoice = true, editingInvoiceId, isReadOnlyMode = false, token, username }, ref) => {\n  // State pro svinovac sekce\n  const [collapsed, setCollapsed] = useState({\n    objednatel: false,\n    schvaleni: false,\n    dodavatel: false,\n    detaily: false,\n    dodani: false,\n    fakturace: false,\n    poznamky: false,\n    registr: false,\n    vecna_spravnost: false,\n    dokonceni: false,\n    prilohy: false\n  });\n\n  const toggleSection = (section) => {\n    setCollapsed(prev => {\n      const newCollapsed = { ...prev, [section]: !prev[section] };\n      // Notify parent about change\n      if (onCollapseChange) {\n        const hasAnyCollapsed = Object.values(newCollapsed).some(val => val === true);\n        onCollapseChange(hasAnyCollapsed);\n      }\n      return newCollapsed;\n    });\n  };\n\n  const collapseAll = () => {\n    const allCollapsed = {};\n    Object.keys(collapsed).forEach(key => {\n      allCollapsed[key] = true;\n    });\n    setCollapsed(allCollapsed);\n    if (onCollapseChange) {\n      onCollapseChange(true);\n    }\n  };\n\n  const expandAll = () => {\n    const allExpanded = {};\n    Object.keys(collapsed).forEach(key => {\n      allExpanded[key] = false;\n    });\n    setCollapsed(allExpanded);\n    if (onCollapseChange) {\n      onCollapseChange(false);\n    }\n  };\n\n  const areAllCollapsed = Object.values(collapsed).every(val => val === true);\n  const areAllExpanded = Object.values(collapsed).every(val => val === false);\n\n  // Export collapse functions via ref\n  useImperativeHandle(ref, () => ({\n    collapseAll,\n    expandAll,\n    areAllCollapsed,\n    areAllExpanded\n  }));\n\n  if (!orderData) {\n    return (\n      <div style={{ padding: '3rem', textAlign: 'center', color: '#94a3b8' }}>\n        <FontAwesomeIcon icon={faFileAlt} size=\"3x\" style={{ marginBottom: '1rem', opacity: 0.3 }} />\n        <div>dn data k zobrazen</div>\n      </div>\n    );\n  }\n\n  const formatCurrency = (value) => {\n    if (!value) return '';\n    return `${parseFloat(value).toLocaleString('cs-CZ')} K`;\n  };\n\n  const getWorkflowBadges = () => {\n    if (!orderData.stav_workflow_kod || !Array.isArray(orderData.stav_workflow_kod)) return null;\n    \n    const badgeColors = {\n      'SCHVALENA': { bg: '#dcfce7', color: '#166534' },\n      'ODESLANA': { bg: '#dbeafe', color: '#1e40af' },\n      'POTVRZENA': { bg: '#e0e7ff', color: '#4338ca' },\n      'NEUVEREJNIT': { bg: '#fef3c7', color: '#92400e' },\n      'FAKTURACE': { bg: '#fce7f3', color: '#9f1239' },\n      'VECNA_SPRAVNOST': { bg: '#f3e8ff', color: '#6b21a8' },\n      'ZKONTROLOVANA': { bg: '#d1fae5', color: '#065f46' },\n      'DOKONCENA': { bg: '#ccfbf1', color: '#115e59' }\n    };\n\n    return orderData.stav_workflow_kod.map((kod, index) => {\n      const colors = badgeColors[kod] || { bg: '#f1f5f9', color: '#475569' };\n      return (\n        <React.Fragment key={kod}>\n          <Badge $bg={colors.bg} $color={colors.color} style={{ marginBottom: '0.5rem' }}>\n            {kod.replace('_', ' ')}\n          </Badge>\n          {index < orderData.stav_workflow_kod.length - 1 && (\n            <span style={{ margin: '0 0.5rem', color: '#64748b', fontWeight: '600' }}></span>\n          )}\n        </React.Fragment>\n      );\n    });\n  };\n\n  return (\n    <FormContainer>\n      {/* SEKCE 1: INFORMACE O OBJEDNATELI */}\n      <Section>\n        <SectionHeader $theme=\"grey\" $isActive={!collapsed.objednatel} onClick={() => toggleSection('objednatel')}>\n          <SectionTitle $theme=\"grey\">\n            <FontAwesomeIcon icon={faUser} />\n            Informace o objednateli\n          </SectionTitle>\n          <CollapseIcon $collapsed={collapsed.objednatel}>\n            <FontAwesomeIcon icon={faChevronDown} />\n          </CollapseIcon>\n        </SectionHeader>\n        <SectionContent $collapsed={collapsed.objednatel} $theme=\"grey\">\n          {/* Objednatel */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faUser} />\n              Objednatel\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {(() => {\n                    const enriched = orderData._enriched?.uzivatel || orderData._enriched?.objednatel;\n                    if (enriched) {\n                      const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                      const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                      return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                    }\n                    return orderData.uzivatel?.cele_jmeno || orderData.jmeno || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>\n                  {(() => {\n                    const enriched = orderData._enriched?.uzivatel || orderData._enriched?.objednatel;\n                    return enriched?.telefon || orderData.objednatel_telefon || orderData.uzivatel?.telefon || orderData.telefon || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\" style={{marginTop: '1rem'}}>\n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>\n                  {(() => {\n                    const enriched = orderData._enriched?.uzivatel || orderData._enriched?.objednatel;\n                    return enriched?.email || orderData.uzivatel?.email || orderData.email || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n\n          {/* Garant */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faCheckCircle} />\n              Garant objednvky\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {(() => {\n                    const enriched = orderData._enriched?.garant_uzivatel;\n                    if (enriched) {\n                      const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                      const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                      return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                    }\n                    return orderData.garant_uzivatel?.cele_jmeno || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.garant_uzivatel?.telefon || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\" style={{marginTop: '1rem'}}>\n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.garant_uzivatel?.email || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n        </SectionContent>\n      </Section>\n\n      {/* SEKCE 2: SCHVLEN NKUPU PO */}\n      <Section data-section=\"schvaleni\">\n        <SectionHeader $theme=\"grey\" $isActive={!collapsed.schvaleni} onClick={() => toggleSection('schvaleni')}>\n          <SectionTitle $theme=\"grey\">\n            <FontAwesomeIcon icon={faClipboardCheck} />\n            Schvlen nkupu PO\n          </SectionTitle>\n          <CollapseIcon $collapsed={collapsed.schvaleni}>\n            <FontAwesomeIcon icon={faChevronDown} />\n          </CollapseIcon>\n        </SectionHeader>\n        <SectionContent $collapsed={collapsed.schvaleni} $theme=\"grey\">\n          {/* Zkladn informace o objednvce */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faFileAlt} />\n              Zkladn daje\n            </CardTitle>\n            <KeyValuePair style={{ marginBottom: '1rem' }}>\n              <KeyLabel>Pedmt objednvky</KeyLabel>\n              <ValueText className=\"highlight\">{orderData.predmet || ''}</ValueText>\n            </KeyValuePair>\n            \n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>slo objednvky</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {orderData.cislo_objednavky || `#${orderData.id}`}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Datum objednvky</KeyLabel>\n                <ValueText>\n                  {orderData.dt_objednavky ? formatDateOnly(orderData.dt_objednavky) : ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\">\n              <KeyValuePair style={{textAlign: 'right'}}>\n                <KeyLabel style={{textAlign: 'right'}}>Max. cena s DPH</KeyLabel>\n                <ValueText className=\"currency\" style={{textAlign: 'right'}}>\n                  {formatCurrency(orderData.max_cena_s_dph)}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n\n          {/* Pkazce */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faUser} />\n              Pkazce rozpotu\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {(() => {\n                    const enriched = orderData._enriched?.prikazce;\n                    if (enriched) {\n                      const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                      const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                      return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                    }\n                    return orderData.prikazce?.cele_jmeno || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.prikazce?.telefon || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\" style={{marginTop: '1rem'}}>\n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.prikazce?.email || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n\n          {/* Schvalovatel */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faCheckCircle} />\n              Schvalovatel\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {(() => {\n                    const enriched = orderData._enriched?.schvalovatel;\n                    if (enriched) {\n                      const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                      const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                      return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                    }\n                    return orderData.schvalovatel?.cele_jmeno || '';\n                  })()}\n                </ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.schvalovatel?.telefon || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <DataGrid $columns=\"1fr\" style={{marginTop: '1rem'}}>\n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>\n                  {orderData._enriched?.schvalovatel?.email || ''}\n                </ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n\n          {/* Stediska */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faBuilding} />\n              Stediska\n            </CardTitle>\n            <KeyValuePair>\n              <ValueText>\n                {(() => {\n                  // Backend vrac _enriched.strediska s nzvy\n                  if (orderData._enriched?.strediska && Array.isArray(orderData._enriched.strediska)) {\n                    return orderData._enriched.strediska\n                      .map(s => s.nazev || s.kod)\n                      .join(', ') || '';\n                  }\n                  // Fallback: jen kdy\n                  if (orderData.strediska_kod && Array.isArray(orderData.strediska_kod)) {\n                    return orderData.strediska_kod.join(', ');\n                  }\n                  return '';\n                })()}\n              </ValueText>\n            </KeyValuePair>\n          </InfoCard>\n\n          {/* Financovn */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faCoins} />\n              Zpsob financovn a workflow\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Typ financovn</KeyLabel>\n                <ValueText className=\"highlight\">\n                  {orderData.financovani?.typ_nazev || orderData.financovani?.typ || ''}\n                </ValueText>\n              </KeyValuePair>\n\n              {/* LP - Limitovan psliby */}\n              {orderData.financovani?.lp_nazvy && orderData.financovani.lp_nazvy.length > 0 && (\n                <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                  <KeyLabel>Limitovan psliby</KeyLabel>\n                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem', marginTop: '0.5rem' }}>\n                    {orderData.financovani.lp_nazvy.map((lp, idx) => {\n                      let lpText = '';\n                      if (typeof lp === 'object') {\n                        const kod = lp.cislo_lp || lp.kod || lp.id;\n                        const popis = lp.nazev || lp.nazev_uctu || lp.label;\n                        lpText = kod && popis ? `${kod} - ${popis}` : (popis || kod || 'LP');\n                      } else {\n                        lpText = String(lp);\n                      }\n                      return (\n                        <Badge key={idx} $bg=\"#dbeafe\" $color=\"#1e40af\">\n                          {lpText}\n                        </Badge>\n                      );\n                    })}\n                  </div>\n                </KeyValuePair>\n              )}\n\n              {/* Smlouva - dynamick pole */}\n              {(() => {\n                const typKod = orderData.financovani?.typ_kod || orderData.financovani?.typ || orderData.zpusob_financovani;\n                const isSmlouva = typKod === 'SMLOUVA' || typKod?.toUpperCase?.() === 'SMLOUVA';\n                \n                if (isSmlouva) {\n                  return (\n                    <>\n                      <KeyValuePair>\n                        <KeyLabel>slo smlouvy</KeyLabel>\n                        <ValueText>{orderData.financovani?.cislo_smlouvy || orderData.cislo_smlouvy || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                      <KeyValuePair>\n                        <KeyLabel>Poznmka ke smlouv</KeyLabel>\n                        <ValueText>{orderData.financovani?.smlouva_poznamka || orderData.smlouva_poznamka || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                    </>\n                  );\n                }\n                return null;\n              })()}\n\n              {/* Individuln schvlen - dynamick pole */}\n              {(() => {\n                const typKod = orderData.financovani?.typ_kod || orderData.financovani?.typ || orderData.zpusob_financovani;\n                const isIndividualni = typKod === 'INDIVIDUALNI_SCHVALENI' || typKod?.toUpperCase?.() === 'INDIVIDUALNI_SCHVALENI' || \n                                      typKod === 'INDIVIDUALNI SCHVALENI' || typKod?.includes?.('INDIVIDUALNI');\n                \n                if (isIndividualni) {\n                  return (\n                    <>\n                      <KeyValuePair>\n                        <KeyLabel>slo vzvy</KeyLabel>\n                        <ValueText>{orderData.financovani?.individualni_schvaleni || orderData.individualni_schvaleni || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                      <KeyValuePair>\n                        <KeyLabel>Poznmka</KeyLabel>\n                        <ValueText>{orderData.financovani?.individualni_poznamka || orderData.individualni_poznamka || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                    </>\n                  );\n                }\n                return null;\n              })()}\n\n              {/* Pojistn udlost - dynamick pole */}\n              {(() => {\n                const typKod = orderData.financovani?.typ_kod || orderData.financovani?.typ || orderData.zpusob_financovani;\n                const isPojistna = typKod === 'POJISTNA_UDALOST' || typKod?.toUpperCase?.() === 'POJISTNA_UDALOST' ||\n                                  typKod === 'POJISTNA UDALOST' || typKod?.includes?.('POJISTNA');\n                \n                if (isPojistna) {\n                  return (\n                    <>\n                      <KeyValuePair>\n                        <KeyLabel>slo pojistn udlosti</KeyLabel>\n                        <ValueText>{orderData.financovani?.pojistna_udalost_cislo || orderData.pojistna_udalost_cislo || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                      <KeyValuePair>\n                        <KeyLabel>Poznmka k pojistn udlosti</KeyLabel>\n                        <ValueText>{orderData.financovani?.pojistna_udalost_poznamka || orderData.pojistna_udalost_poznamka || <span style={{color: '#9ca3af'}}>Nen vyplnno</span>}</ValueText>\n                      </KeyValuePair>\n                    </>\n                  );\n                }\n                return null;\n              })()}\n\n              {/* Workflow stavy */}\n              <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                <KeyLabel>Stavy workflow</KeyLabel>\n                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem', alignItems: 'center', marginTop: '0.5rem' }}>\n                  {getWorkflowBadges()}\n                </div>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n        </SectionContent>\n      </Section>\n\n      {/* SEKCE 3: DODAVATEL */}\n      <Section>\n        <SectionHeader $theme=\"orange\" $isActive={!collapsed.dodavatel} onClick={() => toggleSection('dodavatel')}>\n          <SectionTitle $theme=\"orange\">\n            <FontAwesomeIcon icon={faBuilding} />\n            Dodavatel\n          </SectionTitle>\n          <CollapseIcon $collapsed={collapsed.dodavatel}>\n            <FontAwesomeIcon icon={faChevronDown} />\n          </CollapseIcon>\n        </SectionHeader>\n        <SectionContent $collapsed={collapsed.dodavatel} $theme=\"orange\">\n          {/* Zkladn daje dodavatele */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faBuilding} />\n              Zkladn daje\n            </CardTitle>\n            <KeyValuePair style={{ marginBottom: '1rem' }}>\n              <KeyLabel>Nzev dodavatele</KeyLabel>\n              <ValueText className=\"highlight\">{orderData.dodavatel_nazev || ''}</ValueText>\n            </KeyValuePair>\n            \n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>IO</KeyLabel>\n                <ValueText>{orderData.dodavatel_ico || ''}</ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>DI</KeyLabel>\n                <ValueText>{orderData.dodavatel_dic || ''}</ValueText>\n              </KeyValuePair>\n            </DataGrid>\n            \n            <KeyValuePair style={{ marginTop: '1rem' }}>\n              <KeyLabel>Adresa</KeyLabel>\n              <ValueText>{orderData.dodavatel_adresa || ''}</ValueText>\n            </KeyValuePair>\n          </InfoCard>\n\n          {/* Kontaktn osoba */}\n          <InfoCard>\n            <CardTitle>\n              <FontAwesomeIcon icon={faUser} />\n              Kontaktn osoba\n            </CardTitle>\n            <DataGrid $columns=\"1fr 1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Jmno</KeyLabel>\n                <ValueText>{orderData.dodavatel_kontakt_jmeno || ''}</ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>E-mail</KeyLabel>\n                <ValueText>{orderData.dodavatel_kontakt_email || ''}</ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Telefon</KeyLabel>\n                <ValueText>{orderData.dodavatel_kontakt_telefon || ''}</ValueText>\n              </KeyValuePair>\n            </DataGrid>\n          </InfoCard>\n        </SectionContent>\n      </Section>\n\n      {/* SEKCE 5: DETAILY OBJEDNVKY */}\n      {orderData.polozky && orderData.polozky.length > 0 && (\n        <Section data-section=\"detaily\">\n          <SectionHeader $theme=\"orange\" $isActive={!collapsed.detaily} onClick={() => toggleSection('detaily')}>\n            <SectionTitle $theme=\"orange\">\n              <FontAwesomeIcon icon={faBox} />\n              Detaily objednvky ({orderData.polozky_count || orderData.polozky.length} {orderData.polozky.length === 1 ? 'poloka' : 'poloek'})\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.detaily}>\n              <FontAwesomeIcon icon={faChevronDown} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.detaily} $theme=\"orange\">\n            <FieldRow>\n              <FieldGroup>\n                <FieldLabel>Druh objednvky</FieldLabel>\n                <FieldValue>\n                  {orderData._enriched?.druh_objednavky?.nazev || \n                   orderData.druh_objednavky_nazev || \n                   orderData.druh_objednavky || \n                   ''}\n                </FieldValue>\n              </FieldGroup>\n            </FieldRow>\n\n            <div style={{ marginTop: '1.5rem' }}>\n              <div style={{ fontWeight: '600', marginBottom: '1rem', color: '#374151' }}>\n                Poloky objednvky\n              </div>\n              {orderData.polozky.map((polozka, idx) => (\n                <div key={idx} style={{ \n                  padding: '1rem', \n                  background: '#fafafa', \n                  border: '1px solid #e5e7eb',\n                  borderRadius: '8px', \n                  marginBottom: '1rem' \n                }}>\n                  <div style={{ fontWeight: '600', color: '#374151', marginBottom: '1rem', fontSize: '0.9rem', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\n                    <span>POLOKA {idx + 1}</span>\n                    {/* LP kd poloky - najt v orderData.financovani.lp_nazvy podle lp_id */}\n                    {polozka.lp_id && (() => {\n                      // Najt LP podle ID v orderData.financovani.lp_nazvy\n                      const lpData = orderData.financovani?.lp_nazvy?.find(lp => lp.id === polozka.lp_id);\n                      \n                      if (!lpData) return null;\n                      \n                      return (\n                        <Badge \n                          $bg={polozka.lp_je_platne !== false ? '#dcfce7' : '#fee2e2'}\n                          $color={polozka.lp_je_platne !== false ? '#166534' : '#991b1b'}\n                        >\n                           LP: {lpData.cislo_lp} - {lpData.nazev}\n                        </Badge>\n                      );\n                    })()}\n                  </div>\n\n                  <FieldRow>\n                    <FieldGroup>\n                      <FieldLabel>Nzev / popis</FieldLabel>\n                      <FieldValue>{polozka.popis || ''}</FieldValue>\n                    </FieldGroup>\n                  </FieldRow>\n\n                  <FieldRow $columns=\"1fr auto 1fr\">\n                    <FieldGroup>\n                      <FieldLabel>Cena bez DPH</FieldLabel>\n                      <FieldValue>{formatCurrency(polozka.cena_bez_dph)}</FieldValue>\n                    </FieldGroup>\n                    \n                    <FieldGroup>\n                      <FieldLabel>DPH</FieldLabel>\n                      <FieldValue>{polozka.sazba_dph || '21'}%</FieldValue>\n                    </FieldGroup>\n                    \n                    <FieldGroup>\n                      <FieldLabel>Cena s DPH</FieldLabel>\n                      <FieldValue className=\"highlight\">\n                        {formatCurrency(polozka.cena_s_dph)}\n                      </FieldValue>\n                    </FieldGroup>\n                  </FieldRow>\n\n                  {/* Umstn - sek, budova, mstnost z JSON polozky */}\n                  {(polozka.usek_kod || polozka.budova_kod || polozka.mistnost_kod || polozka.poznamka) && (\n                    <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px dashed #d1d5db' }}>\n                      <div style={{ fontWeight: '600', color: '#6b7280', marginBottom: '0.75rem', fontSize: '0.85rem' }}>\n                        UMSTN MAJETKU\n                      </div>\n                      <FieldRow $columns=\"1fr 1fr 1fr\">\n                        {polozka.usek_kod && (\n                          <FieldGroup>\n                            <FieldLabel>sek</FieldLabel>\n                            <FieldValue>{polozka.usek_kod}</FieldValue>\n                          </FieldGroup>\n                        )}\n                        {polozka.budova_kod && (\n                          <FieldGroup>\n                            <FieldLabel>Budova</FieldLabel>\n                            <FieldValue>{polozka.budova_kod}</FieldValue>\n                          </FieldGroup>\n                        )}\n                        {polozka.mistnost_kod && (\n                          <FieldGroup>\n                            <FieldLabel>Mstnost</FieldLabel>\n                            <FieldValue>{polozka.mistnost_kod}</FieldValue>\n                          </FieldGroup>\n                        )}\n                      </FieldRow>\n                      {(polozka.usek_kod || polozka.budova_kod || polozka.mistnost_kod) && (\n                        <FieldRow style={{ marginTop: '0.5rem' }}>\n                          <FieldGroup>\n                            <FieldLabel>Poznmka k mstu</FieldLabel>\n                            <FieldValue>{polozka.poznamka || <span style={{color: '#9ca3af'}}>---</span>}</FieldValue>\n                          </FieldGroup>\n                        </FieldRow>\n                      )}\n                    </div>\n                  )}\n                </div>\n              ))}\n\n              <div style={{ marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '2px solid #e5e7eb', display: 'flex', justifyContent: 'flex-end', alignItems: 'center', gap: '1rem' }}>\n                <div style={{ fontWeight: '600', fontSize: '1.1rem', color: '#374151' }}>Celkem s DPH:</div>\n                <div style={{ fontWeight: '700', fontSize: '1.3rem', color: '#1e40af' }}>\n                  {formatCurrency(orderData.polozky_celkova_cena_s_dph)}\n                </div>\n              </div>\n            </div>\n\n            {/* Poznmka k objednvce */}\n            <FieldRow style={{ marginTop: '1.5rem' }}>\n              <FieldGroup>\n                <FieldLabel>Poznmka k objednvce</FieldLabel>\n                <FieldValue>{orderData.poznamka_objednavky || orderData.poznamka || <span style={{color: '#9ca3af'}}>---</span>}</FieldValue>\n              </FieldGroup>\n            </FieldRow>\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 5: DODN */}\n      <Section>\n        <SectionHeader $theme=\"orange\" $isActive={!collapsed.dodani} onClick={() => toggleSection('dodani')}>\n          <SectionTitle $theme=\"orange\">\n            <FontAwesomeIcon icon={faTruck} />\n            Dodn\n          </SectionTitle>\n          <CollapseIcon $collapsed={collapsed.dodani}>\n            <FontAwesomeIcon icon={faChevronDown} />\n          </CollapseIcon>\n        </SectionHeader>\n        <SectionContent $collapsed={collapsed.dodani} $theme=\"orange\">\n          <InfoCard>\n            <DataGrid $columns=\"1fr 1fr\">\n              <KeyValuePair>\n                <KeyLabel>Msto dodn</KeyLabel>\n                <ValueText>{orderData.misto_dodani || ''}</ValueText>\n              </KeyValuePair>\n              \n              <KeyValuePair>\n                <KeyLabel>Pedpokldan termn dodn</KeyLabel>\n                <ValueText>\n                  {orderData.dt_predpokladany_termin_dodani \n                    ? formatDateOnly(orderData.dt_predpokladany_termin_dodani) \n                    : ''}\n                </ValueText>\n              </KeyValuePair>\n\n              <KeyValuePair>\n                <KeyLabel>Zruka</KeyLabel>\n                <ValueText>{orderData.zaruka || <span style={{color: '#9ca3af'}}>---</span>}</ValueText>\n              </KeyValuePair>\n\n              {orderData.dt_akceptace && (\n                <>\n                  <KeyValuePair>\n                    <KeyLabel>Datum akceptace dodavatelem</KeyLabel>\n                    <ValueText>\n                      {formatDateOnly(orderData.dt_akceptace)}\n                    </ValueText>\n                  </KeyValuePair>\n                  \n                  <KeyValuePair>\n                    <KeyLabel>Potvrdil dodavatel</KeyLabel>\n                    <ValueText>\n                      {(() => {\n                        const enriched = orderData._enriched?.dodavatel_potvrdil;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return orderData.dodavatel_potvrdil_jmeno || '';\n                      })()}\n                    </ValueText>\n                  </KeyValuePair>\n                </>\n              )}\n            </DataGrid>\n          </InfoCard>\n        </SectionContent>\n      </Section>\n\n      {/* SEKCE 6: UVEEJNN V REGISTRU SMLUV */}\n      {('zverejnit' in orderData) && (\n        <Section>\n          <SectionHeader $theme=\"blue\" $isActive={!collapsed.registr} onClick={() => toggleSection('registr')}>\n            <SectionTitle $theme=\"blue\">\n              <FontAwesomeIcon icon={faFileAlt} />\n              Rozhodnut o zveejnn v registru smluv\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.registr}>\n              <FontAwesomeIcon icon={faChevronDown} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.registr} $theme=\"blue\">\n            {(() => {\n              // Robustn kontrola - pevedeme na string a porovnme\n              const jeZverejnit = String(orderData.zverejnit) === '1';\n              \n              return (\n                <InfoCard>\n                  <DataGrid $columns=\"1fr 1fr\">\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>M bt zveejnna v registru smluv</KeyLabel>\n                      <div style={{ \n                        display: 'inline-flex',\n                        alignItems: 'center',\n                        gap: '0.5rem',\n                        padding: '0.5rem 1rem',\n                        background: jeZverejnit ? '#dcfce7' : '#fee2e2',\n                        border: `2px solid ${jeZverejnit ? '#16a34a' : '#ef4444'}`,\n                        borderRadius: '8px',\n                        color: jeZverejnit ? '#166534' : '#991b1b',\n                        fontWeight: '600',\n                        marginTop: '0.5rem'\n                      }}>\n                        <FontAwesomeIcon icon={jeZverejnit ? faCheckCircle : faTimesCircle} />\n                        {jeZverejnit ? 'ANO' : 'NE'}\n                      </div>\n                    </KeyValuePair>\n\n                    {/* Pokud NE (0), zobraz info e nebyla zveejnna */}\n                    {!jeZverejnit && (\n                      <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                        <ValueText style={{ color: '#6b7280', fontStyle: 'italic' }}>\n                          Objednvka nebyla zveejnna v registru smluv.\n                        </ValueText>\n                      </KeyValuePair>\n                    )}\n\n                    {/* Datum a ID se zobraz POUZE pokud m bt zveejnna */}\n                    {jeZverejnit && orderData.dt_zverejneni && (\n                      <>\n                        <KeyValuePair>\n                          <KeyLabel>Datum zveejnn</KeyLabel>\n                          <ValueText>{formatDateOnly(orderData.dt_zverejneni)}</ValueText>\n                        </KeyValuePair>\n                        <KeyValuePair>\n                          <KeyLabel>Zveejnil</KeyLabel>\n                          <ValueText>\n                            {(() => {\n                              const enriched = orderData._enriched?.zverejnil;\n                              if (enriched) {\n                                const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                                const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                                return `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                              }\n                              return orderData.zverejnil_jmeno || '';\n                            })()}\n                          </ValueText>\n                        </KeyValuePair>\n                      </>\n                    )}\n\n                    {jeZverejnit && orderData.registr_iddt && (\n                      <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                        <KeyLabel>ID smlouvy v registru</KeyLabel>\n                        <ValueText>{orderData.registr_iddt}</ValueText>\n                      </KeyValuePair>\n                    )}\n                  </DataGrid>\n                </InfoCard>\n              );\n            })()}\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 7: FAKTURY */}\n      {orderData.faktury && orderData.faktury.length > 0 && (\n        <Section data-section=\"faktury\">\n          <SectionHeader $theme=\"blue\" $isActive={!collapsed.fakturace} onClick={() => toggleSection('fakturace')}>\n            <SectionTitle $theme=\"blue\">\n              <FontAwesomeIcon icon={faMoneyBillWave} />\n              Fakturace k objednvce ({orderData.faktury.length})\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.fakturace}>\n              <FontAwesomeIcon icon={faChevronDown} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.fakturace} $theme=\"blue\">\n            {orderData.faktury.map((faktura, index) => {\n              const isVecnaPotvrzena = faktura.vecna_spravnost_potvrzeno === 1;\n              const isBeingEdited = editingInvoiceId && (faktura.id === editingInvoiceId || faktura.id === Number(editingInvoiceId));\n              return (\n              <div key={faktura.id || index} style={{\n                border: isBeingEdited ? '3px solid #f59e0b' : '2px solid #3b82f6',\n                borderRadius: '12px',\n                padding: '0',\n                marginBottom: index < orderData.faktury.length - 1 ? '1.5rem' : 0,\n                background: isBeingEdited ? '#fffbeb' : (isVecnaPotvrzena ? '#f0fdf4' : '#ffffff'),\n                boxShadow: isBeingEdited ? '0 4px 16px rgba(245, 158, 11, 0.3)' : '0 2px 8px rgba(0, 0, 0, 0.08)',\n                overflow: 'hidden',\n                position: 'relative',\n                transition: 'all 0.2s ease'\n              }}>\n                {/* Zhlav faktury - vrazn */}\n                <div style={{\n                  background: isBeingEdited \n                    ? 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)' \n                    : 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)',\n                  color: 'white',\n                  padding: '1rem 1.25rem',\n                  fontWeight: '700',\n                  fontSize: '1.1rem',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'space-between',\n                  gap: '1rem',\n                  borderBottom: isBeingEdited ? '3px solid #b45309' : '3px solid #1e40af',\n                  letterSpacing: '0.5px',\n                  textTransform: 'uppercase'\n                }}>\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\n                    <FontAwesomeIcon icon={isBeingEdited ? faEdit : faMoneyBillWave} style={{ fontSize: '1.2rem' }} />\n                    Faktura #{index + 1}\n                    {faktura.fa_cislo_vema && (\n                      <span style={{ \n                        fontWeight: '600',\n                        fontSize: '0.9rem',\n                        background: 'rgba(255, 255, 255, 0.2)',\n                        padding: '0.25rem 0.75rem',\n                        borderRadius: '6px',\n                        letterSpacing: 'normal',\n                        textTransform: 'none'\n                      }}>\n                        {faktura.fa_cislo_vema}\n                      </span>\n                    )}\n                  </div>\n                  {/* Swap: bu tlatko Upravit NEBO badge Editace */}\n                  {isBeingEdited ? (\n                    <div style={{\n                      background: 'rgba(255, 255, 255, 0.25)',\n                      color: 'white',\n                      border: '1px solid rgba(255, 255, 255, 0.4)',\n                      padding: '0.5rem 1rem',\n                      fontWeight: '600',\n                      borderRadius: '8px',\n                      fontSize: '0.85rem',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.5rem',\n                      letterSpacing: '0.05em'\n                    }}>\n                      <FontAwesomeIcon icon={faEdit} />\n                      {isReadOnlyMode ? 'PRV KONTROLUJETE' : 'PRV EDITUJETE'}\n                    </div>\n                  ) : onEditInvoice && canEditInvoice && (\n                    <EditInvoiceButton \n                      onClick={(e) => {\n                        e.stopPropagation();\n                        onEditInvoice(faktura);\n                      }}\n                      style={{\n                        background: 'rgba(255, 255, 255, 0.25)',\n                        color: 'white',\n                        border: '1px solid rgba(255, 255, 255, 0.4)',\n                        padding: '0.5rem 1rem',\n                        fontWeight: '600'\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.background = 'rgba(255, 255, 255, 0.35)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.background = 'rgba(255, 255, 255, 0.25)';\n                      }}\n                    >\n                      <FontAwesomeIcon icon={faEdit} />\n                      Upravit\n                    </EditInvoiceButton>\n                  )}\n                </div>\n\n                {/* Obsah faktury */}\n                <div style={{ padding: '1.25rem' }}>\n                <DataGrid $columns=\"1fr 1fr\">\n                  <KeyValuePair>\n                    <KeyLabel>slo faktury</KeyLabel>\n                    <ValueText>{faktura.fa_cislo_vema || ''}</ValueText>\n                  </KeyValuePair>\n                  \n                  <KeyValuePair>\n                    <KeyLabel>stka</KeyLabel>\n                    <ValueText className=\"highlight\">\n                      {formatCurrency(faktura.fa_castka)}\n                    </ValueText>\n                  </KeyValuePair>\n\n                  <KeyValuePair>\n                    <KeyLabel>Datum vystaven</KeyLabel>\n                    <ValueText>\n                      {faktura.fa_datum_vystaveni ? formatDateOnly(faktura.fa_datum_vystaveni) : ''}\n                    </ValueText>\n                  </KeyValuePair>\n                  \n                  <KeyValuePair>\n                    <KeyLabel>Datum splatnosti</KeyLabel>\n                    <ValueText>\n                      {(faktura.fa_datum_splatnosti || faktura.fa_splatnost)\n                        ? formatDateOnly(faktura.fa_datum_splatnosti || faktura.fa_splatnost)\n                        : ''}\n                    </ValueText>\n                  </KeyValuePair>\n                  \n                  <KeyValuePair>\n                    <KeyLabel>Datum doruen</KeyLabel>\n                    <ValueText>\n                      {faktura.fa_datum_doruceni ? formatDateOnly(faktura.fa_datum_doruceni) : ''}\n                    </ValueText>\n                  </KeyValuePair>\n\n                  <KeyValuePair>\n                    <KeyLabel>Typ faktury</KeyLabel>\n                    <ValueText>\n                      {(() => {\n                        const typ = faktura.fa_typ || 'BEZNA';\n                        const typColors = {\n                          'BEZNA': { bg: '#f1f5f9', color: '#475569' },\n                          'ZALOHOVA': { bg: '#dbeafe', color: '#1e40af' },\n                          'OPRAVNA': { bg: '#fef3c7', color: '#92400e' },\n                          'PROFORMA': { bg: '#f3e8ff', color: '#6b21a8' },\n                          'DOBROPIS': { bg: '#d1fae5', color: '#065f46' }\n                        };\n                        const colors = typColors[typ] || typColors['BEZNA'];\n                        return (\n                          <Badge $bg={colors.bg} $color={colors.color}>\n                            {typ}\n                          </Badge>\n                        );\n                      })()}\n                    </ValueText>\n                  </KeyValuePair>\n\n                  {faktura.fa_strediska_kod && (\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>Stediska</KeyLabel>\n                      <ValueText>\n                        {(() => {\n                          const strediska = faktura.fa_strediska_kod;\n                          if (Array.isArray(strediska)) {\n                            const formatted = strediska\n                              .map(s => {\n                                if (typeof s === 'object') {\n                                  const kod = s.kod || s.value;\n                                  const nazev = s.nazev || s.label;\n                                  return kod && nazev ? `${kod} - ${nazev}` : (nazev || kod || s);\n                                }\n                                return s;\n                              })\n                              .filter(Boolean)\n                              .join(', ');\n                            return formatted || '';\n                          }\n                          if (typeof strediska === 'string') {\n                            return strediska || '';\n                          }\n                          return '';\n                        })()}\n                      </ValueText>\n                    </KeyValuePair>\n                  )}\n\n                  <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                    <KeyLabel>Poznmka</KeyLabel>\n                    <ValueText>{faktura.fa_poznamka || <span style={{color: '#9ca3af'}}>---</span>}</ValueText>\n                  </KeyValuePair>\n\n                  {faktura._isdoc_dodavatel && (\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>ISDOC Dodavatel</KeyLabel>\n                      <ValueText>\n                        {faktura._isdoc_dodavatel.nazev}\n                        {faktura._isdoc_dodavatel.ico && ` (IO: ${faktura._isdoc_dodavatel.ico})`}\n                      </ValueText>\n                    </KeyValuePair>\n                  )}\n\n                </DataGrid>\n\n                {/* PLOHY FAKTURY */}\n                {faktura.prilohy && faktura.prilohy.length > 0 && (\n                  <div style={{\n                    margin: '1.5rem 0 1rem 0',\n                    borderTop: '2px solid #e5e7eb',\n                    paddingTop: '1rem'\n                  }}>\n                    <div style={{\n                      fontWeight: '600',\n                      color: '#1e40af',\n                      fontSize: '0.9rem',\n                      marginBottom: '1rem',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.5rem'\n                    }}>\n                      <FontAwesomeIcon icon={faPaperclip} style={{ color: '#3b82f6' }} />\n                      PLOHY FAKTURY . {index + 1} ({faktura.prilohy.length})\n                    </div>\n\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\n                      {faktura.prilohy.map((priloha, idx) => {\n                        const formatFileSize = (bytes) => {\n                          if (!bytes || bytes === 0) return '0 B';\n                          const k = 1024;\n                          const sizes = ['B', 'KB', 'MB', 'GB'];\n                          const i = Math.floor(Math.log(bytes) / Math.log(k));\n                          return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n                        };\n\n                        const getTypeBadge = (typ) => {\n                          const typeMap = {\n                            'FAKTURA': { bg: '#dbeafe', color: '#1e40af', label: 'Faktura' },\n                            'ISDOC': { bg: '#e0e7ff', color: '#4338ca', label: 'ISDOC' },\n                            'PRILOHA': { bg: '#f3e8ff', color: '#6b21a8', label: 'Ploha' },\n                            'SMLOUVA': { bg: '#fef3c7', color: '#92400e', label: 'Smlouva' },\n                            'IMPORT': { bg: '#fce7f3', color: '#9f1239', label: 'Import' },\n                            'JINE': { bg: '#f1f5f9', color: '#475569', label: 'Jin' },\n                            'JINA': { bg: '#f1f5f9', color: '#475569', label: 'Jin' }\n                          };\n                          const config = typeMap[typ] || typeMap['JINA'];\n                          return (\n                            <Badge $bg={config.bg} $color={config.color}>\n                              {config.label}\n                            </Badge>\n                          );\n                        };\n\n                        const handleDownload = async () => {\n                          try {\n                            const blob = await downloadInvoiceAttachment(faktura.id, priloha.id, username, token);\n                            const url = window.URL.createObjectURL(blob);\n                            const a = document.createElement('a');\n                            a.href = url;\n                            a.download = priloha.originalni_nazev_souboru || 'attachment';\n                            document.body.appendChild(a);\n                            a.click();\n                            window.URL.revokeObjectURL(url);\n                            document.body.removeChild(a);\n                          } catch (error) {\n                            console.error('Error downloading invoice attachment:', error);\n                            // Error u byl zpracovn v API vrstv, sta zobrazit error.message\n                            alert(error.message || 'Nepodailo se sthnout plohu faktury');\n                          }\n                        };\n\n                        return (\n                          <div key={priloha.id || idx} onClick={handleDownload} style={{\n                            display: 'flex',\n                            alignItems: 'center',\n                            gap: '0.75rem',\n                            padding: '0.5rem 0.75rem',\n                            background: '#f9fafb',\n                            borderRadius: '6px',\n                            border: '1px solid #e5e7eb',\n                            cursor: 'pointer',\n                            transition: 'all 0.2s ease',\n                          }}\n                          onMouseEnter={(e) => {\n                            e.currentTarget.style.background = '#f3f4f6';\n                            e.currentTarget.style.borderColor = '#3b82f6';\n                          }}\n                          onMouseLeave={(e) => {\n                            e.currentTarget.style.background = '#f9fafb';\n                            e.currentTarget.style.borderColor = '#e5e7eb';\n                          }}\n                          title=\"Kliknte pro staen\">\n                            <FontAwesomeIcon icon={faFile} style={{ color: '#6b7280', fontSize: '1rem' }} />\n                            <div style={{ flex: 1, minWidth: 0 }}>\n                              <div style={{\n                                fontSize: '0.875rem',\n                                color: '#374151',\n                                fontWeight: '500',\n                                overflow: 'hidden',\n                                textOverflow: 'ellipsis',\n                                whiteSpace: 'nowrap'\n                              }}>\n                                {priloha.originalni_nazev_souboru || 'Nepojmenovan soubor'}\n                              </div>\n                              <div style={{\n                                fontSize: '0.75rem',\n                                color: '#9ca3af',\n                                marginTop: '2px'\n                              }}>\n                                {formatFileSize(priloha.velikost_souboru_b)}\n                              </div>\n                            </div>\n                            {getTypeBadge(priloha.typ_prilohy)}\n                            <FontAwesomeIcon icon={faDownload} style={{ color: '#3b82f6', fontSize: '0.875rem', marginLeft: '0.5rem' }} />\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                )}\n\n                {/* DLC RA - VCN KONTROLA FAKTURY */}\n                <div style={{\n                  margin: '1.5rem 0 1rem 0',\n                  borderTop: '2px solid #e5e7eb',\n                  paddingTop: '1rem'\n                }}>\n                  <div style={{\n                    fontWeight: '600',\n                    color: '#6b21a8',\n                    fontSize: '0.9rem',\n                    marginBottom: '1rem',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '0.5rem'\n                  }}>\n                    <FontAwesomeIcon icon={faClipboardCheck} style={{ color: '#a855f7' }} />\n                    VCN KONTROLA FAKTURY {index + 1}\n                  </div>\n\n                  <DataGrid $columns=\"1fr 1fr\">\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>Stav vcn kontroly</KeyLabel>\n                      <ValueText>\n                        {faktura.vecna_spravnost_potvrzeno === 1 || faktura.vecna_spravnost_potvrzeno === '1' ? (\n                          <div style={{\n                            display: 'inline-flex',\n                            alignItems: 'center',\n                            gap: '0.5rem',\n                            padding: '0.5rem 1rem',\n                            background: '#dcfce7',\n                            border: '2px solid #16a34a',\n                            borderRadius: '8px',\n                            color: '#166534',\n                            fontWeight: '600'\n                          }}>\n                            <FontAwesomeIcon icon={faCheckCircle} />\n                            Potvrzeno\n                          </div>\n                        ) : (\n                          <div style={{\n                            display: 'inline-flex',\n                            alignItems: 'center',\n                            gap: '0.5rem',\n                            padding: '0.5rem 1rem',\n                            background: '#fee2e2',\n                            border: '2px solid #ef4444',\n                            borderRadius: '8px',\n                            color: '#991b1b',\n                            fontWeight: '600'\n                          }}>\n                            <FontAwesomeIcon icon={faTimesCircle} />\n                            Nepotvrzeno\n                          </div>\n                        )}\n                      </ValueText>\n                    </KeyValuePair>\n\n                    <KeyValuePair>\n                      <KeyLabel>Datum potvrzen</KeyLabel>\n                      <ValueText>\n                        {faktura.dt_potvrzeni_vecne_spravnosti \n                          ? <span style={{fontWeight: '600', color: '#059669'}}>{formatDateOnly(faktura.dt_potvrzeni_vecne_spravnosti)}</span>\n                          : <span style={{color: '#9ca3af'}}>Nepotvrzeno</span>}\n                      </ValueText>\n                    </KeyValuePair>\n                    \n                    <KeyValuePair>\n                      <KeyLabel>Potvrdil</KeyLabel>\n                      <ValueText>\n                        {(() => {\n                          // Primrn pouij jmno z DB (JOIN) vetn titul\n                          if (faktura.potvrdil_vecnou_spravnost_jmeno) {\n                            const titul_pred = faktura.potvrdil_vecnou_spravnost_titul_pred ? `${faktura.potvrdil_vecnou_spravnost_titul_pred} ` : '';\n                            const titul_za = faktura.potvrdil_vecnou_spravnost_titul_za ? `, ${faktura.potvrdil_vecnou_spravnost_titul_za}` : '';\n                            const fullName = `${titul_pred}${faktura.potvrdil_vecnou_spravnost_jmeno} ${faktura.potvrdil_vecnou_spravnost_prijmeni || ''}${titul_za}`.trim();\n                            return <span style={{fontWeight: '600', color: '#059669'}}>{fullName}</span>;\n                          }\n                          // Fallback na enriched data\n                          const enriched = faktura._enriched?.potvrdil_vecnou_spravnost;\n                          if (enriched) {\n                            const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                            const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                            const fullName = `${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                            return <span style={{fontWeight: '600', color: '#059669'}}>{fullName}</span>;\n                          }\n                          return <span style={{color: '#9ca3af'}}></span>;\n                        })()}\n                      </ValueText>\n                    </KeyValuePair>\n\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>Umstn majetku</KeyLabel>\n                      <ValueText>\n                        {faktura.vecna_spravnost_umisteni_majetku || <span style={{color: '#9ca3af'}}>---</span>}\n                      </ValueText>\n                    </KeyValuePair>\n\n                    <KeyValuePair style={{ gridColumn: '1 / -1' }}>\n                      <KeyLabel>Poznmka k vcn kontrole</KeyLabel>\n                      <ValueText>\n                        {faktura.vecna_spravnost_poznamka || <span style={{color: '#9ca3af'}}>---</span>}\n                      </ValueText>\n                    </KeyValuePair>\n                  </DataGrid>\n                </div>\n                </div>\n                {/* Konec obsahu faktury */}\n              </div>\n            );\n            })}\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 8: POZNMKY */}\n      {orderData.poznamka && (\n        <Section>\n          <SectionHeader $theme=\"orange\" $isActive={!collapsed.poznamky} onClick={() => toggleSection('poznamky')}>\n            <SectionTitle $theme=\"orange\">\n              <FontAwesomeIcon icon={faFileAlt} />\n              Poznmky\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.poznamky}>\n              <FontAwesomeIcon icon={faChevronDown} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.poznamky} $theme=\"orange\">\n            <InfoCard>\n              <ValueText style={{ whiteSpace: 'pre-wrap', wordBreak: 'break-word' }}>{orderData.poznamka}</ValueText>\n            </InfoCard>\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 9: DOKONEN */}\n      {orderData.stav_workflow_kod && orderData.stav_workflow_kod.includes('DOKONCENA') && (\n        <Section>\n          <SectionHeader $theme=\"green\" $isActive={!collapsed.dokonceni} onClick={() => toggleSection('dokonceni')}>\n            <SectionTitle $theme=\"green\">\n              <FontAwesomeIcon icon={faCheck} />\n              Dokonen objednvky\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.dokonceni}>\n              <FontAwesomeIcon icon={faChevronDown} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.dokonceni} $theme=\"green\">\n            <div style={{\n              padding: '1rem',\n              background: '#dcfce7',\n              border: '2px solid #16a34a',\n              borderRadius: '8px',\n              color: '#166534',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '0.75rem',\n              fontWeight: '600',\n              marginBottom: '1.5rem'\n            }}>\n              <FontAwesomeIcon icon={faCheckCircle} size=\"lg\" />\n              Objednvka byla spn dokonena\n            </div>\n\n            {/* Workflow timeline */}\n            <div style={{ marginBottom: '1.5rem' }}>\n              <h4 style={{ marginBottom: '1rem', color: '#166534', fontSize: '0.95rem', fontWeight: '600' }}>\n                Historie workflow\n              </h4>\n              \n              {/* 1. Schvlen */}\n              {orderData.dt_schvaleni && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Schvlen objednvky\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_schvaleni)}\n                      {(() => {\n                        const enriched = orderData._enriched?.schvalovatel;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 2. Odesln dodavateli */}\n              {orderData.dt_odeslani && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Odesln dodavateli\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_odeslani)}\n                      {(() => {\n                        const enriched = orderData._enriched?.odesilatel;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 3. Potvrzen dodavatele */}\n              {orderData.dt_akceptace && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Potvrzen dodavatele\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_akceptace)}\n                      {(() => {\n                        const enriched = orderData._enriched?.dodavatel_potvrdil;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 4. Registr smluv (optional) */}\n              {orderData.dt_zverejneni && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Zveejnn v registru smluv\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_zverejneni)}\n                      {(() => {\n                        const enriched = orderData._enriched?.zverejnil;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 5. Fakturace */}\n              {orderData.dt_faktura_pridana && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Pidn faktury\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_faktura_pridana)}\n                      {(() => {\n                        const enriched = orderData._enriched?.fakturant;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 6. Vcn sprvnost objednvky (agregovan) */}\n              {orderData.dt_potvrzeni_vecne_spravnosti && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem',\n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Potvrzen vcn sprvnosti (objednvka)\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_potvrzeni_vecne_spravnosti)}\n                      {(() => {\n                        const enriched = orderData._enriched?.potvrdil_vecnou_spravnost;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* 6b. Individuln vcn sprvnost u faktur */}\n              {orderData.faktury && orderData.faktury.some(f => f.dt_potvrzeni_vecne_spravnosti) && (\n                <div style={{ \n                  marginBottom: '0.75rem',\n                  paddingBottom: '0.75rem',\n                  borderBottom: '1px solid #e5e7eb'\n                }}>\n                  <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.5rem', fontSize: '0.95rem' }}>\n                    Vcn sprvnost jednotlivch faktur:\n                  </div>\n                  {orderData.faktury\n                    .filter(f => f.dt_potvrzeni_vecne_spravnosti)\n                    .map((faktura, idx) => {\n                      const isBeingEdited = editingInvoiceId && (faktura.id === editingInvoiceId || faktura.id === Number(editingInvoiceId));\n                      return (\n                        <div key={faktura.id || idx} style={{ \n                          display: 'flex', \n                          alignItems: 'flex-start', \n                          gap: '0.75rem',\n                          marginBottom: idx < orderData.faktury.filter(f => f.dt_potvrzeni_vecne_spravnosti).length - 1 ? '0.5rem' : 0,\n                          paddingLeft: '1rem',\n                          padding: isBeingEdited ? '0.5rem 0.75rem 0.5rem 1rem' : '0 0 0 1rem',\n                          background: isBeingEdited ? '#fffbeb' : 'transparent',\n                          borderRadius: '6px',\n                          border: isBeingEdited ? '2px solid #f59e0b' : 'none',\n                          transition: 'all 0.2s ease'\n                        }}>\n                          <span style={{ color: '#16a34a', fontSize: '1rem', lineHeight: '1.4' }}></span>\n                          <div style={{ flex: 1 }}>\n                            <div style={{ fontSize: '0.875rem', color: isBeingEdited ? '#78350f' : '#6b7280' }}>\n                              <span style={{ \n                                fontWeight: isBeingEdited ? '700' : '500', \n                                color: isBeingEdited ? '#92400e' : '#4b5563' \n                              }}>\n                                {faktura.fa_cislo_vema || `Faktura #${orderData.faktury.indexOf(faktura) + 1}`}\n                                {isBeingEdited && '  PRV EDITUJETE'}\n                              </span>\n                              {'  '}\n                              {formatDateOnly(faktura.dt_potvrzeni_vecne_spravnosti)}\n                              {(() => {\n                                // Pout data z SQL JOINu (priorita) nebo enriched jako fallback\n                                let jmeno, prijmeni, titul_pred, titul_za;\n                                \n                                if (faktura.potvrdil_vecnou_spravnost_jmeno) {\n                                  // Data z SQL JOINu\n                                  jmeno = faktura.potvrdil_vecnou_spravnost_jmeno;\n                                  prijmeni = faktura.potvrdil_vecnou_spravnost_prijmeni;\n                                  titul_pred = faktura.potvrdil_vecnou_spravnost_titul_pred;\n                                  titul_za = faktura.potvrdil_vecnou_spravnost_titul_za;\n                                } else if (faktura._enriched?.potvrdil_vecnou_spravnost) {\n                                  // Enriched data jako fallback\n                                  const enriched = faktura._enriched.potvrdil_vecnou_spravnost;\n                                  jmeno = enriched.jmeno;\n                                  prijmeni = enriched.prijmeni;\n                                  titul_pred = enriched.titul_pred;\n                                  titul_za = enriched.titul_za;\n                                }\n                                \n                                if (jmeno && prijmeni) {\n                                  const titul_pred_str = titul_pred ? `${titul_pred} ` : '';\n                                  const titul_za_str = titul_za ? `, ${titul_za}` : '';\n                                  return `  ${titul_pred_str}${jmeno} ${prijmeni}${titul_za_str}`;\n                                }\n                                return '';\n                              })()}\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                </div>\n              )}\n\n              {/* 7. Dokonen objednvky */}\n              {orderData.dt_dokonceni && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'flex-start', \n                  gap: '0.75rem'\n                }}>\n                  <span style={{ color: '#16a34a', fontSize: '1.1rem', lineHeight: '1.4' }}></span>\n                  <div style={{ flex: 1 }}>\n                    <div style={{ fontWeight: '600', color: '#374151', marginBottom: '0.25rem' }}>\n                      Dokonen objednvky\n                    </div>\n                    <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n                      {formatDateOnly(orderData.dt_dokonceni)}\n                      {(() => {\n                        const enriched = orderData._enriched?.dokoncil;\n                        if (enriched) {\n                          const titul_pred = enriched.titul_pred ? `${enriched.titul_pred} ` : '';\n                          const titul_za = enriched.titul_za ? `, ${enriched.titul_za}` : '';\n                          return `  ${titul_pred}${enriched.jmeno} ${enriched.prijmeni}${titul_za}`;\n                        }\n                        return '';\n                      })()}\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Price comparison warning */}\n            {orderData.faktury_celkem_s_dph && orderData.max_cena_s_dph && \n             parseFloat(orderData.faktury_celkem_s_dph) > parseFloat(orderData.max_cena_s_dph) && (\n              <div style={{\n                padding: '0.75rem 1rem',\n                background: '#fef2f2',\n                border: '1px solid #fca5a5',\n                borderRadius: '6px',\n                color: '#991b1b',\n                fontSize: '0.875rem',\n                marginBottom: '1rem'\n              }}>\n                <strong> Upozornn:</strong> Celkov cena faktur (\n                {parseFloat(orderData.faktury_celkem_s_dph).toLocaleString('cs-CZ', {\n                  minimumFractionDigits: 2,\n                  maximumFractionDigits: 2\n                })} K) pekrauje maximln cenu objednvky (\n                {parseFloat(orderData.max_cena_s_dph).toLocaleString('cs-CZ', {\n                  minimumFractionDigits: 2,\n                  maximumFractionDigits: 2\n                })} K)\n              </div>\n            )}\n\n            {/* Poznmka k dokonen */}\n            <FieldGroup>\n              <FieldLabel>Poznmka k dokonen</FieldLabel>\n              <FieldValue>{orderData.dokonceni_poznamka || <span style={{color: '#9ca3af'}}>---</span>}</FieldValue>\n            </FieldGroup>\n          </SectionContent>\n        </Section>\n      )}\n\n      {/* SEKCE 10: PLOHY */}\n      {orderData.prilohy_count > 0 && (\n        <Section>\n          <SectionHeader $theme=\"red\" $isActive={!collapsed.prilohy} onClick={() => toggleSection('prilohy')}>\n            <SectionTitle $theme=\"red\">\n              <FontAwesomeIcon icon={faFileAlt} />\n              Plohy ({orderData.prilohy_count})\n            </SectionTitle>\n            <CollapseIcon $collapsed={collapsed.prilohy}>\n              <FontAwesomeIcon icon={faChevronDown} />\n            </CollapseIcon>\n          </SectionHeader>\n          <SectionContent $collapsed={collapsed.prilohy} $theme=\"red\">\n            {orderData.prilohy && orderData.prilohy.length > 0 ? (\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\n                {orderData.prilohy.map((priloha, idx) => {\n                  const formatFileSize = (bytes) => {\n                    if (!bytes || bytes === 0) return '0 B';\n                    const k = 1024;\n                    const sizes = ['B', 'KB', 'MB', 'GB'];\n                    const i = Math.floor(Math.log(bytes) / Math.log(k));\n                    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n                  };\n\n                  const getTypeBadge = (typ) => {\n                    const typeMap = {\n                      'FAKTURA': { bg: '#dbeafe', color: '#1e40af', label: 'Faktura' },\n                      'ISDOC': { bg: '#e0e7ff', color: '#4338ca', label: 'ISDOC' },\n                      'PRILOHA': { bg: '#f3e8ff', color: '#6b21a8', label: 'Ploha' },\n                      'SMLOUVA': { bg: '#fef3c7', color: '#92400e', label: 'Smlouva' },\n                      'OBJEDNAVKA': { bg: '#d1fae5', color: '#065f46', label: 'Objednvka' },\n                      'IMPORT': { bg: '#fce7f3', color: '#9f1239', label: 'Import' },\n                      'JINE': { bg: '#f1f5f9', color: '#475569', label: 'Jin' },\n                      'JINA': { bg: '#f1f5f9', color: '#475569', label: 'Jin' }\n                    };\n                    const config = typeMap[typ] || typeMap['JINA'];\n                    return (\n                      <Badge $bg={config.bg} $color={config.color}>\n                        {config.label}\n                      </Badge>\n                    );\n                  };\n\n                  const handleDownload = async () => {\n                    try {\n                      const blob = await downloadOrderAttachment(orderData.id, priloha.id, username, token);\n                      const url = window.URL.createObjectURL(blob);\n                      const a = document.createElement('a');\n                      a.href = url;\n                      a.download = priloha.originalni_nazev_souboru || priloha.nazev_souboru || 'attachment';\n                      document.body.appendChild(a);\n                      a.click();\n                      window.URL.revokeObjectURL(url);\n                      document.body.removeChild(a);\n                    } catch (error) {\n                      console.error('Error downloading order attachment:', error);\n                      // Error u byl zpracovn v API vrstv, sta zobrazit error.message\n                      alert(error.message || 'Nepodailo se sthnout plohu objednvky');\n                    }\n                  };\n\n                  return (\n                    <div key={priloha.id || idx} onClick={handleDownload} style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.75rem',\n                      padding: '0.75rem 1rem',\n                      background: '#f9fafb',\n                      borderRadius: '8px',\n                      border: '1px solid #e5e7eb',\n                      cursor: 'pointer',\n                      transition: 'all 0.2s ease',\n                    }}\n                    onMouseEnter={(e) => {\n                      e.currentTarget.style.background = '#f3f4f6';\n                      e.currentTarget.style.borderColor = '#3b82f6';\n                    }}\n                    onMouseLeave={(e) => {\n                      e.currentTarget.style.background = '#f9fafb';\n                      e.currentTarget.style.borderColor = '#e5e7eb';\n                    }}\n                    title=\"Kliknte pro staen\">\n                      <FontAwesomeIcon icon={faFile} style={{ color: '#6b7280', fontSize: '1.25rem' }} />\n                      <div style={{ flex: 1, minWidth: 0 }}>\n                        <div style={{\n                          fontSize: '0.9rem',\n                          color: '#374151',\n                          fontWeight: '500',\n                          overflow: 'hidden',\n                          textOverflow: 'ellipsis',\n                          whiteSpace: 'nowrap'\n                        }}>\n                          {priloha.originalni_nazev_souboru || priloha.nazev_souboru || 'Nepojmenovan soubor'}\n                        </div>\n                        <div style={{\n                          fontSize: '0.8rem',\n                          color: '#9ca3af',\n                          marginTop: '2px'\n                        }}>\n                          {formatFileSize(priloha.velikost_souboru_b || priloha.velikost)}\n                        </div>\n                      </div>\n                      {getTypeBadge(priloha.typ_prilohy || priloha.typ)}\n                      <FontAwesomeIcon icon={faDownload} style={{ color: '#3b82f6', fontSize: '1rem', marginLeft: '0.5rem' }} />\n                    </div>\n                  );\n                })}\n              </div>\n            ) : (\n              <FieldValue>\n                Poet ploh: <strong>{orderData.prilohy_count}</strong>\n              </FieldValue>\n            )}\n          </SectionContent>\n        </Section>\n      )}\n    </FormContainer>\n  );\n});\n\nOrderFormReadOnly.displayName = 'OrderFormReadOnly';\n\nexport default OrderFormReadOnly;\n","import React from 'react';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { \n  faFileContract, \n  faBuilding, \n  faMoneyBillWave, \n  faCalendar,\n  faUser,\n  faMapMarkerAlt,\n  faClipboardList\n} from '@fortawesome/free-solid-svg-icons';\n\nconst PreviewContainer = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  height: 100%;\n  overflow-y: auto;\n`;\n\nconst PreviewHeader = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding-bottom: 1rem;\n  border-bottom: 2px solid #e5e7eb;\n  margin-bottom: 1.5rem;\n`;\n\nconst HeaderIcon = styled.div`\n  width: 48px;\n  height: 48px;\n  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 1.5rem;\n  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);\n`;\n\nconst HeaderInfo = styled.div`\n  flex: 1;\n`;\n\nconst ContractNumber = styled.div`\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: #1e40af;\n  margin-bottom: 0.25rem;\n`;\n\nconst ContractTitle = styled.div`\n  font-size: 0.95rem;\n  color: #6b7280;\n  font-weight: 500;\n`;\n\nconst Section = styled.div`\n  margin-bottom: 1.5rem;\n`;\n\nconst SectionTitle = styled.div`\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: #6b7280;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-bottom: 0.75rem;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n\nconst InfoGrid = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 1rem;\n`;\n\nconst InfoItem = styled.div`\n  background: #f9fafb;\n  padding: 0.875rem;\n  border-radius: 8px;\n  border: 1px solid #e5e7eb;\n`;\n\nconst InfoLabel = styled.div`\n  font-size: 0.75rem;\n  color: #9ca3af;\n  margin-bottom: 0.25rem;\n  font-weight: 500;\n`;\n\nconst InfoValue = styled.div`\n  font-size: 0.95rem;\n  color: #1f2937;\n  font-weight: 600;\n`;\n\nconst FullWidthInfo = styled(InfoItem)`\n  grid-column: 1 / -1;\n`;\n\nconst AmountDisplay = styled.div`\n  background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);\n  border: 2px solid #10b981;\n  border-radius: 12px;\n  padding: 1.25rem;\n  margin-bottom: 1.5rem;\n  text-align: center;\n`;\n\nconst AmountLabel = styled.div`\n  font-size: 0.85rem;\n  color: #065f46;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n`;\n\nconst AmountValue = styled.div`\n  font-size: 2rem;\n  font-weight: 700;\n  color: #065f46;\n`;\n\nconst StatusBadge = styled.div`\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 0.5rem 1rem;\n  background: ${props => props.$active ? 'linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)' : 'linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%)'};\n  border: 2px solid ${props => props.$active ? '#10b981' : '#d1d5db'};\n  border-radius: 8px;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: ${props => props.$active ? '#065f46' : '#6b7280'};\n`;\n\nconst NoData = styled.div`\n  padding: 3rem;\n  text-align: center;\n  color: #9ca3af;\n  font-size: 0.95rem;\n`;\n\nconst formatCurrency = (value) => {\n  if (!value && value !== 0) return '';\n  return new Intl.NumberFormat('cs-CZ', {\n    style: 'currency',\n    currency: 'CZK',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2\n  }).format(value);\n};\n\nconst formatDate = (dateStr) => {\n  if (!dateStr) return '';\n  try {\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('cs-CZ');\n  } catch {\n    return dateStr;\n  }\n};\n\nconst SmlouvaPreview = ({ smlouvaData, loading }) => {\n  // Support both smlouva and smlouvaData props\n  const smlouva = smlouvaData;\n\n  if (loading) {\n    return (\n      <PreviewContainer>\n        <NoData>\n          <FontAwesomeIcon icon={faFileContract} size=\"3x\" style={{ marginBottom: '1rem', opacity: 0.3 }} />\n          <div>Natm smlouvu...</div>\n        </NoData>\n      </PreviewContainer>\n    );\n  }\n\n  if (!smlouva) {\n    return (\n      <PreviewContainer>\n        <NoData>\n          <FontAwesomeIcon icon={faFileContract} size=\"3x\" style={{ marginBottom: '1rem', opacity: 0.3 }} />\n          <div>dn smlouva nen vybrna</div>\n        </NoData>\n      </PreviewContainer>\n    );\n  }\n\n  return (\n    <PreviewContainer>\n      <PreviewHeader>\n        <HeaderIcon>\n          <FontAwesomeIcon icon={faFileContract} />\n        </HeaderIcon>\n        <HeaderInfo>\n          <ContractNumber>{smlouva.cislo_smlouvy || 'Bez sla'}</ContractNumber>\n          <ContractTitle>{smlouva.nazev_smlouvy || smlouva.nazev || 'Smlouva'}</ContractTitle>\n        </HeaderInfo>\n        {(smlouva.pouzit_v_obj_formu === 1 || smlouva.pouzit_v_obj_formu === '1' || smlouva.pouzit_v_obj_formu === true) && (\n          <StatusBadge $active={false} style={{ background: '#dbeafe', color: '#1e40af', marginRight: '8px' }}>\n            FORM\n          </StatusBadge>\n        )}\n        <StatusBadge $active={smlouva.aktivni === 1 || smlouva.aktivni === '1' || smlouva.aktivni === true}>\n          {(smlouva.aktivni === 1 || smlouva.aktivni === '1' || smlouva.aktivni === true) ? 'Aktivn' : 'Neaktivn'}\n        </StatusBadge>\n      </PreviewHeader>\n\n      {/* Celkov stka plnn */}\n      <AmountDisplay>\n        <AmountLabel>\n          <FontAwesomeIcon icon={faMoneyBillWave} /> Celkem plnn s DPH\n        </AmountLabel>\n        <AmountValue>\n          {formatCurrency(smlouva.hodnota_s_dph || 0)}\n        </AmountValue>\n      </AmountDisplay>\n\n      {/* Dodavatel */}\n      <Section>\n        <SectionTitle>\n          <FontAwesomeIcon icon={faBuilding} />\n          Dodavatel\n        </SectionTitle>\n        <InfoGrid>\n          <FullWidthInfo>\n            <InfoLabel>Nzev</InfoLabel>\n            <InfoValue>{smlouva.nazev_firmy || ''}</InfoValue>\n          </FullWidthInfo>\n          {smlouva.ico && (\n            <InfoItem>\n              <InfoLabel>IO</InfoLabel>\n              <InfoValue>{smlouva.ico}</InfoValue>\n            </InfoItem>\n          )}\n          {smlouva.dic && (\n            <InfoItem>\n              <InfoLabel>DI</InfoLabel>\n              <InfoValue>{smlouva.dic}</InfoValue>\n            </InfoItem>\n          )}\n        </InfoGrid>\n      </Section>\n\n      {/* Datumy */}\n      <Section>\n        <SectionTitle>\n          <FontAwesomeIcon icon={faCalendar} />\n          Termny\n        </SectionTitle>\n        <InfoGrid>\n          {(smlouva.datum_uzavreni || smlouva.datum_podpisu || smlouva.datum_uzavreni_smlouvy || smlouva.dt_vytvoreni) && (\n            <InfoItem>\n              <InfoLabel>Datum importu</InfoLabel>\n              <InfoValue>{formatDate(smlouva.datum_uzavreni || smlouva.datum_podpisu || smlouva.datum_uzavreni_smlouvy || smlouva.dt_vytvoreni)}</InfoValue>\n            </InfoItem>\n          )}\n          {(smlouva.platnost_od || smlouva.datum_od) && (\n            <InfoItem>\n              <InfoLabel>Platnost od</InfoLabel>\n              <InfoValue>{formatDate(smlouva.platnost_od || smlouva.datum_od)}</InfoValue>\n            </InfoItem>\n          )}\n          {(smlouva.platnost_do || smlouva.datum_do) && (() => {\n            const platnostDo = smlouva.platnost_do || smlouva.datum_do;\n            const isExpired = platnostDo && new Date(platnostDo) < new Date();\n            return (\n              <InfoItem style={{ \n                background: isExpired ? '#fee2e2' : '#d1fae5',\n                border: `2px solid ${isExpired ? '#dc2626' : '#10b981'}`\n              }}>\n                <InfoLabel style={{ color: isExpired ? '#7f1d1d' : '#065f46' }}>Platnost do</InfoLabel>\n                <InfoValue style={{ color: isExpired ? '#7f1d1d' : '#065f46' }}>\n                  {formatDate(platnostDo)}\n                </InfoValue>\n              </InfoItem>\n            );\n          })()}\n          {(smlouva.datum_ukonceni || smlouva.ukonceni) && (\n            <InfoItem>\n              <InfoLabel>Datum ukonen</InfoLabel>\n              <InfoValue>{formatDate(smlouva.datum_ukonceni || smlouva.ukonceni)}</InfoValue>\n            </InfoItem>\n          )}\n        </InfoGrid>\n      </Section>\n\n      {/* Pedmt */}\n      {smlouva.predmet && (\n        <Section>\n          <SectionTitle>\n            <FontAwesomeIcon icon={faClipboardList} />\n            Pedmt smlouvy\n          </SectionTitle>\n          <FullWidthInfo>\n            <InfoValue style={{ whiteSpace: 'pre-wrap' }}>{smlouva.predmet}</InfoValue>\n          </FullWidthInfo>\n        </Section>\n      )}\n\n      {/* erpn */}\n      {(smlouva.cerpano_celkem !== undefined || smlouva.cerpano !== undefined) && (\n        <Section>\n          <SectionTitle>\n            <FontAwesomeIcon icon={faMoneyBillWave} />\n            erpn\n          </SectionTitle>\n          <InfoGrid>\n            <InfoItem>\n              <InfoLabel>erpno</InfoLabel>\n              <InfoValue>{formatCurrency(smlouva.cerpano_celkem || smlouva.cerpano || 0)}</InfoValue>\n            </InfoItem>\n            <InfoItem>\n              <InfoLabel>Zbv</InfoLabel>\n              <InfoValue>\n                {formatCurrency(\n                  (smlouva.hodnota_s_dph || smlouva.celkova_castka || 0) - \n                  (smlouva.cerpano_celkem || smlouva.cerpano || 0)\n                )}\n              </InfoValue>\n            </InfoItem>\n          </InfoGrid>\n        </Section>\n      )}\n\n      {/* Poznmka */}\n      {smlouva.poznamka && (\n        <Section>\n          <SectionTitle>Poznmka</SectionTitle>\n          <FullWidthInfo>\n            <InfoValue style={{ whiteSpace: 'pre-wrap', fontSize: '0.875rem' }}>\n              {smlouva.poznamka}\n            </InfoValue>\n          </FullWidthInfo>\n        </Section>\n      )}\n    </PreviewContainer>\n  );\n};\n\nexport default SmlouvaPreview;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport styled from '@emotion/styled';\nimport { AlertCircle, X } from 'lucide-react';\n\nconst Overlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 100010;\n  animation: fadeIn 0.2s ease;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n`;\n\nconst Dialog = styled.div`\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);\n  max-width: 500px;\n  width: 90%;\n  max-height: 80vh;\n  overflow: hidden;\n  animation: slideIn 0.3s ease;\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(-20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n`;\n\nconst Header = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 20px 24px;\n  border-bottom: 1px solid #e5e7eb;\n  background: linear-gradient(135deg, #dc2626, #991b1b);\n  color: white;\n`;\n\nconst IconWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 40px;\n  height: 40px;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 50%;\n  flex-shrink: 0;\n`;\n\nconst Title = styled.h2`\n  font-size: 1.25rem;\n  font-weight: 600;\n  margin: 0;\n  flex: 1;\n`;\n\nconst CloseButton = styled.button`\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  flex-shrink: 0;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.3);\n  }\n`;\n\nconst Content = styled.div`\n  padding: 24px;\n  max-height: 60vh;\n  overflow-y: auto;\n`;\n\nconst Message = styled.div`\n  font-size: 0.95rem;\n  line-height: 1.6;\n  color: #374151;\n  white-space: pre-wrap;\n  word-break: break-word;\n`;\n\nconst ErrorDetails = styled.details`\n  margin-top: 16px;\n  padding: 12px;\n  background: #f9fafb;\n  border-radius: 6px;\n  font-size: 0.85rem;\n  color: #6b7280;\n  cursor: pointer;\n\n  summary {\n    font-weight: 600;\n    user-select: none;\n    outline: none;\n  }\n\n  pre {\n    margin-top: 8px;\n    padding: 8px;\n    background: #1f2937;\n    color: #f3f4f6;\n    border-radius: 4px;\n    overflow-x: auto;\n    font-size: 0.75rem;\n    line-height: 1.4;\n  }\n`;\n\nconst Footer = styled.div`\n  padding: 16px 24px;\n  border-top: 1px solid #e5e7eb;\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n`;\n\nconst Button = styled.button`\n  padding: 10px 20px;\n  border-radius: 6px;\n  font-weight: 600;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n  \n  ${props => props.primary ? `\n    background: #dc2626;\n    color: white;\n    \n    &:hover {\n      background: #b91c1c;\n    }\n  ` : `\n    background: #f3f4f6;\n    color: #374151;\n    \n    &:hover {\n      background: #e5e7eb;\n    }\n  `}\n`;\n\nconst ErrorDialog = ({ \n  isOpen, \n  title = 'Chyba', \n  message, \n  details = null,\n  onClose,\n  onConfirm = null,\n  confirmText = 'OK',\n  cancelText = 'Zruit'\n}) => {\n  if (!isOpen) return null;\n\n  const handleOverlayClick = (e) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  return ReactDOM.createPortal(\n    <Overlay onClick={handleOverlayClick}>\n      <Dialog>\n        <Header>\n          <IconWrapper>\n            <AlertCircle size={24} />\n          </IconWrapper>\n          <Title>{title}</Title>\n          <CloseButton onClick={onClose}>\n            <X size={18} />\n          </CloseButton>\n        </Header>\n        \n        <Content>\n          <Message>{message}</Message>\n          \n          {details && (\n            <ErrorDetails>\n              <summary>Technick detaily</summary>\n              <pre>{details}</pre>\n            </ErrorDetails>\n          )}\n        </Content>\n        \n        <Footer>\n          {onConfirm ? (\n            <>\n              <Button onClick={onClose}>{cancelText}</Button>\n              <Button primary onClick={onConfirm}>{confirmText}</Button>\n            </>\n          ) : (\n            <Button primary onClick={onClose}>{confirmText}</Button>\n          )}\n        </Footer>\n      </Dialog>\n    </Overlay>,\n    document.body\n  );\n};\n\nexport default ErrorDialog;\n","/**\n *  SPISOVKA ZPRACOVN API Service\n *\n * Frontend API klient pro Spisovka Processing Tracking System.\n * Sleduje zpracovan dokumenty ze Spisovka InBox - umouje etnm\n * oznait dokumenty jako zpracovan a zobrazit statistiky.\n *\n * Backend endpointy: /api.eeo/spisovka-zpracovani/*\n * Verze: v1.0.0\n * Datum: 19. prosince 2025\n *\n *  Podle OrderV2 konvenc:\n * - POST metody s username/token v body\n * - Standardizovan error handling\n * - Response format: {status, data, meta}\n */\n\nimport axios from 'axios';\n\n// Axios instance pro Spisovka Zpracovn API\nconst apiSpisovkaZpracovani = axios.create({\n  baseURL: process.env.REACT_APP_API2_BASE_URL,\n  headers: { 'Content-Type': 'application/json' }\n});\n\n// Response interceptor pro error handling\napiSpisovkaZpracovani.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    // Authentication errors\n    if (error.response?.status === 401 || error.response?.status === 403) {\n      if (typeof window !== 'undefined') {\n        const event = new CustomEvent('authError', {\n          detail: { message: 'Vae pihlen vyprelo. Pihlaste se prosm znovu.' }\n        });\n        window.dispatchEvent(event);\n      }\n    }\n\n    // HTML response instead of JSON (login page)\n    const responseText = error.response?.data || '';\n    if (typeof responseText === 'string' && responseText.includes('<!doctype')) {\n      if (typeof window !== 'undefined') {\n        const event = new CustomEvent('authError', {\n          detail: { message: 'Vae pihlen vyprelo. Obnovte strnku a pihlaste se znovu.' }\n        });\n        window.dispatchEvent(event);\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\n/**\n *  Helper: Normalize error messages\n */\nexport function normalizeError(err) {\n  if (err.response?.data?.message) return err.response.data.message;\n  if (err.response?.data?.error) return err.response.data.error;\n  if (err.response?.data?.err) return err.response.data.err;\n  if (err.message) return err.message;\n  return 'Neznm chyba';\n}\n\n/**\n *  GET Seznam zpracovanch dokument\n * \n * @param {Object} params - Parametry dotazu\n * @param {string} params.username - Username (required)\n * @param {string} params.token - Auth token (required)\n * @param {number} [params.uzivatel_id] - Filtr podle uivatele\n * @param {string} [params.stav] - Filtr podle stavu (ZAEVIDOVANO|NENI_FAKTURA|CHYBA|DUPLIKAT)\n * @param {string} [params.datum_od] - Filtr od data (YYYY-MM-DD)\n * @param {string} [params.datum_do] - Filtr do data (YYYY-MM-DD)\n * @param {number} [params.limit=100] - Poet zznam\n * @param {number} [params.offset=0] - Offset pro strnkovn\n * @returns {Promise<Object>} Response {status, data[], meta}\n */\nexport async function getSpisovkaZpracovaniList({\n  username,\n  token,\n  uzivatel_id = null,\n  stav = null,\n  datum_od = null,\n  datum_do = null,\n  limit = 100,\n  offset = 0\n}) {\n  try {\n    const response = await apiSpisovkaZpracovani.post('/spisovka-zpracovani/list', {\n      username,\n      token,\n      uzivatel_id,\n      stav,\n      datum_od,\n      datum_do,\n      limit,\n      offset\n    });\n    \n    return response.data;\n  } catch (err) {\n    throw new Error(normalizeError(err));\n  }\n}\n\n/**\n *  GET Statistiky zpracovn dokument\n * \n * @param {Object} params - Parametry dotazu\n * @param {string} params.username - Username (required)\n * @param {string} params.token - Auth token (required)\n * @param {number} [params.uzivatel_id] - Stats pro konkrtnho uivatele\n * @param {string} [params.datum_od] - Filtr od data (YYYY-MM-DD)\n * @param {string} [params.datum_do] - Filtr do data (YYYY-MM-DD)\n * @returns {Promise<Object>} Response {status, data: {celkem, podle_stavu, prumerna_doba_zpracovani_s, ...}, meta}\n */\nexport async function getSpisovkaZpracovaniStats({\n  username,\n  token,\n  uzivatel_id = null,\n  datum_od = null,\n  datum_do = null\n}) {\n  try {\n    const response = await apiSpisovkaZpracovani.post('/spisovka-zpracovani/stats', {\n      username,\n      token,\n      uzivatel_id,\n      datum_od,\n      datum_do\n    });\n    \n    return response.data;\n  } catch (err) {\n    throw new Error(normalizeError(err));\n  }\n}\n\n/**\n *  POST Oznait dokument jako zpracovan\n * \n * Automaticky volno po spnm zaveden faktury ze Spisovka dokumentu.\n * \n * @param {Object} params - Parametry\n * @param {string} params.username - Username (required)\n * @param {string} params.token - Auth token (required)\n * @param {number} params.dokument_id - ID dokumentu ze Spisovky (required)\n * @param {number} [params.faktura_id] - ID vytvoen faktury\n * @param {string} [params.fa_cislo_vema] - slo faktury\n * @param {string} [params.stav='ZAEVIDOVANO'] - Stav (ZAEVIDOVANO|NENI_FAKTURA|CHYBA|DUPLIKAT)\n * @param {string} [params.poznamka] - Poznmka k zpracovn\n * @param {number} [params.doba_zpracovani_s] - Doba zpracovn v sekundch\n * @returns {Promise<Object>} Response {status, message, data: {id, dokument_id, uzivatel_id, stav}, meta}\n */\nexport async function markSpisovkaDocumentProcessed({\n  username,\n  token,\n  dokument_id,\n  spisovka_priloha_id = null,\n  faktura_id = null,\n  fa_cislo_vema = null,\n  stav = 'ZAEVIDOVANO',\n  poznamka = null,\n  doba_zpracovani_s = null,\n  force = false //  Vynucen duplicity\n}) {\n  try {\n    const response = await apiSpisovkaZpracovani.post('/spisovka-zpracovani/mark', {\n      username,\n      token,\n      dokument_id,\n      spisovka_priloha_id,\n      faktura_id,\n      fa_cislo_vema,\n      stav,\n      poznamka,\n      doba_zpracovani_s,\n      force //  Poslat flag do BE\n    });\n    \n    return { success: true, data: response.data };\n  } catch (err) {\n    //  409 Conflict = dokument ji byl zpracovn (vrtit jako validn response)\n    if (err.response?.status === 409) {\n      return {\n        success: false,\n        conflict: true,\n        message: err.response?.data?.message || 'Dokument ji byl zpracovn',\n        existingRecord: err.response?.data?.existing || null\n      };\n    }\n    // Ostatn chyby vyhodit\n    throw new Error(normalizeError(err));\n  }\n}\n\n/**\n *  POST Hromadn oznaen dokument jako zpracovanch\n * \n * Umouje oznait vce dokument najednou (nap. pi bulk import).\n * \n * @param {Object} params - Parametry\n * @param {string} params.username - Username (required)\n * @param {string} params.token - Auth token (required)\n * @param {Array<Object>} params.documents - Pole dokument k oznaen\n * @param {number} params.documents[].dokument_id - ID dokumentu\n * @param {number} [params.documents[].faktura_id] - ID faktury\n * @param {string} [params.documents[].fa_cislo_vema] - slo faktury\n * @param {string} [params.documents[].stav] - Stav\n * @returns {Promise<Object>} Response s potem spnch/nespnch\n */\nexport async function markMultipleSpisovkaDocuments({\n  username,\n  token,\n  documents\n}) {\n  try {\n    // Backend zatm nem bulk endpoint, volme jednotliv\n    const results = await Promise.allSettled(\n      documents.map(doc => \n        markSpisovkaDocumentProcessed({\n          username,\n          token,\n          ...doc\n        })\n      )\n    );\n    \n    const successful = results.filter(r => r.status === 'fulfilled').length;\n    const failed = results.filter(r => r.status === 'rejected').length;\n    \n    return {\n      status: 'ok',\n      data: {\n        total: documents.length,\n        successful,\n        failed,\n        results\n      }\n    };\n  } catch (err) {\n    throw new Error(normalizeError(err));\n  }\n}\n\n/**\n *  Helper: Zkontrolovat zda dokument u byl zpracovn\n * \n * @param {number} dokument_id - ID dokumentu\n * @param {string} username - Username\n * @param {string} token - Auth token\n * @returns {Promise<boolean>} True pokud u byl zpracovn\n */\nexport async function isDocumentProcessed(dokument_id, username, token) {\n  try {\n    const response = await getSpisovkaZpracovaniList({\n      username,\n      token,\n      limit: 1,\n      offset: 0\n    });\n    \n    if (response.status === 'ok' && response.data) {\n      return response.data.some(item => item.dokument_id === dokument_id);\n    }\n    \n    return false;\n  } catch (err) {\n    console.warn('Chyba pi kontrole zpracovanho dokumentu:', err);\n    return false;\n  }\n}\n\n/**\n *  DELETE Zruit zpracovn dokumentu\n * \n * Smae zznam o zpracovn dokumentu ze Spisovky.\n * Faktura zstane zachovna, pouze se zru vazba.\n * \n * @param {Object} params - Parametry\n * @param {string} params.username - Username (required)\n * @param {string} params.token - Auth token (required)\n * @param {number} params.dokument_id - ID dokumentu ze Spisovky (required)\n * @returns {Promise<Object>} Response {status, message}\n */\nexport async function deleteSpisovkaZpracovani({\n  username,\n  token,\n  dokument_id\n}) {\n  try {\n    if (!dokument_id) {\n      throw new Error('dokument_id je povinn parametr');\n    }\n\n    const response = await apiSpisovkaZpracovani.post('/spisovka-zpracovani/delete', {\n      username,\n      token,\n      dokument_id\n    });\n    \n    return response.data;\n  } catch (err) {\n    throw new Error(normalizeError(err));\n  }\n}\n\nexport default {\n  getSpisovkaZpracovaniList,\n  getSpisovkaZpracovaniStats,\n  markSpisovkaDocumentProcessed,\n  markMultipleSpisovkaDocuments,\n  isDocumentProcessed,\n  deleteSpisovkaZpracovani,\n  normalizeError\n};\n","import React, { useState, useEffect, useCallback } from 'react';\nimport ReactDOM from 'react-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { \n  faBookOpen, \n  faTimes, \n  faFileAlt, \n  faDownload, \n  faSpinner, \n  faExclamationTriangle,\n  faSync,\n  faMinus,\n  faSquare,\n  faWindowRestore,\n  faExpand\n} from '@fortawesome/free-solid-svg-icons';\nimport { Sparkles } from 'lucide-react';\nimport { PanelBase, PanelHeader, TinyBtn, edgeHandles } from './PanelPrimitives';\nimport styled from '@emotion/styled';\nimport { extractTextFromPDF, extractInvoiceData } from '../../utils/invoiceOCR';\nimport ErrorDialog from '../ErrorDialog';\nimport { getSpisovkaZpracovaniList, deleteSpisovkaZpracovani } from '../../services/apiSpisovkaZpracovani';\n\n// ============================================================\n// STYLED COMPONENTS + ANIMATIONS\n// ============================================================\n\n// CSS animace pro pulsujc teku\nconst globalStyles = `\n  @keyframes pulse {\n    0%, 100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n    50% {\n      opacity: 0.5;\n      transform: scale(1.2);\n    }\n  }\n`;\n\n// Pidat globln styly\nif (typeof document !== 'undefined' && !document.getElementById('spisovka-pulse-animation')) {\n  const styleTag = document.createElement('style');\n  styleTag.id = 'spisovka-pulse-animation';\n  styleTag.textContent = globalStyles;\n  document.head.appendChild(styleTag);\n}\n\nconst InboxContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  flex: 1;\n  min-height: 0;\n  /* dn min-width - panel si uruje ku sm */\n`;\n\nconst InboxHeader = styled.div`\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  padding: 0.875rem 1rem;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.25);\n  margin-bottom: 0.75rem;\n`;\n\nconst InboxTitle = styled.div`\n  font-size: 0.95rem;\n  font-weight: 700;\n  color: white;\n  letter-spacing: 0.3px;\n  display: flex;\n  alignItems: 'center';\n  gap: 0.625rem;\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n`;\n\nconst InboxStats = styled.div`\n  font-size: 0.8rem;\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: 600;\n  background: rgba(255, 255, 255, 0.15);\n  padding: 0.25rem 0.625rem;\n  border-radius: 12px;\n`;\n\nconst InboxContent = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  padding: 0.5rem;\n  background: #f9fafb;\n  border-radius: 8px;\n  min-height: 0;\n  border: 1px solid #e5e7eb;\n\n  scrollbar-width: thin;\n  scrollbar-color: #10b981 #f3f4f6;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f3f4f6;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: linear-gradient(135deg, #10b981, #059669);\n    border-radius: 5px;\n    border: 2px solid #f9fafb;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: linear-gradient(135deg, #059669, #047857);\n  }\n`;\n\n//  Status Badge pro zpracovan dokumenty\nconst StatusBadge = styled.div`\n  display: inline-flex;\n  align-items: center;\n  gap: 0.4rem;\n  padding: 0.25rem 0.625rem;\n  border-radius: 12px;\n  font-size: 0.65rem;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  \n  ${props => {\n    switch (props.$status) {\n      case 'ZAEVIDOVANO':\n        return `\n          background: #d1fae5;\n          color: #065f46;\n          border: 1px solid #10b981;\n        `;\n      case 'NENI_FAKTURA':\n        return `\n          background: #fef3c7;\n          color: #92400e;\n          border: 1px solid #f59e0b;\n        `;\n      case 'CHYBA':\n        return `\n          background: #fee2e2;\n          color: #991b1b;\n          border: 1px solid #ef4444;\n        `;\n      case 'DUPLIKAT':\n        return `\n          background: #e0e7ff;\n          color: #3730a3;\n          border: 1px solid #6366f1;\n        `;\n      default:\n        return `\n          background: #f3f4f6;\n          color: #6b7280;\n          border: 1px solid #d1d5db;\n        `;\n    }\n  }}\n`;\n\nconst FakturaCard = styled.div`\n  background: white;\n  border: 2px solid #e5e7eb;\n  border-radius: 10px;\n  padding: 1rem;\n  transition: all 0.2s ease;\n  cursor: pointer;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n\n  &:hover {\n    background: #f0fdf4;\n    border-color: #10b981;\n    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);\n    transform: translateY(-2px);\n  }\n`;\n\nconst FakturaHeader = styled.div`\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n`;\n\nconst FakturaNazev = styled.div`\n  font-size: 0.875rem;\n  font-weight: 700;\n  color: #1f2937;\n  line-height: 1.3;\n  flex: 1;\n`;\n\nconst FakturaID = styled.div`\n  font-size: 0.7rem;\n  color: #059669;\n  font-family: 'Courier New', monospace;\n  background: #d1fae5;\n  padding: 0.3rem 0.6rem;\n  border-radius: 5px;\n  white-space: nowrap;\n  font-weight: 600;\n`;\n\nconst FakturaInfo = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.4rem;\n  font-size: 0.75rem;\n  color: #4b5563;\n`;\n\nconst InfoRow = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n`;\n\nconst InfoLabel = styled.span`\n  color: #6b7280;\n  font-weight: 700;\n`;\n\nconst InfoValue = styled.span`\n  color: #374151;\n  font-weight: 500;\n`;\n\nconst PrilohaSection = styled.div`\n  margin-top: 0.75rem;\n  padding-top: 0.75rem;\n  border-top: 2px solid #e5e7eb;\n`;\n\nconst PrilohaTitle = styled.div`\n  font-size: 0.75rem;\n  color: #6b7280;\n  font-weight: 700;\n  margin-bottom: 0.5rem;\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n`;\n\nconst PrilohaItem = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0.65rem;\n  background: #f9fafb;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  margin-bottom: 0.4rem;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f0fdf4;\n    border-color: #10b981;\n  }\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst PrilohaInfo = styled.div`\n  flex: 1;\n  min-width: 0;\n`;\n\nconst PrilohaFilename = styled.div`\n  font-size: 0.75rem;\n  color: #1f2937;\n  font-weight: 600;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst PrilohaMeta = styled.div`\n  font-size: 0.65rem;\n  color: #6b7280;\n  margin-top: 0.2rem;\n`;\n\nconst PrilohaButton = styled.a`\n  display: inline-flex;\n  align-items: center;\n  gap: 0.4rem;\n  padding: 0.5rem 0.75rem;\n  background: #10b981;\n  color: white;\n  border-radius: 6px;\n  text-decoration: none;\n  font-size: 0.7rem;\n  font-weight: 600;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n\n  &:hover {\n    background: #059669;\n    transform: translateY(-1px);\n    box-shadow: 0 4px 8px rgba(16, 185, 129, 0.25);\n  }\n\n  svg {\n    font-size: 0.75rem;\n  }\n`;\n\nconst LoadingBox = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2.5rem;\n  color: #6b7280;\n  font-size: 0.875rem;\n  gap: 0.75rem;\n`;\n\nconst ErrorBox = styled.div`\n  background: #fef2f2;\n  border: 2px solid #fca5a5;\n  border-radius: 8px;\n  padding: 1rem;\n  color: #dc2626;\n  font-size: 0.8rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst EmptyBox = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem 1.5rem;\n  color: #9ca3af;\n  font-size: 0.875rem;\n  text-align: center;\n  gap: 0.75rem;\n  opacity: 0.8;\n`;\n\nconst RefreshButton = styled.button`\n  background: white;\n  border: 2px solid #e5e7eb;\n  color: #6b7280;\n  padding: 0.5rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.75rem;\n  font-weight: 600;\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.2s ease;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n\n  &:hover {\n    background: #f0fdf4;\n    border-color: #10b981;\n    color: #10b981;\n    box-shadow: 0 2px 6px rgba(16, 185, 129, 0.15);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n`;\n\nconst FileModal = styled.div`\n  position: fixed;\n  top: ${props => props.y || 50}px;\n  left: ${props => props.x || (window.innerWidth / 2)}px;\n  width: ${props => props.w || (window.innerWidth / 2 - 40)}px;\n  height: ${props => props.h || (window.innerHeight - 100)}px;\n  background: white;\n  border-radius: 12px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);\n  z-index: 100002;\n  resize: both;\n  min-width: 400px;\n  min-height: 300px;\n`;\n\nconst FileModalContent = styled.div`\n  width: 100%;\n  height: 100%;\n  background: white;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst FileModalHeader = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1rem 1.5rem;\n  background: linear-gradient(135deg, #10b981, #059669);\n  color: white;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n`;\n\nconst FileModalTitle = styled.div`\n  font-size: 1rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst FileCloseButton = styled.button`\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  color: white;\n  width: 32px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.3);\n  }\n`;\n\nconst FileIframe = styled.iframe`\n  flex: 1;\n  border: none;\n  width: 100%;\n  height: 100%;\n`;\n\nconst FileObject = styled.object`\n  flex: 1;\n  border: none;\n  width: 100%;\n  height: 100%;\n`;\n\nconst PdfFallback = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n  padding: 2rem;\n  background: #f8fafc;\n  color: #334155;\n`;\n\nconst DownloadButton = styled.a`\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1.5rem;\n  background: #10b981;\n  color: white;\n  border-radius: 8px;\n  text-decoration: none;\n  font-weight: 600;\n  transition: all 0.2s ease;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n\n  &:hover {\n    background: #059669;\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(16, 185, 129, 0.3);\n  }\n`;\n\nconst TxtViewer = styled.pre`\n  flex: 1;\n  overflow: auto;\n  padding: 2rem;\n  margin: 0;\n  font-family: 'Courier New', monospace;\n  font-size: 0.875rem;\n  line-height: 1.6;\n  background: #f9fafb;\n  color: #1f2937;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  border: 1px solid #e5e7eb;\n\n  scrollbar-width: thin;\n  scrollbar-color: #10b981 #f9fafb;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f9fafb;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: linear-gradient(180deg, #10b981, #059669);\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: linear-gradient(180deg, #059669, #047857);\n  }\n`;\n\n// ============================================================\n// MAIN COMPONENT\n// ============================================================\n\nconst SpisovkaInboxPanel = ({ panelState, setPanelState, beginDrag, onClose, onOCRDataExtracted, token, username, showToast }) => {\n  const [faktury, setFaktury] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [pagination, setPagination] = useState({ total: 0, limit: 1000, offset: 0 }); // Zven limit pro datum filtry\n  const [zpracovaneIds, setZpracovaneIds] = useState(new Set()); //  Set zpracovanch dokument_id\n  const [zpracovaneDetails, setZpracovaneDetails] = useState(new Map()); //  Map dokument_id  {uzivatel_jmeno, zpracovano_kdy, fa_cislo_vema}\n  const [filterMode, setFilterMode] = useState('nezaevidovane'); // 'vse' | 'nezaevidovane' | 'zaevidovane' - VCHOZ: Nezaevidovan\n  const [yearFilter, setYearFilter] = useState(new Date().getFullYear()); // Rok (2025, 2024...)\n  const [dateRange, setDateRange] = useState('dnes'); // 'dnes' | 'tyden' | 'mesic' | 'kvartal' | 'rok' - VCHOZ: Dnes\n  const [activeDokumentId, setActiveDokumentId] = useState(null); //  ID dokumentu, se kterm uivatel prv pracuje\n  const [expandedAttachments, setExpandedAttachments] = useState(new Set()); //  Set expandovanch faktur (dokument_id)\n  const [fileViewer, setFileViewer] = useState({ visible: false, url: '', filename: '', type: '', content: '' });\n  const [ocrProgress, setOcrProgress] = useState({ visible: false, progress: 0, message: '' });\n  const [fileViewerPosition, setFileViewerPosition] = useState(() => {\n    // PDF viewer napravo - polovin ka okna (jako z Spisovky)\n    return {\n      x: window.innerWidth / 2, // Prav polovina obrazovky\n      y: 50, // Trochu od vrchu\n      w: window.innerWidth / 2 - 40, // Polovin ka minus offset\n      h: window.innerHeight - 100 // Vka do konce obrazovky\n    };\n  });\n  const [isDraggingViewer, setIsDraggingViewer] = useState(false);\n  const [errorDialog, setErrorDialog] = useState({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n\n  const fetchTxtContent = async (url) => {\n    try {\n      // Pout proxy endpoint pro naten TXT (een CORS)\n      const proxyUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/proxy-txt?url=${encodeURIComponent(url)}`;\n      const response = await fetch(proxyUrl);\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      const text = await response.text();\n      return text;\n    } catch (error) {\n      console.error('Chyba pi natn TXT souboru:', error);\n      return `Chyba pi natn souboru:\\n${error.message}\\n\\nURL: ${url}`;\n    }\n  };\n\n  const handleFileViewerDrag = useCallback((e) => {\n    if (!isDraggingViewer) return;\n    e.preventDefault();\n    setFileViewerPosition(prev => ({\n      ...prev,\n      x: e.clientX - 200,\n      y: e.clientY - 20\n    }));\n  }, [isDraggingViewer]);\n\n  const handleFileViewerDragEnd = useCallback(() => {\n    setIsDraggingViewer(false);\n  }, []);\n\n  useEffect(() => {\n    if (isDraggingViewer) {\n      window.addEventListener('mousemove', handleFileViewerDrag);\n      window.addEventListener('mouseup', handleFileViewerDragEnd);\n      return () => {\n        window.removeEventListener('mousemove', handleFileViewerDrag);\n        window.removeEventListener('mouseup', handleFileViewerDragEnd);\n      };\n    }\n  }, [isDraggingViewer, handleFileViewerDrag, handleFileViewerDragEnd]);\n\n  const handleOCRExtraction = async (priloha, dokumentId) => {\n    try {\n      //  RESET pol ped OCR\n      if (onOCRDataExtracted) {\n        onOCRDataExtracted({\n          datumVystaveni: '',\n          datumSplatnosti: '',\n          variabilniSymbol: '',\n          castka: ''\n        });\n      }\n      \n      setOcrProgress({ visible: true, progress: 0, message: 'Stahuji PDF ze Spisovky...' });\n\n      // Pout proxy-file endpoint pro staen PDF (een CORS)\n      const proxyUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/proxy-file?url=${encodeURIComponent(priloha.download_url)}`;\n      \n      console.log(` Fetching PDF via proxy: ${proxyUrl}`);\n      console.log(` Original URL: ${priloha.download_url}`);\n      const response = await fetch(proxyUrl);\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      \n      const contentType = response.headers.get('content-type');\n      const contentLength = response.headers.get('content-length');\n      console.log(` Response received, Content-Type: ${contentType}, Length: ${contentLength}`);\n      \n      // Validace response\n      if (!contentType || !contentType.includes('pdf')) {\n        throw new Error(`Neplatn formt souboru: ${contentType || 'unknown'}. Oekvno PDF.`);\n      }\n      \n      setOcrProgress({ visible: true, progress: 3, message: 'Stahuji PDF data...' });\n      \n      // DLEIT: Pokme na kompletn staen jako ArrayBuffer\n      const arrayBuffer = await response.arrayBuffer();\n      console.log(` PDF completely downloaded: ${arrayBuffer.byteLength} bytes`);\n      \n      // Validace staench dat\n      if (arrayBuffer.byteLength === 0) {\n        throw new Error('Staen soubor je przdn. Zkuste to prosm znovu.');\n      }\n      \n      if (arrayBuffer.byteLength < 100) {\n        throw new Error(`Staen soubor je pli mal (${arrayBuffer.byteLength} bytes). Stahovn mon selhalo.`);\n      }\n      \n      // Validace PDF magickch byt (%PDF)\n      const header = new Uint8Array(arrayBuffer.slice(0, 5));\n      const headerStr = String.fromCharCode(...header);\n      if (!headerStr.startsWith('%PDF')) {\n        console.error('Invalid PDF header:', headerStr);\n        throw new Error('Staen soubor nen platn PDF (chyb PDF header).');\n      }\n      \n      console.log(` PDF validated: header=\"${headerStr}\", size=${arrayBuffer.byteLength} bytes`);\n      \n      setOcrProgress({ visible: true, progress: 5, message: 'PDF staeno, pipravuji OCR...' });\n\n      // OCR extrakce (pedvme pmo ArrayBuffer)\n      const text = await extractTextFromPDF(arrayBuffer, (progress, message) => {\n        setOcrProgress({ visible: true, progress, message });\n      });\n\n      // Vyten dat\n      const data = extractInvoiceData(text);\n      \n      setOcrProgress({ visible: false, progress: 100, message: 'Hotovo!' });\n\n      // Zobrazit varovn, pokud dokument nen faktura\n      if (data.warning) {\n        await new Promise((resolve) => {\n          setErrorDialog({\n            isOpen: true,\n            title: ' Varovn',\n            message: data.warning,\n            details: null,\n            onConfirm: () => {\n              setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n              resolve(true);\n            },\n            onClose: () => {\n              setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n              resolve(false);\n            }\n          });\n        }).then((proceed) => {\n          if (!proceed) {\n            console.log(' OCR zrueno uivatelem - dokument nen faktura');\n            throw new Error('OCR_CANCELLED');\n          }\n        });\n      }\n\n      // Zavolat callback s daty + Spisovka metadata pro tracking\n      if (onOCRDataExtracted) {\n        onOCRDataExtracted({\n          ...data,\n          //  SPISOVKA METADATA pro automatick tracking\n          spisovka_dokument_id: dokumentId,\n          spisovka_priloha_id: priloha.priloha_id\n        });\n      }\n\n      console.log(' OCR Data + Spisovka metadata:', {\n        ...data,\n        spisovka_dokument_id: dokumentId,\n        spisovka_priloha_id: priloha.priloha_id\n      });\n      \n      //  AUTOMATICKY OTEVT PDF pro kontrolu vsledk OCR\n      console.log(' Opening PDF for verification...');\n      setFileViewer({\n        visible: true,\n        url: priloha.download_url,\n        filename: priloha.filename,\n        type: 'pdf',\n        content: ''\n      });\n    } catch (err) {\n      console.error(' OCR Error:', err);\n      setOcrProgress({ visible: false, progress: 0, message: '' });\n      \n      // Ignorovat cancel chybu\n      if (err.message === 'OCR_CANCELLED') {\n        return;\n      }\n      \n      // Zobrazit error dialog\n      setErrorDialog({\n        isOpen: true,\n        title: 'Chyba pi OCR extrakci',\n        message: err.message || 'Nepodailo se extrahovat data z dokumentu.',\n        details: err.stack || null,\n        onConfirm: () => {\n          setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n          // Otevt PDF viewer pro manuln prci (pout STEJNOU URL jako preview)\n          setFileViewer({\n            visible: true,\n            url: priloha.download_url,\n            filename: priloha.filename,\n            type: 'pdf',\n            content: ''\n          });\n        },\n        onClose: () => {\n          setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n        }\n      });\n    }\n  };\n\n  //  Helper: Vpoet datum rozsahu\n  const calculateDateRange = useCallback((range, year) => {\n    const now = new Date();\n    const currentYear = year || now.getFullYear();\n    let dateFrom, dateTo;\n\n    switch (range) {\n      case 'dnes':\n        dateFrom = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n        dateTo = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59);\n        break;\n      case 'tyden':\n        const weekAgo = new Date(now);\n        weekAgo.setDate(now.getDate() - 7);\n        dateFrom = weekAgo;\n        dateTo = now;\n        break;\n      case 'mesic':\n        const monthAgo = new Date(now);\n        monthAgo.setMonth(now.getMonth() - 1);\n        dateFrom = monthAgo;\n        dateTo = now;\n        break;\n      case 'kvartal':\n        const quarterAgo = new Date(now);\n        quarterAgo.setMonth(now.getMonth() - 3);\n        dateFrom = quarterAgo;\n        dateTo = now;\n        break;\n      case 'rok':\n        dateFrom = new Date(currentYear, 0, 1); // 1. ledna\n        dateTo = new Date(currentYear, 11, 31, 23, 59, 59); // 31. prosince\n        break;\n      default:\n        dateFrom = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n        dateTo = now;\n    }\n\n    return {\n      dateFrom: dateFrom.toISOString().split('T')[0], // YYYY-MM-DD\n      dateTo: dateTo.toISOString().split('T')[0]\n    };\n  }, []);\n\n  //  Nast zpracovan dokumenty pro oznaen\n  const fetchZpracovaneDokumenty = useCallback(async () => {\n    try {\n      // Token a username pichzej jako props z InvoiceEvidencePage\n      if (!token || !username) {\n        console.warn(' Token nebo username chyb - nelze nast zpracovan dokumenty');\n        return;\n      }\n\n      const response = await getSpisovkaZpracovaniList({\n        username,\n        token,\n        limit: 1000, // Nast vechny zpracovan dokumenty\n        offset: 0\n      });\n\n      if (response.status === 'ok' && response.data) {\n        // Vytvoit Set z dokument_id pro rychl vyhledvn\n        const processedIds = new Set(response.data.map(item => item.dokument_id));\n        setZpracovaneIds(processedIds);\n        \n        // Vytvoit Map s detaily pro kad dokument\n        const detailsMap = new Map();\n        response.data.forEach(item => {\n          detailsMap.set(item.dokument_id, {\n            uzivatel_jmeno: item.uzivatel_jmeno || 'Neznm',\n            zpracovano_kdy: item.zpracovano_kdy,\n            fa_cislo_vema: item.fa_cislo_vema,\n            faktura_id: item.faktura_id, //  Pro ppadn smazn faktury\n            stav: item.stav\n          });\n        });\n        setZpracovaneDetails(detailsMap);\n      }\n    } catch (err) {\n      console.warn(' Nepodailo se nast zpracovan dokumenty:', err);\n      // Neblokujeme - panel me fungovat i bez tohoto\n    }\n  }, [token, username]);\n\n  //  Zruit zpracovn Spisovka dokumentu\n  const handleCancelProcessing = useCallback(async (dokumentId, fakturaId, faCisloVema) => {\n    setErrorDialog({\n      isOpen: true,\n      title: ' Zruit zpracovn dokumentu',\n      message: (\n        <div style={{ fontFamily: 'system-ui', lineHeight: '1.6' }}>\n          <p style={{ marginBottom: '12px' }}>\n            Chcete zruit zpracovn tohoto dokumentu ze Spisovky?\n          </p>\n          {faCisloVema && (\n            <div style={{\n              padding: '12px',\n              backgroundColor: '#fef3c7',\n              borderRadius: '6px',\n              fontSize: '13px',\n              marginBottom: '12px'\n            }}>\n              <div><strong>Zaevidovan faktura:</strong> {faCisloVema}</div>\n              {fakturaId && <div style={{ fontSize: '12px', color: '#78716c', marginTop: '4px' }}>ID: {fakturaId}</div>}\n            </div>\n          )}\n          <p style={{ marginBottom: '8px', fontWeight: 600, color: '#dc2626' }}>\n             Pozor: Toto pouze odstran vazbu mezi dokumentem a fakturou.\n          </p>\n          <p style={{ fontSize: '13px', color: '#6b7280' }}>\n            Fakturu mete smazat run z formule editace faktury.\n          </p>\n        </div>\n      ),\n      onConfirm: async () => {\n        try {\n          // Smazat tracking\n          await deleteSpisovkaZpracovani({\n            username,\n            token,\n            dokument_id: dokumentId\n          });\n          \n          // Vyistit localStorage pokud je to aktivn dokument\n          if (activeDokumentId === dokumentId) {\n            localStorage.removeItem('spisovka_active_dokument');\n            setActiveDokumentId(null);\n          }\n          \n          // Refresh seznamu\n          await fetchZpracovaneDokumenty();\n          \n          showToast && showToast(' Evidence zruena', { type: 'success' });\n          setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n        } catch (err) {\n          showToast && showToast(` Chyba: ${err.message}`, { type: 'error' });\n          setErrorDialog({ isOpen: false, title: '', message: '', details: null, onConfirm: null });\n        }\n      }\n    });\n  }, [username, token, activeDokumentId, fetchZpracovaneDokumenty, showToast, setActiveDokumentId, setErrorDialog]);\n\n  const fetchFaktury = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Nast faktury pro zvolen rok (vdy cel rok, pak client-side filtrujeme podle dateRange)\n      const apiUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/faktury?limit=${pagination.limit}&offset=${pagination.offset}&rok=${yearFilter}`;\n      const response = await fetch(apiUrl);\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      const data = await response.json();\n\n      if (data.status === 'success') {\n        setFaktury(data.data);\n        setPagination(prev => ({ ...prev, total: data.pagination?.total || data.data.length }));\n        \n        //  Nast zpracovan dokumenty po naten faktur\n        fetchZpracovaneDokumenty();\n      } else {\n        throw new Error(data.message || 'Nepodailo se nast faktury');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Chyba pi natn faktur ze spisovky:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [pagination.limit, pagination.offset, yearFilter, fetchZpracovaneDokumenty, token, username]);\n\n  // Initial fetch + refetch pi zmn roku\n  useEffect(() => {\n    fetchFaktury();\n  }, [yearFilter]); //  Refetch pi zmn roku\n\n  // Background refresh every 5 minutes\n  useEffect(() => {\n    const interval = setInterval(() => {\n      console.log(' Spisovka auto-refresh (5 minut)');\n      fetchFaktury();\n    }, 5 * 60 * 1000); // 5 minutes\n\n    return () => clearInterval(interval);\n  }, [fetchFaktury]);\n\n  //  Polling pro aktivn dokument z localStorage\n  useEffect(() => {\n    const checkActiveDocument = () => {\n      const activeDokId = localStorage.getItem('spisovka_active_dokument');\n      const parsedDokId = activeDokId ? parseInt(activeDokId, 10) : null;\n      \n      // Pouze update stavu, scroll se provede v samostatnm effectu\n      setActiveDokumentId(parsedDokId);\n    };\n\n    // Initial check\n    checkActiveDocument();\n\n    // Poll kadch 500ms (rychl reakce na zmny)\n    const interval = setInterval(checkActiveDocument, 500);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  //  SCROLL NA AKTIVN DOKUMENT po naten seznamu\n  useEffect(() => {\n    if (activeDokumentId && faktury.length > 0) {\n      // Pokat na render a pak scrollovat\n      const timeoutId = setTimeout(() => {\n        const element = document.querySelector(`[data-section=\"dokument-${activeDokumentId}\"]`);\n        if (element) {\n          console.log(' Scrolling to active document:', activeDokumentId);\n          element.scrollIntoView({ \n            behavior: 'smooth', \n            block: 'center',\n            inline: 'nearest'\n          });\n        } else {\n          console.log(' Active document element not found:', activeDokumentId);\n        }\n      }, 300); // Delay pro zajitn renderovn\n      \n      return () => clearTimeout(timeoutId);\n    }\n  }, [activeDokumentId, faktury]);\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return '-';\n    const date = new Date(dateStr);\n    return date.toLocaleString('cs-CZ', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit'\n    });\n  };\n\n  const formatFileSize = (bytes) => {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n    return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  };\n\n  const handleSnapRight = () => {\n    //  Snap panel doprava - zjistit ku z pravho nhledovho panelu (45% okna)\n    // LAYOUT: fixed header (96px) + menubar (48px) = 144px top offset\n    // Footer: 54px\n    const headerHeight = 96; // Fixed header\n    const menubarHeight = 48; // Menubar\n    const footerHeight = 54; // Layout footer\n    const topOffset = headerHeight + menubarHeight; // 144px celkem\n    const minWidth = 620; // Minimln ka aby tlatka nevytekala\n    \n    // Najt prav nhledov panel podle textu \"Nhled\" v SectionTitle\n    let targetWidth = panelState.w; // Fallback na aktuln ku\n    \n    const previewHeaders = Array.from(document.querySelectorAll('div')).filter(el => \n      el.textContent.includes('Nhled') && el.style.width && el.parentElement\n    );\n    \n    if (previewHeaders.length > 0) {\n      // Najt parent container (prav sloupec)\n      let previewColumn = previewHeaders[0].parentElement;\n      while (previewColumn && !previewColumn.style.width?.includes('%')) {\n        previewColumn = previewColumn.parentElement;\n      }\n      if (previewColumn) {\n        const previewWidth = previewColumn.getBoundingClientRect().width;\n        targetWidth = Math.max(previewWidth, minWidth);\n      }\n    }\n    \n    if (targetWidth === panelState.w) {\n      // Fallback: pout 45% ky okna (jako PreviewColumn)\n      targetWidth = Math.max(Math.floor(window.innerWidth * 0.45), minWidth);\n    }\n    \n    setPanelState(prev => ({\n      ...prev,\n      x: window.innerWidth - targetWidth, // Zarovnat k pravmu okraji\n      y: topOffset, // Pod header + menubar\n      w: targetWidth,\n      h: window.innerHeight - topOffset - footerHeight, // Cel vka minus header, menubar, footer\n      minimized: false\n    }));\n  };\n\n  const handleMinimize = () => {\n    //  OPRAVENO: Minimize = zavt cel panel (ne jen obsah)\n    if (onClose) onClose();\n  };\n\n  const handleClose = () => {\n    if (onClose) onClose();\n  };\n\n  const currentStyle = {\n    left: `${panelState.x}px`,\n    top: `${panelState.y}px`,\n    width: `${panelState.w}px`,\n    height: `${panelState.h}px`,\n    minWidth: '320px',\n    minHeight: '200px',\n    maxHeight: '90vh'\n  };\n\n  return ReactDOM.createPortal(\n    <PanelBase style={currentStyle}>\n      {edgeHandles(beginDrag, 'spisovkaInbox')}\n      \n      <PanelHeader\n        onMouseDown={(e) => beginDrag(e, 'spisovkaInbox', 'move')}\n        style={{ cursor: 'move' }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>\n          <FontAwesomeIcon icon={faBookOpen} style={{ color: '#1f2937' }} />\n          Spisovka Inbox\n        </div>\n        <div style={{ display: 'flex', gap: '0.3rem' }}>\n          <TinyBtn \n            onClick={() => {\n              fetchFaktury();\n              fetchZpracovaneDokumenty();\n            }} \n            title=\"Obnovit data (Spisovka + Tracking)\"\n            style={{ opacity: loading ? 0.5 : 1 }}\n          >\n            <FontAwesomeIcon icon={faSync} spin={loading} />\n          </TinyBtn>\n          <TinyBtn onClick={handleSnapRight} title=\"Zarovnat doprava (cel vka)\">\n            <FontAwesomeIcon icon={faExpand} />\n          </TinyBtn>\n          <TinyBtn onClick={handleMinimize} title={panelState.minimized ? 'Obnovit' : 'Minimalizovat'}>\n            <FontAwesomeIcon icon={panelState.minimized ? faWindowRestore : faMinus} />\n          </TinyBtn>\n          <TinyBtn onClick={handleClose} title=\"Zavt\">\n            <FontAwesomeIcon icon={faTimes} />\n          </TinyBtn>\n        </div>\n      </PanelHeader>\n\n      {!panelState.minimized && (() => {\n        //  Spotat filtrovan faktury pro zobrazen v headeru\n        const { dateFrom, dateTo } = calculateDateRange(dateRange, yearFilter);\n        const dateFromTs = new Date(dateFrom).getTime();\n        const dateToTs = new Date(dateTo + ' 23:59:59').getTime();\n        \n        const filteredCount = faktury.filter(faktura => {\n          const fakturaDate = new Date(faktura.datum_vzniku);\n          const fakturaTs = fakturaDate.getTime();\n          if (fakturaTs < dateFromTs || fakturaTs > dateToTs) return false;\n          \n          const isZaevidovano = zpracovaneIds.has(faktura.dokument_id);\n          if (filterMode === 'nezaevidovane') return !isZaevidovano;\n          if (filterMode === 'zaevidovane') return isZaevidovano;\n          return true;\n        }).length;\n        \n        return (\n        <InboxContainer>\n          <InboxHeader>\n            <InboxTitle>\n              <FontAwesomeIcon icon={faBookOpen} />\n              Faktury\n            </InboxTitle>\n            <InboxStats>\n              {filteredCount} / {pagination.total} celkem\n            </InboxStats>\n          </InboxHeader>\n          \n          {/*  ROK + DATUM FILTRY */}\n          <div style={{\n            display: 'flex',\n            gap: '1rem',\n            padding: '0.75rem 1rem',\n            background: 'linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)',\n            borderBottom: '1px solid #bae6fd',\n            alignItems: 'center',\n            flexWrap: 'wrap'\n          }}>\n            {/* Rok selector */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n              <span style={{ fontSize: '0.85rem', color: '#0369a1', fontWeight: 600 }}>Rok:</span>\n              <select\n                value={yearFilter}\n                onChange={(e) => setYearFilter(parseInt(e.target.value))}\n                style={{\n                  padding: '0.4rem 0.75rem',\n                  borderRadius: '6px',\n                  border: '2px solid #0284c7',\n                  background: 'white',\n                  color: '#0c4a6e',\n                  fontSize: '0.85rem',\n                  fontWeight: 600,\n                  cursor: 'pointer'\n                }}\n              >\n                {(() => {\n                  const currentYear = new Date().getFullYear();\n                  const startYear = 2025; // Poten rok evidence\n                  const years = [];\n                  for (let y = currentYear; y >= startYear; y--) {\n                    years.push(y);\n                  }\n                  return years.map(year => (\n                    <option key={year} value={year}>{year}</option>\n                  ));\n                })()}\n              </select>\n            </div>\n\n            {/* Datum range filtry */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', flex: 1 }}>\n              <span style={{ fontSize: '0.85rem', color: '#0369a1', fontWeight: 600 }}>Obdob:</span>\n              {['dnes', 'tyden', 'mesic', 'kvartal', 'rok'].map(range => (\n                <button\n                  key={range}\n                  onClick={() => setDateRange(range)}\n                  style={{\n                    padding: '0.4rem 0.75rem',\n                    borderRadius: '6px',\n                    border: dateRange === range ? '2px solid #0284c7' : '1px solid #94a3b8',\n                    background: dateRange === range ? '#e0f2fe' : 'white',\n                    color: dateRange === range ? '#0c4a6e' : '#64748b',\n                    fontSize: '0.8rem',\n                    fontWeight: dateRange === range ? 600 : 500,\n                    cursor: 'pointer',\n                    transition: 'all 0.2s ease',\n                    whiteSpace: 'nowrap'\n                  }}\n                  onMouseEnter={(e) => {\n                    if (dateRange !== range) {\n                      e.currentTarget.style.borderColor = '#0284c7';\n                      e.currentTarget.style.color = '#0c4a6e';\n                    }\n                  }}\n                  onMouseLeave={(e) => {\n                    if (dateRange !== range) {\n                      e.currentTarget.style.borderColor = '#94a3b8';\n                      e.currentTarget.style.color = '#64748b';\n                    }\n                  }}\n                >\n                  {range === 'dnes' && 'Dnes'}\n                  {range === 'tyden' && 'Tden zpt'}\n                  {range === 'mesic' && 'Msc zpt'}\n                  {range === 'kvartal' && 'Kvartl zpt'}\n                  {range === 'rok' && 'Cel rok'}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/*  FILTROVAC TLATKA (Ve / Nezaevidovan / Zaevidovan) */}\n          <div style={{\n            display: 'flex',\n            gap: '0.5rem',\n            padding: '0.75rem 1rem',\n            background: '#f9fafb',\n            borderBottom: '1px solid #e5e7eb',\n            alignItems: 'center',\n            justifyContent: 'space-between'\n          }}>\n            <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n              <span style={{ fontSize: '0.85rem', color: '#6b7280', fontWeight: 600 }}>Zobrazit:</span>\n              {['vse', 'nezaevidovane', 'zaevidovane'].map(mode => (\n                <button\n                  key={mode}\n                  onClick={() => setFilterMode(mode)}\n                  style={{\n                    padding: '0.4rem 0.75rem',\n                    borderRadius: '6px',\n                    border: filterMode === mode ? '2px solid #10b981' : '1px solid #d1d5db',\n                    background: filterMode === mode ? '#ecfdf5' : 'white',\n                  color: filterMode === mode ? '#059669' : '#6b7280',\n                  fontSize: '0.8rem',\n                  fontWeight: filterMode === mode ? 600 : 500,\n                  cursor: 'pointer',\n                  transition: 'all 0.2s ease',\n                  whiteSpace: 'nowrap'\n                }}\n                onMouseEnter={(e) => {\n                  if (filterMode !== mode) {\n                    e.currentTarget.style.borderColor = '#10b981';\n                    e.currentTarget.style.color = '#059669';\n                  }\n                }}\n                onMouseLeave={(e) => {\n                  if (filterMode !== mode) {\n                    e.currentTarget.style.borderColor = '#d1d5db';\n                    e.currentTarget.style.color = '#6b7280';\n                  }\n                }}\n              >\n                {mode === 'vse' && 'Ve'}\n                {mode === 'nezaevidovane' && `Nezaevidovan (${faktury.filter(f => !zpracovaneIds.has(f.dokument_id)).length})`}\n                {mode === 'zaevidovane' && `Zaevidovan (${zpracovaneIds.size})`}\n              </button>\n            ))}\n            </div>\n            \n            {/*  IKONA SCROLL NA AKTIVN DOKUMENT */}\n            {activeDokumentId && (\n              <button\n                onClick={() => {\n                  const element = document.querySelector(`[data-section=\"dokument-${activeDokumentId}\"]`);\n                  if (element) {\n                    element.scrollIntoView({ \n                      behavior: 'smooth', \n                      block: 'center',\n                      inline: 'nearest'\n                    });\n                  }\n                }}\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  width: '32px',\n                  height: '32px',\n                  background: 'rgba(59, 130, 246, 0.15)',\n                  border: '1px solid rgba(59, 130, 246, 0.3)',\n                  borderRadius: '6px',\n                  color: '#1e40af',\n                  fontSize: '16px',\n                  cursor: 'pointer',\n                  transition: 'all 0.2s ease'\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.background = 'rgba(59, 130, 246, 0.25)';\n                  e.currentTarget.style.borderColor = 'rgba(59, 130, 246, 0.5)';\n                  e.currentTarget.style.transform = 'scale(1.1)';\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.background = 'rgba(59, 130, 246, 0.15)';\n                  e.currentTarget.style.borderColor = 'rgba(59, 130, 246, 0.3)';\n                  e.currentTarget.style.transform = 'scale(1)';\n                }}\n                title=\"Jdi na fakturu, se kterou prv pracuji\"\n              >\n                \n              </button>\n            )}\n          </div>\n\n          {loading && (\n            <LoadingBox>\n              <FontAwesomeIcon icon={faSpinner} spin />\n              Natm faktury...\n            </LoadingBox>\n          )}\n\n          {error && (\n            <ErrorBox>\n              <FontAwesomeIcon icon={faExclamationTriangle} />\n              Chyba: {error}\n              <RefreshButton onClick={fetchFaktury} disabled={loading}>\n                <FontAwesomeIcon icon={faSync} />\n                Zkusit znovu\n              </RefreshButton>\n            </ErrorBox>\n          )}\n\n          {!loading && !error && faktury.length === 0 && (\n            <EmptyBox>\n              <FontAwesomeIcon icon={faBookOpen} size=\"2x\" />\n              dn faktury k zobrazen\n            </EmptyBox>\n          )}\n\n          {!loading && !error && faktury.length > 0 && (() => {\n            //  Vpoet datum rozsahu\n            const { dateFrom, dateTo } = calculateDateRange(dateRange, yearFilter);\n            const dateFromTs = new Date(dateFrom).getTime();\n            const dateToTs = new Date(dateTo + ' 23:59:59').getTime();\n            \n            //  Filtrovn faktur podle reimu + datum rozsahu + nzev (pouze faktury)\n            const filteredFaktury = faktury.filter(faktura => {\n              // 0. Filter podle nzvu - pouze dokumenty obsahujc \"Faktura\", \"Fa .\", \"Fa.\", \"FA\" atd.\n              // Regex zachyt: faktura/faktra, fa../fa.c./fa ./fa c./fa./fac./fak../fak.c./fak ./fak c., FA na zatku\n              const nazev = (faktura.nazev || '').normalize('NFD').replace(/[\\u0300-\\u036f]/g, ''); // Normalizace diakritiky\n              const isFaktura = /faktur[au]|fa[\\s\\.]*(c|)[\\s\\.]?|fak[\\s\\.]*(c|)[\\s\\.]?|^fa\\s/i.test(nazev) || \n                                /faktur[au]|fa[\\s\\.]*(c|)[\\s\\.]?|fak[\\s\\.]*(c|)[\\s\\.]?|^fa\\s/i.test(faktura.nazev || '');\n              \n              if (!isFaktura) {\n                return false; // Nen faktura podle nzvu\n              }\n              \n              // 1. Filter podle dateRange\n              const fakturaDate = new Date(faktura.datum_vzniku);\n              const fakturaTs = fakturaDate.getTime();\n              if (fakturaTs < dateFromTs || fakturaTs > dateToTs) {\n                return false; // Mimo datum rozsah\n              }\n              \n              // 2. Filter podle reimu (Ve / Nezaevidovan / Zaevidovan)\n              const isZaevidovano = zpracovaneIds.has(faktura.dokument_id);\n              if (filterMode === 'nezaevidovane') return !isZaevidovano;\n              if (filterMode === 'zaevidovane') return isZaevidovano;\n              return true; // 'vse'\n            });\n            \n            if (filteredFaktury.length === 0) {\n              return (\n                <EmptyBox>\n                  <FontAwesomeIcon icon={faBookOpen} size=\"2x\" />\n                  {filterMode === 'nezaevidovane' && 'Vechny faktury jsou zaevidovan '}\n                  {filterMode === 'zaevidovane' && 'Zatm dn zaevidovan faktury'}\n                </EmptyBox>\n              );\n            }\n            \n            return (\n            <InboxContent>\n              {filteredFaktury.map((faktura) => {\n                const isActive = activeDokumentId === faktura.dokument_id;\n                const isOtherActive = activeDokumentId && !isActive;\n                \n                return (\n                <FakturaCard \n                  key={faktura.dokument_id}\n                  data-section={`dokument-${faktura.dokument_id}`}\n                  style={{\n                    opacity: isOtherActive ? 0.4 : 1,\n                    transition: 'opacity 0.3s ease',\n                    position: 'relative'\n                  }}\n                >\n                  {/*  Indiktor aktivnho dokumentu */}\n                  {isActive && (\n                    <div style={{\n                      position: 'absolute',\n                      top: 0,\n                      left: 0,\n                      right: 0,\n                      height: '4px',\n                      background: 'linear-gradient(90deg, #3b82f6, #60a5fa)',\n                      borderRadius: '6px 6px 0 0',\n                      zIndex: 1\n                    }} />\n                  )}\n                  {isActive && (\n                    <div style={{\n                      padding: '6px 12px',\n                      marginBottom: '12px',\n                      background: 'linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)',\n                      borderBottom: '1px solid #93c5fd',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '8px',\n                      fontSize: '13px',\n                      fontWeight: 600,\n                      color: '#1e40af'\n                    }}>\n                      <span style={{ fontSize: '16px' }}></span>\n                      <span>Prv pracuji s touto fakturou</span>\n                      <div style={{\n                        marginLeft: 'auto',\n                        width: '8px',\n                        height: '8px',\n                        borderRadius: '50%',\n                        background: '#3b82f6',\n                        animation: 'pulse 2s infinite'\n                      }} />\n                    </div>\n                  )}\n                  <FakturaHeader\n                    draggable={faktura.prilohy && faktura.prilohy.length > 0}\n                    onDragStart={(e) => {\n                      if (faktura.prilohy && faktura.prilohy.length > 0) {\n                        e.stopPropagation();\n                        e.currentTarget.style.cursor = 'grabbing';\n                        e.currentTarget.style.opacity = '0.6';\n                        // Pedat vechny plohy jako JSON + Spisovka metadata pro tracking\n                        const attachmentsData = faktura.prilohy.map(p => ({\n                          url: p.download_url,\n                          filename: p.filename,\n                          mime_type: p.mime_type || 'application/octet-stream',\n                          //  SPISOVKA METADATA pro automatick tracking\n                          spisovka_dokument_id: faktura.dokument_id,\n                          spisovka_file_id: p.file_id || p.priloha_id\n                        }));\n                        e.dataTransfer.setData('text/spisovka-attachments', JSON.stringify(attachmentsData));\n                        e.dataTransfer.effectAllowed = 'copy';\n                      }\n                    }}\n                    onDragEnd={(e) => {\n                      e.stopPropagation();\n                      e.currentTarget.style.cursor = (faktura.prilohy && faktura.prilohy.length > 0) ? 'grab' : 'default';\n                      e.currentTarget.style.opacity = '1';\n                    }}\n                    style={{ cursor: (faktura.prilohy && faktura.prilohy.length > 0) ? 'grab' : 'default' }}\n                    title={(faktura.prilohy && faktura.prilohy.length > 0) ? `Pethnte hlaviku pro nahrn vech ${faktura.prilohy.length} ploh` : ''}\n                  >\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem', flex: 1 }}>\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', justifyContent: 'space-between' }}>\n                        <FakturaNazev>{faktura.nazev}</FakturaNazev>\n                        <FakturaID>#{faktura.dokument_id}</FakturaID>\n                      </div>\n                      {zpracovaneIds.has(faktura.dokument_id) && (\n                        <div style={{ display: 'flex', justifyContent: 'flex-end' }}>\n                          <StatusBadge $status=\"ZAEVIDOVANO\">\n                             Zaevidovno\n                          </StatusBadge>\n                        </div>\n                      )}\n                    </div>\n                  </FakturaHeader>\n\n                  <FakturaInfo>\n                    <InfoRow>\n                      <InfoLabel>JID:</InfoLabel>\n                      <InfoValue>{faktura.jid}</InfoValue>\n                    </InfoRow>\n                    <InfoRow>\n                      <InfoLabel>slo jednac:</InfoLabel>\n                      <InfoValue>{faktura.cislo_jednaci}</InfoValue>\n                    </InfoRow>\n                    <InfoRow>\n                      <InfoLabel>Datum vzniku:</InfoLabel>\n                      <InfoValue>{formatDate(faktura.datum_vzniku)}</InfoValue>\n                    </InfoRow>\n                  </FakturaInfo>\n\n                  {/*  INFO O ZPRACOVN (pokud je zaevidovno) */}\n                  {zpracovaneIds.has(faktura.dokument_id) && zpracovaneDetails.has(faktura.dokument_id) && (() => {\n                    const detail = zpracovaneDetails.get(faktura.dokument_id);\n                    const zpracovanoDate = new Date(detail.zpracovano_kdy);\n                    const timeAgo = Math.floor((Date.now() - zpracovanoDate.getTime()) / 1000);\n                    let timeText = '';\n                    if (timeAgo < 60) timeText = 'ped chvl';\n                    else if (timeAgo < 3600) timeText = `ped ${Math.floor(timeAgo / 60)} min`;\n                    else if (timeAgo < 86400) timeText = `ped ${Math.floor(timeAgo / 3600)} h`;\n                    else timeText = `ped ${Math.floor(timeAgo / 86400)} dny`;\n                    \n                    return (\n                      <div style={{\n                        padding: '0.75rem 1rem',\n                        background: 'linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)',\n                        borderTop: '1px solid #a7f3d0',\n                        borderBottom: '1px solid #a7f3d0',\n                        marginBottom: '0.5rem'\n                      }}>\n                        <div style={{\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: '0.75rem',\n                          fontSize: '0.8rem',\n                          color: '#047857',\n                          fontWeight: 500\n                        }}>\n                          <span></span>\n                          <span>\n                            Zaevidovno <strong>{timeText}</strong>\n                            {detail.fa_cislo_vema && <> jako <strong>{detail.fa_cislo_vema}</strong></>}\n                          </span>\n                          <button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleCancelProcessing(faktura.dokument_id, detail.faktura_id, detail.fa_cislo_vema);\n                            }}\n                            style={{\n                              marginLeft: 'auto',\n                              padding: '4px 8px',\n                              fontSize: '0.75rem',\n                              backgroundColor: '#dc2626',\n                              color: 'white',\n                              border: 'none',\n                              borderRadius: '4px',\n                              cursor: 'pointer',\n                              display: 'flex',\n                              alignItems: 'center',\n                              gap: '4px',\n                              fontWeight: 600\n                            }}\n                            title=\"Zruit zpracovn tohoto dokumentu\"\n                          >\n                            <span></span>\n                            <span>Zruit</span>\n                          </button>\n                        </div>\n                        <div style={{\n                          fontSize: '0.75rem',\n                          color: '#059669',\n                          marginTop: '0.25rem',\n                          paddingLeft: '1.5rem'\n                        }}>\n                          Uivatel: <strong>{detail.uzivatel_jmeno}</strong>  {zpracovanoDate.toLocaleString('cs-CZ')}\n                        </div>\n                      </div>\n                    );\n                  })()}\n\n                  {faktura.prilohy && faktura.prilohy.length > 0 && (\n                    <PrilohaSection>\n                      <PrilohaTitle>\n                         Plohy ({faktura.prilohy.length})\n                      </PrilohaTitle>\n                      {(() => {\n                        const isExpanded = expandedAttachments.has(faktura.dokument_id);\n                        const attachmentsToShow = isExpanded ? faktura.prilohy : faktura.prilohy.slice(0, 3);\n                        return attachmentsToShow.map((priloha) => {\n                        const isPdf = priloha.mime_type === 'application/pdf';\n                        const isTxt = priloha.mime_type === 'text/plain' || priloha.filename.toLowerCase().endsWith('.txt');\n                        const canPreview = isPdf || isTxt;\n                        return (\n                          <PrilohaItem \n                            key={priloha.file_id}\n                            draggable={true}\n                            onDragStart={(e) => {\n                              e.stopPropagation();\n                              e.currentTarget.style.cursor = 'grabbing';\n                              e.currentTarget.style.opacity = '0.6';\n                              e.dataTransfer.setData('text/spisovka-file-url', priloha.download_url);\n                              e.dataTransfer.setData('text/spisovka-file-name', priloha.filename);\n                              e.dataTransfer.setData('text/spisovka-file-mime', priloha.mime_type || 'application/octet-stream');\n                              e.dataTransfer.setData('text/spisovka-file-id', priloha.file_id); //  ID plohy\n                              e.dataTransfer.setData('text/spisovka-dokument-id', faktura.dokument_id); //  ID dokumentu\n                              e.dataTransfer.effectAllowed = 'copy';\n                            }}\n                            style={{ cursor: 'grab' }}\n                            onDragEnd={(e) => {\n                              e.stopPropagation();\n                              e.currentTarget.style.cursor = 'grab';\n                              e.currentTarget.style.opacity = '1';\n                            }}\n                          >\n                            <PrilohaInfo>\n                              <PrilohaFilename>\n                                {isPdf && ' '}{isTxt && ' '}{priloha.filename}\n                              </PrilohaFilename>\n                              <PrilohaMeta>\n                                {formatFileSize(priloha.size)}\n                              </PrilohaMeta>\n                            </PrilohaInfo>\n                            <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\n                              {/* OCR Button VLEVO - pouze pro PDF */}\n                              {isPdf && (\n                                <button\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    handleOCRExtraction(priloha, faktura.dokument_id);\n                                  }}\n                                  style={{\n                                    background: '#3b82f6',\n                                    border: 'none',\n                                    borderRadius: '6px',\n                                    padding: '0.5rem 0.75rem',\n                                    cursor: 'pointer',\n                                    display: 'inline-flex',\n                                    alignItems: 'center',\n                                    gap: '0.4rem',\n                                    color: 'white',\n                                    fontSize: '0.7rem',\n                                    fontWeight: '600',\n                                    boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',\n                                    transition: 'all 0.2s ease',\n                                    whiteSpace: 'nowrap'\n                                  }}\n                                  onMouseEnter={(e) => {\n                                    e.currentTarget.style.background = '#2563eb';\n                                    e.currentTarget.style.transform = 'translateY(-1px)';\n                                    e.currentTarget.style.boxShadow = '0 4px 8px rgba(59, 130, 246, 0.25)';\n                                  }}\n                                  onMouseLeave={(e) => {\n                                    e.currentTarget.style.background = '#3b82f6';\n                                    e.currentTarget.style.transform = 'translateY(0)';\n                                    e.currentTarget.style.boxShadow = '0 1px 3px rgba(0, 0, 0, 0.1)';\n                                  }}\n                                  title=\"Vytit daje pomoc OCR\"\n                                >\n                                  <Sparkles size={14} />\n                                  <span>OCR</span>\n                                </button>\n                              )}\n                              \n                              {/* PDF/TXT Preview Button VPRAVO */}\n                              <PrilohaButton\n                                as={canPreview ? 'button' : 'a'}\n                                href={canPreview ? undefined : priloha.download_url}\n                                target={canPreview ? undefined : \"_blank\"}\n                                rel={canPreview ? undefined : \"noopener noreferrer\"}\n                                onClick={async (e) => {\n                                  e.stopPropagation();\n                                  if (isPdf) {\n                                    // Otevt PDF v modalu\n                                    setFileViewer({\n                                      visible: true,\n                                      url: priloha.download_url,\n                                      filename: priloha.filename,\n                                      type: 'pdf',\n                                      content: ''\n                                    });\n                                  } else if (isTxt) {\n                                    const txtContent = await fetchTxtContent(priloha.download_url);\n                                    setFileViewer({\n                                      visible: true,\n                                      url: priloha.download_url,\n                                      filename: priloha.filename,\n                                      type: 'txt',\n                                      content: txtContent\n                                    });\n                                  }\n                                }}\n                              >\n                                <FontAwesomeIcon icon={isPdf ? faFileAlt : (isTxt ? faFileAlt : faDownload)} />\n                                {isPdf ? 'PDF' : (isTxt ? 'TXT' : 'DL')}\n                              </PrilohaButton>\n                            </div>\n                          </PrilohaItem>\n                        );\n                        });\n                      })()}\n                      {faktura.prilohy.length > 3 && (\n                        <div \n                          style={{ \n                            fontSize: '0.75rem', \n                            color: '#3b82f6', \n                            marginTop: '0.5rem', \n                            textAlign: 'center', \n                            fontWeight: 600,\n                            cursor: 'pointer',\n                            padding: '0.5rem',\n                            borderRadius: '4px',\n                            background: '#eff6ff',\n                            transition: 'all 0.2s ease'\n                          }}\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            setExpandedAttachments(prev => {\n                              const newSet = new Set(prev);\n                              if (newSet.has(faktura.dokument_id)) {\n                                newSet.delete(faktura.dokument_id);\n                              } else {\n                                newSet.add(faktura.dokument_id);\n                              }\n                              return newSet;\n                            });\n                          }}\n                          onMouseEnter={(e) => {\n                            e.currentTarget.style.background = '#dbeafe';\n                            e.currentTarget.style.transform = 'translateY(-1px)';\n                          }}\n                          onMouseLeave={(e) => {\n                            e.currentTarget.style.background = '#eff6ff';\n                            e.currentTarget.style.transform = 'translateY(0)';\n                          }}\n                        >\n                          {expandedAttachments.has(faktura.dokument_id) \n                            ? ' Skrt plohy' \n                            : ` Zobrazit +${faktura.prilohy.length - 3} dal`}\n                        </div>\n                      )}\n                    </PrilohaSection>\n                  )}\n                </FakturaCard>\n              );\n              })}\n            </InboxContent>\n            );\n          })()}\n        </InboxContainer>\n        );\n      })()}\n\n      {/* OCR Progress Overlay */}\n      {ocrProgress.visible && (\n        <div style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'linear-gradient(135deg, rgba(249, 250, 251, 0.98) 0%, rgba(243, 244, 246, 0.98) 100%)',\n          backdropFilter: 'blur(8px)',\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: '1.25rem',\n          zIndex: 1000,\n          borderRadius: '8px',\n          border: '2px solid #e5e7eb',\n          boxShadow: '0 10px 25px rgba(0, 0, 0, 0.1)'\n        }}>\n          <div style={{\n            background: 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)',\n            borderRadius: '50%',\n            width: '80px',\n            height: '80px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            boxShadow: '0 4px 12px rgba(59, 130, 246, 0.3)'\n          }}>\n            <Sparkles size={40} color=\"white\" style={{ animation: 'spin 2s linear infinite' }} />\n          </div>\n          <div style={{ \n            fontSize: '1.1rem', \n            fontWeight: '700', \n            color: '#1f2937',\n            textAlign: 'center'\n          }}>\n            <FontAwesomeIcon icon={faFileAlt} style={{ marginRight: '0.5rem', color: '#3b82f6' }} />\n            OCR extrakce z PDF\n          </div>\n          <div style={{ \n            fontSize: '0.9rem', \n            color: '#6b7280',\n            textAlign: 'center',\n            maxWidth: '300px'\n          }}>\n            {ocrProgress.message}\n          </div>\n          <div style={{ \n            width: '85%', \n            maxWidth: '320px', \n            height: '10px', \n            backgroundColor: '#e5e7eb', \n            borderRadius: '5px', \n            overflow: 'hidden',\n            border: '1px solid #d1d5db',\n            boxShadow: 'inset 0 1px 3px rgba(0, 0, 0, 0.1)'\n          }}>\n            <div style={{ \n              height: '100%', \n              width: `${ocrProgress.progress}%`, \n              background: 'linear-gradient(90deg, #3b82f6 0%, #2563eb 100%)',\n              transition: 'width 0.3s ease',\n              boxShadow: '0 0 8px rgba(59, 130, 246, 0.5)'\n            }} />\n          </div>\n          <div style={{ \n            fontSize: '0.85rem', \n            color: '#1e40af', \n            fontWeight: '700',\n            background: 'rgba(59, 130, 246, 0.1)',\n            padding: '0.25rem 0.75rem',\n            borderRadius: '12px'\n          }}>\n            {Math.round(ocrProgress.progress)}%\n          </div>\n        </div>\n      )}\n\n      {fileViewer.visible && ReactDOM.createPortal(\n        <FileModal \n          x={fileViewerPosition.x}\n          y={fileViewerPosition.y}\n          w={fileViewerPosition.w}\n          h={fileViewerPosition.h}\n        >\n          <FileModalContent>\n            <FileModalHeader\n              onMouseDown={(e) => {\n                setIsDraggingViewer(true);\n                e.preventDefault();\n              }}\n              style={{ cursor: isDraggingViewer ? 'grabbing' : 'grab' }}\n            >\n              <FileModalTitle>\n                <FontAwesomeIcon icon={faFileAlt} />\n                {fileViewer.filename}\n              </FileModalTitle>\n              <FileCloseButton onClick={() => setFileViewer({ visible: false, url: '', filename: '', type: '', content: '' })}>\n                <FontAwesomeIcon icon={faTimes} />\n              </FileCloseButton>\n            </FileModalHeader>\n            {fileViewer.type === 'pdf' ? (\n              <FileObject \n                data={fileViewer.url}\n                type=\"application/pdf\"\n                title={fileViewer.filename}\n              >\n                <PdfFallback>\n                  <FontAwesomeIcon icon={faFileAlt} size=\"3x\" style={{ color: '#64748b' }} />\n                  <div style={{ fontSize: '1.1rem', fontWeight: 600 }}>PDF nelze zobrazit v prohlei</div>\n                  <div style={{ fontSize: '0.9rem', color: '#64748b', textAlign: 'center', maxWidth: '400px' }}>\n                    V prohle nepodporuje zobrazen PDF soubor. Mete soubor sthnout a otevt extern.\n                  </div>\n                  <DownloadButton href={fileViewer.url} download={fileViewer.filename}>\n                    <FontAwesomeIcon icon={faDownload} />\n                    Sthnout PDF\n                  </DownloadButton>\n                </PdfFallback>\n              </FileObject>\n            ) : fileViewer.type === 'txt' ? (\n              <TxtViewer>{fileViewer.content}</TxtViewer>\n            ) : null}\n          </FileModalContent>\n        </FileModal>,\n        document.body\n      )}\n\n      <ErrorDialog\n        isOpen={errorDialog.isOpen}\n        title={errorDialog.title}\n        message={errorDialog.message}\n        details={errorDialog.details}\n        onConfirm={errorDialog.onConfirm}\n        onClose={errorDialog.onClose}\n        confirmText={errorDialog.onConfirm ? (errorDialog.title.includes('Varovn') ? 'Pokraovat' : 'Otevt PDF') : null}\n        cancelText=\"Zruit\"\n      />\n    </PanelBase>,\n    document.body\n  );\n};\n\nexport default SpisovkaInboxPanel;\n","/**\n * InvoiceEvidencePage.js - Komponenta pro evidenci a pravu faktur\n * \n *  OPTIMALIZOVNO (29.12.2025):\n * - Odstranny duplicitn useEffecty pro natn objednvky (3 msta  1)\n * - Opraveny dependency arrays v useEffect (localStorage, debounced search)\n * - Pidn flag pro jednorzov auto-scroll na fakturu\n * - Optimalizovn handleAttachmentUploaded - stabiln reference pomoc useRef\n * - Pidn cleanup pro originalFormData pi submitu (prevence memory leak)\n * - Spisovka effect spout se pouze jednou pi mount\n * - Resize handler pouv functional update\n * \n * ODHADOVAN SPORA: ~40-60% mn re-render\n */\n\nimport React, { useState, useEffect, useContext, useCallback, useMemo, useRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport { unstable_batchedUpdates } from 'react-dom';\nimport { useNavigate, useParams, useLocation } from 'react-router-dom';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faTimes,\n  faSave,\n  faFileInvoice,\n  faCheckCircle,\n  faTimesCircle,\n  faExclamationTriangle,\n  faBuilding,\n  faCalendar,\n  faMoneyBillWave,\n  faClipboardCheck,\n  faExpand,\n  faCompress,\n  faArrowLeft,\n  faCreditCard,\n  faUpload,\n  faChevronUp,\n  faChevronDown,\n  faSearch,\n  faSpinner,\n  faEdit,\n  faFileContract,\n  faLock,\n  faUnlock,\n  faBookOpen,\n  faEnvelope,\n  faPhone,\n  faClock\n} from '@fortawesome/free-solid-svg-icons';\nimport { AuthContext } from '../context/AuthContext';\nimport { ToastContext } from '../context/ToastContext';\nimport { ProgressContext } from '../context/ProgressContext';\nimport { createInvoiceWithAttachmentV2, createInvoiceV2, getInvoiceById25, updateInvoiceV2, deleteInvoiceAttachment25 } from '../services/api25invoices';\nimport { getOrderV2, updateOrderV2, lockOrderV2, unlockOrderV2 } from '../services/apiOrderV2';\nimport { getSmlouvaDetail } from '../services/apiSmlouvy';\nimport { universalSearch } from '../services/apiUniversalSearch';\nimport { fetchAllUsers } from '../services/api2auth';\nimport { getStrediska25, getTypyFaktur25 } from '../services/api25orders';\nimport { formatDateOnly } from '../utils/format';\nimport OrderFormReadOnly from '../components/OrderFormReadOnly';\nimport SmlouvaPreview from '../components/SmlouvaPreview';\nimport DatePicker from '../components/DatePicker';\nimport { CustomSelect } from '../components/CustomSelect';\nimport ConfirmDialog from '../components/ConfirmDialog';\nimport { Search } from 'lucide-react';\nimport draftManager from '../services/DraftManager';\nimport { notificationService, NOTIFICATION_TYPES } from '../services/notificationsUnified';\nimport SpisovkaInboxPanel from '../components/panels/SpisovkaInboxPanel';\nimport { InvoiceAttachmentsCompact, LPCerpaniEditor } from '../components/invoices';\nimport { parseISDOCFile, createISDOCSummary, mapISDOCToFaktura } from '../utils/isdocParser';\nimport { markSpisovkaDocumentProcessed } from '../services/apiSpisovkaZpracovani';\nimport { saveFakturaLPCerpani, getFakturaLPCerpani } from '../services/apiFakturyLPCerpani';\nimport { useDictionaries } from '../forms/OrderForm25/hooks/useDictionaries';\n\n// Helper: formt data pro input type=\"date\" (YYYY-MM-DD)\nconst formatDateForPicker = (date) => {\n  if (!date) return '';\n  const d = new Date(date);\n  if (isNaN(d)) return '';\n  return d.toISOString().split('T')[0];\n};\n\n// Currency Input Component - zachovv pozici kurzoru pi psan\nfunction CurrencyInput({ fieldName, value, onChange, onBlur, disabled, hasError, placeholder }) {\n  const inputRef = useRef(null);\n  const [localValue, setLocalValue] = useState('');\n  const [isFocused, setIsFocused] = useState(false);\n\n  // Funkce pro formtovn mny (BEZ K, protoe to je fixn vpravo)\n  const formatCurrency = (val) => {\n    if (!val && val !== 0) return '';\n    const num = parseFloat(val.toString().replace(/[^0-9.-]/g, ''));\n    if (isNaN(num)) return '';\n    // Pro faktury/etnictv pesn 2 desetinn msta\n    return num.toFixed(2).replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ').replace('.', ',');\n  };\n\n  // Inicializace lokln hodnoty z props (pouze kdy nen focused)\n  useEffect(() => {\n    if (!isFocused) {\n      const formattedValue = formatCurrency(value || '');\n      if (localValue !== formattedValue) {\n        setLocalValue(formattedValue);\n      }\n    }\n  }, [value, isFocused, localValue]);\n\n  const handleChange = (e) => {\n    const newValue = e.target.value;\n\n    // Aktualizovat lokln hodnotu okamit (bez formtovn)\n    setLocalValue(newValue);\n\n    // Oistit hodnotu od formtovn\n    const cleanValue = newValue.replace(/[^\\d,.-]/g, '').replace(',', '.');\n    const numValue = parseFloat(cleanValue);\n    const finalValue = isNaN(numValue) ? '' : numValue.toFixed(2);\n\n    // Volat onChange s oitnou hodnotou\n    if (onChange) {\n      onChange({ target: { name: fieldName, value: finalValue } });\n    }\n  };\n\n  const handleFocus = () => {\n    setIsFocused(true);\n  };\n\n  const handleBlurLocal = () => {\n    setIsFocused(false);\n\n    // Formtovat hodnotu pi ztrt fokusu\n    const formatted = formatCurrency(localValue);\n    setLocalValue(formatted);\n\n    // Oistit hodnotu ped odeslnm do onBlur\n    const cleanValue = localValue.replace(/[^\\d,.-]/g, '').replace(',', '.');\n    const numValue = parseFloat(cleanValue);\n    const finalValue = isNaN(numValue) ? '' : numValue.toFixed(2);\n\n    // Zavolat parent onBlur pro validaci\n    if (onBlur) {\n      onBlur({ target: { name: fieldName, value: finalValue } });\n    }\n  };\n\n  return (\n    <CurrencyInputWrapper>\n      <Input\n        ref={inputRef}\n        type=\"text\"\n        name={fieldName}\n        placeholder={placeholder}\n        value={localValue}\n        onChange={handleChange}\n        onFocus={handleFocus}\n        onBlur={handleBlurLocal}\n        disabled={disabled}\n        style={{ textAlign: 'right', paddingRight: '40px', fontWeight: isFocused ? '400' : '600' }}\n        $hasError={hasError}\n      />\n      <CurrencySymbol>K</CurrencySymbol>\n    </CurrencyInputWrapper>\n  );\n}\n\n// ===================================================================\n// STYLED COMPONENTS - Recyklovan z OrderForm25 + nov pro layout\n// ===================================================================\n\n//  LOCK Dialog komponenty\nconst UserInfo = styled.div`\n  padding: 1rem;\n  background: #f8fafc;\n  border-left: 4px solid #3b82f6;\n  border-radius: 4px;\n  margin: 1rem 0;\n  font-size: 1.1rem;\n`;\n\nconst InfoText = styled.p`\n  margin: 0.75rem 0;\n  color: #64748b;\n  line-height: 1.6;\n`;\n\nconst WarningText = styled.p`\n  margin: 0.75rem 0;\n  color: #dc2626;\n  font-weight: 600;\n  line-height: 1.6;\n`;\n\nconst ContactInfo = styled.div`\n  margin: 1rem 0;\n  padding: 1rem;\n  background: #f0f9ff;\n  border: 1px solid #bfdbfe;\n  border-radius: 8px;\n`;\n\nconst ContactItem = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.5rem 0;\n  color: #1e40af;\n\n  &:not(:last-child) {\n    border-bottom: 1px solid #e0e7ff;\n  }\n\n  svg {\n    color: #3b82f6;\n    width: 18px;\n    height: 18px;\n  }\n\n  a {\n    color: #1e40af;\n    text-decoration: none;\n    font-weight: 500;\n    transition: all 0.2s ease;\n\n    &:hover {\n      color: #1e3a8a;\n      text-decoration: underline;\n    }\n  }\n`;\n\nconst ContactLabel = styled.span`\n  font-weight: 600;\n  min-width: 80px;\n  color: #64748b;\n`;\n\nconst LockTimeInfo = styled.div`\n  margin: 0.75rem 0;\n  padding: 0.75rem;\n  background: #fef3c7;\n  border-left: 4px solid #f59e0b;\n  border-radius: 4px;\n  font-size: 0.875rem;\n  color: #92400e;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n\n  svg {\n    color: #f59e0b;\n    width: 16px;\n    height: 16px;\n  }\n`;\n\nconst PageContainer = styled.div`\n  position: relative;\n  width: 100%;\n  height: calc(100vh - 60px);\n  background: #f9fafb;\n  padding: 0;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst FullscreenOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: #ffffff;\n  z-index: 99999;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n`;\n\nconst PageHeader = styled.div`\n  background: linear-gradient(135deg, #dbeafe 0%, #ffffff 100%);\n  color: #1f2937;\n  padding: 1.5rem 2rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 2px solid #e5e7eb;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n`;\n\nconst PageTitle = styled.h1`\n  margin: 0;\n  font-size: 1.75rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n`;\n\nconst HeaderActions = styled.div`\n  display: flex;\n  gap: 12px;\n  align-items: center;\n`;\n\nconst IconButton = styled.button`\n  background: #f9fafb;\n  border: 2px solid #e5e7eb;\n  color: #6b7280;\n  width: 44px;\n  height: 44px;\n  padding: 0;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 1.25rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  position: relative;\n\n  &:hover {\n    background: #ffffff;\n    border-color: #3b82f6;\n    color: #3b82f6;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n`;\n\nconst NotificationBadge = styled.span`\n  position: absolute;\n  top: -6px;\n  right: -6px;\n  background: #10b981;\n  color: white;\n  font-size: 0.7rem;\n  font-weight: 700;\n  padding: 2px 6px;\n  border-radius: 10px;\n  min-width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 2px solid #ffffff;\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);\n`;\n\nconst TooltipWrapper = styled.div`\n  position: relative;\n  display: inline-block;\n`;\n\nconst TooltipContent = styled.div`\n  position: fixed;\n  top: ${props => props.$top || 0}px;\n  left: ${props => props.$left || 0}px;\n  min-width: 350px;\n  max-width: 450px;\n  background: #ffffff;\n  border: 2px solid #e5e7eb;\n  border-radius: 10px;\n  padding: 0.75rem;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);\n  z-index: 10000;\n  opacity: ${props => props.show ? 1 : 0};\n  visibility: ${props => props.show ? 'visible' : 'hidden'};\n  transform: ${props => props.show ? 'translateY(0)' : 'translateY(-10px)'};\n  transition: all 0.2s ease;\n  pointer-events: none;\n\n  &::before {\n    content: '';\n    position: absolute;\n    bottom: 100%;\n    right: 20px;\n    border: 6px solid transparent;\n    border-bottom-color: #e5e7eb;\n  }\n  \n  &::after {\n    content: '';\n    position: absolute;\n    bottom: 100%;\n    right: 21px;\n    border: 5px solid transparent;\n    border-bottom-color: #ffffff;\n  }\n`;\n\nconst TooltipTitle = styled.div`\n  font-size: 0.7rem;\n  font-weight: 700;\n  color: #10b981;\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n`;\n\nconst TooltipItem = styled.div`\n  padding: 0.4rem;\n  border-radius: 6px;\n  margin-bottom: 0.3rem;\n  background: #f0fdf4;\n  border: 1px solid #d1fae5;\n  font-size: 0.75rem;\n  color: #1f2937;\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst TooltipItemTitle = styled.div`\n  font-weight: 600;\n  color: #065f46;\n  margin-bottom: 0.2rem;\n`;\n\nconst TooltipItemMeta = styled.div`\n  font-size: 0.7rem;\n  color: #6b7280;\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst ContentLayout = styled.div`\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  min-height: 0;\n`;\n\nconst FormColumn = styled.div`\n  width: 55%;\n  background: white;\n  border-right: 2px solid #e5e7eb;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst FormColumnHeader = styled.div`\n  flex-shrink: 0;\n  background: white;\n  padding: 1.5rem 2rem 1rem 2rem;\n  border-bottom: 2px solid #e5e7eb;\n`;\n\nconst FormColumnContent = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 2rem;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f1f1f1;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n`;\n\nconst PreviewColumn = styled.div`\n  width: 45%;\n  background: #f8fafc;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst PreviewColumnHeader = styled.div`\n  flex-shrink: 0;\n  background: #f8fafc;\n  padding: 1.25rem 2rem 1.5rem 2rem;\n  border-bottom: 2px solid #e5e7eb;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 1rem;\n`;\n\nconst ToggleButton = styled.button`\n  background: ${props => props.disabled ? '#e5e7eb' : '#3b82f6'};\n  color: ${props => props.disabled ? '#94a3b8' : 'white'};\n  border: none;\n  border-radius: 6px;\n  padding: 0.5rem 1rem;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.15s ease;\n  white-space: nowrap;\n  align-self: center;\n  margin: 0;\n\n  &:hover:not(:disabled) {\n    background: #2563eb;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n\n  &:active:not(:disabled) {\n    transform: translateY(0);\n  }\n`;\n\nconst PreviewColumnContent = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 2rem;\n\n  &::-webkit-scrollbar {\n    width: 10px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #e5e7eb;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #9ca3af;\n    border-radius: 5px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #6b7280;\n  }\n`;\n\nconst SectionTitle = styled.h2`\n  font-size: 1.3rem;\n  color: #1e293b;\n  margin: 0 0 1.5rem 0;\n  padding-bottom: 12px;\n  border-bottom: 2px solid #3498db;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n\n// Collapsible Section Components - inspirovan OrderForm25.js\nconst CollapsibleSection = styled.div`\n  background: #ffffff;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  margin-bottom: 1.5rem;\n  overflow: visible;\n  border: 2px solid #e2e8f0;\n`;\n\nconst CollapsibleHeader = styled.div`\n  padding: 1rem 1.25rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  border-bottom: 3px solid #1e40af;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  border-radius: 12px 12px 0 0;\n  color: white;\n  font-weight: 700;\n  font-size: 1.1rem;\n  letter-spacing: 0.5px;\n  text-transform: uppercase;\n\n  &:hover {\n    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n  }\n`;\n\nconst HeaderLeft = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  font-weight: 600;\n  font-size: 1.1rem;\n  color: white;\n`;\n\nconst HeaderRight = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst SectionContent = styled.div`\n  padding: 1.5rem 1.25rem;\n  display: ${props => props.$collapsed ? 'none' : 'block'};\n`;\n\nconst CollapseButton = styled.button`\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  padding: 0.25rem;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.2rem;\n  transition: transform 0.3s ease;\n  transform: ${props => props.$collapsed ? 'rotate(180deg)' : 'rotate(0deg)'};\n\n  &:hover {\n    color: rgba(255, 255, 255, 0.8);\n  }\n`;\n\n// Recyklovan z OrderForm25 - FakturaCard layout\nconst FakturaCard = styled.div`\n  border: 2px solid ${props => props.$hasError ? '#ef4444' : '#e5e7eb'};\n  border-radius: 12px;\n  padding: 1.5rem;\n  background: ${props => props.$isEditing ? '#f0f9ff' : '#ffffff'};\n  margin-bottom: 1.5rem;\n  transition: all 0.3s ease;\n\n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n`;\n\nconst FieldRow = styled.div`\n  display: grid;\n  grid-template-columns: ${props => props.$columns || '1fr'};\n  gap: ${props => props.$gap || '1rem'};\n  margin-bottom: 1rem;\n`;\n\nconst FieldGroup = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n`;\n\nconst FieldLabel = styled.label`\n  font-weight: 600;\n  color: #475569;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst RequiredStar = styled.span`\n  color: #ef4444;\n`;\n\nconst CurrencyInputWrapper = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n`;\n\nconst CurrencySymbol = styled.span`\n  position: absolute;\n  right: 12px;\n  color: #374151;\n  font-weight: 600;\n  font-size: 0.875rem;\n  font-family: inherit;\n  pointer-events: none;\n  user-select: none;\n  display: flex;\n  align-items: center;\n  height: 100%;\n`;\n\nconst Input = styled.input`\n  width: 100%;\n  height: 48px;\n  padding: 1px 0.875rem;\n  border: 2px solid ${props => props.$hasError ? '#ef4444' : '#e2e8f0'};\n  border-radius: 8px;\n  font-size: 0.95rem;\n  transition: all 0.2s ease;\n  font-family: inherit;\n  box-sizing: border-box;\n\n  &:focus {\n    outline: none;\n    border-color: ${props => props.$hasError ? '#ef4444' : '#3b82f6'};\n    box-shadow: 0 0 0 3px ${props => props.$hasError ? 'rgba(239, 68, 68, 0.1)' : 'rgba(59, 130, 246, 0.1)'};\n  }\n\n  &:disabled {\n    background: #f1f5f9;\n    cursor: not-allowed;\n  }\n\n  &::placeholder {\n    color: #94a3af;\n  }\n`;\n\nconst Textarea = styled.textarea`\n  padding: 0.875rem;\n  border: 2px solid #e2e8f0;\n  border-radius: 8px;\n  font-size: 0.95rem;\n  min-height: 100px;\n  resize: vertical;\n  font-family: inherit;\n  transition: all 0.2s ease;\n  box-sizing: border-box;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n`;\n\nconst Select = styled.select`\n  width: 100%;\n  height: 48px;\n  padding: 1px 2.5rem 1px 0.875rem;\n  border: 2px solid ${props => props.$hasError ? '#ef4444' : '#e2e8f0'};\n  border-radius: 8px;\n  font-size: 0.95rem;\n  cursor: pointer;\n  font-family: inherit;\n  background-color: white;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 9L1 4h10z'/%3E%3C/svg%3E\");\n  background-repeat: no-repeat;\n  background-position: right 0.75rem center;\n  background-size: 12px;\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  transition: all 0.2s ease;\n  box-sizing: border-box;\n\n  &:hover {\n    border-color: ${props => props.$hasError ? '#ef4444' : '#cbd5e1'};\n  }\n\n  &:focus {\n    outline: none;\n    border-color: ${props => props.$hasError ? '#ef4444' : '#3b82f6'};\n    box-shadow: 0 0 0 3px ${props => props.$hasError ? 'rgba(239, 68, 68, 0.1)' : 'rgba(59, 130, 246, 0.1)'};\n  }\n\n  option {\n    padding: 0.5rem;\n  }\n`;\n\nconst ErrorMessage = styled.div`\n  color: #ef4444;\n  font-size: 0.875rem;\n  margin-top: 0.5rem;\n`;\n\nconst VecnaSpravnostPanel = styled.div`\n  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n  border: 2px solid #86efac;\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-top: 2rem;\n`;\n\nconst VecnaSpravnostTitle = styled.h3`\n  margin: 0 0 1rem 0;\n  font-size: 1.1rem;\n  color: #166534;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n\nconst CheckboxLabel = styled.label`\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  cursor: pointer;\n  padding: 0.75rem;\n  background: white;\n  border-radius: 8px;\n  border: 2px solid #d1fae5;\n  transition: all 0.2s ease;\n\n  &:hover {\n    border-color: #86efac;\n    background: #f0fdf4;\n  }\n\n  input[type=\"checkbox\"] {\n    width: 20px;\n    height: 20px;\n    cursor: pointer;\n  }\n\n  strong {\n    color: #166534;\n    font-size: 1rem;\n  }\n`;\n\nconst ButtonGroup = styled.div`\n  display: flex;\n  gap: 1rem;\n  margin-top: 2rem;\n  padding-top: 1.5rem;\n  border-top: 2px solid #e5e7eb;\n  justify-content: flex-end;\n`;\n\nconst Button = styled.button`\n  padding: 0.875rem 1.75rem;\n  border: none;\n  border-radius: 8px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n\n  ${props => props.$variant === 'primary' && `\n    background: #3b82f6;\n    color: white;\n\n    &:hover {\n      background: #2563eb;\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);\n    }\n  `}\n\n  ${props => props.$variant === 'secondary' && `\n    background: #f1f5f9;\n    color: #475569;\n\n    &:hover {\n      background: #e2e8f0;\n    }\n  `}\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none !important;\n  }\n\n  &:active:not(:disabled) {\n    transform: scale(0.98);\n  }\n`;\n\nconst OrderPreviewCard = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  margin-bottom: 1.5rem;\n`;\n\nconst OrderHeaderRow = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n  padding-bottom: 1rem;\n  border-bottom: 2px solid #e5e7eb;\n`;\n\nconst OrderNumber = styled.div`\n  font-size: 1.4rem;\n  font-weight: 700;\n  color: #1e293b;\n`;\n\nconst OrderBadge = styled.span`\n  padding: 6px 14px;\n  border-radius: 16px;\n  font-size: 0.85rem;\n  font-weight: 600;\n  background: ${props => props.$color || '#64748b'};\n  color: white;\n`;\n\nconst OrderDetailRow = styled.div`\n  display: flex;\n  margin-bottom: 12px;\n  gap: 12px;\n`;\n\nconst OrderDetailLabel = styled.div`\n  font-weight: 600;\n  color: #64748b;\n  min-width: 140px;\n  font-size: 0.9rem;\n`;\n\nconst OrderDetailValue = styled.div`\n  color: #1e293b;\n  flex: 1;\n  font-size: 0.9rem;\n`;\n\nconst LoadingOverlay = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem;\n  color: #64748b;\n`;\n\nconst LoadingSpinner = styled.div`\n  width: 48px;\n  height: 48px;\n  border: 4px solid #e2e8f0;\n  border-top: 4px solid #3b82f6;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  margin-bottom: 1rem;\n\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n`;\n\nconst ErrorAlert = styled.div`\n  background: #fef2f2;\n  border: 2px solid #fecaca;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1.5rem;\n  color: #991b1b;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n\nconst HelpText = styled.div`\n  font-size: 0.85rem;\n  color: #64748b;\n  margin-top: 0.5rem;\n  font-style: italic;\n`;\n\nconst FieldError = styled.div`\n  font-size: 0.85rem;\n  color: #dc2626;\n  margin-top: 0.5rem;\n  display: flex;\n  align-items: center;\n  gap: 0.35rem;\n  font-weight: 500;\n`;\n\n// Autocomplete styled components\nconst AutocompleteWrapper = styled.div`\n  position: relative;\n  width: 100%;\n`;\n\nconst AutocompleteInput = styled(Input)`\n  padding-right: 2.5rem;\n`;\n\nconst ClearButton = styled.button`\n  position: absolute;\n  right: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  background: none;\n  border: none;\n  color: #cbd5e1;\n  cursor: pointer;\n  padding: 0.25rem;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s ease;\n  font-size: 0.75rem;\n  opacity: 0.6;\n\n  &:hover {\n    color: #94a3b8;\n    opacity: 1;\n  }\n\n  &:active {\n    transform: translateY(-50%) scale(0.9);\n  }\n`;\n\nconst AutocompleteDropdown = styled.div`\n  position: absolute;\n  top: calc(100% + 4px);\n  left: 0;\n  width: 150%;\n  max-height: 400px;\n  overflow-y: auto;\n  background: white;\n  border: 2px solid #3b82f6;\n  border-radius: 8px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n`;\n\nconst OrderSuggestionItem = styled.div`\n  padding: 0.75rem 1rem;\n  cursor: pointer;\n  border-bottom: 1px solid #f3f4f6;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #eff6ff;\n  }\n\n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst OrderSuggestionTitle = styled.div`\n  font-weight: 600;\n  color: #1e40af;\n  font-size: 0.95rem;\n  margin-bottom: 0.25rem;\n`;\n\nconst OrderSuggestionDetail = styled.div`\n  font-size: 0.85rem;\n  color: #6b7280;\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-top: 0.25rem;\n`;\n\nconst OrderSuggestionBadge = styled.span`\n  background: ${props => props.$color || '#e5e7eb'};\n  color: ${props => props.$textColor || '#374151'};\n  padding: 0.125rem 0.5rem;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  font-weight: 500;\n`;\n\nconst NoResults = styled.div`\n  padding: 1rem;\n  text-align: center;\n  color: #9ca3af;\n  font-size: 0.9rem;\n`;\n\nconst SearchingSpinner = styled.div`\n  padding: 1rem;\n  text-align: center;\n  color: #6b7280;\n`;\n\n// ===================================================================\n// PROGRESS MODAL - Modln okno pro zobrazen prbhu ukldn\n// ===================================================================\n\nconst ProgressOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 100010;\n  animation: fadeIn 0.2s ease-in;\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n`;\n\nconst ProgressModal = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 2rem;\n  min-width: 400px;\n  max-width: 500px;\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);\n  animation: slideIn 0.3s ease-out;\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(-20px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n`;\n\nconst ProgressHeader = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n`;\n\nconst ProgressIconWrapper = styled.div`\n  width: 48px;\n  height: 48px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5rem;\n  background: ${props => {\n    if (props.status === 'success') return 'linear-gradient(135deg, #10b981 0%, #059669 100%)';\n    if (props.status === 'error') return 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';\n    return 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)';\n  }};\n  color: white;\n  animation: ${props => props.status === 'loading' ? 'pulse 2s ease-in-out infinite' : 'none'};\n\n  @keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n  }\n`;\n\nconst ProgressTitle = styled.div`\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #111827;\n`;\n\nconst ProgressMessage = styled.div`\n  font-size: 0.95rem;\n  color: #6b7280;\n  margin-bottom: 1.5rem;\n  line-height: 1.5;\n`;\n\nconst ProgressBarWrapper = styled.div`\n  width: 100%;\n  height: 8px;\n  background: #e5e7eb;\n  border-radius: 4px;\n  overflow: hidden;\n  margin-bottom: 1rem;\n`;\n\nconst ProgressBarFill = styled.div`\n  height: 100%;\n  background: linear-gradient(90deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%);\n  border-radius: 4px;\n  transition: width 0.3s ease-out;\n  width: ${props => props.progress || 0}%;\n  background-size: 200% 100%;\n  animation: shimmer 2s infinite;\n\n  @keyframes shimmer {\n    0% { background-position: 200% 0; }\n    100% { background-position: -200% 0; }\n  }\n`;\n\nconst ProgressActions = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  gap: 0.75rem;\n  margin-top: 1.5rem;\n`;\n\nconst ProgressButton = styled.button`\n  padding: 0.5rem 1.25rem;\n  border-radius: 6px;\n  font-size: 0.9rem;\n  font-weight: 600;\n  cursor: pointer;\n  border: none;\n  transition: all 0.2s;\n  background: ${props => props.variant === 'primary' ? '#3b82f6' : '#e5e7eb'};\n  color: ${props => props.variant === 'primary' ? 'white' : '#374151'};\n\n  &:hover {\n    background: ${props => props.variant === 'primary' ? '#2563eb' : '#d1d5db'};\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n`;\n\n// Multi-select komponenta pro stediska\nconst MultiSelectWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  z-index: ${props => props.isOpen ? 10000 : 1};\n`;\n\nconst MultiSelectButton = styled.div`\n  width: 100%;\n  box-sizing: border-box;\n  height: 48px;\n  padding: 1px 2.5rem 1px 0.875rem;\n  border: 2px solid ${props => props.hasError ? '#dc2626' : '#e2e8f0'};\n  border-radius: 8px;\n  font-size: 0.95rem;\n  background: ${props => props.disabled ? '#f1f5f9' : '#ffffff'};\n  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n  color: ${props => {\n    if (props.disabled) return '#6b7280';\n    if (props.placeholder || !props.value || props.value === '') return '#94a3af';\n    return '#1f2937';\n  }};\n  font-weight: ${props => props.disabled ? '400' : (props.value && props.value !== '' && props.placeholder !== \"true\" ? '600' : '400')};\n  display: flex;\n  align-items: center;\n  position: relative;\n  transition: all 0.2s ease;\n  appearance: none;\n  -moz-appearance: none;\n  -webkit-appearance: none;\n  background-image: ${props => {\n    if (props.disabled) {\n      return props.isOpen\n        ? `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")`\n        : `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")`;\n    } else if (props.hasError) {\n      return props.isOpen\n        ? `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23b91c1c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")`\n        : `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23b91c1c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")`;\n    } else {\n      return props.isOpen\n        ? `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23374151' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='18 15 12 9 6 15'%3E%3C/polyline%3E%3C/svg%3E\")`\n        : `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23374151' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\")`;\n    }\n  }};\n  background-repeat: no-repeat;\n  background-position: right 0.75rem center;\n  background-size: 12px 12px;\n\n  &:hover {\n    border-color: ${props => props.disabled ? '#e2e8f0' : (props.hasError ? '#dc2626' : '#cbd5e1')};\n  }\n\n  &:focus {\n    outline: none;\n    border-color: ${props => props.hasError ? '#dc2626' : '#3b82f6'};\n    box-shadow: 0 0 0 3px ${props => props.hasError ? 'rgba(239, 68, 68, 0.1)' : 'rgba(59, 130, 246, 0.1)'};\n  }\n`;\n\nconst SelectedValue = styled.span`\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  color: ${props => props.isEmpty ? '#9ca3af' : '#1f2937'};\n  font-weight: ${props => props.isEmpty ? '400' : '600'};\n`;\n\nconst MultiSelectDropdown = styled.div`\n  position: fixed;\n  z-index: 40;\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.1);\n  max-height: 300px;\n  overflow-y: auto;\n  min-width: 200px;\n  user-select: none;\n  scroll-behavior: auto;\n  contain: layout style paint;\n  will-change: scroll-position;\n  transform: translateZ(0);\n  scrollbar-width: thin;\n  scrollbar-color: #d1d5db #f9fafb;\n\n  &::-webkit-scrollbar {\n    width: 8px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f9fafb;\n    border-radius: 4px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #d1d5db;\n    border-radius: 4px;\n  }\n\n  &::-webkit-scrollbar-thumb:hover {\n    background: #9ca3af;\n  }\n`;\n\nconst SearchBox = styled.div`\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: white;\n  padding: 0.75rem;\n  border-bottom: 1px solid #e5e7eb;\n`;\n\nconst SearchInput = styled.input`\n  width: 100%;\n  padding: 0.75rem 0.75rem 0.75rem 2.5rem;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  font-size: 0.875rem;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n  }\n`;\n\nconst SearchIcon = styled.div`\n  position: absolute;\n  left: 1rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #6b7280;\n  pointer-events: none;\n`;\n\nconst MultiSelectOption = styled.div`\n  padding: ${props => props.level === 0 ? '0.75rem' : '0.5rem 0.75rem 0.5rem 2rem'};\n  cursor: pointer;\n  font-size: 0.875rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  background: ${props => props.level === 0 ? '#f9fafb' : '#ffffff'};\n  border-bottom: ${props => props.level === 0 ? '2px solid #e5e7eb' : '1px solid #f3f4f6'};\n  font-weight: ${props => props.level === 0 ? '600' : '400'};\n  color: ${props => props.level === 0 ? '#111827' : '#4b5563'};\n  position: relative;\n  will-change: transform;\n  backface-visibility: hidden;\n  outline: none;\n\n  &:hover {\n    background: ${props => props.level === 0 ? '#f3f4f6' : '#f8fafc'};\n  }\n\n  &:focus {\n    background: #dbeafe;\n    box-shadow: inset 0 0 0 2px #3b82f6;\n  }\n\n  &:last-child {\n    border-bottom: none;\n  }\n\n  input[type=\"checkbox\"] {\n    margin: 0;\n    pointer-events: none;\n  }\n\n  span {\n    padding-left: ${props => (props.level || 0) * 20}px;\n    font-weight: ${props => (props.level || 0) === 0 ? '600' : '400'};\n  }\n`;\n\n// ===================================================================\n// MAIN COMPONENT\n// ===================================================================\n\nexport default function InvoiceEvidencePage() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { orderId } = useParams(); // URL param\n  const { token, username, user_id, hasPermission } = useContext(AuthContext);\n  const { showToast } = useContext(ToastContext);\n  const { setProgress } = useContext(ProgressContext) || {};\n\n  //  LP Kdy pro erpn \n  const dictionaries = useDictionaries({ token, username, showToast });\n\n  // Kontrola oprvnn - uivatel s MANAGE prvy nebo ADMIN role vid vechny objednvky\n  // hasPermission('ADMIN') kontroluje SUPERADMIN NEBO ADMINISTRATOR (speciln alias v AuthContext)\n  const canViewAllOrders = hasPermission('INVOICE_MANAGE') || \n                           hasPermission('ORDER_MANAGE') || \n                           hasPermission('ADMIN');\n\n  // Helper: zskn finlnho stavu objednvky\n  const getCurrentWorkflowState = useCallback((order) => {\n    if (!order || !order.stav_workflow_kod) {\n      return null;\n    }\n\n    let stavKody = [];\n    try {\n      if (typeof order.stav_workflow_kod === 'string') {\n        stavKody = JSON.parse(order.stav_workflow_kod);\n      } else if (Array.isArray(order.stav_workflow_kod)) {\n        stavKody = order.stav_workflow_kod;\n      }\n    } catch (e) {\n      return null;\n    }\n\n    return stavKody.length > 0 ? stavKody[stavKody.length - 1] : null;\n  }, []);\n\n  // Helper: kontrola zda lze pidat fakturu k objednvce (mus bt ve stavu FAKTURACE, VECNA_SPRAVNOST nebo ZKONTROLOVANA)\n  const canAddInvoiceToOrder = useCallback((order) => {\n    if (!order || !order.stav_workflow_kod) {\n      return { allowed: false, reason: 'Objednvka nem definovan stav' };\n    }\n\n    // stav_workflow_kod je JSON array string - obsahuje celou historii workflow\n    let stavKody = [];\n    try {\n      if (typeof order.stav_workflow_kod === 'string') {\n        stavKody = JSON.parse(order.stav_workflow_kod);\n      } else if (Array.isArray(order.stav_workflow_kod)) {\n        stavKody = order.stav_workflow_kod;\n      }\n    } catch (e) {\n      return { allowed: false, reason: 'Chyba pi parsovn stavu objednvky' };\n    }\n\n    //  DLEIT: Bereme pouze POSLEDN stav (finln stav objednvky)\n    const currentState = stavKody.length > 0 ? stavKody[stavKody.length - 1] : null;\n    \n    if (!currentState) {\n      return { allowed: false, reason: 'Objednvka nem definovan aktuln stav' };\n    }\n\n    // Povolen stavy pro fakturaci\n    // NEUVEREJNIT, UVEREJNENA - ped prvn fakturou (po potvrzen dodavatele)\n    // FAKTURACE - prvn faktura byla pidna\n    // VECNA_SPRAVNOST - ek na kontrolu vcn sprvnosti\n    // ZKONTROLOVANA - vcn sprvnost byla zkontrolovna\n    const allowedStates = ['NEUVEREJNIT', 'UVEREJNENA', 'FAKTURACE', 'VECNA_SPRAVNOST', 'ZKONTROLOVANA'];\n    \n    if (!allowedStates.includes(currentState)) {\n      return { \n        allowed: false, \n        reason: `Fakturaci lze pidat pouze k objednvkm ve stavu: NEUVEEJNIT, UVEEJNNA, FAKTURACE, VCN SPRVNOST nebo ZKONTROLOVAN. Aktuln stav: ${currentState}`\n      };\n    }\n\n    return { allowed: true, reason: null };\n  }, []);\n\n  //  Readonly reim pro omezen ty\n  const isReadOnlyMode = !hasPermission('INVOICE_MANAGE') && hasPermission('INVOICE_MATERIAL_CORRECTNESS');\n\n  //  Collapsible sections state\n  const [sectionStates, setSectionStates] = useState(() => {\n    // Default stavy\n    const defaultStates = {\n      invoiceData: true, // vdy rozvinut pi naten\n      materialCorrectness: !hasPermission('INVOICE_MANAGE') // rozvinuto pouze pro uivatele bez INVOICE_MANAGE\n    };\n\n    // Zkusit nast z localStorage pi prvn inicializaci\n    try {\n      const savedSections = localStorage.getItem(`invoiceSections_${user_id}`);\n      if (savedSections) {\n        const parsed = JSON.parse(savedSections);\n        return { ...defaultStates, ...parsed };\n      }\n    } catch (e) {\n      console.warn(' Chyba pi natn stavu sekc z localStorage:', e);\n    }\n\n    return defaultStates;\n  });\n\n  // Toggle funkce pro sekce\n  const toggleSection = useCallback((sectionName) => {\n    setSectionStates(prev => ({\n      ...prev,\n      [sectionName]: !prev[sectionName]\n    }));\n  }, []);\n\n  // State\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [orderLoading, setOrderLoading] = useState(false);\n  const [orderData, setOrderData] = useState(null);\n  const [smlouvaData, setSmlouvaData] = useState(null);\n  const [selectedType, setSelectedType] = useState('order'); // 'order' nebo 'smlouva'\n  const [error, setError] = useState(null);\n  const [fieldErrors, setFieldErrors] = useState({});\n\n  // Autocomplete state - univerzln pro objednvky i smlouvy\n  const [searchTerm, setSearchTerm] = useState('');\n  const [suggestions, setSuggestions] = useState([]); // Zmnno z orderSuggestions\n  const [isSearching, setIsSearching] = useState(false);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n\n  // Ref pro OrderFormReadOnly\n  const orderFormRef = useRef(null);\n  \n  // State pro sledovn collapse stavu\n  const [hasAnySectionCollapsed, setHasAnySectionCollapsed] = useState(false);\n  \n  // State pro sledovn editace faktury (localStorage se nate v useEffect)\n  const [editingInvoiceId, setEditingInvoiceId] = useState(null);\n  \n  //  Flag: Faktura byla POTVRZENA uivatelem (kliknut na Zaevidovat)\n  // Tento flag se NENASTAV pi auto-vytvoen faktury pi uploadu plohy\n  const [invoiceUserConfirmed, setInvoiceUserConfirmed] = useState(false);\n\n  //  Ref pro sledovn resetu - blokuje useEffect bhem reset operace\n  // POZNMKA: Tento pattern je OK - ref slou jako synchronizan mechanismus\n  const isResettingRef = useRef(false);\n\n  // Confirm dialog state\n  const [confirmDialog, setConfirmDialog] = useState({\n    isOpen: false,\n    title: '',\n    message: '',\n    onConfirm: null,\n    onCancel: null\n  });\n  \n  //  State pro LOCK dialog system\n  const [showLockedOrderDialog, setShowLockedOrderDialog] = useState(false);\n  const [lockedOrderInfo, setLockedOrderInfo] = useState(null);\n\n  // State pro unlock entity (zmna objednvky/smlouvy u existujc FA)\n  const [isEntityUnlocked, setIsEntityUnlocked] = useState(false);\n  // State pro zapamatovn, zda mla faktura pvodn piazenou objednvku/smlouvu\n  const [hadOriginalEntity, setHadOriginalEntity] = useState(false);\n\n  //  Progress Modal State - zobrazen prbhu ukldn\n  const [progressModal, setProgressModal] = useState({\n    show: false,\n    status: 'loading', // 'loading' | 'success' | 'error'\n    progress: 0,\n    title: '',\n    message: ''\n  });\n\n  // Spisovka Inbox Panel - pouze pro ADMIN\n  const [spisovkaInboxOpen, setSpisovkaInboxOpen] = useState(false);\n  const [spisovkaInboxState, setSpisovkaInboxState] = useState({\n    x: Math.max(0, window.innerWidth - 750), // Snap doprava, min 0 (nesm bt zporn)\n    y: 144, // Pod fixed header (96px) + menubar (48px)\n    w: 750, // ka jako nhled faktury\n    h: Math.max(400, window.innerHeight - 144 - 54), // Mezi header+menubar a footer\n    minimized: false\n  });\n  const [spisovkaTodayCount, setSpisovkaTodayCount] = useState(0);\n  const [spisovkaLastRecords, setSpisovkaLastRecords] = useState([]);\n  const [showSpisovkaTooltip, setShowSpisovkaTooltip] = useState(false);\n  const [tooltipPosition, setTooltipPosition] = useState({ top: 0, left: 0 });\n  const tooltipButtonRef = useRef(null);\n\n  //  Resize handler - kontrola pozice panelu pi zmn velikosti okna\n  useEffect(() => {\n    const handleResize = () => {\n      setSpisovkaInboxState(prev => {\n        // Kontrola, zda panel nen mimo viditelnou oblast\n        const maxX = window.innerWidth - prev.w - 20;\n        const maxY = window.innerHeight - prev.h - 20;\n        \n        return {\n          ...prev,\n          x: Math.min(Math.max(20, prev.x), maxX),\n          y: Math.min(Math.max(20, prev.y), maxY)\n        };\n      });\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []); //  OPRAVENO: Ponechme [] ale pouvme functional update\n\n  // Form data - inicializace s vchozmi hodnotami (localStorage se nate v useEffect)\n  const [formData, setFormData] = useState({\n    order_id: orderId || '',\n    smlouva_id: null,\n    fa_cislo_vema: '',\n    fa_typ: 'BEZNA',\n    fa_datum_doruceni: formatDateForPicker(new Date()),\n    fa_datum_vystaveni: '',\n    fa_datum_splatnosti: '',\n    fa_castka: '',\n    fa_poznamka: '',\n    fa_strediska_kod: [],\n    fa_predana_zam_id: null,\n    fa_datum_predani_zam: '',\n    fa_datum_vraceni_zam: '',\n    // Vcn kontrola\n    vecna_spravnost_umisteni_majetku: '',\n    vecna_spravnost_poznamka: '',\n    vecna_spravnost_potvrzeno: 0,\n    potvrdil_vecnou_spravnost_id: null,\n    dt_potvrzeni_vecne_spravnosti: ''\n  });\n\n  // Plohy faktury - inicializace przdn (localStorage se nate v useEffect)\n  const [attachments, setAttachments] = useState([]);\n  \n  //  Flag pro sledovn zda u bylo nateno z localStorage (zabrnit opakovanmu natn)\n  const [lsLoaded, setLsLoaded] = useState(false);\n\n  //  LP erpn (Limitovan psliby) - nap. [{lp_cislo: '6', lp_id: 6, castka: 50000, poznamka: ''}]\n  const [lpCerpani, setLpCerpani] = useState([]);\n  const [lpCerpaniLoaded, setLpCerpaniLoaded] = useState(false);\n  //  Flag pro kontrolu zda POVOLIT auto-save do localStorage\n  // Kdy uivatel klikne \"Zruit pravu\", nastav se na false aby se data znovu neuloila\n  const [allowLSSave, setAllowLSSave] = useState(true);\n\n  //  SPISOVKA METADATA - pomocn promnn pro tracking (ulo se pi drag & drop ze Spisovky)\n  // Pouvme useRef msto useState, aby se metadata neztrcela v closure callback\n  const pendingSpisovkaMetadataRef = useRef(null);\n\n  // CustomSelect states\n  const [selectStates, setSelectStates] = useState({});\n  const [searchStates, setSearchStates] = useState({});\n  const [touchedSelectFields, setTouchedSelectFields] = useState({});\n\n  // Stediska options\n  const [strediskaOptions, setStrediskaOptions] = useState([]);\n  const [strediskaLoading, setStrediskaLoading] = useState(false);\n\n  // Typy faktur (klasifikace ploh)\n  const [typyFakturOptions, setTypyFakturOptions] = useState([]);\n  const [typyFakturLoading, setTypyFakturLoading] = useState(false);\n  \n  // Zamstnanci options (pro pedn FA)\n  const [zamestnanci, setZamestnanci] = useState([]);\n  const [zamestnanciLoading, setZamestnanciLoading] = useState(false);\n  \n  // Tracking zmn kritickch pol\n  const [originalFormData, setOriginalFormData] = useState(null);\n  const [hasChangedCriticalField, setHasChangedCriticalField] = useState(false);\n\n  //  Zjistit, zda lze fakturu editovat (stejn logika jako disable na tlatku Aktualizovat)\n  const isInvoiceEditable = useMemo(() => {\n    return !isReadOnlyMode && !(formData.order_id && orderData && !canAddInvoiceToOrder(orderData).allowed);\n  }, [isReadOnlyMode, formData.order_id, orderData, canAddInvoiceToOrder]);\n\n  //  Zjistit, zda je objednvka ve stavu DOKONENA (ji nelze provdt vcnou kontrolu)\n  const isOrderCompleted = useMemo(() => {\n    if (!orderData || !orderData.stav_workflow_kod) return false;\n    \n    let stavKody = [];\n    try {\n      if (typeof orderData.stav_workflow_kod === 'string') {\n        stavKody = JSON.parse(orderData.stav_workflow_kod);\n      } else if (Array.isArray(orderData.stav_workflow_kod)) {\n        stavKody = orderData.stav_workflow_kod;\n      }\n    } catch (e) {\n      return false;\n    }\n    \n    const currentState = stavKody.length > 0 ? stavKody[stavKody.length - 1] : null;\n    return currentState === 'DOKONCENA';\n  }, [orderData]);\n\n  //  Natn LP selnk pi mount\n  useEffect(() => {\n    if (!token || !username) return;\n    \n    dictionaries.loadAll();\n  }, [token, username]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  //  AUTO-SAVE vech dat do localStorage pi zmn (per-user pomoc user_id)\n  // Slouen vech AUTO-SAVE operac do jednoho useEffect pro efektivitu\n  useEffect(() => {\n    if (!lsLoaded || !user_id || !allowLSSave) return; //  OPRAVENO: Kontrola allowLSSave flagu\n    \n    try {\n      localStorage.setItem(`invoiceForm_${user_id}`, JSON.stringify(formData));\n      localStorage.setItem(`invoiceAttach_${user_id}`, JSON.stringify(attachments));\n      \n      if (editingInvoiceId) {\n        localStorage.setItem(`invoiceEdit_${user_id}`, JSON.stringify(editingInvoiceId));\n      } else {\n        localStorage.removeItem(`invoiceEdit_${user_id}`);\n      }\n      \n      localStorage.setItem(`invoiceOrigEntity_${user_id}`, JSON.stringify(hadOriginalEntity));\n      \n      //  Uloit LP erpn\n      if (lpCerpani && Array.isArray(lpCerpani) && lpCerpani.length > 0) {\n        localStorage.setItem(`invoiceLpCerpani_${user_id}`, JSON.stringify(lpCerpani));\n      } else {\n        localStorage.removeItem(`invoiceLpCerpani_${user_id}`);\n      }\n      \n      //  Uloit stav sekc (sbalen/rozbalen)\n      localStorage.setItem(`invoiceSections_${user_id}`, JSON.stringify(sectionStates));\n    } catch (err) {\n      console.warn(' Chyba pi ukldn do localStorage:', err);\n    }\n  }, [formData, attachments, editingInvoiceId, hadOriginalEntity, lpCerpani, sectionStates, user_id, lsLoaded, allowLSSave]); //  Pidno lpCerpani, sectionStates\n\n  //  NOV: Naten dat z localStorage pi mount (pouze jednou, po zskn user_id)\n  useEffect(() => {\n    if (!user_id || lsLoaded || isResettingRef.current) return;\n    \n    // Detekce fresh navigation pomoc sessionStorage\n    // Pi kliknut na \"Zaevidovat fakturu\" nastavme flag, kter zstane a do zaven tabu\n    const freshNavigationFlag = sessionStorage.getItem('invoice_fresh_navigation');\n    const isEditingExisting = location.state?.editInvoiceId;\n    const isLoadingOrder = location.state?.orderIdForLoad;\n    const isLoadingSmlouva = location.state?.smlouvaIdForLoad;\n    \n    // Vymaeme flag po pouit (jednorzov)\n    if (freshNavigationFlag) {\n      sessionStorage.removeItem('invoice_fresh_navigation');\n    }\n    \n    // Skip localStorage pouze kdy:\n    // 1. Je freshNavigationFlag (prv kliknuto na \"Zaevidovat\") NEBO\n    // 2. Editujeme existujc fakturu NEBO  \n    // 3. Natme fakturu z objednvky/smlouvy\n    const shouldSkipLS = freshNavigationFlag || isEditingExisting || isLoadingOrder || isLoadingSmlouva;\n    \n    if (shouldSkipLS) {\n      setLsLoaded(true);\n      return;\n    }\n    \n    try {\n      // Nast editingInvoiceId\n      const savedEditId = localStorage.getItem(`invoiceEdit_${user_id}`);\n      if (savedEditId) {\n        setEditingInvoiceId(JSON.parse(savedEditId));\n        //  Pokud je uloeno editingInvoiceId, nastavit i invoiceUserConfirmed\n        // (protoe to znamen, e faktura byla ji potvrzena)\n        setInvoiceUserConfirmed(true);\n      }\n      \n      // Nast hadOriginalEntity\n      const savedOrigEntity = localStorage.getItem(`invoiceOrigEntity_${user_id}`);\n      if (savedOrigEntity) {\n        setHadOriginalEntity(JSON.parse(savedOrigEntity));\n      }\n      \n      //  Nast LP erpn\n      const savedLpCerpani = localStorage.getItem(`invoiceLpCerpani_${user_id}`);\n      if (savedLpCerpani) {\n        try {\n          const parsed = JSON.parse(savedLpCerpani);\n          if (Array.isArray(parsed) && parsed.length > 0) {\n            setLpCerpani(parsed);\n          }\n        } catch (e) {\n          console.warn(' Chyba pi parsovn LP erpn z localStorage:', e);\n        }\n      }\n      \n      // Nast formData\n      const savedForm = localStorage.getItem(`invoiceForm_${user_id}`);\n      if (savedForm) {\n        const parsed = JSON.parse(savedForm);\n        setFormData(parsed);\n      }\n      \n      // Nast attachments\n      const savedAttach = localStorage.getItem(`invoiceAttach_${user_id}`);\n      if (savedAttach) {\n        setAttachments(JSON.parse(savedAttach));\n      }\n    } catch (err) {\n      console.warn(' Chyba pi natn dat z localStorage:', err);\n    }\n    \n    setLsLoaded(true);\n  }, [user_id, lsLoaded]);\n\n  // Naten stedisek, typ faktur a zamstnanc pi mount (pouze jednou!)\n  useEffect(() => {\n    //  Nast data pouze jednou, pi prvnm mount\n    if (!token || !username || strediskaOptions.length > 0) return; // Skip pokud u jsou natena\n    \n    //  Paraleln naten vech selnk najednou\n    setStrediskaLoading(true);\n    setTypyFakturLoading(true);  \n    setZamestnanciLoading(true);\n    \n    const loadAllCiselniky = async () => {\n      try {\n        //  Paraleln voln vech API najednou\n        const [strediskaData, typyFakturData, usersData] = await Promise.all([\n          getStrediska25({ token, username }),\n          getTypyFaktur25({ token, username, aktivni: 1 }),\n          fetchAllUsers({ token, username })\n        ]);\n        \n        //  Zpracovat stediska\n        if (strediskaData && Array.isArray(strediskaData)) {\n          setStrediskaOptions(strediskaData);\n        }\n        \n        //  Zpracovat typy faktur\n        if (typyFakturData && Array.isArray(typyFakturData)) {\n          setTypyFakturOptions(typyFakturData);\n        }\n        \n        //  Zpracovat zamstnance\n        if (usersData && Array.isArray(usersData)) {\n          const aktivni = usersData\n            .filter(u => u.aktivni === 1)\n            .sort((a, b) => {\n              const aName = `${a.prijmeni || ''} ${a.jmeno || ''}`.trim();\n              const bName = `${b.prijmeni || ''} ${b.jmeno || ''}`.trim();\n              return aName.localeCompare(bName, 'cs');\n            });\n          setZamestnanci(aktivni);\n        }\n        \n      } catch (err) {\n        console.error('Chyba pi natn selnk:', err);\n      } finally {\n        setStrediskaLoading(false);\n        setTypyFakturLoading(false);\n        setZamestnanciLoading(false);\n      }\n    };\n    \n    loadAllCiselniky();\n  }, [token, username]); //  Ale jen pokud se zmn token/username\n\n  // Detekce zmny kritickch pol faktury\n  // Varovn m smysl POUZE pokud:\n  // 1. FA MLA piazenou OBJ nebo SML (ne NULL)\n  // 2. FA NEBYLA pedna zamstnanci\n  // 3. Vcn sprvnost JI BYLA PROVEDENA (vecna_spravnost_potvrzeno = 1)\n  useEffect(() => {\n    if (!editingInvoiceId || !originalFormData) return;\n    \n    // Kontrola podmnek pro zobrazen varovn\n    const hadOrderOrContract = originalFormData.order_id || originalFormData.smlouva_id;\n    const wasNotHandedToEmployee = !originalFormData.fa_predana_zam_id;\n    const wasAlreadyApproved = originalFormData.vecna_spravnost_potvrzeno === 1;\n    \n    // Varovn zobrazit jen pokud jsou splnny vechny podmnky\n    if (!hadOrderOrContract || !wasNotHandedToEmployee || !wasAlreadyApproved) {\n      setHasChangedCriticalField(false);\n      return;\n    }\n    \n    const criticalFields = [\n      'fa_castka',\n      'fa_cislo_vema',\n      'fa_strediska_kod',\n      'fa_typ',\n      'fa_datum_vystaveni',\n      'fa_datum_splatnosti',\n      'fa_datum_doruceni'\n    ];\n    \n    const hasChanged = criticalFields.some(field => {\n      const original = originalFormData[field];\n      const current = formData[field];\n      \n      // Speciln handling pro array (stediska)\n      if (Array.isArray(original) && Array.isArray(current)) {\n        return JSON.stringify(original.sort()) !== JSON.stringify(current.sort());\n      }\n      \n      return original !== current;\n    });\n    \n    setHasChangedCriticalField(hasChanged);\n  }, [formData, originalFormData, editingInvoiceId]);\n\n  // Naten faktury pi editaci (z location.state nebo localStorage)\n  // Flag aby se effect spustil jen jednou po naten stedisek\n  const hasLoadedInvoiceRef = useRef(false);\n  \n  useEffect(() => {\n    //  Skip loading podczas resetowania\n    if (isResettingRef.current) return;\n    \n    const loadInvoiceForEdit = async () => {\n      //  ID faktury me pijt z location.state NEBO z editingInvoiceId (localStorage po F5)\n      const editIdToLoad = location.state?.editInvoiceId || editingInvoiceId;\n      const orderIdForLoad = location.state?.orderIdForLoad;\n      \n      if (!editIdToLoad || !token || !username) {\n        return;\n      }\n      \n      //  Pokat na naten stedisek (potebujeme je pro mapovn)\n      if (strediskaOptions.length === 0) {\n        return;\n      }\n      \n      //  Pokud u jsme fakturu naetli, skip (prevence duplicitnho natn)\n      if (hasLoadedInvoiceRef.current && editingInvoiceId === editIdToLoad) {\n        return;\n      }\n      \n      //  NOV FIX: Pokud mme pending/uploading plohy, NEPEPISOVAT state\n      // (faktura se prv vytv a nahrvaj se k n plohy)\n      const hasPendingAttachments = attachments.some(att => \n        att.status === 'pending_upload' || att.status === 'uploading'\n      );\n      if (hasPendingAttachments) {\n        // Jen aktualizovat editingInvoiceId pro pt upload\n        setEditingInvoiceId(editIdToLoad);\n        return;\n      }\n      \n      //  Oznait e natme fakturu\n      hasLoadedInvoiceRef.current = true;\n      \n      setLoading(true);\n      setEditingInvoiceId(editIdToLoad);\n      //  Nastavit invoiceUserConfirmed na true - natme existujc fakturu\n      setInvoiceUserConfirmed(true);\n      \n      try {\n        // Nast data faktury\n        const invoiceData = await getInvoiceById25({ token, username, id: editIdToLoad });\n        \n        // Naplnit formul daty faktury\n        if (invoiceData) {\n          // Parse stedisek pokud jsou string - STEJN JAKO OrderForm25\n          let strediskaArray = [];\n          if (invoiceData.fa_strediska_kod) {\n            let parsed = [];\n            if (typeof invoiceData.fa_strediska_kod === 'string') {\n              try {\n                parsed = JSON.parse(invoiceData.fa_strediska_kod);\n              } catch (e) {\n                console.warn('Chyba pi parsovn stedisek:', e);\n              }\n            } else if (Array.isArray(invoiceData.fa_strediska_kod)) {\n              parsed = invoiceData.fa_strediska_kod;\n            }\n            \n            // MultiSelect oekv array STRING (values), ne objekt!\n            // Pouze ovit, e codes existuj v options\n            strediskaArray = parsed.map(item => {\n              // Pokud je to string, vrtit ho (to je sprvn formt)\n              if (typeof item === 'string') {\n                // Ovit, e existuje v options\n                const exists = strediskaOptions.find(opt => opt.value === item);\n                if (!exists) {\n                  console.warn(` Stedisko ${item} nen v options (neaktivn)`);\n                }\n                return item;\n              }\n              // Pokud je to objekt, extrahovat value\n              if (typeof item === 'object' && item.value) {\n                return item.value;\n              }\n              // Fallback\n              return item;\n            });\n          }\n          \n          const loadedFormData = {\n            order_id: invoiceData.objednavka_id || '',\n            smlouva_id: invoiceData.smlouva_id || null,\n            fa_cislo_vema: invoiceData.fa_cislo_vema || '',\n            fa_typ: invoiceData.fa_typ || 'BEZNA',\n            fa_datum_doruceni: formatDateForPicker(invoiceData.fa_datum_doruceni),\n            fa_datum_vystaveni: formatDateForPicker(invoiceData.fa_datum_vystaveni),\n            fa_datum_splatnosti: formatDateForPicker(invoiceData.fa_datum_splatnosti),\n            fa_castka: invoiceData.fa_castka || '',\n            fa_poznamka: invoiceData.fa_poznamka || '',\n            fa_strediska_kod: strediskaArray,\n            file: null, // Plohy se nenataj pi editaci\n            // Nov poloky\n            fa_predana_zam_id: invoiceData.fa_predana_zam_id || null,\n            fa_datum_predani_zam: formatDateForPicker(invoiceData.fa_datum_predani_zam),\n            fa_datum_vraceni_zam: formatDateForPicker(invoiceData.fa_datum_vraceni_zam),\n            // Vcn kontrola\n            vecna_spravnost_umisteni_majetku: invoiceData.vecna_spravnost_umisteni_majetku || '',\n            vecna_spravnost_poznamka: invoiceData.vecna_spravnost_poznamka || '',\n            vecna_spravnost_potvrzeno: invoiceData.vecna_spravnost_potvrzeno || 0,\n            potvrdil_vecnou_spravnost_id: invoiceData.potvrdil_vecnou_spravnost_id || null,\n            dt_potvrzeni_vecne_spravnosti: invoiceData.dt_potvrzeni_vecne_spravnosti || ''\n          };\n          \n          //  BATCH vechny setState operace najednou (mn re-render)\n          unstable_batchedUpdates(() => {\n            setFormData(loadedFormData);\n            // Uloit originln data pro detekci zmn\n            setOriginalFormData(loadedFormData);\n            \n            // Zapamatovat si, zda mla faktura pvodn piazenou objednvku nebo smlouvu\n            const hadEntity = !!(invoiceData.objednavka_id || invoiceData.smlouva_id);\n            setHadOriginalEntity(hadEntity);\n            localStorage.setItem('hadOriginalEntity', JSON.stringify(hadEntity));\n          });\n          \n          //  LP ERPN: Nast erpn LP pokud m objednvku (pedbn nateme, finln check bude a po loadOrderData)\n          if (invoiceData.objednavka_id) {\n            try {\n              const lpResponse = await getFakturaLPCerpani(editIdToLoad, token, username);\n              \n              //  Backend vrac: { status: \"ok\", data: { lp_cerpani: [...], suma, fa_castka } }\n              if (lpResponse && lpResponse.status === 'ok' && lpResponse.data && lpResponse.data.lp_cerpani) {\n                setLpCerpani(lpResponse.data.lp_cerpani);\n                setLpCerpaniLoaded(true);\n              } else {\n                setLpCerpani([]);\n                setLpCerpaniLoaded(true);\n              }\n            } catch (lpError) {\n              console.error(' Chyba pi natn LP erpn:', lpError);\n              // Nezastavujeme natn faktury - LP erpn je bonusov data\n              setLpCerpani([]);\n              setLpCerpaniLoaded(true);\n            }\n          }\n          \n          // Pokud je znma objednvka, nast ji a nastavit searchTerm\n          if (orderIdForLoad || invoiceData.objednavka_id) {\n            const orderIdToLoad = orderIdForLoad || invoiceData.objednavka_id;\n            await loadOrderData(orderIdToLoad);\n            \n            //  BATCH entity-related setState\n            unstable_batchedUpdates(() => {\n              setSelectedType('order');\n              // Nastavit searchTerm pokud mme slo objednvky\n              if (invoiceData.cislo_objednavky) {\n                setSearchTerm(invoiceData.cislo_objednavky);\n              }\n            });\n          }\n          // Pokud je znma smlouva, nast ji\n          else if (invoiceData.smlouva_id) {\n            await loadSmlouvaData(invoiceData.smlouva_id);\n            setSelectedType('smlouva');\n          }\n        }\n      } catch (err) {\n        console.error(' Chyba pi natn faktury:', err);\n        showToast?.(err.message || 'Chyba pi natn faktury', { type: 'error' });\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    // Spustit pokud existuje editInvoiceId v location.state NEBO v editingInvoiceId (z localStorage)\n    const editIdToLoad = location.state?.editInvoiceId || editingInvoiceId;\n    if (editIdToLoad && strediskaOptions.length > 0) {\n      loadInvoiceForEdit();\n    }\n  }, [location.state?.editInvoiceId, editingInvoiceId, token, username, strediskaOptions.length]); //  OPRAVENO: sledujeme .length msto celho pole\n\n  // Naten objednvky pi mount nebo zmn orderId\n  const loadOrderData = useCallback(async (orderIdToLoad) => {\n    if (!orderIdToLoad || !token || !username) {\n      return;\n    }\n\n    //  BATCH: Initial loading states\n    unstable_batchedUpdates(() => {\n      setOrderLoading(true);\n      setError(null);\n    });\n\n    try {\n      //  KROK 1: Zamknout objednvku pro editaci (pidvn faktur)\n      await lockOrderV2({ orderId: orderIdToLoad, token, username, force: false });\n\n      //  KROK 2: Nati pln data objednvky s enriched daty (faktury, poloky, atd.)\n      const orderData = await getOrderV2(orderIdToLoad, token, username, true);\n\n      if (orderData && orderData.id) {\n        //  BATCH: All success state updates together\n        unstable_batchedUpdates(() => {\n          setOrderData(orderData);\n          // Aktualizuj searchTerm aby zobrazoval pouze ev. slo\n          const evCislo = orderData.cislo_objednavky || orderData.evidencni_cislo || `#${orderData.id}`;\n          setSearchTerm(evCislo);\n        });\n      } else {\n        setError('Nepodailo se nast data objednvky');\n        // Odemkni pokud se naten nezdailo\n        await unlockOrderV2({ orderId: orderIdToLoad, token, username }).catch(e => console.warn(' Unlock failed:', e));\n      }\n    } catch (err) {\n      console.error(' Chyba pi natn objednvky:', err);\n      \n      //  Pokud je objednvka zamen (423), naviguj ZPT a zobraz toast\n      const is423Error = err?.response?.status === 423 || err?.message?.includes('423') || err?.message?.includes('zamen');\n      \n      if (is423Error) {\n        setError('Objednvka je zamen jinm uivatelem');\n        showToast && showToast('Objednvka je zamen jinm uivatelem', 'error');\n        setOrderLoading(false);\n        // Naviguj zpt na seznam faktur\n        setTimeout(() => {\n          navigate('/invoices25-list', { replace: true });\n        }, 1500);\n        return; //  Nevolat unlock - nen nae!\n      }\n      \n      setError(err.message || 'Chyba pi natn objednvky');\n      showToast && showToast(err.message || 'Chyba pi natn objednvky', 'error');\n      //  Odemkni POUZE pokud to NEN 423 (lock error)\n      if (!is423Error) {\n        await unlockOrderV2({ orderId: orderIdToLoad, token, username }).catch(e => console.warn(' Unlock failed:', e));\n      }\n    } finally {\n      setOrderLoading(false);\n    }\n  }, [token, username, showToast]);\n\n  const loadSmlouvaData = useCallback(async (smlouvaId) => {\n    if (!smlouvaId || !token || !username) {\n      return;\n    }\n\n    //  BATCH: Initial loading states\n    unstable_batchedUpdates(() => {\n      setOrderLoading(true); // Pouijeme stejn loading state\n      setError(null);\n    });\n\n    try {\n      const smlouvaData = await getSmlouvaDetail({ token, username, id: smlouvaId });\n\n      if (smlouvaData) {\n        // API vrac data v objektu { smlouva: {...}, objednavky: [], statistiky: {} }\n        // Potebujeme extrahovat jen st smlouva\n        const contract = smlouvaData.smlouva || smlouvaData;\n        \n        // Normalizace dat - penst vechna data + pidat cel response\n        const normalizedData = {\n          ...contract,\n          // Pidme objednavky a statistiky z root objektu\n          objednavky: smlouvaData.objednavky || [],\n          statistiky: smlouvaData.statistiky || {}\n        };\n        \n        //  BATCH: All success state updates together\n        unstable_batchedUpdates(() => {\n          setSmlouvaData(normalizedData);\n          setSelectedType('smlouva');\n        });\n        \n        // Aktualizuj formData s smlouva_id\n        setFormData(prev => ({\n          ...prev,\n          smlouva_id: normalizedData.id,\n          order_id: null // Vyistit objednvku pokud byla pedtm\n        }));\n        \n        // Aktualizuj searchTerm - slo smlouvy\n        const cislo = normalizedData.cislo_smlouvy || `#${normalizedData.id}`;\n        setSearchTerm(cislo);\n        \n        // Vyistit orderData\n        setOrderData(null);\n      } else {\n        setError('Nepodailo se nast data smlouvy - przdn odpov z API');\n        showToast && showToast('Nepodailo se nast data smlouvy', 'error');\n      }\n    } catch (err) {\n      console.error(' Chyba pi natn smlouvy:', err);\n      setError(err.message || 'Chyba pi natn smlouvy');\n      showToast && showToast(err.message || 'Chyba pi natn smlouvy', 'error');\n    } finally {\n      setOrderLoading(false);\n    }\n  }, [token, username, showToast]);\n\n  //  UNLOCK objednvky pi unmount komponenty (oputn strnky)\n  useEffect(() => {\n    return () => {\n      // Cleanup pi unmount - odemkni objednvku pokud byla zamen\n      if (formData.order_id && token && username) {\n        unlockOrderV2({ orderId: formData.order_id, token, username })\n          .catch(err => console.warn(' Nepodailo se odemknout objednvku:', err));\n      }\n    };\n  }, [formData.order_id, token, username]); // Aktuln hodnoty pro unlock\n\n  // Naten objednvky nebo smlouvy z location.state pi mount\n  useEffect(() => {\n    //  Pokud prv probh reset, nic nenatat\n    if (isResettingRef.current) {\n      return;\n    }\n    \n    const orderIdForLoad = location.state?.orderIdForLoad;\n    const smlouvaIdForLoad = location.state?.smlouvaIdForLoad;\n    const openMaterialCorrectness = location.state?.openMaterialCorrectness;\n\n    //  Pokud je pznak openMaterialCorrectness, otevi sekci vcn kontroly a scrollni na ni\n    if (openMaterialCorrectness) {\n      setSectionStates(prev => ({\n        ...prev,\n        materialCorrectness: true // Rozvinout sekci vcn kontroly\n      }));\n      \n      // Scroll na sekci vcn kontroly po malm delay (aby se stihla vyrenderovat)\n      setTimeout(() => {\n        const materialSection = document.querySelector('[data-section=\"material-correctness\"]');\n        if (materialSection) {\n          materialSection.scrollIntoView({ behavior: 'smooth', block: 'start' });\n        }\n      }, 300);\n    }\n\n    if (orderIdForLoad && token && username) {\n      //  Ped natenm zkontrolovat LOCK\n      (async () => {\n        try {\n          const orderCheck = await getOrderV2(orderIdForLoad, token, username, false);\n          \n          //  Blokuj pouze pokud locked=true A NEN mj zmek A NEN expired\n          if (orderCheck?.lock_info?.locked === true && !orderCheck?.lock_info?.is_owned_by_me && !orderCheck?.lock_info?.is_expired) {\n            const lockInfo = orderCheck.lock_info;\n            const lockedByUserName = lockInfo.locked_by_user_fullname || `uivatel #${lockInfo.locked_by_user_id}`;\n            \n            // Ulo info o zamen pro vizuln dialog\n            setLockedOrderInfo({\n              lockedByUserName,\n              lockedByUserEmail: lockInfo.locked_by_user_email || null,\n              lockedByUserTelefon: lockInfo.locked_by_user_telefon || null,\n              lockedAt: lockInfo.locked_at || null,\n              lockAgeMinutes: lockInfo.lock_age_minutes || null,\n              canForceUnlock: false,\n              orderId: orderIdForLoad\n            });\n            setShowLockedOrderDialog(true);\n            // Zstat na seznamu\n            setSelectedType('list');\n            return;\n          }\n          \n          //  Nen zamen - nast\n          loadOrderData(orderIdForLoad);\n          setSelectedType('order');\n          setFormData(prev => ({\n            ...prev,\n            order_id: orderIdForLoad,\n            smlouva_id: null\n          }));\n        } catch (err) {\n          console.warn(' Chyba pi kontrole LOCK:', err);\n          // I pi chyb zkusit nast\n          loadOrderData(orderIdForLoad);\n          setSelectedType('order');\n          setFormData(prev => ({\n            ...prev,\n            order_id: orderIdForLoad,\n            smlouva_id: null\n          }));\n        }\n      })();\n    } else if (smlouvaIdForLoad && token && username) {\n      // Nast smlouvu\n      loadSmlouvaData(smlouvaIdForLoad);\n      setSelectedType('smlouva');\n      setFormData(prev => ({\n        ...prev,\n        smlouva_id: smlouvaIdForLoad,\n        order_id: null\n      }));\n    }\n  }, [location.state?.orderIdForLoad, location.state?.smlouvaIdForLoad, token, username, loadOrderData, loadSmlouvaData]);\n\n  //  Auto-scroll na fakturu pi naten dat\n  const hasScrolledRef = useRef(false); //  NOV: Flag aby se scroll provedl jen jednou\n  \n  useEffect(() => {\n    //  Skip scrolling tijekom resetovanja  \n    if (isResettingRef.current) return;\n    \n    if (editingInvoiceId && orderData && !orderLoading && orderFormRef.current && !hasScrolledRef.current) {\n      // Rozbalit sekci faktur\n      orderFormRef.current.expandSectionByName?.('faktury');\n      \n      // Scroll na konkrtn fakturu\n      const facturaElement = document.querySelector(`[data-invoice-id=\"${editingInvoiceId}\"]`);\n      if (facturaElement) {\n        facturaElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        hasScrolledRef.current = true; //  Oznait jako hotov\n      }\n    }\n  }, [editingInvoiceId, orderData, orderLoading]);\n\n  // Search objednvek a smluv pro autocomplete\n  const searchEntities = useCallback(async (search) => {\n    //  universalSearch vyaduje min 3 znaky\n    if (!search || search.length < 3) {\n      setSuggestions([]);\n      return;\n    }\n\n    setIsSearching(true);\n    try {\n      const searchParams = {\n        query: search,\n        categories: ['orders_2025', 'contracts'], // Objednvky + Smlouvy\n        limit: 15,\n        archivovano: 0,\n        search_all: canViewAllOrders\n      };\n      \n      const response = await universalSearch(searchParams);\n\n      const orders = response?.categories?.orders_2025?.results || [];\n      const contracts = response?.categories?.contracts?.results || [];\n\n      // Filtruj objednvky - zobraz VECHNY odeslan/aktivn objednvky\n      const sentOrders = orders.filter(order => {\n        let stavKody = [];\n        try {\n          if (order.stav_kod) {\n            stavKody = JSON.parse(order.stav_kod);\n          }\n        } catch (e) {\n          // Ignorovat chyby parsovn\n        }\n        \n        const invalidStates = ['STORNOVANA', 'ZAMITNUTA'];\n        const hasInvalidState = stavKody.some(stav => invalidStates.includes(stav));\n        \n        if (hasInvalidState) {\n          return false;\n        }\n        \n        const validStates = ['ODESLANA', 'ODESLANO', 'POTVRZENA', 'NEUVEREJNIT', 'FAKTURACE', 'VECNA_SPRAVNOST', 'ZKONTROLOVANA', 'DOKONCENA'];\n        const hasValidState = stavKody.some(stav => validStates.includes(stav));\n        \n        if (!hasValidState) {\n          return false;\n        }\n\n        return canViewAllOrders || true;\n      });\n\n      // Filtruj smlouvy - pouze aktivn\n      const activeContracts = contracts.filter(contract => contract.aktivni === 1);\n\n      // Kombinuj vsledky s oznaenm typu\n      const combinedResults = [\n        ...sentOrders.map(order => ({ ...order, _type: 'order' })),\n        ...activeContracts.map(contract => ({ ...contract, _type: 'smlouva' }))\n      ];\n\n      setSuggestions(combinedResults);\n      setShowSuggestions(true);\n    } catch (err) {\n      setSuggestions([]);\n    } finally {\n      setIsSearching(false);\n    }\n  }, [canViewAllOrders]);\n\n  // Debounced search pi psan (jen kdy jsou suggestions oteven)\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (searchTerm && showSuggestions) {\n        searchEntities(searchTerm);\n      }\n    }, 300);\n\n    return () => clearTimeout(timer);\n  }, [searchTerm, showSuggestions]); //  OPRAVENO: Odstranit searchEntities z dependencies\n\n  //  OPTIMALIZOVNO: Natn objednvky je eeno v useEffect pro location.state (dky 2148-2297)\n  // Duplicitn useEffecty byly odstranny\n\n  // Effect: Zavt dropdown pi kliknut mimo\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (!e.target.closest('.autocomplete-wrapper')) {\n        setShowSuggestions(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Effect: Nast poet faktur ze spisovky za dnen den (pro badge) a poslednch 5 zznam (pro tooltip)\n  useEffect(() => {\n    if (!hasPermission('ADMIN')) return;\n\n    const fetchSpisovkaData = async () => {\n      try {\n        // Fetch count\n        const countUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/count-today`;\n        const countResponse = await fetch(countUrl);\n        if (countResponse.ok) {\n          const countData = await countResponse.json();\n          if (countData.status === 'success') {\n            setSpisovkaTodayCount(countData.count);\n          }\n        }\n\n        // Fetch last 5 records\n        const faktoryUrl = `${process.env.REACT_APP_API2_BASE_URL}spisovka.php/faktury?limit=5&offset=0&rok=2025`;\n        const faktoryResponse = await fetch(faktoryUrl);\n        if (faktoryResponse.ok) {\n          const faktoryData = await faktoryResponse.json();\n          if (faktoryData.status === 'success') {\n            setSpisovkaLastRecords(faktoryData.data);\n          }\n        }\n      } catch (error) {\n        console.error('Chyba pi natn dat ze spisovky:', error);\n      }\n    };\n\n    // Initial fetch\n    fetchSpisovkaData();\n\n    // Refresh every 5 minutes\n    const interval = setInterval(fetchSpisovkaData, 5 * 60 * 1000);\n    return () => clearInterval(interval);\n  }, []); //  OPRAVENO: Pouze [] - hasPermission se kontroluje uvnit\n\n  // Handler: zmna inputu\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  // Handler: zmna search inputu pro autocomplete\n  const handleSearchChange = (e) => {\n    const value = e.target.value;\n    setSearchTerm(value);\n    setShowSuggestions(true);\n    \n    // Pokud uivatel mn text, vymaeme order_id a orderData\n    // aby se nemohlo stt, e bude vyplnn nevalidn text s validnm order_id\n    if (value !== searchTerm) {\n      setFormData(prev => ({ ...prev, order_id: '' }));\n      setOrderData(null);\n    }\n  };\n\n  // Handler: odemen entity (zmna OBJ/SML u existujc FA)\n  const handleUnlockEntity = () => {\n    setConfirmDialog({\n      isOpen: true,\n      title: ' Zmna objednvky/smlouvy',\n      message: (\n        <div style={{ lineHeight: '1.6' }}>\n          <p style={{ marginBottom: '1rem', fontWeight: 600 }}>\n            Opravdu chcete zmnit piazen faktury k jin objednvce nebo smlouv?\n          </p>\n          <div style={{ background: '#fef3c7', border: '2px solid #f59e0b', borderRadius: '8px', padding: '1rem', marginBottom: '1rem' }}>\n            <strong style={{ color: '#92400e' }}> VAROVN - Mon dopady:</strong>\n            <ul style={{ margin: '0.5rem 0 0 1.25rem', color: '#78350f' }}>\n              <li>Pvodn objednvka me bt vrcena na <strong>vcnou sprvnost</strong></li>\n              <li>Me dojt ke zmn <strong>workflow stavu</strong> objednvky</li>\n              <li>stka faktury ovlivn <strong>erpn rozpotu</strong> nov entity</li>\n              <li>Historie a notifikace budou navzny na novou entitu</li>\n            </ul>\n          </div>\n          <p style={{ fontSize: '0.9rem', color: '#6b7280' }}>\n            Po odemen budete moci vybrat jinou objednvku nebo smlouvu.\n          </p>\n        </div>\n      ),\n      onConfirm: () => {\n        setIsEntityUnlocked(true);\n        setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n      },\n      onCancel: () => {\n        setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n      }\n    });\n  };\n\n  // Handler: vymazn hledn objednvky\n  const handleClearSearch = () => {\n    setSearchTerm('');\n    setSuggestions([]);\n    setShowSuggestions(false);\n    setFormData(prev => ({ ...prev, order_id: '', smlouva_id: null }));\n    setOrderData(null);\n    setSmlouvaData(null);\n    setSelectedType('order'); // Reset na vchoz\n  };\n\n  // Handler: vbr objednvky z autocomplete\n  const handleSelectOrder = async (order) => {\n    const evCislo = order.cislo_objednavky || order.evidencni_cislo || `#${order.id}`;\n    \n    //  KONTROLA 1: Je tat objednvka oteven na formuli? (draft v localStorage)\n    draftManager.setCurrentUser(user_id);\n    const existingDraft = await draftManager.loadDraft();\n\n    if (existingDraft && existingDraft.formData && parseInt(existingDraft.formData.id) === parseInt(order.id)) {\n      const draftEvCislo = existingDraft.formData.cislo_objednavky || existingDraft.formData.evidencni_cislo || `#${order.id}`;\n      \n      // Zobraz dialog\n      setConfirmDialog({\n        isOpen: true,\n        title: ' Objednvka je oteven na formuli',\n        message: `Objednvka ${draftEvCislo} je prv oteven v editanm formuli.\\n\\n NEJDVE JI ZAVETE!\\n\\nTeprve pot mete pidvat nebo aktualizovat faktury.`,\n        onConfirm: () => {\n          setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n        },\n        onCancel: null\n      });\n      return;\n    }\n\n    //  KONTROLA 2: Je objednvka zamen jinm uivatelem?\n    setOrderLoading(true);\n    try {\n      const orderCheck = await getOrderV2(order.id, token, username, false); // false = bez enriched dat\n      \n      //  Blokuj pouze pokud locked=true A NEN mj zmek A NEN expired\n      if (orderCheck?.lock_info?.locked === true && !orderCheck?.lock_info?.is_owned_by_me && !orderCheck?.lock_info?.is_expired) {\n        const lockInfo = orderCheck.lock_info;\n        const lockedByUserName = lockInfo.locked_by_user_fullname || `uivatel #${lockInfo.locked_by_user_id}`;\n\n        setOrderLoading(false);\n        \n        // Ulo info o zamen pro vizuln dialog\n        setLockedOrderInfo({\n          lockedByUserName,\n          lockedByUserEmail: lockInfo.locked_by_user_email || null,\n          lockedByUserTelefon: lockInfo.locked_by_user_telefon || null,\n          lockedAt: lockInfo.locked_at || null,\n          lockAgeMinutes: lockInfo.lock_age_minutes || null,\n          canForceUnlock: false,\n          orderId: order.id\n        });\n        setShowLockedOrderDialog(true);\n        return;\n      }\n    } catch (err) {\n      console.warn(' Nepodailo se zkontrolovat lock status:', err);\n    } finally {\n      setOrderLoading(false);\n    }\n\n    //  VE OK - pokrauj s natenm\n    await proceedWithOrderLoad(order, evCislo);\n  };\n\n  // Helper funkce pro naten objednvky\n  const proceedWithOrderLoad = async (order, evCislo) => {\n    //  KONTROLA LOCK ped natenm\n    setOrderLoading(true);\n    try {\n      const orderCheck = await getOrderV2(order.id, token, username, false);\n      \n      //  Blokuj pouze pokud locked=true A NEN mj zmek A NEN expired\n      if (orderCheck?.lock_info?.locked === true && !orderCheck?.lock_info?.is_owned_by_me && !orderCheck?.lock_info?.is_expired) {\n        const lockInfo = orderCheck.lock_info;\n        const lockedByUserName = lockInfo.locked_by_user_fullname || `uivatel #${lockInfo.locked_by_user_id}`;\n\n        setOrderLoading(false);\n        \n        // Ulo info o zamen pro vizuln dialog\n        setLockedOrderInfo({\n          lockedByUserName,\n          lockedByUserEmail: lockInfo.locked_by_user_email || null,\n          lockedByUserTelefon: lockInfo.locked_by_user_telefon || null,\n          lockedAt: lockInfo.locked_at || null,\n          lockAgeMinutes: lockInfo.lock_age_minutes || null,\n          canForceUnlock: false,\n          orderId: order.id\n        });\n        setShowLockedOrderDialog(true);\n        return;\n      }\n    } catch (err) {\n      console.warn(' Nepodailo se zkontrolovat lock status:', err);\n    } finally {\n      setOrderLoading(false);\n    }\n    \n    //  Nen zamen - pokrauj s natenm\n    setFormData(prev => ({\n      ...prev,\n      order_id: order.id,\n      smlouva_id: null\n    }));\n    setSearchTerm(evCislo);\n    setShowSuggestions(false);\n    setSelectedType('order');\n    setSmlouvaData(null);\n    \n    localStorage.setItem('activeOrderEditId', order.id);\n    \n    loadOrderData(order.id);\n  };\n\n  // Handler: editace faktury - nate fakturu do formule\n  const handleEditInvoice = useCallback((faktura) => {\n    //  Kontrola stavu objednvky - nelze editovat fakturu u objednvky v nevhodnm stavu\n    if (orderData) {\n      const invoiceCheck = canAddInvoiceToOrder(orderData);\n      if (!invoiceCheck.allowed) {\n        showToast && showToast(` ${invoiceCheck.reason}`, 'error');\n        return;\n      }\n    }\n\n    setFormData({\n      order_id: faktura.objednavka_id || '',\n      smlouva_id: faktura.smlouva_id || null,\n      fa_cislo_vema: faktura.fa_cislo_vema || '',\n      fa_typ: faktura.fa_typ || 'BEZNA',\n      fa_datum_vystaveni: faktura.fa_datum_vystaveni || '',\n      fa_datum_splatnosti: faktura.fa_datum_splatnosti || '',\n      fa_datum_doruceni: faktura.fa_datum_doruceni || '',\n      fa_castka: faktura.fa_castka || '',\n      fa_variabilni_symbol: faktura.fa_variabilni_symbol || '',\n      fa_poznamka: faktura.fa_poznamka || '',\n      fa_predana_zam_id: faktura.fa_predana_zam_id || null,\n      fa_datum_predani_zam: faktura.fa_datum_predani_zam || '',\n      fa_datum_vraceni_zam: faktura.fa_datum_vraceni_zam || '',\n      file: null,\n      invoice_id: faktura.id // Ulome ID faktury pro update msto create\n    });\n    \n    setEditingInvoiceId(faktura.id);\n    \n    \n    //  Pi naten existujc faktury pro editaci nastavit flag na true\n    setInvoiceUserConfirmed(true);\n    \n    // Nastavit hadOriginalEntity podle toho, jestli m faktura piazenou objednvku nebo smlouvu\n    const hadEntity = !!(faktura.objednavka_id || faktura.smlouva_id);\n    setHadOriginalEntity(hadEntity);\n    localStorage.setItem('hadOriginalEntity', JSON.stringify(hadEntity));\n\n    // Scroll na zatek formule\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n    \n    showToast && showToast(' Faktura natena pro pravu', 'info');\n  }, [showToast, orderData, canAddInvoiceToOrder]);\n\n  //  Handler: zmna ploh (controlled component pattern)\n  const handleAttachmentsChange = useCallback((updater) => {\n    //  Sprvn zpracovat funkn updater (jako setAttachments)\n    setAttachments(prev => {\n      // Pokud je updater funkce, zavolat ji s pedchozm stavem\n      const newAttachments = typeof updater === 'function' ? updater(prev) : updater;\n      \n      //  Pi pidn prvnho attachmentu zkontrolovat Spisovka metadata a uloit je\n      // DLEIT: Uloit JEN kdy:\n      // 1. Je attachment ze Spisovky (m metadata)\n      // 2. Jet nebyl uploadovn (!serverId = lokln soubor)\n      // 3. Ref je przdn (metadata jet nebyla uloena)\n      if (newAttachments && newAttachments.length > 0 && !pendingSpisovkaMetadataRef.current) {\n        const firstAttachment = newAttachments[0];\n        \n        //  Guard: Zkontrolovat, e firstAttachment existuje a nen undefined\n        if (firstAttachment) {\n          // Uloit metadata JEN pro lokln soubory (ped uploadem)\n          if (firstAttachment.spisovka_dokument_id && \n              firstAttachment.spisovka_file_id && \n              !firstAttachment.serverId) {\n            pendingSpisovkaMetadataRef.current = {\n              dokument_id: firstAttachment.spisovka_dokument_id,\n              spisovka_priloha_id: firstAttachment.spisovka_file_id,\n              filename: firstAttachment.name\n            };\n            \n            //  Oznait v localStorage, e s tmto dokumentem pracuji\n            localStorage.setItem('spisovka_active_dokument', firstAttachment.spisovka_dokument_id);\n          }\n        }\n      }\n      \n      return newAttachments;\n    });\n  }, []);\n\n  //  Handler: pi smazn plohy - vyistit pending metadata\n  const handleAttachmentRemoved = useCallback((removedAttachment) => {\n    //  Guard: Zkontrolovat, e removedAttachment existuje\n    if (!removedAttachment) {\n      console.warn(' handleAttachmentRemoved: removedAttachment je undefined');\n      return;\n    }\n\n    // Pokud byla ploha ze Spisovky a jet nebyla uloena do DB, vyistit metadata\n    if (pendingSpisovkaMetadataRef.current) {\n      const metadata = pendingSpisovkaMetadataRef.current;\n      \n      // Zkontrolovat, jestli mazan soubor odpovd pending metadata\n      if (removedAttachment.spisovka_dokument_id === metadata.dokument_id ||\n          removedAttachment.spisovka_file_id === metadata.spisovka_priloha_id) {\n        \n        pendingSpisovkaMetadataRef.current = null;\n        // Vyistit aktivn dokument z localStorage\n        localStorage.removeItem('spisovka_active_dokument');\n      }\n    } else {\n      //  dn pending metadata - vyistit localStorage pro jistotu\n      if (removedAttachment.spisovka_dokument_id) {\n        localStorage.removeItem('spisovka_active_dokument');\n      }\n    }\n  }, []);\n\n  //  Handler: Spisovka dokument conflict - uivatel rozhodne, zda pidat duplikt\n  const handleSpisovkaConflict = useCallback(async (metadata, fakturaId, existingRecord) => {\n    return new Promise((resolve) => {\n      const message = (\n        <div style={{ fontFamily: 'system-ui', lineHeight: '1.6' }}>\n          <p style={{ marginBottom: '12px', fontWeight: 600 }}>\n            Tento dokument ze Spisovky ji byl dve zaevidovn:\n          </p>\n          {existingRecord && (\n            <div style={{\n              padding: '12px',\n              backgroundColor: '#fef3c7',\n              borderRadius: '6px',\n              fontSize: '13px',\n              marginBottom: '12px'\n            }}>\n              <div><strong>Faktura:</strong> {existingRecord.fa_cislo_vema || existingRecord.faktura_id}</div>\n              <div><strong>Datum:</strong> {existingRecord.zpracovano_kdy ? new Date(existingRecord.zpracovano_kdy).toLocaleString('cs-CZ') : 'N/A'}</div>\n              <div><strong>Uivatel:</strong> {existingRecord.uzivatel_id}</div>\n            </div>\n          )}\n          <p style={{ marginBottom: '8px' }}>\n            Chcete pesto pidat tuto plohu k nov faktue?\n          </p>\n          <p style={{ fontSize: '12px', color: '#78716c', marginTop: '8px' }}>\n             Vytvo se duplicitn zznam v trackingu.\n          </p>\n        </div>\n      );\n\n      setConfirmDialog({\n        isOpen: true,\n        title: ' Dokument ji evidovn',\n        message,\n        onConfirm: async () => {\n          // Uivatel potvrdil - force tracking\n          try {\n            const result = await markSpisovkaDocumentProcessed({\n              username,\n              token,\n              dokument_id: metadata.dokument_id,\n              spisovka_priloha_id: metadata.spisovka_priloha_id,\n              faktura_id: fakturaId,\n              fa_cislo_vema: formData.fa_cislo_vema,\n              stav: 'ZAEVIDOVANO',\n              poznamka: `DUPLICITA - Auto-tracking: Ploha ze Spisovky (file_id: ${metadata.spisovka_priloha_id})`,\n              force: true //  Vynucen duplicity\n            });\n\n            if (result.success) {\n              showToast && showToast(' Ploha pidna (duplicitn zznam vytvoen)', { type: 'success' });\n            } else {\n              console.warn(' Force tracking se nezdail:', result);\n            }\n          } catch (err) {\n            console.error(' Force tracking error:', err);\n          }\n          setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n          resolve(true);\n        },\n        onCancel: () => {\n          setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n          resolve(false);\n        }\n      });\n    });\n  }, [username, token, formData.fa_cislo_vema, setConfirmDialog, showToast]);\n\n  //  Helper ref pro stabiln referenci na fa_cislo_vema v callbacku\n  const faCisloVemaRef = useRef(formData.fa_cislo_vema);\n  useEffect(() => {\n    faCisloVemaRef.current = formData.fa_cislo_vema;\n  }, [formData.fa_cislo_vema]);\n\n  //  Handler: po spnm uploadu plohy - vol se z InvoiceAttachmentsCompact\n  const handleAttachmentUploaded = useCallback(async (fakturaId, uploadedAttachment) => {\n    // Guard: Pokud nen fakturaId, nen co trackovat\n    if (!fakturaId) {\n      return;\n    }\n    \n    //  SPISOVKA TRACKING: Oznait dokument jako zpracovan (po uploadu plohy)\n    try {\n      const metadata = pendingSpisovkaMetadataRef.current;\n      \n      if (metadata) {\n        const result = await markSpisovkaDocumentProcessed({\n          username,\n          token,\n          dokument_id: metadata.dokument_id,\n          spisovka_priloha_id: metadata.spisovka_priloha_id,\n          faktura_id: fakturaId,\n          fa_cislo_vema: faCisloVemaRef.current, //  OPRAVENO: Pouvme ref namsto pm zvislosti\n          stav: 'ZAEVIDOVANO',\n          poznamka: `Auto-tracking: Ploha ze Spisovky (file_id: ${metadata.spisovka_priloha_id})`,\n          force: false // Prvn pokus bez force\n        });\n        \n        //  Kontrola vsledku\n        if (result.success) {\n          // Vyistit metadata po spnm zpisu\n          pendingSpisovkaMetadataRef.current = null;\n          //  NEvyiovat LS zde - uivatel me pidat dal plohy ze stejn faktury\n          // LS se vyist pi opoutn strnky nebo pi reset formu\n        } else if (result.conflict) {\n          //  CONFLICT - zobrazit dialog uivateli\n          console.warn(' Conflict detekovn:', result);\n          await handleSpisovkaConflict(metadata, fakturaId, result.existingRecord);\n          // Vyistit metadata i po confliktu (dialog u byl zobrazen)\n          pendingSpisovkaMetadataRef.current = null;\n          //  NEvyiovat LS - uivatel me pidat dal plohy\n        }\n      } else {\n        // Pokud nen metadata - nic se ned\n      }\n    } catch (spisovkaErr) {\n      console.error(' Nepodailo se oznait Spisovka dokument jako zpracovan:', spisovkaErr);\n      // Vyistit metadata i pi chyb\n      pendingSpisovkaMetadataRef.current = null;\n      //  Pi chyb vyistit LS - uivatel mus zat znovu\n      localStorage.removeItem('spisovka_active_dokument');\n    }\n  }, [username, token, handleSpisovkaConflict]); //  OPRAVENO: formData.fa_cislo_vema odstranno z dependencies\n\n  //  Validace faktury ped uploadem ploh (podle vzoru OrderForm25)\n  // Parametr: faktura objekt (ne file!) - obsahuje data faktury pro validaci\n  // Parametr: file (optional) - soubor pro kontrolu ISDOC\n  const validateInvoiceForAttachments = useCallback((faktura, file) => {\n    // Pro editaci existujc faktury - povolit upload bez omezen\n    if (editingInvoiceId) {\n      return {\n        isValid: true,\n        isISDOC: false,\n        categories: {}\n      };\n    }\n    \n    // Pokud je file ISDOC, povolit upload i bez vyplnnch pol\n    const isISDOC = file && file.name && file.name.toLowerCase().endsWith('.isdoc');\n    \n    if (isISDOC) {\n      // ISDOC soubor - povolit upload, data se vyt z ISDOC\n      return {\n        isValid: true,\n        isISDOC: true,\n        categories: {}\n      };\n    }\n    \n    // Bn soubory (PDF, JPG...) - kontrolovat povinn pole faktury\n    const categories = {\n      objednateli: {\n        label: 'Informace o objednateli',\n        errors: []\n      },\n      schvaleni: {\n        label: 'Schvlen nkupu PO',\n        errors: []\n      }\n    };\n    \n    // Kategorie: Informace o objednateli\n    if (!faktura?.fa_cislo_vema) categories.objednateli.errors.push('slo faktury');\n    if (!faktura?.fa_datum_splatnosti) categories.objednateli.errors.push('Datum splatnosti');\n    if (!faktura?.fa_castka) categories.objednateli.errors.push('stka');\n    \n    // Kategorie: Schvlen nkupu PO (przdn pro faktury - pouze pro objednvky)\n    // categories.schvaleni.errors zde zstv przdn\n    \n    const allErrors = [...categories.objednateli.errors, ...categories.schvaleni.errors];\n    \n    return {\n      isValid: allErrors.length === 0,\n      isISDOC: false,\n      categories\n    };\n  }, [editingInvoiceId]);\n\n  //  Handler: Vytvoen faktury v DB (pro temp faktury ped uploadem plohy)\n  const handleCreateInvoiceInDB = useCallback(async (tempFakturaId) => {\n    try {\n      const apiParams = {\n        token,\n        username,\n        order_id: formData.order_id || null,\n        smlouva_id: formData.smlouva_id || null,\n        fa_cislo_vema: formData.fa_cislo_vema,\n        fa_typ: formData.fa_typ || 'BEZNA',\n        fa_datum_vystaveni: formData.fa_datum_vystaveni,\n        fa_datum_splatnosti: formData.fa_datum_splatnosti || null,\n        fa_datum_doruceni: formData.fa_datum_doruceni || null,\n        fa_castka: formData.fa_castka,\n        fa_poznamka: formData.fa_poznamka || '',\n        fa_dorucena: formData.fa_datum_doruceni ? 1 : 0,\n        fa_strediska_kod: JSON.stringify(formData.fa_strediska_kod || []),\n        fa_predana_zam_id: formData.fa_predana_zam_id || null,\n        fa_datum_predani_zam: formData.fa_datum_predani_zam || null,\n        fa_datum_vraceni_zam: formData.fa_datum_vraceni_zam || null\n      };\n\n      // Vytvo fakturu bez plohy\n      const result = await createInvoiceV2(apiParams);\n      \n      // API vrac {status: 'ok', data: {invoice_id: 89}}\n      const newInvoiceId = result?.data?.invoice_id || result?.invoice_id || result?.id;\n      \n      if (!newInvoiceId) {\n        console.error(' Neplatn result z createInvoiceV2:', result);\n        throw new Error('Nepodailo se vytvoit fakturu v DB - backend nevrtil ID');\n      }\n\n      // Nastav editingInvoiceId, aby se dal plohy uploadovaly k tto faktue\n      setEditingInvoiceId(newInvoiceId);\n      \n      //  Nastav hadOriginalEntity podle toho, zda m faktura objednvku/smlouvu\n      // Tm zajistme, e tlatko bude \"Aktualizovat\" msto \"Piadit\"\n      if (formData.order_id || formData.smlouva_id) {\n        setHadOriginalEntity(true);\n      }\n      \n      //  Refresh nhledu objednvky/smlouvy - aby se FA zobrazila v seznamu\n      if (formData.order_id && orderData) {\n        await loadOrderData(formData.order_id);\n      }\n      if (formData.smlouva_id && smlouvaData) {\n        await loadSmlouvaData(formData.smlouva_id);\n      }\n\n      return newInvoiceId;\n    } catch (error) {\n      console.error(' Chyba pi vytven faktury v DB:', error);\n      throw error;\n    }\n  }, [token, username, formData]);\n\n  //  Handler: ISDOC parsing - vyplnn faktury z ISDOC souboru\n  const handleISDOCParsed = useCallback((isdocData, isdocSummary) => {\n    try {\n      // Mapovn ISDOC dat na fakturu\n      const mappedData = mapISDOCToFaktura(isdocData, {\n        strediska: strediskaOptions,\n        // Pokud je piazena objednvka, pouij jej stediska\n        orderStrediska: orderData?.strediska_kod || formData.fa_strediska_kod\n      });\n\n      // Aktualizuj formData s daty z ISDOC\n      setFormData(prev => ({\n        ...prev,\n        fa_cislo_vema: mappedData.fa_cislo_vema || prev.fa_cislo_vema,\n        fa_datum_vystaveni: mappedData.fa_datum_vystaveni || prev.fa_datum_vystaveni,\n        fa_datum_splatnosti: mappedData.fa_datum_splatnosti || prev.fa_datum_splatnosti,\n        fa_castka: mappedData.fa_castka || prev.fa_castka,\n        fa_strediska_kod: mappedData.fa_strediska_kod || prev.fa_strediska_kod,\n        fa_poznamka: mappedData.fa_poznamka || prev.fa_poznamka\n      }));\n\n      showToast && showToast(\n        ` Data z ISDOC byla spn natena\\n\\nslo faktury: ${mappedData.fa_cislo_vema}\\nstka: ${mappedData.fa_castka} K`,\n        { type: 'success' }\n      );\n    } catch (error) {\n      console.error(' Chyba pi zpracovn ISDOC:', error);\n      showToast && showToast(\n        `Chyba pi zpracovn ISDOC: ${error.message}`,\n        { type: 'error' }\n      );\n    }\n  }, [formData, orderData, strediskaOptions, showToast]);\n\n  //  OCR Callback - Vypln data z OCR do formule\n  const handleOCRDataExtracted = useCallback((ocrData) => {\n    try {\n      // Aktualizuj formData s daty z OCR\n      setFormData(prev => {\n        const updates = {};\n        \n        // Variabiln symbol -> fa_cislo_vema\n        if (ocrData.variabilniSymbol) {\n          updates.fa_cislo_vema = ocrData.variabilniSymbol;\n        }\n        \n        // Datum vystaven\n        if (ocrData.datumVystaveni) {\n          updates.fa_datum_vystaveni = ocrData.datumVystaveni;\n        }\n        \n        // Datum splatnosti\n        if (ocrData.datumSplatnosti) {\n          updates.fa_datum_splatnosti = ocrData.datumSplatnosti;\n        }\n        \n        // stka\n        if (ocrData.castka) {\n          updates.fa_castka = ocrData.castka;\n        }\n        \n        //  SPISOVKA METADATA pro automatick tracking\n        // Pidat Spisovka metadata do file objektu (pokud existuj)\n        if (ocrData.spisovka_dokument_id && ocrData.spisovka_priloha_id && prev.file) {\n          updates.file = {\n            ...prev.file,\n            spisovka_dokument_id: ocrData.spisovka_dokument_id,\n            spisovka_file_id: ocrData.spisovka_priloha_id\n          };\n        }\n        \n        return {\n          ...prev,\n          ...updates\n        };\n      });\n      \n    } catch (error) {\n      console.error(' Chyba pi aplikaci OCR dat:', error);\n      showToast && showToast(\n        `Chyba pi aplikaci OCR dat: ${error.message}`,\n        { type: 'error' }\n      );\n    }\n  }, [showToast]);\n\n  //  Funkce pro odesln notifikac pi zmn stavu objednvky na vcnou kontrolu\n  //  AKTUALIZOVNO: Pouv organizan hierarchii msto runho vbru pjemc\n  const sendInvoiceNotifications = async (orderId, orderData) => {\n    try {\n      //  NOV SYSTM: Pouit organizan hierarchie\n      // Backend automaticky najde sprvn pjemce podle hierarchie a notification profiles\n      // Podporuje generick pjemce (OBJEDNATEL, GARANT, SCHVALOVATEL_1, SCHVALOVATEL_2, ...)\n      const result = await notificationService.trigger(\n        'ORDER_MATERIAL_CORRECTNESS', // Event type code pro vcnou sprvnost\n        orderId,\n        user_id // ID uivatele, kter vytvoil/piadil fakturu\n      );\n\n      if (result.errors && result.errors.length > 0) {\n        console.warn(' Nkter notifikace se nepodailo odeslat:', result.errors);\n      }\n\n    } catch (error) {\n      console.error(' Chyba pi odesln notifikac:', error);\n      console.error('   Error message:', error.message);\n      console.error('   Error details:', error.response?.data);\n      // Neblokujeme workflow kvli chyb notifikace\n    }\n  };\n\n  // ============================================================\n  // SPISOVKA INBOX PANEL - Drag handling\n  // ============================================================\n  const handleSpisovkaInboxDrag = useCallback((e, key, dir) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    const startX = e.clientX;\n    const startY = e.clientY;\n    const startState = { ...spisovkaInboxState };\n\n    const onMove = (moveEvent) => {\n      const dx = moveEvent.clientX - startX;\n      const dy = moveEvent.clientY - startY;\n\n      setSpisovkaInboxState(prev => {\n        let newState = { ...prev };\n        const minW = 620; // Minimln ka aby se vela vechna tlatka v hlavice (rok + 5 period tlatek + 3 filtry)\n        const minH = 400; // Minimln vka pro zobrazen alespo 2 faktury\n\n        if (dir === 'move') {\n          newState.x = Math.max(0, Math.min(startState.x + dx, window.innerWidth - prev.w));\n          newState.y = Math.max(0, Math.min(startState.y + dy, window.innerHeight - prev.h));\n        } \n        // Prav hrana\n        else if (dir === 'right') {\n          newState.w = Math.max(minW, startState.w + dx);\n        } \n        // Lev hrana\n        else if (dir === 'left') {\n          const newW = Math.max(minW, startState.w - dx);\n          if (newW > minW) {\n            newState.w = newW;\n            newState.x = startState.x + dx;\n          }\n        } \n        // Horn hrana\n        else if (dir === 'top') {\n          const newH = Math.max(minH, startState.h - dy);\n          if (newH > minH) {\n            newState.h = newH;\n            newState.y = startState.y + dy;\n          }\n        } \n        // Doln hrana\n        else if (dir === 'bottom') {\n          newState.h = Math.max(minH, startState.h + dy);\n        } \n        // Rohy\n        else if (dir === 'top-left') {\n          const newW = Math.max(minW, startState.w - dx);\n          const newH = Math.max(minH, startState.h - dy);\n          if (newW > minW) {\n            newState.w = newW;\n            newState.x = startState.x + dx;\n          }\n          if (newH > minH) {\n            newState.h = newH;\n            newState.y = startState.y + dy;\n          }\n        } \n        else if (dir === 'top-right') {\n          const newH = Math.max(minH, startState.h - dy);\n          newState.w = Math.max(minW, startState.w + dx);\n          if (newH > minH) {\n            newState.h = newH;\n            newState.y = startState.y + dy;\n          }\n        } \n        else if (dir === 'bottom-left') {\n          const newW = Math.max(minW, startState.w - dx);\n          newState.h = Math.max(minH, startState.h + dy);\n          if (newW > minW) {\n            newState.w = newW;\n            newState.x = startState.x + dx;\n          }\n        } \n        else if (dir === 'bottom-right') {\n          newState.w = Math.max(minW, startState.w + dx);\n          newState.h = Math.max(minH, startState.h + dy);\n        }\n\n        return newState;\n      });\n    };\n\n    const onUp = () => {\n      document.removeEventListener('mousemove', onMove);\n      document.removeEventListener('mouseup', onUp);\n    };\n\n    document.addEventListener('mousemove', onMove);\n    document.addEventListener('mouseup', onUp);\n  }, [spisovkaInboxState]);\n\n  // Handler: UPDATE vcn kontroly (partial update)\n  const handleUpdateMaterialCorrectness = async () => {\n    if (!editingInvoiceId) {\n      showToast && showToast('Chyba: Nen vybrna faktura k aktualizaci', 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Validace - checkbox mus bt zakrtnut\n      if (formData.vecna_spravnost_potvrzeno !== 1) {\n        showToast && showToast('Zakrtnte polko \"Potvrzuji vcnou sprvnost faktury\"', 'error');\n        setLoading(false);\n        return;\n      }\n\n      //  Validace LP erpn pro LP financovn\n      if (orderData && orderData.financovani) {\n        try {\n          const fin = typeof orderData.financovani === 'string' \n            ? JSON.parse(orderData.financovani) \n            : orderData.financovani;\n          \n          if (fin.typ === 'LP') {\n            if (!lpCerpani || lpCerpani.length === 0 || lpCerpani.every(lp => !lp.lp_cislo || lp.castka <= 0)) {\n              showToast && showToast(' Objednvka je financovna z LP. Muste piadit alespo jeden LP kd!', 'error');\n              setLoading(false);\n              return;\n            }\n\n            const totalLP = lpCerpani.reduce((sum, lp) => sum + (parseFloat(lp.castka) || 0), 0);\n            const faCastka = parseFloat(formData.fa_castka) || 0;\n            if (totalLP > faCastka) {\n              showToast && showToast(` Souet LP erpn pekrauje stku faktury`, 'error');\n              setLoading(false);\n              return;\n            }\n          }\n        } catch (e) {\n          console.error('Chyba pi validaci LP:', e);\n        }\n      }\n\n      // Validace - poznmka je POVINN pokud faktura pekrauje MAX cenu\n      if (orderData && orderData.max_cena_s_dph && formData.fa_castka) {\n        const maxCena = parseFloat(orderData.max_cena_s_dph) || 0;\n        const fakturaCastka = parseFloat(formData.fa_castka) || 0;\n        if (fakturaCastka > maxCena && (!formData.vecna_spravnost_poznamka || formData.vecna_spravnost_poznamka.trim() === '')) {\n          showToast && showToast('Vysvtlete v poznmce, pro faktura pekrauje max. cenu objednvky', 'error');\n          setLoading(false);\n          return;\n        }\n      }\n\n      // Partial update - pouze pole vcn kontroly\n      const updateData = {\n        vecna_spravnost_umisteni_majetku: formData.vecna_spravnost_umisteni_majetku || '',\n        vecna_spravnost_poznamka: formData.vecna_spravnost_poznamka || '',\n        vecna_spravnost_potvrzeno: formData.vecna_spravnost_potvrzeno,\n        potvrdil_vecnou_spravnost_id: formData.potvrdil_vecnou_spravnost_id,\n        dt_potvrzeni_vecne_spravnosti: formData.dt_potvrzeni_vecne_spravnosti\n      };\n      \n      const response = await updateInvoiceV2({\n        token,\n        username,\n        invoice_id: editingInvoiceId,\n        updateData\n      });\n\n      //  spn aktualizace - zkontrolovat rzn formty response\n      const isSuccess = response?.success === true || \n                       response?.status === 'success' || \n                       (response?.message && response.message.includes('spn'));\n      \n      if (isSuccess) {\n        // Aktualizovat originalFormData aby Cancel fungoval sprvn\n        setOriginalFormData(prev => ({\n          ...prev,\n          ...updateData\n        }));\n\n        //  LP ERPN: Uloit erpn LP po spn aktualizaci vcn sprvnosti\n        if (lpCerpani && lpCerpani.length > 0) {\n          try {\n            await saveFakturaLPCerpani(editingInvoiceId, lpCerpani, token, username);\n          } catch (lpError) {\n            console.error(' Chyba pi ukldn LP erpn:', lpError);\n            // Nezastavujeme proces - LP erpn je bonusov data, faktura u je uloena\n            showToast && showToast('Vcn sprvnost uloena, ale erpn LP se nepodailo uloit: ' + lpError.message, 'warning');\n          }\n        }\n\n        // Odeslat notifikaci o vcn kontrole (pokud m objednvku)\n        if (formData.order_id) {\n          try {\n            await notificationService.trigger(\n              'ORDER_MATERIAL_CORRECTNESS',\n              formData.order_id,\n              user_id\n            );\n          } catch (notifError) {\n            console.error(' Chyba pi odesln notifikace:', notifError);\n          }\n        }\n\n        // Vdy zobrazit progress dialog pro oba typy uivatel\n        setProgressModal({\n          show: true,\n          status: 'success',\n          title: 'Vcn sprvnost uloena',\n          message: isReadOnlyMode \n            ? 'Vcn sprvnost faktury byla spn zaznamenna. Budete pesmrovni na seznam faktur.'\n            : 'Vcn sprvnost faktury byla spn aktualizovna.',\n          resetData: { isVecnaSpravnost: true, isReadOnlyMode }\n        });\n      } else {\n        // Skuten chyba\n        const errorMsg = response?.message || response?.error || 'Nepodailo se aktualizovat vcnou sprvnost';\n        throw new Error(errorMsg);\n      }\n    } catch (err) {\n      console.error(' Chyba pi aktualizaci vcn kontroly:', err);\n      setError(err.message || 'Nepodailo se aktualizovat vcnou kontrolu');\n      showToast && showToast(err.message || 'Nepodailo se aktualizovat vcnou kontrolu', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Handler: submit formule\n  const handleSubmit = async () => {\n    setError(null);\n    setFieldErrors({});\n    \n    //  Uivatel klikl na Zaevidovat/Aktualizovat - nastavit flag\n    setInvoiceUserConfirmed(true);\n\n    //  Kontrola stavu objednvky\n    // - Pro NOVOU fakturu s objednvkou\n    // - Pro EDITACI faktury, kde PIDVME objednvku (pvodn nemla)\n    const isAddingOrderToExistingInvoice = editingInvoiceId && !hadOriginalEntity && formData.order_id;\n    \n    if (formData.order_id && orderData && (!editingInvoiceId || isAddingOrderToExistingInvoice)) {\n      const invoiceCheck = canAddInvoiceToOrder(orderData);\n      if (!invoiceCheck.allowed) {\n        setError(invoiceCheck.reason);\n        showToast && showToast(invoiceCheck.reason, 'error');\n        return;\n      }\n    }\n    \n    //  Zobrazit progress modal ihned pi startu\n    setProgressModal({\n      show: true,\n      status: 'loading',\n      progress: 10,\n      title: editingInvoiceId ? 'Ukldm zmny faktury...' : 'Eviduji novou fakturu...',\n      message: 'Ovuji zadan daje a pipravuji data k uloen...'\n    });\n\n    //  Validace povinnch pol\n    const errors = {};\n    \n    // slo faktury - POVINN\n    if (!formData.fa_cislo_vema || !formData.fa_cislo_vema.trim()) {\n      errors.fa_cislo_vema = 'Vyplte slo faktury';\n    }\n\n    // Typ faktury - POVINN\n    if (!formData.fa_typ) {\n      errors.fa_typ = 'Vyberte typ faktury';\n    }\n\n    // Datum doruen - POVINN\n    if (!formData.fa_datum_doruceni) {\n      errors.fa_datum_doruceni = 'Vyplte datum doruen';\n    }\n\n    // Datum vystaven - POVINN\n    if (!formData.fa_datum_vystaveni) {\n      errors.fa_datum_vystaveni = 'Vyplte datum vystaven';\n    }\n\n    // Datum splatnosti - POVINN\n    if (!formData.fa_datum_splatnosti) {\n      errors.fa_datum_splatnosti = 'Vyplte datum splatnosti';\n    }\n\n    // stka - POVINN\n    if (!formData.fa_castka || parseFloat(formData.fa_castka) <= 0) {\n      errors.fa_castka = 'Vyplte platnou stku faktury';\n    }\n\n    // Validace datum pedn/vrcen (nepovinn, ale pokud jsou vyplnn)\n    if (formData.fa_datum_predani_zam && formData.fa_datum_vraceni_zam) {\n      const predani = new Date(formData.fa_datum_predani_zam);\n      const vraceni = new Date(formData.fa_datum_vraceni_zam);\n      if (vraceni < predani) {\n        errors.fa_datum_vraceni_zam = 'Datum vrcen neme bt dvj ne datum pedn';\n      }\n    }\n\n    // Pokud jsou chyby, zobraz je a zastav submit\n    if (Object.keys(errors).length > 0) {\n      setFieldErrors(errors);\n      setError('Opravte prosm chyby ve formuli ped odeslnm');\n      // Zavt progress modal pi chyb validace\n      setProgressModal({ show: false, status: 'error', progress: 0, title: '', message: '' });\n      return;\n    }\n\n    setLoading(true);\n    setProgress?.(50);\n    \n    //  Aktualizace progress - validace prola\n    setProgressModal(prev => ({\n      ...prev,\n      progress: 30,\n      message: 'Validace formule dokonena, odeslm data na server...'\n    }));\n\n    try {\n      // Vcn sprvnost podle dokumentace\n      const getMysqlDateTime = () => {\n        return new Date().toISOString().slice(0, 19).replace('T', ' ');\n      };\n\n      const apiParams = {\n        token,\n        username,\n        order_id: formData.order_id || null, // Me bt null pokud faktura nen vzna na objednvku\n        smlouva_id: formData.smlouva_id || null, // Me bt null pokud faktura nen vzna na smlouvu\n        fa_cislo_vema: formData.fa_cislo_vema,\n        fa_typ: formData.fa_typ || 'BEZNA',\n        fa_datum_vystaveni: formData.fa_datum_vystaveni,\n        fa_datum_splatnosti: formData.fa_datum_splatnosti || null,\n        fa_datum_doruceni: formData.fa_datum_doruceni || null,\n        fa_castka: formData.fa_castka,\n        fa_poznamka: formData.fa_poznamka || '',\n        fa_dorucena: formData.fa_datum_doruceni ? 1 : 0,\n        // fa_strediska_kod je ji array string [\"101_RLP_KLADNO\"], jen JSON.stringify\n        fa_strediska_kod: JSON.stringify(formData.fa_strediska_kod || []),\n        // Nov poloky (nepovinn) - null pokud nen vyplnno\n        fa_predana_zam_id: formData.fa_predana_zam_id || null,\n        fa_datum_predani_zam: formData.fa_datum_predani_zam || null,\n        fa_datum_vraceni_zam: formData.fa_datum_vraceni_zam || null\n      };\n\n      let result;\n\n      if (editingInvoiceId) {\n        // EDITACE - UPDATE faktury\n        // updateInvoiceV2 oekv updateData jako separtn objekt\n        const updateData = {\n          objednavka_id: formData.order_id || null,\n          smlouva_id: formData.smlouva_id || null,\n          fa_cislo_vema: formData.fa_cislo_vema,\n          fa_typ: formData.fa_typ || 'BEZNA',\n          fa_datum_vystaveni: formData.fa_datum_vystaveni,\n          fa_datum_splatnosti: formData.fa_datum_splatnosti || null,\n          fa_datum_doruceni: formData.fa_datum_doruceni || null,\n          fa_castka: formData.fa_castka,\n          fa_poznamka: formData.fa_poznamka || '',\n          fa_dorucena: formData.fa_datum_doruceni ? 1 : 0,\n          fa_predana_zam_id: formData.fa_predana_zam_id || null,\n          fa_datum_predani_zam: formData.fa_datum_predani_zam || null,\n          fa_datum_vraceni_zam: formData.fa_datum_vraceni_zam || null,\n          // fa_strediska_kod je ji array string [\"101_RLP_KLADNO\"], jen JSON.stringify\n          fa_strediska_kod: JSON.stringify(formData.fa_strediska_kod || [])\n        };\n\n        //  Progress - aktualizace faktury\n        setProgressModal(prev => ({\n          ...prev,\n          progress: 60,\n          message: 'Aktualizuji daje faktury v databzi...'\n        }));\n\n        result = await updateInvoiceV2({\n          token,\n          username,\n          invoice_id: editingInvoiceId,\n          updateData\n        });\n        \n        //  LP ERPN: Uloit erpn LP pro fakturu (pokud je LP financovn)\n        \n        if (lpCerpani && lpCerpani.length > 0) {\n          try {\n            await saveFakturaLPCerpani(editingInvoiceId, lpCerpani, token, username);\n          } catch (lpError) {\n            console.error(' Chyba pi ukldn LP erpn:', lpError);\n            // Nezastavujeme proces - LP erpn je bonusov data, faktura u je uloena\n            showToast && showToast('Faktura uloena, ale erpn LP se nepodailo uloit: ' + lpError.message, 'warning');\n          }\n        }\n        \n        setProgress?.(100);\n        \n        //  Progress - spn aktualizace\n        setProgressModal(prev => ({\n          ...prev,\n          progress: 100,\n          status: 'success',\n          title: 'Faktura byla aktualizovna',\n          message: `Faktura ${formData.fa_cislo_vema} byla spn uloena do databze.`\n        }));\n      } else {\n        // NOV FAKTURA - CREATE\n        //  Progress - vytven faktury\n        setProgressModal(prev => ({\n          ...prev,\n          progress: 60,\n          message: formData.file \n            ? 'Nahrvm plohu a vytvm fakturu...' \n            : 'Vytvm novou fakturu v databzi...'\n        }));\n        \n        if (formData.file) {\n          // S plohou\n          result = await createInvoiceWithAttachmentV2({\n            ...apiParams,\n            file: formData.file,\n            klasifikace: formData.klasifikace || null // Typ plohy\n          });\n        } else {\n          // Bez plohy\n          result = await createInvoiceV2(apiParams);\n        }\n\n        //  LP ERPN: Uloit erpn LP pro novou fakturu (pokud je LP financovn)\n        const newInvoiceId = result?.data?.invoice_id || result?.data?.id || result?.invoice_id || result?.id;\n        \n        if (newInvoiceId && lpCerpani && lpCerpani.length > 0) {\n          try {\n            await saveFakturaLPCerpani(newInvoiceId, lpCerpani, token, username);\n          } catch (lpError) {\n            console.error(' Chyba pi ukldn LP erpn:', lpError);\n            // Nezastavujeme proces - LP erpn je bonusov data, faktura u je uloena\n            showToast && showToast('Faktura vytvoena, ale erpn LP se nepodailo uloit: ' + lpError.message, 'warning');\n          }\n        }\n\n        setProgress?.(100);\n        \n        //  Progress - spn vytvoen\n        setProgressModal(prev => ({\n          ...prev,\n          progress: 100,\n          status: 'success',\n          title: 'Faktura byla zaevidovna',\n          message: `Faktura ${formData.fa_cislo_vema} byla spn uloena do systmu.`\n        }));\n      }\n\n      //  Pokud je faktura pipojena k objednvce, aktualizuj workflow stav\n      // - NOV FAKTURA: pidat stav VECNA_SPRAVNOST\n      // - EDITACE: vrtit na VECNA_SPRAVNOST (mus projt novou kontrolou)\n      if (formData.order_id && orderData) {\n        try {\n          // Parsuj aktuln workflow stavy\n          let stavKody = [];\n          try {\n            if (typeof orderData.stav_workflow_kod === 'string') {\n              stavKody = JSON.parse(orderData.stav_workflow_kod);\n            } else if (Array.isArray(orderData.stav_workflow_kod)) {\n              stavKody = [...orderData.stav_workflow_kod];\n            }\n          } catch (e) {\n            console.error('Chyba pi parsovn workflow stav:', e);\n            stavKody = [];\n          }\n\n          // Zskej aktuln (posledn) stav\n          const currentState = stavKody.length > 0 ? stavKody[stavKody.length - 1] : null;\n\n          //  DLEIT: Pokud editujeme fakturu kter PVODN NEMLA objednvku a TE JI PIAZUJEME,\n          // musme se chovat jako NOV faktura pro tuto objednvku (ne jako editace)\n          const isAddingOrderToExistingInvoice = editingInvoiceId && !hadOriginalEntity && formData.order_id;\n\n          // Logika pro zmnu workflow stavu podle aktulnho stavu:\n          // NOV FAKTURA (nebo piazen k objednvce):\n          // 1. NEUVEREJNIT nebo UVEREJNENA  pidat FAKTURACE  pidat VECNA_SPRAVNOST\n          // 2. FAKTURACE  pidat VECNA_SPRAVNOST\n          // 3. ZKONTROLOVANA  vrtit na VECNA_SPRAVNOST (faktury byly upraveny)\n          // 4. VECNA_SPRAVNOST  nechat beze zmny\n          // \n          // EDITACE FAKTURY (kter u mla objednvku):\n          // - ZKONTROLOVANA nebo DOKONCENA  vrtit na VECNA_SPRAVNOST (mus projt novou kontrolou)\n          // - VECNA_SPRAVNOST  nechat (u ek na kontrolu)\n          \n          let needsUpdate = false;\n          \n          if (editingInvoiceId && !isAddingOrderToExistingInvoice) {\n            // EDITACE existujc faktury kter U MLA objednvku\n            if (currentState === 'ZKONTROLOVANA' || currentState === 'DOKONCENA') {\n              // Vrtit zpt na VECNA_SPRAVNOST - mus projt novou kontrolou\n              stavKody.pop(); // Odstra posledn stav (ZKONTROLOVANA/DOKONCENA)\n              if (currentState === 'DOKONCENA' && stavKody[stavKody.length - 1] === 'ZKONTROLOVANA') {\n                stavKody.pop(); // Odstra i ZKONTROLOVANA pokud tam je\n              }\n              // Ujisti se e m VECNA_SPRAVNOST\n              if (stavKody[stavKody.length - 1] !== 'VECNA_SPRAVNOST') {\n                stavKody.push('VECNA_SPRAVNOST');\n              }\n              needsUpdate = true;\n              console.log(' EDITACE FAKTURY: Objednvka vrcena na vcnou sprvnost');\n            }\n            // Pokud je u ve VECNA_SPRAVNOST, nechme beze zmny\n          } else {\n            // NOV FAKTURA nebo PIAZEN FAKTURY K OBJEDNVCE\n            if (currentState === 'NEUVEREJNIT' || currentState === 'UVEREJNENA') {\n              // Prvn faktura  pidat FAKTURACE a pak VECNA_SPRAVNOST\n              stavKody.push('FAKTURACE');\n              stavKody.push('VECNA_SPRAVNOST');\n              needsUpdate = true;\n            } else if (currentState === 'FAKTURACE') {\n              // U m FAKTURACE  jen pidat VECNA_SPRAVNOST\n              stavKody.push('VECNA_SPRAVNOST');\n              needsUpdate = true;\n            } else if (currentState === 'ZKONTROLOVANA') {\n              // Vrtit zpt na VECNA_SPRAVNOST (faktury byly upraveny)\n              stavKody.pop(); // Odstra ZKONTROLOVANA\n              needsUpdate = true;\n            }\n            // Pokud je currentState === 'VECNA_SPRAVNOST', nechme beze zmny (needsUpdate = false)\n          }\n\n          if (needsUpdate) {\n            //  Progress - aktualizace workflow objednvky\n            setProgressModal(prev => ({\n              ...prev,\n              progress: 85,\n              message: 'Aktualizuji stav objednvky a odeslm notifikace...'\n            }));\n            \n            // Aktualizuj objednvku\n            //  Krom stav_workflow_kod je nutn aktualizovat i stav_objednavky (textov stav)\n            await updateOrderV2(\n              formData.order_id,\n              { \n                stav_workflow_kod: JSON.stringify(stavKody),\n                stav_objednavky: 'Vcn sprvnost'  // Text odpovdajc stavu VECNA_SPRAVNOST\n              },\n              token,\n              username\n            );\n\n            //  NOTIFIKACE: Odeslat notifikace objednateli, garantovi a schvalovateli\n            await sendInvoiceNotifications(formData.order_id, orderData);\n\n            //  Reload objednvky aby se zobrazil nov stav\n            await loadOrderData(formData.order_id);\n          }\n        } catch (updateErr) {\n          console.error(' Nepodailo se aktualizovat workflow objednvky:', updateErr);\n          // Neblokujeme spch faktury, jen logujeme chybu\n        }\n      }\n\n      //  RESET FORMULE se provede a po kliknut na \"Pokraovat\" v progress dialogu\n      // Ulome data potebn pro reset do stavu progress dialogu\n      //  PI UPDATE (editaci) - smazat vechno vetn objednvky\n      //  PI CREATE (nov) - ponechat objednvku pro dal fakturu\n      const wasEditing = !!editingInvoiceId;\n      \n      //  CLEANUP: Vymazat originalFormData aby nedolo k memory leak\n      setOriginalFormData(null);\n      setHasChangedCriticalField(false);\n      \n      //  Uloit reset parametry do progress dialogu (pouije se pi kliknut na \"Pokraovat\")\n      setProgressModal(prev => ({\n        ...prev,\n        resetData: {\n          wasEditing,\n          currentOrderId: formData.order_id,\n          currentSmlouvaId: formData.smlouva_id\n        }\n      }));\n\n      //  SPISOVKA TRACKING: Oznait dokument jako zpracovan (pouze pro nov faktury, ne editace)\n      //  AUTO-TRACKING: Oznait Spisovka dokument jako zpracovan\n      // Toto se provede na pozad - neblokuje spch uloen faktury\n      if (!editingInvoiceId && result?.data?.id) {\n        try {\n          //  PRIORITA 1: Hledat Spisovka metadata v prvnm attachmentu\n          const firstAttachment = attachments?.[0];\n          \n          if (firstAttachment?.spisovka_file_id && firstAttachment?.spisovka_dokument_id) {\n            //  PESN PROPOJEN podle file_id z attachmentu\n            await markSpisovkaDocumentProcessed({\n              username,\n              token,\n              dokument_id: firstAttachment.spisovka_dokument_id,\n              spisovka_priloha_id: firstAttachment.spisovka_file_id, //  Pesn ID plohy\n              faktura_id: result.data.id,\n              fa_cislo_vema: formData.fa_cislo_vema,\n              stav: 'ZAEVIDOVANO',\n              poznamka: `Auto-tracking: Ploha ze Spisovky (file_id: ${firstAttachment.spisovka_file_id})`\n            });\n            \n          }\n          // FALLBACK: Pokud nen Spisovka metadata, zkusit provat podle nzvu souboru (star zpsob)\n          else if (formData.file && spisovkaLastRecords && spisovkaLastRecords.length > 0) {\n            const potentialDoc = spisovkaLastRecords.find(doc => {\n              if (doc.prilohy && doc.prilohy.length > 0) {\n                return doc.prilohy.some(priloha => priloha.filename === formData.file.name);\n              }\n              return false;\n            });\n\n            if (potentialDoc?.dokument_id) {\n              await markSpisovkaDocumentProcessed({\n                username,\n                token,\n                dokument_id: potentialDoc.dokument_id,\n                faktura_id: result.data.id,\n                fa_cislo_vema: formData.fa_cislo_vema,\n                stav: 'ZAEVIDOVANO',\n                poznamka: `Auto-tracking: Provn podle nzvu souboru (fallback)`\n              });\n              \n            } else {\n            }\n          }\n        } catch (spisovkaErr) {\n          // Neblokujeme spch faktury - jen logujeme\n          console.warn(' Nepodailo se oznait Spisovka dokument jako zpracovan:', spisovkaErr);\n        }\n      }\n\n    } catch (err) {\n      console.error('Error creating invoice:', err);\n      setError(err.message || 'Chyba pi evidenci faktury');\n      setProgress?.(0);\n      \n      //  Progress - chyba pi ukldn\n      setProgressModal({\n        show: true,\n        status: 'error',\n        progress: 0,\n        title: 'Chyba pi ukldn faktury',\n        message: err.message || 'Dolo k neoekvan chyb pi ukldn faktury. Zkuste to prosm znovu.'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Handler: zpt na seznam\n  const handleBack = async () => {\n    //  Kontrola neuloench zmn (pro editaci i novou fakturu)\n    const hasUnsavedChanges = editingInvoiceId \n      ? hasChangedCriticalField // Pro editaci - sledujeme kritick pole\n      : (!(!formData.fa_cislo_vema && !formData.fa_castka && !formData.order_id && !formData.file)); // Pro novou fakturu - nen przdn\n    \n    // Pokud NEJSOU neuloen zmny, rovnou zpt\n    if (!hasUnsavedChanges) {\n      // Vyistit LS i pi odchodu bez zmn (aby se neobjevily pt)\n      try {\n        localStorage.removeItem(`invoiceForm_${user_id}`);\n        localStorage.removeItem(`invoiceAttach_${user_id}`);\n        localStorage.removeItem(`invoiceEdit_${user_id}`);\n        localStorage.removeItem(`invoiceOrigEntity_${user_id}`);\n        localStorage.removeItem('spisovka_active_dokument');\n      } catch (err) {\n        console.warn('Chyba pi mazn localStorage:', err);\n      }\n      navigate(-1);\n      return;\n    }\n    \n    //  Pokud m formul neuloen zmny, zeptat se na zruen\n    const dialogMessage = editingInvoiceId\n      ? 'Mte neuloen zmny faktury. Chcete odejt bez uloen? Vechny zmny budou ztraceny.'\n      : (formData.file \n        ? 'Mte rozdlanou fakturu s nahranou plohou. Chcete zruit evidenci? Vechna data a nahran plohy budou ztraceny.'\n        : 'Mte rozdlanou fakturu. Chcete zruit evidenci? Vechna vyplnn data budou ztracena.');\n    \n    setConfirmDialog({\n      isOpen: true,\n      title: editingInvoiceId ? ' Neuloen zmny' : ' Zruit evidenci faktury?',\n      message: dialogMessage,\n      onConfirm: async () => {\n        setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n        \n        //  Smazat plohy POUZE pokud to byla NOV faktura (temp ID nebo erstv vytvoen)\n        // Pro EDITACI reln faktury NEMAZAT plohy (pat k existujc faktue v DB)\n        const wasEditingRealInvoice = editingInvoiceId && Number(editingInvoiceId) > 0 && hadOriginalEntity;\n        \n        if (!wasEditingRealInvoice) {\n          // NOV FAKTURA - smazat uploadnut plohy\n          const uploadedAttachments = attachments.filter(att => att.serverId);\n          const hasRealInvoiceId = editingInvoiceId && Number(editingInvoiceId) > 0;\n          \n          if (uploadedAttachments.length > 0 && hasRealInvoiceId) {\n            \n            for (const att of uploadedAttachments) {\n              try {\n                await deleteInvoiceAttachment25({\n                  token,\n                  username,\n                  faktura_id: editingInvoiceId,\n                  priloha_id: att.serverId,\n                  objednavka_id: formData.order_id || null,\n                  hard_delete: 1 // Fyzicky smazat ze serveru\n                });\n              } catch (err) {\n                console.error(` Chyba pi mazn plohy ${att.name}:`, err);\n                // Pokraovat v mazn dalch ploh i pi chyb\n              }\n            }\n          } else if (uploadedAttachments.length > 0 && !hasRealInvoiceId) {\n            // Plohy nahrny k temp-new-invoice - nemaj DB zznam, nemazat pes API\n          }\n        } else {\n          // Editace reln faktury - plohy NEMAZAT (pat k existujc faktue)\n        }\n        \n        // Vyistit formData aby se uvolnila reference na soubor\n        setFormData({\n          fa_cislo_vema: '',\n          fa_datum_vystaveni: '',\n          fa_datum_zdanitelneho_plneni: '',\n          fa_datum_splatnosti: '',\n          fa_castka: '',\n          order_id: '',\n          dodavatel_id: '',\n          stredisko_id: '',\n          typ_faktury: '',\n          fa_poznamka: '',\n          fa_predana_zam_id: '',\n          file: null,\n          klasifikace: null\n        });\n        \n        // Vyistit attachments state\n        setAttachments([]);\n        \n        //  Vymazat localStorage pi zruen\n        try {\n          localStorage.removeItem(`invoiceForm_${user_id}`);\n          localStorage.removeItem(`invoiceAttach_${user_id}`);\n          localStorage.removeItem(`invoiceEdit_${user_id}`);\n          localStorage.removeItem(`invoiceOrigEntity_${user_id}`);\n          localStorage.removeItem('spisovka_active_dokument');\n        } catch (err) {\n          console.warn('Chyba pi mazn localStorage:', err);\n        }\n        \n        navigate(-1);\n      },\n      onCancel: () => {\n        setConfirmDialog({ isOpen: false, title: '', message: '', onConfirm: null, onCancel: null });\n      }\n    });\n  };\n\n  // Handler: toggle fullscreen\n  const toggleFullscreen = () => {\n    setIsFullscreen(prev => !prev);\n  };\n\n  // Helper: Toggle select dropdown\n  const toggleSelect = (fieldName) => {\n    setSelectStates(prev => ({\n      ...prev,\n      [fieldName]: !prev[fieldName]\n    }));\n  };\n\n  // Helper: Filter options\n  const filterOptions = (options, searchTerm) => {\n    if (!searchTerm) return options;\n    const lowerSearch = searchTerm.toLowerCase();\n    return options.filter(opt => \n      (opt.label || opt).toLowerCase().includes(lowerSearch)\n    );\n  };\n\n  // Helper: Get option label\n  const getOptionLabel = (option) => {\n    return option?.label || option?.value || option;\n  };\n\n  // MultiSelect komponenta\n  const MultiSelect = ({\n    values = [],\n    onChange,\n    options = [],\n    placeholder,\n    disabled = false\n  }) => {\n    const safeValues = Array.isArray(values) ? values : [];\n    const isOpen = selectStates.strediska;\n    const searchTerm = searchStates.strediska || '';\n    const dropdownRef = useRef(null);\n    const buttonRef = useRef(null);\n    const searchInputRef = useRef(null);\n\n    const filteredOptions = filterOptions(options, searchTerm);\n\n    // Zavt dropdown pi kliku mimo\n    useEffect(() => {\n      if (!isOpen) return;\n\n      const handleClickOutside = (event) => {\n        if (\n          dropdownRef.current && \n          buttonRef.current &&\n          !dropdownRef.current.contains(event.target) &&\n          !buttonRef.current.contains(event.target)\n        ) {\n          setSelectStates(prev => ({ ...prev, strediska: false }));\n        }\n      };\n\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => {\n        document.removeEventListener('mousedown', handleClickOutside);\n      };\n    }, [isOpen]);\n\n    // Pozicovn pro fixed dropdown\n    useEffect(() => {\n      if (isOpen && buttonRef.current && dropdownRef.current) {\n        const updatePosition = () => {\n          if (!buttonRef.current || !dropdownRef.current) return;\n          const buttonRect = buttonRef.current.getBoundingClientRect();\n          const dropdown = dropdownRef.current;\n\n          dropdown.style.left = buttonRect.left + 'px';\n          dropdown.style.width = buttonRect.width + 'px';\n          dropdown.style.top = (buttonRect.bottom + 2) + 'px';\n        };\n\n        updatePosition();\n        window.addEventListener('scroll', updatePosition, { passive: true, capture: true });\n        window.addEventListener('resize', updatePosition, { passive: true });\n\n        return () => {\n          window.removeEventListener('scroll', updatePosition, { capture: true });\n          window.removeEventListener('resize', updatePosition);\n        };\n      }\n    }, [isOpen]);\n\n    // Auto-focus search pi oteven\n    useEffect(() => {\n      if (isOpen && searchInputRef.current) {\n        // requestAnimationFrame msto setTimeout - synchronizuje s browser paint\n        const rafId = requestAnimationFrame(() => {\n          searchInputRef.current?.focus();\n        });\n        \n        return () => cancelAnimationFrame(rafId);\n      }\n    }, [isOpen]);\n\n    const displayValue = safeValues.length > 0\n      ? safeValues.map(val => {\n          const option = options.find(opt => opt.value === val || opt === val);\n          return option ? getOptionLabel(option) : val;\n        }).join(', ')\n      : placeholder;\n\n    const handleToggleOption = (option) => {\n      const optionValue = option.value || option;\n      const newValues = safeValues.includes(optionValue)\n        ? safeValues.filter(v => v !== optionValue)\n        : [...safeValues, optionValue];\n\n      onChange({ target: { value: newValues } });\n    };\n\n    return (\n      <MultiSelectWrapper isOpen={isOpen}>\n        <MultiSelectButton\n          ref={buttonRef}\n          onClick={() => !disabled && toggleSelect('strediska')}\n          disabled={disabled}\n          placeholder={safeValues.length === 0 ? \"true\" : \"false\"}\n          value={safeValues.length > 0 ? 'selected' : ''}\n          isOpen={isOpen}\n        >\n          <SelectedValue isEmpty={safeValues.length === 0}>{displayValue}</SelectedValue>\n        </MultiSelectButton>\n\n        {isOpen && !disabled && (\n          <MultiSelectDropdown ref={dropdownRef}>\n            <SearchBox>\n              <SearchIcon>\n                <Search size={16} />\n              </SearchIcon>\n              <SearchInput\n                ref={searchInputRef}\n                type=\"text\"\n                placeholder=\"Vyhledat stedisko...\"\n                value={searchTerm}\n                onChange={(e) => setSearchStates(prev => ({\n                  ...prev,\n                  strediska: e.target.value\n                }))}\n              />\n            </SearchBox>\n\n            {filteredOptions.map((option, index) => {\n              const optionValue = option.value || option;\n              const isChecked = safeValues.includes(optionValue);\n\n              return (\n                <MultiSelectOption\n                  key={option.value || index}\n                  level={option.level || 0}\n                  onClick={() => handleToggleOption(option)}\n                >\n                  <input\n                    type=\"checkbox\"\n                    checked={isChecked}\n                    readOnly\n                  />\n                  <span>{getOptionLabel(option)}</span>\n                </MultiSelectOption>\n              );\n            })}\n\n            {filteredOptions.length === 0 && (\n              <div style={{ padding: '1rem', textAlign: 'center', color: '#9ca3af' }}>\n                dn stedisko nenalezeno\n              </div>\n            )}\n          </MultiSelectDropdown>\n        )}\n      </MultiSelectWrapper>\n    );\n  };\n\n  //  LOADING GATE: ekat na naten selnk ped zobrazenm formule\n  const isInitialDataLoaded = strediskaOptions.length > 0 && typyFakturOptions.length > 0 && zamestnanci.length > 0;\n  \n  if (!isInitialDataLoaded) {\n    return (\n      <PageContainer>\n        <PageHeader>\n          <PageTitle>\n            <FontAwesomeIcon icon={faFileInvoice} />\n            Nataj se data...\n          </PageTitle>\n        </PageHeader>\n        <ContentLayout>\n          <FormColumn>\n            <div style={{ \n              display: 'flex', \n              flexDirection: 'column',\n              alignItems: 'center', \n              justifyContent: 'center',\n              minHeight: '400px',\n              gap: '1.5rem'\n            }}>\n              <div style={{\n                width: '80px',\n                height: '80px',\n                border: '6px solid #e5e7eb',\n                borderTop: '6px solid #3b82f6',\n                borderRadius: '50%',\n                animation: 'spin 1s linear infinite'\n              }} />\n              <div style={{\n                color: '#6b7280',\n                fontSize: '1.1rem',\n                fontWeight: '500'\n              }}>\n                Nataj se selnky...\n              </div>\n              <div style={{\n                color: '#9ca3af',\n                fontSize: '0.9rem'\n              }}>\n                Stediska, typy faktur, zamstnanci\n              </div>\n            </div>\n          </FormColumn>\n        </ContentLayout>\n        <style>{`\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        `}</style>\n      </PageContainer>\n    );\n  }\n\n  // Content komponenta (sdlen pro normal i fullscreen reim)\n  const PageContent = (\n    <>\n      <PageHeader>\n        <PageTitle>\n          <FontAwesomeIcon icon={(editingInvoiceId && invoiceUserConfirmed) ? faEdit : faFileInvoice} />\n          {(editingInvoiceId && invoiceUserConfirmed)\n            ? (isReadOnlyMode ? 'Doplnn vcn sprvnosti k faktue' : 'Upravit fakturu') \n            : 'Zaevidovat fakturu'\n          }\n        </PageTitle>\n        <HeaderActions>\n          {hasPermission('ADMIN') && (\n            <TooltipWrapper\n              ref={tooltipButtonRef}\n              onMouseEnter={() => {\n                setShowSpisovkaTooltip(true);\n                if (tooltipButtonRef.current) {\n                  const rect = tooltipButtonRef.current.getBoundingClientRect();\n                  const tooltipWidth = 350;\n                  let left = rect.right - tooltipWidth;\n                  \n                  // Adjust if tooltip would go off left edge\n                  if (left < 10) {\n                    left = 10;\n                  }\n                  \n                  // Adjust if tooltip would go off right edge\n                  if (left + tooltipWidth > window.innerWidth - 10) {\n                    left = window.innerWidth - tooltipWidth - 10;\n                  }\n                  \n                  setTooltipPosition({\n                    top: rect.bottom + 10,\n                    left: left\n                  });\n                }\n              }}\n              onMouseLeave={() => setShowSpisovkaTooltip(false)}\n            >\n              <IconButton \n                onClick={() => {\n                  setShowSpisovkaTooltip(false);\n                  setSpisovkaInboxOpen(!spisovkaInboxOpen);\n                }} \n                title={spisovkaInboxOpen ? 'Zavt Spisovka InBox' : 'Otevt Spisovka InBox'}\n                style={{ \n                  backgroundColor: spisovkaInboxOpen ? 'rgba(16, 185, 129, 0.2)' : 'transparent',\n                  color: spisovkaInboxOpen ? '#10b981' : '#9ca3af'\n                }}\n              >\n                <FontAwesomeIcon icon={faBookOpen} />\n                {spisovkaTodayCount > 0 && (\n                  <NotificationBadge>{spisovkaTodayCount}</NotificationBadge>\n                )}\n              </IconButton>\n              <TooltipContent \n                show={showSpisovkaTooltip && spisovkaLastRecords.length > 0}\n                $top={tooltipPosition.top}\n                $left={tooltipPosition.left}\n              >\n                <TooltipTitle>Poslednch 5 zznam</TooltipTitle>\n                {spisovkaLastRecords.map((record) => (\n                  <TooltipItem key={record.dokument_id}>\n                    <TooltipItemTitle>{record.nazev}</TooltipItemTitle>\n                    <TooltipItemMeta>\n                      <span> {record.pocet_priloh} plohy</span>\n                      <span>#{record.dokument_id}</span>\n                    </TooltipItemMeta>\n                  </TooltipItem>\n                ))}\n              </TooltipContent>\n            </TooltipWrapper>\n          )}\n          <IconButton onClick={toggleFullscreen} title={isFullscreen ? 'Normln reim' : 'Cel obrazovka'}>\n            <FontAwesomeIcon icon={isFullscreen ? faCompress : faExpand} />\n          </IconButton>\n          <IconButton onClick={handleBack} title=\"Zavt a vrtit se na seznam faktur\">\n            <FontAwesomeIcon icon={faTimes} />\n          </IconButton>\n        </HeaderActions>\n      </PageHeader>\n\n      <ContentLayout $fullscreen={isFullscreen}>\n        {/* LEV STRANA - FORMUL (60%) */}\n        <FormColumn>\n          <FormColumnHeader style={{ minHeight: '0px', padding: '0' }}>\n            {/* Header je przdn - tlatko pesunuto do zhlav sekce */}\n          </FormColumnHeader>\n\n          {/* Scrollable content area */}\n          <FormColumnContent>\n            {/*  SEKCE 1: DAJE FAKTURY - collapsible */}\n            <CollapsibleSection>\n            <CollapsibleHeader onClick={() => toggleSection('invoiceData')}>\n              <HeaderLeft>\n                <FontAwesomeIcon icon={faCreditCard} />\n                daje faktury\n                {editingInvoiceId && (\n                  <span style={{ \n                    marginLeft: '1rem',\n                    color: 'rgba(255, 255, 255, 0.9)',\n                    fontSize: '0.9rem',\n                    fontWeight: 400\n                  }}>\n                    - Reim prav #{editingInvoiceId}\n                  </span>\n                )}\n              </HeaderLeft>\n              <HeaderRight>\n                {/* Badge pro readonly reim */}\n                {isReadOnlyMode && (\n                  <span style={{ \n                    marginRight: '1rem',\n                    background: 'rgba(255, 255, 255, 0.95)',\n                    padding: '0.25rem 0.75rem',\n                    borderRadius: '4px',\n                    color: '#1e40af',\n                    fontSize: '0.8rem',\n                    fontWeight: 600,\n                    border: '2px solid rgba(255, 255, 255, 0.3)'\n                  }}>\n                    POUZE PRO TEN\n                  </span>\n                )}\n                {/* Tlatko zruit pravu - pouze v editanm reimu (ne readonly) */}\n                {editingInvoiceId && !isReadOnlyMode && (\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation(); // Zabrnit zaven sekce\n                      \n                      //  KROK 0: Nastavit flag, e probh reset (blokuje useEffect)\n                      isResettingRef.current = true;\n                      \n                      //  KROK 0.5: BLOKOVAT auto-save do localStorage!\n                      setAllowLSSave(false);\n                      \n                      //  KROK 1: Vyistit localStorage IHNED (ped jakmkoliv state update)\n                      try {\n                        localStorage.removeItem(`invoiceForm_${user_id}`);\n                        localStorage.removeItem(`invoiceAttach_${user_id}`);\n                        localStorage.removeItem(`invoiceEdit_${user_id}`);\n                        localStorage.removeItem(`invoiceOrigEntity_${user_id}`);\n                      } catch (err) {\n                        console.warn('Chyba pi mazn localStorage:', err);\n                      }\n                      \n                      //  KROK 2: Kompletn reset state\n                      setEditingInvoiceId(null);\n                      setInvoiceUserConfirmed(false);\n                      setAttachments([]);\n                      setOriginalFormData(null);\n                      setHasChangedCriticalField(false);\n                      setIsEntityUnlocked(false);\n                      setHadOriginalEntity(false);\n                      setFieldErrors({});\n                      \n                      //  RESET loading flags\n                      hasLoadedInvoiceRef.current = false; //  NOV: Reset aby se mohla nast jin faktura\n                      \n                      //  VDY resetovat vechno vetn entity\n                      setFormData({\n                        order_id: '',\n                        smlouva_id: null,\n                        fa_cislo_vema: '',\n                        fa_typ: 'BEZNA',\n                        fa_datum_doruceni: formatDateForPicker(new Date()),\n                        fa_datum_vystaveni: '',\n                        fa_datum_splatnosti: '',\n                        fa_castka: '',\n                        fa_poznamka: '',\n                        fa_strediska_kod: [],\n                        file: null,\n                        fa_predana_zam_id: null,\n                        fa_datum_predani_zam: '',\n                        fa_datum_vraceni_zam: '',\n                        vecna_spravnost_umisteni_majetku: '',\n                        vecna_spravnost_poznamka: '',\n                        vecna_spravnost_potvrzeno: 0,\n                        potvrdil_vecnou_spravnost_id: null,\n                        dt_potvrzeni_vecne_spravnosti: ''\n                      });\n                      \n                      //  Vyistit preview entity\n                      setOrderData(null);\n                      setSmlouvaData(null);\n                      setSearchTerm('');\n                      setShowSuggestions(false);\n                      setSelectedType('order');\n                      \n                      //  KROK 3: Reset location.state\n                      navigate(location.pathname, { replace: true, state: {} });\n                      showToast && showToast(' Formul resetovn pro novou fakturu', 'info');\n                      \n                      //  KROK 4: Reset flag po krtkm delay (a se ve dokon)\n                      setTimeout(() => {\n                        isResettingRef.current = false;\n                        setAllowLSSave(true); //  Znovu povolit auto-save\n                      }, 100);\n                    }}\n                    style={{\n                      background: '#dc2626',\n                      color: 'white',\n                      border: 'none',\n                      padding: '0.4rem 0.8rem',\n                      borderRadius: '6px',\n                      cursor: 'pointer',\n                      fontSize: '0.85rem',\n                      fontWeight: '600',\n                      marginRight: '0.5rem',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '0.4rem'\n                    }}\n                    title=\"Zruit pravy a vrtit se k novmu zznamu\"\n                  >\n                    <FontAwesomeIcon icon={faTimes} /> Zruit pravu\n                  </button>\n                )}\n                <CollapseButton $collapsed={!sectionStates.invoiceData}>\n                  <FontAwesomeIcon icon={faChevronDown} />\n                </CollapseButton>\n              </HeaderRight>\n            </CollapsibleHeader>\n            <SectionContent $collapsed={!sectionStates.invoiceData}>\n            {error && (\n              <ErrorAlert>\n                <FontAwesomeIcon icon={faExclamationTriangle} />\n                {error}\n              </ErrorAlert>\n            )}\n\n            <FakturaCard $isEditing={true}>\n            {/* DEK 1: Nzev smlouvy / Pedmt objednvky - pes celou ku */}\n            <FieldRow $columns=\"1fr\">\n              <FieldGroup>\n                <FieldLabel>\n                  {selectedType === 'smlouva' ? 'Nzev smlouvy' : 'Pedmt objednvky'}\n                </FieldLabel>\n                <div style={{ \n                  minHeight: '62px',\n                  padding: '0.75rem',\n                  display: 'flex',\n                  alignItems: 'center',\n                  background: (orderData || smlouvaData) ? '#f0f9ff' : '#f9fafb', \n                  border: (orderData || smlouvaData) ? '2px solid #3b82f6' : '2px solid #e5e7eb', \n                  borderRadius: '8px',\n                  color: (orderData || smlouvaData) ? '#1e40af' : '#9ca3af',\n                  fontWeight: (orderData || smlouvaData) ? '600' : '400',\n                  fontSize: '0.95rem',\n                  boxSizing: 'border-box'\n                }}>\n                  {selectedType === 'order' && orderData \n                    ? (orderData.predmet || '')\n                    : selectedType === 'smlouva' && smlouvaData\n                    ? (smlouvaData.nazev_smlouvy || smlouvaData.nazev || '')\n                    : ''}\n                </div>\n              </FieldGroup>\n            </FieldRow>\n\n            {/* DEK 2: Vbr objednvky/smlouvy | Platnost/Datum vytvoen | Celkov cena */}\n            <FieldRow $columns=\"2fr 1fr 1fr\">\n              <FieldGroup style={{ width: '100%' }}>\n                <FieldLabel>\n                  Vyberte objednvku nebo smlouvu\n                </FieldLabel>\n                <AutocompleteWrapper className=\"autocomplete-wrapper\" style={{ width: '100%', position: 'relative' }}>\n                  {/* Ikona zmku - klikateln pro odemen */}\n                  {editingInvoiceId && hadOriginalEntity && (formData.order_id || formData.smlouva_id) && !isEntityUnlocked && (\n                    <div\n                      onClick={handleUnlockEntity}\n                      style={{\n                        position: 'absolute',\n                        left: '0.75rem',\n                        top: '50%',\n                        transform: 'translateY(-50%)',\n                        color: '#f59e0b',\n                        fontSize: '0.875rem',\n                        zIndex: 1,\n                        cursor: 'pointer',\n                        transition: 'color 0.2s'\n                      }}\n                      onMouseEnter={(e) => e.currentTarget.style.color = '#d97706'}\n                      onMouseLeave={(e) => e.currentTarget.style.color = '#f59e0b'}\n                      title=\"Kliknte pro odemen zmny objednvky/smlouvy\"\n                    >\n                      <FontAwesomeIcon icon={faLock} />\n                    </div>\n                  )}\n                  <AutocompleteInput\n                    type=\"text\"\n                    value={searchTerm}\n                    onChange={handleSearchChange}\n                    onFocus={() => setShowSuggestions(true)}\n                    disabled={isReadOnlyMode || !!orderId || (editingInvoiceId && hadOriginalEntity && (formData.order_id || formData.smlouva_id) && !isEntityUnlocked)}\n                    placeholder={\n                      \"Zante pst ev. slo objednvky nebo smlouvy (min. 3 znaky)...\"\n                    }\n                    style={{ \n                      width: '100%',\n                      paddingLeft: (editingInvoiceId && hadOriginalEntity && (formData.order_id || formData.smlouva_id) && !isEntityUnlocked) ? '2.5rem' : '0.75rem',\n                      paddingRight: searchTerm ? '2.5rem' : '0.75rem'\n                    }}\n                  />\n                  {searchTerm && (\n                    <ClearButton\n                      type=\"button\"\n                      onClick={handleClearSearch}\n                      title=\"Vymazat text\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </ClearButton>\n                  )}\n                  {showSuggestions && searchTerm && (\n                    <AutocompleteDropdown>\n                      {isSearching ? (\n                        <SearchingSpinner>\n                          <FontAwesomeIcon icon={faFileInvoice} spin />\n                          {' Vyhledvm...'}\n                        </SearchingSpinner>\n                      ) : searchTerm.length < 3 ? (\n                        <NoResults>\n                          <FontAwesomeIcon icon={faSearch} style={{ marginRight: '0.5rem' }} />\n                          Zadejte alespo 3 znaky pro vyhledvn\n                        </NoResults>\n                      ) : suggestions.length > 0 ? (\n                        suggestions.map(item => {\n                          const isOrder = item._type === 'order';\n                          const isSmlouva = item._type === 'smlouva';\n\n                          // Pro objednvky\n                          if (isOrder) {\n                            const stavText = item.stav || '';\n                            const getStavColor = (stav) => {\n                              const stavLower = (stav || '').toLowerCase();\n                              if (stavLower.includes('dokonen') || stavLower.includes('zkontrolovan')) {\n                                return { bg: '#d1fae5', text: '#065f46' };\n                              }\n                              if (stavLower.includes('fakturac') || stavLower.includes('vcn sprvnost')) {\n                                return { bg: '#dbeafe', text: '#1e40af' };\n                              }\n                              if (stavLower.includes('odeslan') || stavLower.includes('potvr')) {\n                                return { bg: '#e0e7ff', text: '#3730a3' };\n                              }\n                              if (stavLower.includes('schval')) {\n                                return { bg: '#fef3c7', text: '#92400e' };\n                              }\n                              return { bg: '#e5e7eb', text: '#374151' };\n                            };\n                            const stavColors = getStavColor(stavText);\n\n                            return (\n                              <OrderSuggestionItem\n                                key={`order-${item.id}`}\n                                onClick={() => handleSelectOrder(item)}\n                              >\n                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', gap: '0.5rem' }}>\n                                  <OrderSuggestionTitle style={{ flex: 1 }}>\n                                    <OrderSuggestionBadge $color=\"#3b82f6\" $textColor=\"white\" style={{ marginRight: '0.5rem' }}>\n                                      OBJ\n                                    </OrderSuggestionBadge>\n                                    {item.cislo_objednavky || item.evidencni_cislo || `#${item.id}`}\n                                    {stavText && (\n                                      <OrderSuggestionBadge $color={stavColors.bg} $textColor={stavColors.text} style={{ marginLeft: '0.5rem' }}>\n                                        {stavText}\n                                      </OrderSuggestionBadge>\n                                    )}\n                                    {item.max_cena_s_dph && (\n                                      <OrderSuggestionBadge $color=\"#fef3c7\" $textColor=\"#92400e\" style={{ marginLeft: '0.5rem' }}>\n                                        {parseFloat(item.max_cena_s_dph).toLocaleString('cs-CZ')} K\n                                      </OrderSuggestionBadge>\n                                    )}\n                                  </OrderSuggestionTitle>\n                                  {item.pocet_faktur !== undefined && (\n                                    <OrderSuggestionBadge \n                                      $color={item.pocet_faktur > 0 ? '#e0f2fe' : '#f1f5f9'} \n                                      $textColor={item.pocet_faktur > 0 ? '#0369a1' : '#64748b'}\n                                      style={{ flexShrink: 0, display: 'flex', alignItems: 'center', gap: '0.25rem' }}\n                                    >\n                                      <FontAwesomeIcon icon={faFileInvoice} style={{ fontSize: '0.7rem' }} />\n                                      {item.pocet_faktur || 0}\n                                    </OrderSuggestionBadge>\n                                  )}\n                                </div>\n                                <OrderSuggestionDetail>\n                                  {item.predmet && <span><strong>Pedmt:</strong> {item.predmet}</span>}\n                                  {item.dodavatel_nazev && (\n                                    <span>\n                                      <strong>{item.dodavatel_nazev}</strong>\n                                      {item.dodavatel_ico && ` (IO: ${item.dodavatel_ico})`}\n                                    </span>\n                                  )}\n                                </OrderSuggestionDetail>\n                              </OrderSuggestionItem>\n                            );\n                          }\n\n                          // Pro smlouvy\n                          if (isSmlouva) {\n                            return (\n                              <OrderSuggestionItem\n                                key={`smlouva-${item.id}`}\n                                onClick={() => {\n                                  setSelectedType('smlouva');\n                                  loadSmlouvaData(item.id);\n                                  setShowSuggestions(false);\n                                }}\n                              >\n                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', gap: '0.5rem' }}>\n                                  <OrderSuggestionTitle style={{ flex: 1 }}>\n                                    <OrderSuggestionBadge $color=\"#10b981\" $textColor=\"white\" style={{ marginRight: '0.5rem' }}>\n                                      SML\n                                    </OrderSuggestionBadge>\n                                    {item.cislo_smlouvy}\n                                    {item.hodnota_s_dph && (\n                                      <OrderSuggestionBadge $color=\"#fef3c7\" $textColor=\"#92400e\" style={{ marginLeft: '0.5rem' }}>\n                                        {parseFloat(item.hodnota_s_dph).toLocaleString('cs-CZ')} K\n                                      </OrderSuggestionBadge>\n                                    )}\n                                  </OrderSuggestionTitle>\n                                </div>\n                                <OrderSuggestionDetail>\n                                  {item.nazev_smlouvy && <span><strong>Nzev:</strong> {item.nazev_smlouvy}</span>}\n                                  {item.nazev_firmy && (\n                                    <span>\n                                      <strong>{item.nazev_firmy}</strong>\n                                      {item.ico && ` (IO: ${item.ico})`}\n                                    </span>\n                                  )}\n                                </OrderSuggestionDetail>\n                              </OrderSuggestionItem>\n                            );\n                          }\n\n                          return null;\n                        })\n                      ) : (\n                        <NoResults>\n                          <FontAwesomeIcon icon={faSearch} style={{ marginRight: '0.5rem' }} />\n                          dn objednvky ani smlouvy nenalezeny\n                          <div style={{ fontSize: '0.75rem', marginTop: '0.5rem', color: '#9ca3af' }}>\n                            Hledaj se odeslan objednvky a aktivn smlouvy\n                          </div>\n                        </NoResults>\n                      )}\n                    </AutocompleteDropdown>\n                  )}\n                </AutocompleteWrapper>\n                <HelpText>\n                  {orderId \n                    ? 'Objednvka je pedvyplnna z kontextu' \n                    : 'Nepovinn - pokud faktura nen vzna na objednvku ani smlouvu, nechte przdn'}\n                </HelpText>\n              </FieldGroup>\n\n              {/* Platnost do / Datum vytvoen */}\n              <FieldGroup>\n                <FieldLabel>\n                  {selectedType === 'smlouva' ? 'Platnost do' : 'Datum vytvoen'}\n                </FieldLabel>\n                <div style={{ \n                  height: '48px',\n                  padding: '1px 0.875rem', \n                  display: 'flex',\n                  alignItems: 'center',\n                  background: (orderData || smlouvaData) ? '#fef3c7' : '#f9fafb', \n                  border: (orderData || smlouvaData) ? '2px solid #f59e0b' : '2px solid #e5e7eb', \n                  borderRadius: '8px',\n                  color: (orderData || smlouvaData) ? '#92400e' : '#9ca3af',\n                  fontWeight: (orderData || smlouvaData) ? '600' : '400',\n                  fontSize: '0.875rem',\n                  boxSizing: 'border-box'\n                }}>\n                  {(() => {\n                    // Pro objednvky zobrazit datum vytvoen\n                    if (orderData) {\n                      const datum = orderData.dt_objednavky || orderData.datum_objednavky || orderData.created_at || orderData.dt_vytvoreni || orderData.datum_vytvoreni;\n                      if (datum) {\n                        return formatDateOnly(datum);\n                      }\n                    }\n                    // Pro smlouvy zobrazit platnost do\n                    if (smlouvaData && smlouvaData.platnost_do) {\n                      return formatDateOnly(smlouvaData.platnost_do);\n                    }\n                    return '';\n                  })()}\n                </div>\n              </FieldGroup>\n\n              {/* Celkov cena - dynamicky podle typu entity */}\n              <FieldGroup>\n                <FieldLabel>\n                  {selectedType === 'smlouva' ? 'Celkem plnn s DPH' : 'Celkov cena'}\n                </FieldLabel>\n                <div style={{ \n                  height: '48px',\n                  padding: '1px 0.875rem', \n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'flex-end',\n                  background: (orderData || smlouvaData) ? '#f0fdf4' : '#f9fafb', \n                  border: (orderData || smlouvaData) ? '2px solid #10b981' : '2px solid #e5e7eb', \n                  borderRadius: '8px',\n                  color: (orderData || smlouvaData) ? '#065f46' : '#9ca3af',\n                  fontWeight: (orderData || smlouvaData) ? '700' : '400',\n                  fontSize: '0.875rem',\n                  boxSizing: 'border-box'\n                }}>\n                  {(() => {\n                    let amount = null;\n                    if (selectedType === 'order' && orderData?.max_cena_s_dph) {\n                      amount = orderData.max_cena_s_dph;\n                    } else if (selectedType === 'smlouva' && smlouvaData) {\n                      amount = smlouvaData.hodnota_s_dph || smlouvaData.celkova_castka;\n                    }\n                    \n                    return amount\n                      ? new Intl.NumberFormat('cs-CZ', { \n                          style: 'decimal', \n                          minimumFractionDigits: 2, \n                          maximumFractionDigits: 2 \n                        }).format(parseFloat(amount)) + ' K'\n                      : '';\n                  })()}\n                </div>\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 3x - DEK 2: Datum doruen | Datum vystaven | Datum splatnosti */}\n            <FieldRow $columns=\"1fr 1fr 1fr\">\n              <FieldGroup>\n                <FieldLabel>\n                  Datum doruen <RequiredStar>*</RequiredStar>\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_doruceni}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_doruceni: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_doruceni: date }))}\n                  disabled={!isInvoiceEditable || loading}\n                  placeholder=\"dd.mm.rrrr\"\n                  hasError={!!fieldErrors.fa_datum_doruceni}\n                />\n                {fieldErrors.fa_datum_doruceni && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_datum_doruceni}\n                  </FieldError>\n                )}\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel>\n                  Datum vystaven <RequiredStar>*</RequiredStar>\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_vystaveni}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_vystaveni: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_vystaveni: date }))}\n                  disabled={!isInvoiceEditable || loading}\n                  placeholder=\"dd.mm.rrrr\"\n                  hasError={!!fieldErrors.fa_datum_vystaveni}\n                />\n                {fieldErrors.fa_datum_vystaveni && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_datum_vystaveni}\n                  </FieldError>\n                )}\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel>\n                  Datum splatnosti <RequiredStar>*</RequiredStar>\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_splatnosti}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_splatnosti: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_splatnosti: date }))}\n                  disabled={!isInvoiceEditable || loading}\n                  placeholder=\"dd.mm.rrrr\"\n                  hasError={!!fieldErrors.fa_datum_splatnosti}\n                />\n                {fieldErrors.fa_datum_splatnosti && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_datum_splatnosti}\n                  </FieldError>\n                )}\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 3x - DEK 3: Typ faktury | Variabiln symbol | stka v. DPH */}\n            <FieldRow $columns=\"minmax(0, 1fr) minmax(0, 1fr) minmax(0, 1fr)\" $gap=\"1rem\">\n              <FieldGroup>\n                <FieldLabel>\n                  Typ faktury <RequiredStar>*</RequiredStar>\n                </FieldLabel>\n                <CustomSelect\n                  field=\"fa_typ\"\n                  value={formData.fa_typ}\n                  onChange={(e) => {\n                    setFormData(prev => ({ ...prev, fa_typ: e.target.value }));\n                  }}\n                  disabled={!isInvoiceEditable || loading}\n                  options={[\n                    { id: 'BEZNA', nazev: 'Bn faktura' },\n                    { id: 'ZALOHOVA', nazev: 'Zlohov faktura' },\n                    { id: 'OPRAVNA', nazev: 'Opravn faktura' },\n                    { id: 'PROFORMA', nazev: 'Proforma' },\n                    { id: 'DOBROPIS', nazev: 'Dobropis' }\n                  ]}\n                  placeholder=\"-- Vyberte typ --\"\n                  required={true}\n                  selectStates={selectStates}\n                  setSelectStates={setSelectStates}\n                  searchStates={searchStates}\n                  setSearchStates={setSearchStates}\n                  touchedSelectFields={touchedSelectFields}\n                  setTouchedSelectFields={setTouchedSelectFields}\n                  toggleSelect={(field) => setSelectStates(prev => ({ ...prev, [field]: !prev[field] }))}\n                  filterOptions={(options, searchTerm) => {\n                    if (!searchTerm) return options;\n                    return options.filter(opt => \n                      opt.nazev?.toLowerCase().includes(searchTerm.toLowerCase())\n                    );\n                  }}\n                  getOptionLabel={(option) => option?.nazev || ''}\n                />\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>Variabiln symbol <RequiredStar>*</RequiredStar></span>\n                  {formData.fa_cislo_vema && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ ...prev, fa_cislo_vema: '' }))}\n                      disabled={!isInvoiceEditable}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: isInvoiceEditable ? '#9ca3af' : '#d1d5db',\n                        cursor: isInvoiceEditable ? 'pointer' : 'not-allowed',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#6b7280'; }}\n                      onMouseLeave={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#9ca3af'; }}\n                      title=\"Vymazat variabiln symbol\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <Input\n                  type=\"text\"\n                  name=\"fa_cislo_vema\"\n                  value={formData.fa_cislo_vema}\n                  onChange={handleInputChange}\n                  disabled={!isInvoiceEditable || loading}\n                  onBlur={(e) => {\n                    // Po ztrt fokusu zvraznit text tun (pokud m hodnotu)\n                    if (e.target.value) {\n                      e.target.style.fontWeight = '600';\n                    }\n                  }}\n                  onFocus={(e) => {\n                    // Pi zskn fokusu vrtit normln tlouku\n                    e.target.style.fontWeight = '400';\n                  }}\n                  placeholder=\"12345678\"\n                  style={{ fontWeight: formData.fa_cislo_vema ? '600' : '400' }}\n                  $hasError={!!fieldErrors.fa_cislo_vema}\n                />\n                {fieldErrors.fa_cislo_vema && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_cislo_vema}\n                  </FieldError>\n                )}\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>stka v. DPH <RequiredStar>*</RequiredStar></span>\n                  {formData.fa_castka && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ ...prev, fa_castka: '' }))}\n                      disabled={!isInvoiceEditable}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: isInvoiceEditable ? '#9ca3af' : '#d1d5db',\n                        cursor: isInvoiceEditable ? 'pointer' : 'not-allowed',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#6b7280'; }}\n                      onMouseLeave={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#9ca3af'; }}\n                      title=\"Vymazat stku\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <CurrencyInput\n                  fieldName=\"fa_castka\"\n                  value={formData.fa_castka}\n                  onChange={handleInputChange}\n                  onBlur={(e) => {\n                    // Validace sla s desetinnm oddlovaem\n                    const value = e.target.value;\n                    if (value) {\n                      const num = parseFloat(value);\n                      if (isNaN(num) || num <= 0) {\n                        setFieldErrors(prev => ({\n                          ...prev,\n                          fa_castka: 'Zadejte platnou stku (slo vt ne 0)'\n                        }));\n                      } else {\n                        // Vymazat chybu pokud je slo v podku\n                        setFieldErrors(prev => {\n                          const { fa_castka, ...rest } = prev;\n                          return rest;\n                        });\n                      }\n                    }\n                  }}\n                  disabled={!isInvoiceEditable || loading}\n                  hasError={!!fieldErrors.fa_castka}\n                  placeholder=\"25 000,50\"\n                />\n                {fieldErrors.fa_castka && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    {fieldErrors.fa_castka}\n                  </FieldError>\n                )}\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 1x - DEK 5: Stediska (cel ka) */}\n            <FieldRow $columns=\"1fr\">\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>Stediska</span>\n                  {formData.fa_strediska_kod && formData.fa_strediska_kod.length > 0 && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ ...prev, fa_strediska_kod: [] }))}\n                      disabled={!isInvoiceEditable}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: isInvoiceEditable ? '#9ca3af' : '#d1d5db',\n                        cursor: isInvoiceEditable ? 'pointer' : 'not-allowed',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#6b7280'; }}\n                      onMouseLeave={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#9ca3af'; }}\n                      title=\"Vymazat stediska\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <MultiSelect\n                  values={formData.fa_strediska_kod}\n                  onChange={(e) => {\n                    // MultiSelect vrac array objekt [{kod_stavu, nazev_stavu}]\n                    // Stejn jako CustomSelect v OrderForm25\n                    setFormData(prev => ({ \n                      ...prev, \n                      fa_strediska_kod: e.target.value \n                    }));\n                  }}\n                  options={strediskaOptions}\n                  placeholder={strediskaLoading ? \"Natm stediska...\" : \"Vyberte stediska...\"}\n                  disabled={!isInvoiceEditable || loading || strediskaLoading}\n                />\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 1x - DEK 6: Poznmka (cel ka) */}\n            <FieldRow $columns=\"1fr\">\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>Poznmka</span>\n                  {formData.fa_poznamka && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ ...prev, fa_poznamka: '' }))}\n                      disabled={!isInvoiceEditable}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: isInvoiceEditable ? '#9ca3af' : '#d1d5db',\n                        cursor: isInvoiceEditable ? 'pointer' : 'not-allowed',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#6b7280'; }}\n                      onMouseLeave={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#9ca3af'; }}\n                      title=\"Vymazat poznmku\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <Textarea\n                  name=\"fa_poznamka\"\n                  value={formData.fa_poznamka}\n                  onChange={handleInputChange}\n                  disabled={!isInvoiceEditable || loading}\n                  placeholder=\"Voliteln poznmka...\"\n                />\n              </FieldGroup>\n            </FieldRow>\n\n            {/*  PLOHY FAKTURY - Nov komponenta podle vzoru OrderForm25 */}\n            <InvoiceAttachmentsCompact\n              fakturaId={editingInvoiceId || 'temp-new-invoice'}\n              objednavkaId={formData.order_id || null}\n              fakturaTypyPrilohOptions={typyFakturOptions}\n              readOnly={!isInvoiceEditable}\n              onISDOCParsed={handleISDOCParsed}\n              formData={formData}\n              faktura={{\n                fa_cislo_vema: formData.fa_cislo_vema,\n                fa_datum_vystaveni: formData.fa_datum_vystaveni,\n                fa_datum_splatnosti: formData.fa_datum_splatnosti,\n                fa_castka: formData.fa_castka,\n                fa_strediska_kod: formData.fa_strediska_kod\n              }}\n              validateInvoiceForAttachments={validateInvoiceForAttachments}\n              allUsers={zamestnanci}\n              attachments={attachments}\n              onAttachmentsChange={handleAttachmentsChange}\n              onAttachmentUploaded={handleAttachmentUploaded}\n              onAttachmentRemoved={handleAttachmentRemoved}\n              onCreateInvoiceInDB={handleCreateInvoiceInDB}\n              onOCRDataExtracted={handleOCRDataExtracted}\n            />\n\n            {/* ODDLUJC RA */}\n            <div style={{\n              borderTop: '2px solid #e5e7eb',\n              margin: '1.5rem 0',\n              position: 'relative'\n            }}>\n              <div style={{\n                position: 'absolute',\n                top: '-12px',\n                left: '50%',\n                transform: 'translateX(-50%)',\n                background: '#f9fafb',\n                padding: '0 1rem',\n                fontSize: '0.875rem',\n                color: '#6b7280',\n                fontWeight: 600\n              }}>\n                Doplujc daje (nepovinn)\n              </div>\n            </div>\n\n            {/* GRID 2x - DEK: Datum pedn | Datum vrcen */}\n            <FieldRow $columns=\"1fr 1fr\">\n              <FieldGroup>\n                <FieldLabel>\n                  Datum pedn\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_predani_zam}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_predani_zam: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_predani_zam: date }))}\n                  disabled={!isInvoiceEditable || loading}\n                  placeholder=\"dd.mm.rrrr\"\n                />\n              </FieldGroup>\n\n              <FieldGroup>\n                <FieldLabel>\n                  Datum vrcen\n                </FieldLabel>\n                <DatePicker\n                  value={formData.fa_datum_vraceni_zam}\n                  onChange={(date) => setFormData(prev => ({ ...prev, fa_datum_vraceni_zam: date }))}\n                  onBlur={(date) => setFormData(prev => ({ ...prev, fa_datum_vraceni_zam: date }))}\n                  disabled={!isInvoiceEditable || loading}\n                  placeholder=\"dd.mm.rrrr\"\n                />\n                {formData.fa_datum_predani_zam && formData.fa_datum_vraceni_zam && \n                 new Date(formData.fa_datum_vraceni_zam) < new Date(formData.fa_datum_predani_zam) && (\n                  <FieldError>\n                    <FontAwesomeIcon icon={faExclamationTriangle} />\n                    Datum vrcen neme bt dvj ne datum pedn\n                  </FieldError>\n                )}\n              </FieldGroup>\n            </FieldRow>\n\n            {/* GRID 1x - DEK: Pedno zamstnanci (cel ka) */}\n            <FieldRow $columns=\"1fr\">\n              <FieldGroup>\n                <FieldLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                  <span>Pedno zamstnanci</span>\n                  {formData.fa_predana_zam_id && (\n                    <button\n                      type=\"button\"\n                      onClick={() => setFormData(prev => ({ \n                        ...prev, \n                        fa_predana_zam_id: null,\n                        fa_datum_predani_zam: '',\n                        fa_datum_vraceni_zam: ''\n                      }))}\n                      disabled={!isInvoiceEditable}\n                      style={{\n                        background: 'none',\n                        border: 'none',\n                        color: isInvoiceEditable ? '#9ca3af' : '#d1d5db',\n                        cursor: isInvoiceEditable ? 'pointer' : 'not-allowed',\n                        padding: '0.25rem',\n                        display: 'flex',\n                        alignItems: 'center',\n                        fontSize: '0.875rem'\n                      }}\n                      onMouseEnter={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#6b7280'; }}\n                      onMouseLeave={(e) => { if (isInvoiceEditable) e.currentTarget.style.color = '#9ca3af'; }}\n                      title=\"Vymazat zamstnance (vetn datum pedn/vrcen)\"\n                    >\n                      <FontAwesomeIcon icon={faTimes} />\n                    </button>\n                  )}\n                </FieldLabel>\n                <CustomSelect\n                  value={formData.fa_predana_zam_id}\n                  onChange={(e) => setFormData(prev => ({ \n                    ...prev, \n                    fa_predana_zam_id: e.target.value ? parseInt(e.target.value) : null \n                  }))}\n                  options={zamestnanci}\n                  placeholder={zamestnanciLoading ? \"Natm zamstnance...\" : \"-- Nevybrno --\"}\n                  disabled={!isInvoiceEditable || loading || zamestnanciLoading}\n                  field=\"fa_predana_zam_id\"\n                  selectStates={selectStates}\n                  setSelectStates={setSelectStates}\n                  searchStates={searchStates}\n                  setSearchStates={setSearchStates}\n                  touchedSelectFields={touchedSelectFields}\n                  setTouchedSelectFields={setTouchedSelectFields}\n                  toggleSelect={(field) => setSelectStates(prev => ({ ...prev, [field]: !prev[field] }))}\n                  filterOptions={(options, searchTerm) => {\n                    if (!searchTerm) return options;\n                    return options.filter(opt => {\n                      const fullName = `${opt.prijmeni || ''} ${opt.jmeno || ''} ${opt.titul_za || ''}`.toLowerCase();\n                      return fullName.includes(searchTerm.toLowerCase());\n                    });\n                  }}\n                  getOptionLabel={(option) => {\n                    if (!option) return '';\n                    return `${option.prijmeni || ''} ${option.jmeno || ''} ${option.titul_za ? `, ${option.titul_za}` : ''}`.trim();\n                  }}\n                  allowEmpty={true}\n                />\n                {zamestnanciLoading && (\n                  <div style={{ fontSize: '0.85rem', color: '#6b7280', marginTop: '0.5rem' }}>\n                    <FontAwesomeIcon icon={faSpinner} spin /> Natm zamstnance...\n                  </div>\n                )}\n              </FieldGroup>\n            </FieldRow>\n          </FakturaCard>\n\n          {/* VAROVN: EDITACE faktury vzan na objednvku - nutnost vcn kontroly (pouze pokud je operace mon) */}\n          {/* NEZOBRAZOVAT pro readonly reim (vcn kontrola) - varovn je irelevantn */}\n          {editingInvoiceId && formData.order_id && orderData && canAddInvoiceToOrder(orderData).allowed && !isReadOnlyMode && (\n            <div style={{\n              background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',\n              border: '3px solid #f59e0b',\n              borderRadius: '12px',\n              padding: '1.25rem',\n              marginBottom: '1.5rem',\n              boxShadow: '0 4px 12px rgba(245, 158, 11, 0.25)'\n            }}>\n              <div style={{ display: 'flex', alignItems: 'flex-start', gap: '1rem', marginBottom: '1rem' }}>\n                <div style={{\n                  background: '#f59e0b',\n                  color: 'white',\n                  borderRadius: '50%',\n                  width: '48px',\n                  height: '48px',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  fontSize: '1.5rem',\n                  flexShrink: 0\n                }}>\n                  <FontAwesomeIcon icon={faExclamationTriangle} />\n                </div>\n                <div style={{ flex: 1 }}>\n                  <div style={{ fontWeight: 700, color: '#92400e', fontSize: '1.1rem', marginBottom: '0.5rem' }}>\n                     DLEIT: Aktualizace faktury vzan na objednvku\n                  </div>\n                  <div style={{ fontSize: '0.95rem', color: '#78350f', lineHeight: '1.6' }}>\n                    Editace faktury vzan na objednvku <strong>{orderData.cislo_objednavky || orderData.evidencni_cislo}</strong> zpsob, \n                    e objednvka bude muset znovu projt <strong>vcnou sprvnost</strong> a kontrolou.\n                  </div>\n                </div>\n              </div>\n              <div style={{\n                background: 'rgba(255, 255, 255, 0.5)',\n                borderRadius: '6px',\n                padding: '0.75rem',\n                fontSize: '0.9rem',\n                color: '#78350f'\n              }}>\n                <strong>Co se stane po uloen:</strong>\n                <ul style={{ margin: '0.5rem 0 0 1.5rem', paddingLeft: 0 }}>\n                  <li>Objednvka bude vrcena do stavu <strong>\"Vcn sprvnost\"</strong></li>\n                  <li>Objednatel, garant a schvalovatel obdr notifikaci</li>\n                  <li>Bude nutn provst novou kontrolu a schvlen</li>\n                </ul>\n              </div>\n            </div>\n          )}\n          \n          {/* VAROVN: Nelze pidat/upravit fakturu k objednvce v nevhodnm stavu */}\n          {formData.order_id && orderData && !canAddInvoiceToOrder(orderData).allowed && (\n            <div style={{\n              background: editingInvoiceId ? '#fee2e2' : '#fef3c7',\n              border: editingInvoiceId ? '3px solid #dc2626' : '2px solid #f59e0b',\n              borderRadius: '8px',\n              padding: '1rem',\n              marginBottom: '1rem',\n              display: 'flex',\n              alignItems: 'flex-start',\n              gap: '0.75rem'\n            }}>\n              <FontAwesomeIcon \n                icon={faExclamationTriangle} \n                style={{ \n                  color: editingInvoiceId ? '#dc2626' : '#f59e0b', \n                  marginTop: '0.25rem', \n                  fontSize: '1.25rem' \n                }} \n              />\n              <div style={{ flex: 1 }}>\n                <div style={{ \n                  fontWeight: 600, \n                  color: editingInvoiceId ? '#991b1b' : '#92400e', \n                  marginBottom: '0.25rem' \n                }}>\n                   {editingInvoiceId ? 'Nelze aktualizovat fakturu u tto objednvky' : 'Nelze pidat fakturu k tto objednvce'}\n                </div>\n                <div style={{ fontSize: '0.9rem', color: editingInvoiceId ? '#991b1b' : '#78350f' }}>\n                  {canAddInvoiceToOrder(orderData).reason}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* VAROVN: Zmna kritickch pol vyaduje nov schvlen */}\n          {editingInvoiceId && hasChangedCriticalField && (\n            <div style={{\n              background: 'linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)',\n              border: '2px solid #fb923c',\n              borderRadius: '8px',\n              padding: '1rem',\n              marginBottom: '1rem',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '0.75rem'\n            }}>\n              <FontAwesomeIcon icon={faExclamationTriangle} style={{ color: '#ea580c', fontSize: '1.25rem' }} />\n              <div style={{ flex: 1, fontSize: '0.9rem', color: '#9a3412' }}>\n                <strong>Pozor:</strong> Zmnili jste kritick pole faktury (stka, slo, stedisko, typ nebo datum). \n                Po uloen bude nutn <strong>znovu schvlit vcnou sprvnost</strong>.\n              </div>\n            </div>\n          )}\n\n          {/* TLATKA */}\n          {!isReadOnlyMode && (\n          <ButtonGroup>\n            <Button $variant=\"secondary\" onClick={handleBack} disabled={loading}>\n              <FontAwesomeIcon icon={faTimes} />\n              Zruit\n            </Button>\n            <Button \n              $variant=\"primary\" \n              onClick={handleSubmit} \n              disabled={loading || (formData.order_id && orderData && !canAddInvoiceToOrder(orderData).allowed)}\n              title={\n                formData.order_id && orderData && !canAddInvoiceToOrder(orderData).allowed\n                  ? canAddInvoiceToOrder(orderData).reason\n                  : ''\n              }\n            >\n              <FontAwesomeIcon icon={loading ? faExclamationTriangle : faSave} />\n              {loading ? 'Ukldm...' : (() => {\n                //  OPRAVA: Tlatko je \"Aktualizovat\" jen pokud:\n                // 1. Mme editingInvoiceId (faktura existuje v DB)\n                // 2. A ZROVE uivatel potvrdil fakturu (klikl na Zaevidovat)\n                // Tm pedejdeme situaci, kdy se tlatko zmn na \"Aktualizovat\"\n                // jen kvli auto-vytvoen faktury pi uploadu plohy\n                if (editingInvoiceId && invoiceUserConfirmed) {\n                  // Editace faktury - pokud pidvme entitu (pvodn nemla), zobrazit \"Piadit\"\n                  if ((formData.order_id || formData.smlouva_id) && !hadOriginalEntity) {\n                    if (formData.smlouva_id) {\n                      return 'Piadit fakturu ke smlouv';\n                    }\n                    return 'Piadit fakturu k objednvce';\n                  }\n                  return 'Aktualizovat fakturu';\n                }\n                // Nov faktura\n                if (formData.order_id && orderData) {\n                  return 'Piadit fakturu k objednvce';\n                }\n                if (formData.smlouva_id && smlouvaData) {\n                  return 'Piadit fakturu ke smlouv';\n                }\n                return 'Zaevidovat fakturu';\n              })()}\n            </Button>\n          </ButtonGroup>\n          )}\n            </SectionContent>\n          </CollapsibleSection>\n\n          {/*  SEKCE 2: VCN SPRVNOST K FAKTUE - collapsible */}\n          <CollapsibleSection data-section=\"material-correctness\">\n            <CollapsibleHeader onClick={() => toggleSection('materialCorrectness')}>\n              <HeaderLeft>\n                <FontAwesomeIcon icon={faClipboardCheck} />\n                Vcn sprvnost k faktue\n              </HeaderLeft>\n              <HeaderRight>\n                {/* Badge pro omezen uivatele */}\n                {!hasPermission('INVOICE_MANAGE') && hasPermission('INVOICE_MATERIAL_CORRECTNESS') && (\n                  <span style={{ \n                    marginRight: '1rem',\n                    background: '#fef3c7',\n                    padding: '0.25rem 0.75rem',\n                    borderRadius: '4px',\n                    color: '#92400e',\n                    fontSize: '0.8rem',\n                    fontWeight: 600,\n                    border: '2px solid #fbbf24'\n                  }}>\n                    V KOL\n                  </span>\n                )}\n                <CollapseButton $collapsed={!sectionStates.materialCorrectness}>\n                  <FontAwesomeIcon icon={faChevronDown} />\n                </CollapseButton>\n              </HeaderRight>\n            </CollapsibleHeader>\n            <SectionContent $collapsed={!sectionStates.materialCorrectness}>\n              <FakturaCard>\n                {/* Informace - Objednvka je dokonena */}\n                {isOrderCompleted && (\n                  <div style={{\n                    background: '#f0f9ff',\n                    border: '2px solid #0284c7',\n                    borderRadius: '8px',\n                    padding: '1rem',\n                    marginBottom: '1rem',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '0.75rem'\n                  }}>\n                    <FontAwesomeIcon icon={faCheckCircle} style={{ color: '#0284c7', fontSize: '1.5rem' }} />\n                    <div style={{ flex: 1 }}>\n                      <div style={{ fontWeight: 700, color: '#075985', fontSize: '0.95rem', marginBottom: '0.25rem' }}>\n                        Objednvka je dokonena\n                      </div>\n                      <div style={{ fontSize: '0.85rem', color: '#0c4a6e' }}>\n                        Vcn kontrola ji byla provedena. Pole jsou pouze pro ten.\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* Porovnn MAX CENA vs FAKTURA */}\n                {orderData && orderData.max_cena_s_dph && formData.fa_castka && (\n                  (() => {\n                    const maxCena = parseFloat(orderData.max_cena_s_dph) || 0;\n                    const fakturaCastka = parseFloat(formData.fa_castka) || 0;\n                    const rozdil = fakturaCastka - maxCena;\n                    const prekroceno = rozdil > 0;\n\n                    return (\n                      <div style={{\n                        background: prekroceno ? '#fef2f2' : '#f0fdf4',\n                        border: `1px solid ${prekroceno ? '#ef4444' : '#22c55e'}`,\n                        borderRadius: '6px',\n                        padding: '0.75rem',\n                        marginBottom: '1rem',\n                        fontSize: '0.85rem'\n                      }}>\n                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>\n                          <span style={{ color: '#6b7280' }}>Max. cena objednvky s DPH:</span>\n                          <span style={{ fontWeight: '600', color: '#374151' }}>\n                            {maxCena.toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K\n                          </span>\n                        </div>\n                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>\n                          <span style={{ color: '#6b7280' }}>stka faktury s DPH:</span>\n                          <span style={{ fontWeight: '600', color: '#374151' }}>\n                            {fakturaCastka.toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K\n                          </span>\n                        </div>\n                        <div style={{ \n                          display: 'flex', \n                          justifyContent: 'space-between', \n                          paddingTop: '0.5rem', \n                          borderTop: '1px solid #e5e7eb',\n                          fontWeight: '700'\n                        }}>\n                          <span style={{ color: prekroceno ? '#dc2626' : '#16a34a' }}>\n                            {prekroceno ? ' Pekroen:' : ' Rozdl:'}\n                          </span>\n                          <span style={{ color: prekroceno ? '#dc2626' : '#16a34a' }}>\n                            {prekroceno ? '+' : ''}{rozdil.toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K\n                          </span>\n                        </div>\n                      </div>\n                    );\n                  })()\n                )}\n\n                <FieldRow $columns=\"1fr\">\n                  <FieldGroup>\n                    <FieldLabel>Umstn majetku</FieldLabel>\n                    <input\n                      type=\"text\"\n                      value={formData.vecna_spravnost_umisteni_majetku || ''}\n                      disabled={isOrderCompleted || loading}\n                      onChange={(e) => setFormData(prev => ({ ...prev, vecna_spravnost_umisteni_majetku: e.target.value }))}\n                      placeholder=\"Nap. Kladno, budova K2, mstnost 203\"\n                      style={{\n                        width: '100%',\n                        padding: '0.75rem',\n                        fontSize: '0.95rem',\n                        border: '2px solid #e5e7eb',\n                        borderRadius: '8px',\n                        outline: 'none',\n                        transition: 'all 0.2s',\n                        background: (isOrderCompleted || loading) ? '#f9fafb' : 'white',\n                        cursor: (isOrderCompleted || loading) ? 'not-allowed' : 'text'\n                      }}\n                      onFocus={(e) => {\n                        if (!isOrderCompleted && !loading) {\n                          e.target.style.borderColor = '#3b82f6';\n                          e.target.style.boxShadow = '0 0 0 3px rgba(59, 130, 246, 0.1)';\n                        }\n                      }}\n                      onBlur={(e) => {\n                        e.target.style.borderColor = '#e5e7eb';\n                        e.target.style.boxShadow = 'none';\n                      }}\n                    />\n                  </FieldGroup>\n                </FieldRow>\n\n                <FieldRow $columns=\"1fr\">\n                  <FieldGroup>\n                    <FieldLabel \n                      required={orderData && formData.fa_castka && parseFloat(formData.fa_castka) > parseFloat(orderData.max_cena_s_dph || 0)}\n                      style={(orderData && formData.fa_castka && parseFloat(formData.fa_castka) > parseFloat(orderData.max_cena_s_dph || 0)) ? {color: '#dc2626', fontWeight: '700'} : {}}\n                    >\n                      Poznmka k vcn sprvnosti\n                      {(orderData && formData.fa_castka && parseFloat(formData.fa_castka) > parseFloat(orderData.max_cena_s_dph || 0)) && ' (POVINN - faktura pekrauje MAX cenu)'}\n                    </FieldLabel>\n                    <textarea\n                      value={formData.vecna_spravnost_poznamka || ''}\n                      disabled={isOrderCompleted || loading}\n                      onChange={(e) => setFormData(prev => ({ ...prev, vecna_spravnost_poznamka: e.target.value }))}\n                      placeholder=\"Voliteln poznmka k vcn sprvnosti...\"\n                      rows={2}\n                      style={{\n                        width: '100%',\n                        padding: '0.75rem',\n                        fontSize: '0.95rem',\n                        border: '2px solid #e5e7eb',\n                        borderRadius: '8px',\n                        outline: 'none',\n                        transition: 'all 0.2s',\n                        background: (isOrderCompleted || loading) ? '#f9fafb' : 'white',\n                        cursor: (isOrderCompleted || loading) ? 'not-allowed' : 'text',\n                        resize: 'vertical',\n                        fontFamily: 'inherit'\n                      }}\n                      onFocus={(e) => {\n                        if (!isOrderCompleted && !loading) {\n                          e.target.style.borderColor = '#3b82f6';\n                          e.target.style.boxShadow = '0 0 0 3px rgba(59, 130, 246, 0.1)';\n                        }\n                      }}\n                      onBlur={(e) => {\n                        e.target.style.borderColor = '#e5e7eb';\n                        e.target.style.boxShadow = 'none';\n                      }}\n                    />\n                  </FieldGroup>\n                </FieldRow>\n\n                {/*  LP ERPN EDITOR - pro faktury s LP financovnm */}\n                {(() => {\n                  if (!orderData || !orderData.financovani) {\n                    return null;\n                  }\n                  \n                  try {\n                    const fin = typeof orderData.financovani === 'string' \n                      ? JSON.parse(orderData.financovani) \n                      : orderData.financovani;\n                    \n                    if (fin?.typ === 'LP') {\n                      return (\n                        <LPCerpaniEditor\n                          faktura={formData}\n                          orderData={orderData}\n                          lpCerpani={lpCerpani}\n                          availableLPCodes={dictionaries.data?.lpKodyOptions || []}\n                          onChange={(newLpCerpani) => setLpCerpani(newLpCerpani)}\n                          disabled={isOrderCompleted || loading}\n                        />\n                      );\n                    } else {\n                      return null;\n                    }\n                  } catch (e) {\n                    console.error(' [LP Editor] Chyba pi parsovn financovn:', e);\n                    return null;\n                  }\n                })()}\n\n                {/* Checkbox potvrzen vcn sprvnosti */}\n                <div style={{\n                  marginTop: '1rem',\n                  padding: '0.75rem',\n                  background: '#ffffff',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '6px'\n                }}>\n                  <label style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '0.75rem',\n                    cursor: (isOrderCompleted || loading) ? 'not-allowed' : 'pointer',\n                    fontSize: '0.9rem',\n                    fontWeight: (isOrderCompleted || loading) ? '400' : '600',\n                    color: (isOrderCompleted || loading) ? '#9ca3af' : '#374151'\n                  }}>\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.vecna_spravnost_potvrzeno === 1}\n                      disabled={isOrderCompleted || loading}\n                      onChange={(e) => {\n                        const newValue = e.target.checked ? 1 : 0;\n                        \n                        let updatedFields = { vecna_spravnost_potvrzeno: newValue };\n                        if (newValue === 1 && user_id && !formData.potvrdil_vecnou_spravnost_id) {\n                          const now = new Date();\n                          const year = now.getFullYear();\n                          const month = String(now.getMonth() + 1).padStart(2, '0');\n                          const day = String(now.getDate()).padStart(2, '0');\n                          const hours = String(now.getHours()).padStart(2, '0');\n                          const minutes = String(now.getMinutes()).padStart(2, '0');\n                          const seconds = String(now.getSeconds()).padStart(2, '0');\n                          const localTimestamp = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\n                          \n                          updatedFields.potvrdil_vecnou_spravnost_id = user_id;\n                          updatedFields.dt_potvrzeni_vecne_spravnosti = localTimestamp;\n                        }\n                        \n                        setFormData(prev => ({ ...prev, ...updatedFields }));\n                      }}\n                      style={{\n                        width: '18px',\n                        height: '18px',\n                        cursor: (isOrderCompleted || loading) ? 'not-allowed' : 'pointer',\n                        accentColor: (isOrderCompleted || loading) ? '#9ca3af' : '#16a34a'\n                      }}\n                    />\n                    <span style={{ flex: 1 }}>\n                      Potvrzuji vcnou sprvnost faktury\n                    </span>\n                    {(formData.vecna_spravnost_potvrzeno === 1) && (\n                      <span style={{\n                        fontSize: '0.75rem',\n                        color: '#16a34a',\n                        background: '#dcfce7',\n                        padding: '0.25rem 0.5rem',\n                        borderRadius: '4px',\n                        fontWeight: '600'\n                      }}>\n                         ZKONTROLOVNO\n                      </span>\n                    )}\n                  </label>\n                </div>\n\n                {/* Tlatka pro update vcn sprvnosti */}\n                {editingInvoiceId && (\n                  <div style={{\n                    marginTop: '1.5rem',\n                    paddingTop: '1.5rem',\n                    borderTop: '2px solid #e5e7eb',\n                    display: 'flex',\n                    gap: '1rem',\n                    justifyContent: 'flex-end'\n                  }}>\n                    <button\n                      onClick={() => {\n                        // Pro omezen uivatele - vrtit na seznam faktur\n                        if (isReadOnlyMode) {\n                          navigate('/invoices25-list');\n                          return;\n                        }\n                        \n                        // Pro uivatele s vym oprvnnm - zruit zmny vcn sprvnosti\n                        if (originalFormData) {\n                          setFormData(prev => ({\n                            ...prev,\n                            vecna_spravnost_umisteni_majetku: originalFormData.vecna_spravnost_umisteni_majetku || '',\n                            vecna_spravnost_poznamka: originalFormData.vecna_spravnost_poznamka || '',\n                            vecna_spravnost_potvrzeno: originalFormData.vecna_spravnost_potvrzeno || 0,\n                            potvrdil_vecnou_spravnost_id: originalFormData.potvrdil_vecnou_spravnost_id || null,\n                            dt_potvrzeni_vecne_spravnosti: originalFormData.dt_potvrzeni_vecne_spravnosti || ''\n                          }));\n                        }\n                        showToast && showToast('Zmny vcn sprvnosti zrueny', 'info');\n                      }}\n                      disabled={loading}\n                      style={{\n                        padding: '0.75rem 1.5rem',\n                        background: '#6b7280',\n                        color: 'white',\n                        border: 'none',\n                        borderRadius: '8px',\n                        fontSize: '0.95rem',\n                        fontWeight: '600',\n                        cursor: loading ? 'not-allowed' : 'pointer',\n                        opacity: loading ? 0.6 : 1,\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => !loading && (e.target.style.background = '#4b5563')}\n                      onMouseLeave={(e) => !loading && (e.target.style.background = '#6b7280')}\n                    >\n                      {isReadOnlyMode ? 'Opustit formul' : 'Zruit'}\n                    </button>\n                    <button\n                      onClick={handleUpdateMaterialCorrectness}\n                      disabled={loading}\n                      style={{\n                        padding: '0.75rem 1.5rem',\n                        background: loading ? '#9ca3af' : '#16a34a',\n                        color: 'white',\n                        border: 'none',\n                        borderRadius: '8px',\n                        fontSize: '0.95rem',\n                        fontWeight: '600',\n                        cursor: loading ? 'not-allowed' : 'pointer',\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '0.5rem',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => !loading && (e.target.style.background = '#15803d')}\n                      onMouseLeave={(e) => !loading && (e.target.style.background = '#16a34a')}\n                    >\n                      <FontAwesomeIcon icon={loading ? faSpinner : faSave} spin={loading} />\n                      Aktualizovat vcnou sprvnost\n                    </button>\n                  </div>\n                )}\n              </FakturaCard>\n            </SectionContent>\n          </CollapsibleSection>\n          </FormColumnContent>\n        </FormColumn>\n\n        {/* PRAV STRANA - NHLED OBJEDNVKY / SMLOUVY (40%) */}\n        <PreviewColumn>\n          <PreviewColumnHeader>\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', flex: 1 }}>\n              {/* Prvn dek: Nhled + EV.. - dynamick podle typu */}\n              <div style={{ \n                display: 'flex', \n                alignItems: 'center', \n                justifyContent: 'space-between', \n                gap: '1rem', \n                paddingBottom: '12px',\n                borderBottom: (orderData || smlouvaData) ? (selectedType === 'smlouva' ? '2px solid #10b981' : '2px solid #3498db') : '2px solid #e5e7eb',\n                marginBottom: '1rem'\n              }}>\n                <SectionTitle style={{ margin: 0, border: 'none', paddingBottom: 0, whiteSpace: 'nowrap' }}>\n                  {(orderData || smlouvaData) ? (\n                    <>\n                      <FontAwesomeIcon icon={selectedType === 'smlouva' ? faFileContract : faBuilding} />\n                      {selectedType === 'smlouva' ? 'Nhled smlouvy' : 'Nhled objednvky'}\n                    </>\n                  ) : (\n                    <>\n                      <FontAwesomeIcon icon={faBuilding} />\n                      Nhled\n                    </>\n                  )}\n                </SectionTitle>\n                {orderData && selectedType === 'order' && (\n                  <span style={{ fontWeight: 700, color: '#1e40af', fontSize: '1.05rem', whiteSpace: 'nowrap' }}>\n                    {orderData.cislo_objednavky || `#${orderData.id}`}\n                  </span>\n                )}\n                {smlouvaData && selectedType === 'smlouva' && (\n                  <span style={{ fontWeight: 700, color: '#059669', fontSize: '1.05rem', whiteSpace: 'nowrap' }}>\n                    {smlouvaData.cislo_smlouvy || `#${smlouvaData.id}`}\n                  </span>\n                )}\n              </div>\n\n              {/* Druh dek: Souty + STAV */}\n              {orderData && (\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', gap: '0.75rem', flexWrap: 'wrap' }}>\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>\n                    {/* STAV */}\n                    <div \n                      onClick={() => {\n                        // Nejdv rozbalit sekci\n                        if (orderFormRef.current?.expandSectionByName) {\n                          orderFormRef.current.expandSectionByName('schvaleni');\n                        }\n                        // Pak scrollovat\n                        setTimeout(() => {\n                          const section = document.querySelector('[data-section=\"schvaleni\"]');\n                          if (section) {\n                            section.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                          }\n                        }, 100);\n                      }}\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px',\n                        padding: '0.4rem 0.75rem',\n                        background: 'linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)',\n                        border: '2px solid #10b981',\n                        borderRadius: '6px',\n                        fontSize: '0.7rem',\n                        fontWeight: 600,\n                        color: '#065f46',\n                        boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\n                        whiteSpace: 'nowrap',\n                        cursor: 'pointer',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'scale(1.05)';\n                        e.currentTarget.style.boxShadow = '0 4px 8px rgba(16, 185, 129, 0.3)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'scale(1)';\n                        e.currentTarget.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.05)';\n                      }}\n                    >\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n                        <div style={{ fontSize: '0.6rem', opacity: 0.8, fontWeight: 500 }}>\n                          STAV\n                        </div>\n                        <div style={{ fontSize: '0.85rem', fontWeight: 700 }}>\n                          {orderData.stav_objednavky || getCurrentWorkflowState(orderData)?.replace(/_/g, ' ') || 'N/A'}\n                        </div>\n                      </div>\n                    </div>\n                    {/* MAX CENA S DPH */}\n                    <div \n                      onClick={() => {\n                        // Nejdv rozbalit sekci\n                        if (orderFormRef.current?.expandSectionByName) {\n                          orderFormRef.current.expandSectionByName('schvaleni');\n                        }\n                        // Pak scrollovat\n                        setTimeout(() => {\n                          const section = document.querySelector('[data-section=\"schvaleni\"]');\n                          if (section) {\n                            section.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                          }\n                        }, 100);\n                      }}\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px',\n                        padding: '0.4rem 0.75rem',\n                        background: 'linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%)',\n                        border: '2px solid #64748b',\n                        borderRadius: '6px',\n                        fontSize: '0.7rem',\n                        fontWeight: 600,\n                        color: '#1e293b',\n                        boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\n                        whiteSpace: 'nowrap',\n                        cursor: 'pointer',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'scale(1.05)';\n                        e.currentTarget.style.boxShadow = '0 4px 8px rgba(100, 116, 139, 0.3)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'scale(1)';\n                        e.currentTarget.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.05)';\n                      }}\n                    >\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n                        <div style={{ fontSize: '0.6rem', opacity: 0.8, fontWeight: 500 }}>\n                          MAX CENA S DPH\n                        </div>\n                        <div style={{ fontSize: '0.85rem', fontWeight: 700 }}>\n                          {parseFloat(orderData.max_cena_s_dph || 0).toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Souet poloek objednvky */}\n                    <div \n                      onClick={() => {\n                        // Nejdv rozbalit sekci\n                        if (orderFormRef.current?.expandSectionByName) {\n                          orderFormRef.current.expandSectionByName('detaily');\n                        }\n                        // Pak scrollovat\n                        setTimeout(() => {\n                          const section = document.querySelector('[data-section=\"detaily\"]');\n                          if (section) {\n                            section.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                          }\n                        }, 100);\n                      }}\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px',\n                        padding: '0.4rem 0.75rem',\n                        background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)',\n                        border: '2px solid #fbbf24',\n                        borderRadius: '6px',\n                        fontSize: '0.7rem',\n                        fontWeight: 600,\n                        color: '#92400e',\n                        boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\n                        whiteSpace: 'nowrap',\n                        cursor: 'pointer',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'scale(1.05)';\n                        e.currentTarget.style.boxShadow = '0 4px 8px rgba(251, 191, 36, 0.3)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'scale(1)';\n                        e.currentTarget.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.05)';\n                      }}\n                    >\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n                        <div style={{ fontSize: '0.6rem', opacity: 0.8, fontWeight: 500 }}>\n                          POLOKY (DPH)\n                        </div>\n                        <div style={{ fontSize: '0.85rem', fontWeight: 700 }}>\n                          {parseFloat(orderData.polozky_celkova_cena_s_dph || 0).toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Souet faktur */}\n                    <div \n                      onClick={() => {\n                        // Nejdv rozbalit sekci\n                        if (orderFormRef.current?.expandSectionByName) {\n                          orderFormRef.current.expandSectionByName('faktury');\n                        }\n                        // Pak scrollovat\n                        setTimeout(() => {\n                          const section = document.querySelector('[data-section=\"faktury\"]');\n                          if (section) {\n                            section.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                          }\n                        }, 100);\n                      }}\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '6px',\n                        padding: '0.4rem 0.75rem',\n                        background: 'linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)',\n                        border: '2px solid #3b82f6',\n                        borderRadius: '6px',\n                        fontSize: '0.7rem',\n                        fontWeight: 600,\n                        color: '#1e40af',\n                        boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\n                        whiteSpace: 'nowrap',\n                        cursor: 'pointer',\n                        transition: 'all 0.2s'\n                      }}\n                      onMouseEnter={(e) => {\n                        e.currentTarget.style.transform = 'scale(1.05)';\n                        e.currentTarget.style.boxShadow = '0 4px 8px rgba(59, 130, 246, 0.3)';\n                      }}\n                      onMouseLeave={(e) => {\n                        e.currentTarget.style.transform = 'scale(1)';\n                        e.currentTarget.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.05)';\n                      }}\n                    >\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>\n                        <div style={{ fontSize: '0.6rem', opacity: 0.8, fontWeight: 500 }}>\n                          FAKTURY\n                        </div>\n                        <div style={{ fontSize: '0.85rem', fontWeight: 700 }}>\n                          {(() => {\n                            const total = orderData.faktury?.reduce((sum, faktura) => {\n                              const castka = parseFloat(faktura.fa_castka || 0);\n                              return sum + castka;\n                            }, 0) || 0;\n                            return total.toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' K';\n                          })()}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <ToggleButton\n                    onClick={() => {\n                      if (hasAnySectionCollapsed) {\n                        orderFormRef.current?.expandAll();\n                      } else {\n                        orderFormRef.current?.collapseAll();\n                      }\n                    }}\n                  >\n                    <FontAwesomeIcon icon={hasAnySectionCollapsed ? faChevronDown : faChevronUp} />\n                    {hasAnySectionCollapsed ? 'Rozbalit ve' : 'Sbalit ve'}\n                  </ToggleButton>\n                </div>\n              )}\n            </div>\n          </PreviewColumnHeader>\n\n          <PreviewColumnContent>\n          {orderLoading && (\n            <LoadingOverlay>\n              <LoadingSpinner />\n              <div>Natm {selectedType === 'smlouva' ? 'smlouvu' : 'objednvku'}...</div>\n            </LoadingOverlay>\n          )}\n\n          {!orderLoading && !orderData && !smlouvaData && formData.order_id && (\n            <ErrorAlert>\n              <FontAwesomeIcon icon={faExclamationTriangle} />\n              Nepodailo se nast objednvku ID {formData.order_id}\n            </ErrorAlert>\n          )}\n\n          {!orderLoading && !orderData && !smlouvaData && !formData.order_id && (\n            <div style={{ color: '#94a3af', textAlign: 'center', padding: '3rem' }}>\n              <FontAwesomeIcon icon={selectedType === 'smlouva' ? faFileContract : faBuilding} size=\"3x\" style={{ marginBottom: '1rem', opacity: 0.3 }} />\n              <div style={{ fontSize: '1.1rem', marginBottom: '0.5rem' }}>\n                {selectedType === 'smlouva' ? 'dn smlouva nevybrna' : 'dn objednvka nevybrna'}\n              </div>\n              <div style={{ fontSize: '0.9rem' }}>\n                Zante pst do pole \"Vyberte objednvku nebo smlouvu\"\n              </div>\n            </div>\n          )}\n\n          {/* NHLED OBJEDNVKY */}\n          {!orderLoading && orderData && selectedType === 'order' && (\n            <OrderFormReadOnly \n              ref={orderFormRef} \n              orderData={orderData}\n              onCollapseChange={setHasAnySectionCollapsed}\n              onEditInvoice={isReadOnlyMode ? null : handleEditInvoice}\n              canEditInvoice={!isReadOnlyMode && canAddInvoiceToOrder(orderData).allowed}\n              editingInvoiceId={editingInvoiceId} //  Pedat ID editovan faktury pro zvraznn\n              isReadOnlyMode={isReadOnlyMode} //  Pedat readonly reim pro zmnu textu\n              token={token}\n              username={username}\n            />\n          )}\n\n          {/* NHLED SMLOUVY */}\n          {!orderLoading && smlouvaData && selectedType === 'smlouva' && (\n            <SmlouvaPreview smlouvaData={smlouvaData} />\n          )}\n\n          {false && orderData && (\n            <OrderPreviewCard>\n              <OrderHeaderRow>\n                <OrderNumber>\n                  {orderData.evidencni_cislo || `Obj. #${orderData.id}`}\n                </OrderNumber>\n                <OrderBadge $color={orderData.stav_workflow_kod === 'ODESLANA' ? '#10b981' : '#3b82f6'}>\n                  {orderData.stav_workflow_nazev || 'Nezn. stav'}\n                </OrderBadge>\n              </OrderHeaderRow>\n\n              <OrderDetailRow>\n                <OrderDetailLabel>Pedmt:</OrderDetailLabel>\n                <OrderDetailValue style={{ fontWeight: 500 }}>\n                  {orderData.predmet || 'N/A'}\n                </OrderDetailValue>\n              </OrderDetailRow>\n\n              <OrderDetailRow>\n                <OrderDetailLabel>\n                  <FontAwesomeIcon icon={faMoneyBillWave} /> Max. cena s DPH:\n                </OrderDetailLabel>\n                <OrderDetailValue style={{ fontWeight: 600, color: '#1e40af' }}>\n                  {orderData.max_cena_s_dph \n                    ? `${Number(orderData.max_cena_s_dph).toLocaleString('cs-CZ')} K` \n                    : 'N/A'}\n                </OrderDetailValue>\n              </OrderDetailRow>\n\n              <OrderDetailRow>\n                <OrderDetailLabel>\n                  <FontAwesomeIcon icon={faBuilding} /> Pkazce:\n                </OrderDetailLabel>\n                <OrderDetailValue>\n                  {orderData._enriched?.prikazce?.display_name || orderData.prikazce_id || 'N/A'}\n                </OrderDetailValue>\n              </OrderDetailRow>\n\n              {orderData._enriched?.dodavatel?.ico && (\n                <OrderDetailRow>\n                  <OrderDetailLabel>IO dodavatele:</OrderDetailLabel>\n                  <OrderDetailValue>\n                    {orderData._enriched.dodavatel.ico}\n                  </OrderDetailValue>\n                </OrderDetailRow>\n              )}\n\n              {orderData.dodavatel_nazev && (\n                <OrderDetailRow>\n                  <OrderDetailLabel>Dodavatel:</OrderDetailLabel>\n                  <OrderDetailValue>\n                    {orderData.dodavatel_nazev}\n                  </OrderDetailValue>\n                </OrderDetailRow>\n              )}\n\n              <OrderDetailRow>\n                <OrderDetailLabel>\n                  <FontAwesomeIcon icon={faCalendar} /> Datum vytvoen:\n                </OrderDetailLabel>\n                <OrderDetailValue>\n                  {(() => {\n                    const datum = orderData.dt_objednavky || orderData.datum_objednavky || orderData.created_at || orderData.dt_vytvoreni || orderData.datum_vytvoreni;\n                    return datum ? formatDateOnly(datum) : 'N/A';\n                  })()}\n                </OrderDetailValue>\n              </OrderDetailRow>\n\n              {orderData.garant_cele_jmeno && (\n                <OrderDetailRow>\n                  <OrderDetailLabel>Garant:</OrderDetailLabel>\n                  <OrderDetailValue>\n                    {orderData.garant_cele_jmeno}\n                  </OrderDetailValue>\n                </OrderDetailRow>\n              )}\n\n              {orderData.cislo_smlouvy && (\n                <OrderDetailRow>\n                  <OrderDetailLabel>slo smlouvy:</OrderDetailLabel>\n                  <OrderDetailValue>\n                    {orderData.cislo_smlouvy}\n                  </OrderDetailValue>\n                </OrderDetailRow>\n              )}\n            </OrderPreviewCard>\n          )}\n          </PreviewColumnContent>\n        </PreviewColumn>\n      </ContentLayout>\n    </>\n  );\n\n  // Render: normln reim vs fullscreen reim (portal)\n  return (\n    <>\n      {isFullscreen ? (\n        createPortal(\n          <FullscreenOverlay>\n            {PageContent}\n          </FullscreenOverlay>,\n          document.body\n        )\n      ) : (\n        <PageContainer>\n          {PageContent}\n        </PageContainer>\n      )}\n\n      {/*  Modal pro zamenou objednvku - informan dialog */}\n      {lockedOrderInfo && createPortal(\n        <ConfirmDialog\n          isOpen={showLockedOrderDialog}\n          onClose={() => {\n            setShowLockedOrderDialog(false);\n            setLockedOrderInfo(null);\n          }}\n          onConfirm={() => {\n            setShowLockedOrderDialog(false);\n            setLockedOrderInfo(null);\n          }}\n          title=\"Objednvka nen dostupn\"\n          icon={faLock}\n          variant=\"warning\"\n          confirmText=\"Zavt\"\n          showCancel={false}\n        >\n          <InfoText>\n            Objednvka je aktuln editovna uivatelem:\n          </InfoText>\n          <UserInfo>\n            <strong>{lockedOrderInfo.lockedByUserName}</strong>\n          </UserInfo>\n\n          {/* Kontaktn daje */}\n          {(lockedOrderInfo.lockedByUserEmail || lockedOrderInfo.lockedByUserTelefon) && (\n            <ContactInfo>\n              {lockedOrderInfo.lockedByUserEmail && (\n                <ContactItem>\n                  <FontAwesomeIcon icon={faEnvelope} />\n                  <ContactLabel>Email:</ContactLabel>\n                  <a href={`mailto:${lockedOrderInfo.lockedByUserEmail}`}>\n                    {lockedOrderInfo.lockedByUserEmail}\n                  </a>\n                </ContactItem>\n              )}\n              {lockedOrderInfo.lockedByUserTelefon && (\n                <ContactItem>\n                  <FontAwesomeIcon icon={faPhone} />\n                  <ContactLabel>Telefon:</ContactLabel>\n                  <a href={`tel:${lockedOrderInfo.lockedByUserTelefon}`}>\n                    {lockedOrderInfo.lockedByUserTelefon}\n                  </a>\n                </ContactItem>\n              )}\n            </ContactInfo>\n          )}\n\n          {/* as zamen */}\n          {lockedOrderInfo.lockAgeMinutes !== null && lockedOrderInfo.lockAgeMinutes !== undefined && (\n            <LockTimeInfo>\n              <FontAwesomeIcon icon={faClock} />\n              Zameno ped {lockedOrderInfo.lockAgeMinutes} {lockedOrderInfo.lockAgeMinutes === 1 ? 'minutou' : lockedOrderInfo.lockAgeMinutes < 5 ? 'minutami' : 'minutami'}\n            </LockTimeInfo>\n          )}\n\n          <InfoText>\n            Objednvku nelze nast, dokud ji m otevenou jin uivatel.\n            Prosm, kontaktujte uivatele ve a podejte ho o uloen a zaven objednvky.\n          </InfoText>\n        </ConfirmDialog>,\n        document.body\n      )}\n\n      {/*  Custom Confirm Dialog - VDY v portlu nad vm */}\n      {confirmDialog.isOpen && createPortal(\n        <ConfirmDialog\n          isOpen={confirmDialog.isOpen}\n          title={confirmDialog.title}\n          message={confirmDialog.message}\n          confirmText={confirmDialog.onCancel ? \"Ano, pokraovat\" : \"OK\"}\n          cancelText=\"Zruit\"\n          showCancel={!!confirmDialog.onCancel}\n          variant=\"warning\"\n          icon={faExclamationTriangle}\n          onConfirm={() => {\n            if (confirmDialog.onConfirm) {\n              confirmDialog.onConfirm();\n            }\n          }}\n          onClose={confirmDialog.onCancel ? () => {\n            if (confirmDialog.onCancel) {\n              confirmDialog.onCancel();\n            }\n          } : () => {}}\n        />,\n        document.body\n      )}\n\n      {/*  Spisovka Inbox Panel - pouze pro ADMIN */}\n      {hasPermission('ADMIN') && spisovkaInboxOpen && (\n        <SpisovkaInboxPanel\n          panelState={spisovkaInboxState}\n          setPanelState={setSpisovkaInboxState}\n          beginDrag={handleSpisovkaInboxDrag}\n          onClose={() => setSpisovkaInboxOpen(false)}\n          onOCRDataExtracted={handleOCRDataExtracted}\n          token={token}\n          username={username}\n          showToast={showToast}\n        />\n      )}\n\n      {/*  Progress Modal - zobrazen prbhu ukldn faktury */}\n      {progressModal.show && createPortal(\n        <ProgressOverlay>\n          <ProgressModal>\n            <ProgressHeader>\n              <ProgressIconWrapper status={progressModal.status}>\n                {progressModal.status === 'loading' && <FontAwesomeIcon icon={faSpinner} spin />}\n                {progressModal.status === 'success' && <FontAwesomeIcon icon={faCheckCircle} />}\n                {progressModal.status === 'error' && <FontAwesomeIcon icon={faTimesCircle} />}\n              </ProgressIconWrapper>\n              <ProgressTitle>{progressModal.title}</ProgressTitle>\n            </ProgressHeader>\n\n            <ProgressMessage>{progressModal.message}</ProgressMessage>\n\n            {progressModal.status === 'loading' && (\n              <ProgressBarWrapper>\n                <ProgressBarFill progress={progressModal.progress} />\n              </ProgressBarWrapper>\n            )}\n\n            <ProgressActions>\n              {progressModal.status === 'success' && (\n                <ProgressButton \n                  variant=\"primary\" \n                  onClick={async () => {\n                    // Pokud je to spch vcn sprvnosti - vrtit na seznam nebo zstat\n                    if (progressModal.resetData?.isVecnaSpravnost) {\n                      setProgressModal({ show: false, status: 'loading', progress: 0, title: '', message: '', resetData: null });\n                      \n                      if (progressModal.resetData?.isReadOnlyMode) {\n                        // Omezen uivatel - nvrat na seznam\n                        navigate('/invoices25-list');\n                      }\n                      // Bn uivatel zstav na strnce\n                      return;\n                    }\n                    \n                    //  KROK 1: RESET ploh a editingInvoiceId NEJDV (aby useEffect nereloadoval)\n                    setAttachments([]);\n                    setEditingInvoiceId(null);\n                    setHadOriginalEntity(false);\n                    \n                    //  Vyistit location.state (aby se effect neloadoval znovu)\n                    if (location.state?.editInvoiceId) {\n                      navigate(location.pathname, { replace: true, state: {} });\n                    }\n                    \n                    //  Vyistit localStorage HNED\n                    try {\n                      localStorage.removeItem(`invoiceForm_${user_id}`);\n                      localStorage.removeItem(`invoiceAttach_${user_id}`);\n                      localStorage.removeItem(`invoiceEdit_${user_id}`);\n                      localStorage.removeItem(`invoiceOrigEntity_${user_id}`);\n                      localStorage.removeItem('spisovka_active_dokument');\n                    } catch (err) {\n                      console.warn('Chyba pi mazn localStorage:', err);\n                    }\n                    \n                    //  KROK 2: RESET FORMULE\n                    const resetData = progressModal.resetData || {};\n                    const { wasEditing, currentOrderId, currentSmlouvaId } = resetData;\n                    \n                    //  PI UPDATE - smazat vechno vetn objednvky\n                    //  PI CREATE - ponechat objednvku pro dal fakturu\n                    const shouldResetEntity = wasEditing;\n                    \n                    // Reset formData\n                    setFormData({\n                      order_id: shouldResetEntity ? '' : currentOrderId,\n                      smlouva_id: shouldResetEntity ? null : currentSmlouvaId,\n                      fa_cislo_vema: '',\n                      fa_typ: 'BEZNA',\n                      fa_datum_doruceni: formatDateForPicker(new Date()),\n                      fa_datum_vystaveni: '',\n                      fa_datum_splatnosti: '',\n                      fa_castka: '',\n                      fa_poznamka: '',\n                      fa_strediska_kod: [],\n                      file: null,\n                      fa_predana_zam_id: null,\n                      fa_datum_predani_zam: '',\n                      fa_datum_vraceni_zam: '',\n                      vecna_spravnost_umisteni_majetku: '',\n                      vecna_spravnost_poznamka: '',\n                      vecna_spravnost_potvrzeno: 0,\n                      potvrdil_vecnou_spravnost_id: null,\n                      dt_potvrzeni_vecne_spravnosti: ''\n                    });\n                    \n                    // Reset preview entity a autocomplete pokud je poteba\n                    if (shouldResetEntity) {\n                      setOrderData(null);\n                      setSmlouvaData(null);\n                      setSearchTerm('');\n                      setShowSuggestions(false);\n                      setIsEntityUnlocked(false);\n                      setHadOriginalEntity(false);\n                    } else {\n                      //  Refresh objednvky/smlouvy pro aktualizovan faktury\n                      if (currentOrderId && orderData) {\n                        await loadOrderData(currentOrderId);\n                      }\n                      if (currentSmlouvaId && smlouvaData) {\n                        await loadSmlouvaData(currentSmlouvaId);\n                      }\n                    }\n\n                    // Reset pole errors a tracking zmn\n                    setFieldErrors({});\n                    setOriginalFormData(null);\n                    setHasChangedCriticalField(false);\n                    \n                    // Reset LP erpn\n                    setLpCerpani([]);\n                    setLpCerpaniLoaded(false);\n                    \n                    //  Reset editingInvoiceId a invoiceUserConfirmed\n                    setEditingInvoiceId(null);\n                    setInvoiceUserConfirmed(false);\n                    \n                    // Zavt progress dialog\n                    setProgressModal({ show: false, status: 'loading', progress: 0, title: '', message: '', resetData: null });\n                  }}\n                >\n                  Pokraovat\n                </ProgressButton>\n              )}\n              {progressModal.status === 'error' && (\n                <ProgressButton \n                  variant=\"primary\" \n                  onClick={() => {\n                    setProgressModal({ show: false, status: 'loading', progress: 0, title: '', message: '' });\n                  }}\n                >\n                  Zavt\n                </ProgressButton>\n              )}\n            </ProgressActions>\n          </ProgressModal>\n        </ProgressOverlay>,\n        document.body\n      )}\n    </>\n  );\n}\n"],"names":["FormContainer","styled","div","_templateObject","_taggedTemplateLiteral","Section","_templateObject2","SectionHeader","_templateObject3","props","$theme","concat","$isActive","SectionTitle","h3","_templateObject4","CollapseIcon","_templateObject5","$collapsed","SectionContent","_templateObject6","FieldRow","_templateObject7","$columns","FieldGroup","_templateObject8","FieldLabel","_templateObject9","FieldValue","_templateObject0","Badge","span","_templateObject1","$bg","$color","InfoCard","_templateObject10","CardTitle","_templateObject11","DataGrid","_templateObject12","KeyValuePair","_templateObject13","KeyLabel","_templateObject14","ValueText","_templateObject15","EditInvoiceButton","_templateObject16","button","_templateObject17","_templateObject18","OrderFormReadOnly","forwardRef","_ref","ref","_orderData$_enriched8","_orderData$_enriched9","_orderData$_enriched0","_orderData$_enriched1","_orderData$_enriched11","_orderData$_enriched12","_orderData$_enriched13","_orderData$_enriched14","_orderData$_enriched16","_orderData$_enriched17","_orderData$_enriched18","_orderData$_enriched19","_orderData$financovan","_orderData$financovan2","_orderData$financovan3","_orderData$_enriched21","_orderData$_enriched22","orderData","onCollapseChange","onEditInvoice","canEditInvoice","editingInvoiceId","isReadOnlyMode","token","username","collapsed","setCollapsed","useState","objednatel","schvaleni","dodavatel","detaily","dodani","fakturace","poznamky","registr","vecna_spravnost","dokonceni","prilohy","toggleSection","section","prev","newCollapsed","_objectSpread","hasAnyCollapsed","Object","values","some","val","collapseAll","allCollapsed","keys","forEach","key","expandAll","allExpanded","areAllCollapsed","every","areAllExpanded","useImperativeHandle","_jsxs","style","padding","textAlign","color","children","_jsx","FontAwesomeIcon","icon","faFileAlt","size","marginBottom","opacity","formatCurrency","value","parseFloat","toLocaleString","onClick","faUser","faChevronDown","className","_orderData$_enriched","_orderData$_enriched2","_orderData$uzivatel","enriched","_enriched","uzivatel","titul_pred","titul_za","jmeno","prijmeni","cele_jmeno","_orderData$_enriched3","_orderData$_enriched4","_orderData$uzivatel2","telefon","objednatel_telefon","marginTop","_orderData$_enriched5","_orderData$_enriched6","_orderData$uzivatel3","email","faCheckCircle","_orderData$_enriched7","_orderData$garant_uzi","garant_uzivatel","faClipboardCheck","predmet","cislo_objednavky","id","dt_objednavky","formatDateOnly","max_cena_s_dph","_orderData$_enriched10","_orderData$prikazce","prikazce","_orderData$_enriched15","_orderData$schvalovat","schvalovatel","faBuilding","_orderData$_enriched20","strediska","Array","isArray","map","s","nazev","kod","join","strediska_kod","faCoins","financovani","typ_nazev","typ","lp_nazvy","length","gridColumn","display","flexWrap","gap","lp","idx","lpText","cislo_lp","popis","nazev_uctu","label","String","_orderData$financovan4","_orderData$financovan5","_typKod$toUpperCase","typKod","typ_kod","zpusob_financovani","_orderData$financovan6","_orderData$financovan7","toUpperCase","call","_Fragment","cislo_smlouvy","smlouva_poznamka","_orderData$financovan8","_orderData$financovan9","_typKod$toUpperCase2","_typKod$includes","_orderData$financovan0","_orderData$financovan1","includes","individualni_schvaleni","individualni_poznamka","_orderData$financovan10","_orderData$financovan11","_typKod$toUpperCase3","_typKod$includes2","_orderData$financovan12","_orderData$financovan13","pojistna_udalost_cislo","pojistna_udalost_poznamka","alignItems","getWorkflowBadges","stav_workflow_kod","badgeColors","bg","index","colors","React","replace","margin","fontWeight","dodavatel_nazev","dodavatel_ico","dodavatel_dic","dodavatel_adresa","dodavatel_kontakt_jmeno","dodavatel_kontakt_email","dodavatel_kontakt_telefon","polozky","faBox","polozky_count","druh_objednavky","druh_objednavky_nazev","polozka","background","border","borderRadius","fontSize","lp_id","_orderData$financovan14","_orderData$financovan15","lpData","find","lp_je_platne","cena_bez_dph","sazba_dph","cena_s_dph","usek_kod","budova_kod","mistnost_kod","poznamka","paddingTop","borderTop","justifyContent","polozky_celkova_cena_s_dph","poznamka_objednavky","faTruck","misto_dodani","dt_predpokladany_termin_dodani","zaruka","dt_akceptace","_orderData$_enriched23","dodavatel_potvrdil","dodavatel_potvrdil_jmeno","jeZverejnit","zverejnit","faTimesCircle","fontStyle","dt_zverejneni","_orderData$_enriched24","zverejnil","zverejnil_jmeno","registr_iddt","faktury","faMoneyBillWave","faktura","isVecnaPotvrzena","vecna_spravnost_potvrzeno","isBeingEdited","Number","boxShadow","overflow","position","transition","borderBottom","letterSpacing","textTransform","faEdit","fa_cislo_vema","e","stopPropagation","onMouseEnter","currentTarget","onMouseLeave","fa_castka","fa_datum_vystaveni","fa_datum_splatnosti","fa_splatnost","fa_datum_doruceni","fa_typ","typColors","fa_strediska_kod","filter","Boolean","fa_poznamka","_isdoc_dodavatel","ico","faPaperclip","flexDirection","priloha","async","blob","downloadInvoiceAttachment","url","window","URL","createObjectURL","a","document","createElement","href","download","originalni_nazev_souboru","body","appendChild","click","revokeObjectURL","removeChild","error","console","alert","message","cursor","borderColor","title","faFile","flex","minWidth","textOverflow","whiteSpace","bytes","i","Math","floor","log","round","pow","formatFileSize","velikost_souboru_b","typeMap","config","getTypeBadge","typ_prilohy","faDownload","marginLeft","dt_potvrzeni_vecne_spravnosti","_faktura$_enriched","potvrdil_vecnou_spravnost_jmeno","potvrdil_vecnou_spravnost_titul_pred","potvrdil_vecnou_spravnost_titul_za","fullName","potvrdil_vecnou_spravnost_prijmeni","trim","potvrdil_vecnou_spravnost","vecna_spravnost_umisteni_majetku","vecna_spravnost_poznamka","wordBreak","faCheck","dt_schvaleni","paddingBottom","lineHeight","_orderData$_enriched25","dt_odeslani","_orderData$_enriched26","odesilatel","_orderData$_enriched27","_orderData$_enriched28","dt_faktura_pridana","_orderData$_enriched29","fakturant","_orderData$_enriched30","f","paddingLeft","indexOf","_faktura$_enriched2","titul_pred_str","titul_za_str","dt_dokonceni","_orderData$_enriched31","dokoncil","faktury_celkem_s_dph","minimumFractionDigits","maximumFractionDigits","dokonceni_poznamka","prilohy_count","downloadOrderAttachment","nazev_souboru","velikost","displayName","PreviewContainer","PreviewHeader","HeaderIcon","HeaderInfo","ContractNumber","ContractTitle","InfoGrid","InfoItem","InfoLabel","InfoValue","FullWidthInfo","AmountDisplay","AmountLabel","AmountValue","StatusBadge","$active","NoData","Intl","NumberFormat","currency","format","formatDate","dateStr","Date","toLocaleDateString","_unused","smlouvaData","loading","smlouva","faFileContract","nazev_smlouvy","pouzit_v_obj_formu","marginRight","aktivni","hodnota_s_dph","nazev_firmy","dic","faCalendar","datum_uzavreni","datum_podpisu","datum_uzavreni_smlouvy","dt_vytvoreni","platnost_od","datum_od","platnost_do","datum_do","platnostDo","isExpired","datum_ukonceni","ukonceni","faClipboardList","undefined","cerpano_celkem","cerpano","celkova_castka","Overlay","Dialog","Header","IconWrapper","Title","h2","CloseButton","Content","Message","ErrorDetails","details","Footer","Button","primary","isOpen","onClose","onConfirm","confirmText","cancelText","ReactDOM","target","AlertCircle","X","apiSpisovkaZpracovani","axios","create","baseURL","process","headers","normalizeError","err","_err$response","_err$response$data","_err$response2","_err$response2$data","_err$response3","_err$response3$data","response","data","getSpisovkaZpracovaniList","uzivatel_id","stav","limit","offset","post","Error","markSpisovkaDocumentProcessed","_ref3","dokument_id","spisovka_priloha_id","faktura_id","doba_zpracovani_s","force","success","_err$response4","_err$response5","_err$response5$data","_err$response6","_err$response6$data","status","conflict","existingRecord","existing","deleteSpisovkaZpracovani","_ref5","interceptors","use","_error$response","_error$response2","_error$response3","event","CustomEvent","detail","dispatchEvent","responseText","Promise","reject","getElementById","styleTag","textContent","head","InboxContainer","InboxHeader","InboxTitle","InboxStats","InboxContent","$status","FakturaCard","FakturaHeader","FakturaNazev","FakturaID","FakturaInfo","InfoRow","PrilohaSection","PrilohaTitle","PrilohaItem","PrilohaInfo","PrilohaFilename","PrilohaMeta","PrilohaButton","_templateObject19","LoadingBox","_templateObject20","ErrorBox","_templateObject21","EmptyBox","_templateObject22","RefreshButton","_templateObject23","FileModal","_templateObject24","y","x","innerWidth","w","h","innerHeight","FileModalContent","_templateObject25","FileModalHeader","_templateObject26","FileModalTitle","_templateObject27","FileCloseButton","_templateObject28","FileObject","iframe","_templateObject29","object","_templateObject30","PdfFallback","_templateObject31","DownloadButton","_templateObject32","TxtViewer","pre","_templateObject33","panelState","setPanelState","beginDrag","onOCRDataExtracted","showToast","setFaktury","setLoading","setError","pagination","setPagination","total","zpracovaneIds","setZpracovaneIds","Set","zpracovaneDetails","setZpracovaneDetails","Map","filterMode","setFilterMode","yearFilter","setYearFilter","getFullYear","dateRange","setDateRange","activeDokumentId","setActiveDokumentId","expandedAttachments","setExpandedAttachments","fileViewer","setFileViewer","visible","filename","type","content","ocrProgress","setOcrProgress","progress","fileViewerPosition","setFileViewerPosition","isDraggingViewer","setIsDraggingViewer","errorDialog","setErrorDialog","handleFileViewerDrag","useCallback","preventDefault","clientX","clientY","handleFileViewerDragEnd","useEffect","addEventListener","removeEventListener","calculateDateRange","range","year","now","currentYear","dateFrom","dateTo","getMonth","getDate","weekAgo","setDate","monthAgo","setMonth","quarterAgo","toISOString","split","fetchZpracovaneDokumenty","warn","processedIds","item","detailsMap","set","uzivatel_jmeno","zpracovano_kdy","handleCancelProcessing","dokumentId","fakturaId","faCisloVema","fontFamily","backgroundColor","localStorage","removeItem","fetchFaktury","apiUrl","fetch","ok","json","_data$pagination","interval","setInterval","clearInterval","checkActiveDocument","activeDokId","getItem","parsedDokId","parseInt","timeoutId","setTimeout","element","querySelector","scrollIntoView","behavior","block","inline","clearTimeout","day","month","hour","minute","second","currentStyle","left","top","width","height","minHeight","maxHeight","PanelBase","edgeHandles","PanelHeader","onMouseDown","faBookOpen","TinyBtn","faSync","spin","handleSnapRight","targetWidth","previewHeaders","from","querySelectorAll","el","parentElement","previewColumn","_previewColumn$style$","previewWidth","getBoundingClientRect","max","headerHeight","minimized","faExpand","handleMinimize","faWindowRestore","faMinus","handleClose","faTimes","dateFromTs","getTime","dateToTs","filteredCount","fakturaTs","datum_vzniku","isZaevidovano","has","onChange","years","push","mode","transform","faSpinner","faExclamationTriangle","disabled","filteredFaktury","normalize","test","isActive","isOtherActive","right","zIndex","animation","draggable","onDragStart","attachmentsData","p","download_url","mime_type","spisovka_dokument_id","spisovka_file_id","file_id","priloha_id","dataTransfer","setData","JSON","stringify","effectAllowed","onDragEnd","jid","cislo_jednaci","get","zpracovanoDate","timeAgo","timeText","slice","isPdf","isTxt","toLowerCase","endsWith","canPreview","toFixed","datumVystaveni","datumSplatnosti","variabilniSymbol","castka","proxyUrl","encodeURIComponent","statusText","contentType","contentLength","arrayBuffer","byteLength","header","Uint8Array","headerStr","fromCharCode","startsWith","text","extractTextFromPDF","extractInvoiceData","warning","resolve","then","proceed","stack","handleOCRExtraction","Sparkles","as","rel","txtContent","fetchTxtContent","newSet","delete","add","bottom","backdropFilter","maxWidth","ErrorDialog","formatDateForPicker","date","d","isNaN","CurrencyInput","fieldName","onBlur","hasError","placeholder","inputRef","useRef","localValue","setLocalValue","isFocused","setIsFocused","num","toString","formattedValue","CurrencyInputWrapper","Input","name","newValue","cleanValue","numValue","finalValue","onFocus","handleFocus","handleBlurLocal","formatted","paddingRight","$hasError","CurrencySymbol","UserInfo","InfoText","ContactInfo","ContactItem","ContactLabel","LockTimeInfo","PageContainer","FullscreenOverlay","PageHeader","PageTitle","h1","HeaderActions","IconButton","NotificationBadge","TooltipWrapper","TooltipContent","$top","$left","show","TooltipTitle","TooltipItem","TooltipItemTitle","TooltipItemMeta","ContentLayout","FormColumn","FormColumnHeader","FormColumnContent","PreviewColumn","PreviewColumnHeader","ToggleButton","PreviewColumnContent","CollapsibleSection","CollapsibleHeader","HeaderLeft","HeaderRight","CollapseButton","_templateObject34","$isEditing","_templateObject35","$gap","_templateObject36","_templateObject37","RequiredStar","_templateObject38","_templateObject39","_templateObject40","input","_templateObject41","Textarea","textarea","_templateObject42","ButtonGroup","select","_templateObject43","_templateObject44","_templateObject45","_templateObject46","_templateObject47","_templateObject48","_templateObject49","$variant","LoadingOverlay","_templateObject50","_templateObject51","_templateObject52","_templateObject53","_templateObject54","_templateObject55","_templateObject56","_templateObject57","LoadingSpinner","_templateObject58","ErrorAlert","_templateObject59","HelpText","_templateObject60","FieldError","_templateObject61","AutocompleteWrapper","_templateObject62","AutocompleteInput","_templateObject63","ClearButton","_templateObject64","AutocompleteDropdown","_templateObject65","OrderSuggestionItem","_templateObject66","OrderSuggestionTitle","_templateObject67","OrderSuggestionDetail","_templateObject68","OrderSuggestionBadge","_templateObject69","$textColor","NoResults","_templateObject70","SearchingSpinner","_templateObject71","ProgressOverlay","_templateObject72","ProgressModal","_templateObject73","ProgressHeader","_templateObject74","ProgressIconWrapper","_templateObject75","ProgressTitle","_templateObject76","ProgressMessage","_templateObject77","ProgressBarWrapper","_templateObject78","ProgressBarFill","_templateObject79","ProgressActions","_templateObject80","ProgressButton","_templateObject81","variant","MultiSelectWrapper","_templateObject82","MultiSelectButton","_templateObject83","SelectedValue","_templateObject84","isEmpty","MultiSelectDropdown","_templateObject85","SearchBox","_templateObject86","SearchInput","_templateObject87","SearchIcon","_templateObject88","MultiSelectOption","_templateObject89","level","InvoiceEvidencePage","_location$state7","_location$state1","_location$state10","_getCurrentWorkflowSt","navigate","useNavigate","location","useLocation","orderId","useParams","user_id","hasPermission","useContext","AuthContext","ToastContext","setProgress","ProgressContext","dictionaries","useDictionaries","canViewAllOrders","getCurrentWorkflowState","order","stavKody","parse","canAddInvoiceToOrder","allowed","reason","currentState","sectionStates","setSectionStates","defaultStates","invoiceData","materialCorrectness","savedSections","parsed","sectionName","isFullscreen","setIsFullscreen","orderLoading","setOrderLoading","setOrderData","setSmlouvaData","selectedType","setSelectedType","fieldErrors","setFieldErrors","searchTerm","setSearchTerm","suggestions","setSuggestions","isSearching","setIsSearching","showSuggestions","setShowSuggestions","orderFormRef","hasAnySectionCollapsed","setHasAnySectionCollapsed","setEditingInvoiceId","invoiceUserConfirmed","setInvoiceUserConfirmed","isResettingRef","confirmDialog","setConfirmDialog","onCancel","showLockedOrderDialog","setShowLockedOrderDialog","lockedOrderInfo","setLockedOrderInfo","isEntityUnlocked","setIsEntityUnlocked","hadOriginalEntity","setHadOriginalEntity","progressModal","setProgressModal","spisovkaInboxOpen","setSpisovkaInboxOpen","spisovkaInboxState","setSpisovkaInboxState","spisovkaTodayCount","setSpisovkaTodayCount","spisovkaLastRecords","setSpisovkaLastRecords","showSpisovkaTooltip","setShowSpisovkaTooltip","tooltipPosition","setTooltipPosition","tooltipButtonRef","handleResize","maxX","maxY","min","formData","setFormData","order_id","smlouva_id","fa_predana_zam_id","fa_datum_predani_zam","fa_datum_vraceni_zam","potvrdil_vecnou_spravnost_id","attachments","setAttachments","lsLoaded","setLsLoaded","lpCerpani","setLpCerpani","lpCerpaniLoaded","setLpCerpaniLoaded","allowLSSave","setAllowLSSave","pendingSpisovkaMetadataRef","selectStates","setSelectStates","searchStates","setSearchStates","touchedSelectFields","setTouchedSelectFields","strediskaOptions","setStrediskaOptions","strediskaLoading","setStrediskaLoading","typyFakturOptions","setTypyFakturOptions","typyFakturLoading","setTypyFakturLoading","zamestnanci","setZamestnanci","zamestnanciLoading","setZamestnanciLoading","originalFormData","setOriginalFormData","hasChangedCriticalField","setHasChangedCriticalField","isInvoiceEditable","useMemo","isOrderCompleted","loadAll","setItem","_location$state","_location$state2","_location$state3","current","freshNavigationFlag","sessionStorage","isEditingExisting","state","editInvoiceId","isLoadingOrder","orderIdForLoad","isLoadingSmlouva","smlouvaIdForLoad","savedEditId","savedOrigEntity","savedLpCerpani","savedForm","savedAttach","strediskaData","typyFakturData","usersData","all","getStrediska25","getTypyFaktur25","fetchAllUsers","u","sort","b","aName","bName","localeCompare","loadAllCiselniky","hadOrderOrContract","wasNotHandedToEmployee","wasAlreadyApproved","hasChanged","field","original","hasLoadedInvoiceRef","_location$state6","_location$state4","_location$state5","editIdToLoad","att","getInvoiceById25","strediskaArray","opt","loadedFormData","objednavka_id","file","unstable_batchedUpdates","hadEntity","lpResponse","getFakturaLPCerpani","lp_cerpani","lpError","orderIdToLoad","loadOrderData","loadSmlouvaData","loadInvoiceForEdit","lockOrderV2","getOrderV2","evCislo","evidencni_cislo","unlockOrderV2","catch","_err$message","_err$message2","is423Error","smlouvaId","getSmlouvaDetail","contract","normalizedData","objednavky","statistiky","cislo","_location$state8","_location$state9","_location$state0","openMaterialCorrectness","materialSection","_orderCheck$lock_info","_orderCheck$lock_info2","_orderCheck$lock_info3","orderCheck","lock_info","locked","is_owned_by_me","is_expired","lockInfo","lockedByUserName","locked_by_user_fullname","locked_by_user_id","lockedByUserEmail","locked_by_user_email","lockedByUserTelefon","locked_by_user_telefon","lockedAt","locked_at","lockAgeMinutes","lock_age_minutes","canForceUnlock","hasScrolledRef","_orderFormRef$current","_orderFormRef$current2","expandSectionByName","facturaElement","searchEntities","search","_response$categories","_response$categories$","_response$categories2","_response$categories3","searchParams","query","categories","archivovano","search_all","universalSearch","orders","orders_2025","results","contracts","sentOrders","stav_kod","invalidStates","validStates","activeContracts","combinedResults","_type","timer","handleClickOutside","closest","fetchSpisovkaData","countUrl","countResponse","countData","count","faktoryUrl","faktoryResponse","faktoryData","handleInputChange","proceedWithOrderLoad","_orderCheck$lock_info7","_orderCheck$lock_info8","_orderCheck$lock_info9","handleEditInvoice","invoiceCheck","fa_variabilni_symbol","invoice_id","scrollTo","handleAttachmentsChange","updater","newAttachments","firstAttachment","serverId","handleAttachmentRemoved","removedAttachment","metadata","handleSpisovkaConflict","result","faCisloVemaRef","handleAttachmentUploaded","uploadedAttachment","spisovkaErr","validateInvoiceForAttachments","isValid","isISDOC","objednateli","errors","handleCreateInvoiceInDB","_result$data","apiParams","fa_dorucena","createInvoiceV2","newInvoiceId","handleISDOCParsed","isdocData","isdocSummary","mappedData","mapISDOCToFaktura","orderStrediska","handleOCRDataExtracted","ocrData","updates","handleSpisovkaInboxDrag","dir","startX","startY","startState","onMove","moveEvent","dx","dy","newState","minW","minH","newW","newH","onUp","handleBack","dialogMessage","uploadedAttachments","hasRealInvoiceId","deleteInvoiceAttachment25","hard_delete","fa_datum_zdanitelneho_plneni","dodavatel_id","stredisko_id","typ_faktury","klasifikace","getOptionLabel","option","MultiSelect","_ref2","options","safeValues","dropdownRef","buttonRef","searchInputRef","filteredOptions","filterOptions","lowerSearch","contains","updatePosition","buttonRect","dropdown","passive","capture","rafId","requestAnimationFrame","_searchInputRef$curre","focus","cancelAnimationFrame","displayValue","Search","optionValue","isChecked","newValues","v","handleToggleOption","checked","readOnly","faFileInvoice","PageContent","rect","tooltipWidth","record","pocet_priloh","toggleFullscreen","faCompress","$fullscreen","faCreditCard","pathname","boxSizing","handleUnlockEntity","faLock","handleClearSearch","faSearch","isOrder","isSmlouva","stavText","stavColors","stavLower","getStavColor","draftManager","setCurrentUser","existingDraft","loadDraft","draftEvCislo","_orderCheck$lock_info4","_orderCheck$lock_info5","_orderCheck$lock_info6","handleSelectOrder","pocet_faktur","flexShrink","datum","datum_objednavky","created_at","datum_vytvoreni","amount","DatePicker","CustomSelect","required","toggleSelect","_opt$nazev","_objectWithoutProperties","_excluded","InvoiceAttachmentsCompact","objednavkaId","fakturaTypyPrilohOptions","onISDOCParsed","allUsers","onAttachmentsChange","onAttachmentUploaded","onAttachmentRemoved","onCreateInvoiceInDB","allowEmpty","isAddingOrderToExistingInvoice","predani","_result5","_result5$data","updateData","updateInvoiceV2","saveFakturaLPCerpani","_result","_result$data2","_result2","_result2$data","_result3","_result4","createInvoiceWithAttachmentV2","needsUpdate","pop","updateOrderV2","stav_objednavky","notificationService","trigger","sendInvoiceNotifications","updateErr","wasEditing","resetData","currentOrderId","currentSmlouvaId","potentialDoc","doc","faSave","maxCena","fakturaCastka","rozdil","prekroceno","outline","rows","resize","fin","_dictionaries$data","LPCerpaniEditor","availableLPCodes","lpKodyOptions","newLpCerpani","updatedFields","padStart","hours","getHours","minutes","getMinutes","seconds","getSeconds","localTimestamp","accentColor","lp_cislo","totalLP","reduce","sum","errorMsg","notifError","isVecnaSpravnost","_orderFormRef$current3","_orderFormRef$current4","_orderFormRef$current5","_orderFormRef$current6","_orderData$faktury","_orderFormRef$current7","_orderFormRef$current8","faChevronUp","SmlouvaPreview","createPortal","ConfirmDialog","showCancel","faEnvelope","faPhone","faClock","SpisovkaInboxPanel","_progressModal$resetD","_location$state11","_progressModal$resetD2","shouldResetEntity"],"sourceRoot":""}