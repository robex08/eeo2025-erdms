{"version":3,"file":"static/js/6704.17ac5ee6.chunk.js","mappings":"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","sources":["components/EditableCombobox.js","components/PokladniKnihaPDF.js","components/cashbook/BookStatusBadge.js","components/CashboxSelector.jsx","utils/cashbookPermissions.js","pages/CashBookPage.js","utils/pdfFonts.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport styled from '@emotion/styled';\n\n// =============================================================================\n// STYLED COMPONENTS\n// =============================================================================\n\nconst ComboboxWrapper = styled.div`\n  position: relative;\n  width: 100%;\n`;\n\nconst ComboboxInput = styled.input`\n  width: 100%;\n  padding: 0.5rem;\n  border: 1px solid ${props => props.hasError ? '#e53e3e' : '#cbd5e0'};\n  border-radius: 4px;\n  font-size: 0.9rem;\n  background-color: ${props => props.disabled ? '#f7fafc' : 'white'};\n  cursor: ${props => props.disabled ? 'not-allowed' : 'text'};\n  transition: all 0.2s;\n\n  &:focus {\n    outline: none;\n    border-color: ${props => props.hasError ? '#e53e3e' : '#4299e1'};\n    box-shadow: 0 0 0 3px ${props => props.hasError ? 'rgba(229, 62, 62, 0.1)' : 'rgba(66, 153, 225, 0.1)'};\n  }\n\n  &::placeholder {\n    color: #a0aec0;\n  }\n`;\n\nconst DropdownList = styled.ul`\n  position: fixed; /* Fixed msto absolute pro Portal */\n  min-width: 320px; /* ir dropdown kvli popisu LP kd */\n  max-width: 500px;\n  max-height: 250px;\n  overflow-y: auto;\n  background: white;\n  border: 1px solid #cbd5e0;\n  border-radius: 4px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  z-index: 10000; /* Vysok z-index pro Portal */\n  margin: 0;\n  padding: 0;\n  list-style: none;\n`;\n\nconst DropdownItem = styled.li`\n  padding: 0.6rem 0.85rem;\n  cursor: pointer;\n  transition: background-color 0.15s;\n  font-size: 0.9rem;\n  border-bottom: 1px solid #f7fafc;\n\n  &:hover,\n  &.highlighted {\n    background-color: #edf2f7;\n  }\n\n  &.selected {\n    background-color: #4299e1;\n    color: white;\n\n    small {\n      color: #e6f2ff;\n    }\n  }\n\n  strong {\n    font-family: monospace;\n    font-size: 0.95rem;\n    color: #2d3748;\n  }\n\n  &.selected strong {\n    color: white;\n  }\n\n  small {\n    display: block;\n    color: #718096;\n    font-size: 0.8rem;\n    margin-top: 0.2rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n`;\n\nconst NoResults = styled.div`\n  padding: 0.75rem;\n  color: #718096;\n  font-size: 0.85rem;\n  text-align: center;\n  font-style: italic;\n`;\n\n// =============================================================================\n// EDITABLE COMBOBOX COMPONENT\n// =============================================================================\n\n/**\n * EditableCombobox - Komponenta kombinujc input s autocomplete\n *\n * Umouje:\n * - Voln text (uivatel me napsat cokoliv) - pokud strictSelect=false\n * - Pouze vbr ze seznamu - pokud strictSelect=true\n * - Naeptvn pi shod s polokami\n * - Vbr z naeptvanch poloek\n *\n * @param {string} value - Aktuln hodnota\n * @param {function} onChange - Callback pi zmn hodnoty\n * @param {function} onKeyDown - Callback pi stisku klvesy\n * @param {function} onBlur - Callback pi oputn inputu\n * @param {array} options - Pole monost pro naeptvn [{ code, name }, ...]\n * @param {string} placeholder - Placeholder text\n * @param {boolean} disabled - Zakzn inputu\n * @param {boolean} hasError - Indikace chyby\n * @param {boolean} loading - Indikace natn\n * @param {boolean} strictSelect - Pokud true, umouje pouze vbr ze seznamu (ne voln psan)\n */\nconst EditableCombobox = ({\n  value = '',\n  onChange,\n  onKeyDown,\n  onBlur,\n  options = [],\n  placeholder = 'Zante pst...',\n  disabled = false,\n  hasError = false,\n  loading = false,\n  strictSelect = false\n}) => {\n  const [inputValue, setInputValue] = useState(value);\n  const [isOpen, setIsOpen] = useState(false);\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\n  const [dropdownPosition, setDropdownPosition] = useState({ top: 0, left: 0, width: 0 });\n  const inputRef = useRef(null);\n  const wrapperRef = useRef(null);\n\n  // Synchronizace s vnj hodnotou\n  useEffect(() => {\n    setInputValue(value || '');\n  }, [value]);\n\n  // Vpoet pozice dropdownu\n  const updateDropdownPosition = () => {\n    if (inputRef.current) {\n      const rect = inputRef.current.getBoundingClientRect();\n      setDropdownPosition({\n        top: rect.bottom + window.scrollY,\n        left: rect.left + window.scrollX,\n        width: Math.max(rect.width, 320) // Minimln 320px\n      });\n    }\n  };\n\n  // Aktualizovat pozici pi oteven nebo scrollu\n  useEffect(() => {\n    if (isOpen) {\n      updateDropdownPosition();\n\n      const handleScroll = () => updateDropdownPosition();\n      const handleResize = () => updateDropdownPosition();\n\n      window.addEventListener('scroll', handleScroll, true);\n      window.addEventListener('resize', handleResize);\n\n      return () => {\n        window.removeEventListener('scroll', handleScroll, true);\n        window.removeEventListener('resize', handleResize);\n      };\n    }\n  }, [isOpen]);\n\n  // Filtrovn monost podle zadanho textu\n  const filteredOptions = React.useMemo(() => {\n    if (!inputValue || loading) return options;\n\n    const searchTerm = inputValue.toLowerCase().trim();\n    return options.filter(option => {\n      const code = (option.code || '').toLowerCase();\n      const name = (option.name || '').toLowerCase();\n      return code.includes(searchTerm) || name.includes(searchTerm);\n    });\n  }, [inputValue, options, loading]);\n\n  // Zaven dropdownu pi kliku mimo\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (wrapperRef.current && !wrapperRef.current.contains(event.target)) {\n        setIsOpen(false);\n        setHighlightedIndex(-1);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const handleInputChange = (e) => {\n    const newValue = e.target.value;\n    setInputValue(newValue);\n    setIsOpen(true);\n    setHighlightedIndex(-1);\n\n    // Propagace zmny nahoru\n    if (onChange) {\n      onChange({ target: { value: newValue } });\n    }\n  };\n\n  const handleInputFocus = () => {\n    if (!disabled && options.length > 0) {\n      setIsOpen(true);\n    }\n  };\n\n  const handleInputBlur = (e) => {\n    // Delay pro umonn kliku na poloku\n    // Poznmka: onMouseDown s preventDefault zajist, e blur se nespust pi kliku\n    setTimeout(() => {\n      setIsOpen(false);\n      setHighlightedIndex(-1);\n\n      //  STRICT SELECT: Pokud je zapnut strict reim a hodnota nen v seznamu, vymazat\n      if (strictSelect && inputValue) {\n        const isValid = options.some(opt => opt.code === inputValue);\n        if (!isValid) {\n          setInputValue('');\n          if (onChange) {\n            onChange({ target: { value: '' } });\n          }\n        }\n      }\n\n      if (onBlur) {\n        onBlur(e);\n      }\n    }, 200);\n  };\n\n  const selectOption = (option) => {\n    const newValue = option.code;\n    setInputValue(newValue);\n    setIsOpen(false);\n    setHighlightedIndex(-1);\n\n    // DLEIT: Propagace zmny s novm value PED fokusem\n    if (onChange) {\n      onChange({ target: { value: newValue } });\n    }\n\n    // Focus a po propagaci zmny\n    setTimeout(() => {\n      inputRef.current?.focus();\n    }, 0);\n  };\n\n  const handleKeyDown = (e) => {\n    // Propagace key eventu pro navigaci v tabulce\n    if (onKeyDown && !isOpen) {\n      onKeyDown(e);\n      return;\n    }\n\n    // Navigace v dropdown menu\n    if (isOpen && filteredOptions.length > 0) {\n      switch (e.key) {\n        case 'ArrowDown':\n          e.preventDefault();\n          setHighlightedIndex(prev =>\n            prev < filteredOptions.length - 1 ? prev + 1 : 0\n          );\n          break;\n\n        case 'ArrowUp':\n          e.preventDefault();\n          setHighlightedIndex(prev =>\n            prev > 0 ? prev - 1 : filteredOptions.length - 1\n          );\n          break;\n\n        case 'Enter':\n          if (highlightedIndex >= 0 && highlightedIndex < filteredOptions.length) {\n            e.preventDefault();\n            selectOption(filteredOptions[highlightedIndex]);\n          } else {\n            // Enter bez vbru z dropdown - propaguj event\n            if (onKeyDown) {\n              onKeyDown(e);\n            }\n          }\n          break;\n\n        case 'Escape':\n          e.preventDefault();\n          setIsOpen(false);\n          setHighlightedIndex(-1);\n          break;\n\n        case 'Tab':\n          // Tab zave dropdown a pokrauje v navigaci\n          setIsOpen(false);\n          setHighlightedIndex(-1);\n          if (onKeyDown) {\n            onKeyDown(e);\n          }\n          break;\n\n        default:\n          // Pro ostatn klvesy - propaguj event\n          if (onKeyDown) {\n            onKeyDown(e);\n          }\n      }\n    } else if (onKeyDown) {\n      // Dropdown nen oteven - propaguj vechny eventy\n      onKeyDown(e);\n    }\n  };\n\n  return (\n    <ComboboxWrapper ref={wrapperRef}>\n      <ComboboxInput\n        ref={inputRef}\n        type=\"text\"\n        value={inputValue}\n        onChange={handleInputChange}\n        onFocus={handleInputFocus}\n        onBlur={handleInputBlur}\n        onKeyDown={handleKeyDown}\n        placeholder={loading ? 'Natn...' : placeholder}\n        disabled={disabled || loading}\n        hasError={hasError}\n        autoComplete=\"off\"\n      />\n\n      {isOpen && !disabled && !loading && ReactDOM.createPortal(\n        <DropdownList\n          style={{\n            top: `${dropdownPosition.top}px`,\n            left: `${dropdownPosition.left}px`,\n            width: `${dropdownPosition.width}px`\n          }}\n        >\n          {filteredOptions.length > 0 ? (\n            filteredOptions.map((option, index) => (\n              <DropdownItem\n                key={option.code}\n                className={`${highlightedIndex === index ? 'highlighted' : ''} ${\n                  inputValue === option.code ? 'selected' : ''\n                }`}\n                onMouseDown={(e) => {\n                  e.preventDefault(); // Zabrn blur eventu\n                  selectOption(option);\n                }}\n                onMouseEnter={() => setHighlightedIndex(index)}\n              >\n                <strong>{option.code}</strong>\n                {option.name && <small>{option.name}</small>}\n              </DropdownItem>\n            ))\n          ) : (\n            <NoResults>\n              {inputValue ? 'dn shoda. Mete zadat vlastn text.' : 'Zante pst pro filtrovn...'}\n            </NoResults>\n          )}\n        </DropdownList>,\n        document.body\n      )}\n    </ComboboxWrapper>\n  );\n};\n\nexport default EditableCombobox;\n","import React from 'react';\nimport { Document, Page, Text, View, StyleSheet, Image } from '@react-pdf/renderer';\nimport '../utils/pdfFonts'; //  Automatick registrace Roboto font\nimport { ASSETS } from '../config/assets';\n\n// Styly pro PDF dokument\nconst styles = StyleSheet.create({\n  // Zkladn nastaven strnky\n  page: {\n    flexDirection: 'column',\n    backgroundColor: '#FFFFFF',\n    padding: 30,\n    paddingBottom: 60, // Vce msta pro patiku\n    fontFamily: 'Roboto',\n    fontSize: 9,\n  },\n\n  // Hlavika dokumentu\n  header: {\n    marginBottom: 20,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    gap: 15,\n  },\n\n  logoContainer: {\n    width: 60,\n    height: 60,\n  },\n\n  logo: {\n    width: '100%',\n    height: '100%',\n    objectFit: 'contain',\n  },\n\n  headerContent: {\n    flex: 1,\n    flexDirection: 'column',\n    justifyContent: 'center',\n  },\n\n  headerOrganization: {\n    fontSize: 16,\n    fontWeight: 600,\n    color: '#374151',\n    marginBottom: 4,\n  },\n\n  headerTitle: {\n    fontSize: 18,\n    fontWeight: 700,\n    color: '#1e40af',\n    marginBottom: 4,\n  },\n\n  headerSubtitle: {\n    fontSize: 10,\n    fontWeight: 400,\n    color: '#6b7280',\n    marginBottom: 2,\n  },\n\n  headerInfo: {\n    fontSize: 9,\n    fontWeight: 400,\n    color: '#6b7280',\n  },\n\n  // Msc a rok vpravo nahoe\n  headerPeriod: {\n    flexDirection: 'column',\n    alignItems: 'flex-end',\n    justifyContent: 'flex-start',\n    alignSelf: 'flex-start',\n  },\n\n  periodMonth: {\n    fontSize: 18,\n    fontWeight: 700,\n    color: '#1e40af',\n    textTransform: 'uppercase',\n  },\n\n  periodYear: {\n    fontSize: 16,\n    fontWeight: 500,\n    color: '#374151',\n  },\n\n  // Souhrn (summary block)\n  summaryBlock: {\n    marginBottom: 15,\n    padding: 10,\n    backgroundColor: '#f8fafc',\n    borderRadius: 4,\n  },\n\n  summaryGrid: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    flexWrap: 'nowrap',\n    gap: 8,\n  },\n\n  summaryItem: {\n    flex: 1,\n    minWidth: 0,\n  },\n\n  summaryLabel: {\n    fontSize: 7,\n    fontWeight: 400,\n    color: '#6b7280',\n    marginBottom: 2,\n  },\n\n  summaryValue: {\n    fontSize: 11,\n    fontWeight: 700,\n  },\n\n  summaryValuePositive: {\n    color: '#10b981',\n  },\n\n  summaryValueNegative: {\n    color: '#ef4444',\n  },\n\n  summaryValueNeutral: {\n    color: '#1e40af',\n  },\n\n  // Vizitka stavu knihy\n  bookStatusCard: {\n    marginBottom: 12,\n    padding: 10,\n    backgroundColor: '#fff7ed',\n    borderRadius: 4,\n    borderLeftWidth: 4,\n    borderLeftColor: '#f59e0b',\n    borderLeftStyle: 'solid',\n  },\n\n  bookStatusCardClosed: {\n    backgroundColor: '#fef3c7',\n    borderLeftColor: '#eab308',\n  },\n\n  bookStatusCardLocked: {\n    backgroundColor: '#fee2e2',\n    borderLeftColor: '#ef4444',\n  },\n\n  bookStatusTitle: {\n    fontSize: 10,\n    fontWeight: 700,\n    color: '#92400e',\n    marginBottom: 4,\n  },\n\n  bookStatusInfo: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    fontSize: 8,\n    color: '#78716c',\n  },\n\n  bookStatusInfoItem: {\n    flexDirection: 'row',\n    gap: 4,\n  },\n\n  bookStatusLabel: {\n    fontWeight: 500,\n  },\n\n  bookStatusValue: {\n    fontWeight: 400,\n    color: '#1c1917',\n  },\n\n  // Tabulka\n  table: {\n    display: 'table',\n    width: 'auto',\n    borderStyle: 'solid',\n    borderWidth: 1,\n    borderColor: '#d1d5db',\n    borderRightWidth: 0,\n    borderBottomWidth: 0,\n  },\n\n  tableRow: {\n    flexDirection: 'row',\n  },\n\n  // Hlavika tabulky\n  tableHeaderRow: {\n    flexDirection: 'row',\n    backgroundColor: '#1e40af',\n  },\n\n  tableHeaderCell: {\n    padding: 6,\n    fontSize: 8,\n    fontWeight: 700,\n    color: '#ffffff',\n    borderStyle: 'solid',\n    borderWidth: 1,\n    borderLeftWidth: 0,\n    borderTopWidth: 0,\n    borderColor: '#d1d5db',\n    textAlign: 'center',\n    verticalAlign: 'middle',\n  },\n\n  // Buky tabulky\n  tableCell: {\n    padding: 5,\n    fontSize: 8,\n    fontWeight: 400,\n    color: '#1f2937',\n    borderStyle: 'solid',\n    borderWidth: 1,\n    borderLeftWidth: 0,\n    borderTopWidth: 0,\n    borderColor: '#d1d5db',\n  },\n\n  tableCellAlternate: {\n    backgroundColor: '#f9fafb',\n  },\n\n  // Specifick ky sloupc\n  colNumber: {\n    width: '4%',\n    textAlign: 'center',\n  },\n\n  colDate: {\n    width: '8%',\n    textAlign: 'center',\n  },\n\n  colDocNumber: {\n    width: '8%',\n    textAlign: 'center',\n  },\n\n  colDescription: {\n    width: '22%',\n    textAlign: 'left',\n  },\n\n  colPerson: {\n    width: '15%',\n    textAlign: 'left',\n  },\n\n  colIncome: {\n    width: '10%',\n    textAlign: 'right',\n    fontWeight: 700,\n    color: '#10b981',\n  },\n\n  colExpense: {\n    width: '10%',\n    textAlign: 'right',\n    fontWeight: 700,\n    color: '#ef4444',\n  },\n\n  colBalance: {\n    width: '11%',\n    textAlign: 'right',\n    fontWeight: 700,\n    color: '#1e40af',\n  },\n\n  colLpCode: {\n    width: '7%',\n    textAlign: 'center',\n  },\n\n  colNote: {\n    width: '15%',\n    textAlign: 'left',\n    fontSize: 7,\n  },\n\n  // Speciln styly pro hlaviky sloupc s sly (vycentrovan)\n  colHeaderIncome: {\n    width: '10%',\n    textAlign: 'center',\n  },\n\n  colHeaderExpense: {\n    width: '10%',\n    textAlign: 'center',\n  },\n\n  colHeaderBalance: {\n    width: '11%',\n    textAlign: 'center',\n  },\n\n  // Patika\n  footer: {\n    position: 'absolute',\n    bottom: 20,\n    left: 30,\n    right: 30,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    fontSize: 8,\n    color: '#6b7280',\n    borderTopWidth: 1,\n    borderTopColor: '#e5e7eb',\n    paddingTop: 10,\n  },\n});\n\n// Komponenta pro formtovn mny\nconst formatCurrency = (amount) => {\n  if (amount === null || amount === undefined || amount === '') {\n    return '';\n  }\n  const num = parseFloat(amount);\n  if (isNaN(num)) {\n    return '';\n  }\n  return new Intl.NumberFormat('cs-CZ', {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(num) + ' K';\n};\n\n// Komponenta pro formtovn data\nconst formatDate = (dateString) => {\n  if (!dateString) return '';\n  try {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('cs-CZ', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric',\n    });\n  } catch (error) {\n    return dateString;\n  }\n};\n\n// Hlavn komponenta PDF dokumentu\nconst PokladniKnihaPDF = ({\n  organizationInfo,\n  carryOverAmount,\n  totals,\n  entries,\n  generatedBy, // Informace o tom, kdo generoval: { fullName, usekZkr, lokalita }\n  bookStatus // Stav knihy: { status: 'aktivni'|'uzavrena_uzivatelem'|'zamknuta_spravcem', closedDate, closedBy, lockedDate, lockedBy }\n}) => {\n  const currentDate = new Date().toLocaleString('cs-CZ', {\n    day: '2-digit',\n    month: '2-digit',\n    year: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n\n  return (\n    <Document>\n      <Page size=\"A4\" orientation=\"landscape\" style={styles.page}>\n        {/* Hlavika s logem */}\n        <View style={styles.header}>\n          {/* Logo vlevo */}\n          <View style={styles.logoContainer}>\n            <Image\n              src={ASSETS.LOGO_ZZS_MAIN}\n              style={styles.logo}\n            />\n          </View>\n\n          {/* Textov obsah hlaviky */}\n          <View style={styles.headerContent}>\n            <Text style={styles.headerOrganization}>\n              {organizationInfo.organizationName || 'Zdravotnick zchrann sluba Stedoeskho kraje, p.o.'}\n            </Text>\n            <Text style={styles.headerTitle}>POKLADN KNIHA</Text>\n            <Text style={styles.headerInfo}>\n              Pracovit: {organizationInfo.workplace || 'Pbram'} | Pokladna . {organizationInfo.cashboxNumber || '600'}\n            </Text>\n          </View>\n\n          {/* Msc a rok vpravo nahoe */}\n          <View style={styles.headerPeriod}>\n            <Text style={styles.periodMonth}>\n              {(organizationInfo.month || 'listopad').toUpperCase()}\n            </Text>\n            <Text style={styles.periodYear}>\n              {organizationInfo.year || '2025'}\n            </Text>\n          </View>\n        </View>\n\n        {/* Vizitka stavu knihy (pouze pokud je uzaven nebo zamen) */}\n        {bookStatus && (bookStatus.status === 'uzavrena_uzivatelem' || bookStatus.status === 'zamknuta_spravcem') && (\n          <View style={[\n            styles.bookStatusCard,\n            bookStatus.status === 'uzavrena_uzivatelem' && styles.bookStatusCardClosed,\n            bookStatus.status === 'zamknuta_spravcem' && styles.bookStatusCardLocked,\n          ]}>\n            {/* dek 1: Titulek */}\n            <Text style={styles.bookStatusTitle}>\n              {bookStatus.status === 'uzavrena_uzivatelem' ? ' KNIHA UZAVENA' : ' KNIHA ZAMENA'}\n            </Text>\n\n            {/* dek 2: Informace v jednom dku */}\n            <View style={styles.bookStatusInfo}>\n              {bookStatus.status === 'uzavrena_uzivatelem' && (\n                <>\n                  {bookStatus.closedDate && (\n                    <View style={styles.bookStatusInfoItem}>\n                      <Text style={styles.bookStatusLabel}>Uzaveno dne:</Text>\n                      <Text style={styles.bookStatusValue}>{formatDate(bookStatus.closedDate)}</Text>\n                    </View>\n                  )}\n                  {bookStatus.closedBy && (\n                    <View style={styles.bookStatusInfoItem}>\n                      <Text style={styles.bookStatusLabel}>Uzavel:</Text>\n                      <Text style={styles.bookStatusValue}>{bookStatus.closedBy}</Text>\n                    </View>\n                  )}\n                </>\n              )}\n\n              {bookStatus.status === 'zamknuta_spravcem' && (\n                <>\n                  {bookStatus.lockedDate && (\n                    <View style={styles.bookStatusInfoItem}>\n                      <Text style={styles.bookStatusLabel}>Zameno dne:</Text>\n                      <Text style={styles.bookStatusValue}>{formatDate(bookStatus.lockedDate)}</Text>\n                    </View>\n                  )}\n                  {bookStatus.lockedBy && (\n                    <View style={styles.bookStatusInfoItem}>\n                      <Text style={styles.bookStatusLabel}>Zamkl:</Text>\n                      <Text style={styles.bookStatusValue}>{bookStatus.lockedBy}</Text>\n                    </View>\n                  )}\n                </>\n              )}\n            </View>\n          </View>\n        )}\n\n        {/* Souhrn */}\n        <View style={styles.summaryBlock}>\n          <View style={styles.summaryGrid}>\n            <View style={styles.summaryItem}>\n              <Text style={styles.summaryLabel}>\n                Pevod z pedchozho msce:\n              </Text>\n              <Text style={[styles.summaryValue, styles.summaryValueNeutral]}>\n                {formatCurrency(carryOverAmount)}\n              </Text>\n            </View>\n\n            <View style={styles.summaryItem}>\n              <Text style={styles.summaryLabel}>\n                Celkov pjmy:\n              </Text>\n              <Text style={[styles.summaryValue, styles.summaryValuePositive]}>\n                {formatCurrency(totals.totalIncome)}\n              </Text>\n            </View>\n\n            <View style={styles.summaryItem}>\n              <Text style={styles.summaryLabel}>\n                Celkov vdaje:\n              </Text>\n              <Text style={[styles.summaryValue, styles.summaryValueNegative]}>\n                {formatCurrency(totals.totalExpenses)}\n              </Text>\n            </View>\n\n            <View style={styles.summaryItem}>\n              <Text style={styles.summaryLabel}>\n                Aktuln zstatek:\n              </Text>\n              <Text style={[\n                styles.summaryValue,\n                totals.currentBalance >= 0\n                  ? styles.summaryValuePositive\n                  : styles.summaryValueNegative\n              ]}>\n                {formatCurrency(totals.currentBalance)}\n              </Text>\n            </View>\n          </View>\n        </View>\n\n        {/* Tabulka */}\n        <View style={styles.table}>\n          {/* Hlavika tabulky */}\n          <View style={styles.tableHeaderRow}>\n            <Text style={[styles.tableHeaderCell, styles.colNumber]}>#</Text>\n            <Text style={[styles.tableHeaderCell, styles.colDate]}>Datum</Text>\n            <Text style={[styles.tableHeaderCell, styles.colDocNumber]}>Doklad .</Text>\n            <Text style={[styles.tableHeaderCell, styles.colDescription]}>Obsah zpisu</Text>\n            <Text style={[styles.tableHeaderCell, styles.colPerson]}>Komu/Od koho</Text>\n            <Text style={[styles.tableHeaderCell, styles.colHeaderIncome]}>Pjmy (K)</Text>\n            <Text style={[styles.tableHeaderCell, styles.colHeaderExpense]}>Vdaje (K)</Text>\n            <Text style={[styles.tableHeaderCell, styles.colHeaderBalance]}>Zstatek (K)</Text>\n            <Text style={[styles.tableHeaderCell, styles.colLpCode]}>LP kd</Text>\n            <Text style={[styles.tableHeaderCell, styles.colNote]}>Poznmka</Text>\n          </View>\n\n          {/* dky tabulky */}\n          {entries.map((entry, index) => (\n            <View\n              key={entry.id || index}\n              style={[\n                styles.tableRow,\n                index % 2 === 1 && styles.tableCellAlternate\n              ]}\n            >\n              <Text style={[styles.tableCell, styles.colNumber]}>\n                {index + 1}\n              </Text>\n              <Text style={[styles.tableCell, styles.colDate]}>\n                {formatDate(entry.date)}\n              </Text>\n              <Text style={[styles.tableCell, styles.colDocNumber]}>\n                {entry.documentNumber || ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colDescription]}>\n                {entry.description || ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colPerson]}>\n                {entry.person || ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colIncome]}>\n                {entry.income ? formatCurrency(entry.income) : ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colExpense]}>\n                {entry.expense ? formatCurrency(entry.expense) : ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colBalance]}>\n                {formatCurrency(entry.balance)}\n              </Text>\n              <Text style={[styles.tableCell, styles.colLpCode]}>\n                {entry.lpCode || ''}\n              </Text>\n              <Text style={[styles.tableCell, styles.colNote]}>\n                {entry.note || ''}\n              </Text>\n            </View>\n          ))}\n        </View>\n\n        {/* Patika */}\n        <View style={styles.footer} fixed>\n          <Text>\n            {generatedBy?.fullName || ''} | {generatedBy?.usekZkr || ''} | {generatedBy?.lokalita || organizationInfo.workplace || ''}\n          </Text>\n          <Text\n            render={({ pageNumber, totalPages }) =>\n              `Strana ${pageNumber} z ${totalPages}`\n            }\n          />\n          <Text>Vygenerovno: {currentDate}</Text>\n        </View>\n      </Page>\n    </Document>\n  );\n};\n\nexport default PokladniKnihaPDF;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './BookStatusBadge.css';\n\n/**\n * BookStatusBadge - komponenta pro zobrazen stavu pokladn knihy\n *\n * Stavy:\n * - aktivni: Zelen - kniha je oteven pro editaci\n * - uzavrena_uzivatelem: lut - uzaven uivatelem, me odemknout admin\n * - zamknuta_spravcem: erven - zamen sprvcem, nelze editovat\n */\nconst BookStatusBadge = ({ status }) => {\n  const getStatusConfig = () => {\n    switch (status) {\n      case 'aktivni':\n        return {\n          label: 'Aktivn',\n          className: 'status-badge status-active',\n          icon: '',\n          description: 'Kniha je oteven pro zpis'\n        };\n      case 'uzavrena_uzivatelem':\n        return {\n          label: 'Uzavena uivatelem',\n          className: 'status-badge status-closed',\n          icon: '',\n          description: 'Msc uzaven, lze odemknout sprvcem'\n        };\n      case 'zamknuta_spravcem':\n        return {\n          label: 'Zamena sprvcem',\n          className: 'status-badge status-locked',\n          icon: '',\n          description: 'Zameno sprvcem, nelze editovat'\n        };\n      default:\n        return {\n          label: 'Neznm stav',\n          className: 'status-badge status-unknown',\n          icon: '?',\n          description: status || 'Stav nen definovn'\n        };\n    }\n  };\n\n  const config = getStatusConfig();\n\n  return (\n    <div className={config.className} title={config.description}>\n      <span className=\"status-icon\">{config.icon}</span>\n      <span className=\"status-label\">{config.label}</span>\n    </div>\n  );\n};\n\nBookStatusBadge.propTypes = {\n  status: PropTypes.oneOf(['aktivni', 'uzavrena_uzivatelem', 'zamknuta_spravcem']).isRequired\n};\n\nexport default BookStatusBadge;\n","/**\n *  Vbr pokladny s vyhledvnm\n */\n\nimport React, { useMemo, useState, useRef, useEffect } from 'react';\nimport styled from '@emotion/styled';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCalculator, faCheckCircle, faSearch, faChevronDown } from '@fortawesome/free-solid-svg-icons';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem;\n  background: #f8f9fa;\n  border-radius: 8px;\n  border: 1px solid #dee2e6;\n`;\n\nconst Row = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n`;\n\nconst PeriodSelect = styled.select`\n  padding: 0.5rem;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  font-size: 1rem;\n  background: white;\n  cursor: pointer;\n\n  &:focus {\n    outline: none;\n    border-color: #007bff;\n  }\n`;\n\nconst Label = styled.label`\n  font-weight: 600;\n  color: #495057;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst SelectWrapper = styled.div`\n  position: relative;\n  flex: 1;\n  min-width: 300px;\n`;\n\nconst SelectButton = styled.button`\n  width: 100%;\n  padding: 0.5rem 2.5rem 0.5rem 1rem;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  font-size: 1rem;\n  background: white;\n  cursor: pointer;\n  text-align: left;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n\n  &:hover {\n    border-color: #007bff;\n  }\n\n  &:focus {\n    outline: none;\n    border-color: #007bff;\n    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);\n  }\n`;\n\nconst DropdownIcon = styled.span`\n  position: absolute;\n  right: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  pointer-events: none;\n  color: #6c757d;\n`;\n\nconst Dropdown = styled.div`\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  margin-top: 0.25rem;\n  background: white;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  max-height: 300px;\n  overflow-y: auto;\n  z-index: 1000;\n`;\n\nconst SearchWrapper = styled.div`\n  position: relative;\n  border-bottom: 1px solid #dee2e6;\n\n  &:focus-within .search-icon {\n    color: #007bff;\n  }\n`;\n\nconst SearchIcon = styled.span`\n  position: absolute;\n  left: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #6c757d;\n`;\n\nconst SearchInput = styled.input`\n  width: 100%;\n  padding: 0.75rem 0.75rem 0.75rem 2.5rem;\n  border: none;\n  font-size: 1rem;\n\n  &:focus {\n    outline: none;\n  }\n`;\n\nconst OptionsList = styled.div`\n  max-height: 240px;\n  overflow-y: auto;\n`;\n\nconst Option = styled.div`\n  padding: 0.75rem 1rem;\n  cursor: pointer;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n\n  &:hover {\n    background: #f8f9fa;\n  }\n\n  ${props => props.$selected && `\n    background: #e7f3ff;\n    font-weight: 600;\n  `}\n`;\n\nconst OptionLabel = styled.span`\n  flex: 1;\n`;\n\nconst OptionDetails = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n`;\n\nconst OptionTitle = styled.div`\n  font-weight: 500;\n`;\n\nconst OptionSubtitle = styled.div`\n  font-size: 0.875rem;\n  color: #6c757d;\n`;\n\nconst OptionBadge = styled.span`\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  background: #007bff;\n  color: white;\n  border-radius: 3px;\n  white-space: nowrap;\n`;\n\nconst StatusBadge = styled.span`\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  border-radius: 3px;\n  white-space: nowrap;\n  font-weight: 600;\n\n  ${props => {\n    if (props.$status === 'aktivni') {\n      return `\n        background: #28a745;\n        color: white;\n      `;\n    } else if (props.$status === 'uzavrena_uzivatelem') {\n      return `\n        background: #ffc107;\n        color: #212529;\n      `;\n    } else if (props.$status === 'zamknuta_spravcem') {\n      return `\n        background: #dc3545;\n        color: white;\n      `;\n    }\n    return `\n      background: #6c757d;\n      color: white;\n    `;\n  }}\n`;\n\nconst Info = styled.div`\n  font-size: 0.875rem;\n  color: #6c757d;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst CashboxSelector = ({\n  currentCashbox,\n  userCashboxes = [],\n  allCashboxes = [],\n  permissions = {},\n  canSeeAllCashboxes = false,\n  onCashboxChange,\n  currentYear,\n  currentMonth,\n  onPeriodChange,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const dropdownRef = useRef(null);\n  const searchInputRef = useRef(null);\n\n  // Zavt dropdown pi kliknut mimo\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(e.target)) {\n        setIsOpen(false);\n        setSearchQuery('');\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Focus na search input pi oteven\n  useEffect(() => {\n    if (isOpen && searchInputRef.current) {\n      searchInputRef.current.focus();\n    }\n  }, [isOpen]);\n\n  const canReadAll = permissions.canReadAll || permissions.canManage;\n\n  //  Stabiln detekce vlastnictv aktuln pokladny pomoc ID\n  const isCurrentCashboxOwned = useMemo(() => {\n    if (!currentCashbox) return false;\n    return userCashboxes.some(uc =>\n      String(uc.id) === String(currentCashbox.id) ||\n      (uc.cislo_pokladny && String(uc.cislo_pokladny) === String(currentCashbox.cislo_pokladny))\n    );\n  }, [currentCashbox, userCashboxes]);\n\n  const availableCashboxes = useMemo(() => {\n    let boxes = [];\n    if (canReadAll && allCashboxes.length > 0) {\n      //  FIX: Pro adminy - zobrazit JEN hlavn assignments (je_hlavni === 1)\n      // aby se kad pokladna zobrazila jen jednou\n      boxes = allCashboxes.filter(cb => parseInt(cb.je_hlavni, 10) === 1);\n\n      // Pokud dn assignment nem je_hlavni=1, vzt prvn z kad pokladny\n      if (boxes.length === 0) {\n        const seen = new Set();\n        boxes = allCashboxes.filter(cb => {\n          const key = cb.cislo_pokladny || cb.id;\n          if (seen.has(key)) return false;\n          seen.add(key);\n          return true;\n        });\n      }\n    } else {\n      boxes = userCashboxes;\n    }\n    return boxes;\n  }, [canReadAll, allCashboxes, userCashboxes]);\n\n  // Filtrovan pokladny podle hledn\n  const filteredCashboxes = useMemo(() => {\n    if (!searchQuery.trim()) return availableCashboxes;\n\n    const query = searchQuery.toLowerCase();\n    return availableCashboxes.filter(cb => {\n      const number = String(cb.cislo_pokladny || '').toLowerCase();\n      const name = (cb.nazev || cb.nazev_pracoviste || '').toLowerCase();\n      const userName = (cb.uzivatel_cele_jmeno ||\n                       (cb.uzivatel_jmeno && cb.uzivatel_prijmeni\n                         ? `${cb.uzivatel_jmeno} ${cb.uzivatel_prijmeni}`\n                         : '')).toLowerCase();\n      const lokalita = (cb.lokalita_nazev || cb.lokalita_kod || '').toLowerCase();\n      const usek = (cb.usek_nazev || '').toLowerCase();\n      const location = (cb.nazev_pracoviste || cb.kod_pracoviste || '').toLowerCase();\n\n      return number.includes(query) ||\n             name.includes(query) ||\n             userName.includes(query) ||\n             lokalita.includes(query) ||\n             usek.includes(query) ||\n             location.includes(query);\n    });\n  }, [availableCashboxes, searchQuery]);\n\n  const handleSelect = (cashbox) => {\n    if (onCashboxChange) {\n      onCashboxChange(cashbox);\n    }\n    setIsOpen(false);\n    setSearchQuery('');\n  };\n\n  const getCurrentLabel = () => {\n    if (!currentCashbox) return { label: 'Vyberte pokladnu...', isOwn: false };\n\n    const userName = currentCashbox.uzivatel_cele_jmeno ||\n                     (currentCashbox.uzivatel_jmeno && currentCashbox.uzivatel_prijmeni\n                       ? `${currentCashbox.uzivatel_jmeno} ${currentCashbox.uzivatel_prijmeni}`\n                       : null);\n    const lokalita = currentCashbox.lokalita_nazev || currentCashbox.lokalita_kod || null;\n    const usek = currentCashbox.usek_nazev || null;\n    const location = currentCashbox.nazev_pracoviste || currentCashbox.kod_pracoviste || null;\n    const cashboxName = currentCashbox.nazev || currentCashbox.nazev_pracoviste || '';\n\n    // Formt: . XXX - Nzev pokladny (Cel jmno uivatele, Lokalita, sek, Oddlen)\n    let label = '';\n    if (isCurrentCashboxOwned) label += ' '; // Hvzdika pro vlastn pokladny\n    label += `. ${currentCashbox.cislo_pokladny}`;\n    if (cashboxName) label += ` - ${cashboxName}`;\n\n    // Pidat zvorky s info\n    const details = [];\n    if (userName) details.push(userName);\n    if (lokalita) details.push(lokalita);\n    if (usek) details.push(usek);\n    if (location) details.push(location);\n    if (details.length > 0) {\n      label += ` (${details.join(', ')})`;\n    }\n\n    return { label, isOwn: isCurrentCashboxOwned };\n  };\n\n  // Msce pro select\n  const months = [\n    { value: 1, label: 'Leden' },\n    { value: 2, label: 'nor' },\n    { value: 3, label: 'Bezen' },\n    { value: 4, label: 'Duben' },\n    { value: 5, label: 'Kvten' },\n    { value: 6, label: 'erven' },\n    { value: 7, label: 'ervenec' },\n    { value: 8, label: 'Srpen' },\n    { value: 9, label: 'Z' },\n    { value: 10, label: 'jen' },\n    { value: 11, label: 'Listopad' },\n    { value: 12, label: 'Prosinec' }\n  ];\n\n  // Roky - od 2025 (fixn start) do aktulnho roku\n  const now = new Date();\n  const currentYearNow = now.getFullYear();\n  const currentMonthNow = now.getMonth() + 1; // 1-12\n  const MIN_YEAR = 2025; //  Minimln rok - zatek systmu pokladn knihy\n\n  const years = [];\n  for (let y = MIN_YEAR; y <= currentYearNow; y++) {\n    years.push(y);\n  }\n\n  //  Omezit msce kdy je vybran aktuln rok\n  const availableMonths = useMemo(() => {\n    if (currentYear === currentYearNow) {\n      // Aktuln rok - jen msce do te\n      return months.filter(m => m.value <= currentMonthNow);\n    }\n    // Star roky - vechny msce\n    return months;\n  }, [currentYear, currentYearNow, currentMonthNow]);\n\n  if (availableCashboxes.length <= 1 && !onPeriodChange) {\n    return null;\n  }\n\n  return (\n    <Container>\n      {/* dek 1: Vbr msce a roku */}\n      {onPeriodChange && (\n        <Row>\n          <Label>\n             Obdob:\n          </Label>\n          <PeriodSelect\n            value={currentMonth}\n            onChange={(e) => onPeriodChange(currentYear, parseInt(e.target.value))}\n          >\n            {availableMonths.map(m => (\n              <option key={m.value} value={m.value}>{m.label}</option>\n            ))}\n          </PeriodSelect>\n          <PeriodSelect\n            value={currentYear}\n            onChange={(e) => {\n              const newYear = parseInt(e.target.value);\n              //  Pokud je vybran aktuln rok a msc je v budoucnosti, upravit na aktuln msc\n              let newMonth = currentMonth;\n              if (newYear === currentYearNow && currentMonth > currentMonthNow) {\n                newMonth = currentMonthNow;\n              }\n              onPeriodChange(newYear, newMonth);\n            }}\n          >\n            {years.map(y => (\n              <option key={y} value={y}>{y}</option>\n            ))}\n          </PeriodSelect>\n          <span style={{ fontSize: '0.875rem', color: '#6c757d' }}>\n            {availableCashboxes.length} {availableCashboxes.length === 1 ? 'pokladna' :\n             availableCashboxes.length < 5 ? 'pokladny' : 'pokladen'} v tomto obdob\n          </span>\n        </Row>\n      )}\n\n      {/* dek 2: Vbr pokladny */}\n      {availableCashboxes.length > 1 && (\n        <Row>\n          <Label>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladna:\n          </Label>\n\n      <SelectWrapper ref={dropdownRef}>\n        <SelectButton\n          onClick={() => setIsOpen(!isOpen)}\n          type=\"button\"\n        >\n          {(() => {\n            const labelData = getCurrentLabel();\n            return (\n              <span style={{\n                flex: 1,\n                fontWeight: labelData.isOwn ? 'bold' : 'normal',\n                color: labelData.isOwn ? '#007bff' : 'inherit'\n              }}>\n                {labelData.label}\n              </span>\n            );\n          })()}\n          {currentCashbox?.stav_knihy && (\n            <StatusBadge\n              $status={currentCashbox.stav_knihy}\n              style={{ marginLeft: '0.5rem' }}\n            >\n              {currentCashbox.stav_knihy === 'aktivni' && ' Aktivn'}\n              {currentCashbox.stav_knihy === 'uzavrena_uzivatelem' && ' Uzavena'}\n              {currentCashbox.stav_knihy === 'zamknuta_spravcem' && ' Zamknuta'}\n            </StatusBadge>\n          )}\n        </SelectButton>\n\n        <DropdownIcon>\n          <FontAwesomeIcon icon={faChevronDown} />\n        </DropdownIcon>\n\n        {isOpen && (\n          <Dropdown>\n            <SearchWrapper>\n              <SearchInput\n                ref={searchInputRef}\n                type=\"text\"\n                placeholder=\"Hledat podle sla nebo nzvu...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n              />\n              <SearchIcon className=\"search-icon\">\n                <FontAwesomeIcon icon={faSearch} />\n              </SearchIcon>\n            </SearchWrapper>\n\n            <OptionsList>\n              {filteredCashboxes.length === 0 ? (\n                <Option style={{ color: '#6c757d', cursor: 'default' }}>\n                  dn vsledky\n                </Option>\n              ) : (\n                filteredCashboxes.map((cashbox, index) => {\n                  // Sestavit info o uivateli\n                  const userName = cashbox.uzivatel_cele_jmeno ||\n                                   (cashbox.uzivatel_jmeno && cashbox.uzivatel_prijmeni\n                                     ? `${cashbox.uzivatel_jmeno} ${cashbox.uzivatel_prijmeni}`\n                                     : null);\n                  const lokalita = cashbox.lokalita_nazev || cashbox.lokalita_kod || null;\n                  const usek = cashbox.usek_nazev || null;\n                  const location = cashbox.nazev_pracoviste || cashbox.kod_pracoviste || null;\n\n                  //  Zkontrolovat, jestli je to pokladna pihlenho uivatele\n                  // Zvrazn se pouze pokladny, kde je uivatel vlastnkem (v userCashboxes)\n                  // Porovnvme jak podle ID, tak podle sla pokladny pro jistotu\n                  const isMyOwnCashbox = userCashboxes.some(uc =>\n                    String(uc.id) === String(cashbox.id) ||\n                    (uc.cislo_pokladny && String(uc.cislo_pokladny) === String(cashbox.cislo_pokladny))\n                  );\n\n                  // Stav knihy\n                  const bookStatus = cashbox.stav_knihy || 'aktivni';\n                  const statusLabels = {\n                    'aktivni': ' Aktivn',\n                    'uzavrena_uzivatelem': ' Uzavena',\n                    'zamknuta_spravcem': ' Zamknuta'\n                  };\n\n                  return (\n                    <Option\n                      key={`${cashbox.id}-${cashbox.cislo_pokladny}-${index}`}\n                      onClick={() => handleSelect(cashbox)}\n                      $selected={currentCashbox?.id === cashbox.id}\n                    >\n                      <OptionLabel>\n                        <OptionDetails>\n                          <OptionTitle style={{\n                            fontWeight: isMyOwnCashbox ? 'bold' : 'normal',\n                            color: isMyOwnCashbox ? '#007bff' : 'inherit'\n                          }}>\n                            {isMyOwnCashbox && ' '}. {cashbox.cislo_pokladny} - {cashbox.nazev || cashbox.nazev_pracoviste || 'Bez nzvu'}\n                          </OptionTitle>\n                          {(userName || lokalita || usek || location) && (\n                            <OptionSubtitle>\n                              {userName && ` ${userName}`}\n                              {userName && (lokalita || usek || location) && '  '}\n                              {lokalita && ` ${lokalita}`}\n                              {lokalita && (usek || location) && '  '}\n                              {usek && ` ${usek}`}\n                              {usek && location && '  '}\n                              {location && ` ${location}`}\n                            </OptionSubtitle>\n                          )}\n                        </OptionDetails>\n                      </OptionLabel>\n                      <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n                        <StatusBadge $status={bookStatus}>\n                          {statusLabels[bookStatus] || bookStatus}\n                        </StatusBadge>\n                        {currentCashbox?.id === cashbox.id && (\n                          <OptionBadge>\n                            <FontAwesomeIcon icon={faCheckCircle} /> Vybrna\n                          </OptionBadge>\n                        )}\n                      </div>\n                    </Option>\n                  );\n                })\n              )}\n            </OptionsList>\n          </Dropdown>\n        )}\n        </SelectWrapper>\n\n        {currentCashbox && (\n          <Info>\n            <FontAwesomeIcon icon={faCheckCircle} />\n            {' '}{parseInt(currentCashbox.je_hlavni, 10) === 1\n              ? 'Hlavn pokladnk'\n              : 'Zstupce'}\n          </Info>\n        )}\n      </Row>\n      )}\n    </Container>\n  );\n};\n\nexport default CashboxSelector;\n","/**\n *  CASHBOOK PERMISSIONS - Pomocn funkce pro kontrolu oprvnn\n *\n * Definuje oprvnn pro prci s pokladn knihou:\n * - READ (zobrazen)\n * - EDIT (editace)\n * - DELETE (mazn)\n * - EXPORT (export dat)\n * - MANAGE (kompletn sprva vetn zamykn)\n *\n * Kad oprvnn existuje ve dvou variantch:\n * - _OWN - pouze vlastn pokladn kniha\n * - _ALL - vechny pokladn knihy\n *\n * @author FE Team\n * @date 9. listopadu 2025\n */\n\n// =============================================================================\n// KONSTANTY - Kdy oprvnn z databze\n// =============================================================================\n\nexport const PERMISSIONS = {\n  // Zobrazen\n  CASH_BOOK_READ_OWN: 'CASH_BOOK_READ_OWN',\n  CASH_BOOK_READ_ALL: 'CASH_BOOK_READ_ALL',\n\n  // Editace\n  CASH_BOOK_EDIT_OWN: 'CASH_BOOK_EDIT_OWN',\n  CASH_BOOK_EDIT_ALL: 'CASH_BOOK_EDIT_ALL',\n\n  // Mazn\n  CASH_BOOK_DELETE_OWN: 'CASH_BOOK_DELETE_OWN',\n  CASH_BOOK_DELETE_ALL: 'CASH_BOOK_DELETE_ALL',\n\n  // Export\n  CASH_BOOK_EXPORT_OWN: 'CASH_BOOK_EXPORT_OWN',\n  CASH_BOOK_EXPORT_ALL: 'CASH_BOOK_EXPORT_ALL',\n\n  // Kompletn sprva (vetn zamykn/odemykn)\n  CASH_BOOK_MANAGE: 'CASH_BOOK_MANAGE'\n};\n\n// =============================================================================\n// STAVY UZAMEN POKLADN KNIHY\n// =============================================================================\n\nexport const LOCK_STATUS = {\n  OPEN: 'open',           // Oteven - lze editovat\n  CLOSED: 'closed',       // Uzaven uivatelem - me otevt jen on sm nebo MANAGE\n  LOCKED: 'locked'        // Zamknuta administrtorem - me otevt jen MANAGE\n};\n\n// =============================================================================\n// HELPER FUNKCE\n// =============================================================================\n\n/**\n * Zsk vechna cashbook oprvnn z user objektu\n * @param {Object} userDetail - Detail uivatele z AuthContext\n * @returns {Set<string>} Mnoina kd oprvnn\n */\nexport const getUserCashbookPermissions = (userDetail) => {\n  if (!userDetail) {\n    return new Set();\n  }\n\n  const permissions = new Set();\n\n  // 1. Zkusit direct_rights (pole objekt s kod_prava)\n  const directRights = userDetail.direct_rights || userDetail.directRights || [];\n  if (Array.isArray(directRights)) {\n    directRights.forEach(p => {\n      if (p && typeof p === 'object') {\n        const code = p.kod_prava || p.kod_opravneni || p.code || '';\n        if (code.startsWith('CASH_BOOK_')) {\n          permissions.add(code);\n        }\n      }\n    });\n  }\n\n  // 2. Zkusit prava (pole objekt s kod_prava)\n  const prava = userDetail.prava || [];\n  if (Array.isArray(prava)) {\n    prava.forEach(p => {\n      if (p && typeof p === 'object') {\n        const code = p.kod_prava || p.kod_opravneni || p.code || '';\n        if (code.startsWith('CASH_BOOK_')) {\n          permissions.add(code);\n        }\n      }\n    });\n  }\n\n  // 3. Zkusit permissions (pole objekt nebo string)\n  const perms = userDetail.permissions || [];\n  if (Array.isArray(perms)) {\n    perms.forEach(p => {\n      if (typeof p === 'string' && p.startsWith('CASH_BOOK_')) {\n        permissions.add(p);\n      } else if (p && typeof p === 'object') {\n        const code = p.kod_prava || p.kod_opravneni || p.code || '';\n        if (code.startsWith('CASH_BOOK_')) {\n          permissions.add(code);\n        }\n      }\n    });\n  }\n\n  // 4. Zkusit roles -> prava\n  const roles = userDetail.roles || [];\n  if (Array.isArray(roles)) {\n    roles.forEach(role => {\n      if (role && typeof role === 'object') {\n        const rolePrava = role.prava || role.rights || role.permissions || [];\n        if (Array.isArray(rolePrava)) {\n          rolePrava.forEach(p => {\n            if (p && typeof p === 'object') {\n              const code = p.kod_prava || p.kod_opravneni || p.code || '';\n              if (code.startsWith('CASH_BOOK_')) {\n                permissions.add(code);\n              }\n            } else if (typeof p === 'string' && p.startsWith('CASH_BOOK_')) {\n              permissions.add(p);\n            }\n          });\n        }\n      }\n    });\n  }\n\n  return permissions;\n};\n\n/**\n * Kontrola, zda m uivatel konkrtn oprvnn\n * @param {Object} userDetail - Detail uivatele\n * @param {string} permission - Kd oprvnn\n * @returns {boolean}\n */\nexport const hasPermission = (userDetail, permission) => {\n  const permissions = getUserCashbookPermissions(userDetail);\n  return permissions.has(permission);\n};\n\n/**\n * Zsk objekt vech cashbook oprvnn pro snadn pouit\n * @param {Object} userDetail - Detail uivatele z AuthContext\n * @returns {Object} Objekt s boolean hodnotami pro kad oprvnn\n */\nexport const getCashbookPermissionsObject = (userDetail) => {\n  const permissions = getUserCashbookPermissions(userDetail);\n\n  return {\n    // Zobrazen\n    canReadOwn: permissions.has(PERMISSIONS.CASH_BOOK_READ_OWN),\n    canReadAll: permissions.has(PERMISSIONS.CASH_BOOK_READ_ALL) ||\n                permissions.has(PERMISSIONS.CASH_BOOK_MANAGE),\n\n    // Editace\n    canEditOwn: permissions.has(PERMISSIONS.CASH_BOOK_EDIT_OWN),\n    canEditAll: permissions.has(PERMISSIONS.CASH_BOOK_EDIT_ALL) ||\n                permissions.has(PERMISSIONS.CASH_BOOK_MANAGE),\n\n    // Mazn\n    canDeleteOwn: permissions.has(PERMISSIONS.CASH_BOOK_DELETE_OWN),\n    canDeleteAll: permissions.has(PERMISSIONS.CASH_BOOK_DELETE_ALL) ||\n                  permissions.has(PERMISSIONS.CASH_BOOK_MANAGE),\n\n    // Export\n    canExportOwn: permissions.has(PERMISSIONS.CASH_BOOK_EXPORT_OWN),\n    canExportAll: permissions.has(PERMISSIONS.CASH_BOOK_EXPORT_ALL) ||\n                  permissions.has(PERMISSIONS.CASH_BOOK_MANAGE),\n\n    // Kompletn sprva\n    canManage: permissions.has(PERMISSIONS.CASH_BOOK_MANAGE)\n  };\n};\n\n/**\n * Kontrola, zda me uivatel editovat konkrtn pokladn knihu\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @param {string} cashbook.stav_uzamceni - Stav uzamen (open/closed/locked)\n * @param {number} cashbook.uzivatel_id - ID vlastnka pokladn knihy\n * @returns {Object} { canEdit: boolean, reason: string }\n */\nexport const canEditCashbook = (userDetail, cashbook) => {\n  const perms = getCashbookPermissionsObject(userDetail);\n\n  // 1. Kontrola uzamen\n  if (cashbook.stav_uzamceni === LOCK_STATUS.LOCKED) {\n    // Zamknuto - me otevt jen MANAGE\n    if (!perms.canManage) {\n      return {\n        canEdit: false,\n        reason: 'Pokladn kniha je zamknuta. Me ji odemknout jen sprvce.'\n      };\n    }\n  } else if (cashbook.stav_uzamceni === LOCK_STATUS.CLOSED) {\n    // Uzaveno uivatelem\n    const isOwner = cashbook.uzivatel_id === userDetail.id;\n    if (!isOwner && !perms.canManage) {\n      return {\n        canEdit: false,\n        reason: 'Pokladn kniha je uzavena. Me ji otevt jen vlastnk nebo sprvce.'\n      };\n    }\n  }\n\n  // 2. Kontrola edit oprvnn\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n\n  if (perms.canEditAll) {\n    return { canEdit: true, reason: 'Mte oprvnn editovat vechny pokladn knihy' };\n  }\n\n  if (perms.canEditOwn && isOwner) {\n    return { canEdit: true, reason: 'Mete editovat vlastn pokladn knihu' };\n  }\n\n  return {\n    canEdit: false,\n    reason: 'Nemte oprvnn k editaci tto pokladn knihy'\n  };\n};\n\n/**\n * Kontrola, zda me uivatel zobrazit pokladn knihu\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @returns {boolean}\n */\nexport const canViewCashbook = (userDetail, cashbook) => {\n  const perms = getCashbookPermissionsObject(userDetail);\n\n  if (perms.canReadAll) {\n    return true;\n  }\n\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n  return perms.canReadOwn && isOwner;\n};\n\n/**\n * Kontrola, zda me uivatel smazat poloku v pokladn knize\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @returns {Object} { canDelete: boolean, reason: string }\n */\nexport const canDeleteFromCashbook = (userDetail, cashbook) => {\n  // Nejdv zkontrolovat, zda me editovat (zahrnuje kontrolu uzamen)\n  const editCheck = canEditCashbook(userDetail, cashbook);\n  if (!editCheck.canEdit) {\n    return { canDelete: false, reason: editCheck.reason };\n  }\n\n  const perms = getCashbookPermissionsObject(userDetail);\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n\n  if (perms.canDeleteAll) {\n    return { canDelete: true, reason: 'Mte oprvnn mazat ze vech pokladnch knih' };\n  }\n\n  if (perms.canDeleteOwn && isOwner) {\n    return { canDelete: true, reason: 'Mete mazat z vlastn pokladn knihy' };\n  }\n\n  return {\n    canDelete: false,\n    reason: 'Nemte oprvnn k mazn z tto pokladn knihy'\n  };\n};\n\n/**\n * Kontrola, zda me uivatel exportovat pokladn knihu\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @returns {boolean}\n */\nexport const canExportCashbook = (userDetail, cashbook) => {\n  const perms = getCashbookPermissionsObject(userDetail);\n\n  if (perms.canExportAll) {\n    return true;\n  }\n\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n  return perms.canExportOwn && isOwner;\n};\n\n/**\n * Kontrola, zda me uivatel zmnit stav uzamen\n * @param {Object} userDetail - Detail uivatele\n * @param {Object} cashbook - Objekt pokladn knihy\n * @param {string} targetStatus - Clov stav (open/closed/locked)\n * @returns {Object} { canChange: boolean, reason: string }\n */\nexport const canChangeLockStatus = (userDetail, cashbook, targetStatus) => {\n  const perms = getCashbookPermissionsObject(userDetail);\n  const isOwner = cashbook.uzivatel_id === userDetail.id;\n  const currentStatus = cashbook.stav_uzamceni || LOCK_STATUS.OPEN;\n\n  // MANAGE me dlat cokoli\n  if (perms.canManage) {\n    return { canChange: true, reason: 'Mte kompletn sprvu pokladnch knih' };\n  }\n\n  // Uivatel me UZAVT svou vlastn knihu\n  if (targetStatus === LOCK_STATUS.CLOSED && isOwner && currentStatus === LOCK_STATUS.OPEN) {\n    return { canChange: true, reason: 'Mete uzavt vlastn pokladn knihu' };\n  }\n\n  // Uivatel me OTEVT svou vlastn UZAVENOU knihu\n  if (targetStatus === LOCK_STATUS.OPEN && isOwner && currentStatus === LOCK_STATUS.CLOSED) {\n    return { canChange: true, reason: 'Mete otevt vlastn uzavenou knihu' };\n  }\n\n  // ZAMKNOUT me jen MANAGE\n  if (targetStatus === LOCK_STATUS.LOCKED) {\n    return {\n      canChange: false,\n      reason: 'Zamknout pokladn knihu me jen sprvce s oprvnnm CASH_BOOK_MANAGE'\n    };\n  }\n\n  // ODEMKNOUT LOCKED me jen MANAGE\n  if (currentStatus === LOCK_STATUS.LOCKED) {\n    return {\n      canChange: false,\n      reason: 'Odemknout zamknutou knihu me jen sprvce s oprvnnm CASH_BOOK_MANAGE'\n    };\n  }\n\n  return {\n    canChange: false,\n    reason: 'Nemte oprvnn ke zmn stavu tto pokladn knihy'\n  };\n};\n\n/**\n * Zsk lidsky iteln popis stavu uzamen\n * @param {string} status - Stav uzamen\n * @returns {Object} { label: string, icon: string, color: string }\n */\nexport const getLockStatusInfo = (status) => {\n  switch (status) {\n    case LOCK_STATUS.OPEN:\n      return {\n        label: 'Oteven',\n        icon: '',\n        color: 'success',\n        description: 'Lze editovat'\n      };\n    case LOCK_STATUS.CLOSED:\n      return {\n        label: 'Uzaven',\n        icon: '',\n        color: 'warning',\n        description: 'Uzavena uivatelem - me otevt vlastnk nebo sprvce'\n      };\n    case LOCK_STATUS.LOCKED:\n      return {\n        label: 'Zamknuta',\n        icon: '',\n        color: 'error',\n        description: 'Zamknuta sprvcem - me otevt jen sprvce'\n      };\n    default:\n      return {\n        label: 'Neznm stav',\n        icon: '',\n        color: 'default',\n        description: 'Neznm stav uzamen'\n      };\n  }\n};\n\n// =============================================================================\n// EXPORT DEFAULT\n// =============================================================================\n\nexport default {\n  PERMISSIONS,\n  LOCK_STATUS,\n  getUserCashbookPermissions,\n  hasPermission,\n  getCashbookPermissionsObject,\n  canEditCashbook,\n  canViewCashbook,\n  canDeleteFromCashbook,\n  canExportCashbook,\n  canChangeLockStatus,\n  getLockStatusInfo\n};\n","import React, { useState, useContext, useEffect, useRef, useCallback, useMemo } from 'react';\nimport ReactDOM from 'react-dom';\nimport styled from '@emotion/styled';\nimport { keyframes } from '@emotion/react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faCalculator,\n  faPlus,\n  faTrash,\n  faEdit,\n  faPrint,\n  faFileExport,\n  faCheck,\n  faInfoCircle,\n  faChevronLeft,\n  faChevronRight,\n  faCalendarDay,\n  faLock,\n  faLockOpen,\n  faExclamationTriangle\n} from '@fortawesome/free-solid-svg-icons';\nimport { AuthContext } from '../context/AuthContext';\nimport { ToastContext } from '../context/ToastContext';\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport DatePicker from '../components/DatePicker';\nimport ConfirmDialog from '../components/ConfirmDialog';\nimport EditableCombobox from '../components/EditableCombobox';\nimport ModernHelper from '../components/ModernHelper';\nimport { fetchLimitovanePrisliby } from '../services/api2auth';\nimport { pdf } from '@react-pdf/renderer';\nimport PokladniKnihaPDF from '../components/PokladniKnihaPDF';\nimport { Global, css } from '@emotion/react';\nimport cashbookAPI from '../services/cashbookService';\nimport BookStatusBadge from '../components/cashbook/BookStatusBadge';\nimport CashboxSelector from '../components/CashboxSelector';\nimport { getCashbookPermissionsObject } from '../utils/cashbookPermissions';\n\n// =============================================================================\n// PRINT STYLES - Pro ist tisk pouze tabulky\n// =============================================================================\n\nconst printStyles = css`\n  @media print {\n    /* Skrt ve krom tabulky pi tisku */\n    body * {\n      visibility: hidden;\n    }\n\n    /* Zobrazit pouze obsah pokladn knihy */\n    .cashbook-print-area,\n    .cashbook-print-area * {\n      visibility: visible;\n    }\n\n    /* Odstranit padding/margin z body */\n    body {\n      margin: 0;\n      padding: 0;\n      background: white;\n    }\n\n    /* Tabulka na celou ku */\n    .cashbook-print-area {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      padding: 2rem;\n    }\n\n    /* Zobrazit hlaviku jen pi tisku */\n    .print-header {\n      display: block !important;\n    }\n\n    /* Skrt akn tlatka, navigaci atd. */\n    button,\n    .no-print {\n      display: none !important;\n    }\n\n    /* Optimalizace tabulky pro tisk */\n    table {\n      page-break-inside: auto;\n      border-collapse: collapse;\n      width: 100%;\n      font-size: 0.8rem;\n    }\n\n    tr {\n      page-break-inside: avoid;\n      page-break-after: auto;\n    }\n\n    thead {\n      display: table-header-group;\n    }\n\n    tfoot {\n      display: table-footer-group;\n    }\n\n    /* Men padding pro tisk */\n    td, th {\n      padding: 0.25rem 0.5rem !important;\n    }\n  }\n`;\n\n// =============================================================================\n// ANIMATIONS\n// =============================================================================\n\nconst fadeIn = keyframes`\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n`;\n\nconst slideIn = keyframes`\n  from {\n    opacity: 0;\n    transform: translateX(-20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n`;\n\nconst highlightPulse = keyframes`\n  0%, 100% {\n    background-color: #fff;\n  }\n  50% {\n    background-color: #dbeafe;\n  }\n`;\n\n// =============================================================================\n// STYLED COMPONENTS\n// =============================================================================\n\nconst PageContainer = styled.div`\n  min-height: 100vh;\n  padding: 2rem;\n  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n  animation: ${fadeIn} 0.6s ease-out;\n\n  @media (max-width: 768px) {\n    padding: 1rem;\n  }\n`;\n\nconst Header = styled.div`\n  background: linear-gradient(135deg, #1e40af, #3b82f6);\n  color: white;\n  padding: 2rem;\n  border-radius: 16px;\n  box-shadow: 0 8px 32px rgba(30, 64, 175, 0.3);\n  margin-bottom: 2rem;\n  animation: ${slideIn} 0.8s ease-out;\n\n  h1 {\n    font-size: 2.5rem;\n    font-weight: 700;\n    margin: 0 0 0.5rem 0;\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n  }\n\n  .subtitle {\n    font-size: 1.1rem;\n    opacity: 0.9;\n    margin: 0;\n  }\n\n  @media (max-width: 768px) {\n    padding: 1.5rem;\n    h1 {\n      font-size: 2rem;\n    }\n  }\n`;\n\nconst ActionBar = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n  padding: 1rem;\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  animation: ${slideIn} 0.6s ease-out 0.2s both;\n\n  @media (max-width: 768px) {\n    flex-direction: column;\n    gap: 1rem;\n  }\n`;\n\nconst ActionGroup = styled.div`\n  display: flex;\n  gap: 0.75rem;\n  align-items: center;\n`;\n\nconst ActionButton = styled.button`\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 0.75rem;\n  border: 2px solid ${props => {\n    switch (props.variant) {\n      case 'primary': return '#10b981';\n      case 'danger': return '#ef4444';\n      case 'warning': return '#f59e0b';\n      default: return '#3b82f6';\n    }\n  }};\n  border-radius: 8px;\n  background: ${props => {\n    if (props.$filled) {\n      switch (props.variant) {\n        case 'primary': return '#10b981';\n        case 'danger': return '#ef4444';\n        case 'warning': return '#f59e0b';\n        default: return '#3b82f6';\n      }\n    }\n    return 'white';\n  }};\n  color: ${props => {\n    if (props.$filled) return 'white';\n    switch (props.variant) {\n      case 'primary': return '#10b981';\n      case 'danger': return '#ef4444';\n      case 'warning': return '#f59e0b';\n      default: return '#3b82f6';\n    }\n  }};\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: ${props => {\n      if (props.$filled) {\n        switch (props.variant) {\n          case 'primary': return '#059669';\n          case 'danger': return '#dc2626';\n          case 'warning': return '#d97706';\n          default: return '#2563eb';\n        }\n      }\n      switch (props.variant) {\n        case 'primary': return '#d1fae5';\n        case 'danger': return '#fee2e2';\n        case 'warning': return '#fef3c7';\n        default: return '#eff6ff';\n      }\n    }};\n    border-color: ${props => {\n      switch (props.variant) {\n        case 'primary': return '#059669';\n        case 'danger': return '#dc2626';\n        case 'warning': return '#d97706';\n        default: return '#2563eb';\n      }\n    }};\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px ${props => {\n      switch (props.variant) {\n        case 'primary': return 'rgba(16, 185, 129, 0.25)';\n        case 'danger': return 'rgba(239, 68, 68, 0.25)';\n        case 'warning': return 'rgba(245, 158, 11, 0.25)';\n        default: return 'rgba(59, 130, 246, 0.25)';\n      }\n    }};\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none;\n    box-shadow: none;\n  }\n`;\n\nconst MonthNavigation = styled.div`\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);\n  color: white;\n  animation: ${slideIn} 0.6s ease-out 0.2s both;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 2rem;\n`;\n\nconst MonthInfo = styled.div`\n  flex: 1;\n\n  h2 {\n    margin: 0 0 0.5rem 0;\n    font-size: 1.5rem;\n    font-weight: 700;\n    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n  }\n\n  .carry-over {\n    font-size: 0.95rem;\n    opacity: 0.95;\n    margin: 0.25rem 0 0 0;\n\n    .amount {\n      font-weight: 600;\n      font-size: 1.1rem;\n      margin-left: 0.5rem;\n    }\n  }\n`;\n\nconst MonthControls = styled.div`\n  display: flex;\n  gap: 0.75rem;\n  align-items: center;\n`;\n\nconst MonthButton = styled.button`\n  background: rgba(255, 255, 255, 0.2);\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  color: white;\n  padding: 0.75rem 1.25rem;\n  border-radius: 8px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.95rem;\n\n  &:hover:not(:disabled) {\n    background: rgba(255, 255, 255, 0.3);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n  }\n\n  &:active:not(:disabled) {\n    transform: translateY(0);\n  }\n\n  &:disabled {\n    opacity: 0.4;\n    cursor: not-allowed;\n  }\n`;\n\nconst LockedBookWarning = styled.div`\n  background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);\n  border: 2px solid #dc2626;\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2);\n  animation: ${slideIn} 0.4s ease-out;\n\n  .warning-header {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    margin-bottom: 1rem;\n\n    .icon {\n      font-size: 2.5rem;\n      color: #dc2626;\n      animation: pulse 2s ease-in-out infinite;\n    }\n\n    h3 {\n      color: #991b1b;\n      margin: 0;\n      font-size: 1.3rem;\n      font-weight: 700;\n    }\n  }\n\n  .warning-content {\n    color: #7f1d1d;\n    line-height: 1.6;\n\n    p {\n      margin: 0.75rem 0;\n    }\n\n    strong {\n      color: #991b1b;\n      font-weight: 600;\n    }\n\n    .contact-info {\n      margin-top: 1rem;\n      padding: 1rem;\n      background: rgba(255, 255, 255, 0.5);\n      border-radius: 8px;\n      border-left: 4px solid #dc2626;\n    }\n  }\n\n  @keyframes pulse {\n    0%, 100% {\n      transform: scale(1);\n    }\n    50% {\n      transform: scale(1.1);\n    }\n  }\n`;\n\nconst PreviousMonthWarning = styled.div`\n  background: linear-gradient(135deg, #fff3cd 0%, #fff8e1 100%);\n  border: 2px solid #ffc107;\n  border-radius: 12px;\n  padding: 1.25rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 3px 10px rgba(255, 193, 7, 0.2);\n  animation: ${slideIn} 0.4s ease-out;\n\n  display: flex;\n  align-items: flex-start;\n  gap: 1rem;\n\n  @media print {\n    display: none;\n  }\n`;\n\nconst WarningIcon = styled.div`\n  font-size: 1.5rem;\n  color: #ff9800;\n  line-height: 1;\n  margin-top: 0.25rem;\n  flex-shrink: 0;\n`;\n\nconst WarningContent = styled.div`\n  flex: 1;\n\n  h4 {\n    margin: 0 0 0.5rem 0;\n    color: #f57c00;\n    font-size: 1rem;\n    font-weight: 600;\n  }\n\n  p {\n    margin: 0.25rem 0;\n    color: #5d4037;\n    font-size: 0.9rem;\n    line-height: 1.5;\n  }\n\n  strong {\n    color: #e65100;\n  }\n\n  .tip {\n    margin-top: 0.5rem;\n    font-size: 0.85rem;\n    color: #666;\n  }\n`;\n\nconst InfoPanel = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  border-left: 4px solid #3b82f6;\n  animation: ${slideIn} 0.6s ease-out 0.3s both;\n\n  .organization-info {\n    margin-bottom: 1rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 1rem;\n    flex-wrap: wrap;\n\n    .info-text {\n      flex: 1;\n      min-width: 300px;\n\n      h3 {\n        color: #1f2937;\n        margin: 0 0 0.5rem 0;\n        font-size: 1.2rem;\n        font-weight: 600;\n      }\n\n      p {\n        color: #6b7280;\n        margin: 0;\n        font-size: 0.95rem;\n      }\n    }\n\n    .info-actions {\n      display: flex;\n      align-items: center;\n      gap: 0.75rem;\n    }\n  }\n\n  .summary-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1rem;\n    margin-top: 1rem;\n  }\n\n  .summary-item {\n    text-align: center;\n\n    .label {\n      font-size: 0.875rem;\n      color: #6b7280;\n      margin-bottom: 0.25rem;\n    }\n\n    .value {\n      font-size: 1.5rem;\n      font-weight: 600;\n      color: #1f2937;\n    }\n\n    &.positive .value {\n      color: #059669;\n    }\n\n    &.negative .value {\n      color: #dc2626;\n    }\n  }\n`;\n\n//  Sticky kompaktn pehled pi scrollovn\nconst StickyCompactSummary = styled.div`\n  position: fixed;\n  top: var(--app-fixed-offset-actual, 130px);\n  left: 0;\n  right: 0;\n  z-index: 40;\n  background: white;\n  border-bottom: 2px solid #3b82f6;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  padding: 0.75rem 2rem;\n\n  /* Plynul pechod */\n  opacity: ${props => props.$visible ? '1' : '0'};\n  transform: translateY(${props => props.$visible ? '0' : '-100%'});\n  transition: opacity 0.3s ease, transform 0.3s ease;\n  pointer-events: ${props => props.$visible ? 'auto' : 'none'};\n\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1rem;\n  flex-wrap: wrap;\n\n  @media (max-width: 768px) {\n    padding: 0.75rem 1rem;\n  }\n\n  @media print {\n    display: none !important;\n  }\n\n  .compact-title {\n    font-weight: 600;\n    color: #1f2937;\n    font-size: 1rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .compact-values {\n    display: flex;\n    gap: 2rem;\n    flex-wrap: wrap;\n  }\n\n  .compact-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n\n    .compact-label {\n      font-size: 0.75rem;\n      color: #6b7280;\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n    }\n\n    .compact-value {\n      font-size: 1.1rem;\n      font-weight: 600;\n      color: #1f2937;\n      margin-top: 0.1rem;\n\n      &.positive {\n        color: #059669;\n      }\n\n      &.negative {\n        color: #dc2626;\n      }\n    }\n  }\n\n  @media print {\n    display: none !important;\n  }\n`;\n\nconst TableContainer = styled.div`\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n  overflow-x: auto;\n  overflow-y: visible;\n  animation: ${fadeIn} 0.8s ease-out 0.4s both;\n`;\n\nconst Table = styled.table`\n  width: 100%;\n  border-collapse: collapse;\n\n  th, td {\n    padding: 0.75rem;\n    text-align: left;\n    border-bottom: 1px solid #e5e7eb;\n  }\n\n  th {\n    background: #f8fafc;\n    color: #374151;\n    font-weight: 600;\n    font-size: 0.875rem;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n    position: sticky;\n    top: 0;\n    z-index: 10;\n    line-height: 1.3;\n    vertical-align: middle;\n  }\n\n  td {\n    color: #1f2937;\n  }\n\n  tbody tr:hover {\n    background: #f9fafb;\n  }\n\n  .row-number {\n    width: 60px;\n    text-align: center;\n    font-weight: 600;\n    color: #6b7280;\n  }\n\n  .date-cell {\n    width: 130px; /* Zeno z 220px - datum se nesm zalamovat */\n    min-width: 130px;\n    padding: 0.5rem;\n    position: relative;\n    overflow: visible;\n    white-space: nowrap; /* Zabrnn zalamovn datumu */\n\n    /* DatePicker m vlastn padding, resetujeme padding buky kdy je uvnit */\n    > div {\n      margin: -0.25rem;\n      position: relative;\n      z-index: 100;\n    }\n  }\n\n  .document-cell {\n    width: 120px;\n    font-family: monospace;\n    font-weight: 500;\n    text-align: left;\n  }\n\n  .description-cell {\n    width: 360px; /* 60% pomr - Obsah */\n    text-align: left;\n  }\n\n  .person-cell {\n    width: 150px; /* Vrceno na pvodn ku */\n    text-align: center;\n\n    /* V td zarovnat vlevo */\n    td& {\n      text-align: left;\n    }\n  }\n\n  .amount-cell {\n    width: 120px;\n    text-align: center;\n    font-family: monospace;\n    font-weight: 500;\n\n    /* V td zarovnat vpravo */\n    td& {\n      text-align: right;\n    }\n  }\n\n  .balance-cell {\n    width: 120px;\n    text-align: center;\n    font-family: monospace;\n    font-weight: 600;\n\n    /* V td zarovnat vpravo a zvraznit */\n    td& {\n      text-align: right;\n      background: #f0f9f4;\n    }\n  }\n\n  .lp-code-cell {\n    width: 180px; /* Rozeno ze 100px - kvli popisu LP kdu */\n    min-width: 180px;\n    font-family: monospace;\n    font-size: 0.875rem;\n    text-align: left;\n  }\n\n  .note-cell {\n    width: 240px; /* 40% pomr - Poznmka */\n    font-size: 0.875rem;\n    color: #6b7280;\n    text-align: left;\n  }\n\n  .actions-cell {\n    width: 80px;\n    text-align: center;\n  }\n\n  .income {\n    color: #059669;\n  }\n\n  .expense {\n    color: #dc2626;\n  }\n`;\n\n// Wrapper pro cenov input s K symbolem\nconst CurrencyInputWrapper = styled.div`\n  position: relative;\n  width: 100%;\n\n  /* K symbol vpravo */\n  &::after {\n    content: 'K';\n    position: absolute;\n    right: 0.75rem;\n    top: 50%;\n    transform: translateY(-50%);\n    color: #6b7280;\n    font-size: 0.875rem;\n    font-weight: 500;\n    pointer-events: none;\n  }\n`;\n\nconst EditableInput = styled.input`\n  width: 100%;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  padding: 0.5rem;\n  font-size: 0.875rem;\n  transition: all 0.2s ease;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n\n  &.date-input {\n    font-family: monospace;\n  }\n\n  &.amount-input {\n    text-align: right;\n    font-family: monospace;\n    padding-right: 2.5rem; /* msto pro K symbol */\n\n    /* Odstrann spinner ipek - WebKit */\n    &::-webkit-outer-spin-button,\n    &::-webkit-inner-spin-button {\n      -webkit-appearance: none;\n      margin: 0;\n    }\n\n    /* Odstrann spinner ipek - Firefox */\n    &[type=number] {\n      -moz-appearance: textfield;\n    }\n  }\n\n  &.readonly {\n    background: #f3f4f6;\n    border-color: #e5e7eb;\n    cursor: not-allowed;\n  }\n`;\n\nconst EditableSelect = styled.select`\n  width: 100%;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  padding: 0.5rem;\n  font-size: 0.875rem;\n  background: white;\n  transition: all 0.2s ease;\n\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n  }\n`;\n\nconst ActionIcon = styled.button`\n  padding: 0.25rem;\n  border: none;\n  background: transparent;\n  color: #6b7280;\n  cursor: pointer;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f3f4f6;\n    color: ${props => props.danger ? '#dc2626' : '#374151'};\n  }\n\n  &:active {\n    transform: scale(0.95);\n  }\n`;\n\nconst AddRowButton = styled.button`\n  width: 100%;\n  padding: 1rem;\n  border: 2px dashed #d1d5db;\n  background: #f9fafb;\n  color: #6b7280;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n\n  &:hover {\n    border-color: #3b82f6;\n    background: #eff6ff;\n    color: #3b82f6;\n  }\n\n  &:active {\n    transform: scale(0.99);\n  }\n`;\n\n// =============================================================================\n// CURRENCY INPUT COMPONENT - Zachovv pozici kurzoru pi psan\n// =============================================================================\n\nfunction CurrencyInput({ value, onChange, onKeyDown, onBlur, placeholder = '0,00', disabled = false }) {\n  const inputRef = useRef(null);\n  const [localValue, setLocalValue] = useState('');\n  const [isFocused, setIsFocused] = useState(false);\n\n  // Funkce pro formtovn mny (BEZ K, protoe to je fixn vpravo)\n  const formatCurrency = (val) => {\n    if (!val && val !== 0) return '';\n    const num = parseFloat(val.toString().replace(/[^0-9.-]/g, ''));\n    if (isNaN(num)) return '';\n    // Pro pokladnu pesn 2 desetinn msta\n    return num.toFixed(2).replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ').replace('.', ',');\n  };\n\n  // Inicializace lokln hodnoty z props (pouze kdy nen focused)\n  useEffect(() => {\n    if (!isFocused) {\n      const formattedValue = formatCurrency(value || '');\n      if (localValue !== formattedValue) {\n        setLocalValue(formattedValue);\n      }\n    }\n  }, [value, isFocused]);\n\n  const handleChange = (e) => {\n    const newValue = e.target.value;\n\n    // Aktualizovat lokln hodnotu okamit (bez formtovn)\n    setLocalValue(newValue);\n\n    // Parsovat a vrtit jako number pro konzistentn ukldn\n    const cleanValue = newValue.replace(/[^\\d,.-]/g, '').replace(',', '.');\n    const numValue = parseFloat(cleanValue);\n    const finalValue = cleanValue === '' ? null : (isNaN(numValue) ? null : numValue);\n\n    // Volat onChange s parsovanou hodnotou\n    if (onChange) {\n      onChange({ target: { value: finalValue } });\n    }\n  };\n\n  const handleFocus = () => {\n    setIsFocused(true);\n  };\n\n  const handleBlurLocal = () => {\n    setIsFocused(false);\n\n    // Formtovat hodnotu pi ztrt fokusu\n    const formatted = formatCurrency(localValue);\n    setLocalValue(formatted);\n\n    // Zavolat parent onBlur\n    if (onBlur) {\n      onBlur();\n    }\n  };\n\n  const handleKeyDownLocal = (e) => {\n    if (onKeyDown) {\n      onKeyDown(e);\n    }\n  };\n\n  return (\n    <CurrencyInputWrapper>\n      <EditableInput\n        ref={inputRef}\n        type=\"text\"\n        placeholder={placeholder}\n        value={localValue}\n        onChange={handleChange}\n        onFocus={handleFocus}\n        onBlur={handleBlurLocal}\n        onKeyDown={handleKeyDownLocal}\n        disabled={disabled}\n        className=\"amount-input\"\n      />\n    </CurrencyInputWrapper>\n  );\n}\n\n// =============================================================================\n// COMPONENT\n// =============================================================================\n\nconst CashBookPage = () => {\n  const { user, token, hasPermission, userDetail } = useContext(AuthContext);\n  const { showToast } = useContext(ToastContext);\n\n  //  Nast posledn vbr obdob z localStorage (hlavn pro adminy)\n  const loadSavedPeriod = () => {\n    try {\n      const saved = localStorage.getItem('cashbook_selector_period');\n      if (saved) {\n        const { year, month } = JSON.parse(saved);\n        return { year, month };\n      }\n    } catch (err) {\n      // Tich chyba\n    }\n    return { year: new Date().getFullYear(), month: new Date().getMonth() + 1 };\n  };\n\n  const savedPeriod = loadSavedPeriod();\n\n  // Aktuln msc a rok pro paging\n  const [currentMonth, setCurrentMonth] = useState(savedPeriod.month); // 1-12\n  const [currentYear, setCurrentYear] = useState(savedPeriod.year);\n  const [carryOverAmount, setCarryOverAmount] = useState(0); // Pevod z pedchozho msce\n\n  //  State pro sticky kompaktn pehled\n  const [showStickySummary, setShowStickySummary] = useState(false);\n\n\n\n  // State pro ConfirmDialog\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [entryToDelete, setEntryToDelete] = useState(null);\n  const [closeMonthDialogOpen, setCloseMonthDialogOpen] = useState(false);\n  const [lockBookDialogOpen, setLockBookDialogOpen] = useState(false);\n  const [reopenMonthDialogOpen, setReopenMonthDialogOpen] = useState(false);\n  const [unlockBookDialogOpen, setUnlockBookDialogOpen] = useState(false);\n  const [retroactiveCreationBlockedDialogOpen, setRetroactiveCreationBlockedDialogOpen] = useState(false);\n\n  // Stav pokladn knihy - VECHNY HOOKS MUS BT NA ZATKU\n  //  FIX: Przdn pole - data se natou z DB nebo localStorage v useEffect\n  const [cashBookEntries, setCashBookEntries] = useState([]);\n\n  //  REF: Pro pstup k aktulnmu stavu v intervalech (bez restart intervalu)\n  const cashBookEntriesRef = useRef(cashBookEntries);\n  useEffect(() => {\n    cashBookEntriesRef.current = cashBookEntries;\n  }, [cashBookEntries]);\n\n  const [lastSavedEntryId, setLastSavedEntryId] = useState(null);\n\n  // LP kdy naten z API\n  const [lpCodes, setLpCodes] = useState([]);\n  const [lpLoading, setLpLoading] = useState(true);\n  \n  //  MULTI-LP: Inline rozbalovac panel pro editaci poddk\n  const [expandedDetailEntryId, setExpandedDetailEntryId] = useState(null);\n  const [detailEditBuffer, setDetailEditBuffer] = useState([]);\n\n  //  CASHBOOK V2: Piazen pokladny\n  const [mainAssignment, setMainAssignment] = useState(null);\n  const [assignmentLoading, setAssignmentLoading] = useState(true);\n\n  //  CASHBOOK V3: Vechny pokladny (pro uivatele s _ALL oprvnnmi)\n  const [userAssignments, setUserAssignments] = useState([]); // Pokladny uivatele\n  const [allAssignments, setAllAssignments] = useState([]);   // Vechny pokladny (admin/MANAGE)\n\n  //  KROK 3: Stav pokladn knihy a nastaven prefixu\n  const [bookStatus, setBookStatus] = useState('aktivni'); // aktivni | uzavrena_uzivatelem | zamknuta_spravcem\n  const [bookStatusMetadata, setBookStatusMetadata] = useState(null); // { closedDate, closedBy, lockedDate, lockedBy }\n  const [usePrefixedNumbers, setUsePrefixedNumbers] = useState(false); // Z nastaven cashbook_use_prefix\n  const [settingsLoading, setSettingsLoading] = useState(true);\n\n  //  DB SYNC: Tracking aktuln knihy a sync stavu\n  const [currentBookId, setCurrentBookId] = useState(null); // ID knihy v DB\n  const [currentBookData, setCurrentBookData] = useState(null); //  Cel objekt knihy z BE (obsahuje lokalita_nazev, usek_nazev atd.)\n  const [isSyncing, setIsSyncing] = useState(false); // Probh synchronizace\n  const [lastSyncTimestamp, setLastSyncTimestamp] = useState(null); // Posledn spn sync\n\n  //  PREVIOUS MONTH WARNING: Varovn pokud pedchoz msc nen uzaven\n  const [showPreviousMonthWarning, setShowPreviousMonthWarning] = useState(false);\n  const [syncConflicts, setSyncConflicts] = useState([]); // Pole konflikt ke zobrazen\n\n  // Zskat lokalitu podle pihlenho uivatele\n  const getUserLocation = () => {\n    // Zskn lokality z userDetail - sprvn cesta je lokalita_nazev.nazev\n    const location = userDetail?.lokalita_nazev?.nazev || userDetail?.lokalita?.nazev || userDetail?.location || \"Pbram\";\n    return location;\n  };\n\n  //  DEBUG: Sledovat zmny mainAssignment (zakomentovno - zpsobovalo spam v konzoli)\n  // useEffect(() => {\n  //   console.log(' mainAssignment ZMNA:', {\n  //     id: mainAssignment?.id,\n  //     cislo_pokladny: mainAssignment?.cislo_pokladny,\n  //     uzivatel_id: mainAssignment?.uzivatel_id,\n  //     uzivatel_cele_jmeno: mainAssignment?.uzivatel_cele_jmeno,\n  //     nazev_pracoviste: mainAssignment?.nazev_pracoviste,\n  //     je_hlavni: mainAssignment?.je_hlavni\n  //   });\n  // }, [mainAssignment]);\n\n  // Organizan info\n  const organizationInfo = {\n    organizationName: \"Zdravotnick zchrann sluba Stedoeskho kraje, pspvkov organizace\",\n    workplace: mainAssignment?.nazev_pracoviste || mainAssignment?.kod_pracoviste || getUserLocation(), //  Z vlastnka pokladny\n    cashboxNumber: mainAssignment?.cislo_pokladny || 600, //  Z piazen, fallback 600\n    cashboxVpd: mainAssignment?.ciselna_rada_vpd || null, //  seln ada VPD\n    cashboxPpd: mainAssignment?.ciselna_rada_ppd || null, //  seln ada PPD\n    month: new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long' }),\n    year: currentYear\n  };\n\n  //  OPRAVA: LocalStorage kl mus bt v useMemo aby se aktualizoval kdy pijde userDetail\n  //  OPRAVA 2: Kl mus zahrnovat i mainAssignment.id, aby admin ml oddlen cache pro kadou pokladnu\n  const STORAGE_KEY = useMemo(() => {\n    const userId = userDetail?.id || 'default';\n    const assignmentId = mainAssignment?.id || 'noassignment';\n    const key = `cashbook_${userId}_${assignmentId}_${currentYear}_${currentMonth}`;\n    return key;\n  }, [userDetail?.id, mainAssignment?.id, currentYear, currentMonth]);\n\n  //  OPRVNN: Vpoet oprvnn uivatele\n  const cashbookPermissions = useMemo(() => {\n    return getCashbookPermissionsObject(userDetail);\n  }, [userDetail]);\n\n  //  Me vidt vechny pokladny?\n  // UPRAVENO: Selector se zobraz i bnmu uivateli, pokud m vce ne 1 pokladnu piazenu\n  const canSeeAllCashboxes = useMemo(() => {\n    // Admin/MANAGE me vidt vechny pokladny v systmu\n    const hasAllPermissions = cashbookPermissions.canReadAll ||\n                              cashbookPermissions.canEditAll ||\n                              cashbookPermissions.canDeleteAll ||\n                              cashbookPermissions.canManage;\n\n    // Bn uivatel s vce ne 1 pokladnou me pepnat mezi svmi pokladnami\n    const hasMultipleCashboxes = userAssignments && userAssignments.length > 1;\n\n    return hasAllPermissions || hasMultipleCashboxes;\n  }, [cashbookPermissions, userAssignments]);\n\n  // =============================================================================\n  //  DB SYNC HELPER FUNCTIONS (mus bt ped useEffect kter je vol)\n  // =============================================================================\n\n  /**\n   * Transformace DB entry  Frontend formt\n   */\n  const transformDBEntryToFrontend = useCallback((dbEntry) => {\n    //  Pout DB timestamp pro detekci zmn (admin mohl peslovat)\n    const dbTimestamp = dbEntry.aktualizovano || dbEntry.vytvoreno;\n\n    //  MULTI-LP: Nast detail poloky pokud existuj\n    const detailItems = dbEntry.detail_items || [];\n    const hasDetails = detailItems.length > 0;\n\n    return {\n      id: `local_${Date.now()}_${Math.random()}`, // Lokln ID\n      db_id: dbEntry.id,                           // DB ID\n      date: dbEntry.datum_zapisu,\n      documentNumber: dbEntry.cislo_dokladu,\n      description: dbEntry.obsah_zapisu || '',\n      person: dbEntry.komu_od_koho || '',\n      income: dbEntry.castka_prijem ? parseFloat(dbEntry.castka_prijem) : null,\n      expense: dbEntry.castka_vydaj ? parseFloat(dbEntry.castka_vydaj) : null,\n      balance: parseFloat(dbEntry.zustatek_po_operaci || 0),\n      lpCode: hasDetails ? '' : (dbEntry.lp_kod || ''), // Master LP kod jen pokud NEN multi-LP\n      note: dbEntry.poznamka || '',\n      isEditing: false,\n\n      //  MULTI-LP support\n      detailItems: detailItems.map(item => ({\n        lp_kod: item.lp_kod || '',\n        castka: parseFloat(item.castka || 0),\n        popis: item.popis || ''\n      })),\n\n      //  SYNC metadata pro detekci zmn v DB\n      last_modified_local: new Date().toISOString(),\n      last_synced_at: dbTimestamp,           // Kdy bylo naposledy syncnut z DB\n      db_updated_at: dbTimestamp,            // Kdy bylo v DB aktualizovno\n      changed: false,                        // Zda m lokln neuloen zmny\n      sync_status: 'synced'                  // synced | pending | error\n    };\n  }, []); // dn dependencies\n\n  /**\n   * Transformace Frontend entry  DB payload\n   */\n  const transformFrontendEntryToDB = useCallback((entry, bookId) => {\n    const payload = {\n      book_id: bookId,\n      datum_zapisu: entry.date,\n      cislo_dokladu: entry.documentNumber, //  Poslat slo dokladu (me bt zmnno pi zmn typu)\n      obsah_zapisu: entry.description || '', // Vdy poslat, i kdy przdn string\n      komu_od_koho: entry.person || '', // Vdy poslat\n      //  FIX: Explicitn poslat 0 msto null/undefined, aby se smazala pvodn hodnota\n      castka_prijem: entry.income || 0,\n      castka_vydaj: entry.expense || 0,\n      typ_dokladu: entry.expense > 0 ? 'vydaj' : 'prijem', //  MULTI-LP potebuje typ\n      poznamka: entry.note || '' // Vdy poslat\n    };\n    \n    //  MULTI-LP: Pokud m detailItems, poslat je (NEPOSLAT master lp_kod)\n    if (entry.detailItems && entry.detailItems.length > 0) {\n      payload.detail_items = entry.detailItems;\n      payload.castka_celkem = entry.detailItems.reduce((sum, item) => sum + (item.castka || 0), 0);\n      // Master LP kd je przdn, kdy jsou detaily\n    } else if (entry.lpCode) {\n      // Pvodn flow - pouze pokud NEN multi-LP\n      payload.lp_kod = entry.lpCode;\n    }\n    \n    return payload;\n  }, []); // dn dependencies\n\n  /**\n   * Naten knihy z DB (nebo vytvoen nov)\n   */\n  const ensureBookExists = useCallback(async () => {\n    if (!mainAssignment?.id || !userDetail?.id) {\n      return null;\n    }\n\n    try {\n      //  FIX: Kdy admin pepne na jinou pokladnu, nast knihy pro UIVATELE T POKLADNY\n      const targetUserId = mainAssignment.uzivatel_id || userDetail.id;\n\n      // 1. Zkusit nast existujc knihu\n      const booksResult = await cashbookAPI.listBooks(targetUserId, currentYear, currentMonth);\n\n      if (booksResult.status === 'ok' && booksResult.data?.books?.length > 0) {\n        const book = booksResult.data.books[0];\n\n        setCurrentBookId(book.id);\n        setCurrentBookData(book); //  Uloit cel objekt knihy\n        setBookStatus(book.stav_knihy || 'aktivni');\n        setCarryOverAmount(parseFloat(book.prevod_z_predchoziho || 0));\n\n        // Nast detaily knihy vetn poloek (s force_recalc pro aktuln pevod)\n        const bookDetail = await cashbookAPI.getBook(book.id, true);\n\n        if (bookDetail.status === 'ok' && bookDetail.data?.entries) {\n          // Transformovat entries do frontend formtu\n          const transformedEntries = bookDetail.data.entries.map(transformDBEntryToFrontend);\n          return { book, entries: transformedEntries };\n        }\n\n        return { book, entries: [] };\n      } else {\n        // 2. Kniha neexistuje - zkusit vytvoit\n        //  Pokud m uivatel piazen (mainAssignment.id existuje), vytvo knihu\n        if (mainAssignment?.id) {\n\n          const createResult = await cashbookAPI.createBook(\n            mainAssignment.id,  // prirazeni_pokladny_id\n            currentYear,\n            currentMonth,\n            targetUserId        // uzivatel_id\n          );\n\n          if (createResult.status === 'ok') {\n            //  Backend vrac jen book_id (ne cel objekt)\n            const bookId = createResult.data?.book_id || createResult.data?.id;\n\n            if (bookId) {\n              // Nast kompletn knihu z DB (vetn prevod_z_predchoziho s force_recalc)\n              const bookDetail = await cashbookAPI.getBook(bookId, true);\n\n              if (bookDetail.status === 'ok') {\n                const newBook = bookDetail.data?.book || bookDetail.data;\n\n                setCurrentBookId(bookId);\n                setCurrentBookData(newBook); //  Uloit cel objekt knihy\n                setBookStatus(newBook.stav_knihy || 'aktivni');\n                setCarryOverAmount(parseFloat(newBook.prevod_z_predchoziho || 0));\n\n                const transformedEntries = (bookDetail.data?.entries || []).map(transformDBEntryToFrontend);\n                return { book: newBook, entries: transformedEntries };\n              }\n            }\n          }\n\n          // Pokud se sem dostaneme, nco se nepovedlo\n          const errorMsg = createResult.message || createResult.error || 'Backend nevrtil book_id';\n          throw new Error('Nepodailo se vytvoit knihu: ' + errorMsg);\n        } else {\n          //  Uivatel nem piazen pokladny - zobrazit chybu\n          console.warn(' Uivatel nem piazen k dn pokladn', { mainAssignment, userDetail });\n          throw new Error('NO_ASSIGNMENT');\n        }\n      }\n    } catch (error) {\n      console.error(' Chyba pi zajitn existence knihy:', error);\n\n      //  Speciln zpracovn chyby - uivatel nem piazen\n      if (error.message === 'NO_ASSIGNMENT') {\n        showToast('Bohuel Vm pokladn kniha nebyla pidlena. Kontaktujte sprvce.', 'error');\n        // Nastavit przdn stav\n        setCashBookEntries([]);\n        setCurrentBookId(null);\n        return null;\n      }\n\n      showToast('Chyba pi natn/vytven knihy: ' + error.message, 'error');\n      return null;\n    }\n  }, [mainAssignment, userDetail, currentYear, currentMonth, showToast, transformDBEntryToFrontend]);\n\n  /**\n   * Uloit data do localStorage (backup)\n   */\n  const saveToLocalStorage = useCallback((entries, status, carryOver) => {\n    const dataToSave = {\n      entries: entries,\n      bookStatus: status,\n      carryOverAmount: carryOver,\n      lastModified: new Date().toISOString(),\n      lastSyncTimestamp: lastSyncTimestamp\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n  }, [STORAGE_KEY, lastSyncTimestamp]);\n\n  /**\n   * Synchronizace loklnch zmn do DB\n   * @param {Array} entries - Pole poloek k synchronizaci\n   * @param {number} bookId - ID knihy (voliteln, pouije currentBookId ze state)\n   */\n  const syncLocalChangesToDB = useCallback(async (entries, bookId = null) => {\n    const targetBookId = bookId || currentBookId;\n\n    if (!targetBookId || isSyncing) {\n      return;\n    }\n\n    if (isSyncing) {\n      return;\n    }\n\n    try {\n      setIsSyncing(true);\n\n      let syncedCount = 0;\n      let errorCount = 0;\n\n      for (const entry of entries) {\n        // Peskoit poloky kter jsou ji syncnut\n        if (entry.sync_status === 'synced' && !entry.changed) {\n          continue;\n        }\n\n        try {\n          if (entry.db_id) {\n            // Existuje v DB - update\n            await cashbookAPI.updateEntry(entry.db_id, transformFrontendEntryToDB(entry, targetBookId));\n          } else {\n            // Neexistuje v DB - create\n            const result = await cashbookAPI.createEntry(transformFrontendEntryToDB(entry, targetBookId));\n\n            if (result.status === 'ok' && result.data?.entry) {\n              // Aktualizovat entry s DB ID\n              entry.db_id = result.data.entry.id;\n              entry.documentNumber = result.data.entry.cislo_dokladu;\n            }\n          }\n\n          // Oznait jako syncnut\n          entry.changed = false;\n          entry.sync_status = 'synced';\n          entry.last_synced_at = new Date().toISOString();\n          syncedCount++;\n\n        } catch (error) {\n          console.error(' Chyba pi sync entry:', error);\n          entry.sync_status = 'error';\n          errorCount++;\n        }\n      }\n\n      // Aktualizovat totals v DB\n      const totalIncome = entries.reduce((sum, e) => sum + (e.income || 0), 0);\n      const totalExpenses = entries.reduce((sum, e) => sum + (e.expense || 0), 0);\n      const endBalance = carryOverAmount + totalIncome - totalExpenses;\n\n      await cashbookAPI.updateBook(targetBookId, {\n        celkove_prijmy: totalIncome,\n        celkove_vydaje: totalExpenses,\n        koncovy_stav: endBalance,\n        pocet_zaznamu: entries.length\n      });\n\n      setLastSyncTimestamp(new Date().toISOString());\n\n      if (errorCount > 0) {\n        showToast(`Synchronizovno ${syncedCount} poloek, ${errorCount} chyb`, 'warning');\n      }\n\n    } catch (error) {\n      console.error(' Chyba pi synchronizaci:', error);\n      showToast('Chyba pi synchronizaci s databz', 'error');\n    } finally {\n      setIsSyncing(false);\n    }\n  }, [currentBookId, isSyncing, carryOverAmount, showToast, transformFrontendEntryToDB]);\n\n  //  DB SYNC: Nast data z DB pi naten komponenty nebo zmn msce\n  useEffect(() => {\n    //  DLEIT: Nepokrauj pokud jet nemme userDetail nebo mainAssignment\n    if (!userDetail?.id || !mainAssignment?.id) {\n      return;\n    }\n\n    const loadDataFromDB = async () => {\n      try {\n        // 1. Zajistit existenci knihy v DB (nebo vytvoit novou)\n        const result = await ensureBookExists();\n\n        if (!result) {\n          // Pokud je to chyba oprvnn, nechat przdnou tabulku (ji zobrazen chyba v ensureBookExists)\n          // Jinak zkusit localStorage jako fallback\n          if (currentBookId === null) {\n            // Nebyla vytvoena/natena dn kniha - zobrazit przdnou strnku\n            setCashBookEntries([]);\n            return;\n          }\n          loadFromLocalStorageOnly();\n          return;\n        }\n\n        const { book, entries } = result;\n\n        //  NASTAVIT STAV KNIHY HNED PO NATEN (priorita DB dat)\n        setBookStatus(book.stav_knihy || 'aktivni');\n\n        //  NASTAVIT METADATA O UZAVEN/ZAMEN\n        // Backend vrac kompletn jmna (uzivatel_jmeno_plne, zamknul_spravce_jmeno_plne)\n        const closedByName = book.uzivatel_jmeno_plne || `ID: ${book.uzivatel_id}`;\n        const lockedByName = book.zamknul_spravce_jmeno_plne || null;\n\n        setBookStatusMetadata({\n          closedDate: book.uzavrena_uzivatelem_kdy || null,\n          closedBy: closedByName,\n          lockedDate: book.zamknuta_spravcem_kdy || null,\n          lockedBy: lockedByName,\n        });\n\n        //  DETEKCE PAGE RELOAD (F5)\n        // Pokud je performance.navigation.type === 1, je to reload strnky\n        const isPageReload = window.performance?.navigation?.type === 1 ||\n                            window.performance?.getEntriesByType?.('navigation')?.[0]?.type === 'reload';\n\n        // 2. Nast localStorage pro porovnn (pouze pokud NEN page reload)\n        const savedData = localStorage.getItem(STORAGE_KEY);\n        let localEntries = [];\n        let localTimestamp = null;\n\n        if (savedData && !isPageReload) {\n          try {\n            const parsed = JSON.parse(savedData);\n            localEntries = parsed.entries || [];\n            localTimestamp = parsed.lastSyncTimestamp;\n          } catch (error) {\n            console.error(' Chyba parsovn localStorage:', error);\n          }\n        }\n\n        //  KONTROLA: Porovnat timestamp DB vs localStorage\n        // Pokud m DB novj data (nap. admin pesloval), pout DB\n        const dbIsNewer = book.aktualizovano && localTimestamp &&\n                         new Date(book.aktualizovano) > new Date(localTimestamp);\n\n\n\n        // 3. Rozhodnout, kter data pout\n        //  STRATEGIE: DB JE VDY ZDROJ PRAVDY\n        // localStorage slou POUZE jako doasn offline backup\n        // Po F5 nebo zmn uivatele se VDY nate erstv data z DB\n\n        //  PRAVIDLO 1: Pokud je page reload (F5), VDY ignorovat localStorage\n        if (isPageReload) {\n          // F5  nast jen z DB, smazat star localStorage\n          setCashBookEntries(entries);\n          if (entries.length > 0) {\n            saveToLocalStorage(entries, book.stav_knihy, parseFloat(book.prevod_z_predchoziho || 0));\n          } else {\n            localStorage.removeItem(STORAGE_KEY);\n          }\n          setLastSyncTimestamp(new Date().toISOString());\n        }\n        //  PRAVIDLO 2: Pokud DB m novj data ne localStorage (timestamp check)\n        else if (dbIsNewer) {\n          // Admin mohl zmnit data (peslovn doklad)  pout DB\n          setCashBookEntries(entries);\n          saveToLocalStorage(entries, book.stav_knihy, parseFloat(book.prevod_z_predchoziho || 0));\n          setLastSyncTimestamp(new Date().toISOString());\n        }\n        //  PRAVIDLO 3: Pokud DB m data, pout DB (standardn naten)\n        else if (entries.length > 0) {\n          // DB m data  pout DB jako zdroj pravdy\n          setCashBookEntries(entries);\n          saveToLocalStorage(entries, book.stav_knihy, parseFloat(book.prevod_z_predchoziho || 0));\n          setLastSyncTimestamp(new Date().toISOString());\n        }\n        //  PRAVIDLO 4: DB je przdn, ale localStorage m unsyncnut data\n        else if (entries.length === 0 && localEntries.length > 0) {\n          // Pouze pokud localStorage pat TTO pokladn a TOMUTO uivateli\n          const isValidCache = STORAGE_KEY.includes(`_${mainAssignment.id}_`) &&\n                              STORAGE_KEY.includes(`_${userDetail.id}_`);\n\n          if (isValidCache) {\n            // Offline reim - pout lokln data a pokusit se sync\n            setCashBookEntries(localEntries);\n            syncLocalChangesToDB(localEntries, book.id);\n          } else {\n            // Cache je pro jinou pokladnu/uivatele  smazat a zat ist\n            setCashBookEntries([]);\n            localStorage.removeItem(STORAGE_KEY);\n          }\n        }\n        //  PRAVIDLO 4: Ani DB ani localStorage nem data  przdn start\n        else {\n          setCashBookEntries([]);\n          localStorage.removeItem(STORAGE_KEY);\n        }\n\n      } catch (error) {\n        console.error(' Chyba pi natn z DB:', error);\n        loadFromLocalStorageOnly();\n      }\n    };\n\n    // Helper: Nast pouze z localStorage (fallback)\n    const loadFromLocalStorageOnly = () => {\n      const savedData = localStorage.getItem(STORAGE_KEY);\n\n      // Nast konen zstatek z pedchozho msce (pro vpoet carryOver pokud nen uloen)\n      const prevMonth = currentMonth === 1 ? 12 : currentMonth - 1;\n      const prevYear = currentMonth === 1 ? currentYear - 1 : currentYear;\n      const prevStorageKey = `cashbook_${userDetail.id}_${prevYear}_${prevMonth}`;\n\n      let calculatedCarryOver = 0;\n      const prevMonthData = localStorage.getItem(prevStorageKey);\n\n      if (prevMonthData) {\n        try {\n          const prevParsed = JSON.parse(prevMonthData);\n          const prevEntries = prevParsed.entries || [];\n\n          // Spotat konen zstatek pedchozho msce\n          const prevInitialBalance = prevParsed.carryOverAmount || 0;\n          const totalIncome = prevEntries.reduce((sum, entry) => sum + (entry.income || 0), 0);\n          const totalExpenses = prevEntries.reduce((sum, entry) => sum + (entry.expense || 0), 0);\n          calculatedCarryOver = prevInitialBalance + totalIncome - totalExpenses;\n\n        } catch (error) {\n          console.error(' Chyba pi natn dat pedchozho msce:', error);\n        }\n      }\n\n      if (savedData) {\n        try {\n          const parsed = JSON.parse(savedData);\n\n          // Nast entries z localStorage\n          setCashBookEntries(parsed.entries || []);\n          setBookStatus(parsed.bookStatus || 'aktivni');\n\n          const storedCarryOver = parsed.carryOverAmount;\n          if (typeof storedCarryOver === 'number') {\n            setCarryOverAmount(storedCarryOver);\n          } else {\n            setCarryOverAmount(calculatedCarryOver);\n            const updatedData = { ...parsed, carryOverAmount: calculatedCarryOver };\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedData));\n          }\n        } catch (error) {\n          console.error(' Chyba pi natn dat z localStorage:', error);\n          setCashBookEntries([]);\n          setCarryOverAmount(calculatedCarryOver);\n        }\n      } else {\n        setCashBookEntries([]);\n        setCarryOverAmount(calculatedCarryOver);\n      }\n    };\n\n    // Spustit natn z DB\n    loadDataFromDB();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [STORAGE_KEY, currentMonth, currentYear, userDetail?.id, mainAssignment?.id, mainAssignment?.cislo_pokladny]);\n\n  // Nast LP kdy z API pi naten komponenty (jednou)\n  useEffect(() => {\n    const loadLpCodes = async () => {\n\n      // OPRAVA: token je samostatn promnn, nen soust user objektu!\n      if (!token || !user?.username) {\n        setLpLoading(false);\n        return;\n      }\n\n      try {\n        setLpLoading(true);\n\n        // Pout stejnou funkci jako v OrderForm25\n        const data = await fetchLimitovanePrisliby({\n          token: token,\n          username: user.username\n        });\n\n        // Transformovat data do jednotnho formtu { code, name }\n        // SPRVN STRUKTURA: cislo_lp (nap. \"LPIT01\"), nazev_uctu (nzev LP kdu)\n        const transformedLps = Array.isArray(data) ? data.map(lp => {\n          const code = lp.cislo_lp || lp.kod || lp.code || lp.id;\n          const name = lp.nazev_uctu || lp.nazev || lp.name || lp.popis || '';\n          return { code, name };\n        }) : [];\n\n        setLpCodes(transformedLps);\n        setLpLoading(false);\n      } catch (error) {\n        console.error(' Chyba pi natn LP kd:', error);\n        showToast('Nepodailo se nast LP kdy', 'error');\n        setLpCodes([]);\n        setLpLoading(false);\n      }\n    };\n\n    loadLpCodes();\n  }, [token, user?.username, showToast]); // Nate se jednou kdy mme token a username\n\n  //  STICKY SUMMARY: Sledovn scrollu pro zobrazen kompaktnho pehledu\n  useEffect(() => {\n    const handleScroll = () => {\n      // Layout pouv fixed main element pro scrollovn\n      const mainElement = document.querySelector('main');\n      if (!mainElement) return;\n\n      const scrollTop = mainElement.scrollTop;\n\n      // Zobrazit sticky pi scrollu 575px\n      const threshold = 575;\n      const shouldShow = scrollTop > threshold;\n\n      // Debug - odkomentuj pro testovn\n      // console.log('Scroll:', scrollTop, 'Threshold:', threshold, 'Show:', shouldShow);\n\n      setShowStickySummary(shouldShow);\n    };\n\n    // Najt main element a pipojit listener\n    const mainElement = document.querySelector('main');\n    if (!mainElement) return;\n\n    mainElement.addEventListener('scroll', handleScroll);\n\n    // Kontrola pi mount (pokud u je scrollnut)\n    handleScroll();\n\n    // Re-kalkulovat threshold pi resize (mn se vka InfoPanel)\n    window.addEventListener('resize', handleScroll);\n\n    return () => {\n      if (mainElement) {\n        mainElement.removeEventListener('scroll', handleScroll);\n      }\n      window.removeEventListener('resize', handleScroll);\n    };\n  }, []);\n\n  //  AUTO REFRESH: Automatick refresh pi nvratu do okna + periodick refresh\n  useEffect(() => {\n    // Funkce pro refresh dat z DB\n    const refreshDataFromDB = async (showMessage = false) => {\n      if (!currentBookId) return;\n\n      try {\n        // 1. Nast fresh data z DB vetn book info (s force_recalc pro pepoet pevodu)\n        const bookData = await cashbookAPI.getBook(currentBookId, true);\n\n        if (bookData.status === 'ok') {\n          //  FIX: Aktualizovat carryOverAmount z DB (me se zmnit pi prav pedchozho msce)\n          const book = bookData.data?.book || bookData.data;\n          if (book && book.prevod_z_predchoziho !== undefined) {\n            const freshCarryOver = parseFloat(book.prevod_z_predchoziho || 0);\n            setCarryOverAmount(freshCarryOver);\n          }\n\n          const entries = bookData.data?.entries || [];\n          const dbEntries = entries.map(entry => ({\n            ...entry,\n            id: entry.id || `temp-${Date.now()}-${Math.random()}`,\n            db_id: entry.id,\n            date: entry.datum_zapisu || entry.datum || new Date().toISOString().split('T')[0],\n            documentNumber: entry.cislo_dokladu || '',\n            description: entry.obsah_zapisu || '',\n            person: entry.komu_od_koho || '',\n            income: entry.castka_prijem ? parseFloat(entry.castka_prijem) : null,\n            expense: entry.castka_vydaj ? parseFloat(entry.castka_vydaj) : null,\n            balance: parseFloat(entry.zustatek_po_operaci || 0),\n            lpCode: entry.lp_kod || '',\n            note: entry.poznamka || '',\n            isEditing: false,\n            changed: false,\n            sync_status: 'synced'\n          }));\n\n          // 2. Nast lokln data z localStorage\n          const stored = localStorage.getItem(STORAGE_KEY);\n          const localData = stored ? JSON.parse(stored) : null;\n\n          // 3. Slouit data - DB m pednost, ale zachovat lokln editace\n          if (localData?.entries && localData.entries.some(e => e.isEditing || e.changed)) {\n            // Jsou lokln zmny - mergovat opatrn\n            const mergedEntries = dbEntries.map(dbEntry => {\n              const localEntry = localData.entries.find(le => le.id === dbEntry.id);\n              return localEntry?.changed ? localEntry : dbEntry;\n            });\n\n            setCashBookEntries(mergedEntries);\n            if (showMessage) {\n              showToast('Data refreshnuta - zachovny lokln zmny', 'info');\n            }\n          } else {\n            // dn lokln zmny - prost nahradit\n            setCashBookEntries(dbEntries);\n            if (showMessage) {\n              showToast('Data aktualizovna z DB', 'success');\n            }\n          }\n        }\n      } catch (error) {\n        console.error(' Chyba pi auto-refresh:', error);\n        // Tich chyba - neomezovat UX\n      }\n    };\n\n    // Handler pro nvrat do okna\n    const handleVisibilityChange = () => {\n      // Pokud se uivatel vrt do okna (z hidden na visible)\n      if (!document.hidden && currentBookId) {\n        refreshDataFromDB(true); // S toast notifikac\n      }\n    };\n\n    // Periodick refresh na pozad kad 2 minuty\n    const intervalId = setInterval(() => {\n      //  KONTROLA: Pouze pokud uivatel NEUPRAVUJE dn zznam A NEM NEULOEN ZMNY\n      // Zkontroluj, zda nen njak entry v reimu editace nebo nesynchronizovan zmny\n      const stored = localStorage.getItem(STORAGE_KEY);\n      const localData = stored ? JSON.parse(stored) : null;\n      const hasEditingEntryInLocalStorage = localData?.entries?.some(e => e.isEditing) || false;\n      const hasUnsyncedChanges = localData?.entries?.some(e => e.changed || e.sync_status !== 'synced') || false;\n\n      //  FIX: Kontrola i aktulnho stavu cashBookEntries (pouit ref pro aktuln hodnotu)\n      const hasEditingEntryInState = cashBookEntriesRef.current?.some(e => e.isEditing) || false;\n\n      if (!hasEditingEntryInLocalStorage && !hasEditingEntryInState && !hasUnsyncedChanges) {\n        // Refresh POUZE kdy:\n        // 1. dn zznam nen v editaci (localStorage)\n        // 2. dn zznam nen v editaci (aktuln state)\n        // 3. dn zznam nem nesynchronizovan zmny\n        refreshDataFromDB(false); // Bez toast notifikace\n      }\n      // Pokud je njak zznam v editaci, peskome refresh\n    }, 120000); // 2 minuty (120 sekund)\n\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n\n    return () => {\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n      clearInterval(intervalId);\n    };\n  }, [currentBookId, STORAGE_KEY, showToast]);\n\n  //  UNIFIED: Nast assignments (vlastn + admin allAssignments) v JEDNOM useEffect\n  useEffect(() => {\n    const loadAllData = async () => {\n      if (!userDetail?.id) {\n        return;\n      }\n\n      try {\n        setAssignmentLoading(true);\n\n        // 1 VDY nast vlastn piazen\n        const userResult = await cashbookAPI.listAssignments(userDetail.id, true);\n        const userAssignments = userResult.data?.assignments || [];\n        setUserAssignments(userAssignments);\n\n        // 2 Pokud m admin oprvnn, nast i vechny pokladny\n        let allAvailableAssignments = userAssignments; // Default pro bn uivatele\n\n        if (canSeeAllCashboxes) {\n          try {\n            const allResult = await cashbookAPI.getCashboxListByPeriod(\n              currentYear,\n              currentMonth,\n              true,  // active_only\n              true   // include_users\n            );\n\n            if (allResult.status === 'ok' && allResult.data?.pokladny) {\n              const transformedData = allResult.data.pokladny.map(item => ({\n                ...item,\n                id: parseInt(item.prirazeni_id || item.id, 10),\n                pokladna_id: parseInt(item.id, 10),\n                cislo_pokladny: parseInt(item.cislo_pokladny, 10),\n                aktivni: parseInt(item.aktivni, 10),\n                uzivatel_id: parseInt(item.uzivatel_id, 10),\n                je_hlavni: 1,\n              }));\n\n              setAllAssignments(transformedData);\n              allAvailableAssignments = transformedData; // Admin vid vechny\n            }\n          } catch (err) {\n            // Tich chyba - nen kritick\n          }\n        }\n\n        // 3 Vybrat sprvnou pokladnu (localStorage  hlavn  prvn)\n        let selectedAssignment = null;\n\n        // Zkusit localStorage\n        try {\n          const saved = localStorage.getItem('cashbook_selector_cashbox');\n          if (saved) {\n            const savedData = JSON.parse(saved);\n            selectedAssignment = allAvailableAssignments.find(a => a.id === savedData.id);\n          }\n        } catch (err) {\n          // Tich chyba\n        }\n\n        // Fallback na hlavn nebo prvn\n        if (!selectedAssignment) {\n          const main = allAvailableAssignments.find(a => a.je_hlavni === 1);\n          selectedAssignment = main || allAvailableAssignments[0];\n        }\n\n        if (selectedAssignment) {\n          setMainAssignment(selectedAssignment);\n        } else {\n          showToast('Nemte piazenou pokladnu.', 'error');\n        }\n\n      } catch (error) {\n        console.error(' Chyba pi natn dat:', error);\n        showToast('Chyba pi natn dat: ' + error.message, 'error');\n      } finally {\n        setAssignmentLoading(false);\n      }\n    };\n\n    loadAllData();\n  }, [userDetail?.id, canSeeAllCashboxes, currentYear, currentMonth, showToast]);\n\n  //  Uloit vbr obdob do localStorage (hlavn pro adminy)\n  useEffect(() => {\n    try {\n      localStorage.setItem('cashbook_selector_period', JSON.stringify({\n        year: currentYear,\n        month: currentMonth\n      }));\n    } catch (err) {\n      // Tich chyba\n    }\n  }, [currentYear, currentMonth]);\n\n  //  KROK 4: Nast nastaven prefixovanch sel pi mount\n  useEffect(() => {\n    const loadSettings = async () => {\n      try {\n        setSettingsLoading(true);\n\n        // Backend API vrac pi dotazu na konkrtn kl: {status: 'ok', data: {key: 'cashbook_use_prefix', value: '0'}}\n        const result = await cashbookAPI.getSettings('cashbook_use_prefix');\n\n        if (result.status === 'ok' && result.data) {\n          // Backend vrac objekt s key a value, ne pole\n          const value = result.data.value;\n          const usePrefix = value === '1' || value === 1;\n          setUsePrefixedNumbers(usePrefix);\n        } else {\n          setUsePrefixedNumbers(false);\n        }\n      } catch (error) {\n        console.error(' CASHBOOK V2: Chyba pi natn nastaven:', error);\n        // V ppad chyby pouijeme false (bez prefix)\n        setUsePrefixedNumbers(false);\n      } finally {\n        setSettingsLoading(false);\n      }\n    };\n\n    loadSettings();\n  }, []);\n\n  // Poten zstatek = pevod z pedchozho msce\n  const initialBalance = carryOverAmount;\n\n  // Vypotan hodnoty\n  const totals = React.useMemo(() => {\n    const totalIncome = cashBookEntries.reduce((sum, entry) => sum + (entry.income || 0), 0);\n    const totalExpenses = cashBookEntries.reduce((sum, entry) => sum + (entry.expense || 0), 0);\n    const currentBalance = initialBalance + totalIncome - totalExpenses;\n\n    return {\n      totalIncome,\n      totalExpenses,\n      currentBalance,\n      entryCount: cashBookEntries.length\n    };\n  }, [cashBookEntries, carryOverAmount, initialBalance]);\n\n  //  ZJEDNODUENO: Pouvme data pmo z cashBookEntries jak pijdou z DB\n  // DB u obsahuje sprvn peslovan doklady, nen teba je pepotvat\n\n  //  Funkce pro naten poslednch P a V sel z pedchozho msce\n  const getLastDocumentNumbersFromPreviousMonth = useCallback(async () => {\n    if (!mainAssignment?.uzivatel_id) {\n      return { lastP: 0, lastV: 0 };\n    }\n\n    const userId = mainAssignment.uzivatel_id;\n    const prevMonth = currentMonth === 1 ? 12 : currentMonth - 1;\n    const prevYear = currentMonth === 1 ? currentYear - 1 : currentYear;\n\n    try {\n      // Najt knihu pro pedchoz msc\n      const booksResult = await cashbookAPI.listBooks(userId, prevYear, prevMonth);\n\n      if (booksResult.status !== 'ok' || !booksResult.data?.books || booksResult.data.books.length === 0) {\n        return { lastP: 0, lastV: 0 };\n      }\n\n      const prevBook = booksResult.data.books[0]; // Prvn kniha pro ten msc\n\n      // Nast entries z t knihy\n      const bookResult = await cashbookAPI.getBook(prevBook.id, false);\n\n      if (bookResult.status === 'ok' && bookResult.data?.entries?.length > 0) {\n        const entries = bookResult.data.entries;\n\n        // Najt nejvy P slo (z DB pole cislo_dokladu)\n        const pNumbers = entries\n          .filter(e => e.cislo_dokladu?.startsWith('P'))\n          .map(e => parseInt(e.cislo_dokladu.substring(1)) || 0);\n        const lastP = pNumbers.length > 0 ? Math.max(...pNumbers) : 0;\n\n        // Najt nejvy V slo\n        const vNumbers = entries\n          .filter(e => e.cislo_dokladu?.startsWith('V'))\n          .map(e => parseInt(e.cislo_dokladu.substring(1)) || 0);\n        const lastV = vNumbers.length > 0 ? Math.max(...vNumbers) : 0;\n\n        return { lastP, lastV };\n      }\n\n      return { lastP: 0, lastV: 0 };\n    } catch (error) {\n      console.error(' Chyba pi natn sel z pedchozho msce:', error);\n      return { lastP: 0, lastV: 0 };\n    }\n  }, [mainAssignment, currentMonth, currentYear]);\n\n  // Formtovn eskch korun\n  const formatCurrency = (amount) => {\n    if (amount === null || amount === undefined) return '';\n    return new Intl.NumberFormat('cs-CZ', {\n      style: 'currency',\n      currency: 'CZK',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2\n    }).format(amount);\n  };\n\n  // Formtovn eskho data\n  const formatDate = (dateStr) => {\n    if (!dateStr) return '';\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('cs-CZ');\n  };\n\n  // Dnen datum ve formtu YYYY-MM-DD\n  const getTodayDate = () => {\n    const today = new Date();\n    return today.toISOString().split('T')[0];\n  };\n\n  //  ZJEDNODUENO: Generovn sla dokladu - pokrauje od poslednho v aktulnm msci\n  // Pokud je msc przdn, nate posledn slo z pedchozho msce\n  const generateDocumentNumber = async (isIncome) => {\n    const type = isIncome ? 'P' : 'V';\n\n    // Najt nejvy slo v aktulnm msci\n    const currentMonthNumbers = cashBookEntries\n      .filter(entry => entry.documentNumber?.startsWith(type))\n      .map(entry => parseInt(entry.documentNumber.substring(1)) || 0);\n\n    let nextNumber;\n\n    if (currentMonthNumbers.length > 0) {\n      // Pokud u mme doklady v tomto msci, pokrauj od nejvyho\n      nextNumber = Math.max(...currentMonthNumbers) + 1;\n    } else {\n      // Pokud je msc przdn, nati posledn slo z pedchozho msce\n      const { lastP, lastV } = await getLastDocumentNumbersFromPreviousMonth();\n      nextNumber = (type === 'P' ? lastP : lastV) + 1;\n    }\n\n    return `${type}${String(nextNumber).padStart(3, '0')}`;\n  };\n\n  //  Helper: Kontrola, zda existuj uzaven msce v budoucnosti\n  const checkForClosedFutureMonths = useCallback(async (targetYear, targetMonth) => {\n    if (!mainAssignment?.uzivatel_id) {\n      return { hasClosedFuture: false, closedMonths: [] };\n    }\n\n    try {\n      const userId = mainAssignment.uzivatel_id;\n      const closedMonths = [];\n\n      // Projt vechny msce od targetMonth+1 do aktulnho msce\n      const today = new Date();\n      const currentSystemMonth = today.getMonth() + 1;\n      const currentSystemYear = today.getFullYear();\n\n      let checkYear = targetYear;\n      let checkMonth = targetMonth + 1;\n\n      // Normalizace (pokud je targetMonth = 12, dal msc je 1 v dalm roce)\n      if (checkMonth > 12) {\n        checkMonth = 1;\n        checkYear++;\n      }\n\n      // Prochzet msce a do aktulnho\n      while (\n        checkYear < currentSystemYear ||\n        (checkYear === currentSystemYear && checkMonth <= currentSystemMonth)\n      ) {\n        const booksResult = await cashbookAPI.listBooks(userId, checkYear, checkMonth);\n\n        if (booksResult.status === 'ok' && booksResult.data?.books?.length > 0) {\n          const book = booksResult.data.books[0];\n          // Kontrola, zda je kniha uzaven nebo zamen\n          if (book.stav_knihy === 'uzavrena_uzivatelem' || book.stav_knihy === 'zamknuta_spravcem') {\n            closedMonths.push({\n              year: checkYear,\n              month: checkMonth,\n              status: book.stav_knihy,\n              monthName: new Date(checkYear, checkMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })\n            });\n          }\n        }\n\n        // Posun na dal msc\n        checkMonth++;\n        if (checkMonth > 12) {\n          checkMonth = 1;\n          checkYear++;\n        }\n      }\n\n      return {\n        hasClosedFuture: closedMonths.length > 0,\n        closedMonths: closedMonths\n      };\n    } catch (error) {\n      console.error(' Chyba pi kontrole budoucch uzavench msc:', error);\n      return { hasClosedFuture: false, closedMonths: [] };\n    }\n  }, [mainAssignment]);\n\n  //  Kontrola zda pedchoz msc je uzaven (pro warning)\n  const checkPreviousMonthStatus = useCallback(async () => {\n    if (!currentBookId || !mainAssignment?.uzivatel_id) {\n      setShowPreviousMonthWarning(false);\n      return;\n    }\n\n    const userId = mainAssignment.uzivatel_id;\n    const prevMonth = currentMonth === 1 ? 12 : currentMonth - 1;\n    const prevYear = currentMonth === 1 ? currentYear - 1 : currentYear;\n\n    try {\n      const result = await cashbookAPI.listBooks(userId, prevYear, prevMonth);\n\n      if (result.status === 'ok' && result.data?.books?.length > 0) {\n        const prevBook = result.data.books[0];\n\n        // Pokud je pedchoz msc AKTIVN (ne uzaven)  zobrazit warning\n        if (prevBook.stav_knihy === 'aktivni') {\n          setShowPreviousMonthWarning(true);\n        } else {\n          setShowPreviousMonthWarning(false);\n        }\n      } else {\n        // Pedchoz msc neexistuje  dn varovn\n        setShowPreviousMonthWarning(false);\n      }\n    } catch (error) {\n      console.error('Chyba pi kontrole pedchozho msce:', error);\n      setShowPreviousMonthWarning(false);\n    }\n  }, [mainAssignment, currentYear, currentMonth, currentBookId]);\n\n  // useEffect pro kontrolu pedchozho msce\n  useEffect(() => {\n    checkPreviousMonthStatus();\n  }, [checkPreviousMonthStatus]);\n\n  // Navigace na pedchoz msc\n  const goToPreviousMonth = async () => {\n    // Vypotat clov msc\n    let targetMonth = currentMonth - 1;\n    let targetYear = currentYear;\n\n    if (targetMonth < 1) {\n      targetMonth = 12;\n      targetYear--;\n    }\n\n    //  OCHRANA: Kontrola, zda pro clov msc ji kniha EXISTUJE\n    if (mainAssignment?.uzivatel_id) {\n      try {\n        const userId = mainAssignment.uzivatel_id;\n        const targetBooksResult = await cashbookAPI.listBooks(userId, targetYear, targetMonth);\n\n        // Pokud kniha NEEXISTUJE  zkontrolovat uzaven msce v budoucnosti\n        if (!targetBooksResult.data?.books || targetBooksResult.data.books.length === 0) {\n          const { hasClosedFuture, closedMonths } = await checkForClosedFutureMonths(targetYear, targetMonth);\n\n          if (hasClosedFuture) {\n            // Existuj uzaven msce  BLOKOVAT vytvoen nov knihy v minulosti\n            setRetroactiveCreationBlockedDialogOpen(true);\n            return; // ZASTAVIT navigaci\n          }\n        }\n        // Pokud kniha EXISTUJE  povolit navigaci (jen prohlen)\n      } catch (error) {\n        console.error(' Chyba pi kontrole existence knihy:', error);\n        // V ppad chyby povolit navigaci\n      }\n    }\n\n    // Uloit aktuln msc ped pepnutm\n    const dataToSave = {\n      entries: cashBookEntries.map(entry => ({ ...entry, isEditing: false })),\n      carryOverAmount: carryOverAmount,\n      lastModified: new Date().toISOString()\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n\n    // Pepnout msc\n    setCurrentMonth(targetMonth);\n    setCurrentYear(targetYear);\n  };\n\n  // Navigace na nsledujc msc (max do aktulnho msce)\n  const goToNextMonth = () => {\n    const today = new Date();\n    const currentSystemMonth = today.getMonth() + 1;\n    const currentSystemYear = today.getFullYear();\n\n    // Neumonit jt dl ne aktuln msc\n    if (currentYear === currentSystemYear && currentMonth === currentSystemMonth) {\n      showToast('Nelze pejt do budoucnosti', 'warning');\n      return;\n    }\n\n    // Uloit aktuln msc ped pepnutm\n    const dataToSave = {\n      entries: cashBookEntries.map(entry => ({ ...entry, isEditing: false })),\n      carryOverAmount: carryOverAmount,\n      lastModified: new Date().toISOString()\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n\n    // Pepnout msc\n    if (currentMonth === 12) {\n      setCurrentMonth(1);\n      setCurrentYear(prev => prev + 1);\n    } else {\n      setCurrentMonth(prev => prev + 1);\n    }\n  };\n\n  // Pejt na aktuln msc\n  const goToCurrentMonth = () => {\n    // Uloit souasn msc ped pepnutm\n    const dataToSave = {\n      entries: cashBookEntries.map(entry => ({ ...entry, isEditing: false })),\n      carryOverAmount: carryOverAmount,\n      lastModified: new Date().toISOString()\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n\n    const today = new Date();\n    setCurrentMonth(today.getMonth() + 1);\n    setCurrentYear(today.getFullYear());\n  };\n\n  // Pidn novho dku\n  const addNewEntry = () => {\n    const newId = Date.now();\n\n    // Urit sprvn datum: pokud jsme v minulm msci, pout posledn den toho msce\n    const today = new Date();\n    const isCurrentMonth = currentYear === today.getFullYear() && currentMonth === (today.getMonth() + 1);\n\n    let defaultDate;\n    if (isCurrentMonth) {\n      // Aktuln msc - dnen datum\n      defaultDate = getTodayDate();\n    } else {\n      // Minul msc - posledn den toho msce\n      const lastDayOfMonth = new Date(currentYear, currentMonth, 0); // Den 0 = posledn den pedchozho msce\n      const year = lastDayOfMonth.getFullYear();\n      const month = String(lastDayOfMonth.getMonth() + 1).padStart(2, '0');\n      const day = String(lastDayOfMonth.getDate()).padStart(2, '0');\n      defaultDate = `${year}-${month}-${day}`;\n    }\n\n    const newEntry = {\n      id: newId,\n      date: defaultDate,\n      documentNumber: \"\", // Ponechme przdn, vypln se automaticky podle typu\n      description: \"\",\n      person: \"\",\n      income: null,\n      expense: null,\n      balance: totals.currentBalance,\n      lpCode: \"\",\n      note: \"\",\n      isEditing: true,\n      //  MULTI-LP: Poddky s LP kdy\n      detailItems: [], // Pole {popis, castka, lp_kod, lp_popis}\n      hasDetails: false // Flag zda m poddky\n    };\n\n    setCashBookEntries(prev => [...prev, newEntry]);\n\n    //  OPTIMALIZACE: requestAnimationFrame pro focus (browser-friendly)\n    requestAnimationFrame(() => {\n      const descriptionInput = document.querySelector(`input[data-entry-id=\"${newId}\"][data-field=\"description\"]`);\n      if (descriptionInput) {\n        descriptionInput.focus();\n      }\n    });\n\n    return newId;\n  };\n\n  //  CASHBOX SELECTOR: Handler pro zmnu pokladny\n  const handleCashboxChange = useCallback(async (newAssignment) => {\n    if (!newAssignment || newAssignment.id === mainAssignment?.id) {\n      return; // Stejn pokladna, nic nedlat\n    }\n\n    // Nastavit novou pokladnu\n    setMainAssignment(newAssignment);\n\n    //  Uloit vbr pokladny do localStorage (hlavn pro adminy)\n    try {\n      const saveData = {\n        id: newAssignment.id,\n        cislo_pokladny: newAssignment.cislo_pokladny,\n        uzivatel_id: newAssignment.uzivatel_id\n      };\n      localStorage.setItem('cashbook_selector_cashbox', JSON.stringify(saveData));\n    } catch (err) {\n      // Tich chyba - nen kritick\n    }\n\n    // Vymazat aktuln data\n    setCashBookEntries([]);\n    setCurrentBookId(null);\n    setCarryOverAmount(0);\n\n    // Force reload - data se natou automaticky v useEffect kter sleduje mainAssignment\n    showToast(`Pepnuto na pokladnu ${newAssignment.cislo_pokladny} - ${newAssignment.nazev_pracoviste || newAssignment.nazev}`, 'success');\n  }, [mainAssignment, showToast]);\n\n  // Handler pro tlatko \"Pidat nov dek\" - stejn logika jako Shift+Insert\n  const handleAddNewRow = () => {\n    // Najt editovan dek\n    const editingEntry = cashBookEntries.find(entry => entry.isEditing);\n\n    if (editingEntry) {\n      // Kontrola, zda je dek przdn\n      const isEmpty = (\n        !editingEntry.documentNumber &&\n        !editingEntry.description &&\n        !editingEntry.person &&\n        !editingEntry.income &&\n        !editingEntry.expense &&\n        !editingEntry.lpCode &&\n        !editingEntry.note\n      );\n\n      if (isEmpty) {\n        // Przdn dek - jen pesu focus na \"Obsah zpisu\"\n        requestAnimationFrame(() => {\n          const descriptionInput = document.querySelector(`input[data-entry-id=\"${editingEntry.id}\"][data-field=\"description\"]`);\n          if (descriptionInput) {\n            descriptionInput.focus();\n          }\n        });\n      } else {\n        // dek m njak obsah - ulo ho a pidej nov\n\n        //  OPTIMALIZACE: Synchronn update pomoc flushSync\n        ReactDOM.flushSync(() => {\n          // Ukoni editaci vech dk (automaticky se ulo)\n          setCashBookEntries(prev =>\n            prev.map(entry => ({ ...entry, isEditing: false }))\n          );\n        });\n\n        // Okamit ulo a pidej nov dek\n        autoSave();\n        addNewEntry();\n      }\n    } else {\n      // dn dek nen editovn, rovnou pidej nov\n      addNewEntry();\n    }\n  };\n\n  // Odstrann dku - oteve ConfirmDialog\n  const removeEntry = (id) => {\n    setEntryToDelete(id);\n    setDeleteDialogOpen(true);\n  };\n\n  // Potvrzen smazn dku\n  const handleConfirmDelete = async () => {\n    if (entryToDelete) {\n      const entry = cashBookEntries.find(e => e.id === entryToDelete);\n\n      // Odstranit z frontendu\n      setCashBookEntries(prev => prev.filter(entry => entry.id !== entryToDelete));\n\n      // Pokud m DB ID, smazat i z DB\n      if (entry?.db_id) {\n        try {\n          await cashbookAPI.deleteEntry(entry.db_id);\n          showToast('Poloka byla smazna z databze', 'success');\n        } catch (error) {\n          console.error(' Chyba pi mazn z DB:', error);\n          showToast('Chyba pi mazn z databze', 'error');\n        }\n      } else {\n        showToast('Poloka byla odstranna', 'success');\n      }\n\n      // Uloit zmny do localStorage\n      const updatedEntries = cashBookEntries.filter(e => e.id !== entryToDelete);\n      saveToLocalStorage(updatedEntries, bookStatus, carryOverAmount);\n    }\n    setDeleteDialogOpen(false);\n    setEntryToDelete(null);\n  };\n\n  // Zruen smazn dku\n  const handleCancelDelete = () => {\n    setDeleteDialogOpen(false);\n    setEntryToDelete(null);\n  };\n\n  // Zapnut editace dku\n  const startEditing = (id) => {\n    setCashBookEntries(prev =>\n      prev.map(entry =>\n        entry.id === id ? { ...entry, isEditing: true } : entry\n      )\n    );\n  };\n\n  // Ukonen editace dku\n  const stopEditing = async (id) => {\n    const editedEntry = cashBookEntries.find(e => e.id === id);\n    if (!editedEntry) return;\n\n    //  VALIDACE LP KDU: U vdaj je LP kd povinn\n    const hasExpense = editedEntry.expense && editedEntry.expense > 0;\n    const hasDetailItems = editedEntry.detailItems && editedEntry.detailItems.length > 0;\n    \n    if (hasExpense && !hasDetailItems && !editedEntry.lpCode) {\n      showToast(' LP kd je povinn u vdaj! Prosm vyberte LP kd ze seznamu.', 'error');\n      return; // Zabrnit uloen\n    }\n\n    //  VALIDACE LP KDU: U detail poloek mus mt vechny platn LP kd\n    if (hasDetailItems) {\n      const invalidItems = editedEntry.detailItems.filter(item => !item.lp_kod || !lpCodes.some(lp => lp.code === item.lp_kod));\n      if (invalidItems.length > 0) {\n        showToast(' Vechny detail poloky mus mt platn LP kd ze seznamu!', 'error');\n        return; // Zabrnit uloen\n      }\n    }\n\n    //  VALIDACE: Pokud je entry przdn (nem popis), zruit ji msto ukldn\n    const isEmpty = !editedEntry.description?.trim() && \n                    !editedEntry.income && \n                    !editedEntry.expense && \n                    (!editedEntry.detailItems || editedEntry.detailItems.length === 0);\n    \n    if (isEmpty) {\n      // Pokud je to nov zznam (nem db_id), smazat ho\n      if (!editedEntry.db_id) {\n        setCashBookEntries(prev => {\n          const filtered = prev.filter(entry => entry.id !== id);\n          \n          // Uloit zmny do localStorage\n          const dataToSave = {\n            entries: filtered.map(entry => ({ ...entry, isEditing: false })),\n            carryOverAmount: carryOverAmount,\n            lastModified: new Date().toISOString()\n          };\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n          \n          return filtered;\n        });\n        return;\n      } else {\n        // Pokud existuje v DB, jen zruit editaci (obnovit pvodn data)\n        cancelEditing(id);\n        return;\n      }\n    }\n\n    //  VALIDACE: Zkontrolovat, jestli prefix sla dokladu odpovd typu (pjem/vdaj)\n    let documentNumber = editedEntry.documentNumber;\n    const hasIncome = editedEntry.income && editedEntry.income > 0;\n    // hasExpense u je deklarovn ve\n    let typeChanged = false;\n\n    //  Pokud nem slo dokladu a m pjem/vdaj, vygenerovat nov slo\n    if (!documentNumber && (hasIncome || hasExpense)) {\n      const shouldBeP = hasIncome && !hasExpense;\n      const shouldBeV = hasExpense && !hasIncome;\n\n      if (shouldBeP) {\n        // Vygenerovat nov P slo\n        const currentMonthPNumbers = cashBookEntries\n          .filter(e => e.id !== id && e.documentNumber?.startsWith('P'))\n          .map(e => parseInt(e.documentNumber.substring(1)) || 0);\n\n        let nextP;\n        if (currentMonthPNumbers.length > 0) {\n          nextP = Math.max(...currentMonthPNumbers) + 1;\n        } else {\n          const { lastP } = await getLastDocumentNumbersFromPreviousMonth();\n          nextP = lastP + 1;\n        }\n\n        documentNumber = `P${String(nextP).padStart(3, '0')}`;\n        typeChanged = true;\n        console.log(` Nov entry - vygenerovno slo: ${documentNumber}`);\n\n      } else if (shouldBeV) {\n        // Vygenerovat nov V slo\n        const currentMonthVNumbers = cashBookEntries\n          .filter(e => e.id !== id && e.documentNumber?.startsWith('V'))\n          .map(e => parseInt(e.documentNumber.substring(1)) || 0);\n\n        let nextV;\n        if (currentMonthVNumbers.length > 0) {\n          nextV = Math.max(...currentMonthVNumbers) + 1;\n        } else {\n          const { lastV } = await getLastDocumentNumbersFromPreviousMonth();\n          nextV = lastV + 1;\n        }\n\n        documentNumber = `V${String(nextV).padStart(3, '0')}`;\n        typeChanged = true;\n        console.log(` Nov entry - vygenerovno slo: ${documentNumber}`);\n      }\n    }\n\n    // Validace existujcho sla dokladu\n    if (documentNumber && !typeChanged) {\n      const currentPrefix = documentNumber.charAt(0);\n      const shouldBeP = hasIncome && !hasExpense;\n      const shouldBeV = hasExpense && !hasIncome;\n\n      // Pokud je prefix patn, opravit ho\n      if (shouldBeP && currentPrefix !== 'P') {\n        // Zmna z V na P - vygenerovat nov P slo\n        // 1. Najt nejvy P slo v aktulnm msci\n        const currentMonthPNumbers = cashBookEntries\n          .filter(e => e.id !== id && e.documentNumber?.startsWith('P'))\n          .map(e => parseInt(e.documentNumber.substring(1)) || 0);\n\n        let nextP;\n        if (currentMonthPNumbers.length > 0) {\n          // Pokud u mme P doklady v tomto msci, pokrauj od nejvyho\n          nextP = Math.max(...currentMonthPNumbers) + 1;\n        } else {\n          // Pokud jet nemme dn P doklady, nati posledn z pedchozho msce\n          const { lastP } = await getLastDocumentNumbersFromPreviousMonth();\n          nextP = lastP + 1;\n        }\n\n        documentNumber = `P${String(nextP).padStart(3, '0')}`;\n        typeChanged = true;\n        console.log(` Zmna typu: V  P, nov slo: ${documentNumber}`);\n        showToast(`Zmna typu dokladu: vdaj  pjem. Nov slo: ${documentNumber}`, 'info');\n\n      } else if (shouldBeV && currentPrefix !== 'V') {\n        // Zmna z P na V - vygenerovat nov V slo\n        // 1. Najt nejvy V slo v aktulnm msci\n        const currentMonthVNumbers = cashBookEntries\n          .filter(e => e.id !== id && e.documentNumber?.startsWith('V'))\n          .map(e => parseInt(e.documentNumber.substring(1)) || 0);\n\n        let nextV;\n        if (currentMonthVNumbers.length > 0) {\n          // Pokud u mme V doklady v tomto msci, pokrauj od nejvyho\n          nextV = Math.max(...currentMonthVNumbers) + 1;\n        } else {\n          // Pokud jet nemme dn V doklady, nati posledn z pedchozho msce\n          const { lastV } = await getLastDocumentNumbersFromPreviousMonth();\n          nextV = lastV + 1;\n        }\n\n        documentNumber = `V${String(nextV).padStart(3, '0')}`;\n        typeChanged = true;\n        console.log(` Zmna typu: P  V, nov slo: ${documentNumber}`);\n        showToast(`Zmna typu dokladu: pjem  vdaj. Nov slo: ${documentNumber}`, 'info');\n      }\n    }\n\n    // Oznait entry jako zmnnou\n    const updatedEntry = {\n      ...editedEntry,\n      documentNumber, // Pout opraven slo dokladu\n      isEditing: false,\n      changed: true,\n      sync_status: 'pending',\n      last_modified_local: new Date().toISOString()\n    };\n\n    setCashBookEntries(prev => {\n      const updatedEntries = prev.map(entry =>\n        entry.id === id ? updatedEntry : entry\n      );\n\n      //  Uloit zmny do localStorage ihned (backup)\n      saveToLocalStorage(updatedEntries, bookStatus, carryOverAmount);\n\n      return updatedEntries;\n    });\n\n    setLastSavedEntryId(id);\n\n    setTimeout(() => {\n      setLastSavedEntryId(null);\n    }, 5000);\n\n    //  Sync do DB na pozad\n    if (currentBookId) {\n      try {\n        const payload = transformFrontendEntryToDB(updatedEntry, currentBookId);\n\n        if (updatedEntry.db_id) {\n          // Update existujc entry\n          const updateResult = await cashbookAPI.updateEntry(updatedEntry.db_id, payload);\n\n          //  Pokud se zmnil typ (typeChanged), pout slo z frontendu, ne z backendu\n          if (updateResult.status === 'ok') {\n            setCashBookEntries(prev => prev.map(e =>\n              e.id === id ? {\n                ...e,\n                // Pokud byl zmnn typ, pout nov slo z frontendu, jinak pout slo z backendu\n                documentNumber: typeChanged ? documentNumber : (updateResult.data?.entry?.cislo_dokladu || e.documentNumber),\n                sync_status: 'synced',\n                changed: false,\n                last_synced_at: new Date().toISOString()\n              } : e\n            ));\n          }\n        } else {\n          // Create novou entry\n          const result = await cashbookAPI.createEntry(payload);\n\n          if (result.status === 'ok' && result.data?.entry) {\n            // Aktualizovat s DB ID a slem dokladu\n            //  Pokud jsme vygenerovali slo na frontendu (typeChanged), pout to, jinak slo z backendu\n            setCashBookEntries(prev => prev.map(e =>\n              e.id === id ? {\n                ...e,\n                db_id: result.data.entry.id,\n                documentNumber: typeChanged ? documentNumber : (result.data.entry.cislo_dokladu || documentNumber),\n                sync_status: 'synced',\n                changed: false,\n                last_synced_at: new Date().toISOString()\n              } : e\n            ));\n          }\n        }\n\n        // Update totals v DB\n        const totalIncome = cashBookEntries.reduce((sum, e) => sum + (e.income || 0), 0);\n        const totalExpenses = cashBookEntries.reduce((sum, e) => sum + (e.expense || 0), 0);\n        const endBalance = carryOverAmount + totalIncome - totalExpenses;\n\n        await cashbookAPI.updateBook(currentBookId, {\n          celkove_prijmy: totalIncome,\n          celkove_vydaje: totalExpenses,\n          koncovy_stav: endBalance\n        });\n\n      } catch (error) {\n        console.error(' Chyba pi ukldn do DB:', error);\n        showToast('Uloeno lokln, sync do DB selhala: ' + error.message, 'warning');\n\n        // Oznait jako error\n        setCashBookEntries(prev => prev.map(e =>\n          e.id === id ? { ...e, sync_status: 'error' } : e\n        ));\n      }\n    }\n  };\n\n  // Zruen editace dku bez uloen (ESC)\n  const cancelEditing = (id) => {\n    const originalEntry = cashBookEntries.find(entry => entry.id === id);\n\n    // Pokud je to nov dek (jet neuloen), pln ho smaeme\n    if (originalEntry && !originalEntry.description && !originalEntry.documentNumber) {\n      setCashBookEntries(prev => {\n        const filtered = prev.filter(entry => entry.id !== id);\n\n        // Uloit zmny do localStorage ihned po smazn\n        const dataToSave = {\n          entries: filtered.map(entry => ({ ...entry, isEditing: false })),\n          carryOverAmount: carryOverAmount,\n          lastModified: new Date().toISOString()\n        };\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n\n        return filtered;\n      });\n    } else {\n      // Jinak jen ukonme editaci\n      setCashBookEntries(prev =>\n        prev.map(entry =>\n          entry.id === id ? { ...entry, isEditing: false } : entry\n        )\n      );\n    }\n  };\n\n  // Handler pro Shift+Enter (uloit) a ESC (zruit)\n  const handleKeyDown = (e, entryId) => {\n    if (e.key === 'Enter' && e.shiftKey) {\n      e.preventDefault();\n      stopEditing(entryId);\n    } else if (e.key === 'Escape') {\n      e.preventDefault();\n      cancelEditing(entryId);\n    }\n  };\n\n  // Aktualizace hodnoty v dku s validacemi\n  const updateEntry = (id, field, value) => {\n    setCashBookEntries(prev => {\n      const newEntries = prev.map(entry => {\n        if (entry.id !== id) return entry;\n\n        let processedValue = value;\n\n        // Validace pro rzn typy pol\n        if (field === 'income' || field === 'expense') {\n          // Zajistit, e druh pole je przdn\n          // slo dokladu se pepot automaticky v derived state\n          const updatedEntry = { ...entry, [field]: processedValue };\n          if (field === 'income') {\n            updatedEntry.expense = null;\n          } else {\n            updatedEntry.income = null;\n          }\n          return updatedEntry;\n        }\n\n        // Validace data\n        if (field === 'date') {\n          const today = new Date();\n          const entryDate = new Date(value);\n\n          // Varovn pokud je datum v budoucnosti\n          if (entryDate > today) {\n            showToast('Pozor: Datum je v budoucnosti', 'warning');\n          }\n        }\n\n        // Poznmka: slo dokladu se negeneruje manuln - je automatick\n\n        return { ...entry, [field]: processedValue };\n      });\n\n      // Pepotn zstatk pro vechny zznamy\n      if (field === 'income' || field === 'expense') {\n        let runningBalance = initialBalance;\n        return newEntries.map(entry => {\n          if (entry.income) runningBalance += entry.income;\n          if (entry.expense) runningBalance -= entry.expense;\n          return { ...entry, balance: runningBalance };\n        });\n      }\n\n      return newEntries;\n    });\n  };\n\n  // Auto-save do localStorage bez ukonen editace (pro onBlur)\n  const autoSave = () => {\n    try {\n      const dataToSave = {\n        entries: cashBookEntries,\n        carryOverAmount: carryOverAmount,\n        lastModified: new Date().toISOString()\n      };\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\n    } catch (error) {\n      console.error('Chyba pi auto-ukldn do localStorage:', error);\n    }\n  };\n\n  // Export do rznch formt\n  const exportData = (format) => {\n    try {\n      const filename = `Pokladni_kniha_${organizationInfo.workplace}_${organizationInfo.month}_${organizationInfo.year}`;\n\n      if (format === 'CSV') {\n        exportToCSV(filename);\n      } else if (format === 'PDF') {\n        generatePDFReport(filename);\n      }\n    } catch (error) {\n      showToast('Chyba pi exportu dat', 'error');\n    }\n  };\n\n  // Export do CSV\n  const exportToCSV = (filename) => {\n    // Hlavika tabulky\n    const headers = [\n      'dek', 'Datum', 'slo dokladu', 'Obsah zpisu', 'Komu/Od koho',\n      'Pjmy (K)', 'Vdaje (K)', 'Zstatek (K)', 'LP kd', 'Poznmka'\n    ];\n\n    // Data dk\n    const rows = cashBookEntries.map((entry, index) => [\n      index + 1,\n      formatDate(entry.date),\n      entry.documentNumber || '',\n      `\"${(entry.description || '').replace(/\"/g, '\"\"')}\"`, // Escapovn uvozovek\n      `\"${(entry.person || '').replace(/\"/g, '\"\"')}\"`,\n      entry.income ? entry.income.toFixed(2) : '',\n      entry.expense ? entry.expense.toFixed(2) : '',\n      entry.balance.toFixed(2),\n      entry.lpCode || '',\n      `\"${(entry.note || '').replace(/\"/g, '\"\"')}\"`\n    ]);\n\n    // Sestaven CSV obsahu (hlavika + dky)\n    const csvContent = [\n      headers.join(';'),\n      ...rows.map(row => row.join(';'))\n    ].join('\\n');\n\n    // BOM pro sprvn zobrazen etiny v Excelu\n    const BOM = '\\uFEFF';\n    const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });\n\n    // Staen souboru\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = `${filename}.csv`;\n    link.click();\n    URL.revokeObjectURL(link.href);\n\n    showToast('CSV soubor byl exportovn', 'success');\n  };\n\n  // Generovn PDF reportu\n  const generatePDFReport = async (filename) => {\n    try {\n      // Pprava informac o genertorovi PDF\n      const generatedBy = {\n        fullName: `${userDetail?.titul_pred || ''} ${userDetail?.jmeno || ''} ${userDetail?.prijmeni || ''} ${userDetail?.titul_za || ''}`.trim(),\n        usekZkr: userDetail?.usek_zkr?.[0] || '',\n        lokalita: getUserLocation(),\n      };\n\n      // Vytvoen PDF dokumentu pomoc @react-pdf/renderer\n      const blob = await pdf(\n        <PokladniKnihaPDF\n          organizationInfo={{\n            organizationName: organizationInfo.organizationName,\n            workplace: getUserLocation(),\n            cashboxNumber: organizationInfo.cashboxNumber,\n            month: organizationInfo.month,\n            year: organizationInfo.year,\n          }}\n          carryOverAmount={carryOverAmount}\n          totals={totals}\n          entries={cashBookEntries}\n          generatedBy={generatedBy}\n          bookStatus={{\n            status: bookStatus,\n            closedDate: bookStatusMetadata?.closedDate,\n            closedBy: bookStatusMetadata?.closedBy,\n            lockedDate: bookStatusMetadata?.lockedDate,\n            lockedBy: bookStatusMetadata?.lockedBy,\n          }}\n        />\n      ).toBlob();\n\n      // Vytvoen URL pro blob a staen\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `${filename}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n\n      showToast('PDF report byl spn vygenerovn', 'success');\n    } catch (error) {\n      console.error('Chyba pi generovn PDF:', error);\n      showToast('Chyba pi generovn PDF reportu', 'error');\n    }\n  };\n\n  // Tisk pomoc PDF (oteve PDF v novm okn pro tisk)\n  const printPDFReport = async () => {\n    try {\n      // Pprava informac o genertorovi PDF\n      const generatedBy = {\n        fullName: `${userDetail?.titul_pred || ''} ${userDetail?.jmeno || ''} ${userDetail?.prijmeni || ''} ${userDetail?.titul_za || ''}`.trim(),\n        usekZkr: userDetail?.usek_zkr?.[0] || '',\n        lokalita: getUserLocation(),\n      };\n\n      // Vytvoen PDF dokumentu pomoc @react-pdf/renderer\n      const blob = await pdf(\n        <PokladniKnihaPDF\n          organizationInfo={{\n            organizationName: organizationInfo.organizationName,\n            workplace: getUserLocation(),\n            cashboxNumber: organizationInfo.cashboxNumber,\n            month: organizationInfo.month,\n            year: organizationInfo.year,\n          }}\n          carryOverAmount={carryOverAmount}\n          totals={totals}\n          entries={cashBookEntries}\n          generatedBy={generatedBy}\n          bookStatus={{\n            status: bookStatus,\n            closedDate: bookStatusMetadata?.closedDate,\n            closedBy: bookStatusMetadata?.closedBy,\n            lockedDate: bookStatusMetadata?.lockedDate,\n            lockedBy: bookStatusMetadata?.lockedBy,\n          }}\n        />\n      ).toBlob();\n\n      // Vytvoen URL pro blob a oteven v novm okn pro tisk\n      const url = URL.createObjectURL(blob);\n      const printWindow = window.open(url, '_blank');\n\n      if (printWindow) {\n        // Pokat ne se PDF nate a otevt tiskov dialog\n        printWindow.onload = () => {\n          printWindow.print();\n          // URL se uvoln a po zaven okna\n          printWindow.onafterprint = () => {\n            URL.revokeObjectURL(url);\n          };\n        };\n      } else {\n        // Pokud se nepodailo otevt okno, uvolni URL\n        URL.revokeObjectURL(url);\n        showToast('Nepodailo se otevt tiskov dialog. Zkontrolujte blokovn vyskakovacch oken.', 'error');\n      }\n    } catch (error) {\n      console.error('Chyba pi tisku PDF:', error);\n      showToast('Chyba pi pprav tisku', 'error');\n    }\n  };\n\n  // ============================================================================\n  // HIERARCHIE OPRVNN PRO POKLADN KNIHU\n  // ============================================================================\n  //\n  // Hierarchie (sestupn):\n  // 1. SUPERADMIN/ADMINISTRATOR  me ve\n  // 2. CASH_BOOK_MANAGE  kompletn sprva vech pokladnch knih\n  // 3. *_ALL oprvnn  pstup ke vem pokladnm knihm\n  // 4. *_OWN oprvnn  pstup pouze ke vlastn pokladn knize\n  //\n  // Vlastnictv pokladn knihy = cel kniha za msc jednoho uivatele\n  // ============================================================================\n\n  // 1. Kontrola superadmin/admin role\n  const isSuperAdmin = userDetail?.roles?.some(r =>\n    r.kod_role === 'SUPERADMIN' || r.kod_role === 'ADMINISTRATOR'\n  );\n\n  // 2. Kontrola MANAGE oprvnn (me ve)\n  const hasManagePermission = hasPermission && hasPermission('CASH_BOOK_MANAGE');\n\n  // 3. Kontrola _ALL oprvnn (vechny pokladn knihy)\n  const canReadAll = hasPermission && hasPermission('CASH_BOOK_READ_ALL');\n  const canEditAll = hasPermission && hasPermission('CASH_BOOK_EDIT_ALL');\n  const canDeleteAll = hasPermission && hasPermission('CASH_BOOK_DELETE_ALL');\n  const canExportAll = hasPermission && hasPermission('CASH_BOOK_EXPORT_ALL');\n\n  // 4. Kontrola _OWN oprvnn (pouze vlastn pokladna)\n  const canReadOwn = hasPermission && hasPermission('CASH_BOOK_READ_OWN');\n  const canEditOwn = hasPermission && hasPermission('CASH_BOOK_EDIT_OWN');\n  const canDeleteOwn = hasPermission && hasPermission('CASH_BOOK_DELETE_OWN');\n  const canExportOwn = hasPermission && hasPermission('CASH_BOOK_EXPORT_OWN');\n\n  // 5. Kontrola CREATE oprvnn (spolen pro vlastn i vechny)\n  const canCreate = hasPermission && hasPermission('CASH_BOOK_CREATE');\n\n  // 6. Zjistit, jestli aktuln zobrazen pokladna pat pihlenmu uivateli\n  // UPRAVENO: Kontroluje nejen vlastnka, ale i piazen jako zstupce\n  const isCurrentUserCashbook = useMemo(() => {\n    if (!mainAssignment || !userDetail) return false;\n\n    // Kontrola 1: Je uivatel vlastnkem tto pokladny?\n    const isOwner = String(mainAssignment.uzivatel_id) === String(userDetail.id);\n\n    // Kontrola 2: Je uivatel piazen k tto pokladn (hlavn nebo zstupce)?\n    const isAssignedToThisCashbox = userAssignments?.some(assignment => {\n      return String(assignment.pokladna_id) === String(mainAssignment.pokladna_id) &&\n             String(assignment.uzivatel_id) === String(userDetail.id);\n    });\n\n    return isOwner || isAssignedToThisCashbox;\n  }, [mainAssignment, userDetail, userAssignments]);\n\n  //  CENTRLN FUNKCE PRO KONTROLU EDITOVATELNOSTI\n  // d VE - stav knihy (uzaven/zamen) + oprvnn\n  const isBookEditable = useMemo(() => {\n    // 1. Kontrola stavu knihy - uzaven nebo zamen\n    const isLocked = bookStatus === 'uzavrena_uzivatelem' || bookStatus === 'zamknuta_spravcem';\n\n    // 2.  ZAMEN/UZAVEN KNIHA  NIKDO NEME EDITOVAT!\n    //    Admin/MANAGE me jen ODEMKNOUT, ale dokud je zamen, NESM editovat poloky!\n    if (isLocked) {\n      return false;\n    }\n\n    // 3. Kniha je AKTIVN  kontrola bnch oprvnn\n    // Me editovat: SuperAdmin, MANAGE, EDIT_ALL, nebo (EDIT_OWN + vlastn pokladna)\n    return isSuperAdmin ||\n           hasManagePermission ||\n           canEditAll ||\n           (canEditOwn && isCurrentUserCashbook);\n  }, [bookStatus, isSuperAdmin, hasManagePermission, canEditAll, canEditOwn, isCurrentUserCashbook]);\n\n  //  Odvozen hodnoty z centrln funkce\n  const canViewCashBook = isSuperAdmin || hasManagePermission || canReadAll || (canReadOwn && isCurrentUserCashbook);\n  const canActuallyEdit = isBookEditable;\n  const canActuallyDelete = isBookEditable; // Stejn logika jako edit\n  const canActuallyCreate = isBookEditable; // Stejn logika jako edit\n  const canExportCashBook = isSuperAdmin || hasManagePermission || canExportAll || (canExportOwn && isCurrentUserCashbook);\n\n  // Pro kompatibilitu - budget oprvnn zstv\n  const canEditBudget = hasPermission && hasPermission('BUDGET_MANAGE');\n\n  //  Helper: Kontrola, zda lze msc uzavt/zamknout (mus bt ukonen)\n  // Nap. listopad 2025 lze uzavt a 1.12.2025\n  const canCloseCurrentPeriod = useMemo(() => {\n    const today = new Date();\n    const todayYear = today.getFullYear();\n    const todayMonth = today.getMonth() + 1; // 1-12\n\n    // Pokud je zobrazen msc v minulosti, lze uzavt\n    if (currentYear < todayYear) return true;\n    if (currentYear === todayYear && currentMonth < todayMonth) return true;\n\n    // Pokud je zobrazen msc aktuln nebo budouc, NELZE uzavt\n    return false;\n  }, [currentYear, currentMonth]);\n\n  //  KROK 3: Funkce pro workflow uzavrn - OTEVE DIALOG\n  const handleCloseMonth = () => {\n    if (!hasManagePermission && !(canEditOwn && isCurrentUserCashbook)) {\n      showToast('Nemte oprvnn uzavt tento msc', 'error');\n      return;\n    }\n\n    if (!canCloseCurrentPeriod) {\n      showToast('Nelze uzavt aktuln msc. Uzavt lze a od 1. dne nsledujcho msce.', 'warning');\n      return;\n    }\n\n    if (!currentBookId) {\n      showToast('Chyba: Kniha nen natena', 'error');\n      return;\n    }\n\n    // Otevt confirm dialog\n    setCloseMonthDialogOpen(true);\n  };\n\n  //  Peslovn vech entries v aktulnm a nsledujcch mscch\n  const renumberAllFutureMonths = async () => {\n    if (!mainAssignment?.uzivatel_id) return;\n\n    try {\n      // Zskat vechny knihy od aktulnho msce do budoucnosti\n      const allBooksResult = await cashbookAPI.listBooks(mainAssignment.uzivatel_id);\n\n      if (allBooksResult.status !== 'ok') {\n        throw new Error('Backend vrtil chybu: ' + (allBooksResult.message || 'neznm'));\n      }\n\n      // Backend me vracet rzn struktury - zkusme najt pole knih\n      let booksArray = null;\n\n      if (Array.isArray(allBooksResult.data)) {\n        booksArray = allBooksResult.data;\n      } else if (allBooksResult.data?.books && Array.isArray(allBooksResult.data.books)) {\n        booksArray = allBooksResult.data.books;\n      } else if (allBooksResult.books && Array.isArray(allBooksResult.books)) {\n        booksArray = allBooksResult.books;\n      }\n\n      if (!booksArray) {\n        console.error(' Nepodailo se najt pole knih v odpovdi:', allBooksResult);\n        throw new Error('Backend nevrtil pole knih');\n      }\n\n      // Filtrovat knihy >= aktuln msc a seadit chronologicky\n      const futureBooks = booksArray.filter(book => {\n        const bookDate = new Date(book.rok, book.mesic - 1);\n        const currentDate = new Date(currentYear, currentMonth - 1);\n        return bookDate >= currentDate;\n      }).sort((a, b) => {\n        if (a.rok !== b.rok) return a.rok - b.rok;\n        return a.mesic - b.mesic;\n      });\n\n      //  Nejprve zjistit posledn P/V sla z PEDCHOZHO msce (ped aktulnm)\n      const { lastP: prevLastP, lastV: prevLastV } = await getLastDocumentNumbersFromPreviousMonth();\n      let lastP = prevLastP;\n      let lastV = prevLastV;\n\n      // Projt vechny knihy chronologicky\n      for (const book of futureBooks) {\n\n        // Nast vechny entries pro tuto knihu pomoc getBook()\n        const bookResult = await cashbookAPI.getBook(book.id, false); // force_recalc = false\n\n        if (bookResult.status !== 'ok' || !bookResult.data?.entries) {\n          console.warn(` Nepodailo se nast entries pro knihu ${book.id}`);\n          continue;\n        }\n\n        const entries = bookResult.data.entries;\n\n        // Seadit entries podle data\n        const sortedEntries = [...entries].sort((a, b) => {\n          const dateA = new Date(a.datum_zapisu);\n          const dateB = new Date(b.datum_zapisu);\n          return dateA - dateB;\n        });\n\n        // Peslovat entries\n        for (const entry of sortedEntries) {\n          const hasIncome = entry.castka_prijem && parseFloat(entry.castka_prijem) > 0;\n          const hasExpense = entry.castka_vydaj && parseFloat(entry.castka_vydaj) > 0;\n\n          let newNumber = null;\n\n          if (hasIncome && !hasExpense) {\n            // Pjem - pout P\n            lastP++;\n            newNumber = `P${String(lastP).padStart(3, '0')}`;\n          } else if (hasExpense && !hasIncome) {\n            // Vdaj - pout V\n            lastV++;\n            newNumber = `V${String(lastV).padStart(3, '0')}`;\n          }\n\n          // Pokud se slo zmnilo, aktualizovat v DB\n          if (newNumber && newNumber !== entry.cislo_dokladu) {\n            console.log(`   ${entry.cislo_dokladu}  ${newNumber}`);\n            //  FIX: RAW data z API maj 'id', ne 'db_id'\n            await cashbookAPI.updateEntry(entry.id, {\n              cislo_dokladu: newNumber\n            });\n          }\n        }\n      }\n\n      return { success: true, lastP, lastV };\n\n    } catch (error) {\n      console.error(' Chyba pi peslovn:', error);\n      return { success: false, error: error.message };\n    }\n  };\n\n  //  Potvrzen uzaven msce (volno z dialogu)\n  const confirmCloseMonth = async () => {\n    setCloseMonthDialogOpen(false);\n\n    try {\n      //  KROK 0: Zkontrolovat aktuln stav knihy ped operac\n      const bookCheckResult = await cashbookAPI.getBook(currentBookId, false);\n      if (bookCheckResult.status === 'ok' && bookCheckResult.data?.stav_knihy) {\n        const currentState = bookCheckResult.data.stav_knihy;\n        \n        if (currentState !== 'aktivni') {\n          // Kniha u je uzaven - synchronizovat stav ve frontendu\n          setBookStatus(currentState);\n          showToast(`Kniha je ji ve stavu: ${currentState}`, 'warning');\n          return;\n        }\n      }\n\n      //  KROK 1: Nejprve peslovat vechny knihy od aktuln do budoucna\n      showToast('Probh peslovn doklad...', 'info');\n      const renumberResult = await renumberAllFutureMonths();\n\n      if (!renumberResult.success) {\n        throw new Error(`Chyba pi peslovn: ${renumberResult.error}`);\n      }\n\n      showToast(`Peslovn dokoneno (P: ${renumberResult.lastP}, V: ${renumberResult.lastV})`, 'success');\n\n      //  KROK 2: Znovu nast aktuln msc, aby se zobrazily nov slovn\n      const reloadResult = await cashbookAPI.getBook(currentBookId, false);\n      if (reloadResult.status === 'ok' && reloadResult.data?.entries) {\n        const transformedEntries = reloadResult.data.entries.map(transformDBEntryToFrontend);\n        setCashBookEntries(transformedEntries);\n      }\n\n      //  KROK 3: Uzavt msc\n      const result = await cashbookAPI.closeMonth(currentBookId);\n\n      if (result.status === 'ok') {\n        setBookStatus('uzavrena_uzivatelem');\n        showToast('Msc byl spn uzaven', 'success');\n\n        // Synchronizovat do localStorage\n        saveToLocalStorage(cashBookEntries, 'uzavrena_uzivatelem', carryOverAmount);\n      } else {\n        throw new Error(result.message || 'Neznm chyba');\n      }\n    } catch (error) {\n      console.error(' Chyba pi uzavrn msce:', error);\n      showToast('Chyba pi uzavrn msce: ' + error.message, 'error');\n      \n      //  Po chyb znovu nast stav knihy z DB\n      try {\n        const bookCheckResult = await cashbookAPI.getBook(currentBookId, false);\n        if (bookCheckResult.status === 'ok' && bookCheckResult.data?.stav_knihy) {\n          setBookStatus(bookCheckResult.data.stav_knihy);\n        }\n      } catch (recheckError) {\n        console.error('Nepodailo se znovu nast stav knihy:', recheckError);\n      }\n    }\n  };\n\n  const handleLockBook = () => {\n    if (!hasManagePermission) {\n      showToast('Nemte oprvnn zamknout knihu', 'error');\n      return;\n    }\n\n    if (!canCloseCurrentPeriod) {\n      showToast('Nelze zamknout aktuln msc. Zamknout lze a od 1. dne nsledujcho msce.', 'warning');\n      return;\n    }\n\n    if (!currentBookId) {\n      showToast('Chyba: Kniha nen natena', 'error');\n      return;\n    }\n\n    // Otevt confirm dialog\n    setLockBookDialogOpen(true);\n  };\n\n  //  Potvrzen zamknut msce (volno z dialogu)\n  const confirmLockBook = async () => {\n    setLockBookDialogOpen(false);\n\n    try {\n      //  Volat skuten API\n      const result = await cashbookAPI.lockBook(currentBookId);\n\n      if (result.status === 'ok') {\n        setBookStatus('zamknuta_spravcem');\n        showToast('Kniha byla zamena sprvcem', 'success');\n\n        // Synchronizovat do localStorage\n        saveToLocalStorage(cashBookEntries, 'zamknuta_spravcem', carryOverAmount);\n      } else {\n        throw new Error(result.message || 'Neznm chyba');\n      }\n    } catch (error) {\n      console.error(' Chyba pi zamykn knihy:', error);\n      showToast('Chyba pi zamykn knihy: ' + error.message, 'error');\n    }\n  };\n\n  const handleUnlockBook = () => {\n    //  Admin s MANAGE me odemknout cokoli (uzavrena_uzivatelem i zamknuta_spravcem)\n    //  Bn uivatel s EDIT_OWN me odemknout jen svou vlastn uzavrena_uzivatelem knihu\n    //  Bn uivatel NEME odemknout zamknuta_spravcem (ani svou)\n\n    if (bookStatus === 'zamknuta_spravcem' && !hasManagePermission) {\n      showToast('Kniha je zamen sprvcem. Kontaktujte administrtora.', 'error');\n      return;\n    }\n\n    if (bookStatus === 'uzavrena_uzivatelem' && !hasManagePermission && !(canEditOwn && isCurrentUserCashbook)) {\n      showToast('Nemte oprvnn odemknout tento msc', 'error');\n      return;\n    }\n\n    if (!currentBookId) {\n      showToast('Chyba: Kniha nen natena', 'error');\n      return;\n    }\n\n    // Otevt pslun dialog podle stavu knihy\n    if (bookStatus === 'zamknuta_spravcem') {\n      setUnlockBookDialogOpen(true);\n    } else if (bookStatus === 'uzavrena_uzivatelem') {\n      setReopenMonthDialogOpen(true);\n    }\n  };\n\n  //  Confirm handler pro oteven msce (uzavrena_uzivatelem)\n  const confirmReopenMonth = async () => {\n    setReopenMonthDialogOpen(false);\n\n    try {\n      const result = await cashbookAPI.reopenBook(currentBookId);\n\n      if (result.status === 'ok') {\n        setBookStatus('aktivni');\n        showToast('Msc byl znovu oteven', 'success');\n        saveToLocalStorage(cashBookEntries, 'aktivni', carryOverAmount);\n      } else {\n        throw new Error(result.message || 'Neznm chyba');\n      }\n    } catch (error) {\n      console.error(' Chyba pi otevrn msce:', error);\n      showToast('Chyba pi otevrn msce: ' + error.message, 'error');\n    }\n  };\n\n  //  Confirm handler pro odemknut zamenho msce (zamknuta_spravcem)\n  const confirmUnlockBook = async () => {\n    setUnlockBookDialogOpen(false);\n\n    try {\n      const result = await cashbookAPI.reopenBook(currentBookId);\n\n      if (result.status === 'ok') {\n        setBookStatus('aktivni');\n        showToast('Msc byl odemen administrtorem', 'success');\n        saveToLocalStorage(cashBookEntries, 'aktivni', carryOverAmount);\n      } else {\n        throw new Error(result.message || 'Neznm chyba');\n      }\n    } catch (error) {\n      console.error(' Chyba pi odemykn msce:', error);\n      showToast('Chyba pi odemykn msce: ' + error.message, 'error');\n    }\n  };\n\n  // Globln handler pro Shift+Insert (mus bt a po definici canActuallyCreate)\n  useEffect(() => {\n    const handleGlobalKeyDown = async (e) => {\n      if (e.shiftKey && e.key === 'Insert' && canActuallyCreate) {\n        e.preventDefault();\n\n        // Najt editovan dek\n        const editingEntry = cashBookEntries.find(entry => entry.isEditing);\n\n        if (editingEntry) {\n          //  NOV: Ulo aktuln dek do DB (stejn jako Shift+Enter)\n          await stopEditing(editingEntry.id);\n\n          //  OPTIMALIZACE: Okamit pidej nov dek\n          addNewEntry();\n\n          // Focus na prvn pole novho dku pomoc RAF\n          requestAnimationFrame(() => {\n            const firstInput = document.querySelector('.entry-row:last-child input');\n            if (firstInput) {\n              firstInput.focus();\n            }\n          });\n        } else {\n          // dn dek nen editovn, rovnou pidej nov\n          addNewEntry();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleGlobalKeyDown);\n    return () => {\n      document.removeEventListener('keydown', handleGlobalKeyDown);\n    };\n  }, [canActuallyCreate, totals.currentBalance, cashBookEntries, autoSave, addNewEntry]);\n\n  //  CASHBOOK V2: Loading state pi natn piazen\n  //  DLEIT: Kontrola oprvnn MUS bt a PO naten piazen!\n  if (assignmentLoading) {\n    return (\n      <PageContainer>\n        <Header>\n          <h1>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladn kniha\n          </h1>\n          <p className=\"subtitle\">Natn...</p>\n        </Header>\n        <InfoPanel>\n          <div style={{ textAlign: 'center', padding: '2rem' }}>\n            <FontAwesomeIcon icon={faCalculator} size=\"3x\" style={{ color: '#3b82f6', marginBottom: '1rem' }} className=\"fa-spin\" />\n            <h3>Natn piazen pokladny...</h3>\n            <p>Prosm vykejte</p>\n          </div>\n        </InfoPanel>\n      </PageContainer>\n    );\n  }\n\n  //  CASHBOOK V2: Varovn pokud uivatel nem piazenou pokladnu\n  if (!mainAssignment) {\n    return (\n      <PageContainer>\n        <Header>\n          <h1>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladn kniha\n          </h1>\n          <p className=\"subtitle\">Chyba konfigurace</p>\n        </Header>\n        <InfoPanel>\n          <div style={{ textAlign: 'center', padding: '2rem' }}>\n            <FontAwesomeIcon icon={faInfoCircle} size=\"3x\" style={{ color: '#f59e0b', marginBottom: '1rem' }} />\n            <h3>Nemte piazenou pokladnu</h3>\n            <p>Pro prci s pokladn knihou muste mt piazenou alespo jednu pokladnu.</p>\n            <p>Kontaktujte administrtora systmu pro piazen pokladny.</p>\n          </div>\n        </InfoPanel>\n      </PageContainer>\n    );\n  }\n\n  //  Pokud nem oprvnn, zobraz varovn (kontrola a po naten piazen!)\n  if (!canViewCashBook) {\n    return (\n      <PageContainer>\n        <Header>\n          <h1>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladn kniha\n          </h1>\n          <p className=\"subtitle\">Pstup odepen</p>\n        </Header>\n        <InfoPanel>\n          <div style={{ textAlign: 'center', padding: '2rem' }}>\n            <FontAwesomeIcon icon={faInfoCircle} size=\"3x\" style={{ color: '#dc2626', marginBottom: '1rem' }} />\n            <h3>Nedostaten oprvnn</h3>\n            <p>Pro pstup k pokladn knize potebujete oprvnn CASH_BOOK_READ_OWN nebo vy.</p>\n            <p>Kontaktujte sprvce systmu pro udlen potebnch oprvnn.</p>\n          </div>\n        </InfoPanel>\n      </PageContainer>\n    );\n  }\n\n  return (\n    <>\n      <Global styles={printStyles} />\n      <PageContainer>\n        <Header className=\"no-print\">\n          <h1>\n            <FontAwesomeIcon icon={faCalculator} />\n            Pokladn kniha\n          </h1>\n          <p className=\"subtitle\">\n            {(() => {\n              //  Zskat informace o vlastnkovi pokladny z book objektu (currentBookData)\n              // Backend vrac ve z JOIN: uzivatel_jmeno_plne, lokalita_nazev, usek_nazev\n              const userName = currentBookData?.uzivatel_jmeno_plne ||\n                              currentBookData?.uzivatel_cele_jmeno ||\n                              mainAssignment?.uzivatel_cele_jmeno ||\n                              (mainAssignment?.uzivatel_jmeno && mainAssignment?.uzivatel_prijmeni\n                                ? `${mainAssignment.uzivatel_jmeno} ${mainAssignment.uzivatel_prijmeni}`\n                                : null);\n              const lokalita = currentBookData?.lokalita_nazev || mainAssignment?.lokalita_nazev || mainAssignment?.lokalita_kod;\n              const usek = currentBookData?.usek_nazev || mainAssignment?.usek_nazev;\n              const cashboxNum = organizationInfo.cashboxNumber;\n              const vpd = organizationInfo.cashboxVpd;\n              const ppd = organizationInfo.cashboxPpd;\n\n              return (\n                <>\n                  {userName ? `${userName} | ` : ''}\n                  {lokalita && `${lokalita} | `}\n                  {usek && `${usek} | `}\n                  Pokladna . {cashboxNum}\n                  {vpd && ppd && ` | VPD: ${vpd} | PPD: ${ppd}`}\n                </>\n              );\n            })()}\n          </p>\n        </Header>\n\n        {/*  CASHBOX SELECTOR - Pepnn mezi pokladnami (jen pro uivatele s _ALL oprvnnmi) */}\n        {canSeeAllCashboxes && !assignmentLoading && (\n          <div className=\"no-print\" style={{ marginBottom: '1rem' }}>\n            <CashboxSelector\n              currentCashbox={mainAssignment}\n              userCashboxes={userAssignments}\n              allCashboxes={allAssignments}\n              permissions={cashbookPermissions}\n              canSeeAllCashboxes={canSeeAllCashboxes}\n              onCashboxChange={handleCashboxChange}\n              currentYear={currentYear}\n              currentMonth={currentMonth}\n              onPeriodChange={(year, month) => {\n                setCurrentYear(year);\n                setCurrentMonth(month);\n              }}\n            />\n          </div>\n        )}\n\n        {/*  Sticky kompaktn pehled pi scrollovn */}\n        <StickyCompactSummary $visible={showStickySummary}>\n          <div className=\"compact-title\">\n            <FontAwesomeIcon icon={faCalculator} />\n            Pehled pokladny - {organizationInfo.month} {organizationInfo.year}\n            <BookStatusBadge status={bookStatus} />\n          </div>\n          <div className=\"compact-values\">\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Pevod</div>\n              <div className=\"compact-value\">{formatCurrency(carryOverAmount)}</div>\n            </div>\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Pjmy</div>\n              <div className=\"compact-value positive\">{formatCurrency(totals.totalIncome)}</div>\n            </div>\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Vdaje</div>\n              <div className=\"compact-value negative\">{formatCurrency(totals.totalExpenses)}</div>\n            </div>\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Zstatek</div>\n              <div className={`compact-value ${totals.currentBalance >= 0 ? 'positive' : 'negative'}`}>\n                {formatCurrency(totals.currentBalance)}\n              </div>\n            </div>\n            <div className=\"compact-item\">\n              <div className=\"compact-label\">Poet operac</div>\n              <div className=\"compact-value\">{totals.entryCount}</div>\n            </div>\n          </div>\n        </StickyCompactSummary>\n\n        {/* Informan panel */}\n        <InfoPanel className=\"no-print\">\n        <div className=\"organization-info\">\n          <div className=\"info-text\">\n            <h3>\n              <FontAwesomeIcon icon={faInfoCircle} style={{ marginRight: '0.5rem' }} />\n              Pehled pokladny\n              {/*  KROK 3: Status badge pmo u nadpisu */}\n              <span style={{ marginLeft: '1rem', display: 'inline-flex', verticalAlign: 'middle' }}>\n                <BookStatusBadge status={bookStatus} />\n              </span>\n            </h3>\n            <p>Aktuln stav pokladn knihy za msc {organizationInfo.month} {organizationInfo.year}</p>\n          </div>\n\n          {/*  KROK 3: Workflow tlatka vpravo */}\n          {/*  Zobrazit uivatelm s EDIT_OWN (jen pro vlastn knihu) nebo MANAGE (vechny knihy) */}\n          {((canEditOwn && isCurrentUserCashbook) || hasManagePermission) && (\n            <div className=\"info-actions\">\n              {bookStatus === 'aktivni' && (\n                <ActionButton\n                  type=\"button\"\n                  variant=\"warning\"\n                  onClick={handleCloseMonth}\n                  disabled={!canCloseCurrentPeriod}\n                  title={\n                    !canCloseCurrentPeriod\n                      ? `Nelze uzavt aktuln msc. Uzavt lze a od 1. dne nsledujcho msce.`\n                      : \"Uzavt msc - knihu nebude mon editovat\"\n                  }\n                >\n                  <FontAwesomeIcon icon={faCheck} />\n                  Uzavt msc\n                </ActionButton>\n              )}\n\n              {/*  Zamknout me jen sprvce - zobrazit i po uzaven msce */}\n              {hasManagePermission && (bookStatus === 'aktivni' || bookStatus === 'uzavrena_uzivatelem') && (\n                <ActionButton\n                  type=\"button\"\n                  variant=\"danger\"\n                  onClick={handleLockBook}\n                  disabled={!canCloseCurrentPeriod}\n                  title={\n                    !canCloseCurrentPeriod\n                      ? `Nelze zamknout aktuln msc. Zamknout lze a od 1. dne nsledujcho msce.`\n                      : \"Zamknout knihu sprvcem - nelze editovat ani odemknout\"\n                  }\n                >\n                   Zamknout\n                </ActionButton>\n              )}\n\n              {/* Otevt msc me bn uivatel (uzavrena_uzivatelem) nebo sprvce (ve) */}\n              {bookStatus === 'uzavrena_uzivatelem' && (\n                <ActionButton\n                  type=\"button\"\n                  variant=\"primary\"\n                  $filled\n                  onClick={handleUnlockBook}\n                  title=\"Otevt msc pro editaci\"\n                >\n                   Otevt msc\n                </ActionButton>\n              )}\n\n              {/* Zamen sprvcem - jen sprvce me odemknout */}\n              {bookStatus === 'zamknuta_spravcem' && hasManagePermission && (\n                <ActionButton\n                  type=\"button\"\n                  variant=\"primary\"\n                  $filled\n                  onClick={handleUnlockBook}\n                  title=\"Odemknout knihu zamenou sprvcem\"\n                >\n                   Odemknout (Admin)\n                </ActionButton>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"summary-grid\">\n          <div className=\"summary-item info\">\n            <div className=\"label\">Pevod z pedchozho msce</div>\n            <div className=\"value\">{formatCurrency(carryOverAmount)}</div>\n          </div>\n          <div className=\"summary-item positive\">\n            <div className=\"label\">Pjmy v msci</div>\n            <div className=\"value\">{formatCurrency(totals.totalIncome)}</div>\n          </div>\n          <div className=\"summary-item negative\">\n            <div className=\"label\">Vdaje v msci</div>\n            <div className=\"value\">{formatCurrency(totals.totalExpenses)}</div>\n          </div>\n          <div className={`summary-item ${totals.currentBalance >= 0 ? 'positive' : 'negative'}`}>\n            <div className=\"label\">Koncov stav msce</div>\n            <div className=\"value\">{formatCurrency(totals.currentBalance)}</div>\n          </div>\n          <div className=\"summary-item\">\n            <div className=\"label\">Poet operac</div>\n            <div className=\"value\">{totals.entryCount}</div>\n          </div>\n        </div>\n      </InfoPanel>\n\n      {/* Navigace mezi msci */}\n      <MonthNavigation className=\"no-print\">\n        <MonthInfo>\n          <h2>\n            {organizationInfo.month} {organizationInfo.year}\n          </h2>\n        </MonthInfo>\n        <MonthControls>\n          <MonthButton onClick={goToPreviousMonth} title=\"Pedchoz msc\">\n            <FontAwesomeIcon icon={faChevronLeft} />\n            Pedchoz\n          </MonthButton>\n          <MonthButton\n            onClick={goToCurrentMonth}\n            disabled={currentMonth === new Date().getMonth() + 1 && currentYear === new Date().getFullYear()}\n            title=\"Aktuln msc\"\n          >\n            <FontAwesomeIcon icon={faCalendarDay} />\n            Nyn\n          </MonthButton>\n          <MonthButton\n            onClick={goToNextMonth}\n            disabled={currentMonth === new Date().getMonth() + 1 && currentYear === new Date().getFullYear()}\n            title=\"Nsledujc msc\"\n          >\n            Dal\n            <FontAwesomeIcon icon={faChevronRight} />\n          </MonthButton>\n        </MonthControls>\n      </MonthNavigation>\n\n      {/*  Warning box pro oteven pedchoz msc */}\n      {showPreviousMonthWarning && (\n        <PreviousMonthWarning>\n          <WarningIcon>\n            <FontAwesomeIcon icon={faExclamationTriangle} />\n          </WarningIcon>\n          <WarningContent>\n            <h4> Pedchoz msc nen uzaven</h4>\n            <p>\n              <strong>Pozor:</strong> Pedchoz msc (\n              {new Date(\n                currentMonth === 1 ? currentYear - 1 : currentYear,\n                (currentMonth === 1 ? 12 : currentMonth - 1) - 1\n              ).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}) nen uzaven.\n            </p>\n            <p>\n              sla doklad <strong>PPD a VPD</strong> v tomto msci se mohou po uzaven pedchozho msce\n              <strong> automaticky pepotat</strong> pro zachovn sprvn posloupnosti.\n            </p>\n            <p className=\"tip\">\n               Doporuujeme nejprve uzavt pedchoz msce chronologicky od nejstarho.\n            </p>\n          </WarningContent>\n        </PreviousMonthWarning>\n      )}\n\n      {/* Tabulka pokladn knihy */}\n      <div className=\"cashbook-print-area\">\n        {/* Hlavika pro tisk */}\n        <div className=\"print-header\" style={{\n          display: 'none',\n          textAlign: 'center',\n          marginBottom: '2rem',\n          paddingBottom: '1rem',\n          borderBottom: '2px solid #1e40af'\n        }}>\n          <h1 style={{\n            fontSize: '1.8rem',\n            fontWeight: 'bold',\n            color: '#1e40af',\n            margin: '0 0 0.5rem 0'\n          }}>\n            Pokladn kniha\n          </h1>\n          <p style={{\n            fontSize: '1rem',\n            color: '#4b5563',\n            margin: '0'\n          }}>\n            {/*  Jmno vlastnka + oddlen + pokladna + obdob */}\n            {(() => {\n              const userName = mainAssignment?.uzivatel_cele_jmeno ||\n                              (mainAssignment?.uzivatel_jmeno && mainAssignment?.uzivatel_prijmeni\n                                ? `${mainAssignment.uzivatel_jmeno} ${mainAssignment.uzivatel_prijmeni}`\n                                : null);\n              const workplace = mainAssignment?.nazev_pracoviste || mainAssignment?.kod_pracoviste;\n              const cashboxNum = mainAssignment?.cislo_pokladny;\n\n              return (\n                <>\n                  {userName || 'Bez uivatele'}\n                  {' | '}\n                  {workplace || 'Bez oddlen'}\n                  {' | '}\n                  Pokladna . {cashboxNum || organizationInfo.cashboxNumber}\n                  {' | '}\n                  {organizationInfo.month} {organizationInfo.year}\n                </>\n              );\n            })()}\n          </p>\n          <p style={{\n            fontSize: '0.875rem',\n            color: '#6b7280',\n            margin: '0.5rem 0 0 0'\n          }}>\n            VPD: {organizationInfo.cashboxVpd || 'N/A'} |\n            PPD: {organizationInfo.cashboxPpd || 'N/A'} |\n            Pevod z pedchozho msce: {formatCurrency(carryOverAmount)}\n          </p>\n        </div>\n\n        <TableContainer>\n          <Table>\n            <thead>\n            <tr>\n              <th className=\"row-number\">#</th>\n              <th className=\"date-cell\">Datum</th>\n              <th className=\"document-cell\">Doklad .</th>\n              <th className=\"description-cell\">Obsah zpisu</th>\n              <th className=\"person-cell\">Komu/Od koho</th>\n              <th className=\"amount-cell income\">Pjmy<br/>(K)</th>\n              <th className=\"amount-cell expense\">Vdaje<br/>(K)</th>\n              <th className=\"balance-cell\">Zstatek<br/>(K)</th>\n              <th className=\"lp-code-cell\">LP kd</th>\n              <th className=\"note-cell\">Poznmka</th>\n              {canActuallyEdit && <th className=\"actions-cell\">Akce</th>}\n            </tr>\n          </thead>\n          <tbody>\n            {cashBookEntries.map((entry, index) => {\n              const isLastSaved = entry.id === lastSavedEntryId;\n              return (\n              <React.Fragment key={entry.id}>\n              <tr\n                onDoubleClick={() => {\n                  if (canActuallyEdit && !entry.isEditing) {\n                    startEditing(entry.id);\n                  }\n                }}\n                style={{\n                  cursor: canActuallyEdit && !entry.isEditing ? 'pointer' : 'default',\n                  animation: isLastSaved ? `${highlightPulse} 1s ease-in-out 5` : 'none'\n                }}\n              >\n                <td className=\"row-number\">{index + 1}</td>\n\n                <td className=\"date-cell\">\n                  {entry.isEditing ? (\n                    <DatePicker\n                      value={entry.date}\n                      onChange={(newDate) => updateEntry(entry.id, 'date', newDate)}\n                      placeholder=\"Vyberte datum\"\n                      limitToMonth={currentMonth}\n                      limitToYear={currentYear}\n                    />\n                  ) : (\n                    formatDate(entry.date)\n                  )}\n                </td>\n\n                <td className=\"document-cell\">\n                  {/*  KROK 4: Zobrazit prefixovan slo pokud je zapnuto nastaven */}\n                  {(() => {\n                    if (!entry.documentNumber) {\n                      return '';\n                    }\n\n                    //  OPRAVA: Pokud slo u obsahuje pomlku, je u prefixovan z DB  zobrazit jak je\n                    if (entry.documentNumber.includes('-')) {\n                      const type = entry.documentNumber.charAt(0); // P nebo V\n                      return (\n                        <span\n                          title={`slo dokladu: ${entry.documentNumber}`}\n                          style={{\n                            cursor: 'help',\n                            fontWeight: '500',\n                            color: type === 'P' ? '#059669' : '#dc2626'\n                          }}\n                        >\n                          {entry.documentNumber}\n                        </span>\n                      );\n                    }\n\n                    // slo nem prefix (nap. V012)  pidat prefix pokud je zapnuto\n                    if (!usePrefixedNumbers) {\n                      return entry.documentNumber;\n                    }\n\n                    const type = entry.documentNumber.charAt(0); // P nebo V\n                    const number = entry.documentNumber.substring(1); // 001\n\n                    // Urit selnou adu podle typu dokladu\n                    let prefix = '';\n                    if (type === 'V' && organizationInfo.cashboxVpd) {\n                      prefix = organizationInfo.cashboxVpd; // VPD = vdajov pokladn doklad\n                    } else if (type === 'P' && organizationInfo.cashboxPpd) {\n                      prefix = organizationInfo.cashboxPpd; // PPD = pjmov pokladn doklad\n                    }\n\n                    const prefixedNumber = prefix ? `${type}${prefix}-${number}` : entry.documentNumber;\n\n                    return (\n                      <span\n                        title={`Poadov slo dokladu v roce: ${entry.documentNumber}`}\n                        style={{\n                          cursor: 'help',\n                          fontWeight: '500',\n                          color: type === 'P' ? '#059669' : '#dc2626'\n                        }}\n                      >\n                        {prefixedNumber}\n                      </span>\n                    );\n                  })()}\n                </td>\n\n                <td className=\"description-cell\">\n                  {entry.isEditing ? (\n                    <EditableInput\n                      value={entry.description}\n                      onChange={(e) => updateEntry(entry.id, 'description', e.target.value)}\n                      onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                      onBlur={autoSave}\n                      data-entry-id={entry.id}\n                      data-field=\"description\"\n                      placeholder=\"Popis operace\"\n                    />\n                  ) : (\n                    entry.description\n                  )}\n                </td>\n\n                <td className=\"person-cell\">\n                  {entry.isEditing ? (\n                    <EditableInput\n                      value={entry.person}\n                      onChange={(e) => updateEntry(entry.id, 'person', e.target.value)}\n                      onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                      onBlur={autoSave}\n                      placeholder=\"Jmno osoby\"\n                    />\n                  ) : (\n                    entry.person\n                  )}\n                </td>\n\n                <td className=\"amount-cell income\">\n                  {entry.isEditing ? (\n                    <CurrencyInput\n                      value={entry.income}\n                      onChange={(e) => updateEntry(entry.id, 'income', e.target.value)}\n                      onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                      onBlur={autoSave}\n                      placeholder=\"0,00\"\n                    />\n                  ) : (\n                    entry.income ? formatCurrency(entry.income) : ''\n                  )}\n                </td>\n\n                <td className=\"amount-cell expense\">\n                  {entry.isEditing ? (\n                    <CurrencyInput\n                      value={entry.expense}\n                      onChange={(e) => updateEntry(entry.id, 'expense', e.target.value)}\n                      onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                      onBlur={autoSave}\n                      placeholder=\"0,00\"\n                    />\n                  ) : (\n                    entry.expense ? formatCurrency(entry.expense) : ''\n                  )}\n                </td>\n\n                <td className=\"balance-cell\">\n                  {formatCurrency(entry.balance)}\n                </td>\n\n                <td className=\"lp-code-cell\">\n                  {entry.isEditing ? (\n                    <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>\n                      {/* Master LP kd - disabled pokud jsou detail poloky, povinn u vdaj */}\n                      {!(entry.detailItems && entry.detailItems.length > 0) && (\n                        <div style={{ position: 'relative', flex: 1 }}>\n                          <EditableCombobox\n                            value={entry.lpCode || ''}\n                            onChange={(e) => updateEntry(entry.id, 'lpCode', e.target.value)}\n                            onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                            onBlur={autoSave}\n                            options={lpCodes}\n                            placeholder={lpLoading ? 'Natn...' : (entry.expense > 0 ? 'LP kd (povinn) *' : 'LP kd (nepovinn)')}\n                            disabled={lpLoading}\n                            loading={lpLoading}\n                            hasError={entry.expense > 0 && !entry.lpCode}\n                            strictSelect={true}\n                          />\n                          {entry.expense > 0 && !entry.lpCode && (\n                            <div style={{ \n                              position: 'absolute', \n                              top: '100%', \n                              left: 0, \n                              fontSize: '10px', \n                              color: '#f44336', \n                              marginTop: '2px',\n                              whiteSpace: 'nowrap'\n                            }}>\n                               LP kd je povinn u vdaj\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {/* Tlatko pro rozbalen inline panelu - pouze u vdaj */}\n                      {entry.expense > 0 && (\n                        <button\n                          onClick={() => {\n                            if (expandedDetailEntryId === entry.id) {\n                              setExpandedDetailEntryId(null);\n                              setDetailEditBuffer([]);\n                            } else {\n                              setExpandedDetailEntryId(entry.id);\n                              setDetailEditBuffer(entry.detailItems && entry.detailItems.length > 0 \n                                ? [...entry.detailItems] \n                                : [{ popis: '', castka: 0, lp_kod: '', lp_popis: '' }]\n                              );\n                            }\n                          }}\n                          style={{\n                            padding: '4px 8px',\n                            fontSize: '12px',\n                            background: expandedDetailEntryId === entry.id \n                              ? '#ff9800' \n                              : (entry.detailItems && entry.detailItems.length > 0 ? '#4caf50' : '#2196f3'),\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            minWidth: '24px'\n                          }}\n                          title={expandedDetailEntryId === entry.id \n                            ? 'Zavt panel' \n                            : (entry.detailItems && entry.detailItems.length > 0 \n                              ? entry.detailItems.map(item => `${item.lp_kod}: ${Number(item.castka).toFixed(2)} K${item.popis ? ' - ' + item.popis : ''}`).join('\\n')\n                              : 'Pidat vce LP kd')\n                          }\n                        >\n                          {expandedDetailEntryId === entry.id \n                            ? '' \n                            : (entry.detailItems && entry.detailItems.length > 0 ? `${entry.detailItems.length}` : '+')}\n                        </button>\n                      )}\n                      {/* Zobrazen multi-LP v edit mdu */}\n                      {entry.detailItems && entry.detailItems.length > 0 && (\n                        <div style={{ fontSize: '11px', color: '#4caf50', fontWeight: 'bold' }}>\n                          Multi-LP ({entry.detailItems.length})\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <div>\n                      {entry.detailItems && entry.detailItems.length > 0 ? (\n                        <div style={{ fontSize: '11px', color: '#666' }}>\n                          {entry.detailItems.map((item, idx) => (\n                            <div key={idx}>{item.lp_kod} ({Number(item.castka).toFixed(2)} K)</div>\n                          ))}\n                        </div>\n                      ) : (\n                        entry.lpCode || '-'\n                      )}\n                    </div>\n                  )}\n                </td>\n\n                <td className=\"note-cell\">\n                  {entry.isEditing ? (\n                    <EditableInput\n                      value={entry.note}\n                      onChange={(e) => updateEntry(entry.id, 'note', e.target.value)}\n                      onKeyDown={(e) => handleKeyDown(e, entry.id)}\n                      onBlur={autoSave}\n                      placeholder=\"Poznmka\"\n                    />\n                  ) : (\n                    entry.note\n                  )}\n                </td>\n\n                {canActuallyEdit && (\n                  <td className=\"actions-cell\">\n                    {entry.isEditing ? (\n                      <>\n                        <ActionIcon onClick={() => stopEditing(entry.id)} title=\"Potvrdit\">\n                          <FontAwesomeIcon icon={faCheck} />\n                        </ActionIcon>\n                      </>\n                    ) : (\n                      <>\n                        <ActionIcon onClick={() => startEditing(entry.id)} title=\"Editovat\">\n                          <FontAwesomeIcon icon={faEdit} />\n                        </ActionIcon>\n                        {canActuallyDelete && (\n                          <ActionIcon\n                            onClick={() => removeEntry(entry.id)}\n                            title=\"Smazat\"\n                            danger\n                          >\n                            <FontAwesomeIcon icon={faTrash} />\n                          </ActionIcon>\n                        )}\n                      </>\n                    )}\n                  </td>\n                )}\n              </tr>\n              {/*  INLINE MULTI-LP PANEL */}\n              {expandedDetailEntryId === entry.id && (\n                <tr key={`detail-${entry.id}`} style={{ background: '#f8f9fa' }}>\n                  <td colSpan={1} style={{ padding: 0 }}></td>\n                  <td colSpan={2} style={{ padding: 0 }}></td>\n                  <td colSpan={canActuallyEdit ? 8 : 7} style={{ padding: '16px 16px 16px 8px' }}>\n                    <div style={{ \n                      background: 'white', \n                      border: '2px solid #2196f3', \n                      borderRadius: '8px', \n                      padding: '16px',\n                      boxShadow: '0 4px 12px rgba(0,0,0,0.1)'\n                    }}>\n                      <div style={{ \n                        display: 'flex', \n                        justifyContent: 'space-between', \n                        alignItems: 'center', \n                        marginBottom: '12px',\n                        borderBottom: '2px solid #e0e0e0',\n                        paddingBottom: '8px'\n                      }}>\n                        <h4 style={{ margin: 0, color: '#2196f3' }}>\n                           Rozpad LP kd pro doklad {entry.documentNumber || '(nov)'}\n                        </h4>\n                        <div style={{ fontSize: '14px', fontWeight: 'bold' }}>\n                          Celkem: {Number(entry.expense || 0).toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K\n                        </div>\n                      </div>\n\n                      <table style={{ width: '100%', borderCollapse: 'collapse', marginBottom: '12px', tableLayout: 'fixed' }}>\n                        <thead>\n                          <tr style={{ background: '#f5f5f5' }}>\n                            <th style={{ padding: '8px', textAlign: 'left', border: '1px solid #ddd', width: '50%' }}>Popis poloky</th>\n                            <th style={{ padding: '8px', textAlign: 'left', border: '1px solid #ddd', width: '18%' }}>stka</th>\n                            <th style={{ padding: '8px', textAlign: 'left', border: '1px solid #ddd', width: '25%' }}>LP kd</th>\n                            <th style={{ padding: '8px', textAlign: 'center', border: '1px solid #ddd', width: '7%' }}></th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                          {detailEditBuffer.map((item, idx) => {\n                            const isValidLp = !item.lp_kod || lpCodes.find(lp => lp.code === item.lp_kod);\n                            return (\n                              <tr key={idx}>\n                                <td style={{ padding: '8px', border: '1px solid #ddd' }}>\n                                  <input\n                                    type=\"text\"\n                                    value={item.popis || ''}\n                                    onChange={(e) => {\n                                      const updated = [...detailEditBuffer];\n                                      updated[idx].popis = e.target.value;\n                                      setDetailEditBuffer(updated);\n                                    }}\n                                    style={{ \n                                      width: '100%', \n                                      padding: '0.5rem', \n                                      fontSize: '0.9rem', \n                                      border: '1px solid #ccc', \n                                      borderRadius: '4px',\n                                      boxSizing: 'border-box'\n                                    }}\n                                    placeholder=\"Nap. Oprava kavovaru\"\n                                  />\n                                </td>\n                                <td style={{ padding: '8px', border: '1px solid #ddd' }}>\n                                  <CurrencyInput\n                                    value={item.castka}\n                                    onChange={(e) => {\n                                      const updated = [...detailEditBuffer];\n                                      updated[idx].castka = e.target.value === null ? 0 : e.target.value;\n                                      setDetailEditBuffer(updated);\n                                    }}\n                                    placeholder=\"0,00\"\n                                  />\n                                </td>\n                                <td style={{ padding: '8px', border: '1px solid #ddd' }}>\n                                  <EditableCombobox\n                                    value={item.lp_kod || ''}\n                                    onChange={(e) => {\n                                      const updated = [...detailEditBuffer];\n                                      const selectedLp = lpCodes.find(lp => lp.code === e.target.value);\n                                      updated[idx].lp_kod = e.target.value;\n                                      updated[idx].lp_popis = selectedLp?.name || '';\n                                      setDetailEditBuffer(updated);\n                                    }}\n                                    options={lpCodes}\n                                    placeholder={lpLoading ? 'Natn...' : 'LP kd (nap. LPIT01)'}\n                                    disabled={lpLoading}\n                                    loading={lpLoading}\n                                    hasError={!isValidLp}\n                                    strictSelect={true}\n                                  />\n                                  {!isValidLp && (\n                                    <div style={{ color: '#f44336', fontSize: '10px', marginTop: '2px' }}>\n                                       Neplatn kd\n                                    </div>\n                                  )}\n                                </td>\n                                <td style={{ padding: '8px', border: '1px solid #ddd', textAlign: 'center' }}>\n                                  <button\n                                    onClick={() => {\n                                      const updated = detailEditBuffer.filter((_, i) => i !== idx);\n                                      setDetailEditBuffer(updated);\n                                    }}\n                                    style={{ \n                                      padding: '0.5rem', \n                                      background: '#dc3545', \n                                      color: 'white', \n                                      border: 'none', \n                                      borderRadius: '4px', \n                                      cursor: 'pointer',\n                                      fontSize: '18px',\n                                      minWidth: '40px',\n                                      display: 'inline-flex',\n                                      alignItems: 'center',\n                                      justifyContent: 'center',\n                                      lineHeight: 1\n                                    }}\n                                    title=\"Smazat dek\"\n                                  >\n                                    \n                                  </button>\n                                </td>\n                              </tr>\n                            );\n                          })}\n                        </tbody>\n                      </table>\n\n                      <button\n                        onClick={() => {\n                          setDetailEditBuffer([...detailEditBuffer, { popis: '', castka: 0, lp_kod: '', lp_popis: '' }]);\n                        }}\n                        style={{ \n                          padding: '6px 12px', \n                          background: '#4caf50', \n                          color: 'white', \n                          border: 'none', \n                          borderRadius: '4px', \n                          cursor: 'pointer',\n                          fontSize: '13px',\n                          marginBottom: '12px'\n                        }}\n                      >\n                        + Pidat poloku\n                      </button>\n\n                      <div style={{ \n                        display: 'flex', \n                        justifyContent: 'space-between', \n                        alignItems: 'center',\n                        marginTop: '12px',\n                        paddingTop: '12px',\n                        borderTop: '2px solid #e0e0e0'\n                      }}>\n                        <div style={{ fontSize: '14px' }}>\n                          Souet poloek: <strong>{detailEditBuffer.reduce((sum, item) => sum + (Number(item.castka) || 0), 0).toLocaleString('cs-CZ', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} K</strong>\n                          {Math.abs(detailEditBuffer.reduce((sum, item) => sum + (item.castka || 0), 0) - (entry.expense || 0)) > 0.01 && (\n                            <span style={{ color: '#f44336', marginLeft: '8px' }}>\n                               Nesouhlas s stkou vdaje!\n                            </span>\n                          )}\n                        </div>\n                        <div style={{ display: 'flex', gap: '8px' }}>\n                          <button\n                            onClick={() => {\n                              setExpandedDetailEntryId(null);\n                              setDetailEditBuffer([]);\n                            }}\n                            style={{ \n                              padding: '8px 16px', \n                              background: '#6c757d', \n                              color: 'white', \n                              border: 'none', \n                              borderRadius: '4px', \n                              cursor: 'pointer' \n                            }}\n                          >\n                            Zruit\n                          </button>\n                          <button\n                            onClick={() => {\n                              // Validace\n                              const totalDetail = detailEditBuffer.reduce((sum, item) => sum + (item.castka || 0), 0);\n                              if (Math.abs(totalDetail - (entry.expense || 0)) > 0.01) {\n                                toast.error(` Souet poloek (${totalDetail.toFixed(2)} K) se neshoduje s stkou vdaje (${entry.expense} K)`, {\n                                  position: \"top-center\",\n                                  autoClose: 4000\n                                });\n                                return;\n                              }\n                              \n                              for (const item of detailEditBuffer) {\n                                if (!item.lp_kod) {\n                                  toast.warning(' Vechny poloky mus mt vybran LP kd', {\n                                    position: \"top-center\",\n                                    autoClose: 3000\n                                  });\n                                  return;\n                                }\n                                if (!lpCodes.find(lp => lp.code === item.lp_kod)) {\n                                  toast.error(` LP kd '${item.lp_kod}' nen platn`, {\n                                    position: \"top-center\",\n                                    autoClose: 3000\n                                  });\n                                  return;\n                                }\n                              }\n                              \n                              // Uloit do entry\n                              setCashBookEntries(prev => prev.map(e => \n                                e.id === entry.id \n                                  ? { \n                                      ...e, \n                                      detailItems: detailEditBuffer,\n                                      lpCode: '',\n                                      hasDetails: true,\n                                      changed: true,\n                                      sync_status: 'pending'\n                                    }\n                                  : e\n                              ));\n                              \n                              toast.success(` Uloeno ${detailEditBuffer.length} LP kd pod dokladem ${entry.documentNumber}`, {\n                                position: \"top-right\",\n                                autoClose: 2000\n                              });\n                              \n                              setExpandedDetailEntryId(null);\n                              setDetailEditBuffer([]);\n                              autoSave();\n                            }}\n                            style={{ \n                              padding: '8px 16px', \n                              background: '#2196f3', \n                              color: 'white', \n                              border: 'none', \n                              borderRadius: '4px', \n                              cursor: 'pointer',\n                              fontWeight: 'bold'\n                            }}\n                          >\n                             Uloit\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  </td>\n                </tr>\n              )}\n              </React.Fragment>\n              );\n            })}\n          </tbody>\n        </Table>\n\n        {canActuallyCreate && (\n          <div style={{ padding: '1rem' }}>\n            <AddRowButton onClick={handleAddNewRow}>\n              <FontAwesomeIcon icon={faPlus} />\n              Pidat nov dek\n            </AddRowButton>\n          </div>\n        )}\n      </TableContainer>\n      \n      {/*  Kompaktn info box pro zamenou knihu */}\n      {bookStatus === 'zamknuta_spravcem' && (\n        <div className=\"no-print\" style={{\n          background: 'linear-gradient(135deg, #fee2e2 0%, #fecaca 100%)',\n          border: '2px solid #dc2626',\n          borderRadius: '8px',\n          padding: '1rem 1.25rem',\n          marginTop: '1rem',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '1rem'\n        }}>\n          <div style={{\n            fontSize: '2rem',\n            color: '#dc2626',\n            flexShrink: 0\n          }}>\n            <FontAwesomeIcon icon={faLock} />\n          </div>\n          <div style={{ flex: 1 }}>\n            <h4 style={{ \n              margin: '0 0 0.5rem 0', \n              color: '#991b1b', \n              fontSize: '1rem',\n              fontWeight: '600'\n            }}>\n               Pokladn kniha je finln uzamena sprvcem\n            </h4>\n            <p style={{ \n              margin: 0, \n              color: '#7f1d1d', \n              fontSize: '0.875rem',\n              lineHeight: '1.4'\n            }}>\n              Tento msc byl zamen administrtorem a je ji zatovn. \n              <strong> Nelze pidvat, upravovat ani mazat zznamy.</strong>\n              {' '}V ppad poteby zmn kontaktujte sprvce pokladn knihy.\n            </p>\n          </div>\n        </div>\n      )}\n      </div>\n\n      {/* Legenda horkch klves - pouze pro aktivn knihu */}\n      {bookStatus === 'aktivni' && (\n        <div className=\"no-print\" style={{\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          gap: '2rem',\n          padding: '0.75rem 1rem',\n          marginTop: '0.75rem',\n          background: 'linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)',\n          borderRadius: '8px',\n          fontSize: '0.8rem',\n          fontWeight: 600,\n          color: '#475569',\n          border: '1px solid #cbd5e1',\n          boxShadow: '0 1px 3px rgba(0, 0, 0, 0.05)'\n        }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Shift</kbd>\n          <span>+</span>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Insert</kbd>\n          <span style={{ marginLeft: '0.25rem' }}>Nov dek</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Shift</kbd>\n          <span>+</span>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Enter</kbd>\n          <span style={{ marginLeft: '0.25rem' }}>Uloit a ukonit editaci</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>ESC</kbd>\n          <span style={{ marginLeft: '0.25rem' }}>Zruit editaci bez uloen</span>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <kbd style={{\n            background: '#ffffff',\n            border: '1px solid #cbd5e1',\n            borderRadius: '4px',\n            padding: '0.15rem 0.4rem',\n            fontSize: '0.75rem',\n            fontFamily: 'monospace',\n            fontWeight: 700,\n            color: '#1e40af',\n            boxShadow: '0 1px 2px rgba(0, 0, 0, 0.1)'\n          }}>Double-click</kbd>\n          <span style={{ marginLeft: '0.25rem' }}>Editovat dek</span>\n        </div>\n        </div>\n      )}\n\n      {/* Panel vech tlatek pod tabulkou */}\n      <ActionBar className=\"no-print\" style={{ marginTop: '1rem' }}>\n        <ActionGroup>\n          {/* Przdn msto vlevo - mete pidat dal tlatka */}\n        </ActionGroup>\n\n        <ActionGroup>\n          {/* Export tlatka */}\n          {canExportCashBook && (\n            <>\n              <ActionButton type=\"button\" onClick={() => exportData('CSV')}>\n                <FontAwesomeIcon icon={faFileExport} />\n                Export CSV\n              </ActionButton>\n              <ActionButton type=\"button\" onClick={() => exportData('PDF')}>\n                <FontAwesomeIcon icon={faPrint} />\n                Export PDF\n              </ActionButton>\n              <ActionButton\n                type=\"button\"\n                onClick={printPDFReport}\n                title=\"Tisknout pokladn knihu (PDF formt, A4 na ku)\"\n              >\n                <FontAwesomeIcon icon={faPrint} />\n                Tisknout\n              </ActionButton>\n            </>\n          )}\n        </ActionGroup>\n      </ActionBar>\n\n      {/* ConfirmDialog pro smazn poloky */}\n      <ConfirmDialog\n        isOpen={deleteDialogOpen}\n        title=\"Smazn poloky\"\n        icon=\"trash\"\n        variant=\"danger\"\n        onConfirm={handleConfirmDelete}\n        onClose={handleCancelDelete}\n      >\n        Opravdu chcete odstranit tento zznam z pokladn knihy? Tato akce je nevratn.\n      </ConfirmDialog>\n\n      {/* ConfirmDialog pro uzaven msce */}\n      <ConfirmDialog\n        isOpen={closeMonthDialogOpen}\n        title={`Uzavt msc ${new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}`}\n        icon={faCheck}\n        variant=\"warning\"\n        onConfirm={confirmCloseMonth}\n        onClose={() => setCloseMonthDialogOpen(false)}\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p><strong>Po uzaven msce:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>Nebude mon pidvat nov zznamy</li>\n            <li>Nebude mon upravovat existujc zznamy</li>\n            <li>Msc lze znovu otevt tlatkem \"Otevt msc\"</li>\n          </ul>\n\n          <div style={{\n            background: '#fef3c7',\n            border: '2px solid #d97706',\n            borderRadius: '8px',\n            padding: '1rem',\n            marginTop: '1rem'\n          }}>\n            <p style={{ color: '#92400e', fontWeight: '600', marginBottom: '0.5rem' }}>\n               Automatick peslovn doklad\n            </p>\n            <p style={{ color: '#92400e', fontSize: '0.9rem' }}>\n              Ped uzavenm budou <strong>vechny doklady</strong> v tomto msci i ve vech nsledujcch mscch <strong>peslovny chronologicky</strong> podle data a typu (P/V).\n            </p>\n            <p style={{ color: '#92400e', fontSize: '0.9rem', marginTop: '0.5rem' }}>\n              Tm se zajist sprvn navazujc poad sel doklad.\n            </p>\n          </div>\n\n          <p style={{ marginTop: '1rem', fontWeight: '500' }}>Opravdu chcete pokraovat?</p>\n        </div>\n      </ConfirmDialog>\n\n      {/* ConfirmDialog pro zamknut msce (ADMIN) */}\n      <ConfirmDialog\n        isOpen={lockBookDialogOpen}\n        title={` Zamknout msc ${new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}`}\n        icon={faLock}\n        variant=\"danger\"\n        onConfirm={confirmLockBook}\n        onClose={() => setLockBookDialogOpen(false)}\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p style={{ color: '#dc3545', fontWeight: 'bold', marginBottom: '1rem' }}>\n            POZOR: Toto je finln uzaven msce!\n          </p>\n          <p><strong>Po zamknut sprvcem:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>Nikdo (ani bn uivatel) nebude moci upravovat zznamy</li>\n            <li>Nikdo (ani bn uivatel) nebude moci otevt msc</li>\n            <li>Odemknout me pouze sprvce tlatkem \"Odemknout (Admin)\"</li>\n            <li>Toto je <strong>FINLN</strong> uzaven msce</li>\n          </ul>\n          <p style={{ marginTop: '1rem' }}>Pokraovat s finlnm zamenm?</p>\n        </div>\n      </ConfirmDialog>\n\n      {/* ConfirmDialog pro oteven uzavenho msce (uzavrena_uzivatelem) */}\n      <ConfirmDialog\n        isOpen={reopenMonthDialogOpen}\n        title={` Otevt msc ${new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}`}\n        icon={faExclamationTriangle}\n        variant=\"warning\"\n        onConfirm={confirmReopenMonth}\n        onClose={() => setReopenMonthDialogOpen(false)}\n        confirmText=\"Ano, otevt msc\"\n        cancelText=\"Zruit\"\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p style={{ color: '#ff9800', fontWeight: 'bold', marginBottom: '1rem' }}>\n             POZOR: Znovu otevrte uzaven msc!\n          </p>\n          <p><strong>Po oteven msce:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>Bude mon znovu <strong>pidvat</strong> nov zznamy</li>\n            <li>Bude mon <strong>upravovat</strong> existujc zznamy</li>\n            <li>Bude mon <strong>mazat</strong> zznamy</li>\n            <li>Msc <strong>nebude uzaven</strong> pro etn operace</li>\n            <li style={{ color: '#d97706', fontWeight: '500', marginTop: '0.5rem' }}>\n               Pokud nsledn provedete zmny a znovu msc uzavete, sla doklad v nsledujcch mscch budou peslovna\n            </li>\n          </ul>\n          <p style={{ marginTop: '1rem', color: '#ff9800', fontWeight: 'bold' }}>\n             Tmto zrute uzaven msce! Opravdu pokraovat?\n          </p>\n        </div>\n      </ConfirmDialog>\n\n      {/* ConfirmDialog pro odemknut zamenho msce (zamknuta_spravcem) - ADMIN ONLY */}\n      <ConfirmDialog\n        isOpen={unlockBookDialogOpen}\n        title={` Odemknout msc ${new Date(currentYear, currentMonth - 1).toLocaleDateString('cs-CZ', { month: 'long', year: 'numeric' })}`}\n        icon={faLockOpen}\n        variant=\"danger\"\n        onConfirm={confirmUnlockBook}\n        onClose={() => setUnlockBookDialogOpen(false)}\n        confirmText=\"Ano, odemknout (Admin)\"\n        cancelText=\"Zruit\"\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p style={{ color: '#dc3545', fontWeight: 'bold', marginBottom: '1rem' }}>\n             ADMIN AKCE: Odemykte finln zamen msc!\n          </p>\n          <p><strong>Po odemknut sprvcem:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>Bude mon znovu <strong>pidvat a upravovat</strong> zznamy</li>\n            <li>Bude mon <strong>mazat</strong> zznamy</li>\n            <li>Msc <strong>ztrat finln uzaven</strong></li>\n            <li>Vichni uivatel budou moci opt editovat</li>\n          </ul>\n          <p style={{ marginTop: '1rem', color: '#dc3545', fontWeight: 'bold' }}>\n             POZOR: Toto ru finln administrativn uzamen! Opravdu pokraovat?\n          </p>\n        </div>\n      </ConfirmDialog>\n\n      {/* InfoDialog pro blokaci zptn tvorby knih (uzaven msce v budoucnosti) */}\n      <ConfirmDialog\n        isOpen={retroactiveCreationBlockedDialogOpen}\n        title=\" Zptn vytvoen knihy nen mon\"\n        icon={faExclamationTriangle}\n        variant=\"danger\"\n        onConfirm={() => setRetroactiveCreationBlockedDialogOpen(false)}\n        onClose={() => setRetroactiveCreationBlockedDialogOpen(false)}\n        confirmText=\"Rozumm\"\n        showCancel={false}\n      >\n        <div style={{ textAlign: 'left' }}>\n          <p style={{ color: '#dc3545', fontWeight: 'bold', marginBottom: '1rem' }}>\n             NELZE VYTVOIT NOVOU KNIHU V TOMTO MSCI\n          </p>\n          <p>Pro tento msc <strong>nemte zaloenou pokladn knihu</strong> a existuj <strong>uzaven msce v budoucnosti</strong>.</p>\n          <p style={{ marginTop: '1rem' }}><strong>Dvody blokace:</strong></p>\n          <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>\n            <li>V nsledujcch mscch mte <strong>uzaven nebo zamen</strong> knihy</li>\n            <li>Zptn vytvoen knihy by <strong>poruilo kontinuitu</strong> etnictv</li>\n            <li>Nelze dodaten vytvet knihy <strong>ped uzavenmi msci</strong></li>\n          </ul>\n          <p style={{ marginTop: '1rem', color: '#28a745', fontWeight: 'bold' }}>\n             POZNMKA: Prohlen existujcch knih v minulosti je mon kdykoliv.\n          </p>\n          <p style={{ marginTop: '1rem', color: '#ff9800', fontWeight: 'bold' }}>\n             een: Nejprve otevete uzaven msce v budoucnosti, pak mete vytvoit nov knihy v minulosti.\n          </p>\n        </div>\n      </ConfirmDialog>\n\n      {/* Kontextov pomocnk - Modern Sponka */}\n      {hasPermission('HELPER_VIEW') && <ModernHelper pageContext=\"cashbook\" />}\n      \n      {/* Toast notifikace kontejner */}\n      <ToastContainer\n        position=\"top-right\"\n        autoClose={3000}\n        hideProgressBar={false}\n        newestOnTop={true}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n        theme=\"light\"\n      />\n      </PageContainer>\n    </>\n  );\n};\n\nexport default CashBookPage;","/**\n * ALTERNATIVN KONFIGURACE FONT PRO POKLADN KNIHU PDF\n *\n * Tento soubor obsahuje rzn zpsoby, jak nastavit fonty pro @react-pdf/renderer\n * s plnou podporou esk diakritiky.\n */\n\nimport { Font } from '@react-pdf/renderer';\n\n//  SINGLETON - fonty se registruj jen jednou\nlet fontsRegistered = false;\n\n/**\n * VARIANTA 1: CDN - Roboto (doporueno pro zatek)\n * Vhody: Jednoduch, bez stahovn soubor\n * Nevhody: Vyaduje internetov pipojen\n */\nexport const registerRobotoFromCDN = () => {\n  if (fontsRegistered) {\n    return;\n  }\n\n  try {\n    Font.register({\n      family: 'Roboto',\n      fonts: [\n        // Light\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-light-webfont.ttf',\n          fontWeight: 300,\n          fontStyle: 'normal',\n        },\n        // Regular\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-regular-webfont.ttf',\n          fontWeight: 400,\n          fontStyle: 'normal',\n        },\n        // Regular Italic\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-italic-webfont.ttf',\n          fontWeight: 400,\n          fontStyle: 'italic',\n        },\n        // Medium\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-medium-webfont.ttf',\n          fontWeight: 500,\n          fontStyle: 'normal',\n        },\n        // Bold\n        {\n          src: 'https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-bold-webfont.ttf',\n          fontWeight: 700,\n          fontStyle: 'normal',\n        },\n      ],\n    });\n    fontsRegistered = true;\n  } catch (error) {\n    console.error(' Chyba pi registraci Roboto font:', error);\n  }\n};\n\n//  Automatick registrace pi importu modulu\nregisterRobotoFromCDN();\n\n/**\n * VARIANTA 2: Google Fonts API\n * Vhody: Spolehlivj ne CDN, vdy aktuln verze\n * Nevhody: Vyaduje internetov pipojen\n */\nexport const registerRobotoFromGoogle = () => {\n  Font.register({\n    family: 'Roboto',\n    fonts: [\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxIIzI.ttf',\n        fontWeight: 300,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.ttf',\n        fontWeight: 500,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfBBc4.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n};\n\n/**\n * VARIANTA 3: Lokln soubory (nejspolehlivj)\n *\n * KROK 1: Sthni Roboto fonty z Google Fonts\n * https://fonts.google.com/specimen/Roboto\n *\n * KROK 2: Umsti TTF soubory do sloky:\n * /public/fonts/Roboto/\n * - Roboto-Light.ttf\n * - Roboto-Regular.ttf\n * - Roboto-Medium.ttf\n * - Roboto-Bold.ttf\n *\n * KROK 3: Pouij tuto funkci\n */\nexport const registerRobotoLocal = () => {\n  Font.register({\n    family: 'Roboto',\n    fonts: [\n      {\n        src: '/fonts/Roboto/Roboto-Light.ttf',\n        fontWeight: 300,\n      },\n      {\n        src: '/fonts/Roboto/Roboto-Regular.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: '/fonts/Roboto/Roboto-Medium.ttf',\n        fontWeight: 500,\n      },\n      {\n        src: '/fonts/Roboto/Roboto-Bold.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n};\n\n/**\n * VARIANTA 4: Noto Sans (alternativa k Roboto)\n * Dobr volba pro jet lep podporu Unicode znak\n */\nexport const registerNotoSansFromGoogle = () => {\n  Font.register({\n    family: 'Noto Sans',\n    fonts: [\n      {\n        src: 'https://fonts.gstatic.com/s/notosans/v30/o-0IIpQlx3QUlC5A4PNb4j5Ba_2c7A.ttf',\n        fontWeight: 300,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/notosans/v30/o-0IIpQlx3QUlC5A4PNr4DRFSfiM7HBj.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/notosans/v30/o-0IIpQlx3QUlC5A4PNb4kZBa_2c7A.ttf',\n        fontWeight: 500,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/notosans/v30/o-0IIpQlx3QUlC5A4PNb4gBDa_2c7A.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n};\n\n/**\n * VARIANTA 5: Fallback s error handlingem\n * Pro produkn prosted - pokus se nast fonty, pi chyb pouije vchoz\n */\nexport const registerFontsWithFallback = async () => {\n  try {\n    // Pokus o naten z Google Fonts\n    registerRobotoFromGoogle();\n    console.log(' Fonty spn nateny z Google Fonts');\n  } catch (error) {\n    console.error(' Nepodailo se nast fonty. PDF bude pouvat vchoz font.', error);\n    // V tomto ppad @react-pdf/renderer pouije vchoz Helvetica\n    // ale bez podpory diakritiky\n  }\n};\n\n/**\n * VARIANTA 6: Registrace vce font pro rzn ely\n */\nexport const registerMultipleFonts = () => {\n  // Roboto pro bn text\n  Font.register({\n    family: 'Roboto',\n    fonts: [\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfBBc4.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n\n  // Roboto Mono pro sla a kdy (lep itelnost)\n  Font.register({\n    family: 'Roboto Mono',\n    fonts: [\n      {\n        src: 'https://fonts.gstatic.com/s/robotomono/v22/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW4.ttf',\n        fontWeight: 400,\n      },\n      {\n        src: 'https://fonts.gstatic.com/s/robotomono/v22/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_gPu_ROW4.ttf',\n        fontWeight: 700,\n      },\n    ],\n  });\n};\n\n/**\n * DOPORUEN NASTAVEN PRO PRODUKCI\n */\nexport const registerProductionFonts = () => {\n  // Pro produkci doporuuji pout lokln fonty\n  // protoe zaruuj:\n  // 1. Offline funknost\n  // 2. Rychlej natn\n  // 3. Bez zvislosti na tetch stranch\n\n  const isLocal = process.env.NODE_ENV === 'production';\n\n  if (isLocal) {\n    registerRobotoLocal();\n  } else {\n    registerRobotoFromGoogle();\n  }\n};\n\n/**\n * NVOD NA STAEN ROBOTO FONT\n *\n * Metoda 1: Pes Google Fonts\n * 1. Jdi na: https://fonts.google.com/specimen/Roboto\n * 2. Klikni na \"Download family\"\n * 3. Rozbal ZIP a zkopruj potebn TTF soubory\n * 4. Umsti je do /public/fonts/Roboto/\n *\n * Metoda 2: Pes terminl (Linux/Mac)\n *\n * mkdir -p public/fonts/Roboto\n * cd public/fonts/Roboto\n *\n * # Staen pmo z Google Fonts CDN\n * wget -O Roboto-Light.ttf \"https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxIIzI.ttf\"\n * wget -O Roboto-Regular.ttf \"https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.ttf\"\n * wget -O Roboto-Medium.ttf \"https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.ttf\"\n * wget -O Roboto-Bold.ttf \"https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfBBc4.ttf\"\n *\n * Metoda 3: Pomoc npm balku\n *\n * npm install @fontsource/roboto\n *\n * Pot importuj v komponente:\n * import '@fontsource/roboto/300.css';\n * import '@fontsource/roboto/400.css';\n * import '@fontsource/roboto/500.css';\n * import '@fontsource/roboto/700.css';\n */\n\nexport default {\n  registerRobotoFromCDN,\n  registerRobotoFromGoogle,\n  registerRobotoLocal,\n  registerNotoSansFromGoogle,\n  registerFontsWithFallback,\n  registerMultipleFonts,\n  registerProductionFonts,\n};\n"],"names":["ComboboxWrapper","styled","div","_templateObject","_taggedTemplateLiteral","ComboboxInput","input","_templateObject2","props","hasError","disabled","DropdownList","ul","_templateObject3","DropdownItem","li","_templateObject4","NoResults","_templateObject5","_ref","value","onChange","onKeyDown","onBlur","options","placeholder","loading","strictSelect","inputValue","setInputValue","useState","isOpen","setIsOpen","highlightedIndex","setHighlightedIndex","dropdownPosition","setDropdownPosition","top","left","width","inputRef","useRef","wrapperRef","useEffect","updateDropdownPosition","current","rect","getBoundingClientRect","bottom","window","scrollY","scrollX","Math","max","handleScroll","handleResize","addEventListener","removeEventListener","filteredOptions","React","searchTerm","toLowerCase","trim","filter","option","code","name","includes","handleClickOutside","event","contains","target","document","selectOption","newValue","setTimeout","_inputRef$current","focus","_jsxs","ref","children","_jsx","type","e","onFocus","handleInputFocus","length","some","opt","key","preventDefault","prev","autoComplete","ReactDOM","style","concat","map","index","className","onMouseDown","onMouseEnter","body","styles","StyleSheet","create","page","flexDirection","backgroundColor","padding","paddingBottom","fontFamily","fontSize","header","marginBottom","alignItems","justifyContent","gap","logoContainer","height","logo","objectFit","headerContent","flex","headerOrganization","fontWeight","color","headerTitle","headerSubtitle","headerInfo","headerPeriod","alignSelf","periodMonth","textTransform","periodYear","summaryBlock","borderRadius","summaryGrid","flexWrap","summaryItem","minWidth","summaryLabel","summaryValue","summaryValuePositive","summaryValueNegative","summaryValueNeutral","bookStatusCard","borderLeftWidth","borderLeftColor","borderLeftStyle","bookStatusCardClosed","bookStatusCardLocked","bookStatusTitle","bookStatusInfo","bookStatusInfoItem","bookStatusLabel","bookStatusValue","table","display","borderStyle","borderWidth","borderColor","borderRightWidth","borderBottomWidth","tableRow","tableHeaderRow","tableHeaderCell","borderTopWidth","textAlign","verticalAlign","tableCell","tableCellAlternate","colNumber","colDate","colDocNumber","colDescription","colPerson","colIncome","colExpense","colBalance","colLpCode","colNote","colHeaderIncome","colHeaderExpense","colHeaderBalance","footer","position","right","borderTopColor","paddingTop","formatCurrency","amount","undefined","num","parseFloat","isNaN","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","format","formatDate","dateString","Date","toLocaleDateString","day","month","year","error","organizationInfo","carryOverAmount","totals","entries","generatedBy","bookStatus","currentDate","toLocaleString","hour","minute","Document","Page","size","orientation","View","Image","src","ASSETS","LOGO_ZZS_MAIN","Text","organizationName","workplace","cashboxNumber","toUpperCase","status","_Fragment","closedDate","closedBy","lockedDate","lockedBy","totalIncome","totalExpenses","currentBalance","entry","date","documentNumber","description","person","income","expense","balance","lpCode","note","id","fixed","fullName","usekZkr","lokalita","render","_ref2","pageNumber","totalPages","config","getStatusConfig","label","icon","title","Container","Row","PeriodSelect","select","Label","SelectWrapper","SelectButton","button","_templateObject6","DropdownIcon","span","_templateObject7","Dropdown","_templateObject8","SearchWrapper","_templateObject9","SearchIcon","_templateObject0","SearchInput","_templateObject1","OptionsList","_templateObject10","Option","_templateObject11","$selected","OptionLabel","_templateObject12","OptionDetails","_templateObject13","OptionTitle","_templateObject14","OptionSubtitle","_templateObject15","OptionBadge","_templateObject16","StatusBadge","_templateObject17","$status","Info","_templateObject18","currentCashbox","userCashboxes","allCashboxes","permissions","canSeeAllCashboxes","onCashboxChange","currentYear","currentMonth","onPeriodChange","searchQuery","setSearchQuery","dropdownRef","searchInputRef","canReadAll","canManage","isCurrentCashboxOwned","useMemo","uc","String","cislo_pokladny","availableCashboxes","boxes","cb","parseInt","je_hlavni","seen","Set","has","add","filteredCashboxes","query","number","nazev","nazev_pracoviste","userName","uzivatel_cele_jmeno","uzivatel_jmeno","uzivatel_prijmeni","lokalita_nazev","lokalita_kod","usek","usek_nazev","location","kod_pracoviste","months","now","currentYearNow","getFullYear","currentMonthNow","getMonth","years","y","push","availableMonths","m","newYear","newMonth","FontAwesomeIcon","faCalculator","onClick","labelData","getCurrentLabel","isOwn","cashboxName","details","join","stav_knihy","marginLeft","faChevronDown","faSearch","cursor","cashbox","isMyOwnCashbox","handleSelect","faCheckCircle","PERMISSIONS","CASH_BOOK_READ_OWN","CASH_BOOK_READ_ALL","CASH_BOOK_EDIT_OWN","CASH_BOOK_EDIT_ALL","CASH_BOOK_DELETE_OWN","CASH_BOOK_DELETE_ALL","CASH_BOOK_EXPORT_OWN","CASH_BOOK_EXPORT_ALL","CASH_BOOK_MANAGE","getUserCashbookPermissions","userDetail","directRights","direct_rights","Array","isArray","forEach","p","kod_prava","kod_opravneni","startsWith","prava","perms","roles","role","rolePrava","rights","getCashbookPermissionsObject","canReadOwn","canEditOwn","canEditAll","canDeleteOwn","canDeleteAll","canExportOwn","canExportAll","printStyles","css","fadeIn","keyframes","slideIn","highlightPulse","PageContainer","Header","ActionBar","ActionGroup","ActionButton","variant","$filled","MonthNavigation","MonthInfo","MonthControls","MonthButton","PreviousMonthWarning","WarningIcon","WarningContent","InfoPanel","StickyCompactSummary","$visible","TableContainer","Table","_templateObject19","CurrencyInputWrapper","_templateObject20","EditableInput","_templateObject21","ActionIcon","_templateObject22","_templateObject23","danger","AddRowButton","_templateObject24","CurrencyInput","localValue","setLocalValue","isFocused","setIsFocused","val","toString","replace","toFixed","formattedValue","cleanValue","numValue","finalValue","handleFocus","handleBlurLocal","formatted","CashBookPage","_userDetail$roles","user","token","hasPermission","useContext","AuthContext","showToast","ToastContext","savedPeriod","loadSavedPeriod","saved","localStorage","getItem","JSON","parse","err","setCurrentMonth","setCurrentYear","setCarryOverAmount","showStickySummary","setShowStickySummary","deleteDialogOpen","setDeleteDialogOpen","entryToDelete","setEntryToDelete","closeMonthDialogOpen","setCloseMonthDialogOpen","lockBookDialogOpen","setLockBookDialogOpen","reopenMonthDialogOpen","setReopenMonthDialogOpen","unlockBookDialogOpen","setUnlockBookDialogOpen","retroactiveCreationBlockedDialogOpen","setRetroactiveCreationBlockedDialogOpen","cashBookEntries","setCashBookEntries","cashBookEntriesRef","lastSavedEntryId","setLastSavedEntryId","lpCodes","setLpCodes","lpLoading","setLpLoading","expandedDetailEntryId","setExpandedDetailEntryId","detailEditBuffer","setDetailEditBuffer","mainAssignment","setMainAssignment","assignmentLoading","setAssignmentLoading","userAssignments","setUserAssignments","allAssignments","setAllAssignments","setBookStatus","bookStatusMetadata","setBookStatusMetadata","usePrefixedNumbers","setUsePrefixedNumbers","settingsLoading","setSettingsLoading","currentBookId","setCurrentBookId","currentBookData","setCurrentBookData","isSyncing","setIsSyncing","lastSyncTimestamp","setLastSyncTimestamp","showPreviousMonthWarning","setShowPreviousMonthWarning","syncConflicts","setSyncConflicts","getUserLocation","_userDetail$lokalita_","_userDetail$lokalita","cashboxVpd","ciselna_rada_vpd","cashboxPpd","ciselna_rada_ppd","STORAGE_KEY","userId","assignmentId","cashbookPermissions","hasAllPermissions","hasMultipleCashboxes","transformDBEntryToFrontend","useCallback","dbEntry","dbTimestamp","aktualizovano","vytvoreno","detailItems","detail_items","hasDetails","random","db_id","datum_zapisu","cislo_dokladu","obsah_zapisu","komu_od_koho","castka_prijem","castka_vydaj","zustatek_po_operaci","lp_kod","poznamka","isEditing","item","castka","popis","last_modified_local","toISOString","last_synced_at","db_updated_at","changed","sync_status","transformFrontendEntryToDB","bookId","payload","book_id","typ_dokladu","castka_celkem","reduce","sum","ensureBookExists","async","_booksResult$data","_booksResult$data$boo","targetUserId","uzivatel_id","booksResult","cashbookAPI","listBooks","data","books","_bookDetail$data","book","prevod_z_predchoziho","bookDetail","getBook","createResult","createBook","_createResult$data","_createResult$data2","_bookDetail$data2","_bookDetail$data3","newBook","errorMsg","message","Error","console","warn","saveToLocalStorage","carryOver","dataToSave","lastModified","setItem","stringify","syncLocalChangesToDB","targetBookId","arguments","syncedCount","errorCount","updateEntry","_result$data","result","createEntry","endBalance","updateBook","celkove_prijmy","celkove_vydaje","koncovy_stav","pocet_zaznamu","loadFromLocalStorageOnly","savedData","prevMonth","prevYear","prevStorageKey","calculatedCarryOver","prevMonthData","prevParsed","prevEntries","prevInitialBalance","parsed","storedCarryOver","updatedData","_objectSpread","_window$performance","_window$performance$n","_window$performance2","_window$performance2$","_window$performance2$2","_window$performance2$3","closedByName","uzivatel_jmeno_plne","lockedByName","zamknul_spravce_jmeno_plne","uzavrena_uzivatelem_kdy","zamknuta_spravcem_kdy","isPageReload","performance","navigation","getEntriesByType","call","localEntries","localTimestamp","dbIsNewer","removeItem","loadDataFromDB","username","fetchLimitovanePrisliby","transformedLps","lp","cislo_lp","kod","nazev_uctu","loadLpCodes","mainElement","querySelector","scrollTop","refreshDataFromDB","showMessage","bookData","_bookData$data","_bookData$data2","freshCarryOver","dbEntries","datum","split","stored","localData","mergedEntries","localEntry","find","le","handleVisibilityChange","hidden","intervalId","setInterval","_localData$entries","_localData$entries2","_cashBookEntriesRef$c","hasEditingEntryInLocalStorage","hasUnsyncedChanges","hasEditingEntryInState","clearInterval","_userResult$data","listAssignments","assignments","allAvailableAssignments","_allResult$data","allResult","getCashboxListByPeriod","pokladny","transformedData","prirazeni_id","pokladna_id","aktivni","selectedAssignment","a","loadAllData","getSettings","loadSettings","initialBalance","entryCount","getLastDocumentNumbersFromPreviousMonth","lastP","lastV","_booksResult$data2","_bookResult$data","_bookResult$data$entr","prevBook","bookResult","pNumbers","_e$cislo_dokladu","substring","vNumbers","_e$cislo_dokladu2","currency","dateStr","checkForClosedFutureMonths","targetYear","targetMonth","hasClosedFuture","closedMonths","today","currentSystemMonth","currentSystemYear","checkYear","checkMonth","_booksResult$data3","_booksResult$data3$bo","monthName","checkPreviousMonthStatus","_result$data2","_result$data2$books","addNewEntry","newId","defaultDate","lastDayOfMonth","padStart","getDate","newEntry","requestAnimationFrame","descriptionInput","handleCashboxChange","newAssignment","saveData","startEditing","stopEditing","_editedEntry$descript","editedEntry","hasExpense","hasDetailItems","cancelEditing","filtered","hasIncome","typeChanged","shouldBeV","currentMonthPNumbers","_e$documentNumber","nextP","log","currentMonthVNumbers","_e$documentNumber2","nextV","currentPrefix","charAt","_e$documentNumber3","_e$documentNumber4","updatedEntry","updatedEntries","updateResult","_updateResult$data","_updateResult$data$en","_result$data3","originalEntry","handleKeyDown","entryId","shiftKey","field","newEntries","processedValue","runningBalance","autoSave","exportData","filename","exportToCSV","generatePDFReport","rows","csvContent","row","blob","Blob","link","createElement","href","URL","createObjectURL","download","click","revokeObjectURL","_userDetail$usek_zkr","titul_pred","jmeno","prijmeni","titul_za","usek_zkr","pdf","PokladniKnihaPDF","toBlob","url","appendChild","removeChild","isSuperAdmin","r","kod_role","hasManagePermission","isCurrentUserCashbook","isOwner","isAssignedToThisCashbox","assignment","isBookEditable","canViewCashBook","canActuallyEdit","canActuallyDelete","canActuallyCreate","canExportCashBook","canCloseCurrentPeriod","todayYear","todayMonth","handleUnlockBook","handleGlobalKeyDown","editingEntry","firstInput","Global","cashboxNum","vpd","ppd","CashboxSelector","BookStatusBadge","faInfoCircle","marginRight","handleCloseMonth","faCheck","handleLockBook","_targetBooksResult$da","targetBooksResult","faChevronLeft","goToCurrentMonth","faCalendarDay","goToNextMonth","faChevronRight","faExclamationTriangle","borderBottom","margin","isLastSaved","onDoubleClick","animation","DatePicker","newDate","limitToMonth","limitToYear","prefix","prefixedNumber","EditableCombobox","marginTop","whiteSpace","lp_popis","background","border","Number","idx","faEdit","removeEntry","faTrash","colSpan","boxShadow","borderCollapse","tableLayout","isValidLp","updated","boxSizing","selectedLp","_","i","lineHeight","borderTop","abs","totalDetail","toast","autoClose","warning","success","handleAddNewRow","faPlus","flexShrink","faLock","faFileExport","faPrint","_userDetail$usek_zkr2","printWindow","open","onload","print","onafterprint","ConfirmDialog","onConfirm","deleteEntry","onClose","handleCancelDelete","_bookCheckResult$data","_reloadResult$data","bookCheckResult","currentState","renumberResult","_allBooksResult$data","allBooksResult","booksArray","futureBooks","rok","mesic","sort","b","prevLastP","prevLastV","_bookResult$data2","sortedEntries","newNumber","renumberAllFutureMonths","reloadResult","transformedEntries","closeMonth","_bookCheckResult$data2","recheckError","lockBook","reopenBook","confirmText","cancelText","faLockOpen","showCancel","ModernHelper","pageContext","ToastContainer","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","theme","fontsRegistered","registerRobotoFromCDN","Font","register","family","fonts","fontStyle"],"sourceRoot":""}